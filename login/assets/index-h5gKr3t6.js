const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DnsQfpRI.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-BKxD1fzZ.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-1spnDE0e.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-vOdqpGGW.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BAnCugnW.js","assets/ProteinSnacks-DM7pSRCD.js","assets/DailyMotivation-BE2KKhc2.js","assets/CircuitDashboard-UtYcVFVB.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-DxKWSgo4.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-BzEhaGbC.js","assets/Leaderboard-lyZEtGxw.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=n(l);fetch(l.href,u)}})();var dp={exports:{}},Vc={};var h1;function sj(){if(h1)return Vc;h1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return Vc.Fragment=e,Vc.jsx=n,Vc.jsxs=n,Vc}var d1;function rj(){return d1||(d1=1,dp.exports=sj()),dp.exports}var a=rj(),fp={exports:{}},Wt={};var f1;function aj(){if(f1)return Wt;f1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),E=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=E&&P[E]||P["@@iterator"],typeof P=="function"?P:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,V={};function te(P,W,ye){this.props=P,this.context=W,this.refs=V,this.updater=ye||G}te.prototype.isReactComponent={},te.prototype.setState=function(P,W){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,W,"setState")},te.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function X(){}X.prototype=te.prototype;function me(P,W,ye){this.props=P,this.context=W,this.refs=V,this.updater=ye||G}var Ee=me.prototype=new X;Ee.constructor=me,U(Ee,te.prototype),Ee.isPureReactComponent=!0;var ze=Array.isArray;function Le(){}var I={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function R(P,W,ye){var Ne=ye.ref;return{$$typeof:s,type:P,key:W,ref:Ne!==void 0?Ne:null,props:ye}}function L(P,W){return R(P.type,W,P.props)}function D(P){return typeof P=="object"&&P!==null&&P.$$typeof===s}function z(P){var W={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(ye){return W[ye]})}var M=/\/+/g;function Fe(P,W){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):W.toString(36)}function wt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Le,Le):(P.status="pending",P.then(function(W){P.status==="pending"&&(P.status="fulfilled",P.value=W)},function(W){P.status==="pending"&&(P.status="rejected",P.reason=W)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function Y(P,W,ye,Ne,Be){var ke=typeof P;(ke==="undefined"||ke==="boolean")&&(P=null);var et=!1;if(P===null)et=!0;else switch(ke){case"bigint":case"string":case"number":et=!0;break;case"object":switch(P.$$typeof){case s:case e:et=!0;break;case x:return et=P._init,Y(et(P._payload),W,ye,Ne,Be)}}if(et)return Be=Be(P),et=Ne===""?"."+Fe(P,0):Ne,ze(Be)?(ye="",et!=null&&(ye=et.replace(M,"$&/")+"/"),Y(Be,W,ye,"",function(Ht){return Ht})):Be!=null&&(D(Be)&&(Be=L(Be,ye+(Be.key==null||P&&P.key===Be.key?"":(""+Be.key).replace(M,"$&/")+"/")+et)),W.push(Be)),1;et=0;var gt=Ne===""?".":Ne+":";if(ze(P))for(var Je=0;Je<P.length;Je++)Ne=P[Je],ke=gt+Fe(Ne,Je),et+=Y(Ne,W,ye,ke,Be);else if(Je=O(P),typeof Je=="function")for(P=Je.call(P),Je=0;!(Ne=P.next()).done;)Ne=Ne.value,ke=gt+Fe(Ne,Je++),et+=Y(Ne,W,ye,ke,Be);else if(ke==="object"){if(typeof P.then=="function")return Y(wt(P),W,ye,Ne,Be);throw W=String(P),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return et}function Se(P,W,ye){if(P==null)return P;var Ne=[],Be=0;return Y(P,Ne,"","",function(ke){return W.call(ye,ke,Be++)}),Ne}function Oe(P){if(P._status===-1){var W=P._result;W=W(),W.then(function(ye){(P._status===0||P._status===-1)&&(P._status=1,P._result=ye)},function(ye){(P._status===0||P._status===-1)&&(P._status=2,P._result=ye)}),P._status===-1&&(P._status=0,P._result=W)}if(P._status===1)return P._result.default;throw P._result}var ht=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},ae={map:Se,forEach:function(P,W,ye){Se(P,function(){W.apply(this,arguments)},ye)},count:function(P){var W=0;return Se(P,function(){W++}),W},toArray:function(P){return Se(P,function(W){return W})||[]},only:function(P){if(!D(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Wt.Activity=k,Wt.Children=ae,Wt.Component=te,Wt.Fragment=n,Wt.Profiler=l,Wt.PureComponent=me,Wt.StrictMode=i,Wt.Suspense=g,Wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Wt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return I.H.useMemoCache(P)}},Wt.cache=function(P){return function(){return P.apply(null,arguments)}},Wt.cacheSignal=function(){return null},Wt.cloneElement=function(P,W,ye){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Ne=U({},P.props),Be=P.key;if(W!=null)for(ke in W.key!==void 0&&(Be=""+W.key),W)!j.call(W,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&W.ref===void 0||(Ne[ke]=W[ke]);var ke=arguments.length-2;if(ke===1)Ne.children=ye;else if(1<ke){for(var et=Array(ke),gt=0;gt<ke;gt++)et[gt]=arguments[gt+2];Ne.children=et}return R(P.type,Be,Ne)},Wt.createContext=function(P){return P={$$typeof:h,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},Wt.createElement=function(P,W,ye){var Ne,Be={},ke=null;if(W!=null)for(Ne in W.key!==void 0&&(ke=""+W.key),W)j.call(W,Ne)&&Ne!=="key"&&Ne!=="__self"&&Ne!=="__source"&&(Be[Ne]=W[Ne]);var et=arguments.length-2;if(et===1)Be.children=ye;else if(1<et){for(var gt=Array(et),Je=0;Je<et;Je++)gt[Je]=arguments[Je+2];Be.children=gt}if(P&&P.defaultProps)for(Ne in et=P.defaultProps,et)Be[Ne]===void 0&&(Be[Ne]=et[Ne]);return R(P,ke,Be)},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(P){return{$$typeof:p,render:P}},Wt.isValidElement=D,Wt.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:Oe}},Wt.memo=function(P,W){return{$$typeof:y,type:P,compare:W===void 0?null:W}},Wt.startTransition=function(P){var W=I.T,ye={};I.T=ye;try{var Ne=P(),Be=I.S;Be!==null&&Be(ye,Ne),typeof Ne=="object"&&Ne!==null&&typeof Ne.then=="function"&&Ne.then(Le,ht)}catch(ke){ht(ke)}finally{W!==null&&ye.types!==null&&(W.types=ye.types),I.T=W}},Wt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Wt.use=function(P){return I.H.use(P)},Wt.useActionState=function(P,W,ye){return I.H.useActionState(P,W,ye)},Wt.useCallback=function(P,W){return I.H.useCallback(P,W)},Wt.useContext=function(P){return I.H.useContext(P)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(P,W){return I.H.useDeferredValue(P,W)},Wt.useEffect=function(P,W){return I.H.useEffect(P,W)},Wt.useEffectEvent=function(P){return I.H.useEffectEvent(P)},Wt.useId=function(){return I.H.useId()},Wt.useImperativeHandle=function(P,W,ye){return I.H.useImperativeHandle(P,W,ye)},Wt.useInsertionEffect=function(P,W){return I.H.useInsertionEffect(P,W)},Wt.useLayoutEffect=function(P,W){return I.H.useLayoutEffect(P,W)},Wt.useMemo=function(P,W){return I.H.useMemo(P,W)},Wt.useOptimistic=function(P,W){return I.H.useOptimistic(P,W)},Wt.useReducer=function(P,W,ye){return I.H.useReducer(P,W,ye)},Wt.useRef=function(P){return I.H.useRef(P)},Wt.useState=function(P){return I.H.useState(P)},Wt.useSyncExternalStore=function(P,W,ye){return I.H.useSyncExternalStore(P,W,ye)},Wt.useTransition=function(){return I.H.useTransition()},Wt.version="19.2.4",Wt}var m1;function jg(){return m1||(m1=1,fp.exports=aj()),fp.exports}var w=jg(),mp={exports:{}},Bc={},pp={exports:{}},gp={};var p1;function ij(){return p1||(p1=1,(function(s){function e(Y,Se){var Oe=Y.length;Y.push(Se);e:for(;0<Oe;){var ht=Oe-1>>>1,ae=Y[ht];if(0<l(ae,Se))Y[ht]=Se,Y[Oe]=ae,Oe=ht;else break e}}function n(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var Se=Y[0],Oe=Y.pop();if(Oe!==Se){Y[0]=Oe;e:for(var ht=0,ae=Y.length,P=ae>>>1;ht<P;){var W=2*(ht+1)-1,ye=Y[W],Ne=W+1,Be=Y[Ne];if(0>l(ye,Oe))Ne<ae&&0>l(Be,ye)?(Y[ht]=Be,Y[Ne]=Oe,ht=Ne):(Y[ht]=ye,Y[W]=Oe,ht=W);else if(Ne<ae&&0>l(Be,Oe))Y[ht]=Be,Y[Ne]=Oe,ht=Ne;else break e}}return Se}function l(Y,Se){var Oe=Y.sortIndex-Se.sortIndex;return Oe!==0?Oe:Y.id-Se.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],x=1,k=null,E=3,O=!1,G=!1,U=!1,V=!1,te=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,me=typeof setImmediate<"u"?setImmediate:null;function Ee(Y){for(var Se=n(y);Se!==null;){if(Se.callback===null)i(y);else if(Se.startTime<=Y)i(y),Se.sortIndex=Se.expirationTime,e(g,Se);else break;Se=n(y)}}function ze(Y){if(U=!1,Ee(Y),!G)if(n(g)!==null)G=!0,Le||(Le=!0,z());else{var Se=n(y);Se!==null&&wt(ze,Se.startTime-Y)}}var Le=!1,I=-1,j=5,R=-1;function L(){return V?!0:!(s.unstable_now()-R<j)}function D(){if(V=!1,Le){var Y=s.unstable_now();R=Y;var Se=!0;try{e:{G=!1,U&&(U=!1,X(I),I=-1),O=!0;var Oe=E;try{t:{for(Ee(Y),k=n(g);k!==null&&!(k.expirationTime>Y&&L());){var ht=k.callback;if(typeof ht=="function"){k.callback=null,E=k.priorityLevel;var ae=ht(k.expirationTime<=Y);if(Y=s.unstable_now(),typeof ae=="function"){k.callback=ae,Ee(Y),Se=!0;break t}k===n(g)&&i(g),Ee(Y)}else i(g);k=n(g)}if(k!==null)Se=!0;else{var P=n(y);P!==null&&wt(ze,P.startTime-Y),Se=!1}}break e}finally{k=null,E=Oe,O=!1}Se=void 0}}finally{Se?z():Le=!1}}}var z;if(typeof me=="function")z=function(){me(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Fe=M.port2;M.port1.onmessage=D,z=function(){Fe.postMessage(null)}}else z=function(){te(D,0)};function wt(Y,Se){I=te(function(){Y(s.unstable_now())},Se)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Y){Y.callback=null},s.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<Y?Math.floor(1e3/Y):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(Y){switch(E){case 1:case 2:case 3:var Se=3;break;default:Se=E}var Oe=E;E=Se;try{return Y()}finally{E=Oe}},s.unstable_requestPaint=function(){V=!0},s.unstable_runWithPriority=function(Y,Se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Oe=E;E=Y;try{return Se()}finally{E=Oe}},s.unstable_scheduleCallback=function(Y,Se,Oe){var ht=s.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?ht+Oe:ht):Oe=ht,Y){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=Oe+ae,Y={id:x++,callback:Se,priorityLevel:Y,startTime:Oe,expirationTime:ae,sortIndex:-1},Oe>ht?(Y.sortIndex=Oe,e(y,Y),n(g)===null&&Y===n(y)&&(U?(X(I),I=-1):U=!0,wt(ze,Oe-ht))):(Y.sortIndex=ae,e(g,Y),G||O||(G=!0,Le||(Le=!0,z()))),Y},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(Y){var Se=E;return function(){var Oe=E;E=Se;try{return Y.apply(this,arguments)}finally{E=Oe}}}})(gp)),gp}var g1;function oj(){return g1||(g1=1,pp.exports=ij()),pp.exports}var yp={exports:{}},Ks={};var y1;function lj(){if(y1)return Ks;y1=1;var s=jg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:x}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Ks.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ks.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},Ks.flushSync=function(g){var y=h.T,x=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=x,i.d.f()}},Ks.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},Ks.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Ks.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin),E=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:E,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:k,integrity:E,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Ks.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},Ks.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Ks.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},Ks.requestFormReset=function(g){i.d.r(g)},Ks.unstable_batchedUpdates=function(g,y){return g(y)},Ks.useFormState=function(g,y,x){return h.H.useFormState(g,y,x)},Ks.useFormStatus=function(){return h.H.useHostTransitionStatus()},Ks.version="19.2.4",Ks}var v1;function cj(){if(v1)return yp.exports;v1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),yp.exports=lj(),yp.exports}var b1;function uj(){if(b1)return Bc;b1=1;var s=oj(),e=jg(),n=cj();function i(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function h(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function g(t){if(u(t)!==t)throw Error(i(188))}function y(t){var r=t.alternate;if(!r){if(r=u(t),r===null)throw Error(i(188));return r!==t?null:t}for(var o=t,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),t;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var b=!1,S=f.child;S;){if(S===o){b=!0,o=f,c=m;break}if(S===c){b=!0,c=f,o=m;break}S=S.sibling}if(!b){for(S=m.child;S;){if(S===o){b=!0,o=m,c=f;break}if(S===c){b=!0,c=m,o=f;break}S=S.sibling}if(!b)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?t:r}function x(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=x(t),r!==null)return r;t=t.sibling}return null}var k=Object.assign,E=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),me=Symbol.for("react.context"),Ee=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),Le=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function z(t){return t===null||typeof t!="object"?null:(t=D&&t[D]||t["@@iterator"],typeof t=="function"?t:null)}var M=Symbol.for("react.client.reference");function Fe(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===M?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case U:return"Fragment";case te:return"Profiler";case V:return"StrictMode";case ze:return"Suspense";case Le:return"SuspenseList";case R:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case G:return"Portal";case me:return t.displayName||"Context";case X:return(t._context.displayName||"Context")+".Consumer";case Ee:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I:return r=t.displayName||null,r!==null?r:Fe(t.type)||"Memo";case j:r=t._payload,t=t._init;try{return Fe(t(r))}catch{}}return null}var wt=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Oe={pending:!1,data:null,method:null,action:null},ht=[],ae=-1;function P(t){return{current:t}}function W(t){0>ae||(t.current=ht[ae],ht[ae]=null,ae--)}function ye(t,r){ae++,ht[ae]=t.current,t.current=r}var Ne=P(null),Be=P(null),ke=P(null),et=P(null);function gt(t,r){switch(ye(ke,r),ye(Be,t),ye(Ne,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?D0(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=D0(r),t=P0(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}W(Ne),ye(Ne,t)}function Je(){W(Ne),W(Be),W(ke)}function Ht(t){t.memoizedState!==null&&ye(et,t);var r=Ne.current,o=P0(r,t.type);r!==o&&(ye(Be,t),ye(Ne,o))}function hn(t){Be.current===t&&(W(Ne),W(Be)),et.current===t&&(W(et),Dc._currentValue=Oe)}var Nt,Ct;function oe(t){if(Nt===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Nt=r&&r[1]||"",Ct=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nt+t+Ct}var yn=!1;function $t(t,r){if(!t||yn)return"";yn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(fe){var ie=fe}Reflect.construct(t,[],Re)}else{try{Re.call()}catch(fe){ie=fe}t.call(Re.prototype)}}else{try{throw Error()}catch(fe){ie=fe}(Re=t())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(fe){if(fe&&ie&&typeof fe.stack=="string")return[fe.stack,ie.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),b=m[0],S=m[1];if(b&&S){var B=b.split(`
`),se=S.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<se.length&&!se[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===se.length)for(c=B.length-1,f=se.length-1;1<=c&&0<=f&&B[c]!==se[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==se[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==se[f]){var be=`
`+B[c].replace(" at new "," at ");return t.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",t.displayName)),be}while(1<=c&&0<=f);break}}}finally{yn=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?oe(o):""}function Et(t,r){switch(t.tag){case 26:case 27:case 5:return oe(t.type);case 16:return oe("Lazy");case 13:return t.child!==r&&r!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return $t(t.type,!1);case 11:return $t(t.type.render,!1);case 1:return $t(t.type,!0);case 31:return oe("Activity");default:return""}}function Bt(t){try{var r="",o=null;do r+=Et(t,o),o=t,t=t.return;while(t);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ft=Object.prototype.hasOwnProperty,Ye=s.unstable_scheduleCallback,le=s.unstable_cancelCallback,He=s.unstable_shouldYield,tt=s.unstable_requestPaint,pt=s.unstable_now,Dt=s.unstable_getCurrentPriorityLevel,at=s.unstable_ImmediatePriority,St=s.unstable_UserBlockingPriority,ce=s.unstable_NormalPriority,xe=s.unstable_LowPriority,Ie=s.unstable_IdlePriority,Qe=s.log,Ge=s.unstable_setDisableYieldValue,We=null,nt=null;function st(t){if(typeof Qe=="function"&&Ge(t),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(We,t)}catch{}}var qe=Math.clz32?Math.clz32:en,Kt=Math.log,nn=Math.LN2;function en(t){return t>>>=0,t===0?32:31-(Kt(t)/nn|0)|0}var Nn=256,Fn=262144,Ut=4194304;function wn(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Xn(t,r,o){var c=t.pendingLanes;if(c===0)return 0;var f=0,m=t.suspendedLanes,b=t.pingedLanes;t=t.warmLanes;var S=c&134217727;return S!==0?(c=S&~m,c!==0?f=wn(c):(b&=S,b!==0?f=wn(b):o||(o=S&~t,o!==0&&(f=wn(o))))):(S=c&~m,S!==0?f=wn(S):b!==0?f=wn(b):o||(o=c&~t,o!==0&&(f=wn(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Dn(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function us(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vs(){var t=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),t}function Hn(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function hs(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function ds(t,r,o,c,f,m){var b=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var S=t.entanglements,B=t.expirationTimes,se=t.hiddenUpdates;for(o=b&~o;0<o;){var be=31-qe(o),Re=1<<be;S[be]=0,B[be]=-1;var ie=se[be];if(ie!==null)for(se[be]=null,be=0;be<ie.length;be++){var fe=ie[be];fe!==null&&(fe.lane&=-536870913)}o&=~Re}c!==0&&Ns(t,c,0),m!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=m&~(b&~r))}function Ns(t,r,o){t.pendingLanes|=r,t.suspendedLanes&=~r;var c=31-qe(r);t.entangledLanes|=r,t.entanglements[c]=t.entanglements[c]|1073741824|o&261930}function Is(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var c=31-qe(o),f=1<<c;f&r|t[c]&r&&(t[c]|=r),o&=~f}}function Os(t,r){var o=r&-r;return o=(o&42)!==0?1:q(o),(o&(t.suspendedLanes|r))!==0?0:o}function q(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function ge(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function we(){var t=Se.p;return t!==0?t:(t=window.event,t===void 0?32:r1(t.type))}function ve(t,r){var o=Se.p;try{return Se.p=t,r()}finally{Se.p=o}}var pe=Math.random().toString(36).slice(2),ot="__reactFiber$"+pe,Rt="__reactProps$"+pe,ut="__reactContainer$"+pe,_t="__reactEvents$"+pe,bt="__reactListeners$"+pe,dn="__reactHandles$"+pe,er="__reactResources$"+pe,bs="__reactMarker$"+pe;function Ms(t){delete t[ot],delete t[Rt],delete t[_t],delete t[bt],delete t[dn]}function Cn(t){var r=t[ot];if(r)return r;for(var o=t.parentNode;o;){if(r=o[ut]||o[ot]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=F0(t);t!==null;){if(o=t[ot])return o;t=F0(t)}return r}t=o,o=t.parentNode}return null}function F(t){if(t=t[ot]||t[ut]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function ue(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(i(33))}function T(t){var r=t[er];return r||(r=t[er]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function C(t){t[bs]=!0}var K=new Set,ee={};function Ue(t,r){Ve(t,r),Ve(t+"Capture",r)}function Ve(t,r){for(ee[t]=r,t=0;t<r.length;t++)K.add(r[t])}var Pe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vt={},kt={};function H(t){return ft.call(kt,t)?!0:ft.call(Vt,t)?!1:Pe.test(t)?kt[t]=!0:(Vt[t]=!0,!1)}function de(t,r,o){if(H(r))if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+o)}}function re(t,r,o){if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+o)}}function Ce(t,r,o,c){if(c===null)t.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(r,o,""+c)}}function De(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rt(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function At(t,r,o){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return f.call(this)},set:function(b){o=""+b,m.call(this,b)}}),Object.defineProperty(t,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function ct(t){if(!t._valueTracker){var r=rt(t)?"checked":"value";t._valueTracker=At(t,r,""+t[r])}}function tn(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return t&&(c=rt(t)?t.checked?"true":"false":t.value),t=c,t!==o?(r.setValue(t),!0):!1}function Rn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var fn=/[\n"\\]/g;function mn(t){return t.replace(fn,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function xr(t,r,o,c,f,m,b,S){t.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?t.type=b:t.removeAttribute("type"),r!=null?b==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+De(r)):t.value!==""+De(r)&&(t.value=""+De(r)):b!=="submit"&&b!=="reset"||t.removeAttribute("value"),r!=null?Jr(t,b,De(r)):o!=null?Jr(t,b,De(o)):c!=null&&t.removeAttribute("value"),f==null&&m!=null&&(t.defaultChecked=!!m),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+De(S):t.removeAttribute("name")}function La(t,r,o,c,f,m,b,S){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ct(t);return}o=o!=null?""+De(o):"",r=r!=null?""+De(r):o,S||r===t.value||(t.value=r),t.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=S?t.checked:!!c,t.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(t.name=b),ct(t)}function Jr(t,r,o){r==="number"&&Rn(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function wr(t,r,o,c){if(t=t.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<t.length;o++)f=r.hasOwnProperty("$"+t[o].value),t[o].selected!==f&&(t[o].selected=f),f&&c&&(t[o].defaultSelected=!0)}else{for(o=""+De(o),r=null,f=0;f<t.length;f++){if(t[f].value===o){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}r!==null||t[f].disabled||(r=t[f])}r!==null&&(r.selected=!0)}}function pn(t,r,o){if(r!=null&&(r=""+De(r),r!==t.value&&(t.value=r),o==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=o!=null?""+De(o):""}function $n(t,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(wt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=De(r),t.defaultValue=o,c=t.textContent,c===o&&c!==""&&c!==null&&(t.value=c),ct(t)}function Bn(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var _r=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cr(t,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":c?t.setProperty(r,o):typeof o!="number"||o===0||_r.has(r)?r==="float"?t.cssFloat=o:t[r]=(""+o).trim():t[r]=o+"px"}function Cs(t,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(t=t.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&cr(t,f,c)}else for(var m in r)r.hasOwnProperty(m)&&cr(t,m,r[m])}function Ds(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pa(t){return kr.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function A(){}var J=null;function Me(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Xe=null,mt=null;function it(t){var r=F(t);if(r&&(t=r.stateNode)){var o=t[Rt]||null;e:switch(t=r.stateNode,r.type){case"input":if(xr(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+mn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==t&&c.form===t.form){var f=c[Rt]||null;if(!f)throw Error(i(90));xr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===t.form&&tn(c)}break e;case"textarea":pn(t,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&wr(t,!!o.multiple,r,!1)}}}var yt=!1;function Pt(t,r,o){if(yt)return t(r,o);yt=!0;try{var c=t(r);return c}finally{if(yt=!1,(Xe!==null||mt!==null)&&(Nh(),Xe&&(r=Xe,t=mt,mt=Xe=null,it(r),t)))for(r=0;r<t.length;r++)it(t[r])}}function Mt(t,r){var o=t.stateNode;if(o===null)return null;var c=o[Rt]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var zt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yt=!1;if(zt)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){Yt=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{Yt=!1}var vn=null,Wn=null,Jn=null;function ns(){if(Jn)return Jn;var t,r=Wn,o=r.length,c,f="value"in vn?vn.value:vn.textContent,m=f.length;for(t=0;t<o&&r[t]===f[t];t++);var b=o-t;for(c=1;c<=b&&r[o-c]===f[m-c];c++);return Jn=f.slice(t,1<c?1-c:void 0)}function xs(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function ur(){return!0}function $s(){return!1}function Gn(t){function r(o,c,f,m,b){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=b,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(o=t[S],this[S]=o?o(m):m[S]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ur:$s,this.isPropagationStopped=$s,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ur)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ur)},persist:function(){},isPersistent:ur}),r}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tr=Gn(hr),fs=k({},hr,{view:0,detail:0}),Ws=Gn(fs),Gs,Tr,jr,fi=k({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mi,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jr&&(jr&&t.type==="mousemove"?(Gs=t.screenX-jr.screenX,Tr=t.screenY-jr.screenY):Tr=Gs=0,jr=t),Gs)},movementY:function(t){return"movementY"in t?t.movementY:Tr}}),uo=Gn(fi),Or=k({},fi,{dataTransfer:0}),Zr=Gn(Or),ea=k({},fs,{relatedTarget:0}),ho=Gn(ea),tc=k({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vu=Gn(tc),Yo=k({},hr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Bu=Gn(Yo),Uu=k({},hr,{data:0}),ga=Gn(Uu),zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hu(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=qu[t])?!!r[t]:!1}function mi(){return Hu}var nr=k({},fs,{key:function(t){if(t.key){var r=zu[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=xs(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mi,charCode:function(t){return t.type==="keypress"?xs(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xs(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$u=Gn(nr),Wu=k({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oa=Gn(Wu),d=k({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mi}),v=Gn(d),_=k({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=Gn(_),Z=k({},fi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),he=Gn(Z),$e=k({},hr,{newState:0,oldState:0}),Qt=Gn($e),ms=[9,13,27,32],jn=zt&&"CompositionEvent"in window,Zn=null;zt&&"documentMode"in document&&(Zn=document.documentMode);var Vr=zt&&"TextEvent"in window&&!Zn,ya=zt&&(!jn||Zn&&8<Zn&&11>=Zn),ta=" ",na=!1;function fo(t,r){switch(t){case"keyup":return ms.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qo(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xo=!1;function Sk(t,r){switch(t){case"compositionend":return Qo(r);case"keypress":return r.which!==32?null:(na=!0,ta);case"textInput":return t=r.data,t===ta&&na?null:t;default:return null}}function Nk(t,r){if(Xo)return t==="compositionend"||!jn&&fo(t,r)?(t=ns(),Jn=Wn=vn=null,Xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ya&&r.locale!=="ko"?null:r.data;default:return null}}var Ck={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!Ck[t.type]:r==="textarea"}function Wy(t,r,o,c){Xe?mt?mt.push(c):mt=[c]:Xe=c,r=Ph(r,"onChange"),0<r.length&&(o=new tr("onChange","change",null,o,c),t.push({event:o,listeners:r}))}var nc=null,sc=null;function Rk(t){N0(t,0)}function Gu(t){var r=ue(t);if(tn(r))return t}function Gy(t,r){if(t==="change")return r}var Ky=!1;if(zt){var bf;if(zt){var xf="oninput"in document;if(!xf){var Yy=document.createElement("div");Yy.setAttribute("oninput","return;"),xf=typeof Yy.oninput=="function"}bf=xf}else bf=!1;Ky=bf&&(!document.documentMode||9<document.documentMode)}function Qy(){nc&&(nc.detachEvent("onpropertychange",Xy),sc=nc=null)}function Xy(t){if(t.propertyName==="value"&&Gu(sc)){var r=[];Wy(r,sc,t,Me(t)),Pt(Rk,r)}}function Ak(t,r,o){t==="focusin"?(Qy(),nc=r,sc=o,nc.attachEvent("onpropertychange",Xy)):t==="focusout"&&Qy()}function Ik(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gu(sc)}function Mk(t,r){if(t==="click")return Gu(r)}function Dk(t,r){if(t==="input"||t==="change")return Gu(r)}function Pk(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Er=typeof Object.is=="function"?Object.is:Pk;function rc(t,r){if(Er(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!ft.call(r,f)||!Er(t[f],r[f]))return!1}return!0}function Jy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Zy(t,r){var o=Jy(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=r&&c>=r)return{node:o,offset:r-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Jy(o)}}function ev(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?ev(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function tv(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Rn(t.document);r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)t=r.contentWindow;else break;r=Rn(t.document)}return r}function wf(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var Lk=zt&&"documentMode"in document&&11>=document.documentMode,Jo=null,_f=null,ac=null,kf=!1;function nv(t,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;kf||Jo==null||Jo!==Rn(c)||(c=Jo,"selectionStart"in c&&wf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ac&&rc(ac,c)||(ac=c,c=Ph(_f,"onSelect"),0<c.length&&(r=new tr("onSelect","select",null,r,o),t.push({event:r,listeners:c}),r.target=Jo)))}function mo(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var Zo={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionrun:mo("Transition","TransitionRun"),transitionstart:mo("Transition","TransitionStart"),transitioncancel:mo("Transition","TransitionCancel"),transitionend:mo("Transition","TransitionEnd")},Tf={},sv={};zt&&(sv=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function po(t){if(Tf[t])return Tf[t];if(!Zo[t])return t;var r=Zo[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in sv)return Tf[t]=r[o];return t}var rv=po("animationend"),av=po("animationiteration"),iv=po("animationstart"),Ok=po("transitionrun"),Vk=po("transitionstart"),Bk=po("transitioncancel"),ov=po("transitionend"),lv=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function sa(t,r){lv.set(t,r),Ue(r,[t])}var Ku=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Br=[],el=0,Ef=0;function Yu(){for(var t=el,r=Ef=el=0;r<t;){var o=Br[r];Br[r++]=null;var c=Br[r];Br[r++]=null;var f=Br[r];Br[r++]=null;var m=Br[r];if(Br[r++]=null,c!==null&&f!==null){var b=c.pending;b===null?f.next=f:(f.next=b.next,b.next=f),c.pending=f}m!==0&&cv(o,f,m)}}function Qu(t,r,o,c){Br[el++]=t,Br[el++]=r,Br[el++]=o,Br[el++]=c,Ef|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Sf(t,r,o,c){return Qu(t,r,o,c),Xu(t)}function go(t,r){return Qu(t,null,null,r),Xu(t)}function cv(t,r,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=t.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(f=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,f&&r!==null&&(f=31-qe(o),t=m.hiddenUpdates,c=t[f],c===null?t[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function Xu(t){if(50<Sc)throw Sc=0,Lm=null,Error(i(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var tl={};function Uk(t,r,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(t,r,o,c){return new Uk(t,r,o,c)}function Nf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Va(t,r){var o=t.alternate;return o===null?(o=Sr(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function uv(t,r){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,r=o.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Ju(t,r,o,c,f,m){var b=0;if(c=t,typeof t=="function")Nf(t)&&(b=1);else if(typeof t=="string")b=$T(t,o,Ne.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case R:return t=Sr(31,o,r,f),t.elementType=R,t.lanes=m,t;case U:return yo(o.children,f,m,r);case V:b=8,f|=24;break;case te:return t=Sr(12,o,r,f|2),t.elementType=te,t.lanes=m,t;case ze:return t=Sr(13,o,r,f),t.elementType=ze,t.lanes=m,t;case Le:return t=Sr(19,o,r,f),t.elementType=Le,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case me:b=10;break e;case X:b=9;break e;case Ee:b=11;break e;case I:b=14;break e;case j:b=16,c=null;break e}b=29,o=Error(i(130,t===null?"null":typeof t,"")),c=null}return r=Sr(b,o,r,f),r.elementType=t,r.type=c,r.lanes=m,r}function yo(t,r,o,c){return t=Sr(7,t,c,r),t.lanes=o,t}function Cf(t,r,o){return t=Sr(6,t,null,r),t.lanes=o,t}function hv(t){var r=Sr(18,null,null,0);return r.stateNode=t,r}function Rf(t,r,o){return r=Sr(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var dv=new WeakMap;function Ur(t,r){if(typeof t=="object"&&t!==null){var o=dv.get(t);return o!==void 0?o:(r={value:t,source:r,stack:Bt(r)},dv.set(t,r),r)}return{value:t,source:r,stack:Bt(r)}}var nl=[],sl=0,Zu=null,ic=0,zr=[],Fr=0,pi=null,va=1,ba="";function Ba(t,r){nl[sl++]=ic,nl[sl++]=Zu,Zu=t,ic=r}function fv(t,r,o){zr[Fr++]=va,zr[Fr++]=ba,zr[Fr++]=pi,pi=t;var c=va;t=ba;var f=32-qe(c)-1;c&=~(1<<f),o+=1;var m=32-qe(r)+f;if(30<m){var b=f-f%5;m=(c&(1<<b)-1).toString(32),c>>=b,f-=b,va=1<<32-qe(r)+f|o<<f|c,ba=m+t}else va=1<<m|o<<f|c,ba=t}function Af(t){t.return!==null&&(Ba(t,1),fv(t,1,0))}function If(t){for(;t===Zu;)Zu=nl[--sl],nl[sl]=null,ic=nl[--sl],nl[sl]=null;for(;t===pi;)pi=zr[--Fr],zr[Fr]=null,ba=zr[--Fr],zr[Fr]=null,va=zr[--Fr],zr[Fr]=null}function mv(t,r){zr[Fr++]=va,zr[Fr++]=ba,zr[Fr++]=pi,va=r.id,ba=r.overflow,pi=t}var Vs=null,Kn=null,gn=!1,gi=null,qr=!1,Mf=Error(i(519));function yi(t){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw oc(Ur(r,t)),Mf}function pv(t){var r=t.stateNode,o=t.type,c=t.memoizedProps;switch(r[ot]=t,r[Rt]=c,o){case"dialog":rn("cancel",r),rn("close",r);break;case"iframe":case"object":case"embed":rn("load",r);break;case"video":case"audio":for(o=0;o<Cc.length;o++)rn(Cc[o],r);break;case"source":rn("error",r);break;case"img":case"image":case"link":rn("error",r),rn("load",r);break;case"details":rn("toggle",r);break;case"input":rn("invalid",r),La(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":rn("invalid",r);break;case"textarea":rn("invalid",r),$n(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||I0(r.textContent,o)?(c.popover!=null&&(rn("beforetoggle",r),rn("toggle",r)),c.onScroll!=null&&rn("scroll",r),c.onScrollEnd!=null&&rn("scrollend",r),c.onClick!=null&&(r.onclick=A),r=!0):r=!1,r||yi(t,!0)}function gv(t){for(Vs=t.return;Vs;)switch(Vs.tag){case 5:case 31:case 13:qr=!1;return;case 27:case 3:qr=!0;return;default:Vs=Vs.return}}function rl(t){if(t!==Vs)return!1;if(!gn)return gv(t),gn=!0,!1;var r=t.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||Xm(t.type,t.memoizedProps)),o=!o),o&&Kn&&yi(t),gv(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));Kn=z0(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));Kn=z0(t)}else r===27?(r=Kn,Ai(t.type)?(t=np,np=null,Kn=t):Kn=r):Kn=Vs?$r(t.stateNode.nextSibling):null;return!0}function vo(){Kn=Vs=null,gn=!1}function Df(){var t=gi;return t!==null&&(pr===null?pr=t:pr.push.apply(pr,t),gi=null),t}function oc(t){gi===null?gi=[t]:gi.push(t)}var Pf=P(null),bo=null,Ua=null;function vi(t,r,o){ye(Pf,r._currentValue),r._currentValue=o}function za(t){t._currentValue=Pf.current,W(Pf)}function Lf(t,r,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===o)break;t=t.return}}function Of(t,r,o,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var m=f.dependencies;if(m!==null){var b=f.child;m=m.firstContext;e:for(;m!==null;){var S=m;m=f;for(var B=0;B<r.length;B++)if(S.context===r[B]){m.lanes|=o,S=m.alternate,S!==null&&(S.lanes|=o),Lf(m.return,o,t),c||(b=null);break e}m=S.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(i(341));b.lanes|=o,m=b.alternate,m!==null&&(m.lanes|=o),Lf(b,o,t),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===t){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function al(t,r,o,c){t=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var S=f.type;Er(f.pendingProps.value,b.value)||(t!==null?t.push(S):t=[S])}}else if(f===et.current){if(b=f.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(Dc):t=[Dc])}f=f.return}t!==null&&Of(r,t,o,c),r.flags|=262144}function eh(t){for(t=t.firstContext;t!==null;){if(!Er(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function xo(t){bo=t,Ua=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Bs(t){return yv(bo,t)}function th(t,r){return bo===null&&xo(t),yv(t,r)}function yv(t,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Ua===null){if(t===null)throw Error(i(308));Ua=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Ua=Ua.next=r;return o}var zk=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(o,c){t.push(c)}};this.abort=function(){r.aborted=!0,t.forEach(function(o){return o()})}},Fk=s.unstable_scheduleCallback,qk=s.unstable_NormalPriority,ws={$$typeof:me,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vf(){return{controller:new zk,data:new Map,refCount:0}}function lc(t){t.refCount--,t.refCount===0&&Fk(qk,function(){t.controller.abort()})}var cc=null,Bf=0,il=0,ol=null;function Hk(t,r){if(cc===null){var o=cc=[];Bf=0,il=Fm(),ol={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Bf++,r.then(vv,vv),r}function vv(){if(--Bf===0&&cc!==null){ol!==null&&(ol.status="fulfilled");var t=cc;cc=null,il=0,ol=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function $k(t,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return t.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var bv=Y.S;Y.S=function(t,r){n0=pt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Hk(t,r),bv!==null&&bv(t,r)};var wo=P(null);function Uf(){var t=wo.current;return t!==null?t:Un.pooledCache}function nh(t,r){r===null?ye(wo,wo.current):ye(wo,r.pool)}function xv(){var t=Uf();return t===null?null:{parent:ws._currentValue,pool:t}}var ll=Error(i(460)),zf=Error(i(474)),sh=Error(i(542)),rh={then:function(){}};function wv(t){return t=t.status,t==="fulfilled"||t==="rejected"}function _v(t,r,o){switch(o=t[o],o===void 0?t.push(r):o!==r&&(r.then(A,A),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Tv(t),t;default:if(typeof r.status=="string")r.then(A,A);else{if(t=Un,t!==null&&100<t.shellSuspendCounter)throw Error(i(482));t=r,t.status="pending",t.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Tv(t),t}throw ko=r,ll}}function _o(t){try{var r=t._init;return r(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ko=o,ll):o}}var ko=null;function kv(){if(ko===null)throw Error(i(459));var t=ko;return ko=null,t}function Tv(t){if(t===ll||t===sh)throw Error(i(483))}var cl=null,uc=0;function ah(t){var r=uc;return uc+=1,cl===null&&(cl=[]),_v(cl,t,r)}function hc(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function ih(t,r){throw r.$$typeof===E?Error(i(525)):(t=Object.prototype.toString.call(r),Error(i(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function jv(t){function r(Q,$){if(t){var ne=Q.deletions;ne===null?(Q.deletions=[$],Q.flags|=16):ne.push($)}}function o(Q,$){if(!t)return null;for(;$!==null;)r(Q,$),$=$.sibling;return null}function c(Q){for(var $=new Map;Q!==null;)Q.key!==null?$.set(Q.key,Q):$.set(Q.index,Q),Q=Q.sibling;return $}function f(Q,$){return Q=Va(Q,$),Q.index=0,Q.sibling=null,Q}function m(Q,$,ne){return Q.index=ne,t?(ne=Q.alternate,ne!==null?(ne=ne.index,ne<$?(Q.flags|=67108866,$):ne):(Q.flags|=67108866,$)):(Q.flags|=1048576,$)}function b(Q){return t&&Q.alternate===null&&(Q.flags|=67108866),Q}function S(Q,$,ne,je){return $===null||$.tag!==6?($=Cf(ne,Q.mode,je),$.return=Q,$):($=f($,ne),$.return=Q,$)}function B(Q,$,ne,je){var Tt=ne.type;return Tt===U?be(Q,$,ne.props.children,je,ne.key):$!==null&&($.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===j&&_o(Tt)===$.type)?($=f($,ne.props),hc($,ne),$.return=Q,$):($=Ju(ne.type,ne.key,ne.props,null,Q.mode,je),hc($,ne),$.return=Q,$)}function se(Q,$,ne,je){return $===null||$.tag!==4||$.stateNode.containerInfo!==ne.containerInfo||$.stateNode.implementation!==ne.implementation?($=Rf(ne,Q.mode,je),$.return=Q,$):($=f($,ne.children||[]),$.return=Q,$)}function be(Q,$,ne,je,Tt){return $===null||$.tag!==7?($=yo(ne,Q.mode,je,Tt),$.return=Q,$):($=f($,ne),$.return=Q,$)}function Re(Q,$,ne){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Cf(""+$,Q.mode,ne),$.return=Q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case O:return ne=Ju($.type,$.key,$.props,null,Q.mode,ne),hc(ne,$),ne.return=Q,ne;case G:return $=Rf($,Q.mode,ne),$.return=Q,$;case j:return $=_o($),Re(Q,$,ne)}if(wt($)||z($))return $=yo($,Q.mode,ne,null),$.return=Q,$;if(typeof $.then=="function")return Re(Q,ah($),ne);if($.$$typeof===me)return Re(Q,th(Q,$),ne);ih(Q,$)}return null}function ie(Q,$,ne,je){var Tt=$!==null?$.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Tt!==null?null:S(Q,$,""+ne,je);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case O:return ne.key===Tt?B(Q,$,ne,je):null;case G:return ne.key===Tt?se(Q,$,ne,je):null;case j:return ne=_o(ne),ie(Q,$,ne,je)}if(wt(ne)||z(ne))return Tt!==null?null:be(Q,$,ne,je,null);if(typeof ne.then=="function")return ie(Q,$,ah(ne),je);if(ne.$$typeof===me)return ie(Q,$,th(Q,ne),je);ih(Q,ne)}return null}function fe(Q,$,ne,je,Tt){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return Q=Q.get(ne)||null,S($,Q,""+je,Tt);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case O:return Q=Q.get(je.key===null?ne:je.key)||null,B($,Q,je,Tt);case G:return Q=Q.get(je.key===null?ne:je.key)||null,se($,Q,je,Tt);case j:return je=_o(je),fe(Q,$,ne,je,Tt)}if(wt(je)||z(je))return Q=Q.get(ne)||null,be($,Q,je,Tt,null);if(typeof je.then=="function")return fe(Q,$,ne,ah(je),Tt);if(je.$$typeof===me)return fe(Q,$,ne,th($,je),Tt);ih($,je)}return null}function dt(Q,$,ne,je){for(var Tt=null,_n=null,vt=$,Zt=$=0,on=null;vt!==null&&Zt<ne.length;Zt++){vt.index>Zt?(on=vt,vt=null):on=vt.sibling;var kn=ie(Q,vt,ne[Zt],je);if(kn===null){vt===null&&(vt=on);break}t&&vt&&kn.alternate===null&&r(Q,vt),$=m(kn,$,Zt),_n===null?Tt=kn:_n.sibling=kn,_n=kn,vt=on}if(Zt===ne.length)return o(Q,vt),gn&&Ba(Q,Zt),Tt;if(vt===null){for(;Zt<ne.length;Zt++)vt=Re(Q,ne[Zt],je),vt!==null&&($=m(vt,$,Zt),_n===null?Tt=vt:_n.sibling=vt,_n=vt);return gn&&Ba(Q,Zt),Tt}for(vt=c(vt);Zt<ne.length;Zt++)on=fe(vt,Q,Zt,ne[Zt],je),on!==null&&(t&&on.alternate!==null&&vt.delete(on.key===null?Zt:on.key),$=m(on,$,Zt),_n===null?Tt=on:_n.sibling=on,_n=on);return t&&vt.forEach(function(Li){return r(Q,Li)}),gn&&Ba(Q,Zt),Tt}function It(Q,$,ne,je){if(ne==null)throw Error(i(151));for(var Tt=null,_n=null,vt=$,Zt=$=0,on=null,kn=ne.next();vt!==null&&!kn.done;Zt++,kn=ne.next()){vt.index>Zt?(on=vt,vt=null):on=vt.sibling;var Li=ie(Q,vt,kn.value,je);if(Li===null){vt===null&&(vt=on);break}t&&vt&&Li.alternate===null&&r(Q,vt),$=m(Li,$,Zt),_n===null?Tt=Li:_n.sibling=Li,_n=Li,vt=on}if(kn.done)return o(Q,vt),gn&&Ba(Q,Zt),Tt;if(vt===null){for(;!kn.done;Zt++,kn=ne.next())kn=Re(Q,kn.value,je),kn!==null&&($=m(kn,$,Zt),_n===null?Tt=kn:_n.sibling=kn,_n=kn);return gn&&Ba(Q,Zt),Tt}for(vt=c(vt);!kn.done;Zt++,kn=ne.next())kn=fe(vt,Q,Zt,kn.value,je),kn!==null&&(t&&kn.alternate!==null&&vt.delete(kn.key===null?Zt:kn.key),$=m(kn,$,Zt),_n===null?Tt=kn:_n.sibling=kn,_n=kn);return t&&vt.forEach(function(nj){return r(Q,nj)}),gn&&Ba(Q,Zt),Tt}function On(Q,$,ne,je){if(typeof ne=="object"&&ne!==null&&ne.type===U&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case O:e:{for(var Tt=ne.key;$!==null;){if($.key===Tt){if(Tt=ne.type,Tt===U){if($.tag===7){o(Q,$.sibling),je=f($,ne.props.children),je.return=Q,Q=je;break e}}else if($.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===j&&_o(Tt)===$.type){o(Q,$.sibling),je=f($,ne.props),hc(je,ne),je.return=Q,Q=je;break e}o(Q,$);break}else r(Q,$);$=$.sibling}ne.type===U?(je=yo(ne.props.children,Q.mode,je,ne.key),je.return=Q,Q=je):(je=Ju(ne.type,ne.key,ne.props,null,Q.mode,je),hc(je,ne),je.return=Q,Q=je)}return b(Q);case G:e:{for(Tt=ne.key;$!==null;){if($.key===Tt)if($.tag===4&&$.stateNode.containerInfo===ne.containerInfo&&$.stateNode.implementation===ne.implementation){o(Q,$.sibling),je=f($,ne.children||[]),je.return=Q,Q=je;break e}else{o(Q,$);break}else r(Q,$);$=$.sibling}je=Rf(ne,Q.mode,je),je.return=Q,Q=je}return b(Q);case j:return ne=_o(ne),On(Q,$,ne,je)}if(wt(ne))return dt(Q,$,ne,je);if(z(ne)){if(Tt=z(ne),typeof Tt!="function")throw Error(i(150));return ne=Tt.call(ne),It(Q,$,ne,je)}if(typeof ne.then=="function")return On(Q,$,ah(ne),je);if(ne.$$typeof===me)return On(Q,$,th(Q,ne),je);ih(Q,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,$!==null&&$.tag===6?(o(Q,$.sibling),je=f($,ne),je.return=Q,Q=je):(o(Q,$),je=Cf(ne,Q.mode,je),je.return=Q,Q=je),b(Q)):o(Q,$)}return function(Q,$,ne,je){try{uc=0;var Tt=On(Q,$,ne,je);return cl=null,Tt}catch(vt){if(vt===ll||vt===sh)throw vt;var _n=Sr(29,vt,null,Q.mode);return _n.lanes=je,_n.return=Q,_n}}}var To=jv(!0),Ev=jv(!1),bi=!1;function Ff(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qf(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function xi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function wi(t,r,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(En&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Xu(t),cv(t,null,o),r}return Qu(t,c,r,o),Xu(t)}function dc(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,Is(t,o)}}function Hf(t,r){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=b:m=m.next=b,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}var $f=!1;function fc(){if($f){var t=ol;if(t!==null)throw t}}function mc(t,r,o,c){$f=!1;var f=t.updateQueue;bi=!1;var m=f.firstBaseUpdate,b=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var B=S,se=B.next;B.next=null,b===null?m=se:b.next=se,b=B;var be=t.alternate;be!==null&&(be=be.updateQueue,S=be.lastBaseUpdate,S!==b&&(S===null?be.firstBaseUpdate=se:S.next=se,be.lastBaseUpdate=B))}if(m!==null){var Re=f.baseState;b=0,be=se=B=null,S=m;do{var ie=S.lane&-536870913,fe=ie!==S.lane;if(fe?(an&ie)===ie:(c&ie)===ie){ie!==0&&ie===il&&($f=!0),be!==null&&(be=be.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var dt=t,It=S;ie=r;var On=o;switch(It.tag){case 1:if(dt=It.payload,typeof dt=="function"){Re=dt.call(On,Re,ie);break e}Re=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=It.payload,ie=typeof dt=="function"?dt.call(On,Re,ie):dt,ie==null)break e;Re=k({},Re,ie);break e;case 2:bi=!0}}ie=S.callback,ie!==null&&(t.flags|=64,fe&&(t.flags|=8192),fe=f.callbacks,fe===null?f.callbacks=[ie]:fe.push(ie))}else fe={lane:ie,tag:S.tag,payload:S.payload,callback:S.callback,next:null},be===null?(se=be=fe,B=Re):be=be.next=fe,b|=ie;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;fe=S,S=fe.next,fe.next=null,f.lastBaseUpdate=fe,f.shared.pending=null}}while(!0);be===null&&(B=Re),f.baseState=B,f.firstBaseUpdate=se,f.lastBaseUpdate=be,m===null&&(f.shared.lanes=0),Ei|=b,t.lanes=b,t.memoizedState=Re}}function Sv(t,r){if(typeof t!="function")throw Error(i(191,t));t.call(r)}function Nv(t,r){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Sv(o[t],r)}var ul=P(null),oh=P(0);function Cv(t,r){t=Qa,ye(oh,t),ye(ul,r),Qa=t|r.baseLanes}function Wf(){ye(oh,Qa),ye(ul,ul.current)}function Gf(){Qa=oh.current,W(ul),W(oh)}var Nr=P(null),Hr=null;function _i(t){var r=t.alternate;ye(ps,ps.current&1),ye(Nr,t),Hr===null&&(r===null||ul.current!==null||r.memoizedState!==null)&&(Hr=t)}function Kf(t){ye(ps,ps.current),ye(Nr,t),Hr===null&&(Hr=t)}function Rv(t){t.tag===22?(ye(ps,ps.current),ye(Nr,t),Hr===null&&(Hr=t)):ki()}function ki(){ye(ps,ps.current),ye(Nr,Nr.current)}function Cr(t){W(Nr),Hr===t&&(Hr=null),W(ps)}var ps=P(0);function lh(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ep(o)||tp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Fa=0,Xt=null,Pn=null,_s=null,ch=!1,hl=!1,jo=!1,uh=0,pc=0,dl=null,Wk=0;function as(){throw Error(i(321))}function Yf(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!Er(t[o],r[o]))return!1;return!0}function Qf(t,r,o,c,f,m){return Fa=m,Xt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Y.H=t===null||t.memoizedState===null?fb:hm,jo=!1,m=o(c,f),jo=!1,hl&&(m=Iv(r,o,c,f)),Av(t),m}function Av(t){Y.H=vc;var r=Pn!==null&&Pn.next!==null;if(Fa=0,_s=Pn=Xt=null,ch=!1,pc=0,dl=null,r)throw Error(i(300));t===null||ks||(t=t.dependencies,t!==null&&eh(t)&&(ks=!0))}function Iv(t,r,o,c){Xt=t;var f=0;do{if(hl&&(dl=null),pc=0,hl=!1,25<=f)throw Error(i(301));if(f+=1,_s=Pn=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}Y.H=mb,m=r(o,c)}while(hl);return m}function Gk(){var t=Y.H,r=t.useState()[0];return r=typeof r.then=="function"?gc(r):r,t=t.useState()[0],(Pn!==null?Pn.memoizedState:null)!==t&&(Xt.flags|=1024),r}function Xf(){var t=uh!==0;return uh=0,t}function Jf(t,r,o){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~o}function Zf(t){if(ch){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}ch=!1}Fa=0,_s=Pn=Xt=null,hl=!1,pc=uh=0,dl=null}function sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?Xt.memoizedState=_s=t:_s=_s.next=t,_s}function gs(){if(Pn===null){var t=Xt.alternate;t=t!==null?t.memoizedState:null}else t=Pn.next;var r=_s===null?Xt.memoizedState:_s.next;if(r!==null)_s=r,Pn=t;else{if(t===null)throw Xt.alternate===null?Error(i(467)):Error(i(310));Pn=t,t={memoizedState:Pn.memoizedState,baseState:Pn.baseState,baseQueue:Pn.baseQueue,queue:Pn.queue,next:null},_s===null?Xt.memoizedState=_s=t:_s=_s.next=t}return _s}function hh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gc(t){var r=pc;return pc+=1,dl===null&&(dl=[]),t=_v(dl,t,r),r=Xt,(_s===null?r.memoizedState:_s.next)===null&&(r=r.alternate,Y.H=r===null||r.memoizedState===null?fb:hm),t}function dh(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return gc(t);if(t.$$typeof===me)return Bs(t)}throw Error(i(438,String(t)))}function em(t){var r=null,o=Xt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Xt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=hh(),Xt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(t),c=0;c<t;c++)o[c]=L;return r.index++,o}function qa(t,r){return typeof r=="function"?r(t):r}function fh(t){var r=gs();return tm(r,Pn,t)}function tm(t,r,o){var c=t.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=t.baseQueue,m=c.pending;if(m!==null){if(f!==null){var b=f.next;f.next=m.next,m.next=b}r.baseQueue=f=m,c.pending=null}if(m=t.baseState,f===null)t.memoizedState=m;else{r=f.next;var S=b=null,B=null,se=r,be=!1;do{var Re=se.lane&-536870913;if(Re!==se.lane?(an&Re)===Re:(Fa&Re)===Re){var ie=se.revertLane;if(ie===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),Re===il&&(be=!0);else if((Fa&ie)===ie){se=se.next,ie===il&&(be=!0);continue}else Re={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},B===null?(S=B=Re,b=m):B=B.next=Re,Xt.lanes|=ie,Ei|=ie;Re=se.action,jo&&o(m,Re),m=se.hasEagerState?se.eagerState:o(m,Re)}else ie={lane:Re,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},B===null?(S=B=ie,b=m):B=B.next=ie,Xt.lanes|=Re,Ei|=Re;se=se.next}while(se!==null&&se!==r);if(B===null?b=m:B.next=S,!Er(m,t.memoizedState)&&(ks=!0,be&&(o=ol,o!==null)))throw o;t.memoizedState=m,t.baseState=b,t.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function nm(t){var r=gs(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=t;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var b=f=f.next;do m=t(m,b.action),b=b.next;while(b!==f);Er(m,r.memoizedState)||(ks=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Mv(t,r,o){var c=Xt,f=gs(),m=gn;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var b=!Er((Pn||f).memoizedState,o);if(b&&(f.memoizedState=o,ks=!0),f=f.queue,am(Lv.bind(null,c,f,t),[t]),f.getSnapshot!==r||b||_s!==null&&_s.memoizedState.tag&1){if(c.flags|=2048,fl(9,{destroy:void 0},Pv.bind(null,c,f,o,r),null),Un===null)throw Error(i(349));m||(Fa&127)!==0||Dv(c,r,o)}return o}function Dv(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=Xt.updateQueue,r===null?(r=hh(),Xt.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function Pv(t,r,o,c){r.value=o,r.getSnapshot=c,Ov(r)&&Vv(t)}function Lv(t,r,o){return o(function(){Ov(r)&&Vv(t)})}function Ov(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!Er(t,o)}catch{return!0}}function Vv(t){var r=go(t,2);r!==null&&gr(r,t,2)}function sm(t){var r=sr();if(typeof t=="function"){var o=t;if(t=o(),jo){st(!0);try{o()}finally{st(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:t},r}function Bv(t,r,o,c){return t.baseState=o,tm(t,Pn,typeof c=="function"?c:qa)}function Kk(t,r,o,c,f){if(gh(t))throw Error(i(485));if(t=r.action,t!==null){var m={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){m.listeners.push(b)}};Y.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,Uv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function Uv(t,r){var o=r.action,c=r.payload,f=t.state;if(r.isTransition){var m=Y.T,b={};Y.T=b;try{var S=o(f,c),B=Y.S;B!==null&&B(b,S),zv(t,r,S)}catch(se){rm(t,r,se)}finally{m!==null&&b.types!==null&&(m.types=b.types),Y.T=m}}else try{m=o(f,c),zv(t,r,m)}catch(se){rm(t,r,se)}}function zv(t,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Fv(t,r,c)},function(c){return rm(t,r,c)}):Fv(t,r,o)}function Fv(t,r,o){r.status="fulfilled",r.value=o,qv(r),t.state=o,r=t.pending,r!==null&&(o=r.next,o===r?t.pending=null:(o=o.next,r.next=o,Uv(t,o)))}function rm(t,r,o){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,qv(r),r=r.next;while(r!==c)}t.action=null}function qv(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function Hv(t,r){return r}function $v(t,r){if(gn){var o=Un.formState;if(o!==null){e:{var c=Xt;if(gn){if(Kn){t:{for(var f=Kn,m=qr;f.nodeType!==8;){if(!m){f=null;break t}if(f=$r(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Kn=$r(f.nextSibling),c=f.data==="F!";break e}}yi(c)}c=!1}c&&(r=o[0])}}return o=sr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hv,lastRenderedState:r},o.queue=c,o=ub.bind(null,Xt,c),c.dispatch=o,c=sm(!1),m=um.bind(null,Xt,!1,c.queue),c=sr(),f={state:r,dispatch:null,action:t,pending:null},c.queue=f,o=Kk.bind(null,Xt,f,m,o),f.dispatch=o,c.memoizedState=t,[r,o,!1]}function Wv(t){var r=gs();return Gv(r,Pn,t)}function Gv(t,r,o){if(r=tm(t,r,Hv)[0],t=fh(qa)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=gc(r)}catch(b){throw b===ll?sh:b}else c=r;r=gs();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Xt.flags|=2048,fl(9,{destroy:void 0},Yk.bind(null,f,o),null)),[c,m,t]}function Yk(t,r){t.action=r}function Kv(t){var r=gs(),o=Pn;if(o!==null)return Gv(r,o,t);gs(),r=r.memoizedState,o=gs();var c=o.queue.dispatch;return o.memoizedState=t,[r,c,!1]}function fl(t,r,o,c){return t={tag:t,create:o,deps:c,inst:r,next:null},r=Xt.updateQueue,r===null&&(r=hh(),Xt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,r.lastEffect=t),t}function Yv(){return gs().memoizedState}function mh(t,r,o,c){var f=sr();Xt.flags|=t,f.memoizedState=fl(1|r,{destroy:void 0},o,c===void 0?null:c)}function ph(t,r,o,c){var f=gs();c=c===void 0?null:c;var m=f.memoizedState.inst;Pn!==null&&c!==null&&Yf(c,Pn.memoizedState.deps)?f.memoizedState=fl(r,m,o,c):(Xt.flags|=t,f.memoizedState=fl(1|r,m,o,c))}function Qv(t,r){mh(8390656,8,t,r)}function am(t,r){ph(2048,8,t,r)}function Qk(t){Xt.flags|=4;var r=Xt.updateQueue;if(r===null)r=hh(),Xt.updateQueue=r,r.events=[t];else{var o=r.events;o===null?r.events=[t]:o.push(t)}}function Xv(t){var r=gs().memoizedState;return Qk({ref:r,nextImpl:t}),function(){if((En&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Jv(t,r){return ph(4,2,t,r)}function Zv(t,r){return ph(4,4,t,r)}function eb(t,r){if(typeof r=="function"){t=t();var o=r(t);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function tb(t,r,o){o=o!=null?o.concat([t]):null,ph(4,4,eb.bind(null,r,t),o)}function im(){}function nb(t,r){var o=gs();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Yf(r,c[1])?c[0]:(o.memoizedState=[t,r],t)}function sb(t,r){var o=gs();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Yf(r,c[1]))return c[0];if(c=t(),jo){st(!0);try{t()}finally{st(!1)}}return o.memoizedState=[c,r],c}function om(t,r,o){return o===void 0||(Fa&1073741824)!==0&&(an&261930)===0?t.memoizedState=r:(t.memoizedState=o,t=r0(),Xt.lanes|=t,Ei|=t,o)}function rb(t,r,o,c){return Er(o,r)?o:ul.current!==null?(t=om(t,o,c),Er(t,r)||(ks=!0),t):(Fa&42)===0||(Fa&1073741824)!==0&&(an&261930)===0?(ks=!0,t.memoizedState=o):(t=r0(),Xt.lanes|=t,Ei|=t,r)}function ab(t,r,o,c,f){var m=Se.p;Se.p=m!==0&&8>m?m:8;var b=Y.T,S={};Y.T=S,um(t,!1,r,o);try{var B=f(),se=Y.S;if(se!==null&&se(S,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var be=$k(B,c);yc(t,r,be,Ir(t))}else yc(t,r,c,Ir(t))}catch(Re){yc(t,r,{then:function(){},status:"rejected",reason:Re},Ir())}finally{Se.p=m,b!==null&&S.types!==null&&(b.types=S.types),Y.T=b}}function Xk(){}function lm(t,r,o,c){if(t.tag!==5)throw Error(i(476));var f=ib(t).queue;ab(t,f,r,Oe,o===null?Xk:function(){return ob(t),o(c)})}function ib(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:Oe,baseState:Oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:Oe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:o},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function ob(t){var r=ib(t);r.next===null&&(r=t.alternate.memoizedState),yc(t,r.next.queue,{},Ir())}function cm(){return Bs(Dc)}function lb(){return gs().memoizedState}function cb(){return gs().memoizedState}function Jk(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ir();t=xi(o);var c=wi(r,t,o);c!==null&&(gr(c,r,o),dc(c,r,o)),r={cache:Vf()},t.payload=r;return}r=r.return}}function Zk(t,r,o){var c=Ir();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},gh(t)?hb(r,o):(o=Sf(t,r,o,c),o!==null&&(gr(o,t,c),db(o,r,c)))}function ub(t,r,o){var c=Ir();yc(t,r,o,c)}function yc(t,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(gh(t))hb(r,f);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var b=r.lastRenderedState,S=m(b,o);if(f.hasEagerState=!0,f.eagerState=S,Er(S,b))return Qu(t,r,f,0),Un===null&&Yu(),!1}catch{}if(o=Sf(t,r,f,c),o!==null)return gr(o,t,c),db(o,r,c),!0}return!1}function um(t,r,o,c){if(c={lane:2,revertLane:Fm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},gh(t)){if(r)throw Error(i(479))}else r=Sf(t,o,c,2),r!==null&&gr(r,t,2)}function gh(t){var r=t.alternate;return t===Xt||r!==null&&r===Xt}function hb(t,r){hl=ch=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function db(t,r,o){if((o&4194048)!==0){var c=r.lanes;c&=t.pendingLanes,o|=c,r.lanes=o,Is(t,o)}}var vc={readContext:Bs,use:dh,useCallback:as,useContext:as,useEffect:as,useImperativeHandle:as,useLayoutEffect:as,useInsertionEffect:as,useMemo:as,useReducer:as,useRef:as,useState:as,useDebugValue:as,useDeferredValue:as,useTransition:as,useSyncExternalStore:as,useId:as,useHostTransitionStatus:as,useFormState:as,useActionState:as,useOptimistic:as,useMemoCache:as,useCacheRefresh:as};vc.useEffectEvent=as;var fb={readContext:Bs,use:dh,useCallback:function(t,r){return sr().memoizedState=[t,r===void 0?null:r],t},useContext:Bs,useEffect:Qv,useImperativeHandle:function(t,r,o){o=o!=null?o.concat([t]):null,mh(4194308,4,eb.bind(null,r,t),o)},useLayoutEffect:function(t,r){return mh(4194308,4,t,r)},useInsertionEffect:function(t,r){mh(4,2,t,r)},useMemo:function(t,r){var o=sr();r=r===void 0?null:r;var c=t();if(jo){st(!0);try{t()}finally{st(!1)}}return o.memoizedState=[c,r],c},useReducer:function(t,r,o){var c=sr();if(o!==void 0){var f=o(r);if(jo){st(!0);try{o(r)}finally{st(!1)}}}else f=r;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=Zk.bind(null,Xt,t),[c.memoizedState,t]},useRef:function(t){var r=sr();return t={current:t},r.memoizedState=t},useState:function(t){t=sm(t);var r=t.queue,o=ub.bind(null,Xt,r);return r.dispatch=o,[t.memoizedState,o]},useDebugValue:im,useDeferredValue:function(t,r){var o=sr();return om(o,t,r)},useTransition:function(){var t=sm(!1);return t=ab.bind(null,Xt,t.queue,!0,!1),sr().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,o){var c=Xt,f=sr();if(gn){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Un===null)throw Error(i(349));(an&127)!==0||Dv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Qv(Lv.bind(null,c,m,t),[t]),c.flags|=2048,fl(9,{destroy:void 0},Pv.bind(null,c,m,o,r),null),o},useId:function(){var t=sr(),r=Un.identifierPrefix;if(gn){var o=ba,c=va;o=(c&~(1<<32-qe(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=uh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Wk++,r="_"+r+"r_"+o.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:cm,useFormState:$v,useActionState:$v,useOptimistic:function(t){var r=sr();r.memoizedState=r.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=um.bind(null,Xt,!0,o),o.dispatch=r,[t,r]},useMemoCache:em,useCacheRefresh:function(){return sr().memoizedState=Jk.bind(null,Xt)},useEffectEvent:function(t){var r=sr(),o={impl:t};return r.memoizedState=o,function(){if((En&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hm={readContext:Bs,use:dh,useCallback:nb,useContext:Bs,useEffect:am,useImperativeHandle:tb,useInsertionEffect:Jv,useLayoutEffect:Zv,useMemo:sb,useReducer:fh,useRef:Yv,useState:function(){return fh(qa)},useDebugValue:im,useDeferredValue:function(t,r){var o=gs();return rb(o,Pn.memoizedState,t,r)},useTransition:function(){var t=fh(qa)[0],r=gs().memoizedState;return[typeof t=="boolean"?t:gc(t),r]},useSyncExternalStore:Mv,useId:lb,useHostTransitionStatus:cm,useFormState:Wv,useActionState:Wv,useOptimistic:function(t,r){var o=gs();return Bv(o,Pn,t,r)},useMemoCache:em,useCacheRefresh:cb};hm.useEffectEvent=Xv;var mb={readContext:Bs,use:dh,useCallback:nb,useContext:Bs,useEffect:am,useImperativeHandle:tb,useInsertionEffect:Jv,useLayoutEffect:Zv,useMemo:sb,useReducer:nm,useRef:Yv,useState:function(){return nm(qa)},useDebugValue:im,useDeferredValue:function(t,r){var o=gs();return Pn===null?om(o,t,r):rb(o,Pn.memoizedState,t,r)},useTransition:function(){var t=nm(qa)[0],r=gs().memoizedState;return[typeof t=="boolean"?t:gc(t),r]},useSyncExternalStore:Mv,useId:lb,useHostTransitionStatus:cm,useFormState:Kv,useActionState:Kv,useOptimistic:function(t,r){var o=gs();return Pn!==null?Bv(o,Pn,t,r):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:em,useCacheRefresh:cb};mb.useEffectEvent=Xv;function dm(t,r,o,c){r=t.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var fm={enqueueSetState:function(t,r,o){t=t._reactInternals;var c=Ir(),f=xi(c);f.payload=r,o!=null&&(f.callback=o),r=wi(t,f,c),r!==null&&(gr(r,t,c),dc(r,t,c))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var c=Ir(),f=xi(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=wi(t,f,c),r!==null&&(gr(r,t,c),dc(r,t,c))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=Ir(),c=xi(o);c.tag=2,r!=null&&(c.callback=r),r=wi(t,c,o),r!==null&&(gr(r,t,o),dc(r,t,o))}};function pb(t,r,o,c,f,m,b){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,m,b):r.prototype&&r.prototype.isPureReactComponent?!rc(o,c)||!rc(f,m):!0}function gb(t,r,o,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==t&&fm.enqueueReplaceState(r,r.state,null)}function Eo(t,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(t=t.defaultProps){o===r&&(o=k({},o));for(var f in t)o[f]===void 0&&(o[f]=t[f])}return o}function yb(t){Ku(t)}function vb(t){console.error(t)}function bb(t){Ku(t)}function yh(t,r){try{var o=t.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function xb(t,r,o){try{var c=t.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function mm(t,r,o){return o=xi(o),o.tag=3,o.payload={element:null},o.callback=function(){yh(t,r)},o}function wb(t){return t=xi(t),t.tag=3,t}function _b(t,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;t.payload=function(){return f(m)},t.callback=function(){xb(r,o,c)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(t.callback=function(){xb(r,o,c),typeof f!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function eT(t,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&al(r,o,f,!0),o=Nr.current,o!==null){switch(o.tag){case 31:case 13:return Hr===null?Ch():o.alternate===null&&is===0&&(is=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===rh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Bm(t,c,f)),!1;case 22:return o.flags|=65536,c===rh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Bm(t,c,f)),!1}throw Error(i(435,o.tag))}return Bm(t,c,f),Ch(),!1}if(gn)return r=Nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Mf&&(t=Error(i(422),{cause:c}),oc(Ur(t,o)))):(c!==Mf&&(r=Error(i(423),{cause:c}),oc(Ur(r,o))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=Ur(c,o),f=mm(t.stateNode,c,f),Hf(t,f),is!==4&&(is=2)),!1;var m=Error(i(520),{cause:c});if(m=Ur(m,o),Ec===null?Ec=[m]:Ec.push(m),is!==4&&(is=2),r===null)return!0;c=Ur(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,t=f&-f,o.lanes|=t,t=mm(o.stateNode,c,t),Hf(o,t),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Si===null||!Si.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=wb(f),_b(f,t,o,c),Hf(o,f),!1}o=o.return}while(o!==null);return!1}var pm=Error(i(461)),ks=!1;function Us(t,r,o,c){r.child=t===null?Ev(r,null,o,c):To(r,t.child,o,c)}function kb(t,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var b={};for(var S in c)S!=="ref"&&(b[S]=c[S])}else b=c;return xo(r),c=Qf(t,r,o,b,m,f),S=Xf(),t!==null&&!ks?(Jf(t,r,f),Ha(t,r,f)):(gn&&S&&Af(r),r.flags|=1,Us(t,r,c,f),r.child)}function Tb(t,r,o,c,f){if(t===null){var m=o.type;return typeof m=="function"&&!Nf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,jb(t,r,m,c,f)):(t=Ju(o.type,null,c,r,r.mode,f),t.ref=r.ref,t.return=r,r.child=t)}if(m=t.child,!km(t,f)){var b=m.memoizedProps;if(o=o.compare,o=o!==null?o:rc,o(b,c)&&t.ref===r.ref)return Ha(t,r,f)}return r.flags|=1,t=Va(m,c),t.ref=r.ref,t.return=r,r.child=t}function jb(t,r,o,c,f){if(t!==null){var m=t.memoizedProps;if(rc(m,c)&&t.ref===r.ref)if(ks=!1,r.pendingProps=c=m,km(t,f))(t.flags&131072)!==0&&(ks=!0);else return r.lanes=t.lanes,Ha(t,r,f)}return gm(t,r,o,c,f)}function Eb(t,r,o,c){var f=c.children,m=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,t!==null){for(c=r.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Sb(t,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&nh(r,m!==null?m.cachePool:null),m!==null?Cv(r,m):Wf(),Rv(r);else return c=r.lanes=536870912,Sb(t,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(nh(r,m.cachePool),Cv(r,m),ki(),r.memoizedState=null):(t!==null&&nh(r,null),Wf(),ki());return Us(t,r,f,o),r.child}function bc(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Sb(t,r,o,c,f){var m=Uf();return m=m===null?null:{parent:ws._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},t!==null&&nh(r,null),Wf(),Rv(r),t!==null&&al(t,r,c,!0),r.childLanes=f,null}function vh(t,r){return r=xh({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function Nb(t,r,o){return To(r,t.child,null,o),t=vh(r,r.pendingProps),t.flags|=2,Cr(r),r.memoizedState=null,t}function tT(t,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(gn){if(c.mode==="hidden")return t=vh(r,c),r.lanes=536870912,bc(null,t);if(Kf(r),(t=Kn)?(t=U0(t,qr),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pi!==null?{id:va,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},o=hv(t),o.return=r,r.child=o,Vs=r,Kn=null)):t=null,t===null)throw yi(r);return r.lanes=536870912,null}return vh(r,c)}var m=t.memoizedState;if(m!==null){var b=m.dehydrated;if(Kf(r),f)if(r.flags&256)r.flags&=-257,r=Nb(t,r,o);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(i(558));else if(ks||al(t,r,o,!1),f=(o&t.childLanes)!==0,ks||f){if(c=Un,c!==null&&(b=Os(c,o),b!==0&&b!==m.retryLane))throw m.retryLane=b,go(t,b),gr(c,t,b),pm;Ch(),r=Nb(t,r,o)}else t=m.treeContext,Kn=$r(b.nextSibling),Vs=r,gn=!0,gi=null,qr=!1,t!==null&&mv(r,t),r=vh(r,c),r.flags|=4096;return r}return t=Va(t.child,{mode:c.mode,children:c.children}),t.ref=r.ref,r.child=t,t.return=r,t}function bh(t,r){var o=r.ref;if(o===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(t===null||t.ref!==o)&&(r.flags|=4194816)}}function gm(t,r,o,c,f){return xo(r),o=Qf(t,r,o,c,void 0,f),c=Xf(),t!==null&&!ks?(Jf(t,r,f),Ha(t,r,f)):(gn&&c&&Af(r),r.flags|=1,Us(t,r,o,f),r.child)}function Cb(t,r,o,c,f,m){return xo(r),r.updateQueue=null,o=Iv(r,c,o,f),Av(t),c=Xf(),t!==null&&!ks?(Jf(t,r,m),Ha(t,r,m)):(gn&&c&&Af(r),r.flags|=1,Us(t,r,o,m),r.child)}function Rb(t,r,o,c,f){if(xo(r),r.stateNode===null){var m=tl,b=o.contextType;typeof b=="object"&&b!==null&&(m=Bs(b)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=fm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Ff(r),b=o.contextType,m.context=typeof b=="object"&&b!==null?Bs(b):tl,m.state=r.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(dm(r,o,b,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(b=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),b!==m.state&&fm.enqueueReplaceState(m,m.state,null),mc(r,c,m,f),fc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(t===null){m=r.stateNode;var S=r.memoizedProps,B=Eo(o,S);m.props=B;var se=m.context,be=o.contextType;b=tl,typeof be=="object"&&be!==null&&(b=Bs(be));var Re=o.getDerivedStateFromProps;be=typeof Re=="function"||typeof m.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,be||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S||se!==b)&&gb(r,m,c,b),bi=!1;var ie=r.memoizedState;m.state=ie,mc(r,c,m,f),fc(),se=r.memoizedState,S||ie!==se||bi?(typeof Re=="function"&&(dm(r,o,Re,c),se=r.memoizedState),(B=bi||pb(r,o,B,c,ie,se,b))?(be||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=se),m.props=c,m.state=se,m.context=b,c=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,qf(t,r),b=r.memoizedProps,be=Eo(o,b),m.props=be,Re=r.pendingProps,ie=m.context,se=o.contextType,B=tl,typeof se=="object"&&se!==null&&(B=Bs(se)),S=o.getDerivedStateFromProps,(se=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(b!==Re||ie!==B)&&gb(r,m,c,B),bi=!1,ie=r.memoizedState,m.state=ie,mc(r,c,m,f),fc();var fe=r.memoizedState;b!==Re||ie!==fe||bi||t!==null&&t.dependencies!==null&&eh(t.dependencies)?(typeof S=="function"&&(dm(r,o,S,c),fe=r.memoizedState),(be=bi||pb(r,o,be,c,ie,fe,B)||t!==null&&t.dependencies!==null&&eh(t.dependencies))?(se||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,fe,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,fe,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||b===t.memoizedProps&&ie===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&ie===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=fe),m.props=c,m.state=fe,m.context=B,c=be):(typeof m.componentDidUpdate!="function"||b===t.memoizedProps&&ie===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&ie===t.memoizedState||(r.flags|=1024),c=!1)}return m=c,bh(t,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,t!==null&&c?(r.child=To(r,t.child,null,f),r.child=To(r,null,o,f)):Us(t,r,o,f),r.memoizedState=m.state,t=r.child):t=Ha(t,r,f),t}function Ab(t,r,o,c){return vo(),r.flags|=256,Us(t,r,o,c),r.child}var ym={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vm(t){return{baseLanes:t,cachePool:xv()}}function bm(t,r,o){return t=t!==null?t.childLanes&~o:0,r&&(t|=Ar),t}function Ib(t,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,b;if((b=m)||(b=t!==null&&t.memoizedState===null?!1:(ps.current&2)!==0),b&&(f=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,t===null){if(gn){if(f?_i(r):ki(),(t=Kn)?(t=U0(t,qr),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:pi!==null?{id:va,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},o=hv(t),o.return=r,r.child=o,Vs=r,Kn=null)):t=null,t===null)throw yi(r);return tp(t)?r.lanes=32:r.lanes=536870912,null}var S=c.children;return c=c.fallback,f?(ki(),f=r.mode,S=xh({mode:"hidden",children:S},f),c=yo(c,f,o,null),S.return=r,c.return=r,S.sibling=c,r.child=S,c=r.child,c.memoizedState=vm(o),c.childLanes=bm(t,b,o),r.memoizedState=ym,bc(null,c)):(_i(r),xm(r,S))}var B=t.memoizedState;if(B!==null&&(S=B.dehydrated,S!==null)){if(m)r.flags&256?(_i(r),r.flags&=-257,r=wm(t,r,o)):r.memoizedState!==null?(ki(),r.child=t.child,r.flags|=128,r=null):(ki(),S=c.fallback,f=r.mode,c=xh({mode:"visible",children:c.children},f),S=yo(S,f,o,null),S.flags|=2,c.return=r,S.return=r,c.sibling=S,r.child=c,To(r,t.child,null,o),c=r.child,c.memoizedState=vm(o),c.childLanes=bm(t,b,o),r.memoizedState=ym,r=bc(null,c));else if(_i(r),tp(S)){if(b=S.nextSibling&&S.nextSibling.dataset,b)var se=b.dgst;b=se,c=Error(i(419)),c.stack="",c.digest=b,oc({value:c,source:null,stack:null}),r=wm(t,r,o)}else if(ks||al(t,r,o,!1),b=(o&t.childLanes)!==0,ks||b){if(b=Un,b!==null&&(c=Os(b,o),c!==0&&c!==B.retryLane))throw B.retryLane=c,go(t,c),gr(b,t,c),pm;ep(S)||Ch(),r=wm(t,r,o)}else ep(S)?(r.flags|=192,r.child=t.child,r=null):(t=B.treeContext,Kn=$r(S.nextSibling),Vs=r,gn=!0,gi=null,qr=!1,t!==null&&mv(r,t),r=xm(r,c.children),r.flags|=4096);return r}return f?(ki(),S=c.fallback,f=r.mode,B=t.child,se=B.sibling,c=Va(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,se!==null?S=Va(se,S):(S=yo(S,f,o,null),S.flags|=2),S.return=r,c.return=r,c.sibling=S,r.child=c,bc(null,c),c=r.child,S=t.child.memoizedState,S===null?S=vm(o):(f=S.cachePool,f!==null?(B=ws._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=xv(),S={baseLanes:S.baseLanes|o,cachePool:f}),c.memoizedState=S,c.childLanes=bm(t,b,o),r.memoizedState=ym,bc(t.child,c)):(_i(r),o=t.child,t=o.sibling,o=Va(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,t!==null&&(b=r.deletions,b===null?(r.deletions=[t],r.flags|=16):b.push(t)),r.child=o,r.memoizedState=null,o)}function xm(t,r){return r=xh({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function xh(t,r){return t=Sr(22,t,null,r),t.lanes=0,t}function wm(t,r,o){return To(r,t.child,null,o),t=xm(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Mb(t,r,o){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),Lf(t.return,r,o)}function _m(t,r,o,c,f,m){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=o,b.tailMode=f,b.treeForkCount=m)}function Db(t,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var b=ps.current,S=(b&2)!==0;if(S?(b=b&1|2,r.flags|=128):b&=1,ye(ps,b),Us(t,r,c,o),c=gn?ic:0,!S&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Mb(t,o,r);else if(t.tag===19)Mb(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)t=o.alternate,t!==null&&lh(t)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),_m(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(t=f.alternate,t!==null&&lh(t)===null){r.child=f;break}t=f.sibling,f.sibling=o,o=f,f=t}_m(r,!0,o,null,m,c);break;case"together":_m(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Ha(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),Ei|=r.lanes,(o&r.childLanes)===0)if(t!==null){if(al(t,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(i(153));if(r.child!==null){for(t=r.child,o=Va(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=Va(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function km(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&eh(t)))}function nT(t,r,o){switch(r.tag){case 3:gt(r,r.stateNode.containerInfo),vi(r,ws,t.memoizedState.cache),vo();break;case 27:case 5:Ht(r);break;case 4:gt(r,r.stateNode.containerInfo);break;case 10:vi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Kf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(_i(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Ib(t,r,o):(_i(r),t=Ha(t,r,o),t!==null?t.sibling:null);_i(r);break;case 19:var f=(t.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(al(t,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Db(t,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ye(ps,ps.current),c)break;return null;case 22:return r.lanes=0,Eb(t,r,o,r.pendingProps);case 24:vi(r,ws,t.memoizedState.cache)}return Ha(t,r,o)}function Pb(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps)ks=!0;else{if(!km(t,o)&&(r.flags&128)===0)return ks=!1,nT(t,r,o);ks=(t.flags&131072)!==0}else ks=!1,gn&&(r.flags&1048576)!==0&&fv(r,ic,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(t=_o(r.elementType),r.type=t,typeof t=="function")Nf(t)?(c=Eo(t,c),r.tag=1,r=Rb(null,r,t,c,o)):(r.tag=0,r=gm(null,r,t,c,o));else{if(t!=null){var f=t.$$typeof;if(f===Ee){r.tag=11,r=kb(null,r,t,c,o);break e}else if(f===I){r.tag=14,r=Tb(null,r,t,c,o);break e}}throw r=Fe(t)||t,Error(i(306,r,""))}}return r;case 0:return gm(t,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Eo(c,r.pendingProps),Rb(t,r,c,f,o);case 3:e:{if(gt(r,r.stateNode.containerInfo),t===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,qf(t,r),mc(r,c,null,o);var b=r.memoizedState;if(c=b.cache,vi(r,ws,c),c!==m.cache&&Of(r,[ws],o,!0),fc(),c=b.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Ab(t,r,c,o);break e}else if(c!==f){f=Ur(Error(i(424)),r),oc(f),r=Ab(t,r,c,o);break e}else for(t=r.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Kn=$r(t.firstChild),Vs=r,gn=!0,gi=null,qr=!0,o=Ev(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(vo(),c===f){r=Ha(t,r,o);break e}Us(t,r,c,o)}r=r.child}return r;case 26:return bh(t,r),t===null?(o=W0(r.type,null,r.pendingProps,null))?r.memoizedState=o:gn||(o=r.type,t=r.pendingProps,c=Lh(ke.current).createElement(o),c[ot]=r,c[Rt]=t,zs(c,o,t),C(c),r.stateNode=c):r.memoizedState=W0(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return Ht(r),t===null&&gn&&(c=r.stateNode=q0(r.type,r.pendingProps,ke.current),Vs=r,qr=!0,f=Kn,Ai(r.type)?(np=f,Kn=$r(c.firstChild)):Kn=f),Us(t,r,r.pendingProps.children,o),bh(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&gn&&((f=c=Kn)&&(c=IT(c,r.type,r.pendingProps,qr),c!==null?(r.stateNode=c,Vs=r,Kn=$r(c.firstChild),qr=!1,f=!0):f=!1),f||yi(r)),Ht(r),f=r.type,m=r.pendingProps,b=t!==null?t.memoizedProps:null,c=m.children,Xm(f,m)?c=null:b!==null&&Xm(f,b)&&(r.flags|=32),r.memoizedState!==null&&(f=Qf(t,r,Gk,null,null,o),Dc._currentValue=f),bh(t,r),Us(t,r,c,o),r.child;case 6:return t===null&&gn&&((t=o=Kn)&&(o=MT(o,r.pendingProps,qr),o!==null?(r.stateNode=o,Vs=r,Kn=null,t=!0):t=!1),t||yi(r)),null;case 13:return Ib(t,r,o);case 4:return gt(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=To(r,null,c,o):Us(t,r,c,o),r.child;case 11:return kb(t,r,r.type,r.pendingProps,o);case 7:return Us(t,r,r.pendingProps,o),r.child;case 8:return Us(t,r,r.pendingProps.children,o),r.child;case 12:return Us(t,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,vi(r,r.type,c.value),Us(t,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,xo(r),f=Bs(f),c=c(f),r.flags|=1,Us(t,r,c,o),r.child;case 14:return Tb(t,r,r.type,r.pendingProps,o);case 15:return jb(t,r,r.type,r.pendingProps,o);case 19:return Db(t,r,o);case 31:return tT(t,r,o);case 22:return Eb(t,r,o,r.pendingProps);case 24:return xo(r),c=Bs(ws),t===null?(f=Uf(),f===null&&(f=Un,m=Vf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},Ff(r),vi(r,ws,f)):((t.lanes&o)!==0&&(qf(t,r),mc(r,null,null,o),fc()),f=t.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),vi(r,ws,c)):(c=m.cache,vi(r,ws,c),c!==f.cache&&Of(r,[ws],o,!0))),Us(t,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function $a(t){t.flags|=4}function Tm(t,r,o,c,f){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(l0())t.flags|=8192;else throw ko=rh,zf}else t.flags&=-16777217}function Lb(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!X0(r))if(l0())t.flags|=8192;else throw ko=rh,zf}function wh(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?vs():536870912,t.lanes|=r,yl|=r)}function xc(t,r){if(!gn)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Yn(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(r)for(var f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=o,r}function sT(t,r,o){var c=r.pendingProps;switch(If(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(r),null;case 1:return Yn(r),null;case 3:return o=r.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),za(ws),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(rl(r)?$a(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Df())),Yn(r),null;case 26:var f=r.type,m=r.memoizedState;return t===null?($a(r),m!==null?(Yn(r),Lb(r,m)):(Yn(r),Tm(r,f,null,c,o))):m?m!==t.memoizedState?($a(r),Yn(r),Lb(r,m)):(Yn(r),r.flags&=-16777217):(t=t.memoizedProps,t!==c&&$a(r),Yn(r),Tm(r,f,t,c,o)),null;case 27:if(hn(r),o=ke.current,f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Yn(r),null}t=Ne.current,rl(r)?pv(r):(t=q0(f,c,o),r.stateNode=t,$a(r))}return Yn(r),null;case 5:if(hn(r),f=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Yn(r),null}if(m=Ne.current,rl(r))pv(r);else{var b=Lh(ke.current);switch(m){case 1:m=b.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=b.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=b.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?b.createElement(f,{is:c.is}):b.createElement(f)}}m[ot]=r,m[Rt]=c;e:for(b=r.child;b!==null;){if(b.tag===5||b.tag===6)m.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===r)break e;for(;b.sibling===null;){if(b.return===null||b.return===r)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}r.stateNode=m;e:switch(zs(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&$a(r)}}return Yn(r),Tm(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,o),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==c&&$a(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(t=ke.current,rl(r)){if(t=r.stateNode,o=r.memoizedProps,c=null,f=Vs,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[ot]=r,t=!!(t.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||I0(t.nodeValue,o)),t||yi(r,!0)}else t=Lh(t).createTextNode(c),t[ot]=r,r.stateNode=t}return Yn(r),null;case 31:if(o=r.memoizedState,t===null||t.memoizedState!==null){if(c=rl(r),o!==null){if(t===null){if(!c)throw Error(i(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(557));t[ot]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Yn(r),t=!1}else o=Df(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return r.flags&256?(Cr(r),r):(Cr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Yn(r),null;case 13:if(c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=rl(r),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[ot]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Yn(r),f=!1}else f=Df(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Cr(r),r):(Cr(r),null)}return Cr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,t=t!==null&&t.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==t&&o&&(r.child.flags|=8192),wh(r,r.updateQueue),Yn(r),null);case 4:return Je(),t===null&&Wm(r.stateNode.containerInfo),Yn(r),null;case 10:return za(r.type),Yn(r),null;case 19:if(W(ps),c=r.memoizedState,c===null)return Yn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)xc(c,!1);else{if(is!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(m=lh(t),m!==null){for(r.flags|=128,xc(c,!1),t=m.updateQueue,r.updateQueue=t,wh(r,t),r.subtreeFlags=0,t=o,o=r.child;o!==null;)uv(o,t),o=o.sibling;return ye(ps,ps.current&1|2),gn&&Ba(r,c.treeForkCount),r.child}t=t.sibling}c.tail!==null&&pt()>Eh&&(r.flags|=128,f=!0,xc(c,!1),r.lanes=4194304)}else{if(!f)if(t=lh(m),t!==null){if(r.flags|=128,f=!0,t=t.updateQueue,r.updateQueue=t,wh(r,t),xc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!gn)return Yn(r),null}else 2*pt()-c.renderingStartTime>Eh&&o!==536870912&&(r.flags|=128,f=!0,xc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(t=c.last,t!==null?t.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=pt(),t.sibling=null,o=ps.current,ye(ps,f?o&1|2:o&1),gn&&Ba(r,c.treeForkCount),t):(Yn(r),null);case 22:case 23:return Cr(r),Gf(),c=r.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Yn(r),r.subtreeFlags&6&&(r.flags|=8192)):Yn(r),o=r.updateQueue,o!==null&&wh(r,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),t!==null&&W(wo),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),za(ws),Yn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function rT(t,r){switch(If(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return za(ws),Je(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return hn(r),null;case 31:if(r.memoizedState!==null){if(Cr(r),r.alternate===null)throw Error(i(340));vo()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Cr(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(i(340));vo()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return W(ps),null;case 4:return Je(),null;case 10:return za(r.type),null;case 22:case 23:return Cr(r),Gf(),t!==null&&W(wo),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return za(ws),null;case 25:return null;default:return null}}function Ob(t,r){switch(If(r),r.tag){case 3:za(ws),Je();break;case 26:case 27:case 5:hn(r);break;case 4:Je();break;case 31:r.memoizedState!==null&&Cr(r);break;case 13:Cr(r);break;case 19:W(ps);break;case 10:za(r.type);break;case 22:case 23:Cr(r),Gf(),t!==null&&W(wo);break;case 24:za(ws)}}function wc(t,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&t)===t){c=void 0;var m=o.create,b=o.inst;c=m(),b.destroy=c}o=o.next}while(o!==f)}}catch(S){In(r,r.return,S)}}function Ti(t,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&t)===t){var b=c.inst,S=b.destroy;if(S!==void 0){b.destroy=void 0,f=r;var B=o,se=S;try{se()}catch(be){In(f,B,be)}}}c=c.next}while(c!==m)}}catch(be){In(r,r.return,be)}}function Vb(t){var r=t.updateQueue;if(r!==null){var o=t.stateNode;try{Nv(r,o)}catch(c){In(t,t.return,c)}}}function Bb(t,r,o){o.props=Eo(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(c){In(t,r,c)}}function _c(t,r){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof o=="function"?t.refCleanup=o(c):o.current=c}}catch(f){In(t,r,f)}}function xa(t,r){var o=t.ref,c=t.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){In(t,r,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){In(t,r,f)}else o.current=null}function Ub(t){var r=t.type,o=t.memoizedProps,c=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){In(t,t.return,f)}}function jm(t,r,o){try{var c=t.stateNode;ET(c,t.type,o,r),c[Rt]=r}catch(f){In(t,t.return,f)}}function zb(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ai(t.type)||t.tag===4}function Em(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ai(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sm(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(t),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=A));else if(c!==4&&(c===27&&Ai(t.type)&&(o=t.stateNode,r=null),t=t.child,t!==null))for(Sm(t,r,o),t=t.sibling;t!==null;)Sm(t,r,o),t=t.sibling}function _h(t,r,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(c!==4&&(c===27&&Ai(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(_h(t,r,o),t=t.sibling;t!==null;)_h(t,r,o),t=t.sibling}function Fb(t){var r=t.stateNode,o=t.memoizedProps;try{for(var c=t.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);zs(r,c,o),r[ot]=t,r[Rt]=o}catch(m){In(t,t.return,m)}}var Wa=!1,Ts=!1,Nm=!1,qb=typeof WeakSet=="function"?WeakSet:Set,Ps=null;function aT(t,r){if(t=t.containerInfo,Ym=qh,t=tv(t),wf(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var b=0,S=-1,B=-1,se=0,be=0,Re=t,ie=null;t:for(;;){for(var fe;Re!==o||f!==0&&Re.nodeType!==3||(S=b+f),Re!==m||c!==0&&Re.nodeType!==3||(B=b+c),Re.nodeType===3&&(b+=Re.nodeValue.length),(fe=Re.firstChild)!==null;)ie=Re,Re=fe;for(;;){if(Re===t)break t;if(ie===o&&++se===f&&(S=b),ie===m&&++be===c&&(B=b),(fe=Re.nextSibling)!==null)break;Re=ie,ie=Re.parentNode}Re=fe}o=S===-1||B===-1?null:{start:S,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qm={focusedElem:t,selectionRange:o},qh=!1,Ps=r;Ps!==null;)if(r=Ps,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Ps=t;else for(;Ps!==null;){switch(r=Ps,m=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)f=t[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var dt=Eo(o.type,f);t=c.getSnapshotBeforeUpdate(dt,m),c.__reactInternalSnapshotBeforeUpdate=t}catch(It){In(o,o.return,It)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,o=t.nodeType,o===9)Zm(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Zm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(i(163))}if(t=r.sibling,t!==null){t.return=r.return,Ps=t;break}Ps=r.return}}function Hb(t,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Ka(t,o),c&4&&wc(5,o);break;case 1:if(Ka(t,o),c&4)if(t=o.stateNode,r===null)try{t.componentDidMount()}catch(b){In(o,o.return,b)}else{var f=Eo(o.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(f,r,t.__reactInternalSnapshotBeforeUpdate)}catch(b){In(o,o.return,b)}}c&64&&Vb(o),c&512&&_c(o,o.return);break;case 3:if(Ka(t,o),c&64&&(t=o.updateQueue,t!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Nv(t,r)}catch(b){In(o,o.return,b)}}break;case 27:r===null&&c&4&&Fb(o);case 26:case 5:Ka(t,o),r===null&&c&4&&Ub(o),c&512&&_c(o,o.return);break;case 12:Ka(t,o);break;case 31:Ka(t,o),c&4&&Gb(t,o);break;case 13:Ka(t,o),c&4&&Kb(t,o),c&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=mT.bind(null,o),DT(t,o))));break;case 22:if(c=o.memoizedState!==null||Wa,!c){r=r!==null&&r.memoizedState!==null||Ts,f=Wa;var m=Ts;Wa=c,(Ts=r)&&!m?Ya(t,o,(o.subtreeFlags&8772)!==0):Ka(t,o),Wa=f,Ts=m}break;case 30:break;default:Ka(t,o)}}function $b(t){var r=t.alternate;r!==null&&(t.alternate=null,$b(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&Ms(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var es=null,dr=!1;function Ga(t,r,o){for(o=o.child;o!==null;)Wb(t,r,o),o=o.sibling}function Wb(t,r,o){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(We,o)}catch{}switch(o.tag){case 26:Ts||xa(o,r),Ga(t,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ts||xa(o,r);var c=es,f=dr;Ai(o.type)&&(es=o.stateNode,dr=!1),Ga(t,r,o),Ac(o.stateNode),es=c,dr=f;break;case 5:Ts||xa(o,r);case 6:if(c=es,f=dr,es=null,Ga(t,r,o),es=c,dr=f,es!==null)if(dr)try{(es.nodeType===9?es.body:es.nodeName==="HTML"?es.ownerDocument.body:es).removeChild(o.stateNode)}catch(m){In(o,r,m)}else try{es.removeChild(o.stateNode)}catch(m){In(o,r,m)}break;case 18:es!==null&&(dr?(t=es,V0(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),jl(t)):V0(es,o.stateNode));break;case 4:c=es,f=dr,es=o.stateNode.containerInfo,dr=!0,Ga(t,r,o),es=c,dr=f;break;case 0:case 11:case 14:case 15:Ti(2,o,r),Ts||Ti(4,o,r),Ga(t,r,o);break;case 1:Ts||(xa(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Bb(o,r,c)),Ga(t,r,o);break;case 21:Ga(t,r,o);break;case 22:Ts=(c=Ts)||o.memoizedState!==null,Ga(t,r,o),Ts=c;break;default:Ga(t,r,o)}}function Gb(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{jl(t)}catch(o){In(r,r.return,o)}}}function Kb(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{jl(t)}catch(o){In(r,r.return,o)}}function iT(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new qb),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new qb),r;default:throw Error(i(435,t.tag))}}function kh(t,r){var o=iT(t);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=pT.bind(null,t,c);c.then(f,f)}})}function fr(t,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=t,b=r,S=b;e:for(;S!==null;){switch(S.tag){case 27:if(Ai(S.type)){es=S.stateNode,dr=!1;break e}break;case 5:es=S.stateNode,dr=!1;break e;case 3:case 4:es=S.stateNode.containerInfo,dr=!0;break e}S=S.return}if(es===null)throw Error(i(160));Wb(m,b,f),es=null,dr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Yb(r,t),r=r.sibling}var ra=null;function Yb(t,r){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:fr(r,t),mr(t),c&4&&(Ti(3,t,t.return),wc(3,t),Ti(5,t,t.return));break;case 1:fr(r,t),mr(t),c&512&&(Ts||o===null||xa(o,o.return)),c&64&&Wa&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ra;if(fr(r,t),mr(t),c&512&&(Ts||o===null||xa(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=t.memoizedState,o===null)if(c===null)if(t.stateNode===null){e:{c=t.type,o=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[bs]||m[ot]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),zs(m,c,o),m[ot]=t,C(m),c=m;break e;case"link":var b=Y0("link","href",f).get(c+(o.href||""));if(b){for(var S=0;S<b.length;S++)if(m=b[S],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(S,1);break t}}m=f.createElement(c),zs(m,c,o),f.head.appendChild(m);break;case"meta":if(b=Y0("meta","content",f).get(c+(o.content||""))){for(S=0;S<b.length;S++)if(m=b[S],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(S,1);break t}}m=f.createElement(c),zs(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[ot]=t,C(m),c=m}t.stateNode=c}else Q0(f,t.type,t.stateNode);else t.stateNode=K0(f,c,t.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Q0(f,t.type,t.stateNode):K0(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&jm(t,t.memoizedProps,o.memoizedProps)}break;case 27:fr(r,t),mr(t),c&512&&(Ts||o===null||xa(o,o.return)),o!==null&&c&4&&jm(t,t.memoizedProps,o.memoizedProps);break;case 5:if(fr(r,t),mr(t),c&512&&(Ts||o===null||xa(o,o.return)),t.flags&32){f=t.stateNode;try{Bn(f,"")}catch(dt){In(t,t.return,dt)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,jm(t,f,o!==null?o.memoizedProps:f)),c&1024&&(Nm=!0);break;case 6:if(fr(r,t),mr(t),c&4){if(t.stateNode===null)throw Error(i(162));c=t.memoizedProps,o=t.stateNode;try{o.nodeValue=c}catch(dt){In(t,t.return,dt)}}break;case 3:if(Bh=null,f=ra,ra=Oh(r.containerInfo),fr(r,t),ra=f,mr(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{jl(r.containerInfo)}catch(dt){In(t,t.return,dt)}Nm&&(Nm=!1,Qb(t));break;case 4:c=ra,ra=Oh(t.stateNode.containerInfo),fr(r,t),mr(t),ra=c;break;case 12:fr(r,t),mr(t);break;case 31:fr(r,t),mr(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 13:fr(r,t),mr(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(jh=pt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 22:f=t.memoizedState!==null;var B=o!==null&&o.memoizedState!==null,se=Wa,be=Ts;if(Wa=se||f,Ts=be||B,fr(r,t),Ts=be,Wa=se,mr(t),c&8192)e:for(r=t.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||B||Wa||Ts||So(t)),o=null,r=t;;){if(r.tag===5||r.tag===26){if(o===null){B=o=r;try{if(m=B.stateNode,f)b=m.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{S=B.stateNode;var Re=B.memoizedProps.style,ie=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;S.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(dt){In(B,B.return,dt)}}}else if(r.tag===6){if(o===null){B=r;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(dt){In(B,B.return,dt)}}}else if(r.tag===18){if(o===null){B=r;try{var fe=B.stateNode;f?B0(fe,!0):B0(B.stateNode,!1)}catch(dt){In(B,B.return,dt)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=t.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,kh(t,o))));break;case 19:fr(r,t),mr(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,kh(t,c)));break;case 30:break;case 21:break;default:fr(r,t),mr(t)}}function mr(t){var r=t.flags;if(r&2){try{for(var o,c=t.return;c!==null;){if(zb(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Em(t);_h(t,m,f);break;case 5:var b=o.stateNode;o.flags&32&&(Bn(b,""),o.flags&=-33);var S=Em(t);_h(t,S,b);break;case 3:case 4:var B=o.stateNode.containerInfo,se=Em(t);Sm(t,se,B);break;default:throw Error(i(161))}}catch(be){In(t,t.return,be)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Qb(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;Qb(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Ka(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Hb(t,r.alternate,r),r=r.sibling}function So(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Ti(4,r,r.return),So(r);break;case 1:xa(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Bb(r,r.return,o),So(r);break;case 27:Ac(r.stateNode);case 26:case 5:xa(r,r.return),So(r);break;case 22:r.memoizedState===null&&So(r);break;case 30:So(r);break;default:So(r)}t=t.sibling}}function Ya(t,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=t,m=r,b=m.flags;switch(m.tag){case 0:case 11:case 15:Ya(f,m,o),wc(4,m);break;case 1:if(Ya(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(se){In(c,c.return,se)}if(c=m,f=c.updateQueue,f!==null){var S=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)Sv(B[f],S)}catch(se){In(c,c.return,se)}}o&&b&64&&Vb(m),_c(m,m.return);break;case 27:Fb(m);case 26:case 5:Ya(f,m,o),o&&c===null&&b&4&&Ub(m),_c(m,m.return);break;case 12:Ya(f,m,o);break;case 31:Ya(f,m,o),o&&b&4&&Gb(f,m);break;case 13:Ya(f,m,o),o&&b&4&&Kb(f,m);break;case 22:m.memoizedState===null&&Ya(f,m,o),_c(m,m.return);break;case 30:break;default:Ya(f,m,o)}r=r.sibling}}function Cm(t,r){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&lc(o))}function Rm(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&lc(t))}function aa(t,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Xb(t,r,o,c),r=r.sibling}function Xb(t,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:aa(t,r,o,c),f&2048&&wc(9,r);break;case 1:aa(t,r,o,c);break;case 3:aa(t,r,o,c),f&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&lc(t)));break;case 12:if(f&2048){aa(t,r,o,c),t=r.stateNode;try{var m=r.memoizedProps,b=m.id,S=m.onPostCommit;typeof S=="function"&&S(b,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(B){In(r,r.return,B)}}else aa(t,r,o,c);break;case 31:aa(t,r,o,c);break;case 13:aa(t,r,o,c);break;case 23:break;case 22:m=r.stateNode,b=r.alternate,r.memoizedState!==null?m._visibility&2?aa(t,r,o,c):kc(t,r):m._visibility&2?aa(t,r,o,c):(m._visibility|=2,ml(t,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Cm(b,r);break;case 24:aa(t,r,o,c),f&2048&&Rm(r.alternate,r);break;default:aa(t,r,o,c)}}function ml(t,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=t,b=r,S=o,B=c,se=b.flags;switch(b.tag){case 0:case 11:case 15:ml(m,b,S,B,f),wc(8,b);break;case 23:break;case 22:var be=b.stateNode;b.memoizedState!==null?be._visibility&2?ml(m,b,S,B,f):kc(m,b):(be._visibility|=2,ml(m,b,S,B,f)),f&&se&2048&&Cm(b.alternate,b);break;case 24:ml(m,b,S,B,f),f&&se&2048&&Rm(b.alternate,b);break;default:ml(m,b,S,B,f)}r=r.sibling}}function kc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=t,c=r,f=c.flags;switch(c.tag){case 22:kc(o,c),f&2048&&Cm(c.alternate,c);break;case 24:kc(o,c),f&2048&&Rm(c.alternate,c);break;default:kc(o,c)}r=r.sibling}}var Tc=8192;function pl(t,r,o){if(t.subtreeFlags&Tc)for(t=t.child;t!==null;)Jb(t,r,o),t=t.sibling}function Jb(t,r,o){switch(t.tag){case 26:pl(t,r,o),t.flags&Tc&&t.memoizedState!==null&&WT(o,ra,t.memoizedState,t.memoizedProps);break;case 5:pl(t,r,o);break;case 3:case 4:var c=ra;ra=Oh(t.stateNode.containerInfo),pl(t,r,o),ra=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=Tc,Tc=16777216,pl(t,r,o),Tc=c):pl(t,r,o));break;default:pl(t,r,o)}}function Zb(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function jc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ps=c,t0(c,t)}Zb(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)e0(t),t=t.sibling}function e0(t){switch(t.tag){case 0:case 11:case 15:jc(t),t.flags&2048&&Ti(9,t,t.return);break;case 3:jc(t);break;case 12:jc(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,Th(t)):jc(t);break;default:jc(t)}}function Th(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ps=c,t0(c,t)}Zb(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Ti(8,r,r.return),Th(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Th(r));break;default:Th(r)}t=t.sibling}}function t0(t,r){for(;Ps!==null;){var o=Ps;switch(o.tag){case 0:case 11:case 15:Ti(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:lc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Ps=c;else e:for(o=t;Ps!==null;){c=Ps;var f=c.sibling,m=c.return;if($b(c),c===o){Ps=null;break e}if(f!==null){f.return=m,Ps=f;break e}Ps=m}}}var oT={getCacheForType:function(t){var r=Bs(ws),o=r.data.get(t);return o===void 0&&(o=t(),r.data.set(t,o)),o},cacheSignal:function(){return Bs(ws).controller.signal}},lT=typeof WeakMap=="function"?WeakMap:Map,En=0,Un=null,sn=null,an=0,An=0,Rr=null,ji=!1,gl=!1,Am=!1,Qa=0,is=0,Ei=0,No=0,Im=0,Ar=0,yl=0,Ec=null,pr=null,Mm=!1,jh=0,n0=0,Eh=1/0,Sh=null,Si=null,Rs=0,Ni=null,vl=null,Xa=0,Dm=0,Pm=null,s0=null,Sc=0,Lm=null;function Ir(){return(En&2)!==0&&an!==0?an&-an:Y.T!==null?Fm():we()}function r0(){if(Ar===0)if((an&536870912)===0||gn){var t=Fn;Fn<<=1,(Fn&3932160)===0&&(Fn=262144),Ar=t}else Ar=536870912;return t=Nr.current,t!==null&&(t.flags|=32),Ar}function gr(t,r,o){(t===Un&&(An===2||An===9)||t.cancelPendingCommit!==null)&&(bl(t,0),Ci(t,an,Ar,!1)),hs(t,o),((En&2)===0||t!==Un)&&(t===Un&&((En&2)===0&&(No|=o),is===4&&Ci(t,an,Ar,!1)),wa(t))}function a0(t,r,o){if((En&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&t.expiredLanes)===0||Dn(t,r),f=c?hT(t,r):Vm(t,r,!0),m=c;do{if(f===0){gl&&!c&&Ci(t,r,0,!1);break}else{if(o=t.current.alternate,m&&!cT(o)){f=Vm(t,r,!1),m=!1;continue}if(f===2){if(m=r,t.errorRecoveryDisabledLanes&m)var b=0;else b=t.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var S=t;f=Ec;var B=S.current.memoizedState.isDehydrated;if(B&&(bl(S,b).flags|=256),b=Vm(S,b,!1),b!==2){if(Am&&!B){S.errorRecoveryDisabledLanes|=m,No|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=b}if(m=!1,f!==2)continue}}if(f===1){bl(t,0),Ci(t,r,0,!0);break}e:{switch(c=t,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ci(c,r,Ar,!ji);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=jh+300-pt(),10<f)){if(Ci(c,r,Ar,!ji),Xn(c,0,!0)!==0)break e;Xa=r,c.timeoutHandle=L0(i0.bind(null,c,o,pr,Sh,Mm,r,Ar,No,yl,ji,m,"Throttled",-0,0),f);break e}i0(c,o,pr,Sh,Mm,r,Ar,No,yl,ji,m,null,-0,0)}}break}while(!0);wa(t)}function i0(t,r,o,c,f,m,b,S,B,se,be,Re,ie,fe){if(t.timeoutHandle=-1,Re=r.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:A},Jb(r,m,Re);var dt=(m&62914560)===m?jh-pt():(m&4194048)===m?n0-pt():0;if(dt=GT(Re,dt),dt!==null){Xa=m,t.cancelPendingCommit=dt(m0.bind(null,t,r,m,o,c,f,b,S,B,be,Re,null,ie,fe)),Ci(t,m,b,!se);return}}m0(t,r,m,o,c,f,b,S,B)}function cT(t){for(var r=t;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Er(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ci(t,r,o,c){r&=~Im,r&=~No,t.suspendedLanes|=r,t.pingedLanes&=~r,c&&(t.warmLanes|=r),c=t.expirationTimes;for(var f=r;0<f;){var m=31-qe(f),b=1<<m;c[m]=-1,f&=~b}o!==0&&Ns(t,o,r)}function Nh(){return(En&6)===0?(Nc(0),!1):!0}function Om(){if(sn!==null){if(An===0)var t=sn.return;else t=sn,Ua=bo=null,Zf(t),cl=null,uc=0,t=sn;for(;t!==null;)Ob(t.alternate,t),t=t.return;sn=null}}function bl(t,r){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,CT(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Xa=0,Om(),Un=t,sn=o=Va(t.current,null),an=r,An=0,Rr=null,ji=!1,gl=Dn(t,r),Am=!1,yl=Ar=Im=No=Ei=is=0,pr=Ec=null,Mm=!1,(r&8)!==0&&(r|=r&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=r;0<c;){var f=31-qe(c),m=1<<f;r|=t[f],c&=~m}return Qa=r,Yu(),o}function o0(t,r){Xt=null,Y.H=vc,r===ll||r===sh?(r=kv(),An=3):r===zf?(r=kv(),An=4):An=r===pm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Rr=r,sn===null&&(is=1,yh(t,Ur(r,t.current)))}function l0(){var t=Nr.current;return t===null?!0:(an&4194048)===an?Hr===null:(an&62914560)===an||(an&536870912)!==0?t===Hr:!1}function c0(){var t=Y.H;return Y.H=vc,t===null?vc:t}function u0(){var t=Y.A;return Y.A=oT,t}function Ch(){is=4,ji||(an&4194048)!==an&&Nr.current!==null||(gl=!0),(Ei&134217727)===0&&(No&134217727)===0||Un===null||Ci(Un,an,Ar,!1)}function Vm(t,r,o){var c=En;En|=2;var f=c0(),m=u0();(Un!==t||an!==r)&&(Sh=null,bl(t,r)),r=!1;var b=is;e:do try{if(An!==0&&sn!==null){var S=sn,B=Rr;switch(An){case 8:Om(),b=6;break e;case 3:case 2:case 9:case 6:Nr.current===null&&(r=!0);var se=An;if(An=0,Rr=null,xl(t,S,B,se),o&&gl){b=0;break e}break;default:se=An,An=0,Rr=null,xl(t,S,B,se)}}uT(),b=is;break}catch(be){o0(t,be)}while(!0);return r&&t.shellSuspendCounter++,Ua=bo=null,En=c,Y.H=f,Y.A=m,sn===null&&(Un=null,an=0,Yu()),b}function uT(){for(;sn!==null;)h0(sn)}function hT(t,r){var o=En;En|=2;var c=c0(),f=u0();Un!==t||an!==r?(Sh=null,Eh=pt()+500,bl(t,r)):gl=Dn(t,r);e:do try{if(An!==0&&sn!==null){r=sn;var m=Rr;t:switch(An){case 1:An=0,Rr=null,xl(t,r,m,1);break;case 2:case 9:if(wv(m)){An=0,Rr=null,d0(r);break}r=function(){An!==2&&An!==9||Un!==t||(An=7),wa(t)},m.then(r,r);break e;case 3:An=7;break e;case 4:An=5;break e;case 7:wv(m)?(An=0,Rr=null,d0(r)):(An=0,Rr=null,xl(t,r,m,7));break;case 5:var b=null;switch(sn.tag){case 26:b=sn.memoizedState;case 5:case 27:var S=sn;if(b?X0(b):S.stateNode.complete){An=0,Rr=null;var B=S.sibling;if(B!==null)sn=B;else{var se=S.return;se!==null?(sn=se,Rh(se)):sn=null}break t}}An=0,Rr=null,xl(t,r,m,5);break;case 6:An=0,Rr=null,xl(t,r,m,6);break;case 8:Om(),is=6;break e;default:throw Error(i(462))}}dT();break}catch(be){o0(t,be)}while(!0);return Ua=bo=null,Y.H=c,Y.A=f,En=o,sn!==null?0:(Un=null,an=0,Yu(),is)}function dT(){for(;sn!==null&&!He();)h0(sn)}function h0(t){var r=Pb(t.alternate,t,Qa);t.memoizedProps=t.pendingProps,r===null?Rh(t):sn=r}function d0(t){var r=t,o=r.alternate;switch(r.tag){case 15:case 0:r=Cb(o,r,r.pendingProps,r.type,void 0,an);break;case 11:r=Cb(o,r,r.pendingProps,r.type.render,r.ref,an);break;case 5:Zf(r);default:Ob(o,r),r=sn=uv(r,Qa),r=Pb(o,r,Qa)}t.memoizedProps=t.pendingProps,r===null?Rh(t):sn=r}function xl(t,r,o,c){Ua=bo=null,Zf(r),cl=null,uc=0;var f=r.return;try{if(eT(t,f,r,o,an)){is=1,yh(t,Ur(o,t.current)),sn=null;return}}catch(m){if(f!==null)throw sn=f,m;is=1,yh(t,Ur(o,t.current)),sn=null;return}r.flags&32768?(gn||c===1?t=!0:gl||(an&536870912)!==0?t=!1:(ji=t=!0,(c===2||c===9||c===3||c===6)&&(c=Nr.current,c!==null&&c.tag===13&&(c.flags|=16384))),f0(r,t)):Rh(r)}function Rh(t){var r=t;do{if((r.flags&32768)!==0){f0(r,ji);return}t=r.return;var o=sT(r.alternate,r,Qa);if(o!==null){sn=o;return}if(r=r.sibling,r!==null){sn=r;return}sn=r=t}while(r!==null);is===0&&(is=5)}function f0(t,r){do{var o=rT(t.alternate,t);if(o!==null){o.flags&=32767,sn=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(t=t.sibling,t!==null)){sn=t;return}sn=t=o}while(t!==null);is=6,sn=null}function m0(t,r,o,c,f,m,b,S,B){t.cancelPendingCommit=null;do Ah();while(Rs!==0);if((En&6)!==0)throw Error(i(327));if(r!==null){if(r===t.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Ef,ds(t,o,m,b,S,B),t===Un&&(sn=Un=null,an=0),vl=r,Ni=t,Xa=o,Dm=m,Pm=f,s0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,gT(ce,function(){return b0(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null,f=Se.p,Se.p=2,b=En,En|=4;try{aT(t,r,o)}finally{En=b,Se.p=f,Y.T=c}}Rs=1,p0(),g0(),y0()}}function p0(){if(Rs===1){Rs=0;var t=Ni,r=vl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=Y.T,Y.T=null;var c=Se.p;Se.p=2;var f=En;En|=4;try{Yb(r,t);var m=Qm,b=tv(t.containerInfo),S=m.focusedElem,B=m.selectionRange;if(b!==S&&S&&S.ownerDocument&&ev(S.ownerDocument.documentElement,S)){if(B!==null&&wf(S)){var se=B.start,be=B.end;if(be===void 0&&(be=se),"selectionStart"in S)S.selectionStart=se,S.selectionEnd=Math.min(be,S.value.length);else{var Re=S.ownerDocument||document,ie=Re&&Re.defaultView||window;if(ie.getSelection){var fe=ie.getSelection(),dt=S.textContent.length,It=Math.min(B.start,dt),On=B.end===void 0?It:Math.min(B.end,dt);!fe.extend&&It>On&&(b=On,On=It,It=b);var Q=Zy(S,It),$=Zy(S,On);if(Q&&$&&(fe.rangeCount!==1||fe.anchorNode!==Q.node||fe.anchorOffset!==Q.offset||fe.focusNode!==$.node||fe.focusOffset!==$.offset)){var ne=Re.createRange();ne.setStart(Q.node,Q.offset),fe.removeAllRanges(),It>On?(fe.addRange(ne),fe.extend($.node,$.offset)):(ne.setEnd($.node,$.offset),fe.addRange(ne))}}}}for(Re=[],fe=S;fe=fe.parentNode;)fe.nodeType===1&&Re.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Re.length;S++){var je=Re[S];je.element.scrollLeft=je.left,je.element.scrollTop=je.top}}qh=!!Ym,Qm=Ym=null}finally{En=f,Se.p=c,Y.T=o}}t.current=r,Rs=2}}function g0(){if(Rs===2){Rs=0;var t=Ni,r=vl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=Y.T,Y.T=null;var c=Se.p;Se.p=2;var f=En;En|=4;try{Hb(t,r.alternate,r)}finally{En=f,Se.p=c,Y.T=o}}Rs=3}}function y0(){if(Rs===4||Rs===3){Rs=0,tt();var t=Ni,r=vl,o=Xa,c=s0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Rs=5:(Rs=0,vl=Ni=null,v0(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(Si=null),ge(o),r=r.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(We,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Y.T,f=Se.p,Se.p=2,Y.T=null;try{for(var m=t.onRecoverableError,b=0;b<c.length;b++){var S=c[b];m(S.value,{componentStack:S.stack})}}finally{Y.T=r,Se.p=f}}(Xa&3)!==0&&Ah(),wa(t),f=t.pendingLanes,(o&261930)!==0&&(f&42)!==0?t===Lm?Sc++:(Sc=0,Lm=t):Sc=0,Nc(0)}}function v0(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,lc(r)))}function Ah(){return p0(),g0(),y0(),b0()}function b0(){if(Rs!==5)return!1;var t=Ni,r=Dm;Dm=0;var o=ge(Xa),c=Y.T,f=Se.p;try{Se.p=32>o?32:o,Y.T=null,o=Pm,Pm=null;var m=Ni,b=Xa;if(Rs=0,vl=Ni=null,Xa=0,(En&6)!==0)throw Error(i(331));var S=En;if(En|=4,e0(m.current),Xb(m,m.current,b,o),En=S,Nc(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(We,m)}catch{}return!0}finally{Se.p=f,Y.T=c,v0(t,r)}}function x0(t,r,o){r=Ur(o,r),r=mm(t.stateNode,r,2),t=wi(t,r,2),t!==null&&(hs(t,2),wa(t))}function In(t,r,o){if(t.tag===3)x0(t,t,o);else for(;r!==null;){if(r.tag===3){x0(r,t,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Si===null||!Si.has(c))){t=Ur(o,t),o=wb(2),c=wi(r,o,2),c!==null&&(_b(o,c,r,t),hs(c,2),wa(c));break}}r=r.return}}function Bm(t,r,o){var c=t.pingCache;if(c===null){c=t.pingCache=new lT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Am=!0,f.add(o),t=fT.bind(null,t,r,o),r.then(t,t))}function fT(t,r,o){var c=t.pingCache;c!==null&&c.delete(r),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Un===t&&(an&o)===o&&(is===4||is===3&&(an&62914560)===an&&300>pt()-jh?(En&2)===0&&bl(t,0):Im|=o,yl===an&&(yl=0)),wa(t)}function w0(t,r){r===0&&(r=vs()),t=go(t,r),t!==null&&(hs(t,r),wa(t))}function mT(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),w0(t,o)}function pT(t,r){var o=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),w0(t,o)}function gT(t,r){return Ye(t,r)}var Ih=null,wl=null,Um=!1,Mh=!1,zm=!1,Ri=0;function wa(t){t!==wl&&t.next===null&&(wl===null?Ih=wl=t:wl=wl.next=t),Mh=!0,Um||(Um=!0,vT())}function Nc(t,r){if(!zm&&Mh){zm=!0;do for(var o=!1,c=Ih;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var b=c.suspendedLanes,S=c.pingedLanes;m=(1<<31-qe(42|t)+1)-1,m&=f&~(b&~S),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,j0(c,m))}else m=an,m=Xn(c,c===Un?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Dn(c,m)||(o=!0,j0(c,m));c=c.next}while(o);zm=!1}}function yT(){_0()}function _0(){Mh=Um=!1;var t=0;Ri!==0&&NT()&&(t=Ri);for(var r=pt(),o=null,c=Ih;c!==null;){var f=c.next,m=k0(c,r);m===0?(c.next=null,o===null?Ih=f:o.next=f,f===null&&(wl=o)):(o=c,(t!==0||(m&3)!==0)&&(Mh=!0)),c=f}Rs!==0&&Rs!==5||Nc(t),Ri!==0&&(Ri=0)}function k0(t,r){for(var o=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var b=31-qe(m),S=1<<b,B=f[b];B===-1?((S&o)===0||(S&c)!==0)&&(f[b]=us(S,r)):B<=r&&(t.expiredLanes|=S),m&=~S}if(r=Un,o=an,o=Xn(t,t===r?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,o===0||t===r&&(An===2||An===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&le(c),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Dn(t,o)){if(r=o&-o,r===t.callbackPriority)return r;switch(c!==null&&le(c),ge(o)){case 2:case 8:o=St;break;case 32:o=ce;break;case 268435456:o=Ie;break;default:o=ce}return c=T0.bind(null,t),o=Ye(o,c),t.callbackPriority=r,t.callbackNode=o,r}return c!==null&&c!==null&&le(c),t.callbackPriority=2,t.callbackNode=null,2}function T0(t,r){if(Rs!==0&&Rs!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Ah()&&t.callbackNode!==o)return null;var c=an;return c=Xn(t,t===Un?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(a0(t,c,r),k0(t,pt()),t.callbackNode!=null&&t.callbackNode===o?T0.bind(null,t):null)}function j0(t,r){if(Ah())return null;a0(t,r,!0)}function vT(){RT(function(){(En&6)!==0?Ye(at,yT):_0()})}function Fm(){if(Ri===0){var t=il;t===0&&(t=Nn,Nn<<=1,(Nn&261888)===0&&(Nn=256)),Ri=t}return Ri}function E0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:pa(""+t)}function S0(t,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,t.id&&o.setAttribute("form",t.id),r.parentNode.insertBefore(o,r),t=new FormData(t),o.parentNode.removeChild(o),t}function bT(t,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=E0((f[Rt]||null).action),b=c.submitter;b&&(r=(r=b[Rt]||null)?E0(r.formAction):b.getAttribute("formAction"),r!==null&&(m=r,b=null));var S=new tr("action","action",null,c,f);t.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ri!==0){var B=b?S0(f,b):new FormData(f);lm(o,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(S.preventDefault(),B=b?S0(f,b):new FormData(f),lm(o,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var qm=0;qm<jf.length;qm++){var Hm=jf[qm],xT=Hm.toLowerCase(),wT=Hm[0].toUpperCase()+Hm.slice(1);sa(xT,"on"+wT)}sa(rv,"onAnimationEnd"),sa(av,"onAnimationIteration"),sa(iv,"onAnimationStart"),sa("dblclick","onDoubleClick"),sa("focusin","onFocus"),sa("focusout","onBlur"),sa(Ok,"onTransitionRun"),sa(Vk,"onTransitionStart"),sa(Bk,"onTransitionCancel"),sa(ov,"onTransitionEnd"),Ve("onMouseEnter",["mouseout","mouseover"]),Ve("onMouseLeave",["mouseout","mouseover"]),Ve("onPointerEnter",["pointerout","pointerover"]),Ve("onPointerLeave",["pointerout","pointerover"]),Ue("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ue("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ue("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ue("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ue("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ue("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_T=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cc));function N0(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var b=c.length-1;0<=b;b--){var S=c[b],B=S.instance,se=S.currentTarget;if(S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=se;try{m(f)}catch(be){Ku(be)}f.currentTarget=null,m=B}else for(b=0;b<c.length;b++){if(S=c[b],B=S.instance,se=S.currentTarget,S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=se;try{m(f)}catch(be){Ku(be)}f.currentTarget=null,m=B}}}}function rn(t,r){var o=r[_t];o===void 0&&(o=r[_t]=new Set);var c=t+"__bubble";o.has(c)||(C0(r,t,2,!1),o.add(c))}function $m(t,r,o){var c=0;r&&(c|=4),C0(o,t,c,r)}var Dh="_reactListening"+Math.random().toString(36).slice(2);function Wm(t){if(!t[Dh]){t[Dh]=!0,K.forEach(function(o){o!=="selectionchange"&&(_T.has(o)||$m(o,!1,t),$m(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Dh]||(r[Dh]=!0,$m("selectionchange",!1,r))}}function C0(t,r,o,c){switch(r1(r)){case 2:var f=QT;break;case 8:f=XT;break;default:f=op}o=f.bind(null,r,o,t),f=void 0,!Yt||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(r,o,{capture:!0,passive:f}):t.addEventListener(r,o,!0):f!==void 0?t.addEventListener(r,o,{passive:f}):t.addEventListener(r,o,!1)}function Gm(t,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var S=c.stateNode.containerInfo;if(S===f)break;if(b===4)for(b=c.return;b!==null;){var B=b.tag;if((B===3||B===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;S!==null;){if(b=Cn(S),b===null)return;if(B=b.tag,B===5||B===6||B===26||B===27){c=m=b;continue e}S=S.parentNode}}c=c.return}Pt(function(){var se=m,be=Me(o),Re=[];e:{var ie=lv.get(t);if(ie!==void 0){var fe=tr,dt=t;switch(t){case"keypress":if(xs(o)===0)break e;case"keydown":case"keyup":fe=$u;break;case"focusin":dt="focus",fe=ho;break;case"focusout":dt="blur",fe=ho;break;case"beforeblur":case"afterblur":fe=ho;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Zr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=v;break;case rv:case av:case iv:fe=Vu;break;case ov:fe=N;break;case"scroll":case"scrollend":fe=Ws;break;case"wheel":fe=he;break;case"copy":case"cut":case"paste":fe=Bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Oa;break;case"toggle":case"beforetoggle":fe=Qt}var It=(r&4)!==0,On=!It&&(t==="scroll"||t==="scrollend"),Q=It?ie!==null?ie+"Capture":null:ie;It=[];for(var $=se,ne;$!==null;){var je=$;if(ne=je.stateNode,je=je.tag,je!==5&&je!==26&&je!==27||ne===null||Q===null||(je=Mt($,Q),je!=null&&It.push(Rc($,je,ne))),On)break;$=$.return}0<It.length&&(ie=new fe(ie,dt,null,o,be),Re.push({event:ie,listeners:It}))}}if((r&7)===0){e:{if(ie=t==="mouseover"||t==="pointerover",fe=t==="mouseout"||t==="pointerout",ie&&o!==J&&(dt=o.relatedTarget||o.fromElement)&&(Cn(dt)||dt[ut]))break e;if((fe||ie)&&(ie=be.window===be?be:(ie=be.ownerDocument)?ie.defaultView||ie.parentWindow:window,fe?(dt=o.relatedTarget||o.toElement,fe=se,dt=dt?Cn(dt):null,dt!==null&&(On=u(dt),It=dt.tag,dt!==On||It!==5&&It!==27&&It!==6)&&(dt=null)):(fe=null,dt=se),fe!==dt)){if(It=uo,je="onMouseLeave",Q="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(It=Oa,je="onPointerLeave",Q="onPointerEnter",$="pointer"),On=fe==null?ie:ue(fe),ne=dt==null?ie:ue(dt),ie=new It(je,$+"leave",fe,o,be),ie.target=On,ie.relatedTarget=ne,je=null,Cn(be)===se&&(It=new It(Q,$+"enter",dt,o,be),It.target=ne,It.relatedTarget=On,je=It),On=je,fe&&dt)t:{for(It=kT,Q=fe,$=dt,ne=0,je=Q;je;je=It(je))ne++;je=0;for(var Tt=$;Tt;Tt=It(Tt))je++;for(;0<ne-je;)Q=It(Q),ne--;for(;0<je-ne;)$=It($),je--;for(;ne--;){if(Q===$||$!==null&&Q===$.alternate){It=Q;break t}Q=It(Q),$=It($)}It=null}else It=null;fe!==null&&R0(Re,ie,fe,It,!1),dt!==null&&On!==null&&R0(Re,On,dt,It,!0)}}e:{if(ie=se?ue(se):window,fe=ie.nodeName&&ie.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ie.type==="file")var _n=Gy;else if($y(ie))if(Ky)_n=Dk;else{_n=Ik;var vt=Ak}else fe=ie.nodeName,!fe||fe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?se&&Ds(se.elementType)&&(_n=Gy):_n=Mk;if(_n&&(_n=_n(t,se))){Wy(Re,_n,o,be);break e}vt&&vt(t,ie,se),t==="focusout"&&se&&ie.type==="number"&&se.memoizedProps.value!=null&&Jr(ie,"number",ie.value)}switch(vt=se?ue(se):window,t){case"focusin":($y(vt)||vt.contentEditable==="true")&&(Jo=vt,_f=se,ac=null);break;case"focusout":ac=_f=Jo=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,nv(Re,o,be);break;case"selectionchange":if(Lk)break;case"keydown":case"keyup":nv(Re,o,be)}var Zt;if(jn)e:{switch(t){case"compositionstart":var on="onCompositionStart";break e;case"compositionend":on="onCompositionEnd";break e;case"compositionupdate":on="onCompositionUpdate";break e}on=void 0}else Xo?fo(t,o)&&(on="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(on="onCompositionStart");on&&(ya&&o.locale!=="ko"&&(Xo||on!=="onCompositionStart"?on==="onCompositionEnd"&&Xo&&(Zt=ns()):(vn=be,Wn="value"in vn?vn.value:vn.textContent,Xo=!0)),vt=Ph(se,on),0<vt.length&&(on=new ga(on,t,null,o,be),Re.push({event:on,listeners:vt}),Zt?on.data=Zt:(Zt=Qo(o),Zt!==null&&(on.data=Zt)))),(Zt=Vr?Sk(t,o):Nk(t,o))&&(on=Ph(se,"onBeforeInput"),0<on.length&&(vt=new ga("onBeforeInput","beforeinput",null,o,be),Re.push({event:vt,listeners:on}),vt.data=Zt)),bT(Re,t,se,o,be)}N0(Re,r)})}function Rc(t,r,o){return{instance:t,listener:r,currentTarget:o}}function Ph(t,r){for(var o=r+"Capture",c=[];t!==null;){var f=t,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Mt(t,o),f!=null&&c.unshift(Rc(t,f,m)),f=Mt(t,r),f!=null&&c.push(Rc(t,f,m))),t.tag===3)return c;t=t.return}return[]}function kT(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function R0(t,r,o,c,f){for(var m=r._reactName,b=[];o!==null&&o!==c;){var S=o,B=S.alternate,se=S.stateNode;if(S=S.tag,B!==null&&B===c)break;S!==5&&S!==26&&S!==27||se===null||(B=se,f?(se=Mt(o,m),se!=null&&b.unshift(Rc(o,se,B))):f||(se=Mt(o,m),se!=null&&b.push(Rc(o,se,B)))),o=o.return}b.length!==0&&t.push({event:r,listeners:b})}var TT=/\r\n?/g,jT=/\u0000|\uFFFD/g;function A0(t){return(typeof t=="string"?t:""+t).replace(TT,`
`).replace(jT,"")}function I0(t,r){return r=A0(r),A0(t)===r}function Ln(t,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Bn(t,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Bn(t,""+c);break;case"className":re(t,"class",c);break;case"tabIndex":re(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":re(t,o,c);break;case"style":Cs(t,c,m);break;case"data":if(r!=="object"){re(t,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){t.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=pa(""+c),t.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&Ln(t,r,"name",f.name,f,null),Ln(t,r,"formEncType",f.formEncType,f,null),Ln(t,r,"formMethod",f.formMethod,f,null),Ln(t,r,"formTarget",f.formTarget,f,null)):(Ln(t,r,"encType",f.encType,f,null),Ln(t,r,"method",f.method,f,null),Ln(t,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=pa(""+c),t.setAttribute(o,c);break;case"onClick":c!=null&&(t.onclick=A);break;case"onScroll":c!=null&&rn("scroll",t);break;case"onScrollEnd":c!=null&&rn("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=o}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}o=pa(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""+c):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":c===!0?t.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,c):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(o,c):t.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(o):t.setAttribute(o,c);break;case"popover":rn("beforetoggle",t),rn("toggle",t),de(t,"popover",c);break;case"xlinkActuate":Ce(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ce(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ce(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ce(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ce(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ce(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":de(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Lr.get(o)||o,de(t,o,c))}}function Km(t,r,o,c,f,m){switch(o){case"style":Cs(t,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=o}}break;case"children":typeof c=="string"?Bn(t,c):(typeof c=="number"||typeof c=="bigint")&&Bn(t,""+c);break;case"onScroll":c!=null&&rn("scroll",t);break;case"onScrollEnd":c!=null&&rn("scrollend",t);break;case"onClick":c!=null&&(t.onclick=A);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ee.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=t[Rt]||null,m=m!=null?m[o]:null,typeof m=="function"&&t.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(r,c,f);break e}o in t?t[o]=c:c===!0?t.setAttribute(o,""):de(t,o,c)}}}function zs(t,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rn("error",t),rn("load",t);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var b=o[m];if(b!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Ln(t,r,m,b,o,null)}}f&&Ln(t,r,"srcSet",o.srcSet,o,null),c&&Ln(t,r,"src",o.src,o,null);return;case"input":rn("invalid",t);var S=m=b=f=null,B=null,se=null;for(c in o)if(o.hasOwnProperty(c)){var be=o[c];if(be!=null)switch(c){case"name":f=be;break;case"type":b=be;break;case"checked":B=be;break;case"defaultChecked":se=be;break;case"value":m=be;break;case"defaultValue":S=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(i(137,r));break;default:Ln(t,r,c,be,o,null)}}La(t,m,S,B,se,b,f,!1);return;case"select":rn("invalid",t),c=b=m=null;for(f in o)if(o.hasOwnProperty(f)&&(S=o[f],S!=null))switch(f){case"value":m=S;break;case"defaultValue":b=S;break;case"multiple":c=S;default:Ln(t,r,f,S,o,null)}r=m,o=b,t.multiple=!!c,r!=null?wr(t,!!c,r,!1):o!=null&&wr(t,!!c,o,!0);return;case"textarea":rn("invalid",t),m=f=c=null;for(b in o)if(o.hasOwnProperty(b)&&(S=o[b],S!=null))switch(b){case"value":c=S;break;case"defaultValue":f=S;break;case"children":m=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Ln(t,r,b,S,o,null)}$n(t,c,f,m);return;case"option":for(B in o)o.hasOwnProperty(B)&&(c=o[B],c!=null)&&(B==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":Ln(t,r,B,c,o,null));return;case"dialog":rn("beforetoggle",t),rn("toggle",t),rn("cancel",t),rn("close",t);break;case"iframe":case"object":rn("load",t);break;case"video":case"audio":for(c=0;c<Cc.length;c++)rn(Cc[c],t);break;case"image":rn("error",t),rn("load",t);break;case"details":rn("toggle",t);break;case"embed":case"source":case"link":rn("error",t),rn("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(c=o[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Ln(t,r,se,c,o,null)}return;default:if(Ds(r)){for(be in o)o.hasOwnProperty(be)&&(c=o[be],c!==void 0&&Km(t,r,be,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Ln(t,r,S,c,o,null))}function ET(t,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,b=null,S=null,B=null,se=null,be=null;for(fe in o){var Re=o[fe];if(o.hasOwnProperty(fe)&&Re!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":B=Re;default:c.hasOwnProperty(fe)||Ln(t,r,fe,null,c,Re)}}for(var ie in c){var fe=c[ie];if(Re=o[ie],c.hasOwnProperty(ie)&&(fe!=null||Re!=null))switch(ie){case"type":m=fe;break;case"name":f=fe;break;case"checked":se=fe;break;case"defaultChecked":be=fe;break;case"value":b=fe;break;case"defaultValue":S=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,r));break;default:fe!==Re&&Ln(t,r,ie,fe,c,Re)}}xr(t,b,S,B,se,be,m,f);return;case"select":fe=b=S=ie=null;for(m in o)if(B=o[m],o.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":fe=B;default:c.hasOwnProperty(m)||Ln(t,r,m,null,c,B)}for(f in c)if(m=c[f],B=o[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":ie=m;break;case"defaultValue":S=m;break;case"multiple":b=m;default:m!==B&&Ln(t,r,f,m,c,B)}r=S,o=b,c=fe,ie!=null?wr(t,!!o,ie,!1):!!c!=!!o&&(r!=null?wr(t,!!o,r,!0):wr(t,!!o,o?[]:"",!1));return;case"textarea":fe=ie=null;for(S in o)if(f=o[S],o.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ln(t,r,S,null,c,f)}for(b in c)if(f=c[b],m=o[b],c.hasOwnProperty(b)&&(f!=null||m!=null))switch(b){case"value":ie=f;break;case"defaultValue":fe=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Ln(t,r,b,f,c,m)}pn(t,ie,fe);return;case"option":for(var dt in o)ie=o[dt],o.hasOwnProperty(dt)&&ie!=null&&!c.hasOwnProperty(dt)&&(dt==="selected"?t.selected=!1:Ln(t,r,dt,null,c,ie));for(B in c)ie=c[B],fe=o[B],c.hasOwnProperty(B)&&ie!==fe&&(ie!=null||fe!=null)&&(B==="selected"?t.selected=ie&&typeof ie!="function"&&typeof ie!="symbol":Ln(t,r,B,ie,c,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in o)ie=o[It],o.hasOwnProperty(It)&&ie!=null&&!c.hasOwnProperty(It)&&Ln(t,r,It,null,c,ie);for(se in c)if(ie=c[se],fe=o[se],c.hasOwnProperty(se)&&ie!==fe&&(ie!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,r));break;default:Ln(t,r,se,ie,c,fe)}return;default:if(Ds(r)){for(var On in o)ie=o[On],o.hasOwnProperty(On)&&ie!==void 0&&!c.hasOwnProperty(On)&&Km(t,r,On,void 0,c,ie);for(be in c)ie=c[be],fe=o[be],!c.hasOwnProperty(be)||ie===fe||ie===void 0&&fe===void 0||Km(t,r,be,ie,c,fe);return}}for(var Q in o)ie=o[Q],o.hasOwnProperty(Q)&&ie!=null&&!c.hasOwnProperty(Q)&&Ln(t,r,Q,null,c,ie);for(Re in c)ie=c[Re],fe=o[Re],!c.hasOwnProperty(Re)||ie===fe||ie==null&&fe==null||Ln(t,r,Re,ie,c,fe)}function M0(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ST(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,b=f.initiatorType,S=f.duration;if(m&&S&&M0(b)){for(b=0,S=f.responseEnd,c+=1;c<o.length;c++){var B=o[c],se=B.startTime;if(se>S)break;var be=B.transferSize,Re=B.initiatorType;be&&M0(Re)&&(B=B.responseEnd,b+=be*(B<S?1:(S-se)/(B-se)))}if(--c,r+=8*(m+b)/(f.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Ym=null,Qm=null;function Lh(t){return t.nodeType===9?t:t.ownerDocument}function D0(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function P0(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function Xm(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Jm=null;function NT(){var t=window.event;return t&&t.type==="popstate"?t===Jm?!1:(Jm=t,!0):(Jm=null,!1)}var L0=typeof setTimeout=="function"?setTimeout:void 0,CT=typeof clearTimeout=="function"?clearTimeout:void 0,O0=typeof Promise=="function"?Promise:void 0,RT=typeof queueMicrotask=="function"?queueMicrotask:typeof O0<"u"?function(t){return O0.resolve(null).then(t).catch(AT)}:L0;function AT(t){setTimeout(function(){throw t})}function Ai(t){return t==="head"}function V0(t,r){var o=r,c=0;do{var f=o.nextSibling;if(t.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){t.removeChild(f),jl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Ac(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,Ac(o);for(var m=o.firstChild;m;){var b=m.nextSibling,S=m.nodeName;m[bs]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=b}}else o==="body"&&Ac(t.ownerDocument.body);o=f}while(o);jl(r)}function B0(t,r){var o=t;t=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=c}while(o)}function Zm(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Zm(o),Ms(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function IT(t,r,o,c){for(;t.nodeType===1;){var f=o;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[bs])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=$r(t.nextSibling),t===null)break}return null}function MT(t,r,o){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=$r(t.nextSibling),t===null))return null;return t}function U0(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=$r(t.nextSibling),t===null))return null;return t}function ep(t){return t.data==="$?"||t.data==="$~"}function tp(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function DT(t,r){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function $r(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var np=null;function z0(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(r===0)return $r(t.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}t=t.nextSibling}return null}function F0(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return t;r--}else o!=="/$"&&o!=="/&"||r++}t=t.previousSibling}return null}function q0(t,r,o){switch(r=Lh(o),t){case"html":if(t=r.documentElement,!t)throw Error(i(452));return t;case"head":if(t=r.head,!t)throw Error(i(453));return t;case"body":if(t=r.body,!t)throw Error(i(454));return t;default:throw Error(i(451))}}function Ac(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Ms(t)}var Wr=new Map,H0=new Set;function Oh(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ja=Se.d;Se.d={f:PT,r:LT,D:OT,C:VT,L:BT,m:UT,X:FT,S:zT,M:qT};function PT(){var t=Ja.f(),r=Nh();return t||r}function LT(t){var r=F(t);r!==null&&r.tag===5&&r.type==="form"?ob(r):Ja.r(t)}var _l=typeof document>"u"?null:document;function $0(t,r,o){var c=_l;if(c&&typeof r=="string"&&r){var f=mn(r);f='link[rel="'+t+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),H0.has(f)||(H0.add(f),t={rel:t,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),zs(r,"link",t),C(r),c.head.appendChild(r)))}}function OT(t){Ja.D(t),$0("dns-prefetch",t,null)}function VT(t,r){Ja.C(t,r),$0("preconnect",t,r)}function BT(t,r,o){Ja.L(t,r,o);var c=_l;if(c&&t&&r){var f='link[rel="preload"][as="'+mn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+mn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+mn(o.imageSizes)+'"]')):f+='[href="'+mn(t)+'"]';var m=f;switch(r){case"style":m=kl(t);break;case"script":m=Tl(t)}Wr.has(m)||(t=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:t,as:r},o),Wr.set(m,t),c.querySelector(f)!==null||r==="style"&&c.querySelector(Ic(m))||r==="script"&&c.querySelector(Mc(m))||(r=c.createElement("link"),zs(r,"link",t),C(r),c.head.appendChild(r)))}}function UT(t,r){Ja.m(t,r);var o=_l;if(o&&t){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+mn(c)+'"][href="'+mn(t)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Tl(t)}if(!Wr.has(m)&&(t=k({rel:"modulepreload",href:t},r),Wr.set(m,t),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Mc(m)))return}c=o.createElement("link"),zs(c,"link",t),C(c),o.head.appendChild(c)}}}function zT(t,r,o){Ja.S(t,r,o);var c=_l;if(c&&t){var f=T(c).hoistableStyles,m=kl(t);r=r||"default";var b=f.get(m);if(!b){var S={loading:0,preload:null};if(b=c.querySelector(Ic(m)))S.loading=5;else{t=k({rel:"stylesheet",href:t,"data-precedence":r},o),(o=Wr.get(m))&&sp(t,o);var B=b=c.createElement("link");C(B),zs(B,"link",t),B._p=new Promise(function(se,be){B.onload=se,B.onerror=be}),B.addEventListener("load",function(){S.loading|=1}),B.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Vh(b,r,c)}b={type:"stylesheet",instance:b,count:1,state:S},f.set(m,b)}}}function FT(t,r){Ja.X(t,r);var o=_l;if(o&&t){var c=T(o).hoistableScripts,f=Tl(t),m=c.get(f);m||(m=o.querySelector(Mc(f)),m||(t=k({src:t,async:!0},r),(r=Wr.get(f))&&rp(t,r),m=o.createElement("script"),C(m),zs(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function qT(t,r){Ja.M(t,r);var o=_l;if(o&&t){var c=T(o).hoistableScripts,f=Tl(t),m=c.get(f);m||(m=o.querySelector(Mc(f)),m||(t=k({src:t,async:!0,type:"module"},r),(r=Wr.get(f))&&rp(t,r),m=o.createElement("script"),C(m),zs(m,"link",t),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function W0(t,r,o,c){var f=(f=ke.current)?Oh(f):null;if(!f)throw Error(i(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=kl(o.href),o=T(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=kl(o.href);var m=T(f).hoistableStyles,b=m.get(t);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,b),(m=f.querySelector(Ic(t)))&&!m._p&&(b.instance=m,b.state.loading=5),Wr.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Wr.set(t,o),m||HT(f,t,o,b.state))),r&&c===null)throw Error(i(528,""));return b}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Tl(o),o=T(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,t))}}function kl(t){return'href="'+mn(t)+'"'}function Ic(t){return'link[rel="stylesheet"]['+t+"]"}function G0(t){return k({},t,{"data-precedence":t.precedence,precedence:null})}function HT(t,r,o,c){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=t.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),zs(r,"link",o),C(r),t.head.appendChild(r))}function Tl(t){return'[src="'+mn(t)+'"]'}function Mc(t){return"script[async]"+t}function K0(t,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=t.querySelector('style[data-href~="'+mn(o.href)+'"]');if(c)return r.instance=c,C(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),C(c),zs(c,"style",f),Vh(c,o.precedence,t),r.instance=c;case"stylesheet":f=kl(o.href);var m=t.querySelector(Ic(f));if(m)return r.state.loading|=4,r.instance=m,C(m),m;c=G0(o),(f=Wr.get(f))&&sp(c,f),m=(t.ownerDocument||t).createElement("link"),C(m);var b=m;return b._p=new Promise(function(S,B){b.onload=S,b.onerror=B}),zs(m,"link",c),r.state.loading|=4,Vh(m,o.precedence,t),r.instance=m;case"script":return m=Tl(o.src),(f=t.querySelector(Mc(m)))?(r.instance=f,C(f),f):(c=o,(f=Wr.get(m))&&(c=k({},o),rp(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),C(f),zs(f,"link",c),t.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Vh(c,o.precedence,t));return r.instance}function Vh(t,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,b=0;b<c.length;b++){var S=c[b];if(S.dataset.precedence===r)m=S;else if(m!==f)break}m?m.parentNode.insertBefore(t,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(t,r.firstChild))}function sp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function rp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var Bh=null;function Y0(t,r,o){if(Bh===null){var c=new Map,f=Bh=new Map;f.set(o,c)}else f=Bh,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(t))return c;for(c.set(t,null),o=o.getElementsByTagName(t),f=0;f<o.length;f++){var m=o[f];if(!(m[bs]||m[ot]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var b=m.getAttribute(r)||"";b=t+b;var S=c.get(b);S?S.push(m):c.set(b,[m])}}return c}function Q0(t,r,o){t=t.ownerDocument||t,t.head.insertBefore(o,r==="title"?t.querySelector("head > title"):null)}function $T(t,r,o){if(o===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(t=r.disabled,typeof r.precedence=="string"&&t==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function X0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function WT(t,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=kl(c.href),m=r.querySelector(Ic(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=Uh.bind(t),r.then(t,t)),o.state.loading|=4,o.instance=m,C(m);return}m=r.ownerDocument||r,c=G0(c),(f=Wr.get(f))&&sp(c,f),m=m.createElement("link"),C(m);var b=m;b._p=new Promise(function(S,B){b.onload=S,b.onerror=B}),zs(m,"link",c),o.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=Uh.bind(t),r.addEventListener("load",o),r.addEventListener("error",o))}}var ap=0;function GT(t,r){return t.stylesheets&&t.count===0&&Fh(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var c=setTimeout(function(){if(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+r);0<t.imgBytes&&ap===0&&(ap=62500*ST());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Fh(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>ap?50:800)+r);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Uh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fh(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var zh=null;function Fh(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,zh=new Map,r.forEach(KT,t),zh=null,Uh.call(t))}function KT(t,r){if(!(r.state.loading&4)){var o=zh.get(t);if(o)var c=o.get(null);else{o=new Map,zh.set(t,o);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var b=f[m];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),c=b)}c&&o.set(null,c)}f=r.instance,b=f.getAttribute("data-precedence"),m=o.get(b)||c,m===c&&o.set(null,f),o.set(b,f),this.count++,c=Uh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),r.state.loading|=4}}var Dc={$$typeof:me,Provider:null,Consumer:null,_currentValue:Oe,_currentValue2:Oe,_threadCount:0};function YT(t,r,o,c,f,m,b,S,B){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hn(0),this.hiddenUpdates=Hn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function J0(t,r,o,c,f,m,b,S,B,se,be,Re){return t=new YT(t,r,o,b,B,se,be,Re,S),r=1,m===!0&&(r|=24),m=Sr(3,null,null,r),t.current=m,m.stateNode=t,r=Vf(),r.refCount++,t.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},Ff(m),t}function Z0(t){return t?(t=tl,t):tl}function e1(t,r,o,c,f,m){f=Z0(f),c.context===null?c.context=f:c.pendingContext=f,c=xi(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=wi(t,c,r),o!==null&&(gr(o,t,r),dc(o,t,r))}function t1(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function ip(t,r){t1(t,r),(t=t.alternate)&&t1(t,r)}function n1(t){if(t.tag===13||t.tag===31){var r=go(t,67108864);r!==null&&gr(r,t,67108864),ip(t,67108864)}}function s1(t){if(t.tag===13||t.tag===31){var r=Ir();r=q(r);var o=go(t,r);o!==null&&gr(o,t,r),ip(t,r)}}var qh=!0;function QT(t,r,o,c){var f=Y.T;Y.T=null;var m=Se.p;try{Se.p=2,op(t,r,o,c)}finally{Se.p=m,Y.T=f}}function XT(t,r,o,c){var f=Y.T;Y.T=null;var m=Se.p;try{Se.p=8,op(t,r,o,c)}finally{Se.p=m,Y.T=f}}function op(t,r,o,c){if(qh){var f=lp(c);if(f===null)Gm(t,r,c,Hh,o),a1(t,c);else if(ZT(f,t,r,o,c))c.stopPropagation();else if(a1(t,c),r&4&&-1<JT.indexOf(t)){for(;f!==null;){var m=F(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var b=wn(m.pendingLanes);if(b!==0){var S=m;for(S.pendingLanes|=2,S.entangledLanes|=2;b;){var B=1<<31-qe(b);S.entanglements[1]|=B,b&=~B}wa(m),(En&6)===0&&(Eh=pt()+500,Nc(0))}}break;case 31:case 13:S=go(m,2),S!==null&&gr(S,m,2),Nh(),ip(m,2)}if(m=lp(c),m===null&&Gm(t,r,c,Hh,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else Gm(t,r,c,null,o)}}function lp(t){return t=Me(t),cp(t)}var Hh=null;function cp(t){if(Hh=null,t=Cn(t),t!==null){var r=u(t);if(r===null)t=null;else{var o=r.tag;if(o===13){if(t=h(r),t!==null)return t;t=null}else if(o===31){if(t=p(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return Hh=t,null}function r1(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dt()){case at:return 2;case St:return 8;case ce:case xe:return 32;case Ie:return 268435456;default:return 32}default:return 32}}var up=!1,Ii=null,Mi=null,Di=null,Pc=new Map,Lc=new Map,Pi=[],JT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function a1(t,r){switch(t){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":Pc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(r.pointerId)}}function Oc(t,r,o,c,f,m){return t===null||t.nativeEvent!==m?(t={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=F(r),r!==null&&n1(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),t)}function ZT(t,r,o,c,f){switch(r){case"focusin":return Ii=Oc(Ii,t,r,o,c,f),!0;case"dragenter":return Mi=Oc(Mi,t,r,o,c,f),!0;case"mouseover":return Di=Oc(Di,t,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Pc.set(m,Oc(Pc.get(m)||null,t,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Lc.set(m,Oc(Lc.get(m)||null,t,r,o,c,f)),!0}return!1}function i1(t){var r=Cn(t.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){t.blockedOn=r,ve(t.priority,function(){s1(o)});return}}else if(r===31){if(r=p(o),r!==null){t.blockedOn=r,ve(t.priority,function(){s1(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $h(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=lp(t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);J=c,o.target.dispatchEvent(c),J=null}else return r=F(o),r!==null&&n1(r),t.blockedOn=o,!1;r.shift()}return!0}function o1(t,r,o){$h(t)&&o.delete(r)}function ej(){up=!1,Ii!==null&&$h(Ii)&&(Ii=null),Mi!==null&&$h(Mi)&&(Mi=null),Di!==null&&$h(Di)&&(Di=null),Pc.forEach(o1),Lc.forEach(o1)}function Wh(t,r){t.blockedOn===r&&(t.blockedOn=null,up||(up=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,ej)))}var Gh=null;function l1(t){Gh!==t&&(Gh=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Gh===t&&(Gh=null);for(var r=0;r<t.length;r+=3){var o=t[r],c=t[r+1],f=t[r+2];if(typeof c!="function"){if(cp(c||o)===null)continue;break}var m=F(o);m!==null&&(t.splice(r,3),r-=3,lm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function jl(t){function r(B){return Wh(B,t)}Ii!==null&&Wh(Ii,t),Mi!==null&&Wh(Mi,t),Di!==null&&Wh(Di,t),Pc.forEach(r),Lc.forEach(r);for(var o=0;o<Pi.length;o++){var c=Pi[o];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Pi.length&&(o=Pi[0],o.blockedOn===null);)i1(o),o.blockedOn===null&&Pi.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],b=f[Rt]||null;if(typeof m=="function")b||l1(o);else if(b){var S=null;if(m&&m.hasAttribute("formAction")){if(f=m,b=m[Rt]||null)S=b.formAction;else if(cp(f)!==null)continue}else S=b.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),l1(o)}}}function c1(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(b){return f=b})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function hp(t){this._internalRoot=t}Kh.prototype.render=hp.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Ir();e1(o,c,t,r,null,null)},Kh.prototype.unmount=hp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;e1(t.current,2,null,t,null,null),Nh(),r[ut]=null}};function Kh(t){this._internalRoot=t}Kh.prototype.unstable_scheduleHydration=function(t){if(t){var r=we();t={blockedOn:null,target:t,priority:r};for(var o=0;o<Pi.length&&r!==0&&r<Pi[o].priority;o++);Pi.splice(o,0,t),o===0&&i1(t)}};var u1=e.version;if(u1!=="19.2.4")throw Error(i(527,u1,"19.2.4"));Se.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(i(188)):(t=Object.keys(t).join(","),Error(i(268,t)));return t=y(r),t=t!==null?x(t):null,t=t===null?null:t.stateNode,t};var tj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{We=Yh.inject(tj),nt=Yh}catch{}}return Bc.createRoot=function(t,r){if(!l(t))throw Error(i(299));var o=!1,c="",f=yb,m=vb,b=bb;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError)),r=J0(t,1,!1,null,null,o,c,null,f,m,b,c1),t[ut]=r.current,Wm(t),new hp(r)},Bc.hydrateRoot=function(t,r,o){if(!l(t))throw Error(i(299));var c=!1,f="",m=yb,b=vb,S=bb,B=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(B=o.formState)),r=J0(t,1,!0,r,o??null,c,f,B,m,b,S,c1),r.context=Z0(null),o=r.current,c=Ir(),c=q(c),f=xi(c),f.callback=null,wi(o,f,c),o=c,r.current.lanes=o,hs(r,o),wa(r),t[ut]=r.current,Wm(t),new Kh(r)},Bc.version="19.2.4",Bc}var x1;function hj(){if(x1)return mp.exports;x1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mp.exports=uj(),mp.exports}var dj=hj();const fj="modulepreload",mj=function(s){return"/login/"+s},w1={},Qr=function(e,n,i){let l=Promise.resolve();if(n&&n.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(n.map(y=>{if(y=mj(y),y in w1)return;w1[y]=!0;const x=y.endsWith(".css"),k=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":fj,x||(E.as="script"),E.crossOrigin="",E.href=y,p&&E.setAttribute("nonce",p),document.head.appendChild(E),x)return new Promise((O,G)=>{E.addEventListener("load",O),E.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var _1="popstate";function pj(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return Qp("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(i,l){return typeof l=="string"?l:iu(l)}return yj(e,n,null,s)}function ts(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Yr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gj(){return Math.random().toString(36).substring(2,10)}function k1(s,e){return{usr:s.state,key:s.key,idx:e}}function Qp(s,e,n=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Wl(e):e,state:n,key:e&&e.key||i||gj()}}function iu({pathname:s="/",search:e="",hash:n=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function Wl(s){let e={};if(s){let n=s.indexOf("#");n>=0&&(e.hash=s.substring(n),s=s.substring(0,n));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function yj(s,e,n,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=x();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function x(){return(h.state||{idx:null}).idx}function k(){p="POP";let V=x(),te=V==null?null:V-y;y=V,g&&g({action:p,location:U.location,delta:te})}function E(V,te){p="PUSH";let X=Qp(U.location,V,te);y=x()+1;let me=k1(X,y),Ee=U.createHref(X);try{h.pushState(me,"",Ee)}catch(ze){if(ze instanceof DOMException&&ze.name==="DataCloneError")throw ze;l.location.assign(Ee)}u&&g&&g({action:p,location:U.location,delta:1})}function O(V,te){p="REPLACE";let X=Qp(U.location,V,te);y=x();let me=k1(X,y),Ee=U.createHref(X);h.replaceState(me,"",Ee),u&&g&&g({action:p,location:U.location,delta:0})}function G(V){return vj(V)}let U={get action(){return p},get location(){return s(l,h)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(_1,k),g=V,()=>{l.removeEventListener(_1,k),g=null}},createHref(V){return e(l,V)},createURL:G,encodeLocation(V){let te=G(V);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:E,replace:O,go(V){return h.go(V)}};return U}function vj(s,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ts(n,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:iu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function w2(s,e,n="/"){return bj(s,e,n,!1)}function bj(s,e,n,i){let l=typeof e=="string"?Wl(e):e,u=ai(l.pathname||"/",n);if(u==null)return null;let h=_2(s);xj(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=Aj(u);p=Cj(h[g],y,i)}return p}function _2(s,e=[],n=[],i="",l=!1){let u=(h,p,g=l,y)=>{let x={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;ts(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let k=ti([i,x.relativePath]),E=n.concat(x);h.children&&h.children.length>0&&(ts(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),_2(h.children,e,E,k,g)),!(h.path==null&&!h.index)&&e.push({path:k,score:Sj(k,h.index),routesMeta:E})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of k2(h.path))u(h,p,!0,g)}),e}function k2(s){let e=s.split("/");if(e.length===0)return[];let[n,...i]=e,l=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=k2(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function xj(s){s.sort((e,n)=>e.score!==n.score?n.score-e.score:Nj(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var wj=/^:[\w-]+$/,_j=3,kj=2,Tj=1,jj=10,Ej=-2,T1=s=>s==="*";function Sj(s,e){let n=s.split("/"),i=n.length;return n.some(T1)&&(i+=Ej),e&&(i+=kj),n.filter(l=>!T1(l)).reduce((l,u)=>l+(wj.test(u)?_j:u===""?Tj:jj),i)}function Nj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Cj(s,e,n=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",k=kd({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),E=g.route;if(!k&&y&&n&&!i[i.length-1].route.index&&(k=kd({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!k)return null;Object.assign(l,k.params),h.push({params:l,pathname:ti([u,k.pathname]),pathnameBase:Pj(ti([u,k.pathnameBase])),route:E}),k.pathnameBase!=="/"&&(u=ti([u,k.pathnameBase]))}return h}function kd(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[n,i]=Rj(s.path,s.caseSensitive,s.end),l=e.match(n);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:k},E)=>{if(x==="*"){let G=p[E]||"";h=u.slice(0,u.length-G.length).replace(/(.)\/+$/,"$1")}const O=p[E];return k&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function Rj(s,e=!1,n=!0){Yr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function Aj(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ai(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=s.charAt(n);return i&&i!=="/"?null:s.slice(n)||"/"}var Ij=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Mj(s,e="/"){let{pathname:n,search:i="",hash:l=""}=typeof s=="string"?Wl(s):s,u;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?u=j1(n.substring(1),"/"):u=j1(n,e)):u=e,{pathname:u,search:Lj(i),hash:Oj(l)}}function j1(s,e){let n=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function vp(s,e,n,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Dj(s){return s.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Eg(s){let e=Dj(s);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Sg(s,e,n,i=!1){let l;typeof s=="string"?l=Wl(s):(l={...s},ts(!l.pathname||!l.pathname.includes("?"),vp("?","pathname","search",l)),ts(!l.pathname||!l.pathname.includes("#"),vp("#","pathname","hash",l)),ts(!l.search||!l.search.includes("#"),vp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=n;else{let k=e.length-1;if(!i&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),k-=1;l.pathname=E.join("/")}p=k>=0?e[k]:"/"}let g=Mj(l,p),y=h&&h!=="/"&&h.endsWith("/"),x=(u||h===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var ti=s=>s.join("/").replace(/\/\/+/g,"/"),Pj=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Lj=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Oj=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,Vj=class{constructor(s,e,n,i=!1){this.status=s,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Bj(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function Uj(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var T2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function j2(s,e){let n=s;if(typeof n!="string"||!Ij.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,l=!1;if(T2)try{let u=new URL(window.location.href),h=n.startsWith("//")?new URL(u.protocol+n):new URL(n),p=ai(h.pathname,e);h.origin===u.origin&&p!=null?n=p+h.search+h.hash:l=!0}catch{Yr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var E2=["POST","PUT","PATCH","DELETE"];new Set(E2);var zj=["GET",...E2];new Set(zj);var Gl=w.createContext(null);Gl.displayName="DataRouter";var Wd=w.createContext(null);Wd.displayName="DataRouterState";var Fj=w.createContext(!1),S2=w.createContext({isTransitioning:!1});S2.displayName="ViewTransition";var qj=w.createContext(new Map);qj.displayName="Fetchers";var Hj=w.createContext(null);Hj.displayName="Await";var Pr=w.createContext(null);Pr.displayName="Navigation";var bu=w.createContext(null);bu.displayName="Location";var fa=w.createContext({outlet:null,matches:[],isDataRoute:!1});fa.displayName="Route";var Ng=w.createContext(null);Ng.displayName="RouteError";var N2="REACT_ROUTER_ERROR",$j="REDIRECT",Wj="ROUTE_ERROR_RESPONSE";function Gj(s){if(s.startsWith(`${N2}:${$j}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Kj(s){if(s.startsWith(`${N2}:${Wj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Vj(e.status,e.statusText,e.data)}catch{}}function Yj(s,{relative:e}={}){ts(Kl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=w.useContext(Pr),{hash:l,pathname:u,search:h}=xu(s,{relative:e}),p=u;return n!=="/"&&(p=u==="/"?n:ti([n,u])),i.createHref({pathname:p,search:h,hash:l})}function Kl(){return w.useContext(bu)!=null}function ma(){return ts(Kl(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(bu).location}var C2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function R2(s){w.useContext(Pr).static||w.useLayoutEffect(s)}function Zs(){let{isDataRoute:s}=w.useContext(fa);return s?cE():Qj()}function Qj(){ts(Kl(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(Gl),{basename:e,navigator:n}=w.useContext(Pr),{matches:i}=w.useContext(fa),{pathname:l}=ma(),u=JSON.stringify(Eg(i)),h=w.useRef(!1);return R2(()=>{h.current=!0}),w.useCallback((g,y={})=>{if(Yr(h.current,C2),!h.current)return;if(typeof g=="number"){n.go(g);return}let x=Sg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:ti([e,x.pathname])),(y.replace?n.replace:n.push)(x,y.state,y)},[e,n,u,l,s])}w.createContext(null);function Xj(){let{matches:s}=w.useContext(fa),e=s[s.length-1];return e?e.params:{}}function xu(s,{relative:e}={}){let{matches:n}=w.useContext(fa),{pathname:i}=ma(),l=JSON.stringify(Eg(n));return w.useMemo(()=>Sg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function Jj(s,e){return A2(s,e)}function A2(s,e,n,i,l){ts(Kl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Pr),{matches:h}=w.useContext(fa),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",k=p&&p.route;{let X=k&&k.path||"";M2(y,!k||X.endsWith("*")||X.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${X}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${X}"> to <Route path="${X==="/"?"*":`${X}/*`}">.`)}let E=ma(),O;if(e){let X=typeof e=="string"?Wl(e):e;ts(x==="/"||X.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${X.pathname}" was given in the \`location\` prop.`),O=X}else O=E;let G=O.pathname||"/",U=G;if(x!=="/"){let X=x.replace(/^\//,"").split("/");U="/"+G.replace(/^\//,"").split("/").slice(X.length).join("/")}let V=w2(s,{pathname:U});Yr(k||V!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Yr(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=sE(V&&V.map(X=>Object.assign({},X,{params:Object.assign({},g,X.params),pathname:ti([x,u.encodeLocation?u.encodeLocation(X.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:X.pathname]),pathnameBase:X.pathnameBase==="/"?x:ti([x,u.encodeLocation?u.encodeLocation(X.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:X.pathnameBase])})),h,n,i,l);return e&&te?w.createElement(bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function Zj(){let s=lE(),e=Bj(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),n=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),n?w.createElement("pre",{style:l},n):null,h)}var eE=w.createElement(Zj,null),I2=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const n=Kj(s.digest);n&&(s=n)}let e=s!==void 0?w.createElement(fa.Provider,{value:this.props.routeContext},w.createElement(Ng.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(tE,{error:s},e):e}};I2.contextType=Fj;var bp=new WeakMap;function tE({children:s,error:e}){let{basename:n}=w.useContext(Pr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=Gj(e.digest);if(i){let l=bp.get(e);if(l)throw l;let u=j2(i.location,n);if(T2&&!bp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw bp.set(e,h),h}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function nE({routeContext:s,match:e,children:n}){let i=w.useContext(Gl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(fa.Provider,{value:s},n)}function sE(s,e=[],n=null,i=null,l=null){if(s==null){if(!n)return null;if(n.errors)s=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)s=n.matches;else return null}let u=s,h=n?.errors;if(h!=null){let x=u.findIndex(k=>k.route.id&&h?.[k.route.id]!==void 0);ts(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(n)for(let x=0;x<u.length;x++){let k=u[x];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=x),k.route.id){let{loaderData:E,errors:O}=n,G=k.route.loader&&!E.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||G){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=n&&i?(x,k)=>{i(x,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:Uj(n.matches),errorInfo:k})}:void 0;return u.reduceRight((x,k,E)=>{let O,G=!1,U=null,V=null;n&&(O=h&&k.route.id?h[k.route.id]:void 0,U=k.route.errorElement||eE,p&&(g<0&&E===0?(M2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,V=null):g===E&&(G=!0,V=k.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,E+1)),X=()=>{let me;return O?me=U:G?me=V:k.route.Component?me=w.createElement(k.route.Component,null):k.route.element?me=k.route.element:me=x,w.createElement(nE,{match:k,routeContext:{outlet:x,matches:te,isDataRoute:n!=null},children:me})};return n&&(k.route.ErrorBoundary||k.route.errorElement||E===0)?w.createElement(I2,{location:n.location,revalidation:n.revalidation,component:U,error:O,children:X(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):X()},null)}function Cg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rE(s){let e=w.useContext(Gl);return ts(e,Cg(s)),e}function aE(s){let e=w.useContext(Wd);return ts(e,Cg(s)),e}function iE(s){let e=w.useContext(fa);return ts(e,Cg(s)),e}function Rg(s){let e=iE(s),n=e.matches[e.matches.length-1];return ts(n.route.id,`${s} can only be used on routes that contain a unique "id"`),n.route.id}function oE(){return Rg("useRouteId")}function lE(){let s=w.useContext(Ng),e=aE("useRouteError"),n=Rg("useRouteError");return s!==void 0?s:e.errors?.[n]}function cE(){let{router:s}=rE("useNavigate"),e=Rg("useNavigate"),n=w.useRef(!1);return R2(()=>{n.current=!0}),w.useCallback(async(l,u={})=>{Yr(n.current,C2),n.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var E1={};function M2(s,e,n){!e&&!E1[s]&&(E1[s]=!0,Yr(!1,n))}w.memo(uE);function uE({routes:s,future:e,state:n,onError:i}){return A2(s,void 0,n,i,e)}function hE({to:s,replace:e,state:n,relative:i}){ts(Kl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Pr);Yr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(fa),{pathname:h}=ma(),p=Zs(),g=Sg(s,Eg(u),h,i==="path"),y=JSON.stringify(g);return w.useEffect(()=>{p(JSON.parse(y),{replace:e,state:n,relative:i})},[p,y,i,e,n]),null}function ss(s){ts(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dE({basename:s="/",children:e=null,location:n,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){ts(!Kl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=w.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof n=="string"&&(n=Wl(n));let{pathname:y="/",search:x="",hash:k="",state:E=null,key:O="default"}=n,G=w.useMemo(()=>{let U=ai(y,p);return U==null?null:{location:{pathname:U,search:x,hash:k,state:E,key:O},navigationType:i}},[p,y,x,k,E,O,i]);return Yr(G!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${k}" because it does not start with the basename, so the <Router> won't render anything.`),G==null?null:w.createElement(Pr.Provider,{value:g},w.createElement(bu.Provider,{children:e,value:G}))}function fE({children:s,location:e}){return Jj(Xp(s),e)}function Xp(s,e=[]){let n=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){n.push.apply(n,Xp(i.props.children,u));return}ts(i.type===ss,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ts(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Xp(i.props.children,u)),n.push(h)}),n}var hd="get",dd="application/x-www-form-urlencoded";function Gd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function mE(s){return Gd(s)&&s.tagName.toLowerCase()==="button"}function pE(s){return Gd(s)&&s.tagName.toLowerCase()==="form"}function gE(s){return Gd(s)&&s.tagName.toLowerCase()==="input"}function yE(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function vE(s,e){return s.button===0&&(!e||e==="_self")&&!yE(s)}function Jp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,n)=>{let i=s[n];return e.concat(Array.isArray(i)?i.map(l=>[n,l]):[[n,i]])},[]))}function bE(s,e){let n=Jp(s);return e&&e.forEach((i,l)=>{n.has(l)||e.getAll(l).forEach(u=>{n.append(l,u)})}),n}var Qh=null;function xE(){if(Qh===null)try{new FormData(document.createElement("form"),0),Qh=!1}catch{Qh=!0}return Qh}var wE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xp(s){return s!=null&&!wE.has(s)?(Yr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dd}"`),null):s}function _E(s,e){let n,i,l,u,h;if(pE(s)){let p=s.getAttribute("action");i=p?ai(p,e):null,n=s.getAttribute("method")||hd,l=xp(s.getAttribute("enctype"))||dd,u=new FormData(s)}else if(mE(s)||gE(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ai(g,e):null,n=s.getAttribute("formmethod")||p.getAttribute("method")||hd,l=xp(s.getAttribute("formenctype"))||xp(p.getAttribute("enctype"))||dd,u=new FormData(p,s),!xE()){let{name:y,type:x,value:k}=s;if(x==="image"){let E=y?`${y}.`:"";u.append(`${E}x`,"0"),u.append(`${E}y`,"0")}else y&&u.append(y,k)}}else{if(Gd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=hd,i=null,l=dd,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:n.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ag(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function kE(s,e,n,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return n?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ai(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function TE(s,e){if(s.id in e)return e[s.id];try{let n=await import(s.module);return e[s.id]=n,n}catch(n){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jE(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function EE(s,e,n){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await TE(u,n);return h.links?h.links():[]}return[]}));return RE(i.flat(1).filter(jE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function S1(s,e,n,i,l,u){let h=(g,y)=>n[y]?g.route.id!==n[y].route.id:!0,p=(g,y)=>n[y].pathname!==g.pathname||n[y].route.path?.endsWith("*")&&n[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function SE(s,e,{includeHydrateFallback:n}={}){return NE(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),n&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function NE(s){return[...new Set(s)]}function CE(s){let e={},n=Object.keys(s).sort();for(let i of n)e[i]=s[i];return e}function RE(s,e){let n=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(CE(l));return n.has(u)||(n.add(u),i.push({key:u,link:l})),i},[])}function D2(){let s=w.useContext(Gl);return Ag(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function AE(){let s=w.useContext(Wd);return Ag(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Ig=w.createContext(void 0);Ig.displayName="FrameworkContext";function P2(){let s=w.useContext(Ig);return Ag(s,"You must render this element inside a <HydratedRouter> element"),s}function IE(s,e){let n=w.useContext(Ig),[i,l]=w.useState(!1),[u,h]=w.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:k}=e,E=w.useRef(null);w.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let U=te=>{te.forEach(X=>{h(X.isIntersecting)})},V=new IntersectionObserver(U,{threshold:.5});return E.current&&V.observe(E.current),()=>{V.disconnect()}}},[s]),w.useEffect(()=>{if(i){let U=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(U)}}},[i]);let O=()=>{l(!0)},G=()=>{l(!1),h(!1)};return n?s!=="intent"?[u,E,{}]:[u,E,{onFocus:Uc(p,O),onBlur:Uc(g,G),onMouseEnter:Uc(y,O),onMouseLeave:Uc(x,G),onTouchStart:Uc(k,O)}]:[!1,E,{}]}function Uc(s,e){return n=>{s&&s(n),n.defaultPrevented||e(n)}}function ME({page:s,...e}){let{router:n}=D2(),i=w.useMemo(()=>w2(n.routes,s,n.basename),[n.routes,s,n.basename]);return i?w.createElement(PE,{page:s,matches:i,...e}):null}function DE(s){let{manifest:e,routeModules:n}=P2(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return EE(s,e,n).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,n]),i}function PE({page:s,matches:e,...n}){let i=ma(),{future:l,manifest:u,routeModules:h}=P2(),{basename:p}=D2(),{loaderData:g,matches:y}=AE(),x=w.useMemo(()=>S1(s,e,y,u,i,"data"),[s,e,y,u,i]),k=w.useMemo(()=>S1(s,e,y,u,i,"assets"),[s,e,y,u,i]),E=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let U=new Set,V=!1;if(e.forEach(X=>{let me=u.routes[X.route.id];!me||!me.hasLoader||(!x.some(Ee=>Ee.route.id===X.route.id)&&X.route.id in g&&h[X.route.id]?.shouldRevalidate||me.hasClientLoader?V=!0:U.add(X.route.id))}),U.size===0)return[];let te=kE(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&U.size>0&&te.searchParams.set("_routes",e.filter(X=>U.has(X.route.id)).map(X=>X.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,s,h]),O=w.useMemo(()=>SE(k,u),[k,u]),G=DE(k);return w.createElement(w.Fragment,null,E.map(U=>w.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...n})),O.map(U=>w.createElement("link",{key:U,rel:"modulepreload",href:U,...n})),G.map(({key:U,link:V})=>w.createElement("link",{key:U,nonce:n.nonce,...V,crossOrigin:V.crossOrigin??n.crossOrigin})))}function LE(...s){return e=>{s.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var OE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{OE&&(window.__reactRouterVersion="7.13.0")}catch{}function VE({basename:s,children:e,unstable_useTransitions:n,window:i}){let l=w.useRef();l.current==null&&(l.current=pj({window:i,v5Compat:!0}));let u=l.current,[h,p]=w.useState({action:u.action,location:u.location}),g=w.useCallback(y=>{n===!1?p(y):w.startTransition(()=>p(y))},[n]);return w.useLayoutEffect(()=>u.listen(g),[u,g]),w.createElement(dE,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:n})}var L2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,O2=w.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},G){let{basename:U,unstable_useTransitions:V}=w.useContext(Pr),te=typeof y=="string"&&L2.test(y),X=j2(y,U);y=X.to;let me=Yj(y,{relative:l}),[Ee,ze,Le]=IE(i,O),I=FE(y,{replace:h,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:E,unstable_useTransitions:V});function j(L){e&&e(L),L.defaultPrevented||I(L)}let R=w.createElement("a",{...O,...Le,href:X.absoluteURL||me,onClick:X.isExternal||u?e:j,ref:LE(G,ze),target:g,"data-discover":!te&&n==="render"?"true":void 0});return Ee&&!te?w.createElement(w.Fragment,null,R,w.createElement(ME,{page:me})):R});O2.displayName="Link";var BE=w.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},x){let k=xu(h,{relative:y.relative}),E=ma(),O=w.useContext(Wd),{navigator:G,basename:U}=w.useContext(Pr),V=O!=null&&KE(k)&&p===!0,te=G.encodeLocation?G.encodeLocation(k).pathname:k.pathname,X=E.pathname,me=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;n||(X=X.toLowerCase(),me=me?me.toLowerCase():null,te=te.toLowerCase()),me&&U&&(me=ai(me,U)||me);const Ee=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let ze=X===te||!l&&X.startsWith(te)&&X.charAt(Ee)==="/",Le=me!=null&&(me===te||!l&&me.startsWith(te)&&me.charAt(te.length)==="/"),I={isActive:ze,isPending:Le,isTransitioning:V},j=ze?e:void 0,R;typeof i=="function"?R=i(I):R=[i,ze?"active":null,Le?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let L=typeof u=="function"?u(I):u;return w.createElement(O2,{...y,"aria-current":j,className:R,ref:x,style:L,to:h,viewTransition:p},typeof g=="function"?g(I):g)});BE.displayName="NavLink";var UE=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:l,state:u,method:h=hd,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},G)=>{let{unstable_useTransitions:U}=w.useContext(Pr),V=WE(),te=GE(p,{relative:y}),X=h.toLowerCase()==="get"?"get":"post",me=typeof p=="string"&&L2.test(p),Ee=ze=>{if(g&&g(ze),ze.defaultPrevented)return;ze.preventDefault();let Le=ze.nativeEvent.submitter,I=Le?.getAttribute("formmethod")||h,j=()=>V(Le||ze.currentTarget,{fetcherKey:e,method:I,navigate:n,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:E});U&&n!==!1?w.startTransition(()=>j()):j()};return w.createElement("form",{ref:G,method:X,action:te,onSubmit:i?g:Ee,...O,"data-discover":!me&&s==="render"?"true":void 0})});UE.displayName="Form";function zE(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function V2(s){let e=w.useContext(Gl);return ts(e,zE(s)),e}function FE(s,{target:e,replace:n,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Zs(),x=ma(),k=xu(s,{relative:u});return w.useCallback(E=>{if(vE(E,e)){E.preventDefault();let O=n!==void 0?n:iu(x)===iu(k),G=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?w.startTransition(()=>G()):G()}},[x,y,k,n,i,e,s,l,u,h,p,g])}function qE(s){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(Jp(s)),n=w.useRef(!1),i=ma(),l=w.useMemo(()=>bE(i.search,n.current?null:e.current),[i.search]),u=Zs(),h=w.useCallback((p,g)=>{const y=Jp(typeof p=="function"?p(new URLSearchParams(l)):p);n.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var HE=0,$E=()=>`__${String(++HE)}__`;function WE(){let{router:s}=V2("useSubmit"),{basename:e}=w.useContext(Pr),n=oE(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:x,body:k}=_E(u,e);if(h.navigate===!1){let E=h.fetcherKey||$E();await i(E,n,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:x,body:k,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:x,body:k,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:n,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,n])}function GE(s,{relative:e}={}){let{basename:n}=w.useContext(Pr),i=w.useContext(fa);ts(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...xu(s||".",{relative:e})},h=ma();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let x=p.toString();u.search=x?`?${x}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(u.pathname=u.pathname==="/"?n:ti([n,u.pathname])),iu(u)}function KE(s,{relative:e}={}){let n=w.useContext(S2);ts(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=V2("useViewTransitionState"),l=xu(s,{relative:e});if(!n.isTransitioning)return!1;let u=ai(n.currentLocation.pathname,i)||n.currentLocation.pathname,h=ai(n.nextLocation.pathname,i)||n.nextLocation.pathname;return kd(l.pathname,h)!=null||kd(l.pathname,u)!=null}const YE=()=>{};var N1={};const B2=function(s){const e=[];let n=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[n++]=l:l<2048?(e[n++]=l>>6|192,e[n++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[n++]=l>>18|240,e[n++]=l>>12&63|128,e[n++]=l>>6&63|128,e[n++]=l&63|128):(e[n++]=l>>12|224,e[n++]=l>>6&63|128,e[n++]=l&63|128)}return e},QE=function(s){const e=[];let n=0,i=0;for(;n<s.length;){const l=s[n++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[n++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[n++],h=s[n++],p=s[n++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[n++],h=s[n++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},U2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,x=u>>2,k=(u&3)<<4|p>>4;let E=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(E=64)),i.push(n[x],n[k],n[E],n[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(B2(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):QE(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=n[s.charAt(l++)],p=l<s.length?n[s.charAt(l)]:0;++l;const y=l<s.length?n[s.charAt(l)]:64;++l;const k=l<s.length?n[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new XE;const E=u<<2|p>>4;if(i.push(E),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const G=y<<6&192|k;i.push(G)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class XE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JE=function(s){const e=B2(s);return U2.encodeByteArray(e,!0)},Td=function(s){return JE(s).replace(/\./g,"")},z2=function(s){try{return U2.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const eS=()=>ZE().__FIREBASE_DEFAULTS__,tS=()=>{if(typeof process>"u"||typeof N1>"u")return;const s=N1.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},nS=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&z2(s[1]);return e&&JSON.parse(e)},Kd=()=>{try{return YE()||eS()||tS()||nS()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},F2=s=>Kd()?.emulatorHosts?.[s],q2=s=>{const e=F2(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},H2=()=>Kd()?.config,$2=s=>Kd()?.[`_${s}`];class sS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function io(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mg(s){return(await fetch(s,{credentials:"include"})).ok}function W2(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Td(JSON.stringify(n)),Td(JSON.stringify(h)),""].join(".")}const Jc={};function rS(){const s={prod:[],emulator:[]};for(const e of Object.keys(Jc))Jc[e]?s.emulator.push(e):s.prod.push(e);return s}function aS(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let C1=!1;function Dg(s,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||Jc[s]===e||Jc[s]||C1)return;Jc[s]=e;function n(E){return`__firebase__banner__${E}`}const i="__firebase__banner",u=rS().prod.length>0;function h(){const E=document.getElementById(i);E&&E.remove()}function p(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,O){E.setAttribute("width","24"),E.setAttribute("id",O),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function y(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{C1=!0,h()},E}function x(E,O){E.setAttribute("id",O),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function k(){const E=aS(i),O=n("text"),G=document.getElementById(O)||document.createElement("span"),U=n("learnmore"),V=document.getElementById(U)||document.createElement("a"),te=n("preprendIcon"),X=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const me=E.element;p(me),x(V,U);const Ee=y();g(X,te),me.append(X,G,V,Ee),document.body.appendChild(me)}u?(G.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,G.innerText="Preview backend running in this workspace."),G.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Js(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Js())}function oS(){const s=Kd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cS(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function uS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hS(){const s=Js();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function dS(){return!oS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fS(){try{return typeof indexedDB=="object"}catch{return!1}}function mS(){return new Promise((s,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),n||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{n=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(n){e(n)}})}const pS="FirebaseError";class Da extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=pS,Object.setPrototypeOf(this,Da.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?gS(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new Da(l,p,i)}}function gS(s,e){return s.replace(yS,(n,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const yS=/\{\$([^}]+)}/g;function vS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Vo(s,e){if(s===e)return!0;const n=Object.keys(s),i=Object.keys(e);for(const l of n){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(R1(u)&&R1(h)){if(!Vo(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!n.includes(l))return!1;return!0}function R1(s){return s!==null&&typeof s=="object"}function _u(s){const e=[];for(const[n,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Wc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Gc(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function bS(s,e){const n=new xS(s,e);return n.subscribe.bind(n)}class xS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let l;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");wS(e,["next","error","complete"])?l=e:l={next:e,error:n,complete:i},l.next===void 0&&(l.next=wp),l.error===void 0&&(l.error=wp),l.complete===void 0&&(l.complete=wp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wS(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function wp(){}function zn(s){return s&&s._delegate?s._delegate:s}class Zi{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ao="[DEFAULT]";class _S{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new sS;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:n});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TS(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const l of i)try{l(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:kS(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kS(s){return s===Ao?void 0:s}function TS(s){return s.instantiationMode==="EAGER"}class jS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _S(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var ln;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(ln||(ln={}));const ES={debug:ln.DEBUG,verbose:ln.VERBOSE,info:ln.INFO,warn:ln.WARN,error:ln.ERROR,silent:ln.SILENT},SS=ln.INFO,NS={[ln.DEBUG]:"log",[ln.VERBOSE]:"log",[ln.INFO]:"info",[ln.WARN]:"warn",[ln.ERROR]:"error"},CS=(s,e,...n)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=NS[e];if(l)console[l](`[${i}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pg{constructor(e){this.name=e,this._logLevel=SS,this._logHandler=CS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ln))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ES[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ln.DEBUG,...e),this._logHandler(this,ln.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ln.VERBOSE,...e),this._logHandler(this,ln.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ln.INFO,...e),this._logHandler(this,ln.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ln.WARN,...e),this._logHandler(this,ln.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ln.ERROR,...e),this._logHandler(this,ln.ERROR,...e)}}const RS=(s,e)=>e.some(n=>s instanceof n);let A1,I1;function AS(){return A1||(A1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IS(){return I1||(I1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G2=new WeakMap,Zp=new WeakMap,K2=new WeakMap,_p=new WeakMap,Lg=new WeakMap;function MS(s){const e=new Promise((n,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{n(Yi(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(n=>{n instanceof IDBCursor&&G2.set(n,s)}).catch(()=>{}),Lg.set(e,s),e}function DS(s){if(Zp.has(s))return;const e=new Promise((n,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{n(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});Zp.set(s,e)}let eg={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return Zp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||K2.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yi(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function PS(s){eg=s(eg)}function LS(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=s.call(kp(this),e,...n);return K2.set(i,e.sort?e.sort():[e]),Yi(i)}:IS().includes(s)?function(...e){return s.apply(kp(this),e),Yi(G2.get(this))}:function(...e){return Yi(s.apply(kp(this),e))}}function OS(s){return typeof s=="function"?LS(s):(s instanceof IDBTransaction&&DS(s),RS(s,AS())?new Proxy(s,eg):s)}function Yi(s){if(s instanceof IDBRequest)return MS(s);if(_p.has(s))return _p.get(s);const e=OS(s);return e!==s&&(_p.set(s,e),Lg.set(e,s)),e}const kp=s=>Lg.get(s);function VS(s,e,{blocked:n,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=Yi(h);return i&&h.addEventListener("upgradeneeded",g=>{i(Yi(h.result),g.oldVersion,g.newVersion,Yi(h.transaction),g)}),n&&h.addEventListener("blocked",g=>n(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const BS=["get","getKey","getAll","getAllKeys","count"],US=["put","add","delete","clear"],Tp=new Map;function M1(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Tp.get(e))return Tp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,l=US.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(l||BS.includes(n)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[n](...p),l&&g.done]))[0]};return Tp.set(e,u),u}PS(s=>({...s,get:(e,n,i)=>M1(e,n)||s.get(e,n,i),has:(e,n)=>!!M1(e,n)||s.has(e,n)}));class zS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(FS(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function FS(s){return s.getComponent()?.type==="VERSION"}const tg="@firebase/app",D1="0.14.7";const ii=new Pg("@firebase/app"),qS="@firebase/app-compat",HS="@firebase/analytics-compat",$S="@firebase/analytics",WS="@firebase/app-check-compat",GS="@firebase/app-check",KS="@firebase/auth",YS="@firebase/auth-compat",QS="@firebase/database",XS="@firebase/data-connect",JS="@firebase/database-compat",ZS="@firebase/functions",eN="@firebase/functions-compat",tN="@firebase/installations",nN="@firebase/installations-compat",sN="@firebase/messaging",rN="@firebase/messaging-compat",aN="@firebase/performance",iN="@firebase/performance-compat",oN="@firebase/remote-config",lN="@firebase/remote-config-compat",cN="@firebase/storage",uN="@firebase/storage-compat",hN="@firebase/firestore",dN="@firebase/ai",fN="@firebase/firestore-compat",mN="firebase",pN="12.8.0";const ng="[DEFAULT]",gN={[tg]:"fire-core",[qS]:"fire-core-compat",[$S]:"fire-analytics",[HS]:"fire-analytics-compat",[GS]:"fire-app-check",[WS]:"fire-app-check-compat",[KS]:"fire-auth",[YS]:"fire-auth-compat",[QS]:"fire-rtdb",[XS]:"fire-data-connect",[JS]:"fire-rtdb-compat",[ZS]:"fire-fn",[eN]:"fire-fn-compat",[tN]:"fire-iid",[nN]:"fire-iid-compat",[sN]:"fire-fcm",[rN]:"fire-fcm-compat",[aN]:"fire-perf",[iN]:"fire-perf-compat",[oN]:"fire-rc",[lN]:"fire-rc-compat",[cN]:"fire-gcs",[uN]:"fire-gcs-compat",[hN]:"fire-fst",[fN]:"fire-fst-compat",[dN]:"fire-vertex","fire-js":"fire-js",[mN]:"fire-js-all"};const jd=new Map,yN=new Map,sg=new Map;function P1(s,e){try{s.container.addComponent(e)}catch(n){ii.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function Bo(s){const e=s.name;if(sg.has(e))return ii.debug(`There were multiple attempts to register component ${e}.`),!1;sg.set(e,s);for(const n of jd.values())P1(n,s);for(const n of yN.values())P1(n,s);return!0}function Yd(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function Mr(s){return s==null?!1:s.settings!==void 0}const vN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new wu("app","Firebase",vN);class bN{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Zi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}const Wo=pN;function Og(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const i={name:ng,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Qi.create("bad-app-name",{appName:String(l)});if(n||(n=H2()),!n)throw Qi.create("no-options");const u=jd.get(l);if(u){if(Vo(n,u.options)&&Vo(i,u.config))return u;throw Qi.create("duplicate-app",{appName:l})}const h=new jS(l);for(const g of sg.values())h.addComponent(g);const p=new bN(n,i,h);return jd.set(l,p),p}function Vg(s=ng){const e=jd.get(s);if(!e&&s===ng&&H2())return Og();if(!e)throw Qi.create("no-app",{appName:s});return e}function ja(s,e,n){let i=gN[s]??s;n&&(i+=`-${n}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ii.warn(h.join(" "));return}Bo(new Zi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const xN="firebase-heartbeat-database",wN=1,ou="firebase-heartbeat-store";let jp=null;function Y2(){return jp||(jp=VS(xN,wN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(ou)}catch(n){console.warn(n)}}}}).catch(s=>{throw Qi.create("idb-open",{originalErrorMessage:s.message})})),jp}async function _N(s){try{const n=(await Y2()).transaction(ou),i=await n.objectStore(ou).get(Q2(s));return await n.done,i}catch(e){if(e instanceof Da)ii.warn(e.message);else{const n=Qi.create("idb-get",{originalErrorMessage:e?.message});ii.warn(n.message)}}}async function L1(s,e){try{const i=(await Y2()).transaction(ou,"readwrite");await i.objectStore(ou).put(e,Q2(s)),await i.done}catch(n){if(n instanceof Da)ii.warn(n.message);else{const i=Qi.create("idb-set",{originalErrorMessage:n?.message});ii.warn(i.message)}}}function Q2(s){return`${s.name}!${s.options.appId}`}const kN=1024,TN=30;class jN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new SN(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=O1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>TN){const l=NN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ii.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=O1(),{heartbeatsToSend:n,unsentEntries:i}=EN(this._heartbeatsCache.heartbeats),l=Td(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ii.warn(e),""}}}function O1(){return new Date().toISOString().substring(0,10)}function EN(s,e=kN){const n=[];let i=s.slice();for(const l of s){const u=n.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),V1(n)>e){u.dates.pop();break}}else if(n.push({agent:l.agent,dates:[l.date]}),V1(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class SN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fS()?mS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await _N(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return L1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return L1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function V1(s){return Td(JSON.stringify({version:2,heartbeats:s})).length}function NN(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let i=1;i<s.length;i++)s[i].date<n&&(n=s[i].date,e=i);return e}function CN(s){Bo(new Zi("platform-logger",e=>new zS(e),"PRIVATE")),Bo(new Zi("heartbeat",e=>new jN(e),"PRIVATE")),ja(tg,D1,s),ja(tg,D1,"esm2020"),ja("fire-js","")}CN("");function X2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RN=X2,J2=new wu("auth","Firebase",X2());const Ed=new Pg("@firebase/auth");function AN(s,...e){Ed.logLevel<=ln.WARN&&Ed.warn(`Auth (${Wo}): ${s}`,...e)}function fd(s,...e){Ed.logLevel<=ln.ERROR&&Ed.error(`Auth (${Wo}): ${s}`,...e)}function ha(s,...e){throw Bg(s,...e)}function Ea(s,...e){return Bg(s,...e)}function Z2(s,e,n){const i={...RN(),[e]:n};return new wu("auth","Firebase",i).create(e,{appName:s.name})}function ni(s){return Z2(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Bg(s,...e){if(typeof s!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(n,...i)}return J2.create(s,...e)}function Lt(s,e,...n){if(!s)throw Bg(e,...n)}function Za(s){const e="INTERNAL ASSERTION FAILED: "+s;throw fd(e),new Error(e)}function oi(s,e){s||Za(e)}function rg(){return typeof self<"u"&&self.location?.href||""}function IN(){return B1()==="http:"||B1()==="https:"}function B1(){return typeof self<"u"&&self.location?.protocol||null}function MN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IN()||cS()||"connection"in navigator)?navigator.onLine:!0}function DN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class ku{constructor(e,n){this.shortDelay=e,this.longDelay=n,oi(n>e,"Short delay should be less than long delay!"),this.isMobile=iS()||uS()}get(){return MN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ug(s,e){oi(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class ew{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const PN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const LN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ON=new ku(3e4,6e4);function ui(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function hi(s,e,n,i,l={}){return tw(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=_u({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return lS()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&io(s.emulatorConfig.host)&&(y.credentials="include"),ew.fetch()(await nw(s,s.config.apiHost,n,p),y)})}async function tw(s,e,n){s._canInitEmulator=!1;const i={...PN,...e};try{const l=new BN(s),u=await Promise.race([n(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw Xh(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xh(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw Xh(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw Xh(s,"user-disabled",h);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Z2(s,x,y);ha(s,x)}}catch(l){if(l instanceof Da)throw l;ha(s,"network-request-failed",{message:String(l)})}}async function Tu(s,e,n,i,l={}){const u=await hi(s,e,n,i,l);return"mfaPendingCredential"in u&&ha(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function nw(s,e,n,i){const l=`${e}${n}?${i}`,u=s,h=u.config.emulator?Ug(s.config,l):`${s.config.apiScheme}://${l}`;return LN.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function VN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Ea(this.auth,"network-request-failed")),ON.get())})}}function Xh(s,e,n){const i={appName:s.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const l=Ea(s,e,i);return l.customData._tokenResponse=n,l}function U1(s){return s!==void 0&&s.enterprise!==void 0}class UN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return VN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zN(s,e){return hi(s,"GET","/v2/recaptchaConfig",ui(s,e))}async function FN(s,e){return hi(s,"POST","/v1/accounts:delete",e)}async function Sd(s,e){return hi(s,"POST","/v1/accounts:lookup",e)}function Zc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function qN(s,e=!1){const n=zn(s),i=await n.getIdToken(e),l=zg(i);Lt(l&&l.exp&&l.auth_time&&l.iat,n.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:Zc(Ep(l.auth_time)),issuedAtTime:Zc(Ep(l.iat)),expirationTime:Zc(Ep(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ep(s){return Number(s)*1e3}function zg(s){const[e,n,i]=s.split(".");if(e===void 0||n===void 0||i===void 0)return fd("JWT malformed, contained fewer than 3 sections"),null;try{const l=z2(n);return l?JSON.parse(l):(fd("Failed to decode base64 JWT payload"),null)}catch(l){return fd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function z1(s){const e=zg(s);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function lu(s,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Da&&HN(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function HN({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class $N{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ag{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zc(this.lastLoginAt),this.creationTime=Zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Nd(s){const e=s.auth,n=await s.getIdToken(),i=await lu(s,Sd(e,{idToken:n}));Lt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?sw(l.providerUserInfo):[],h=GN(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new ag(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,x)}async function WN(s){const e=zn(s);await Nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GN(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function sw(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function KN(s,e){const n=await tw(s,{},async()=>{const i=_u({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await nw(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&io(s.emulatorConfig.host)&&(g.credentials="include"),ew.fetch()(h,g)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function YN(s,e){return hi(s,"POST","/v2/accounts:revokeToken",ui(s,e))}class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):z1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const n=z1(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:l,expiresIn:u}=await KN(e,n);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:l,expirationTime:u}=n,h=new Pl;return i&&(Lt(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(Lt(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(Lt(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return Za("not implemented")}}function Oi(s,e){Lt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ca{constructor({uid:e,auth:n,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new $N(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new ag(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const n=await lu(this,this.stsTokenManager.getToken(this.auth,e));return Lt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return qN(this,e)}reload(){return WN(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ca({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Nd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(ni(this.auth));const e=await this.getIdToken();return await lu(this,FN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,l=n.email??void 0,u=n.phoneNumber??void 0,h=n.photoURL??void 0,p=n.tenantId??void 0,g=n._redirectEventId??void 0,y=n.createdAt??void 0,x=n.lastLoginAt??void 0,{uid:k,emailVerified:E,isAnonymous:O,providerData:G,stsTokenManager:U}=n;Lt(k&&U,e,"internal-error");const V=Pl.fromJSON(this.name,U);Lt(typeof k=="string",e,"internal-error"),Oi(i,e.name),Oi(l,e.name),Lt(typeof E=="boolean",e,"internal-error"),Lt(typeof O=="boolean",e,"internal-error"),Oi(u,e.name),Oi(h,e.name),Oi(p,e.name),Oi(g,e.name),Oi(y,e.name),Oi(x,e.name);const te=new ca({uid:k,auth:e,email:l,emailVerified:E,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:x});return G&&Array.isArray(G)&&(te.providerData=G.map(X=>({...X}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,n,i=!1){const l=new Pl;l.updateFromServerResponse(n);const u=new ca({uid:n.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Nd(u),u}static async _fromGetAccountInfoResponse(e,n,i){const l=n.users[0];Lt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?sw(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Pl;p.updateFromIdToken(i);const g=new ca({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new ag(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const F1=new Map;function ei(s){oi(s instanceof Function,"Expected a class definition");let e=F1.get(s);return e?(oi(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,F1.set(s,e),e)}class rw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}rw.type="NONE";const q1=rw;function md(s,e,n){return`firebase:${s}:${e}:${n}`}class Ll{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=md(this.userKey,l.apiKey,u),this.fullPersistenceKey=md("persistence",l.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sd(this.auth,{idToken:e}).catch(()=>{});return n?ca._fromGetAccountInfoResponse(this.auth,n,e):null}return ca._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Ll(ei(q1),e,i);const l=(await Promise.all(n.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||ei(q1);const h=md(i,e.config.apiKey,e.name);let p=null;for(const y of n)try{const x=await y._get(h);if(x){let k;if(typeof x=="string"){const E=await Sd(e,{idToken:x}).catch(()=>{});if(!E)break;k=await ca._fromGetAccountInfoResponse(e,E,x)}else k=ca._fromJSON(e,x);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Ll(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(n.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Ll(u,e,i))}}function H1(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uw(e))return"Blackberry";if(hw(e))return"Webos";if(iw(e))return"Safari";if((e.includes("chrome/")||ow(e))&&!e.includes("edge/"))return"Chrome";if(cw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(n);if(i?.length===2)return i[1]}return"Other"}function aw(s=Js()){return/firefox\//i.test(s)}function iw(s=Js()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ow(s=Js()){return/crios\//i.test(s)}function lw(s=Js()){return/iemobile/i.test(s)}function cw(s=Js()){return/android/i.test(s)}function uw(s=Js()){return/blackberry/i.test(s)}function hw(s=Js()){return/webos/i.test(s)}function Fg(s=Js()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function QN(s=Js()){return Fg(s)&&!!window.navigator?.standalone}function XN(){return hS()&&document.documentMode===10}function dw(s=Js()){return Fg(s)||cw(s)||hw(s)||uw(s)||/windows phone/i.test(s)||lw(s)}function fw(s,e=[]){let n;switch(s){case"Browser":n=H1(Js());break;case"Worker":n=`${H1(Js())}-${s}`;break;default:n=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Wo}/${i}`}class JN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=n,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const l of n)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function ZN(s,e={}){return hi(s,"GET","/v2/passwordPolicy",ui(s,e))}const eC=6;class tC{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??eC,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),l&&(n.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class nC{constructor(e,n,i,l){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $1(this),this.idTokenSubscription=new $1(this),this.beforeStateQueue=new JN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ei(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ll.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sd(this,{idToken:e}),i=await ca._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(ni(this));const n=e?zn(e):null;return n&&Lt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(ni(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(ni(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZN(this),n=new tC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await YN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ei(e)||this._popupRedirectResolver;Lt(n,this,"argument-error"),this.redirectPersistenceManager=await Ll.create(this,[ei(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,l){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof n=="function"){const g=e.addObserver(n,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(n);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&AN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oo(s){return zn(s)}class $1{constructor(e){this.auth=e,this.observer=null,this.addObserver=bS(n=>this.observer=n)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sC(s){Qd=s}function mw(s){return Qd.loadJS(s)}function rC(){return Qd.recaptchaEnterpriseScript}function aC(){return Qd.gapiScript}function iC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class oC{constructor(){this.enterprise=new lC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class lC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const cC="recaptcha-enterprise",pw="NO_RECAPTCHA";class uC{constructor(e){this.type=cC,this.auth=oo(e)}async verify(e="verify",n=!1){async function i(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{zN(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new UN(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;U1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oC().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!n&&U1(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=rC();g.length!==0&&(g+=p),mw(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function W1(s,e,n,i=!1,l=!1){const u=new uC(s);let h;if(l)h=pw;else try{h=await u.verify(n)}catch{h=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Cd(s,e,n,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await W1(s,e,n,n==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await W1(s,e,n,n==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function hC(s,e){const n=Yd(s,"auth");if(n.isInitialized()){const l=n.getImmediate(),u=n.getOptions();if(Vo(u,e??{}))return l;ha(l,"already-initialized")}return n.initialize({options:e})}function dC(s,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(ei);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function fC(s,e,n){const i=oo(s);Lt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=gw(e),{host:h,port:p}=mC(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},x=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Lt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Lt(Vo(y,i.config.emulator)&&Vo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,io(h)?(Mg(`${u}//${h}${g}`),Dg("Auth",!0)):pC()}function gw(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function mC(s){const e=gw(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:G1(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:G1(h)}}}function G1(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function pC(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class qg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Za("not implemented")}_getIdTokenResponse(e){return Za("not implemented")}_linkToIdToken(e,n){return Za("not implemented")}_getReauthenticationResolver(e){return Za("not implemented")}}async function gC(s,e){return hi(s,"POST","/v1/accounts:signUp",e)}async function yC(s,e){return Tu(s,"POST","/v1/accounts:signInWithPassword",ui(s,e))}async function vC(s,e){return hi(s,"POST","/v1/accounts:sendOobCode",ui(s,e))}async function bC(s,e){return vC(s,e)}async function xC(s,e){return Tu(s,"POST","/v1/accounts:signInWithEmailLink",ui(s,e))}async function wC(s,e){return Tu(s,"POST","/v1/accounts:signInWithEmailLink",ui(s,e))}class cu extends qg{constructor(e,n,i,l=null){super("password",i),this._email=e,this._password=n,this._tenantId=l}static _fromEmailAndPassword(e,n){return new cu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new cu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cd(e,n,"signInWithPassword",yC);case"emailLink":return xC(e,{email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cd(e,i,"signUpPassword",gC);case"emailLink":return wC(e,{idToken:n,email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ol(s,e){return Tu(s,"POST","/v1/accounts:signInWithIdp",ui(s,e))}const _C="http://localhost";class Uo extends qg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Uo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ha("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=n;if(!i||!l)return null;const h=new Uo(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const n=this.buildRequest();return Ol(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Ol(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ol(e,n)}buildRequest(){const e={requestUri:_C,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=_u(n)}return e}}function kC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TC(s){const e=Wc(Gc(s)).link,n=e?Wc(Gc(e)).deep_link_id:null,i=Wc(Gc(s)).deep_link_id;return(i?Wc(Gc(i)).link:null)||i||n||e||s}class Hg{constructor(e){const n=Wc(Gc(e)),i=n.apiKey??null,l=n.oobCode??null,u=kC(n.mode??null);Lt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=TC(e);try{return new Hg(n)}catch{return null}}}class Yl{constructor(){this.providerId=Yl.PROVIDER_ID}static credential(e,n){return cu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Hg.parseLink(n);return Lt(i,"argument-error"),cu._fromEmailAndCode(e,i.code,i.tenantId)}}Yl.PROVIDER_ID="password";Yl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Yl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ju extends yw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ui extends ju{constructor(){super("facebook.com")}static credential(e){return Uo._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ui.PROVIDER_ID="facebook.com";class zi extends ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Uo._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return zi.credential(n,i)}catch{return null}}}zi.GOOGLE_SIGN_IN_METHOD="google.com";zi.PROVIDER_ID="google.com";class Fi extends ju{constructor(){super("github.com")}static credential(e){return Uo._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com";Fi.PROVIDER_ID="github.com";class qi extends ju{constructor(){super("twitter.com")}static credential(e,n){return Uo._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return qi.credential(n,i)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";async function jC(s,e){return Tu(s,"POST","/v1/accounts:signUp",ui(s,e))}class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,l=!1){const u=await ca._fromIdTokenResponse(e,i,l),h=K1(i);return new zo({user:u,providerId:h,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const l=K1(i);return new zo({user:e,providerId:l,_tokenResponse:i,operationType:n})}}function K1(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Rd extends Da{constructor(e,n,i,l){super(n.code,n.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Rd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,l){return new Rd(e,n,i,l)}}function vw(s,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Rd._fromErrorAndOperation(s,u,e,i):u})}async function EC(s,e,n=!1){const i=await lu(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return zo._forOperation(s,"link",i)}async function SC(s,e,n=!1){const{auth:i}=s;if(Mr(i.app))return Promise.reject(ni(i));const l="reauthenticate";try{const u=await lu(s,vw(i,l,e,s),n);Lt(u.idToken,i,"internal-error");const h=zg(u.idToken);Lt(h,i,"internal-error");const{sub:p}=h;return Lt(s.uid===p,i,"user-mismatch"),zo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ha(i,"user-mismatch"),u}}async function bw(s,e,n=!1){if(Mr(s.app))return Promise.reject(ni(s));const i="signIn",l=await vw(s,i,e),u=await zo._fromIdTokenResponse(s,i,l);return n||await s._updateCurrentUser(u.user),u}async function NC(s,e){return bw(oo(s),e)}async function xw(s){const e=oo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CC(s,e,n){const i=oo(s);await Cd(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",bC)}async function BD(s,e,n){if(Mr(s.app))return Promise.reject(ni(s));const i=oo(s),h=await Cd(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&xw(s),g}),p=await zo._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function RC(s,e,n){return Mr(s.app)?Promise.reject(ni(s)):NC(zn(s),Yl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&xw(s),i})}function AC(s,e){return zn(s).setPersistence(e)}function IC(s,e,n,i){return zn(s).onIdTokenChanged(e,n,i)}function MC(s,e,n){return zn(s).beforeAuthStateChanged(e,n)}function DC(s,e,n,i){return zn(s).onAuthStateChanged(e,n,i)}function PC(s){return zn(s).signOut()}const Ad="__sak";class ww{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ad,"1"),this.storage.removeItem(Ad),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const LC=1e3,OC=10;class _w extends ww{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),l=this.localCache[n];i!==l&&e(n,l,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;n?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!n&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);XN()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,OC):l()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},LC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}_w.type="LOCAL";const kw=_w;class Tw extends ww{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Tw.type="SESSION";const $g=Tw;function VC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Xd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(l=>l.isListeningto(e));if(n)return n;const i=new Xd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:l,data:u}=n.data,h=this.handlersMap[l];if(!h?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(n.origin,u)),g=await VC(p);n.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xd.receivers=[];function Wg(s="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return s+n}class BC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=Wg("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(k){const E=k;if(E.data.eventId===y)switch(E.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(E.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:n},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function Sa(){return window}function UC(s){Sa().location.href=s}function jw(){return typeof Sa().WorkerGlobalScope<"u"&&typeof Sa().importScripts=="function"}async function zC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FC(){return navigator?.serviceWorker?.controller||null}function qC(){return jw()?self:null}const Ew="firebaseLocalStorageDb",HC=1,Id="firebaseLocalStorage",Sw="fbase_key";class Eu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Jd(s,e){return s.transaction([Id],e?"readwrite":"readonly").objectStore(Id)}function $C(){const s=indexedDB.deleteDatabase(Ew);return new Eu(s).toPromise()}function ig(){const s=indexedDB.open(Ew,HC);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Id,{keyPath:Sw})}catch(l){n(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Id)?e(i):(i.close(),await $C(),e(await ig()))})})}async function Y1(s,e,n){const i=Jd(s,!0).put({[Sw]:e,value:n});return new Eu(i).toPromise()}async function WC(s,e){const n=Jd(s,!1).get(e),i=await new Eu(n).toPromise();return i===void 0?null:i.value}function Q1(s,e){const n=Jd(s,!0).delete(e);return new Eu(n).toPromise()}const GC=800,KC=3;class Nw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ig(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>KC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xd._getInstance(qC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await zC(),!this.activeServiceWorker)return;this.sender=new BC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ig();return await Y1(e,Ad,"1"),await Q1(e,Ad),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Y1(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>WC(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Q1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Jd(l,!1).getAll();return new Eu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),n.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),n.push(l));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nw.type="LOCAL";const YC=Nw;new ku(3e4,6e4);function QC(s,e){return e?ei(e):(Lt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Gg extends qg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ol(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ol(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ol(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function XC(s){return bw(s.auth,new Gg(s),s.bypassAuthState)}function JC(s){const{auth:e,user:n}=s;return Lt(n,e,"internal-error"),SC(n,new Gg(s),s.bypassAuthState)}async function ZC(s){const{auth:e,user:n}=s;return Lt(n,e,"internal-error"),EC(n,new Gg(s),s.bypassAuthState)}class Cw{constructor(e,n,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:n,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XC;case"linkViaPopup":case"linkViaRedirect":return ZC;case"reauthViaPopup":case"reauthViaRedirect":return JC;default:ha(this.auth,"internal-error")}}resolve(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const e4=new ku(2e3,1e4);class Dl extends Cw{constructor(e,n,i,l,u){super(e,n,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Dl.currentPopupAction&&Dl.currentPopupAction.cancel(),Dl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){oi(this.filter.length===1,"Popup operations only handle one event");const e=Wg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ea(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ea(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ea(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e4.get())};e()}}Dl.currentPopupAction=null;const t4="pendingRedirect",pd=new Map;class n4 extends Cw{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=pd.get(this.auth._key());if(!e){try{const i=await s4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}pd.set(this.auth._key(),e)}return this.bypassAuthState||pd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function s4(s,e){const n=i4(e),i=a4(s);if(!await i._isAvailable())return!1;const l=await i._get(n)==="true";return await i._remove(n),l}function r4(s,e){pd.set(s._key(),e)}function a4(s){return ei(s._redirectPersistence)}function i4(s){return md(t4,s.config.apiKey,s.name)}async function o4(s,e,n=!1){if(Mr(s.app))return Promise.reject(ni(s));const i=oo(s),l=QC(i,e),h=await new n4(i,l,n).execute();return h&&!n&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const l4=600*1e3;class c4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!u4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Rw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ea(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=l4&&this.cachedEventUids.clear(),this.cachedEventUids.has(X1(e))}saveEventToCache(e){this.cachedEventUids.add(X1(e)),this.lastProcessedEventTime=Date.now()}}function X1(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Rw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function u4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rw(s);default:return!1}}async function h4(s,e={}){return hi(s,"GET","/v1/projects",e)}const d4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f4=/^https?/;async function m4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await h4(s);for(const n of e)try{if(p4(n))return}catch{}ha(s,"unauthorized-domain")}function p4(s){const e=rg(),{protocol:n,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&h.hostname===i}if(!f4.test(n))return!1;if(d4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const g4=new ku(3e4,6e4);function J1(){const s=Sa().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function y4(s){return new Promise((e,n)=>{function i(){J1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{J1(),n(Ea(s,"network-request-failed"))},timeout:g4.get()})}if(Sa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Sa().gapi?.load)i();else{const l=iC("iframefcb");return Sa()[l]=()=>{gapi.load?i():n(Ea(s,"network-request-failed"))},mw(`${aC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw gd=null,e})}let gd=null;function v4(s){return gd=gd||y4(s),gd}const b4=new ku(5e3,15e3),x4="__/auth/iframe",w4="emulator/auth/iframe",_4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},k4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T4(s){const e=s.config;Lt(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?Ug(e,w4):`https://${s.config.authDomain}/${x4}`,i={apiKey:e.apiKey,appName:s.name,v:Wo},l=k4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${n}?${_u(i).slice(1)}`}async function j4(s){const e=await v4(s),n=Sa().gapi;return Lt(n,s,"internal-error"),e.open({where:document.body,url:T4(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=Ea(s,"network-request-failed"),p=Sa().setTimeout(()=>{u(h)},b4.get());function g(){Sa().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const E4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S4=500,N4=600,C4="_blank",R4="http://localhost";class Z1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function A4(s,e,n,i=S4,l=N4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...E4,width:i.toString(),height:l.toString(),top:u,left:h},y=Js().toLowerCase();n&&(p=ow(y)?C4:n),aw(y)&&(e=e||R4,g.scrollbars="yes");const x=Object.entries(g).reduce((E,[O,G])=>`${E}${O}=${G},`,"");if(QN(y)&&p!=="_self")return I4(e||"",p),new Z1(null);const k=window.open(e||"",p,x);Lt(k,s,"popup-blocked");try{k.focus()}catch{}return new Z1(k)}function I4(s,e){const n=document.createElement("a");n.href=s,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const M4="__/auth/handler",D4="emulator/auth/handler",P4=encodeURIComponent("fac");async function ex(s,e,n,i,l,u){Lt(s.config.authDomain,s,"auth-domain-config-required"),Lt(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:i,v:Wo,eventId:l};if(e instanceof yw){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",vS(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,k]of Object.entries({}))h[x]=k}if(e instanceof ju){const x=e.getScopes().filter(k=>k!=="");x.length>0&&(h.scopes=x.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await s._getAppCheckToken(),y=g?`#${P4}=${encodeURIComponent(g)}`:"";return`${L4(s)}?${_u(p).slice(1)}${y}`}function L4({config:s}){return s.emulator?Ug(s,D4):`https://${s.authDomain}/${M4}`}const Sp="webStorageSupport";class O4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$g,this._completeRedirectFn=o4,this._overrideRedirectResult=r4}async _openPopup(e,n,i,l){oi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await ex(e,n,i,rg(),l);return A4(e,u,Wg())}async _openRedirect(e,n,i,l){await this._originValidation(e);const u=await ex(e,n,i,rg(),l);return UC(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:l,promise:u}=this.eventManagers[n];return l?Promise.resolve(l):(oi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await j4(e),i=new c4(e);return n.register("authEvent",l=>(Lt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Sp,{type:Sp},l=>{const u=l?.[0]?.[Sp];u!==void 0&&n(!!u),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=m4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return dw()||iw()||Fg()}}const V4=O4;var tx="@firebase/auth",nx="1.12.0";class B4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function U4(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z4(s){Bo(new Zi("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;Lt(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fw(s)},y=new nC(i,l,u,g);return dC(y,n),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Bo(new Zi("auth-internal",e=>{const n=oo(e.getProvider("auth").getImmediate());return(i=>new B4(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ja(tx,nx,U4(s)),ja(tx,nx,"esm2020")}const F4=300,q4=$2("authIdTokenMaxAge")||F4;let sx=null;const H4=s=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>q4)return;const l=n?.token;sx!==l&&(sx=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Aw(s=Vg()){const e=Yd(s,"auth");if(e.isInitialized())return e.getImmediate();const n=hC(s,{popupRedirectResolver:V4,persistence:[YC,kw,$g]}),i=$2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=H4(u.toString());MC(n,h,()=>h(n.currentUser)),IC(n,p=>h(p))}}const l=F2("auth");return l&&fC(n,`http://${l}`),n}function $4(){return document.getElementsByTagName("head")?.[0]??document}sC({loadJS(s){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ea("internal-error");u.customData=l,n(u)},i.type="text/javascript",i.charset="UTF-8",$4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z4("Browser");var rx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Xi,Iw;(function(){var s;function e(I,j){function R(){}R.prototype=j.prototype,I.F=j.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(L,D,z){for(var M=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)M[Fe-2]=arguments[Fe];return j.prototype[D].apply(L,M)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(I,j,R){R||(R=0);const L=Array(16);if(typeof j=="string")for(var D=0;D<16;++D)L[D]=j.charCodeAt(R++)|j.charCodeAt(R++)<<8|j.charCodeAt(R++)<<16|j.charCodeAt(R++)<<24;else for(D=0;D<16;++D)L[D]=j[R++]|j[R++]<<8|j[R++]<<16|j[R++]<<24;j=I.g[0],R=I.g[1],D=I.g[2];let z=I.g[3],M;M=j+(z^R&(D^z))+L[0]+3614090360&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+L[1]+3905402710&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+L[2]+606105819&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+L[3]+3250441966&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+L[4]+4118548399&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+L[5]+1200080426&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+L[6]+2821735955&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+L[7]+4249261313&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+L[8]+1770035416&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+L[9]+2336552879&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+L[10]+4294925233&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+L[11]+2304563134&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(z^R&(D^z))+L[12]+1804603682&4294967295,j=R+(M<<7&4294967295|M>>>25),M=z+(D^j&(R^D))+L[13]+4254626195&4294967295,z=j+(M<<12&4294967295|M>>>20),M=D+(R^z&(j^R))+L[14]+2792965006&4294967295,D=z+(M<<17&4294967295|M>>>15),M=R+(j^D&(z^j))+L[15]+1236535329&4294967295,R=D+(M<<22&4294967295|M>>>10),M=j+(D^z&(R^D))+L[1]+4129170786&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+L[6]+3225465664&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+L[11]+643717713&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+L[0]+3921069994&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+L[5]+3593408605&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+L[10]+38016083&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+L[15]+3634488961&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+L[4]+3889429448&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+L[9]+568446438&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+L[14]+3275163606&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+L[3]+4107603335&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+L[8]+1163531501&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(D^z&(R^D))+L[13]+2850285829&4294967295,j=R+(M<<5&4294967295|M>>>27),M=z+(R^D&(j^R))+L[2]+4243563512&4294967295,z=j+(M<<9&4294967295|M>>>23),M=D+(j^R&(z^j))+L[7]+1735328473&4294967295,D=z+(M<<14&4294967295|M>>>18),M=R+(z^j&(D^z))+L[12]+2368359562&4294967295,R=D+(M<<20&4294967295|M>>>12),M=j+(R^D^z)+L[5]+4294588738&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+L[8]+2272392833&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+L[11]+1839030562&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+L[14]+4259657740&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+L[1]+2763975236&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+L[4]+1272893353&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+L[7]+4139469664&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+L[10]+3200236656&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+L[13]+681279174&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+L[0]+3936430074&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+L[3]+3572445317&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+L[6]+76029189&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(R^D^z)+L[9]+3654602809&4294967295,j=R+(M<<4&4294967295|M>>>28),M=z+(j^R^D)+L[12]+3873151461&4294967295,z=j+(M<<11&4294967295|M>>>21),M=D+(z^j^R)+L[15]+530742520&4294967295,D=z+(M<<16&4294967295|M>>>16),M=R+(D^z^j)+L[2]+3299628645&4294967295,R=D+(M<<23&4294967295|M>>>9),M=j+(D^(R|~z))+L[0]+4096336452&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+L[7]+1126891415&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+L[14]+2878612391&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+L[5]+4237533241&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+L[12]+1700485571&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+L[3]+2399980690&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+L[10]+4293915773&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+L[1]+2240044497&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+L[8]+1873313359&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+L[15]+4264355552&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+L[6]+2734768916&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+L[13]+1309151649&4294967295,R=D+(M<<21&4294967295|M>>>11),M=j+(D^(R|~z))+L[4]+4149444226&4294967295,j=R+(M<<6&4294967295|M>>>26),M=z+(R^(j|~D))+L[11]+3174756917&4294967295,z=j+(M<<10&4294967295|M>>>22),M=D+(j^(z|~R))+L[2]+718787259&4294967295,D=z+(M<<15&4294967295|M>>>17),M=R+(z^(D|~j))+L[9]+3951481745&4294967295,I.g[0]=I.g[0]+j&4294967295,I.g[1]=I.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+z&4294967295}i.prototype.v=function(I,j){j===void 0&&(j=I.length);const R=j-this.blockSize,L=this.C;let D=this.h,z=0;for(;z<j;){if(D==0)for(;z<=R;)l(this,I,z),z+=this.blockSize;if(typeof I=="string"){for(;z<j;)if(L[D++]=I.charCodeAt(z++),D==this.blockSize){l(this,L),D=0;break}}else for(;z<j;)if(L[D++]=I[z++],D==this.blockSize){l(this,L),D=0;break}}this.h=D,this.o+=j},i.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var j=1;j<I.length-8;++j)I[j]=0;j=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=j&255,j/=256;for(this.v(I),I=Array(16),j=0,R=0;R<4;++R)for(let L=0;L<32;L+=8)I[j++]=this.g[R]>>>L&255;return I};function u(I,j){var R=p;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=j(I)}function h(I,j){this.h=j;const R=[];let L=!0;for(let D=I.length-1;D>=0;D--){const z=I[D]|0;L&&z==j||(R[D]=z,L=!1)}this.g=R}var p={};function g(I){return-128<=I&&I<128?u(I,function(j){return new h([j|0],j<0?-1:0)}):new h([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return k;if(I<0)return V(y(-I));const j=[];let R=1;for(let L=0;I>=R;L++)j[L]=I/R|0,R*=4294967296;return new h(j,0)}function x(I,j){if(I.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(I.charAt(0)=="-")return V(x(I.substring(1),j));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(j,8));let L=k;for(let z=0;z<I.length;z+=8){var D=Math.min(8,I.length-z);const M=parseInt(I.substring(z,z+D),j);D<8?(D=y(Math.pow(j,D)),L=L.j(D).add(y(M))):(L=L.j(R),L=L.add(y(M)))}return L}var k=g(0),E=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(U(this))return-V(this).m();let I=0,j=1;for(let R=0;R<this.g.length;R++){const L=this.i(R);I+=(L>=0?L:4294967296+L)*j,j*=4294967296}return I},s.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(G(this))return"0";if(U(this))return"-"+V(this).toString(I);const j=y(Math.pow(I,6));var R=this;let L="";for(;;){const D=Ee(R,j).g;R=te(R,D.j(j));let z=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=D,G(R))return z+L;for(;z.length<6;)z="0"+z;L=z+L}},s.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function G(I){if(I.h!=0)return!1;for(let j=0;j<I.g.length;j++)if(I.g[j]!=0)return!1;return!0}function U(I){return I.h==-1}s.l=function(I){return I=te(this,I),U(I)?-1:G(I)?0:1};function V(I){const j=I.g.length,R=[];for(let L=0;L<j;L++)R[L]=~I.g[L];return new h(R,~I.h).add(E)}s.abs=function(){return U(this)?V(this):this},s.add=function(I){const j=Math.max(this.g.length,I.g.length),R=[];let L=0;for(let D=0;D<=j;D++){let z=L+(this.i(D)&65535)+(I.i(D)&65535),M=(z>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);L=M>>>16,z&=65535,M&=65535,R[D]=M<<16|z}return new h(R,R[R.length-1]&-2147483648?-1:0)};function te(I,j){return I.add(V(j))}s.j=function(I){if(G(this)||G(I))return k;if(U(this))return U(I)?V(this).j(V(I)):V(V(this).j(I));if(U(I))return V(this.j(V(I)));if(this.l(O)<0&&I.l(O)<0)return y(this.m()*I.m());const j=this.g.length+I.g.length,R=[];for(var L=0;L<2*j;L++)R[L]=0;for(L=0;L<this.g.length;L++)for(let D=0;D<I.g.length;D++){const z=this.i(L)>>>16,M=this.i(L)&65535,Fe=I.i(D)>>>16,wt=I.i(D)&65535;R[2*L+2*D]+=M*wt,X(R,2*L+2*D),R[2*L+2*D+1]+=z*wt,X(R,2*L+2*D+1),R[2*L+2*D+1]+=M*Fe,X(R,2*L+2*D+1),R[2*L+2*D+2]+=z*Fe,X(R,2*L+2*D+2)}for(I=0;I<j;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=j;I<2*j;I++)R[I]=0;return new h(R,0)};function X(I,j){for(;(I[j]&65535)!=I[j];)I[j+1]+=I[j]>>>16,I[j]&=65535,j++}function me(I,j){this.g=I,this.h=j}function Ee(I,j){if(G(j))throw Error("division by zero");if(G(I))return new me(k,k);if(U(I))return j=Ee(V(I),j),new me(V(j.g),V(j.h));if(U(j))return j=Ee(I,V(j)),new me(V(j.g),j.h);if(I.g.length>30){if(U(I)||U(j))throw Error("slowDivide_ only works with positive integers.");for(var R=E,L=j;L.l(I)<=0;)R=ze(R),L=ze(L);var D=Le(R,1),z=Le(L,1);for(L=Le(L,2),R=Le(R,2);!G(L);){var M=z.add(L);M.l(I)<=0&&(D=D.add(R),z=M),L=Le(L,1),R=Le(R,1)}return j=te(I,D.j(j)),new me(D,j)}for(D=k;I.l(j)>=0;){for(R=Math.max(1,Math.floor(I.m()/j.m())),L=Math.ceil(Math.log(R)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),z=y(R),M=z.j(j);U(M)||M.l(I)>0;)R-=L,z=y(R),M=z.j(j);G(z)&&(z=E),D=D.add(z),I=te(I,M)}return new me(D,I)}s.B=function(I){return Ee(this,I).h},s.and=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<j;L++)R[L]=this.i(L)&I.i(L);return new h(R,this.h&I.h)},s.or=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<j;L++)R[L]=this.i(L)|I.i(L);return new h(R,this.h|I.h)},s.xor=function(I){const j=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<j;L++)R[L]=this.i(L)^I.i(L);return new h(R,this.h^I.h)};function ze(I){const j=I.g.length+1,R=[];for(let L=0;L<j;L++)R[L]=I.i(L)<<1|I.i(L-1)>>>31;return new h(R,I.h)}function Le(I,j){const R=j>>5;j%=32;const L=I.g.length-R,D=[];for(let z=0;z<L;z++)D[z]=j>0?I.i(z+R)>>>j|I.i(z+R+1)<<32-j:I.i(z+R);return new h(D,I.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Iw=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=x,Xi=h}).apply(typeof rx<"u"?rx:typeof self<"u"?self:typeof window<"u"?window:{});var Jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Mw,Kc,Dw,yd,og,Pw,Lw,Ow;(function(){var s,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jh=="object"&&Jh];for(var v=0;v<d.length;++v){var _=d[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=n(this);function l(d,v){if(v)e:{var _=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var Z=d[N];if(!(Z in _))break e;_=_[Z]}d=d[d.length-1],N=_[d],v=v(N),v!=N&&v!=null&&e(_,d,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},h=this||self;function p(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,_){return d.call.apply(d.bind,arguments)}function y(d,v,_){return y=g,y.apply(null,arguments)}function x(d,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function k(d,v){function _(){}_.prototype=v.prototype,d.Z=v.prototype,d.prototype=new _,d.prototype.constructor=d,d.Ob=function(N,Z,he){for(var $e=Array(arguments.length-2),Qt=2;Qt<arguments.length;Qt++)$e[Qt-2]=arguments[Qt];return v.prototype[Z].apply(N,$e)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const v=d.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=d[N];return _}return[]}function G(d,v){for(let N=1;N<arguments.length;N++){const Z=arguments[N];var _=typeof Z;if(_=_!="object"?_:Z?Array.isArray(Z)?"array":_:"null",_=="array"||_=="object"&&typeof Z.length=="number"){_=d.length||0;const he=Z.length||0;d.length=_+he;for(let $e=0;$e<he;$e++)d[_+$e]=Z[$e]}else d.push(Z)}}class U{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function V(d){h.setTimeout(()=>{throw d},0)}function te(){var d=I;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class X{constructor(){this.h=this.g=null}add(v,_){const N=me.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var me=new U(()=>new Ee,d=>d.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ze,Le=!1,I=new X,j=()=>{const d=Promise.resolve(void 0);ze=()=>{d.then(R)}};function R(){for(var d;d=te();){try{d.h.call(d.g)}catch(_){V(_)}var v=me;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}Le=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const _=()=>{};h.addEventListener("test",_,v),h.removeEventListener("test",_,v)}catch{}return d})();function M(d){return/^[\s\xa0]*$/.test(d)}function Fe(d,v){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}k(Fe,D),Fe.prototype.init=function(d,v){const _=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(_=="mouseover"?v=d.fromElement:_=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Fe.Z.h.call(this)},Fe.prototype.h=function(){Fe.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var wt="closure_listenable_"+(Math.random()*1e6|0),Y=0;function Se(d,v,_,N,Z){this.listener=d,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=Z,this.key=++Y,this.da=this.fa=!1}function Oe(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ht(d,v,_){for(const N in d)v.call(_,d[N],N,d)}function ae(d,v){for(const _ in d)v.call(void 0,d[_],_,d)}function P(d){const v={};for(const _ in d)v[_]=d[_];return v}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(d,v){let _,N;for(let Z=1;Z<arguments.length;Z++){N=arguments[Z];for(_ in N)d[_]=N[_];for(let he=0;he<W.length;he++)_=W[he],Object.prototype.hasOwnProperty.call(N,_)&&(d[_]=N[_])}}function Ne(d){this.src=d,this.g={},this.h=0}Ne.prototype.add=function(d,v,_,N,Z){const he=d.toString();d=this.g[he],d||(d=this.g[he]=[],this.h++);const $e=ke(d,v,N,Z);return $e>-1?(v=d[$e],_||(v.fa=!1)):(v=new Se(v,this.src,he,!!N,Z),v.fa=_,d.push(v)),v};function Be(d,v){const _=v.type;if(_ in d.g){var N=d.g[_],Z=Array.prototype.indexOf.call(N,v,void 0),he;(he=Z>=0)&&Array.prototype.splice.call(N,Z,1),he&&(Oe(v),d.g[_].length==0&&(delete d.g[_],d.h--))}}function ke(d,v,_,N){for(let Z=0;Z<d.length;++Z){const he=d[Z];if(!he.da&&he.listener==v&&he.capture==!!_&&he.ha==N)return Z}return-1}var et="closure_lm_"+(Math.random()*1e6|0),gt={};function Je(d,v,_,N,Z){if(Array.isArray(v)){for(let he=0;he<v.length;he++)Je(d,v[he],_,N,Z);return null}return _=Bt(_),d&&d[wt]?d.J(v,_,p(N)?!!N.capture:!1,Z):Ht(d,v,_,!1,N,Z)}function Ht(d,v,_,N,Z,he){if(!v)throw Error("Invalid event type");const $e=p(Z)?!!Z.capture:!!Z;let Qt=$t(d);if(Qt||(d[et]=Qt=new Ne(d)),_=Qt.add(v,_,N,$e,he),_.proxy)return _;if(N=hn(),_.proxy=N,N.src=d,N.listener=_,d.addEventListener)z||(Z=$e),Z===void 0&&(Z=!1),d.addEventListener(v.toString(),N,Z);else if(d.attachEvent)d.attachEvent(oe(v.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function hn(){function d(_){return v.call(d.src,d.listener,_)}const v=yn;return d}function Nt(d,v,_,N,Z){if(Array.isArray(v))for(var he=0;he<v.length;he++)Nt(d,v[he],_,N,Z);else N=p(N)?!!N.capture:!!N,_=Bt(_),d&&d[wt]?(d=d.i,he=String(v).toString(),he in d.g&&(v=d.g[he],_=ke(v,_,N,Z),_>-1&&(Oe(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete d.g[he],d.h--)))):d&&(d=$t(d))&&(v=d.g[v.toString()],d=-1,v&&(d=ke(v,_,N,Z)),(_=d>-1?v[d]:null)&&Ct(_))}function Ct(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[wt])Be(v.i,d);else{var _=d.type,N=d.proxy;v.removeEventListener?v.removeEventListener(_,N,d.capture):v.detachEvent?v.detachEvent(oe(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=$t(v))?(Be(_,d),_.h==0&&(_.src=null,v[et]=null)):Oe(d)}}}function oe(d){return d in gt?gt[d]:gt[d]="on"+d}function yn(d,v){if(d.da)d=!0;else{v=new Fe(v,this);const _=d.listener,N=d.ha||d.src;d.fa&&Ct(d),d=_.call(N,v)}return d}function $t(d){return d=d[et],d instanceof Ne?d:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function Bt(d){return typeof d=="function"?d:(d[Et]||(d[Et]=function(v){return d.handleEvent(v)}),d[Et])}function ft(){L.call(this),this.i=new Ne(this),this.M=this,this.G=null}k(ft,L),ft.prototype[wt]=!0,ft.prototype.removeEventListener=function(d,v,_,N){Nt(this,d,v,_,N)};function Ye(d,v){var _,N=d.G;if(N)for(_=[];N;N=N.G)_.push(N);if(d=d.M,N=v.type||v,typeof v=="string")v=new D(v,d);else if(v instanceof D)v.target=v.target||d;else{var Z=v;v=new D(N,d),ye(v,Z)}Z=!0;let he,$e;if(_)for($e=_.length-1;$e>=0;$e--)he=v.g=_[$e],Z=le(he,N,!0,v)&&Z;if(he=v.g=d,Z=le(he,N,!0,v)&&Z,Z=le(he,N,!1,v)&&Z,_)for($e=0;$e<_.length;$e++)he=v.g=_[$e],Z=le(he,N,!1,v)&&Z}ft.prototype.N=function(){if(ft.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const _=d.g[v];for(let N=0;N<_.length;N++)Oe(_[N]);delete d.g[v],d.h--}}this.G=null},ft.prototype.J=function(d,v,_,N){return this.i.add(String(d),v,!1,_,N)},ft.prototype.K=function(d,v,_,N){return this.i.add(String(d),v,!0,_,N)};function le(d,v,_,N){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let Z=!0;for(let he=0;he<v.length;++he){const $e=v[he];if($e&&!$e.da&&$e.capture==_){const Qt=$e.listener,ms=$e.ha||$e.src;$e.fa&&Be(d.i,$e),Z=Qt.call(ms,N)!==!1&&Z}}return Z&&!N.defaultPrevented}function He(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:h.setTimeout(d,v||0)}function tt(d){d.g=He(()=>{d.g=null,d.i&&(d.i=!1,tt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class pt extends L{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:tt(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(d){L.call(this),this.h=d,this.g={}}k(Dt,L);var at=[];function St(d){ht(d.g,function(v,_){this.g.hasOwnProperty(_)&&Ct(v)},d),d.g={}}Dt.prototype.N=function(){Dt.Z.N.call(this),St(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=h.JSON.stringify,xe=h.JSON.parse,Ie=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function Qe(){}function Ge(){}var We={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function nt(){D.call(this,"d")}k(nt,D);function st(){D.call(this,"c")}k(st,D);var qe={},Kt=null;function nn(){return Kt=Kt||new ft}qe.Ia="serverreachability";function en(d){D.call(this,qe.Ia,d)}k(en,D);function Nn(d){const v=nn();Ye(v,new en(v))}qe.STAT_EVENT="statevent";function Fn(d,v){D.call(this,qe.STAT_EVENT,d),this.stat=v}k(Fn,D);function Ut(d){const v=nn();Ye(v,new Fn(v,d))}qe.Ja="timingevent";function wn(d,v){D.call(this,qe.Ja,d),this.size=v}k(wn,D);function Xn(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function Dn(){this.g=!0}Dn.prototype.ua=function(){this.g=!1};function us(d,v,_,N,Z,he){d.info(function(){if(d.g)if(he){var $e="",Qt=he.split("&");for(let jn=0;jn<Qt.length;jn++){var ms=Qt[jn].split("=");if(ms.length>1){const Zn=ms[0];ms=ms[1];const Vr=Zn.split("_");$e=Vr.length>=2&&Vr[1]=="type"?$e+(Zn+"="+ms+"&"):$e+(Zn+"=redacted&")}}}else $e=null;else $e=he;return"XMLHTTP REQ ("+N+") [attempt "+Z+"]: "+v+`
`+_+`
`+$e})}function vs(d,v,_,N,Z,he,$e){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+Z+"]: "+v+`
`+_+`
`+he+" "+$e})}function Hn(d,v,_,N){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+ds(d,_)+(N?" "+N:"")})}function hs(d,v){d.info(function(){return"TIMEOUT: "+v})}Dn.prototype.info=function(){};function ds(d,v){if(!d.g)return v;if(!v)return null;try{const he=JSON.parse(v);if(he){for(d=0;d<he.length;d++)if(Array.isArray(he[d])){var _=he[d];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var Z=N[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let $e=1;$e<N.length;$e++)N[$e]=""}}}}return ce(he)}catch{return v}}var Ns={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Is={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Os;function q(){}k(q,Qe),q.prototype.g=function(){return new XMLHttpRequest},Os=new q;function ge(d){return encodeURIComponent(String(d))}function we(d){var v=1;d=d.split(":");const _=[];for(;v>0&&d.length;)_.push(d.shift()),v--;return d.length&&_.push(d.join(":")),_}function ve(d,v,_,N){this.j=d,this.i=v,this.l=_,this.S=N||1,this.V=new Dt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pe}function pe(){this.i=null,this.g="",this.h=!1}var ot={},Rt={};function ut(d,v,_){d.M=1,d.A=tn(Ce(v)),d.u=_,d.R=!0,_t(d,null)}function _t(d,v){d.F=Date.now(),bs(d),d.B=Ce(d.A);var _=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Ds(_.i,"t",N),d.C=0,_=d.j.L,d.h=new pe,d.g=qu(d.j,_?v:null,!d.u),d.P>0&&(d.O=new pt(y(d.Y,d,d.g),d.P)),v=d.V,_=d.g,N=d.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(at[0]=Z.toString()),Z=at);for(let he=0;he<Z.length;he++){const $e=Je(_,Z[he],N||v.handleEvent,!1,v.h||v);if(!$e)break;v.g[$e.key]=$e}v=d.J?P(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),Nn(),us(d.i,d.v,d.B,d.l,d.S,d.u)}ve.prototype.ba=function(d){d=d.target;const v=this.O;v&&$s(d)==3?v.j():this.Y(d)},ve.prototype.Y=function(d){try{if(d==this.g)e:{const Qt=$s(this.g),ms=this.g.ya(),jn=this.g.ca();if(!(Qt<3)&&(Qt!=3||this.g&&(this.h.h||this.g.la()||Gn(this.g)))){this.K||Qt!=4||ms==7||(ms==8||jn<=0?Nn(3):Nn(2)),Cn(this);var v=this.g.ca();this.X=v;var _=bt(this);if(this.o=v==200,vs(this.i,this.v,this.B,this.l,this.S,Qt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,Z=this.g;if((N=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(N)){var he=N;break t}}he=null}if(d=he)Hn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,T(this,d);else{this.o=!1,this.m=3,Ut(12),ue(this),F(this);break e}}if(this.R){d=!0;let Zn;for(;!this.K&&this.C<_.length;)if(Zn=er(this,_),Zn==Rt){Qt==4&&(this.m=4,Ut(14),d=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(Zn==ot){this.m=4,Ut(15),Hn(this.i,this.l,_,"[Invalid Chunk]"),d=!1;break}else Hn(this.i,this.l,Zn,null),T(this,Zn);if(dn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||_.length!=0||this.h.h||(this.m=1,Ut(16),d=!1),this.o=this.o&&d,!d)Hn(this.i,this.l,_,"[Invalid Chunked Response]"),ue(this),F(this);else if(_.length>0&&!this.W){this.W=!0;var $e=this.j;$e.g==this&&$e.aa&&!$e.P&&($e.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),tc($e),$e.P=!0,Ut(11))}}else Hn(this.i,this.l,_,null),T(this,_);Qt==4&&ue(this),this.o&&!this.K&&(Qt==4?Bu(this.j,this):(this.o=!1,bs(this)))}else hr(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,Ut(12)):(this.m=0,Ut(13)),ue(this),F(this)}}}catch{}};function bt(d){if(!dn(d))return d.g.la();const v=Gn(d.g);if(v==="")return"";let _="";const N=v.length,Z=$s(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return ue(d),F(d),"";d.h.i=new h.TextDecoder}for(let he=0;he<N;he++)d.h.h=!0,_+=d.h.i.decode(v[he],{stream:!(Z&&he==N-1)});return v.length=0,d.h.g+=_,d.C=0,d.h.g}function dn(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function er(d,v){var _=d.C,N=v.indexOf(`
`,_);return N==-1?Rt:(_=Number(v.substring(_,N)),isNaN(_)?ot:(N+=1,N+_>v.length?Rt:(v=v.slice(N,N+_),d.C=N+_,v)))}ve.prototype.cancel=function(){this.K=!0,ue(this)};function bs(d){d.T=Date.now()+d.H,Ms(d,d.H)}function Ms(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Xn(y(d.aa,d),v)}function Cn(d){d.D&&(h.clearTimeout(d.D),d.D=null)}ve.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(hs(this.i,this.B),this.M!=2&&(Nn(),Ut(17)),ue(this),this.m=2,F(this)):Ms(this,this.T-d)};function F(d){d.j.I==0||d.K||Bu(d.j,d)}function ue(d){Cn(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,St(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function T(d,v){try{var _=d.j;if(_.I!=0&&(_.g==d||Ve(_.h,d))){if(!d.L&&Ve(_.h,d)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var Z=N;if(Z[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<d.F)Yo(_),Gs(_);else break e;ho(_),Ut(18)}}else _.xa=Z[1],0<_.xa-_.K&&Z[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Xn(y(_.Va,_),6e3));Ue(_.h)<=1&&_.ta&&(_.ta=void 0)}else ga(_,11)}else if((d.L||_.g==d)&&Yo(_),!M(v))for(Z=_.Ba.g.parse(v),v=0;v<Z.length;v++){let jn=Z[v];const Zn=jn[0];if(!(Zn<=_.K))if(_.K=Zn,jn=jn[1],_.I==2)if(jn[0]=="c"){_.M=jn[1],_.ba=jn[2];const Vr=jn[3];Vr!=null&&(_.ka=Vr,_.j.info("VER="+_.ka));const ya=jn[4];ya!=null&&(_.za=ya,_.j.info("SVER="+_.za));const ta=jn[5];ta!=null&&typeof ta=="number"&&ta>0&&(N=1.5*ta,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const na=d.g;if(na){const fo=na.g?na.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fo){var he=N.h;he.g||fo.indexOf("spdy")==-1&&fo.indexOf("quic")==-1&&fo.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Pe(he,he.h),he.h=null))}if(N.G){const Qo=na.g?na.g.getResponseHeader("X-HTTP-Session-Id"):null;Qo&&(N.wa=Qo,ct(N.J,N.G,Qo))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-d.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var $e=d;if(N.na=Fu(N,N.L?N.ba:null,N.W),$e.L){Vt(N.h,$e);var Qt=$e,ms=N.O;ms&&(Qt.H=ms),Qt.D&&(Cn(Qt),bs(Qt)),N.g=$e}else ea(N);_.i.length>0&&jr(_)}else jn[0]!="stop"&&jn[0]!="close"||ga(_,7);else _.I==3&&(jn[0]=="stop"||jn[0]=="close"?jn[0]=="stop"?ga(_,7):Ws(_):jn[0]!="noop"&&_.l&&_.l.qa(jn),_.A=0)}}Nn(4)}catch{}}var C=class{constructor(d,v){this.g=d,this.map=v}};function K(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ee(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Ue(d){return d.h?1:d.g?d.g.size:0}function Ve(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Pe(d,v){d.g?d.g.add(v):d.h=v}function Vt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}K.prototype.cancel=function(){if(this.i=kt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function kt(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const _ of d.g.values())v=v.concat(_.G);return v}return O(d.i)}var H=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function de(d,v){if(d){d=d.split("&");for(let _=0;_<d.length;_++){const N=d[_].indexOf("=");let Z,he=null;N>=0?(Z=d[_].substring(0,N),he=d[_].substring(N+1)):Z=d[_],v(Z,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function re(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof re?(this.l=d.l,De(this,d.j),this.o=d.o,this.g=d.g,rt(this,d.u),this.h=d.h,At(this,Lr(d.i)),this.m=d.m):d&&(v=String(d).match(H))?(this.l=!1,De(this,v[1]||"",!0),this.o=Rn(v[2]||""),this.g=Rn(v[3]||"",!0),rt(this,v[4]),this.h=Rn(v[5]||"",!0),At(this,v[6]||"",!0),this.m=Rn(v[7]||"")):(this.l=!1,this.i=new $n(null,this.l))}re.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(fn(v,xr,!0),":");var _=this.g;return(_||v=="file")&&(d.push("//"),(v=this.o)&&d.push(fn(v,xr,!0),"@"),d.push(ge(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&d.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&d.push("/"),d.push(fn(_,_.charAt(0)=="/"?Jr:La,!0))),(_=this.i.toString())&&d.push("?",_),(_=this.m)&&d.push("#",fn(_,pn)),d.join("")},re.prototype.resolve=function(d){const v=Ce(this);let _=!!d.j;_?De(v,d.j):_=!!d.o,_?v.o=d.o:_=!!d.g,_?v.g=d.g:_=d.u!=null;var N=d.h;if(_)rt(v,d.u);else if(_=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var Z=v.h.lastIndexOf("/");Z!=-1&&(N=v.h.slice(0,Z+1)+N)}if(Z=N,Z==".."||Z==".")N="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){N=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const he=[];for(let $e=0;$e<Z.length;){const Qt=Z[$e++];Qt=="."?N&&$e==Z.length&&he.push(""):Qt==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),N&&$e==Z.length&&he.push("")):(he.push(Qt),N=!0)}N=he.join("/")}else N=Z}return _?v.h=N:_=d.i.toString()!=="",_?At(v,Lr(d.i)):_=!!d.m,_&&(v.m=d.m),v};function Ce(d){return new re(d)}function De(d,v,_){d.j=_?Rn(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function rt(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function At(d,v,_){v instanceof $n?(d.i=v,pa(d.i,d.l)):(_||(v=fn(v,wr)),d.i=new $n(v,d.l))}function ct(d,v,_){d.i.set(v,_)}function tn(d){return ct(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Rn(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function fn(d,v,_){return typeof d=="string"?(d=encodeURI(d).replace(v,mn),_&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function mn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var xr=/[#\/\?@]/g,La=/[#\?:]/g,Jr=/[#\?]/g,wr=/[#\?@]/g,pn=/#/g;function $n(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Bn(d){d.g||(d.g=new Map,d.h=0,d.i&&de(d.i,function(v,_){d.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=$n.prototype,s.add=function(d,v){Bn(this),this.i=null,d=kr(this,d);let _=this.g.get(d);return _||this.g.set(d,_=[]),_.push(v),this.h+=1,this};function _r(d,v){Bn(d),v=kr(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function cr(d,v){return Bn(d),v=kr(d,v),d.g.has(v)}s.forEach=function(d,v){Bn(this),this.g.forEach(function(_,N){_.forEach(function(Z){d.call(v,Z,N,this)},this)},this)};function Cs(d,v){Bn(d);let _=[];if(typeof v=="string")cr(d,v)&&(_=_.concat(d.g.get(kr(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)_=_.concat(d[v]);return _}s.set=function(d,v){return Bn(this),this.i=null,d=kr(this,d),cr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},s.get=function(d,v){return d?(d=Cs(this,d),d.length>0?String(d[0]):v):v};function Ds(d,v,_){_r(d,v),_.length>0&&(d.i=null,d.g.set(kr(d,v),O(_)),d.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const Z=ge(_);_=Cs(this,_);for(let he=0;he<_.length;he++){let $e=Z;_[he]!==""&&($e+="="+ge(_[he])),d.push($e)}}return this.i=d.join("&")};function Lr(d){const v=new $n;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function kr(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function pa(d,v){v&&!d.j&&(Bn(d),d.i=null,d.g.forEach(function(_,N){const Z=N.toLowerCase();N!=Z&&(_r(this,N),Ds(this,Z,_))},d)),d.j=v}function A(d,v){const _=new Dn;if(h.Image){const N=new Image;N.onload=x(Me,_,"TestLoadImage: loaded",!0,v,N),N.onerror=x(Me,_,"TestLoadImage: error",!1,v,N),N.onabort=x(Me,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=x(Me,_,"TestLoadImage: timeout",!1,v,N),h.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else v(!1)}function J(d,v){const _=new Dn,N=new AbortController,Z=setTimeout(()=>{N.abort(),Me(_,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:N.signal}).then(he=>{clearTimeout(Z),he.ok?Me(_,"TestPingServer: ok",!0,v):Me(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Z),Me(_,"TestPingServer: error",!1,v)})}function Me(d,v,_,N,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),N(_)}catch{}}function Xe(){this.g=new Ie}function mt(d){this.i=d.Sb||null,this.h=d.ab||!1}k(mt,Qe),mt.prototype.g=function(){return new it(this.i,this.h)};function it(d,v){ft.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(it,ft),s=it.prototype,s.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,Mt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||h).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Pt(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Mt(this)),this.g&&(this.readyState=3,Mt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;yt(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function yt(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Pt(this):Mt(this),this.readyState==3&&yt(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,Pt(this))},s.Na=function(d){this.g&&(this.response=d,Pt(this))},s.ga=function(){this.g&&Pt(this)};function Pt(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Mt(d)}s.setRequestHeader=function(d,v){this.A.append(d,v)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,d.push(_[0]+": "+_[1]),_=v.next();return d.join(`\r
`)};function Mt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(it.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function zt(d){let v="";return ht(d,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function Yt(d,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=zt(_),typeof d=="string"?_!=null&&ge(_):ct(d,v,_))}function Ft(d){ft.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(Ft,ft);var vn=/^https?$/i,Wn=["POST","PUT"];s=Ft.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Os.g(),this.g.onreadystatechange=E(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(he){Jn(this,he);return}if(d=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var Z in N)_.set(Z,N[Z]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const he of N.keys())_.set(he,N.get(he));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(he=>he.toLowerCase()=="content-type"),Z=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Wn,v,void 0)>=0)||N||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,$e]of _)this.g.setRequestHeader(he,$e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(he){Jn(this,he)}};function Jn(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,ns(d),ur(d)}function ns(d){d.A||(d.A=!0,Ye(d,"complete"),Ye(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Ye(this,"complete"),Ye(this,"abort"),ur(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ur(this,!0)),Ft.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?xs(this):this.Xa())},s.Xa=function(){xs(this)};function xs(d){if(d.h&&typeof u<"u"){if(d.v&&$s(d)==4)setTimeout(d.Ca.bind(d),0);else if(Ye(d,"readystatechange"),$s(d)==4){d.h=!1;try{const he=d.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=he===0){let $e=String(d.D).match(H)[1]||null;!$e&&h.self&&h.self.location&&($e=h.self.location.protocol.slice(0,-1)),N=!vn.test($e?$e.toLowerCase():"")}_=N}if(_)Ye(d,"complete"),Ye(d,"success");else{d.o=6;try{var Z=$s(d)>2?d.g.statusText:""}catch{Z=""}d.l=Z+" ["+d.ca()+"]",ns(d)}}finally{ur(d)}}}}function ur(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const _=d.g;d.g=null,v||Ye(d,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function $s(d){return d.g?d.g.readyState:0}s.ca=function(){try{return $s(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),xe(v)}};function Gn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function hr(d){const v={};d=(d.g&&$s(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(M(d[N]))continue;var _=we(d[N]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const he=v[Z]||[];v[Z]=he,he.push(_)}ae(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tr(d,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[d]||v}function fs(d){this.za=0,this.i=[],this.j=new Dn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tr("baseRetryDelayMs",5e3,d),this.Za=tr("retryDelaySeedMs",1e4,d),this.Ta=tr("forwardChannelMaxRetries",2,d),this.va=tr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new K(d&&d.concurrentRequestLimit),this.Ba=new Xe,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=fs.prototype,s.ka=8,s.I=1,s.connect=function(d,v,_,N){Ut(0),this.W=d,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Fu(this,null,this.W),jr(this)};function Ws(d){if(Tr(d),d.I==3){var v=d.V++,_=Ce(d.J);if(ct(_,"SID",d.M),ct(_,"RID",v),ct(_,"TYPE","terminate"),Or(d,_),v=new ve(d,d.j,v),v.M=2,v.A=tn(Ce(_)),_=!1,h.navigator&&h.navigator.sendBeacon)try{_=h.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&h.Image&&(new Image().src=v.A,_=!0),_||(v.g=qu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),bs(v)}zu(d)}function Gs(d){d.g&&(tc(d),d.g.cancel(),d.g=null)}function Tr(d){Gs(d),d.v&&(h.clearTimeout(d.v),d.v=null),Yo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function jr(d){if(!ee(d.h)&&!d.m){d.m=!0;var v=d.Ea;ze||j(),Le||(ze(),Le=!0),I.add(v,d),d.D=0}}function fi(d,v){return Ue(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Xn(y(d.Ea,d,v),Uu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const Z=new ve(this,this.j,d);let he=this.o;if(this.U&&(he?(he=P(he),ye(he,this.U)):he=this.U),this.u!==null||this.R||(Z.J=he,he=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=Zr(this,Z,v),_=Ce(this.J),ct(_,"RID",d),ct(_,"CVER",22),this.G&&ct(_,"X-HTTP-Session-Id",this.G),Or(this,_),he&&(this.R?v="headers="+ge(zt(he))+"&"+v:this.u&&Yt(_,this.u,he)),Pe(this.h,Z),this.Ra&&ct(_,"TYPE","init"),this.S?(ct(_,"$req",v),ct(_,"SID","null"),Z.U=!0,ut(Z,_,null)):ut(Z,_,v),this.I=2}}else this.I==3&&(d?uo(this,d):this.i.length==0||ee(this.h)||uo(this))};function uo(d,v){var _;v?_=v.l:_=d.V++;const N=Ce(d.J);ct(N,"SID",d.M),ct(N,"RID",_),ct(N,"AID",d.K),Or(d,N),d.u&&d.o&&Yt(N,d.u,d.o),_=new ve(d,d.j,_,d.D+1),d.u===null&&(_.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Zr(d,_,1e3),_.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Pe(d.h,_),ut(_,N,v)}function Or(d,v){d.H&&ht(d.H,function(_,N){ct(v,N,_)}),d.l&&ht({},function(_,N){ct(v,N,_)})}function Zr(d,v,_){_=Math.min(d.i.length,_);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var Z=d.i;let Qt=-1;for(;;){const ms=["count="+_];Qt==-1?_>0?(Qt=Z[0].g,ms.push("ofs="+Qt)):Qt=0:ms.push("ofs="+Qt);let jn=!0;for(let Zn=0;Zn<_;Zn++){var he=Z[Zn].g;const Vr=Z[Zn].map;if(he-=Qt,he<0)Qt=Math.max(0,Z[Zn].g-100),jn=!1;else try{he="req"+he+"_"||"";try{var $e=Vr instanceof Map?Vr:Object.entries(Vr);for(const[ya,ta]of $e){let na=ta;p(ta)&&(na=ce(ta)),ms.push(he+ya+"="+encodeURIComponent(na))}}catch(ya){throw ms.push(he+"type="+encodeURIComponent("_badmap")),ya}}catch{N&&N(Vr)}}if(jn){$e=ms.join("&");break e}}$e=void 0}return d=d.i.splice(0,_),v.G=d,$e}function ea(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;ze||j(),Le||(ze(),Le=!0),I.add(v,d),d.A=0}}function ho(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Xn(y(d.Da,d),Uu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Vu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Xn(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ut(10),Gs(this),Vu(this))};function tc(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Vu(d){d.g=new ve(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Ce(d.na);ct(v,"RID","rpc"),ct(v,"SID",d.M),ct(v,"AID",d.K),ct(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&ct(v,"TO",d.ia),ct(v,"TYPE","xmlhttp"),Or(d,v),d.u&&d.o&&Yt(v,d.u,d.o),d.O&&(d.g.H=d.O);var _=d.g;d=d.ba,_.M=1,_.A=tn(Ce(v)),_.u=null,_.R=!0,_t(_,d)}s.Va=function(){this.C!=null&&(this.C=null,Gs(this),ho(this),Ut(19))};function Yo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Bu(d,v){var _=null;if(d.g==v){Yo(d),tc(d),d.g=null;var N=2}else if(Ve(d.h,v))_=v.G,Vt(d.h,v),N=1;else return;if(d.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var Z=d.D;N=nn(),Ye(N,new wn(N,_)),jr(d)}else ea(d);else if(Z=v.m,Z==3||Z==0&&v.X>0||!(N==1&&fi(d,v)||N==2&&ho(d)))switch(_&&_.length>0&&(v=d.h,v.i=v.i.concat(_)),Z){case 1:ga(d,5);break;case 4:ga(d,10);break;case 3:ga(d,6);break;default:ga(d,2)}}}function Uu(d,v){let _=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(_*=2),_*v}function ga(d,v){if(d.j.info("Error code "+v),v==2){var _=y(d.bb,d),N=d.Ua;const Z=!N;N=new re(N||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||De(N,"https"),tn(N),Z?A(N.toString(),_):J(N.toString(),_)}else Ut(2);d.I=0,d.l&&d.l.pa(v),zu(d),Tr(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function zu(d){if(d.I=0,d.ja=[],d.l){const v=kt(d.h);(v.length!=0||d.i.length!=0)&&(G(d.ja,v),G(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function Fu(d,v,_){var N=_ instanceof re?Ce(_):new re(_);if(N.g!="")v&&(N.g=v+"."+N.g),rt(N,N.u);else{var Z=h.location;N=Z.protocol,v=v?v+"."+Z.hostname:Z.hostname,Z=+Z.port;const he=new re(null);N&&De(he,N),v&&(he.g=v),Z&&rt(he,Z),_&&(he.h=_),N=he}return _=d.G,v=d.wa,_&&v&&ct(N,_,v),ct(N,"VER",d.ka),Or(d,N),N}function qu(d,v,_){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new Ft(new mt({ab:_})):new Ft(d.ma),v.Fa(d.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}s=Hu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function mi(){}mi.prototype.g=function(d,v){return new nr(d,v)};function nr(d,v){ft.call(this),this.g=new fs(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!M(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!M(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Oa(this)}k(nr,ft),nr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){Ws(this.g)},nr.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var _={};_.__data__=d,d=_}else this.v&&(_={},_.__data__=ce(d),d=_);v.i.push(new C(v.Ya++,d)),v.I==3&&jr(v)},nr.prototype.N=function(){this.g.l=null,delete this.j,Ws(this.g),delete this.g,nr.Z.N.call(this)};function $u(d){nt.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const _ in v){d=_;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}k($u,nt);function Wu(){st.call(this),this.status=1}k(Wu,st);function Oa(d){this.g=d}k(Oa,Hu),Oa.prototype.ra=function(){Ye(this.g,"a")},Oa.prototype.qa=function(d){Ye(this.g,new $u(d))},Oa.prototype.pa=function(d){Ye(this.g,new Wu)},Oa.prototype.oa=function(){Ye(this.g,"b")},mi.prototype.createWebChannel=mi.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,Ow=function(){return new mi},Lw=function(){return nn()},Pw=qe,og={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ns.NO_ERROR=0,Ns.TIMEOUT=8,Ns.HTTP_ERROR=6,yd=Ns,Is.COMPLETE="complete",Dw=Is,Ge.EventType=We,We.OPEN="a",We.CLOSE="b",We.ERROR="c",We.MESSAGE="d",ft.prototype.listen=ft.prototype.J,Kc=Ge,Ft.prototype.listenOnce=Ft.prototype.K,Ft.prototype.getLastError=Ft.prototype.Ha,Ft.prototype.getLastErrorCode=Ft.prototype.ya,Ft.prototype.getStatus=Ft.prototype.ca,Ft.prototype.getResponseJson=Ft.prototype.La,Ft.prototype.getResponseText=Ft.prototype.la,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Fa,Mw=Ft}).apply(typeof Jh<"u"?Jh:typeof self<"u"?self:typeof window<"u"?window:{});class Qs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qs.UNAUTHENTICATED=new Qs(null),Qs.GOOGLE_CREDENTIALS=new Qs("google-credentials-uid"),Qs.FIRST_PARTY=new Qs("first-party-uid"),Qs.MOCK_USER=new Qs("mock-user");let Ql="12.8.0";function W4(s){Ql=s}const Fo=new Pg("@firebase/firestore");function Rl(){return Fo.logLevel}function lt(s,...e){if(Fo.logLevel<=ln.DEBUG){const n=e.map(Kg);Fo.debug(`Firestore (${Ql}): ${s}`,...n)}}function li(s,...e){if(Fo.logLevel<=ln.ERROR){const n=e.map(Kg);Fo.error(`Firestore (${Ql}): ${s}`,...n)}}function Ul(s,...e){if(Fo.logLevel<=ln.WARN){const n=e.map(Kg);Fo.warn(`Firestore (${Ql}): ${s}`,...n)}}function Kg(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Ot(s,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,Vw(s,i,n)}function Vw(s,e,n){let i=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw li(i),new Error(i)}function Sn(s,e,n,i){let l="Unexpected state";typeof n=="string"?l=n:i=n,s||Vw(e,l,i)}function Gt(s,e){return s}const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ze extends Da{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class si{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class Bw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Qs.UNAUTHENTICATED)))}shutdown(){}}class K4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Y4{constructor(e){this.t=e,this.currentUser=Qs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Sn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,n(g)):Promise.resolve();let u=new si;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new si,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{lt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(lt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new si)}}),0),h()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(lt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Sn(typeof i.accessToken=="string",31837,{l:i}),new Bw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Sn(e===null||typeof e=="string",2055,{h:e}),new Qs(e)}}class Q4{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Qs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class X4{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Q4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Qs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ax{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Sn(this.o===void 0,3512);const i=u=>{u.error!=null&&lt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,lt("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{lt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):lt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ax(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Sn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ax(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Z4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<s;i++)n[i]=Math.floor(256*Math.random());return n}class Yg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=Z4(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<n&&(i+=e.charAt(l[u]%62))}return i}}function cn(s,e){return s<e?-1:s>e?1:0}function lg(s,e){const n=Math.min(s.length,e.length);for(let i=0;i<n;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Np(l)===Np(u)?cn(l,u):Np(l)?1:-1}return cn(s.length,e.length)}const eR=55296,tR=57343;function Np(s){const e=s.charCodeAt(0);return e>=eR&&e<=tR}function zl(s,e,n){return s.length===e.length&&s.every(((i,l)=>n(i,e[l])))}const ix="__name__";class ka{constructor(e,n,i){n===void 0?n=0:n>e.length&&Ot(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Ot(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ka.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ka?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let l=0;l<i;l++){const u=ka.compareSegments(e.get(l),n.get(l));if(u!==0)return u}return cn(e.length,n.length)}static compareSegments(e,n){const i=ka.isNumericId(e),l=ka.isNumericId(n);return i&&!l?-1:!i&&l?1:i&&l?ka.extractNumericId(e).compare(ka.extractNumericId(n)):lg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class qn extends ka{construct(e,n,i){return new qn(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ze(Te.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((l=>l.length>0)))}return new qn(n)}static emptyPath(){return new qn([])}}const nR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qs extends ka{construct(e,n,i){return new qs(e,n,i)}static isValidIdentifier(e){return nR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ix}static keyField(){return new qs([ix])}static fromServerFormat(e){const n=[];let i="",l=0;const u=()=>{if(i.length===0)throw new Ze(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new Ze(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ze(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new Ze(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qs(n)}static emptyPath(){return new qs([])}}class jt{constructor(e){this.path=e}static fromPath(e){return new jt(qn.fromString(e))}static fromName(e){return new jt(qn.fromString(e).popFirst(5))}static empty(){return new jt(qn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jt(new qn(e.slice()))}}function Uw(s,e,n){if(!n)throw new Ze(Te.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function sR(s,e,n,i){if(e===!0&&i===!0)throw new Ze(Te.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function ox(s){if(!jt.isDocumentKey(s))throw new Ze(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function lx(s){if(jt.isDocumentKey(s))throw new Ze(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function zw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Zd(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ot(12329,{type:typeof s})}function or(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ze(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zd(s);throw new Ze(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function rR(s,e){if(e<=0)throw new Ze(Te.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function Ss(s,e){const n={typeString:s};return e&&(n.value=e),n}function Su(s,e){if(!zw(s))throw new Ze(Te.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){n=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){n=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){n=`Expected '${i}' field to equal '${u.value}'`;break}}if(n)throw new Ze(Te.INVALID_ARGUMENT,n);return!0}const cx=-62135596800,ux=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*ux);return new xt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ze(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ze(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<cx)throw new Ze(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ze(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ux}_compareTo(e){return this.seconds===e.seconds?cn(this.nanoseconds,e.nanoseconds):cn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Su(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Ss("string",xt._jsonSchemaVersion),seconds:Ss("number"),nanoseconds:Ss("number")};class qt{static fromTimestamp(e){return new qt(e)}static min(){return new qt(new xt(0,0))}static max(){return new qt(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const uu=-1;function aR(s,e){const n=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=qt.fromTimestamp(i===1e9?new xt(n+1,0):new xt(n,i));return new eo(l,jt.empty(),e)}function iR(s){return new eo(s.readTime,s.key,uu)}class eo{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new eo(qt.min(),jt.empty(),uu)}static max(){return new eo(qt.max(),jt.empty(),uu)}}function oR(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=jt.comparator(s.documentKey,e.documentKey),n!==0?n:cn(s.largestBatchId,e.largestBatchId))}const lR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Xl(s){if(s.code!==Te.FAILED_PRECONDITION||s.message!==lR)throw s;lt("LocalStore","Unexpectedly lost primary lease")}class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ae(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(n,u).next(i,l)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Ae?n:Ae.resolve(n)}catch(n){return Ae.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Ae.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Ae.reject(n)}static resolve(e){return new Ae(((n,i)=>{n(e)}))}static reject(e){return new Ae(((n,i)=>{i(e)}))}static waitFor(e){return new Ae(((n,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&n()}),(g=>i(g)))})),h=!0,u===l&&n()}))}static or(e){let n=Ae.resolve(!1);for(const i of e)n=n.next((l=>l?Ae.resolve(l):i()));return n}static forEach(e,n){const i=[];return e.forEach(((l,u)=>{i.push(n.call(this,l,u))})),this.waitFor(i)}static mapArray(e,n){return new Ae(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;n(e[y]).next((x=>{h[y]=x,++p,p===u&&i(h)}),(x=>l(x)))}}))}static doWhile(e,n){return new Ae(((i,l)=>{const u=()=>{e()===!0?n().next((()=>{u()}),l):i()};u()}))}}function uR(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Jl(s){return s.name==="IndexedDbTransactionError"}class ef{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;const Qg=-1;function tf(s){return s==null}function Md(s){return s===0&&1/s==-1/0}function hR(s){return typeof s=="number"&&Number.isInteger(s)&&!Md(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Fw="";function dR(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=hx(e)),e=fR(s.get(n),e);return hx(e)}function fR(s,e){let n=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":n+="";break;case Fw:n+="";break;default:n+=u}}return n}function hx(s){return s+Fw+""}function dx(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function lo(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function qw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class rs{constructor(e,n){this.comparator=e,this.root=n||Fs.EMPTY}insert(e,n){return new rs(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fs.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fs.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return n+i.left.size;l<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zh(this.root,e,this.comparator,!0)}}class Zh{constructor(e,n,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?i(e.key,n):1,n&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fs{constructor(e,n,i,l,u){this.key=e,this.value=n,this.color=i??Fs.RED,this.left=l??Fs.EMPTY,this.right=u??Fs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,l,u){return new Fs(e??this.key,n??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,n,i),null):u===0?l.copy(null,n,null,null,null):l.copy(null,null,null,null,l.right.insert(e,n,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Fs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,l=this;if(n(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,n),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),n(e,l.key)===0){if(l.right.isEmpty())return Fs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,n))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ot(27949);return e+(this.isRed()?0:1)}}Fs.EMPTY=null,Fs.RED=!0,Fs.BLACK=!1;Fs.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(e,n,i,l,u){return this}insert(e,n,i){return new Fs(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class As{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;n(l.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new fx(this.data.getIterator())}getIteratorFrom(e){return new fx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof As)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new As(this.comparator);return n.data=e,n}}class fx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Dr{constructor(e){this.fields=e,e.sort(qs.comparator)}static empty(){return new Dr([])}unionWith(e){let n=new As(qs.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new Dr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class Hw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Hw("Invalid base64 string: "+u):u}})(e);return new Hs(n)}static fromUint8Array(e){const n=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Hs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let l=0;l<n.length;l++)i[l]=n.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return cn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hs.EMPTY_BYTE_STRING=new Hs("");const mR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(s){if(Sn(!!s,39018),typeof s=="string"){let e=0;const n=mR.exec(s);if(Sn(!!n,46558,{timestamp:s}),n[1]){let l=n[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ys(s.seconds),nanos:ys(s.nanos)}}function ys(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function no(s){return typeof s=="string"?Hs.fromBase64String(s):Hs.fromUint8Array(s)}const $w="server_timestamp",Ww="__type__",Gw="__previous_value__",Kw="__local_write_time__";function Xg(s){return(s?.mapValue?.fields||{})[Ww]?.stringValue===$w}function nf(s){const e=s.mapValue.fields[Gw];return Xg(e)?nf(e):e}function hu(s){const e=to(s.mapValue.fields[Kw].timestampValue);return new xt(e.seconds,e.nanos)}class pR{constructor(e,n,i,l,u,h,p,g,y,x,k){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=k}}const Dd="(default)";class du{constructor(e,n){this.projectId=e,this.database=n||Dd}static empty(){return new du("","")}get isDefaultDatabase(){return this.database===Dd}isEqual(e){return e instanceof du&&e.projectId===this.projectId&&e.database===this.database}}function gR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ze(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new du(s.options.projectId,e)}const Yw="__type__",yR="__max__",ed={mapValue:{}},Qw="__vector__",Pd="value";function so(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Xg(s)?4:bR(s)?9007199254740991:vR(s)?10:11:Ot(28295,{value:s})}function Aa(s,e){if(s===e)return!0;const n=so(s);if(n!==so(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return hu(s).isEqual(hu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=to(l.timestampValue),p=to(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return no(l.bytesValue).isEqual(no(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return ys(l.geoPointValue.latitude)===ys(u.geoPointValue.latitude)&&ys(l.geoPointValue.longitude)===ys(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return ys(l.integerValue)===ys(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=ys(l.doubleValue),p=ys(u.doubleValue);return h===p?Md(h)===Md(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return zl(s.arrayValue.values||[],e.arrayValue.values||[],Aa);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(dx(h)!==dx(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Aa(h[g],p[g])))return!1;return!0})(s,e);default:return Ot(52216,{left:s})}}function fu(s,e){return(s.values||[]).find((n=>Aa(n,e)))!==void 0}function Fl(s,e){if(s===e)return 0;const n=so(s),i=so(e);if(n!==i)return cn(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return cn(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=ys(u.integerValue||u.doubleValue),g=ys(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return mx(s.timestampValue,e.timestampValue);case 4:return mx(hu(s),hu(e));case 5:return lg(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=no(u),g=no(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=cn(p[y],g[y]);if(x!==0)return x}return cn(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=cn(ys(u.latitude),ys(h.latitude));return p!==0?p:cn(ys(u.longitude),ys(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return px(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[Pd]?.arrayValue,x=g[Pd]?.arrayValue,k=cn(y?.values?.length||0,x?.values?.length||0);return k!==0?k:px(y,x)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===ed.mapValue&&h===ed.mapValue)return 0;if(u===ed.mapValue)return 1;if(h===ed.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let k=0;k<g.length&&k<x.length;++k){const E=lg(g[k],x[k]);if(E!==0)return E;const O=Fl(p[g[k]],y[x[k]]);if(O!==0)return O}return cn(g.length,x.length)})(s.mapValue,e.mapValue);default:throw Ot(23264,{he:n})}}function mx(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return cn(s,e);const n=to(s),i=to(e),l=cn(n.seconds,i.seconds);return l!==0?l:cn(n.nanos,i.nanos)}function px(s,e){const n=s.values||[],i=e.values||[];for(let l=0;l<n.length&&l<i.length;++l){const u=Fl(n[l],i[l]);if(u)return u}return cn(n.length,i.length)}function ql(s){return cg(s)}function cg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const i=to(n);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return no(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return jt.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let i="[",l=!0;for(const u of n.values||[])l?l=!1:i+=",",i+=cg(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(n){const i=Object.keys(n.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${cg(n.fields[h])}`;return l+"}"})(s.mapValue):Ot(61005,{value:s})}function vd(s){switch(so(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(s);return e?16+vd(e):16;case 5:return 2*s.stringValue.length;case 6:return no(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+vd(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return lo(i.fields,((u,h)=>{l+=u.length+vd(h)})),l})(s.mapValue);default:throw Ot(13486,{value:s})}}function gx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function ug(s){return!!s&&"integerValue"in s}function Jg(s){return!!s&&"arrayValue"in s}function yx(s){return!!s&&"nullValue"in s}function vx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function bd(s){return!!s&&"mapValue"in s}function vR(s){return(s?.mapValue?.fields||{})[Yw]?.stringValue===Qw}function eu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return lo(s.mapValue.fields,((n,i)=>e.mapValue.fields[n]=eu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=eu(s.arrayValue.values[n]);return e}return{...s}}function bR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===yR}class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!bd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=eu(n)}setAll(e){let n=qs.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!n.isImmediateParentOf(p)){const g=this.getFieldsMap(n);this.applyChanges(g,i,l),i={},l=[],n=p.popLast()}h?i[p.lastSegment()]=eu(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,i,l)}delete(e){const n=this.field(e.popLast());bd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Aa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=n.mapValue.fields[e.get(i)];bd(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=l),n=l}return n.mapValue.fields}applyChanges(e,n,i){lo(n,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new br(eu(this.value))}}function Xw(s){const e=[];return lo(s.fields,((n,i)=>{const l=new qs([n]);if(bd(i)){const u=Xw(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Dr(e)}class Xs{constructor(e,n,i,l,u,h,p){this.key=e,this.documentType=n,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new Xs(e,0,qt.min(),qt.min(),qt.min(),br.empty(),0)}static newFoundDocument(e,n,i,l){return new Xs(e,1,n,qt.min(),i,l,0)}static newNoDocument(e,n){return new Xs(e,2,n,qt.min(),qt.min(),br.empty(),0)}static newUnknownDocument(e,n){return new Xs(e,3,n,qt.min(),qt.min(),br.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(qt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ld{constructor(e,n){this.position=e,this.inclusive=n}}function bx(s,e,n){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=jt.comparator(jt.fromName(h.referenceValue),n.key):i=Fl(h,n.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function xx(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!Aa(s.position[n],e.position[n]))return!1;return!0}class mu{constructor(e,n="asc"){this.field=e,this.dir=n}}function xR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Jw{}class Es extends Jw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new _R(e,n,i):n==="array-contains"?new jR(e,i):n==="in"?new ER(e,i):n==="not-in"?new SR(e,i):n==="array-contains-any"?new NR(e,i):new Es(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new kR(e,i):new TR(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fl(n,this.value)):n!==null&&so(this.value)===so(n)&&this.matchesComparison(Fl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class da extends Jw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new da(e,n)}matches(e){return Zw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Zw(s){return s.op==="and"}function e_(s){return wR(s)&&Zw(s)}function wR(s){for(const e of s.filters)if(e instanceof da)return!1;return!0}function hg(s){if(s instanceof Es)return s.field.canonicalString()+s.op.toString()+ql(s.value);if(e_(s))return s.filters.map((e=>hg(e))).join(",");{const e=s.filters.map((n=>hg(n))).join(",");return`${s.op}(${e})`}}function t_(s,e){return s instanceof Es?(function(i,l){return l instanceof Es&&i.op===l.op&&i.field.isEqual(l.field)&&Aa(i.value,l.value)})(s,e):s instanceof da?(function(i,l){return l instanceof da&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&t_(h,l.filters[p])),!0):!1})(s,e):void Ot(19439)}function n_(s){return s instanceof Es?(function(n){return`${n.field.canonicalString()} ${n.op} ${ql(n.value)}`})(s):s instanceof da?(function(n){return n.op.toString()+" {"+n.getFilters().map(n_).join(" ,")+"}"})(s):"Filter"}class _R extends Es{constructor(e,n,i){super(e,n,i),this.key=jt.fromName(i.referenceValue)}matches(e){const n=jt.comparator(e.key,this.key);return this.matchesComparison(n)}}class kR extends Es{constructor(e,n){super(e,"in",n),this.keys=s_("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class TR extends Es{constructor(e,n){super(e,"not-in",n),this.keys=s_("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function s_(s,e){return(e.arrayValue?.values||[]).map((n=>jt.fromName(n.referenceValue)))}class jR extends Es{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jg(n)&&fu(n.arrayValue,this.value)}}class ER extends Es{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&fu(this.value.arrayValue,n)}}class SR extends Es{constructor(e,n){super(e,"not-in",n)}matches(e){if(fu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!fu(this.value.arrayValue,n)}}class NR extends Es{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>fu(this.value.arrayValue,i)))}}class CR{constructor(e,n=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function wx(s,e=null,n=[],i=[],l=null,u=null,h=null){return new CR(s,e,n,i,l,u,h)}function Zg(s){const e=Gt(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>hg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),tf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>ql(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>ql(i))).join(",")),e.Te=n}return e.Te}function ey(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!xR(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!t_(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!xx(s.startAt,e.startAt)&&xx(s.endAt,e.endAt)}function dg(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class Zl{constructor(e,n=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function RR(s,e,n,i,l,u,h,p){return new Zl(s,e,n,i,l,u,h,p)}function sf(s){return new Zl(s)}function _x(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function AR(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function r_(s){return s.collectionGroup!==null}function tu(s){const e=Gt(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new As(qs.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new mu(u,i))})),n.has(qs.keyField().canonicalString())||e.Ie.push(new mu(qs.keyField(),i))}return e.Ie}function Na(s){const e=Gt(s);return e.Ee||(e.Ee=IR(e,tu(s))),e.Ee}function IR(s,e){if(s.limitType==="F")return wx(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new mu(l.field,u)}));const n=s.endAt?new Ld(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Ld(s.startAt.position,s.startAt.inclusive):null;return wx(s.path,s.collectionGroup,e,s.filters,s.limit,n,i)}}function fg(s,e){const n=s.filters.concat([e]);return new Zl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function MR(s,e){const n=s.explicitOrderBy.concat([e]);return new Zl(s.path,s.collectionGroup,n,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Od(s,e,n){return new Zl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function rf(s,e){return ey(Na(s),Na(e))&&s.limitType===e.limitType}function a_(s){return`${Zg(Na(s))}|lt:${s.limitType}`}function Al(s){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((l=>n_(l))).join(", ")}]`),tf(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((l=>ql(l))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((l=>ql(l))).join(",")),`Target(${i})`})(Na(s))}; limitType=${s.limitType})`}function af(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):jt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of tu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=bx(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,tu(i),l)||i.endAt&&!(function(h,p,g){const y=bx(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,tu(i),l))})(s,e)}function DR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function i_(s){return(e,n)=>{let i=!1;for(const l of tu(s)){const u=PR(l,e,n);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function PR(s,e,n){const i=s.field.isKeyField()?jt.comparator(e.key,n.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Fl(g,y):Ot(42886)})(s.field,e,n);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Ot(19790,{direction:s.dir})}}class Go{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,n]);l.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[n]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,((n,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return qw(this.inner)}size(){return this.innerSize}}const LR=new rs(jt.comparator);function ci(){return LR}const o_=new rs(jt.comparator);function Yc(...s){let e=o_;for(const n of s)e=e.insert(n.key,n);return e}function l_(s){let e=o_;return s.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Io(){return nu()}function c_(){return nu()}function nu(){return new Go((s=>s.toString()),((s,e)=>s.isEqual(e)))}const OR=new rs(jt.comparator),VR=new As(jt.comparator);function un(...s){let e=VR;for(const n of s)e=e.add(n);return e}const BR=new As(cn);function UR(){return BR}function ty(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Md(e)?"-0":e}}function u_(s){return{integerValue:""+s}}function h_(s,e){return hR(e)?u_(e):ty(s,e)}class of{constructor(){this._=void 0}}function zR(s,e,n){return s instanceof pu?(function(l,u){const h={fields:{[Ww]:{stringValue:$w},[Kw]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&Xg(u)&&(u=nf(u)),u&&(h.fields[Gw]=u),{mapValue:h}})(n,e):s instanceof gu?f_(s,e):s instanceof yu?m_(s,e):(function(l,u){const h=d_(l,u),p=kx(h)+kx(l.Ae);return ug(h)&&ug(l.Ae)?u_(p):ty(l.serializer,p)})(s,e)}function FR(s,e,n){return s instanceof gu?f_(s,e):s instanceof yu?m_(s,e):n}function d_(s,e){return s instanceof vu?(function(i){return ug(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class pu extends of{}class gu extends of{constructor(e){super(),this.elements=e}}function f_(s,e){const n=p_(e);for(const i of s.elements)n.some((l=>Aa(l,i)))||n.push(i);return{arrayValue:{values:n}}}class yu extends of{constructor(e){super(),this.elements=e}}function m_(s,e){let n=p_(e);for(const i of s.elements)n=n.filter((l=>!Aa(l,i)));return{arrayValue:{values:n}}}class vu extends of{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function kx(s){return ys(s.integerValue||s.doubleValue)}function p_(s){return Jg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class g_{constructor(e,n){this.field=e,this.transform=n}}function qR(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof gu&&l instanceof gu||i instanceof yu&&l instanceof yu?zl(i.elements,l.elements,Aa):i instanceof vu&&l instanceof vu?Aa(i.Ae,l.Ae):i instanceof pu&&l instanceof pu})(s.transform,e.transform)}class HR{constructor(e,n){this.version=e,this.transformResults=n}}class lr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new lr}static exists(e){return new lr(void 0,e)}static updateTime(e){return new lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class lf{}function y_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new cf(s.key,lr.none()):new Nu(s.key,s.data,lr.none());{const n=s.data,i=br.empty();let l=new As(qs.comparator);for(let u of e.fields)if(!l.has(u)){let h=n.field(u);h===null&&u.length>1&&(u=u.popLast(),h=n.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new co(s.key,i,new Dr(l.toArray()),lr.none())}}function $R(s,e,n){s instanceof Nu?(function(l,u,h){const p=l.value.clone(),g=jx(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,n):s instanceof co?(function(l,u,h){if(!xd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=jx(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(v_(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,n):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,n)}function su(s,e,n,i){return s instanceof Nu?(function(u,h,p,g){if(!xd(u.precondition,h))return p;const y=u.value.clone(),x=Ex(u.fieldTransforms,g,h);return y.setAll(x),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,n,i):s instanceof co?(function(u,h,p,g){if(!xd(u.precondition,h))return p;const y=Ex(u.fieldTransforms,g,h),x=h.data;return x.setAll(v_(u)),x.setAll(y),h.convertToFoundDocument(h.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,n,i):(function(u,h,p){return xd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,n)}function WR(s,e){let n=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=d_(i.transform,l||null);u!=null&&(n===null&&(n=br.empty()),n.set(i.field,u))}return n||null}function Tx(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&zl(i,l,((u,h)=>qR(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Nu extends lf{constructor(e,n,i,l=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class co extends lf{constructor(e,n,i,l,u=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function v_(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=s.data.field(n);e.set(n,i)}})),e}function jx(s,e,n){const i=new Map;Sn(s.length===n.length,32656,{Ve:n.length,de:s.length});for(let l=0;l<n.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,FR(h,p,n[l]))}return i}function Ex(s,e,n){const i=new Map;for(const l of s){const u=l.transform,h=n.data.field(l.field);i.set(l.field,zR(u,h,e))}return i}class cf extends lf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GR extends lf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class KR{constructor(e,n,i,l){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&$R(u,e,i[l])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=su(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=su(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=c_();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=n.has(l.key)?null:p;const g=y_(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(qt.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),un())}isEqual(e){return this.batchId===e.batchId&&zl(this.mutations,e.mutations,((n,i)=>Tx(n,i)))&&zl(this.baseMutations,e.baseMutations,((n,i)=>Tx(n,i)))}}class ny{constructor(e,n,i,l){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=l}static from(e,n,i){Sn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return OR})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new ny(e,n,i,l)}}class YR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QR{constructor(e,n){this.count=e,this.unchangedNames=n}}var js,bn;function XR(s){switch(s){case Te.OK:return Ot(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return Ot(15467,{code:s})}}function b_(s){if(s===void 0)return li("GRPC error has no .code"),Te.UNKNOWN;switch(s){case js.OK:return Te.OK;case js.CANCELLED:return Te.CANCELLED;case js.UNKNOWN:return Te.UNKNOWN;case js.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case js.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case js.INTERNAL:return Te.INTERNAL;case js.UNAVAILABLE:return Te.UNAVAILABLE;case js.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case js.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case js.NOT_FOUND:return Te.NOT_FOUND;case js.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case js.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case js.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case js.ABORTED:return Te.ABORTED;case js.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case js.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case js.DATA_LOSS:return Te.DATA_LOSS;default:return Ot(39323,{code:s})}}(bn=js||(js={}))[bn.OK=0]="OK",bn[bn.CANCELLED=1]="CANCELLED",bn[bn.UNKNOWN=2]="UNKNOWN",bn[bn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bn[bn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bn[bn.NOT_FOUND=5]="NOT_FOUND",bn[bn.ALREADY_EXISTS=6]="ALREADY_EXISTS",bn[bn.PERMISSION_DENIED=7]="PERMISSION_DENIED",bn[bn.UNAUTHENTICATED=16]="UNAUTHENTICATED",bn[bn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bn[bn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bn[bn.ABORTED=10]="ABORTED",bn[bn.OUT_OF_RANGE=11]="OUT_OF_RANGE",bn[bn.UNIMPLEMENTED=12]="UNIMPLEMENTED",bn[bn.INTERNAL=13]="INTERNAL",bn[bn.UNAVAILABLE=14]="UNAVAILABLE",bn[bn.DATA_LOSS=15]="DATA_LOSS";function JR(){return new TextEncoder}const ZR=new Xi([4294967295,4294967295],0);function Sx(s){const e=JR().encode(s),n=new Iw;return n.update(e),new Uint8Array(n.digest())}function Nx(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Xi([n,i],0),new Xi([l,u],0)]}class sy{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Qc(`Invalid padding: ${n}`);if(i<0)throw new Qc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Qc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Qc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Xi.fromNumber(this.ge)}ye(e,n,i){let l=e.add(n.multiply(Xi.fromNumber(i)));return l.compare(ZR)===1&&(l=new Xi([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Sx(e),[i,l]=Nx(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,n,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new sy(u,l,n);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const n=Sx(e),[i,l]=Nx(n);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Qc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uf{constructor(e,n,i,l,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const l=new Map;return l.set(e,Cu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new uf(qt.min(),l,new rs(cn),ci(),un())}}class Cu{constructor(e,n,i,l,u){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new Cu(i,n,un(),un(),un())}}class wd{constructor(e,n,i,l){this.Se=e,this.removedTargetIds=n,this.key=i,this.De=l}}class x_{constructor(e,n){this.targetId=e,this.Ce=n}}class w_{constructor(e,n,i=Hs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=l}}class Cx{constructor(){this.ve=0,this.Fe=Rx(),this.Me=Hs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=un(),n=un(),i=un();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:n=n.add(l);break;case 1:i=i.add(l);break;default:Ot(38017,{changeType:u})}})),new Cu(this.Me,this.xe,e,n,i)}Ke(){this.Oe=!1,this.Fe=Rx()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Sn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class eA{constructor(e){this.Ge=e,this.ze=new Map,this.je=ci(),this.He=td(),this.Je=td(),this.Ze=new rs(cn)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Ot(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,l)=>{this.rt(l)&&n(l)}))}st(e){const n=e.targetId,i=e.Ce.count,l=this.ot(n);if(l){const u=l.target;if(dg(u))if(i===0){const h=new jt(u.path);this.et(n,h,Xs.newNoDocument(h,qt.min()))}else Sn(i===1,20013,{expectedCount:i});else{const h=this._t(n);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(n);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,y)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=n;let h,p;try{h=no(i).toUint8Array()}catch(g){if(g instanceof Hw)return Ul("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new sy(h,l,u)}catch(g){return Ul(g instanceof Qc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),l++)})),l}Tt(e){const n=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&dg(p.target)){const g=new jt(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,Xs.newNoDocument(g,e))}u.Be&&(n.set(h,u.ke()),u.Ke())}}));let i=un();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new uf(e,n,this.Ze,this.je,i);return this.je=ci(),this.He=td(),this.Je=td(),this.Ze=new rs(cn),l}Ye(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,n)?l.qe(n,1):l.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Cx,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new As(cn),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new As(cn),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||lt("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Cx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function td(){return new rs(jt.comparator)}function Rx(){return new rs(jt.comparator)}const tA={asc:"ASCENDING",desc:"DESCENDING"},nA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sA={and:"AND",or:"OR"};class rA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function mg(s,e){return s.useProto3Json||tf(e)?e:{value:e}}function Vd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function aA(s,e){return Vd(s,e.toTimestamp())}function Ca(s){return Sn(!!s,49232),qt.fromTimestamp((function(n){const i=to(n);return new xt(i.seconds,i.nanos)})(s))}function ry(s,e){return pg(s,e).canonicalString()}function pg(s,e){const n=(function(l){return new qn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?n:n.child(e)}function k_(s){const e=qn.fromString(s);return Sn(N_(e),10190,{key:e.toString()}),e}function gg(s,e){return ry(s.databaseId,e.path)}function Cp(s,e){const n=k_(e);if(n.get(1)!==s.databaseId.projectId)throw new Ze(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new Ze(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new jt(j_(n))}function T_(s,e){return ry(s.databaseId,e)}function iA(s){const e=k_(s);return e.length===4?qn.emptyPath():j_(e)}function yg(s){return new qn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function j_(s){return Sn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Ax(s,e,n){return{name:gg(s,e),fields:n.value.mapValue.fields}}function oA(s,e){let n;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Ot(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Sn(x===void 0||typeof x=="string",58123),Hs.fromBase64String(x||"")):(Sn(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Hs.fromUint8Array(x||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const x=y.code===void 0?Te.UNKNOWN:b_(y.code);return new Ze(x,y.message||"")})(h);n=new w_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Cp(s,i.document.name),u=Ca(i.document.updateTime),h=i.document.createTime?Ca(i.document.createTime):qt.min(),p=new br({mapValue:{fields:i.document.fields}}),g=Xs.newFoundDocument(l,u,h,p),y=i.targetIds||[],x=i.removedTargetIds||[];n=new wd(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Cp(s,i.document),u=i.readTime?Ca(i.readTime):qt.min(),h=Xs.newNoDocument(l,u),p=i.removedTargetIds||[];n=new wd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Cp(s,i.document),u=i.removedTargetIds||[];n=new wd([],u,l,null)}else{if(!("filter"in e))return Ot(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new QR(l,u),p=i.targetId;n=new x_(p,h)}}return n}function lA(s,e){let n;if(e instanceof Nu)n={update:Ax(s,e.key,e.value)};else if(e instanceof cf)n={delete:gg(s,e.key)};else if(e instanceof co)n={update:Ax(s,e.key,e.data),updateMask:yA(e.fieldMask)};else{if(!(e instanceof GR))return Ot(16599,{dt:e.type});n={verify:gg(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof pu)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof gu)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof yu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof vu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw Ot(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:aA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ot(27497)})(s,e.precondition)),n}function cA(s,e){return s&&s.length>0?(Sn(e!==void 0,14353),s.map((n=>(function(l,u){let h=l.updateTime?Ca(l.updateTime):Ca(u);return h.isEqual(qt.min())&&(h=Ca(u)),new HR(h,l.transformResults||[])})(n,e)))):[]}function uA(s,e){return{documents:[T_(s,e.path)]}}function hA(s,e){const n={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=T_(s,l);const u=(function(y){if(y.length!==0)return S_(da.create(y,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((x=>(function(E){return{field:Il(E.field),direction:mA(E.dir)}})(x)))})(e.orderBy);h&&(n.structuredQuery.orderBy=h);const p=mg(s,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:n,parent:l}}function dA(s){let e=iA(s.parent);const n=s.structuredQuery,i=n.from?n.from.length:0;let l=null;if(i>0){Sn(i===1,65062);const x=n.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];n.where&&(u=(function(k){const E=E_(k);return E instanceof da&&e_(E)?E.getFilters():[E]})(n.where));let h=[];n.orderBy&&(h=(function(k){return k.map((E=>(function(G){return new mu(Ml(G.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(G.direction))})(E)))})(n.orderBy));let p=null;n.limit&&(p=(function(k){let E;return E=typeof k=="object"?k.value:k,tf(E)?null:E})(n.limit));let g=null;n.startAt&&(g=(function(k){const E=!!k.before,O=k.values||[];return new Ld(O,E)})(n.startAt));let y=null;return n.endAt&&(y=(function(k){const E=!k.before,O=k.values||[];return new Ld(O,E)})(n.endAt)),RR(e,l,h,u,p,"F",g,y)}function fA(s,e){const n=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:l})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function E_(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Ml(n.unaryFilter.field);return Es.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ml(n.unaryFilter.field);return Es.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ml(n.unaryFilter.field);return Es.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Ml(n.unaryFilter.field);return Es.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Es.create(Ml(n.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return da.create(n.compositeFilter.filters.map((i=>E_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}})(n.compositeFilter.op))})(s):Ot(30097,{filter:s})}function mA(s){return tA[s]}function pA(s){return nA[s]}function gA(s){return sA[s]}function Il(s){return{fieldPath:s.canonicalString()}}function Ml(s){return qs.fromServerFormat(s.fieldPath)}function S_(s){return s instanceof Es?(function(n){if(n.op==="=="){if(vx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NAN"}};if(yx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NOT_NAN"}};if(yx(n.value))return{unaryFilter:{field:Il(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Il(n.field),op:pA(n.op),value:n.value}}})(s):s instanceof da?(function(n){const i=n.getFilters().map((l=>S_(l)));return i.length===1?i[0]:{compositeFilter:{op:gA(n.op),filters:i}}})(s):Ot(54877,{filter:s})}function yA(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function N_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function C_(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Wi{constructor(e,n,i,l,u=qt.min(),h=qt.min(),p=Hs.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class vA{constructor(e){this.yt=e}}function bA(s){const e=dA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Od(e,e.limit,"L"):e}class xA{constructor(){this.Sn=new wA}addToCollectionParentIndex(e,n){return this.Sn.add(n),Ae.resolve()}getCollectionParents(e,n){return Ae.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return Ae.resolve()}deleteFieldIndex(e,n){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,n){return Ae.resolve()}getDocumentsMatchingTarget(e,n){return Ae.resolve(null)}getIndexType(e,n){return Ae.resolve(0)}getFieldIndexes(e,n){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,n){return Ae.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,n){return Ae.resolve(eo.min())}updateCollectionGroup(e,n,i){return Ae.resolve()}updateIndexEntries(e,n){return Ae.resolve()}}class wA{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),l=this.index[n]||new As(qn.comparator),u=!l.has(i);return this.index[n]=l.add(i),u}has(e){const n=e.lastSegment(),i=e.popLast(),l=this.index[n];return l&&l.has(i)}getEntries(e){return(this.index[e]||new As(qn.comparator)).toArray()}}const Ix={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},R_=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(R_,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Hl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Hl(0)}static ar(){return new Hl(-1)}}const Mx="LruGarbageCollector",_A=1048576;function Dx([s,e],[n,i]){const l=cn(s,n);return l===0?cn(e,i):l}class kA{constructor(e){this.Pr=e,this.buffer=new As(Dx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Dx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class TA{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){lt(Mx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Jl(n)?lt(Mx,"Ignoring IndexedDB error during garbage collection: ",n):await Xl(n)}await this.Ar(3e5)}))}}class jA{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return Ae.resolve(ef.ce);const i=new kA(n);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.Vr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(lt("LruGarbageCollector","Garbage collection skipped; disabled"),Ae.resolve(Ix)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(lt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ix):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let i,l,u,h,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(lt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,h=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,n)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Rl()<=ln.DEBUG&&lt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-x}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),Ae.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function EA(s,e){return new jA(s,e)}class SA{constructor(){this.changes=new Go((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Xs.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Ae.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class CA{constructor(e,n,i,l){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,n)))).next((l=>(i!==null&&su(i.mutation,l,Dr.empty(),xt.now()),l)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,un()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=un()){const l=Io();return this.populateOverlays(e,l,n).next((()=>this.computeViews(e,n,l,i).next((u=>{let h=Yc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,n){const i=Io();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,un())))}populateOverlays(e,n,i){const l=[];return i.forEach((u=>{n.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{n.set(h,p)}))}))}computeViews(e,n,i,l){let u=ci();const h=nu(),p=(function(){return nu()})();return n.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof co)?u=u.insert(y.key,y):x!==void 0?(h.set(y.key,x.mutation.getFieldMask()),su(x.mutation,y,x.mutation.getFieldMask(),xt.now())):h.set(y.key,Dr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>h.set(y,x))),n.forEach(((y,x)=>p.set(y,new NA(x,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,n){const i=nu();let l=new rs(((h,p)=>h-p)),u=un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=n.get(g);if(y===null)return;let x=i.get(g)||Dr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const k=(l.get(p.batchId)||un()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,k=c_();x.forEach((E=>{if(!u.has(E)){const O=y_(n.get(E),i.get(E));O!==null&&k.set(E,O),u=u.add(E)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Ae.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,l){return AR(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):r_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,l):this.getDocumentsMatchingCollectionQuery(e,n,i,l)}getNextDocuments(e,n,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,l-u.size):Ae.resolve(Io());let p=uu,g=u;return h.next((y=>Ae.forEach(y,((x,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(x)?Ae.resolve():this.remoteDocumentCache.getEntry(e,x).next((E=>{g=g.insert(x,E)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,un()))).next((x=>({batchId:p,changes:l_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new jt(n)).next((i=>{let l=Yc();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,l){const u=n.collectionGroup;let h=Yc();return this.indexManager.getCollectionParents(e,u).next((p=>Ae.forEach(p,(g=>{const y=(function(k,E){return new Zl(E,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(n,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((k,E)=>{h=h.insert(k,E)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,n,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const x=y.getKey();h.get(x)===null&&(h=h.insert(x,Xs.newInvalidDocument(x)))}));let p=Yc();return h.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&su(x.mutation,y,Dr.empty(),xt.now()),af(n,y)&&(p=p.insert(g,y))})),p}))}}class RA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return Ae.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(l){return{id:l.id,version:l.version,createTime:Ca(l.createTime)}})(n)),Ae.resolve()}getNamedQuery(e,n){return Ae.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(l){return{name:l.name,query:bA(l.bundledQuery),readTime:Ca(l.readTime)}})(n)),Ae.resolve()}}class AA{constructor(){this.overlays=new rs(jt.comparator),this.Lr=new Map}getOverlay(e,n){return Ae.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Io();return Ae.forEach(n,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((l,u)=>{this.bt(e,n,u)})),Ae.resolve()}removeOverlaysForBatchId(e,n,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ae.resolve()}getOverlaysForCollection(e,n,i){const l=Io(),u=n.length+1,h=new jt(n.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!n.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ae.resolve(l)}getOverlaysForCollectionGroup(e,n,i,l){let u=new rs(((y,x)=>y-x));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===n&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Io(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Io(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return Ae.resolve(p)}bt(e,n,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new YR(n,i));let u=this.Lr.get(n);u===void 0&&(u=un(),this.Lr.set(n,u)),this.Lr.set(n,u.add(i.key))}}class IA{constructor(){this.sessionToken=Hs.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Ae.resolve()}}class ay{constructor(){this.kr=new As(Ls.Kr),this.qr=new As(Ls.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const i=new Ls(e,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Wr(new Ls(e,n))}Qr(e,n){e.forEach((i=>this.removeReference(i,n)))}Gr(e){const n=new jt(new qn([])),i=new Ls(n,e),l=new Ls(n,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new jt(new qn([])),i=new Ls(n,e),l=new Ls(n,e+1);let u=un();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const n=new Ls(e,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Ls{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return jt.comparator(e.key,n.key)||cn(e.Hr,n.Hr)}static Ur(e,n){return cn(e.Hr,n.Hr)||jt.comparator(e.key,n.key)}}class MA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new As(Ls.Kr)}checkEmpty(e){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new KR(u,n,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new Ls(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ae.resolve(h)}lookupMutationBatch(e,n){return Ae.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,l=this.Xr(i),u=l<0?0:l;return Ae.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?Qg:this.Yn-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Ls(n,0),l=new Ls(n,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),Ae.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new As(cn);return n.forEach((l=>{const u=new Ls(l,0),h=new Ls(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),Ae.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,l=i.length+1;let u=i;jt.isDocumentKey(u)||(u=u.child(""));const h=new Ls(new jt(u),0);let p=new As(cn);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),Ae.resolve(this.Yr(p))}Yr(e){const n=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&n.push(l)})),n}removeMutationBatch(e,n){Sn(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ae.forEach(n.mutations,(l=>{const u=new Ls(l.key,n.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,n){const i=new Ls(n,0),l=this.Jr.firstAfterOrEqual(i);return Ae.resolve(n.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class DA{constructor(e){this.ti=e,this.docs=(function(){return new rs(jt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return Ae.resolve(i?i.document.mutableCopy():Xs.newInvalidDocument(n))}getEntries(e,n){let i=ci();return n.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Xs.newInvalidDocument(l))})),Ae.resolve(i)}getDocumentsMatchingQuery(e,n,i,l){let u=ci();const h=n.path,p=new jt(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||oR(iR(x),i)<=0||(l.has(x.key)||af(n,x))&&(u=u.insert(x.key,x.mutableCopy()))}return Ae.resolve(u)}getAllFromCollectionGroup(e,n,i,l){Ot(9500)}ni(e,n){return Ae.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new PA(this)}getSize(e){return Ae.resolve(this.size)}}class PA extends SA{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?n.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ae.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class LA{constructor(e){this.persistence=e,this.ri=new Go((n=>Zg(n)),ey),this.lastRemoteSnapshotVersion=qt.min(),this.highestTargetId=0,this.ii=0,this.si=new ay,this.targetCount=0,this.oi=Hl._r()}forEachTarget(e,n){return this.ri.forEach(((i,l)=>n(l))),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),Ae.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Hl(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,Ae.resolve()}updateTargetData(e,n){return this.lr(n),Ae.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,n,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=n&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ae.waitFor(u).next((()=>l))}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,n){const i=this.ri.get(n)||null;return Ae.resolve(i)}addMatchingKeys(e,n,i){return this.si.$r(n,i),Ae.resolve()}removeMatchingKeys(e,n,i){this.si.Qr(n,i);const l=this.persistence.referenceDelegate,u=[];return l&&n.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),Ae.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),Ae.resolve()}getMatchingKeysForTargetId(e,n){const i=this.si.jr(n);return Ae.resolve(i)}containsKey(e,n){return Ae.resolve(this.si.containsKey(n))}}class A_{constructor(e,n){this._i={},this.overlays={},this.ai=new ef(0),this.ui=!1,this.ui=!0,this.ci=new IA,this.referenceDelegate=e(this),this.li=new LA(this),this.indexManager=new xA,this.remoteDocumentCache=(function(l){return new DA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new vA(n),this.Pi=new RA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new AA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this._i[e.toKey()];return i||(i=new MA(n,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,i){lt("MemoryPersistence","Starting transaction:",e);const l=new OA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,n){return Ae.or(Object.values(this._i).map((i=>()=>i.containsKey(e,n))))}}class OA extends cR{constructor(e){super(),this.currentSequenceNumber=e}}class iy{constructor(e){this.persistence=e,this.Ri=new ay,this.Ai=null}static Vi(e){return new iy(e)}get di(){if(this.Ai)return this.Ai;throw Ot(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),Ae.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),Ae.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),Ae.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.di,(i=>{const l=jt.fromPath(i);return this.mi(e,l).next((u=>{u||n.removeEntry(l,qt.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return Ae.or([()=>Ae.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Bd{constructor(e,n){this.persistence=e,this.fi=new Go((i=>dR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=EA(this,n)}static Vi(e,n){return new Bd(e,n)}Ti(){}Ii(e){return Ae.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((l=>i+l))))}pr(e){let n=0;return this.mr(e,(i=>{n++})).next((()=>n))}mr(e,n){return Ae.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ae.resolve():n(l)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,n).next((p=>{p||(i++,u.removeEntry(h,qt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),Ae.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Ae.resolve()}removeReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Ae.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),Ae.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vd(e.data.value)),n}wr(e,n,i){return Ae.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const l=this.fi.get(n);return Ae.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class oy{constructor(e,n,i,l){this.targetId=e,this.fromCache=n,this.Ts=i,this.Is=l}static Es(e,n){let i=un(),l=un();for(const u of n.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new oy(e,n.fromCache,i,l)}}class VA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class BA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return dS()?8:uR(Js())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,l){const u={result:null};return this.gs(e,n).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,n,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new VA;return this.ys(e,n,h).next((p=>{if(u.result=p,this.As)return this.ws(e,n,h,p.size)}))})).next((()=>u.result))}ws(e,n,i,l){return i.documentReadCount<this.Vs?(Rl()<=ln.DEBUG&&lt("QueryEngine","SDK will not create cache indexes for query:",Al(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ae.resolve()):(Rl()<=ln.DEBUG&&lt("QueryEngine","Query:",Al(n),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Rl()<=ln.DEBUG&&lt("QueryEngine","The SDK decides to create cache indexes for query:",Al(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Na(n))):Ae.resolve())}gs(e,n){if(_x(n))return Ae.resolve(null);let i=Na(n);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(n.limit!==null&&l===1&&(n=Od(n,null,"F"),i=Na(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=un(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(n,p);return this.Ss(n,y,h,g.readTime)?this.gs(e,Od(n,null,"F")):this.Ds(e,y,n,g)}))))})))))}ps(e,n,i,l){return _x(n)||l.isEqual(qt.min())?Ae.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(n,u);return this.Ss(n,h,i,l)?Ae.resolve(null):(Rl()<=ln.DEBUG&&lt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Al(n)),this.Ds(e,h,n,aR(l,uu)).next((p=>p)))}))}bs(e,n){let i=new As(i_(e));return n.forEach(((l,u)=>{af(e,u)&&(i=i.add(u))})),i}Ss(e,n,i,l){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,n,i){return Rl()<=ln.DEBUG&&lt("QueryEngine","Using full collection scan to execute query:",Al(n)),this.fs.getDocumentsMatchingQuery(e,n,eo.min(),i)}Ds(e,n,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(n.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const ly="LocalStore",UA=3e8;class zA{constructor(e,n,i,l){this.persistence=e,this.Cs=n,this.serializer=l,this.vs=new rs(cn),this.Fs=new Go((u=>Zg(u)),ey),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function FA(s,e,n,i){return new zA(s,e,n,i)}async function I_(s,e){const n=Gt(s);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return n.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,n.Os(e),n.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=un();for(const y of l){h.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return n.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function qA(s,e){const n=Gt(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=n.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const k=y.batch,E=k.keys();let O=Ae.resolve();return E.forEach((G=>{O=O.next((()=>x.getEntry(g,G))).next((U=>{const V=y.docVersions.get(G);Sn(V!==null,48541),U.version.compareTo(V)<0&&(k.applyToRemoteDocument(U,y),U.isValidDocument()&&(U.setReadTime(y.commitVersion),x.addEntry(U)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(n,i,e,u).next((()=>u.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=un();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>n.localDocuments.getDocuments(i,l)))}))}function M_(s){const e=Gt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function HA(s,e){const n=Gt(s),i=e.snapshotVersion;let l=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=n.xs.newChangeBuffer({trackRemovals:!0});l=n.vs;const p=[];e.targetChanges.forEach(((x,k)=>{const E=l.get(k);if(!E)return;p.push(n.li.removeMatchingKeys(u,x.removedDocuments,k).next((()=>n.li.addMatchingKeys(u,x.addedDocuments,k))));let O=E.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(Hs.EMPTY_BYTE_STRING,qt.min()).withLastLimboFreeSnapshotVersion(qt.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(k,O),(function(U,V,te){return U.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=UA?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(E,O,x)&&p.push(n.li.updateTargetData(u,O))}));let g=ci(),y=un();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push($A(u,h,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(qt.min())){const x=n.li.getLastRemoteSnapshotVersion(u).next((k=>n.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return Ae.waitFor(p).next((()=>h.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(n.vs=l,u)))}function $A(s,e,n){let i=un(),l=un();return n.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=ci();return n.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(qt.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):lt(ly,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function WA(s,e){const n=Gt(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Qg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function GA(s,e){const n=Gt(s);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return n.li.getTargetData(i,e).next((u=>u?(l=u,Ae.resolve(l)):n.li.allocateTargetId(i).next((h=>(l=new Wi(e,h,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=n.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(e,i.targetId)),i}))}async function vg(s,e,n){const i=Gt(s),l=i.vs.get(e),u=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!Jl(h))throw h;lt(ly,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Px(s,e,n){const i=Gt(s);let l=qt.min(),u=un();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,x){const k=Gt(g),E=k.Fs.get(x);return E!==void 0?Ae.resolve(k.vs.get(E)):k.li.getTargetData(y,x)})(i,h,Na(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,n?l:qt.min(),n?u:un()))).next((p=>(KA(i,DR(e),p),{documents:p,ks:u})))))}function KA(s,e,n){let i=s.Ms.get(e)||qt.min();n.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class Lx{constructor(){this.activeTargetIds=UR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YA{constructor(){this.vo=new Lx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,i){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Lx,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class QA{Mo(e){}shutdown(){}}const Ox="ConnectivityMonitor";class Vx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){lt(Ox,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){lt(Ox,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let nd=null;function bg(){return nd===null?nd=(function(){return 268435456+Math.round(2147483648*Math.random())})():nd++,"0x"+nd.toString(16)}const Rp="RestConnection",XA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class JA{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Dd?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,n,i,l,u){const h=bg(),p=this.Qo(e,n.toUriEncodedString());lt(Rp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=io(y);return this.zo(e,p,g,i,x).then((k=>(lt(Rp,`Received RPC '${e}' ${h}: `,k),k)),(k=>{throw Ul(Rp,`RPC '${e}' ${h} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,n,i,l,u,h){return this.Wo(e,n,i,l,u)}Go(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ql})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,n){const i=XA[e];let l=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class ZA{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ys="WebChannelConnection",zc=(s,e,n)=>{s.listen(e,(i=>{try{n(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Vl extends JA{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Vl.c_){const e=Lw();zc(e,Pw.STAT_EVENT,(n=>{n.stat===og.PROXY?lt(Ys,"STAT_EVENT: detected buffering proxy"):n.stat===og.NOPROXY&&lt(Ys,"STAT_EVENT: detected no buffering proxy")})),Vl.c_=!0}}zo(e,n,i,l,u){const h=bg();return new Promise(((p,g)=>{const y=new Mw;y.setWithCredentials(!0),y.listenOnce(Dw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case yd.NO_ERROR:const k=y.getResponseJson();lt(Ys,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(k)),p(k);break;case yd.TIMEOUT:lt(Ys,`RPC '${e}' ${h} timed out`),g(new Ze(Te.DEADLINE_EXCEEDED,"Request time out"));break;case yd.HTTP_ERROR:const E=y.getStatus();if(lt(Ys,`RPC '${e}' ${h} failed with status:`,E,"response text:",y.getResponseText()),E>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const G=O?.error;if(G&&G.status&&G.message){const U=(function(te){const X=te.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(X)>=0?X:Te.UNKNOWN})(G.status);g(new Ze(U,G.message))}else g(new Ze(Te.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new Ze(Te.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{lt(Ys,`RPC '${e}' ${h} completed.`)}}));const x=JSON.stringify(l);lt(Ys,`RPC '${e}' ${h} sending request:`,l),y.send(n,"POST",x,i,15)}))}T_(e,n,i){const l=bg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,n,i),p.encodeInitMessageHeaders=!0;const y=u.join("");lt(Ys,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=h.createWebChannel(y,p);this.I_(x);let k=!1,E=!1;const O=new ZA({Ho:G=>{E?lt(Ys,`Not sending because RPC '${e}' stream ${l} is closed:`,G):(k||(lt(Ys,`Opening RPC '${e}' stream ${l} transport.`),x.open(),k=!0),lt(Ys,`RPC '${e}' stream ${l} sending:`,G),x.send(G))},Jo:()=>x.close()});return zc(x,Kc.EventType.OPEN,(()=>{E||(lt(Ys,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),zc(x,Kc.EventType.CLOSE,(()=>{E||(E=!0,lt(Ys,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),zc(x,Kc.EventType.ERROR,(G=>{E||(E=!0,Ul(Ys,`RPC '${e}' stream ${l} transport errored. Name:`,G.name,"Message:",G.message),O.o_(new Ze(Te.UNAVAILABLE,"The operation could not be completed")))})),zc(x,Kc.EventType.MESSAGE,(G=>{if(!E){const U=G.data[0];Sn(!!U,16349);const V=U,te=V?.error||V[0]?.error;if(te){lt(Ys,`RPC '${e}' stream ${l} received error:`,te);const X=te.status;let me=(function(Le){const I=js[Le];if(I!==void 0)return b_(I)})(X),Ee=te.message;me===void 0&&(me=Te.INTERNAL,Ee="Unknown error status: "+X+" with message "+te.message),E=!0,O.o_(new Ze(me,Ee)),x.close()}else lt(Ys,`RPC '${e}' stream ${l} received:`,U),O.__(U)}})),Vl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,i){super.Go(e,n,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Ow()}}function eI(s){return new Vl(s)}function Ap(){return typeof document<"u"?document:null}function hf(s){return new rA(s,!0)}Vl.c_=!1;class D_{constructor(e,n,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=n,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,n-i);l>0&&lt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Bx="PersistentStream";class P_{constructor(e,n,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new D_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Te.RESOURCE_EXHAUSTED?(li(n.toString()),li("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===n&&this.G_(i,l)}),(i=>{e((()=>{const l=new Ze(Te.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,n){const i=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return lt(Bx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(lt(Bx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class tI extends P_{constructor(e,n,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,l,h),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=oA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return qt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?qt.min():h.readTime?Ca(h.readTime):qt.min()})(e);return this.listener.J_(n,i)}Z_(e){const n={};n.database=yg(this.serializer),n.addTarget=(function(u,h){let p;const g=h.target;if(p=dg(g)?{documents:uA(u,g)}:{query:hA(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=__(u,h.resumeToken);const y=mg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(qt.min())>0){p.readTime=Vd(u,h.snapshotVersion.toTimestamp());const y=mg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=fA(this.serializer,e);i&&(n.labels=i),this.K_(n)}X_(e){const n={};n.database=yg(this.serializer),n.removeTarget=e,this.K_(n)}}class nI extends P_{constructor(e,n,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return Sn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Sn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Sn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=cA(e.writeResults,e.commitTime),i=Ca(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=yg(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>lA(this.serializer,i)))};this.K_(n)}}class sI{}class rI extends sI{constructor(e,n,i,l){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new Ze(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,pg(n,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ze(Te.UNKNOWN,u.toString())}))}jo(e,n,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,pg(n,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new Ze(Te.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function aI(s,e,n,i){return new rI(s,e,n,i)}class iI{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(li(n),this.aa=!1):lt("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const qo="RemoteStore";class oI{constructor(e,n,i,l,u){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Ko(this)&&(lt(qo,"Restarting streams for network reachability change."),await(async function(g){const y=Gt(g);y.Ea.add(4),await Ru(y),y.Va.set("Unknown"),y.Ea.delete(4),await df(y)})(this))}))})),this.Va=new iI(i,l)}}async function df(s){if(Ko(s))for(const e of s.Ra)await e(!0)}async function Ru(s){for(const e of s.Ra)await e(!1)}function L_(s,e){const n=Gt(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),dy(n)?hy(n):ec(n).O_()&&uy(n,e))}function cy(s,e){const n=Gt(s),i=ec(n);n.Ia.delete(e),i.O_()&&O_(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ko(n)&&n.Va.set("Unknown"))}function uy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qt.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ec(s).Z_(e)}function O_(s,e){s.da.$e(e),ec(s).X_(e)}function hy(s){s.da=new eA({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ec(s).start(),s.Va.ua()}function dy(s){return Ko(s)&&!ec(s).x_()&&s.Ia.size>0}function Ko(s){return Gt(s).Ea.size===0}function V_(s){s.da=void 0}async function lI(s){s.Va.set("Online")}async function cI(s){s.Ia.forEach(((e,n)=>{uy(s,e)}))}async function uI(s,e){V_(s),dy(s)?(s.Va.ha(e),hy(s)):s.Va.set("Unknown")}async function hI(s,e,n){if(s.Va.set("Online"),e instanceof w_&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){lt(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ud(s,i)}else if(e instanceof wd?s.da.Xe(e):e instanceof x_?s.da.st(e):s.da.tt(e),!n.isEqual(qt.min()))try{const i=await M_(s.localStore);n.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(Hs.EMPTY_BYTE_STRING,x.snapshotVersion)),O_(u,g);const k=new Wi(x.target,g,y,x.sequenceNumber);uy(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(s,n)}catch(i){lt(qo,"Failed to raise snapshot:",i),await Ud(s,i)}}async function Ud(s,e,n){if(!Jl(e))throw e;s.Ea.add(1),await Ru(s),s.Va.set("Offline"),n||(n=()=>M_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{lt(qo,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await df(s)}))}function B_(s,e){return e().catch((n=>Ud(s,n,e)))}async function ff(s){const e=Gt(s),n=ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qg;for(;dI(e);)try{const l=await WA(e.localStore,i);if(l===null){e.Ta.length===0&&n.L_();break}i=l.batchId,fI(e,l)}catch(l){await Ud(e,l)}U_(e)&&z_(e)}function dI(s){return Ko(s)&&s.Ta.length<10}function fI(s,e){s.Ta.push(e);const n=ro(s);n.O_()&&n.Y_&&n.ea(e.mutations)}function U_(s){return Ko(s)&&!ro(s).x_()&&s.Ta.length>0}function z_(s){ro(s).start()}async function mI(s){ro(s).ra()}async function pI(s){const e=ro(s);for(const n of s.Ta)e.ea(n.mutations)}async function gI(s,e,n){const i=s.Ta.shift(),l=ny.from(i,e,n);await B_(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await ff(s)}async function yI(s,e){e&&ro(s).Y_&&await(async function(i,l){if((function(h){return XR(h)&&h!==Te.ABORTED})(l.code)){const u=i.Ta.shift();ro(i).B_(),await B_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await ff(i)}})(s,e),U_(s)&&z_(s)}async function Ux(s,e){const n=Gt(s);n.asyncQueue.verifyOperationInProgress(),lt(qo,"RemoteStore received new credentials");const i=Ko(n);n.Ea.add(3),await Ru(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await df(n)}async function vI(s,e){const n=Gt(s);e?(n.Ea.delete(2),await df(n)):e||(n.Ea.add(2),await Ru(n),n.Va.set("Unknown"))}function ec(s){return s.ma||(s.ma=(function(n,i,l){const u=Gt(n);return u.sa(),new tI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:lI.bind(null,s),Yo:cI.bind(null,s),t_:uI.bind(null,s),J_:hI.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),dy(s)?hy(s):s.Va.set("Unknown")):(await s.ma.stop(),V_(s))}))),s.ma}function ro(s){return s.fa||(s.fa=(function(n,i,l){const u=Gt(n);return u.sa(),new nI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:mI.bind(null,s),t_:yI.bind(null,s),ta:pI.bind(null,s),na:gI.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await ff(s)):(await s.fa.stop(),s.Ta.length>0&&(lt(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class fy{constructor(e,n,i,l,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new si,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,l,u){const h=Date.now()+i,p=new fy(e,n,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ze(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function my(s,e){if(li("AsyncQueue",`${e}: ${s}`),Jl(s))return new Ze(Te.UNAVAILABLE,`${e}: ${s}`);throw s}class Bl{static emptySet(e){return new Bl(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||jt.comparator(n.key,i.key):(n,i)=>jt.comparator(n.key,i.key),this.keyedMap=Yc(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Bl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Bl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class zx{constructor(){this.ga=new rs(jt.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ot(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class $l{constructor(e,n,i,l,u,h,p,g,y){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,n,i,l,u){const h=[];return n.forEach((p=>{h.push({type:0,doc:p})})),new $l(e,n,Bl.emptySet(n),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let l=0;l<n.length;l++)if(n[l].type!==i[l].type||!n[l].doc.isEqual(i[l].doc))return!1;return!0}}class bI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class xI{constructor(){this.queries=Fx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const l=Gt(n),u=l.queries;l.queries=Fx(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ze(Te.ABORTED,"Firestore shutting down"))}}function Fx(){return new Go((s=>a_(s)),rf)}async function py(s,e){const n=Gt(s);let i=3;const l=e.query;let u=n.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new bI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await n.onListen(l,!0);break;case 1:u.wa=await n.onListen(l,!1);break;case 2:await n.onFirstRemoteStoreListen(l)}}catch(h){const p=my(h,`Initialization of query '${Al(e.query)}' failed`);return void e.onError(p)}n.queries.set(l,u),u.ba.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&yy(n)}async function gy(s,e){const n=Gt(s),i=e.query;let l=3;const u=n.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function wI(s,e){const n=Gt(s);let i=!1;for(const l of e){const u=l.query,h=n.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&yy(n)}function _I(s,e,n){const i=Gt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(n);i.queries.delete(e)}function yy(s){s.Ca.forEach((e=>{e.next()}))}var xg,qx;(qx=xg||(xg={})).Ma="default",qx.Cache="cache";class vy{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new $l(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xg.Cache}}class F_{constructor(e){this.key=e}}class q_{constructor(e){this.key=e}}class kI{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=un(),this.mutatedKeys=un(),this.eu=i_(e),this.tu=new Bl(this.eu)}get nu(){return this.Za}ru(e,n){const i=n?n.iu:new zx,l=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,k)=>{const E=l.get(x),O=af(this.query,k)?k:null,G=!!E&&this.mutatedKeys.has(E.key),U=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let V=!1;E&&O?E.data.isEqual(O.data)?G!==U&&(i.track({type:3,doc:O}),V=!0):this.su(E,O)||(i.track({type:2,doc:O}),V=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!E&&O?(i.track({type:0,doc:O}),V=!0):E&&!O&&(i.track({type:1,doc:E}),V=!0,(g||y)&&(p=!0)),V&&(O?(h=h.add(O),u=U?u.add(x):u.delete(x)):(h=h.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const x=this.query.limitType==="F"?h.last():h.first();h=h.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((x,k)=>(function(O,G){const U=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Vt:V})}};return U(O)-U(G)})(x.type,k.type)||this.eu(x.doc,k.doc))),this.ou(i),l=l??!1;const p=n&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new $l(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=un(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const n=[];return e.forEach((i=>{this.Ya.has(i)||n.push(new q_(i))})),this.Ya.forEach((i=>{e.has(i)||n.push(new F_(i))})),n}cu(e){this.Za=e.ks,this.Ya=un();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $l.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const by="SyncEngine";class TI{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class jI{constructor(e){this.key=e,this.hu=!1}}class EI{constructor(e,n,i,l,u,h){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Go((p=>a_(p)),rf),this.Iu=new Map,this.Eu=new Set,this.Ru=new rs(jt.comparator),this.Au=new Map,this.Vu=new ay,this.du={},this.mu=new Map,this.fu=Hl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function SI(s,e,n=!0){const i=Y_(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await H_(i,e,n,!0),l}async function NI(s,e){const n=Y_(s);await H_(n,e,!0,!1)}async function H_(s,e,n,i){const l=await GA(s.localStore,Na(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,n);let p;return i&&(p=await CI(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&n&&L_(s.remoteStore,l),p}async function CI(s,e,n,i,l){s.pu=(k,E,O)=>(async function(U,V,te,X){let me=V.view.ru(te);me.Ss&&(me=await Px(U.localStore,V.query,!1).then((({documents:I})=>V.view.ru(I,me))));const Ee=X&&X.targetChanges.get(V.targetId),ze=X&&X.targetMismatches.get(V.targetId)!=null,Le=V.view.applyChanges(me,U.isPrimaryClient,Ee,ze);return $x(U,V.targetId,Le.au),Le.snapshot})(s,k,E,O);const u=await Px(s.localStore,e,!0),h=new kI(e,u.ks),p=h.ru(u.documents),g=Cu.createSynthesizedTargetChangeForCurrentChange(n,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);$x(s,n,y.au);const x=new TI(e,n,h);return s.Tu.set(e,x),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),y.snapshot}async function RI(s,e,n){const i=Gt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!rf(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await vg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),n&&cy(i.remoteStore,l.targetId),wg(i,l.targetId)})).catch(Xl)):(wg(i,l.targetId),await vg(i.localStore,l.targetId,!0))}async function AI(s,e){const n=Gt(s),i=n.Tu.get(e),l=n.Iu.get(i.targetId);n.isPrimaryClient&&l.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),cy(n.remoteStore,i.targetId))}async function II(s,e,n){const i=BI(s);try{const l=await(function(h,p){const g=Gt(h),y=xt.now(),x=p.reduce(((O,G)=>O.add(G.key)),un());let k,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let G=ci(),U=un();return g.xs.getEntries(O,x).next((V=>{G=V,G.forEach(((te,X)=>{X.isValidDocument()||(U=U.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,G))).next((V=>{k=V;const te=[];for(const X of p){const me=WR(X,k.get(X.key).overlayedDocument);me!=null&&te.push(new co(X.key,me,Xw(me.value.mapValue),lr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((V=>{E=V;const te=V.applyToLocalDocumentSet(k,U);return g.documentOverlayCache.saveOverlays(O,V.batchId,te)}))})).then((()=>({batchId:E.batchId,changes:l_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new rs(cn)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,n),await Au(i,l.changes),await ff(i.remoteStore)}catch(l){const u=my(l,"Failed to persist write");n.reject(u)}}async function $_(s,e){const n=Gt(s);try{const i=await HA(n.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=n.Au.get(u);h&&(Sn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?Sn(h.hu,14607):l.removedDocuments.size>0&&(Sn(h.hu,42227),h.hu=!1))})),await Au(n,i,e)}catch(i){await Xl(i)}}function Hx(s,e,n){const i=Gt(s);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Gt(h);g.onlineState=p;let y=!1;g.queries.forEach(((x,k)=>{for(const E of k.ba)E.va(p)&&(y=!0)})),y&&yy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function MI(s,e,n){const i=Gt(s);i.sharedClientState.updateQueryState(e,"rejected",n);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new rs(jt.comparator);h=h.insert(u,Xs.newNoDocument(u,qt.min()));const p=un().add(u),g=new uf(qt.min(),new Map,new rs(cn),h,p);await $_(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),xy(i)}else await vg(i.localStore,e,!1).then((()=>wg(i,e,n))).catch(Xl)}async function DI(s,e){const n=Gt(s),i=e.batch.batchId;try{const l=await qA(n.localStore,e);G_(n,i,null),W_(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Au(n,l)}catch(l){await Xl(l)}}async function PI(s,e,n){const i=Gt(s);try{const l=await(function(h,p){const g=Gt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(Sn(k!==null,37113),x=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);G_(i,e,n),W_(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Au(i,l)}catch(l){await Xl(l)}}function W_(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function G_(s,e,n){const i=Gt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(n?u.reject(n):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function wg(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),n&&s.Pu.yu(i,n);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||K_(s,i)}))}function K_(s,e){s.Eu.delete(e.path.canonicalString());const n=s.Ru.get(e);n!==null&&(cy(s.remoteStore,n),s.Ru=s.Ru.remove(e),s.Au.delete(n),xy(s))}function $x(s,e,n){for(const i of n)i instanceof F_?(s.Vu.addReference(i.key,e),LI(s,i)):i instanceof q_?(lt(by,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||K_(s,i.key)):Ot(19791,{wu:i})}function LI(s,e){const n=e.key,i=n.path.canonicalString();s.Ru.get(n)||s.Eu.has(i)||(lt(by,"New document in limbo: "+n),s.Eu.add(i),xy(s))}function xy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new jt(qn.fromString(e)),i=s.fu.next();s.Au.set(i,new jI(n)),s.Ru=s.Ru.insert(n,i),L_(s.remoteStore,new Wi(Na(sf(n.path)),i,"TargetPurposeLimboResolution",ef.ce))}}async function Au(s,e,n){const i=Gt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,n).then((y=>{if((y||n)&&i.isPrimaryClient){const x=y?!y.fromCache:n?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=oy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const x=Gt(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ae.forEach(y,(E=>Ae.forEach(E.Ts,(O=>x.persistence.referenceDelegate.addReference(k,E.targetId,O))).next((()=>Ae.forEach(E.Is,(O=>x.persistence.referenceDelegate.removeReference(k,E.targetId,O)))))))))}catch(k){if(!Jl(k))throw k;lt(ly,"Failed to update sequence numbers: "+k)}for(const k of y){const E=k.targetId;if(!k.fromCache){const O=x.vs.get(E),G=O.snapshotVersion,U=O.withLastLimboFreeSnapshotVersion(G);x.vs=x.vs.insert(E,U)}}})(i.localStore,u))}async function OI(s,e){const n=Gt(s);if(!n.currentUser.isEqual(e)){lt(by,"User change. New user:",e.toKey());const i=await I_(n.localStore,e);n.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ze(Te.CANCELLED,h))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Au(n,i.Ns)}}function VI(s,e){const n=Gt(s),i=n.Au.get(e);if(i&&i.hu)return un().add(i.key);{let l=un();const u=n.Iu.get(e);if(!u)return l;for(const h of u){const p=n.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function Y_(s){const e=Gt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=$_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MI.bind(null,e),e.Pu.J_=wI.bind(null,e.eventManager),e.Pu.yu=_I.bind(null,e.eventManager),e}function BI(s){const e=Gt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PI.bind(null,e),e}class zd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return FA(this.persistence,new BA,e.initialUser,this.serializer)}Cu(e){return new A_(iy.Vi,this.serializer)}Du(e){return new YA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zd.provider={build:()=>new zd};class UI extends zd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Sn(this.persistence.referenceDelegate instanceof Bd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new TA(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new A_((i=>Bd.Vi(i,n)),this.serializer)}}class _g{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Hx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=OI.bind(null,this.syncEngine),await vI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new xI})()}createDatastore(e){const n=hf(e.databaseInfo.databaseId),i=eI(e.databaseInfo);return aI(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,l,u,h,p){return new oI(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>Hx(this.syncEngine,n,0)),(function(){return Vx.v()?new Vx:new QA})())}createSyncEngine(e,n){return(function(l,u,h,p,g,y,x){const k=new EI(l,u,h,p,g,y);return x&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Gt(n);lt(qo,"RemoteStore shutting down."),i.Ea.add(5),await Ru(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_g.provider={build:()=>new _g};class wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):li("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const ao="FirestoreClient";class zI{constructor(e,n,i,l,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=l,this.user=Qs.UNAUTHENTICATED,this.clientId=Yg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{lt(ao,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(lt(ao,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new si;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=my(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Ip(s,e){s.asyncQueue.verifyOperationInProgress(),lt(ao,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let i=n.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await I_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Wx(s,e){s.asyncQueue.verifyOperationInProgress();const n=await FI(s);lt(ao,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((i=>Ux(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>Ux(e.remoteStore,l))),s._onlineComponents=e}async function FI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){lt(ao,"Using user provided OfflineComponentProvider");try{await Ip(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Te.FAILED_PRECONDITION||l.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(n))throw n;Ul("Error using user provided cache. Falling back to memory cache: "+n),await Ip(s,new zd)}}else lt(ao,"Using default OfflineComponentProvider"),await Ip(s,new UI(void 0));return s._offlineComponents}async function Q_(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(lt(ao,"Using user provided OnlineComponentProvider"),await Wx(s,s._uninitializedComponentsProvider._online)):(lt(ao,"Using default OnlineComponentProvider"),await Wx(s,new _g))),s._onlineComponents}function qI(s){return Q_(s).then((e=>e.syncEngine))}async function Fd(s){const e=await Q_(s),n=e.eventManager;return n.onListen=SI.bind(null,e.syncEngine),n.onUnlisten=RI.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=NI.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=AI.bind(null,e.syncEngine),n}function HI(s,e,n,i){const l=new wy(i),u=new vy(e,l,n);return s.asyncQueue.enqueueAndForget((async()=>py(await Fd(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>gy(await Fd(s),u)))}}function $I(s,e,n={}){const i=new si;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const x=new wy({next:E=>{x.Nu(),h.enqueueAndForget((()=>gy(u,k)));const O=E.docs.has(p);!O&&E.fromCache?y.reject(new Ze(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&E.fromCache&&g&&g.source==="server"?y.reject(new Ze(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new vy(sf(p.path),x,{includeMetadataChanges:!0,Ka:!0});return py(u,k)})(await Fd(s),s.asyncQueue,e,n,i))),i.promise}function WI(s,e,n={}){const i=new si;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const x=new wy({next:E=>{x.Nu(),h.enqueueAndForget((()=>gy(u,k))),E.fromCache&&g.source==="server"?y.reject(new Ze(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new vy(p,x,{includeMetadataChanges:!0,Ka:!0});return py(u,k)})(await Fd(s),s.asyncQueue,e,n,i))),i.promise}function GI(s,e){const n=new si;return s.asyncQueue.enqueueAndForget((async()=>II(await qI(s),e,n))),n.promise}function X_(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const KI="ComponentProvider",Gx=new Map;function YI(s,e,n,i,l){return new pR(s,e,n,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,X_(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const J_="firestore.googleapis.com",Kx=!0;class Yx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ze(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J_,this.ssl=Kx}else this.host=e.host,this.ssl=e.ssl??Kx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=R_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<_A)throw new Ze(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X_(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ze(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ze(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ze(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mf{constructor(e,n,i,l){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ze(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ze(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new G4;switch(i.type){case"firstParty":return new X4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ze(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Gx.get(n);i&&(lt(KI,"Removing Datastore"),Gx.delete(n),i.terminate())})(this),Promise.resolve()}}function QI(s,e,n,i={}){s=or(s,mf);const l=io(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${n}`;l&&(Mg(`https://${p}`),Dg("Firestore",!0)),u.host!==J_&&u.host!==p&&Ul("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Vo(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=Qs.MOCK_USER;else{y=W2(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new Ze(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Qs(k)}s._authCredentials=new K4(new Bw(y,x))}}class di{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new di(this.firestore,e,this._query)}}class os{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new os(this.firestore,e,this._key)}toJSON(){return{type:os._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(Su(n,os._jsonSchema))return new os(e,i||null,new jt(qn.fromString(n.referencePath)))}}os._jsonSchemaVersion="firestore/documentReference/1.0",os._jsonSchema={type:Ss("string",os._jsonSchemaVersion),referencePath:Ss("string")};class Ji extends di{constructor(e,n,i){super(e,n,sf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new os(this.firestore,null,new jt(e))}withConverter(e){return new Ji(this.firestore,e,this._path)}}function Jt(s,e,...n){if(s=zn(s),Uw("collection","path",e),s instanceof mf){const i=qn.fromString(e,...n);return lx(i),new Ji(s,null,i)}{if(!(s instanceof os||s instanceof Ji))throw new Ze(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(qn.fromString(e,...n));return lx(i),new Ji(s.firestore,null,i)}}function Ke(s,e,...n){if(s=zn(s),arguments.length===1&&(e=Yg.newId()),Uw("doc","path",e),s instanceof mf){const i=qn.fromString(e,...n);return ox(i),new os(s,null,new jt(i))}{if(!(s instanceof os||s instanceof Ji))throw new Ze(Te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(qn.fromString(e,...n));return ox(i),new os(s.firestore,s instanceof Ji?s.converter:null,new jt(i))}}const Qx="AsyncQueue";class Xx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new D_(this,"async_queue_retry"),this._c=()=>{const i=Ap();i&&lt(Qx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Ap();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ap();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new si;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Jl(e))throw e;lt(Qx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,li("INTERNAL UNHANDLED ERROR: ",Jx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const l=fy.createAndSchedule(this,e,n,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Ot(47125,{Pc:Jx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Jx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ia extends mf{constructor(e,n,i,l){super(e,n,i,l),this.type="firestore",this._queue=new Xx,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xx(e),this._firestoreClient=void 0,await e}}}function XI(s,e){const n=typeof s=="object"?s:Vg(),i=typeof s=="string"?s:Dd,l=Yd(n,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=q2("firestore");u&&QI(l,...u)}return l}function Iu(s){if(s._terminated)throw new Ze(Te.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||JI(s),s._firestoreClient}function JI(s){const e=s._freezeSettings(),n=YI(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new zI(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Gr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gr(Hs.fromBase64String(e))}catch(n){throw new Ze(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gr(Hs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Su(e,Gr._jsonSchema))return Gr.fromBase64String(e.bytes)}}Gr._jsonSchemaVersion="firestore/bytes/1.0",Gr._jsonSchema={type:Ss("string",Gr._jsonSchemaVersion),bytes:Ss("string")};class pf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ze(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mu{constructor(e){this._methodName=e}}class Ra{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ze(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ze(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return cn(this._lat,e._lat)||cn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ra._jsonSchemaVersion}}static fromJSON(e){if(Su(e,Ra._jsonSchema))return new Ra(e.latitude,e.longitude)}}Ra._jsonSchemaVersion="firestore/geoPoint/1.0",Ra._jsonSchema={type:Ss("string",Ra._jsonSchemaVersion),latitude:Ss("number"),longitude:Ss("number")};class ua{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ua._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Su(e,ua._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ua(e.vectorValues);throw new Ze(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ua._jsonSchemaVersion="firestore/vectorValue/1.0",ua._jsonSchema={type:Ss("string",ua._jsonSchemaVersion),vectorValues:Ss("object")};const ZI=/^__.*__$/;class eM{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,n,this.fieldTransforms):new Nu(e,this.data,n,this.fieldTransforms)}}class Z_{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new co(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ek(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot(40011,{dataSource:s})}}class _y{constructor(e,n,i,l,u,h){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new _y({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ek(this.dataSource)&&ZI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class tM{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||hf(e)}createContext(e,n,i,l=!1){return new _y({dataSource:e,methodName:n,targetDoc:i,path:qs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Du(s){const e=s._freezeSettings(),n=hf(s._databaseId);return new tM(s._databaseId,!!e.ignoreUndefinedProperties,n)}function ky(s,e,n,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,n,l);Ey("Data must be an object, but it was:",h,i);const p=sk(i,h);let g,y;if(u.merge)g=new Dr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const x=[];for(const k of u.mergeFields){const E=Ho(e,k,n);if(!h.contains(E))throw new Ze(Te.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);ik(x,E)||x.push(E)}g=new Dr(x),y=h.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=h.fieldTransforms;return new eM(new br(p),g,y)}class gf extends Mu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gf}}class Ty extends Mu{_toFieldTransform(e){return new g_(e.path,new pu)}isEqual(e){return e instanceof Ty}}class jy extends Mu{constructor(e,n){super(e),this.Vc=n}_toFieldTransform(e){const n=new vu(e.serializer,h_(e.serializer,this.Vc));return new g_(e.path,n)}isEqual(e){return e instanceof jy&&this.Vc===e.Vc}}function tk(s,e,n,i){const l=s.createContext(1,e,n);Ey("Data must be an object, but it was:",l,i);const u=[],h=br.empty();lo(i,((g,y)=>{const x=ak(e,g,n);y=zn(y);const k=l.childContextForFieldPath(x);if(y instanceof gf)u.push(x);else{const E=Pu(y,k);E!=null&&(u.push(x),h.set(x,E))}}));const p=new Dr(u);return new Z_(h,p,l.fieldTransforms)}function nk(s,e,n,i,l,u){const h=s.createContext(1,e,n),p=[Ho(e,i,n)],g=[l];if(u.length%2!=0)throw new Ze(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<u.length;E+=2)p.push(Ho(e,u[E])),g.push(u[E+1]);const y=[],x=br.empty();for(let E=p.length-1;E>=0;--E)if(!ik(y,p[E])){const O=p[E];let G=g[E];G=zn(G);const U=h.childContextForFieldPath(O);if(G instanceof gf)y.push(O);else{const V=Pu(G,U);V!=null&&(y.push(O),x.set(O,V))}}const k=new Dr(y);return new Z_(x,k,h.fieldTransforms)}function nM(s,e,n,i=!1){return Pu(n,s.createContext(i?4:3,e))}function Pu(s,e){if(rk(s=zn(s)))return Ey("Unsupported field value:",e,s),sk(s,e);if(s instanceof Mu)return(function(i,l){if(!ek(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Pu(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=zn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return h_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=xt.fromDate(i);return{timestampValue:Vd(l.serializer,u)}}if(i instanceof xt){const u=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vd(l.serializer,u)}}if(i instanceof Ra)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gr)return{bytesValue:__(l.serializer,i._byteString)};if(i instanceof os){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:ry(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ua)return(function(h,p){const g=h instanceof ua?h.toArray():h;return{mapValue:{fields:{[Yw]:{stringValue:Qw},[Pd]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return ty(p.serializer,x)}))}}}}}})(i,l);if(C_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${Zd(i)}`)})(s,e)}function sk(s,e){const n={};return qw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(s,((i,l)=>{const u=Pu(l,e.childContextForField(i));u!=null&&(n[i]=u)})),{mapValue:{fields:n}}}function rk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof xt||s instanceof Ra||s instanceof Gr||s instanceof os||s instanceof Mu||s instanceof ua||C_(s))}function Ey(s,e,n){if(!rk(n)||!zw(n)){const i=Zd(n);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Ho(s,e,n){if((e=zn(e))instanceof pf)return e._internalPath;if(typeof e=="string")return ak(s,e);throw qd("Field path arguments must be of type string or ",s,!1,void 0,n)}const sM=new RegExp("[~\\*/\\[\\]]");function ak(s,e,n){if(e.search(sM)>=0)throw qd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new pf(...e.split("."))._internalPath}catch{throw qd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function qd(s,e,n,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new Ze(Te.INVALID_ARGUMENT,p+s+g)}function ik(s,e){return s.some((n=>n.isEqual(e)))}class rM{convertValue(e,n="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ys(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ot(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return lo(e,((l,u)=>{i[l]=this.convertValue(u,n)})),i}convertVectorValue(e){const n=e.fields?.[Pd].arrayValue?.values?.map((i=>ys(i.doubleValue)));return new ua(n)}convertGeoPoint(e){return new Ra(ys(e.latitude),ys(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=nf(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(hu(e));default:return null}}convertTimestamp(e){const n=to(e);return new xt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=qn.fromString(e);Sn(N_(i),9688,{name:e});const l=new du(i.get(1),i.get(3)),u=new jt(i.popFirst(5));return l.isEqual(n)||li(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}class Sy extends rM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new os(this.firestore,null,n)}}function Kr(){return new Ty("serverTimestamp")}function Mo(s){return new jy("increment",s)}const Zx="@firebase/firestore",e2="4.10.0";function t2(s){return(function(n,i){if(typeof n!="object"||n===null)return!1;const l=n;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class ok{constructor(e,n,i,l,u){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new os(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(Ho("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class aM extends ok{data(){return super.data()}}function lk(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ze(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ny{}class Cy extends Ny{}function Mn(s,e,...n){let i=[];e instanceof Ny&&i.push(e),i=i.concat(n),(function(u){const h=u.filter((g=>g instanceof Ry)).length,p=u.filter((g=>g instanceof yf)).length;if(h>1||h>0&&p>0)throw new Ze(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class yf extends Cy{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new yf(e,n,i)}_apply(e){const n=this._parse(e);return ck(e._query,n),new di(e.firestore,e.converter,fg(e._query,n))}_parse(e){const n=Du(e.firestore);return(function(u,h,p,g,y,x,k){let E;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Ze(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){s2(k,x);const G=[];for(const U of k)G.push(n2(g,u,U));E={arrayValue:{values:G}}}else E=n2(g,u,k)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||s2(k,x),E=nM(p,h,k,x==="in"||x==="not-in");return Es.create(y,x,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function xn(s,e,n){const i=e,l=Ho("where",s);return yf._create(l,i,n)}class Ry extends Ny{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ry(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:da.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)ck(h,g),h=fg(h,g)})(e._query,n),new di(e.firestore,e.converter,fg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ay extends Cy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ay(e,n)}_apply(e){const n=(function(l,u,h){if(l.startAt!==null)throw new Ze(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new Ze(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new mu(u,h)})(e._query,this._field,this._direction);return new di(e.firestore,e.converter,MR(e._query,n))}}function Hd(s,e="asc"){const n=e,i=Ho("orderBy",s);return Ay._create(i,n)}class Iy extends Cy{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new Iy(e,n,i)}_apply(e){return new di(e.firestore,e.converter,Od(e._query,this._limit,this._limitType))}}function $d(s){return rR("limit",s),Iy._create("limit",s,"F")}function n2(s,e,n){if(typeof(n=zn(n))=="string"){if(n==="")throw new Ze(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r_(e)&&n.indexOf("/")!==-1)throw new Ze(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(qn.fromString(n));if(!jt.isDocumentKey(i))throw new Ze(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return gx(s,new jt(i))}if(n instanceof os)return gx(s,n._key);throw new Ze(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zd(n)}.`)}function s2(s,e){if(!Array.isArray(s)||s.length===0)throw new Ze(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ck(s,e){const n=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ze(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ze(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function My(s,e,n){let i;return i=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,i}class Xc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends ok{constructor(e,n,i,l,u,h){super(e,n,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new _d(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(Ho("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ze(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Do._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:Ss("string",Do._jsonSchemaVersion),bundleSource:Ss("string","DocumentSnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class _d extends Do{data(e={}){return super.data(e)}}class Po{constructor(e,n,i,l){this._firestore=e,this._userDataWriter=n,this._snapshot=l,this.metadata=new Xc(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new _d(this._firestore,this._userDataWriter,i.key,i,new Xc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ze(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new _d(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new _d(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Xc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),x=h.indexOf(p.doc.key)),{type:iM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ze(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Po._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function iM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:s})}}Po._jsonSchemaVersion="firestore/querySnapshot/1.0",Po._jsonSchema={type:Ss("string",Po._jsonSchemaVersion),bundleSource:Ss("string","QuerySnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class oM{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Du(e)}set(e,n,i){this._verifyNotCommitted();const l=Mp(e,this._firestore),u=My(l.converter,n,i),h=ky(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,lr.none())),this}update(e,n,i,...l){this._verifyNotCommitted();const u=Mp(e,this._firestore);let h;return h=typeof(n=zn(n))=="string"||n instanceof pf?nk(this._dataReader,"WriteBatch.update",u._key,n,i,l):tk(this._dataReader,"WriteBatch.update",u._key,n),this._mutations.push(h.toMutation(u._key,lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Mp(e,this._firestore);return this._mutations=this._mutations.concat(new cf(n._key,lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ze(Te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Mp(s,e){if((s=zn(s)).firestore!==e)throw new Ze(Te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Qn(s){s=or(s,os);const e=or(s.firestore,Ia),n=Iu(e);return $I(n,s._key).then((i=>uk(e,s,i)))}function Tn(s){s=or(s,di);const e=or(s.firestore,Ia),n=Iu(e),i=new Sy(e);return lk(s._query),WI(n,s._query).then((l=>new Po(e,i,s,l)))}function Vn(s,e,n){s=or(s,os);const i=or(s.firestore,Ia),l=My(s.converter,e,n),u=Du(i);return Lu(i,[ky(u,"setDoc",s._key,l,s.converter!==null,n).toMutation(s._key,lr.none())])}function Hi(s,e,n,...i){s=or(s,os);const l=or(s.firestore,Ia),u=Du(l);let h;return h=typeof(e=zn(e))=="string"||e instanceof pf?nk(u,"updateDoc",s._key,e,n,i):tk(u,"updateDoc",s._key,e),Lu(l,[h.toMutation(s._key,lr.exists(!0))])}function ar(s){return Lu(or(s.firestore,Ia),[new cf(s._key,lr.none())])}function ri(s,e){const n=or(s.firestore,Ia),i=Ke(s),l=My(s.converter,e),u=Du(s.firestore);return Lu(n,[ky(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,lr.exists(!1))]).then((()=>i))}function lM(s,...e){s=zn(s);let n={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||t2(e[i])||(n=e[i++]);const l={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(t2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof os)h=or(s.firestore,Ia),p=sf(s._key.path),u={next:y=>{e[i]&&e[i](uk(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=or(s,di);h=or(y.firestore,Ia),p=y._query;const x=new Sy(h);u={next:k=>{e[i]&&e[i](new Po(h,x,y,k))},error:e[i+1],complete:e[i+2]},lk(s._query)}const g=Iu(h);return HI(g,p,l,u)}function Lu(s,e){const n=Iu(s);return GI(n,e)}function uk(s,e,n){const i=n.docs.get(e._key),l=new Sy(s);return new Do(s,l,e._key,i,new Xc(n.hasPendingWrites,n.fromCache),e.converter)}function r2(s){return s=or(s,Ia),Iu(s),new oM(s,(e=>Lu(s,e)))}(function(e,n=!0){W4(Wo),Bo(new Zi("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new Ia(new Y4(i.getProvider("auth-internal")),new J4(h,i.getProvider("app-check-internal")),gR(h,l),h);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),ja(Zx,e2,e),ja(Zx,e2,"esm2020")})();var cM="firebase",uM="12.8.0";ja(cM,uM,"app");const hk="firebasestorage.googleapis.com",dk="storageBucket",hM=120*1e3,dM=600*1e3;class cs extends Da{constructor(e,n,i=0){super(Dp(e),`Firebase Storage: ${n} (${Dp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ls;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ls||(ls={}));function Dp(s){return"storage/"+s}function Dy(){const s="An unknown error occurred, please check the error payload for server response.";return new cs(ls.UNKNOWN,s)}function fM(s){return new cs(ls.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function mM(s){return new cs(ls.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new cs(ls.UNAUTHENTICATED,s)}function gM(){return new cs(ls.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yM(s){return new cs(ls.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function vM(){return new cs(ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bM(){return new cs(ls.CANCELED,"User canceled the upload/download.")}function xM(s){return new cs(ls.INVALID_URL,"Invalid URL '"+s+"'.")}function wM(s){return new cs(ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function _M(){return new cs(ls.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dk+"' property when initializing the app?")}function kM(){return new cs(ls.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function TM(){return new cs(ls.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function jM(s){return new cs(ls.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function kg(s){return new cs(ls.INVALID_ARGUMENT,s)}function fk(){return new cs(ls.APP_DELETED,"The Firebase app was deleted.")}function EM(s){return new cs(ls.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ru(s,e){return new cs(ls.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Fc(s){throw new cs(ls.INTERNAL_ERROR,"Internal error: "+s)}class ir{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=ir.makeFromUrl(e,n)}catch{return new ir(e,"")}if(i.path==="")return i;throw wM(e)}static makeFromUrl(e,n){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(Ee){Ee.path.charAt(Ee.path.length-1)==="/"&&(Ee.path_=Ee.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(Ee){Ee.path_=decodeURIComponent(Ee.path)}const x="v[A-Za-z0-9_]+",k=n.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${x}/b/${l}/o${E}`,"i"),G={bucket:1,path:3},U=n===hk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,V="([^?#]*)",te=new RegExp(`^https?://${U}/${l}/${V}`,"i"),me=[{regex:p,indices:g,postModify:u},{regex:O,indices:G,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let Ee=0;Ee<me.length;Ee++){const ze=me[Ee],Le=ze.regex.exec(e);if(Le){const I=Le[ze.indices.bucket];let j=Le[ze.indices.path];j||(j=""),i=new ir(I,j),ze.postModify(i);break}}if(i==null)throw xM(e);return i}}class SM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function NM(s,e,n){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function x(...V){y||(y=!0,e.apply(null,V))}function k(V){l=setTimeout(()=>{l=null,s(O,g())},V)}function E(){u&&clearTimeout(u)}function O(V,...te){if(y){E();return}if(V){E(),x.call(null,V,...te);return}if(g()||h){E(),x.call(null,V,...te);return}i<64&&(i*=2);let me;p===1?(p=2,me=0):me=(i+Math.random())*1e3,k(me)}let G=!1;function U(V){G||(G=!0,E(),!y&&(l!==null?(V||(p=2),clearTimeout(l),k(0)):V||(p=1)))}return k(0),u=setTimeout(()=>{h=!0,U(!0)},n),U}function CM(s){s(!1)}function RM(s){return s!==void 0}function AM(s){return typeof s=="object"&&!Array.isArray(s)}function Py(s){return typeof s=="string"||s instanceof String}function a2(s){return Ly()&&s instanceof Blob}function Ly(){return typeof Blob<"u"}function Tg(s,e,n,i){if(i<e)throw kg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>n)throw kg(`Invalid value for '${s}'. Expected ${n} or less.`)}function vf(s,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${s}`}function mk(s){const e=encodeURIComponent;let n="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);n=n+l+"&"}return n=n.slice(0,-1),n}var Lo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Lo||(Lo={}));function IM(s,e){const n=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return n||l||u}class MM{constructor(e,n,i,l,u,h,p,g,y,x,k,E=!0,O=!1){this.url_=e,this.method_=n,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=k,this.retry=E,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((G,U)=>{this.resolve_=G,this.reject_=U,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new sd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Lo.NO_ERROR,g=u.getStatus();if(!p||IM(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Lo.ABORT;i(!1,new sd(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new sd(y,u))})},n=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());RM(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=Dy();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?fk():bM();h(g)}else{const g=vM();h(g)}};this.canceled_?n(!1,new sd(!1,null,!0)):this.backoffId_=NM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&CM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class sd{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}}function DM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function PM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function LM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function OM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function VM(s,e,n,i,l,u,h=!0,p=!1){const g=mk(s.urlParams),y=s.url+g,x=Object.assign({},s.headers);return LM(x,e),DM(x,n),PM(x,u),OM(x,i),new MM(y,s.method,x,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function BM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function UM(...s){const e=BM();if(e!==void 0){const n=new e;for(let i=0;i<s.length;i++)n.append(s[i]);return n.getBlob()}else{if(Ly())return new Blob(s);throw new cs(ls.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function zM(s,e,n){return s.webkitSlice?s.webkitSlice(e,n):s.mozSlice?s.mozSlice(e,n):s.slice?s.slice(e,n):null}function FM(s){if(typeof atob>"u")throw jM("base-64");return atob(s)}const Ta={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pp{constructor(e,n){this.data=e,this.contentType=n||null}}function qM(s,e){switch(s){case Ta.RAW:return new Pp(pk(e));case Ta.BASE64:case Ta.BASE64URL:return new Pp(gk(s,e));case Ta.DATA_URL:return new Pp($M(e),WM(e))}throw Dy()}function pk(s){const e=[];for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<s.length-1&&(s.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++n);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function HM(s){let e;try{e=decodeURIComponent(s)}catch{throw ru(Ta.DATA_URL,"Malformed data URL.")}return pk(e)}function gk(s,e){switch(s){case Ta.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw ru(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ta.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw ru(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=FM(e)}catch(l){throw l.message.includes("polyfill")?l:ru(s,"Invalid character found")}const i=new Uint8Array(n.length);for(let l=0;l<n.length;l++)i[l]=n.charCodeAt(l);return i}class yk{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ru(Ta.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=GM(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function $M(s){const e=new yk(s);return e.base64?gk(Ta.BASE64,e.rest):HM(e.rest)}function WM(s){return new yk(s).contentType}function GM(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class $i{constructor(e,n){let i=0,l="";a2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,n){if(a2(this.data_)){const i=this.data_,l=zM(i,e,n);return l===null?null:new $i(l)}else{const i=new Uint8Array(this.data_.buffer,e,n-e);return new $i(i,!0)}}static getBlob(...e){if(Ly()){const n=e.map(i=>i instanceof $i?i.data_:i);return new $i(UM.apply(null,n))}else{const n=e.map(h=>Py(h)?qM(Ta.RAW,h).data:h.data_);let i=0;n.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return n.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new $i(l,!0)}}uploadData(){return this.data_}}function Oy(s){let e;try{e=JSON.parse(s)}catch{return null}return AM(e)?e:null}function KM(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function YM(s,e){const n=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?n:s+"/"+n}function vk(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function QM(s,e){return e}class rr{constructor(e,n,i,l){this.server=e,this.local=n||e,this.writable=!!i,this.xform=l||QM}}let rd=null;function XM(s){return!Py(s)||s.length<2?s:vk(s)}function bk(){if(rd)return rd;const s=[];s.push(new rr("bucket")),s.push(new rr("generation")),s.push(new rr("metageneration")),s.push(new rr("name","fullPath",!0));function e(u,h){return XM(h)}const n=new rr("name");n.xform=e,s.push(n);function i(u,h){return h!==void 0?Number(h):h}const l=new rr("size");return l.xform=i,s.push(l),s.push(new rr("timeCreated")),s.push(new rr("updated")),s.push(new rr("md5Hash",null,!0)),s.push(new rr("cacheControl",null,!0)),s.push(new rr("contentDisposition",null,!0)),s.push(new rr("contentEncoding",null,!0)),s.push(new rr("contentLanguage",null,!0)),s.push(new rr("contentType",null,!0)),s.push(new rr("metadata","customMetadata",!0)),rd=s,rd}function JM(s,e){function n(){const i=s.bucket,l=s.fullPath,u=new ir(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:n})}function ZM(s,e,n){const i={};i.type="file";const l=n.length;for(let u=0;u<l;u++){const h=n[u];i[h.local]=h.xform(i,e[h.server])}return JM(i,s),i}function xk(s,e,n){const i=Oy(e);return i===null?null:ZM(s,i,n)}function e3(s,e,n,i){const l=Oy(e);if(l===null||!Py(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const x=s.bucket,k=s.fullPath,E="/b/"+h(x)+"/o/"+h(k),O=vf(E,n,i),G=mk({alt:"media",token:y});return O+G})[0]}function t3(s,e){const n={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(n[u.server]=s[u.local])}return JSON.stringify(n)}const i2="prefixes",o2="items";function n3(s,e,n){const i={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[i2])for(const l of n[i2]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new ir(e,u));i.prefixes.push(h)}if(n[o2])for(const l of n[o2]){const u=s._makeStorageReference(new ir(e,l.name));i.items.push(u)}return i}function s3(s,e,n){const i=Oy(n);return i===null?null:n3(s,e,i)}class Vy{constructor(e,n,i,l){this.url=e,this.method=n,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function By(s){if(!s)throw Dy()}function r3(s,e){function n(i,l){const u=xk(s,l,e);return By(u!==null),u}return n}function a3(s,e){function n(i,l){const u=s3(s,e,l);return By(u!==null),u}return n}function i3(s,e){function n(i,l){const u=xk(s,l,e);return By(u!==null),e3(u,l,s.host,s._protocol)}return n}function Uy(s){function e(n,i){let l;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?l=gM():l=pM():n.getStatus()===402?l=mM(s.bucket):n.getStatus()===403?l=yM(s.path):l=i,l.status=n.getStatus(),l.serverResponse=i.serverResponse,l}return e}function o3(s){const e=Uy(s);function n(i,l){let u=e(i,l);return i.getStatus()===404&&(u=fM(s.path)),u.serverResponse=l.serverResponse,u}return n}function l3(s,e,n,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",n.length>0&&(u.delimiter=n),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=vf(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,x=new Vy(p,g,a3(s,e.bucket),y);return x.urlParams=u,x.errorHandler=Uy(e),x}function c3(s,e,n){const i=e.fullServerUrl(),l=vf(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new Vy(l,u,i3(s,n),h);return p.errorHandler=o3(e),p}function u3(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function h3(s,e,n){const i=Object.assign({},n);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=u3(null,e)),i}function d3(s,e,n,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let me="";for(let Ee=0;Ee<2;Ee++)me=me+Math.random().toString().slice(2);return me}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=h3(e,i,l),x=t3(y,n),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,E=`\r
--`+g+"--",O=$i.getBlob(k,i,E);if(O===null)throw kM();const G={name:y.fullPath},U=vf(u,s.host,s._protocol),V="POST",te=s.maxUploadRetryTime,X=new Vy(U,V,r3(s,n),te);return X.urlParams=G,X.headers=h,X.body=O.uploadData(),X.errorHandler=Uy(e),X}class f3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,l,u){if(this.sent_)throw Fc("cannot .send() more than once");if(io(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class m3 extends f3{initXhr(){this.xhr_.responseType="text"}}function zy(){return new m3}class $o{constructor(e,n){this._service=e,n instanceof ir?this._location=n:this._location=ir.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new $o(e,n)}get root(){const e=new ir(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vk(this._location.path)}get storage(){return this._service}get parent(){const e=KM(this._location.path);if(e===null)return null;const n=new ir(this._location.bucket,e);return new $o(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw EM(e)}}function p3(s,e,n){s._throwIfRoot("uploadBytes");const i=d3(s.storage,s._location,bk(),new $i(e,!0),n);return s.storage.makeRequestWithTokens(i,zy).then(l=>({metadata:l,ref:s}))}function g3(s){const e={prefixes:[],items:[]};return wk(s,e).then(()=>e)}async function wk(s,e,n){const l=await y3(s,{pageToken:n});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await wk(s,e,l.nextPageToken)}function y3(s,e){e!=null&&typeof e.maxResults=="number"&&Tg("options.maxResults",1,1e3,e.maxResults);const n=e||{},i=l3(s.storage,s._location,"/",n.pageToken,n.maxResults);return s.storage.makeRequestWithTokens(i,zy)}function v3(s){s._throwIfRoot("getDownloadURL");const e=c3(s.storage,s._location,bk());return s.storage.makeRequestWithTokens(e,zy).then(n=>{if(n===null)throw TM();return n})}function b3(s,e){const n=YM(s._location.path,e),i=new ir(s._location.bucket,n);return new $o(s.storage,i)}function x3(s){return/^[A-Za-z]+:\/\//.test(s)}function w3(s,e){return new $o(s,e)}function _k(s,e){if(s instanceof Fy){const n=s;if(n._bucket==null)throw _M();const i=new $o(n,n._bucket);return e!=null?_k(i,e):i}else return e!==void 0?b3(s,e):s}function _3(s,e){if(e&&x3(e)){if(s instanceof Fy)return w3(s,e);throw kg("To use ref(service, url), the first argument must be a Storage instance.")}else return _k(s,e)}function l2(s,e){const n=e?.[dk];return n==null?null:ir.makeFromBucketSpec(n,s)}function k3(s,e,n,i={}){s.host=`${e}:${n}`;const l=io(e);l&&(Mg(`https://${s.host}/b`),Dg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:W2(u,s.app.options.projectId))}class Fy{constructor(e,n,i,l,u,h=!1){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=hk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hM,this._maxUploadRetryTime=dM,this._requests=new Set,l!=null?this._bucket=ir.makeFromBucketSpec(l,this._host):this._bucket=l2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ir.makeFromBucketSpec(this._url,e):this._bucket=l2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Tg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Tg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $o(this,e)}_makeRequest(e,n,i,l,u=!0){if(this._deleted)return new SM(fk());{const h=VM(e,this._appId,i,l,n,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,n){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,l).getPromise()}}const c2="@firebase/storage",u2="0.14.0";const kk="storage";function Lp(s,e,n){return s=zn(s),p3(s,e,n)}function h2(s){return s=zn(s),g3(s)}function Oo(s){return s=zn(s),v3(s)}function Gi(s,e){return s=zn(s),_3(s,e)}function T3(s=Vg(),e){s=zn(s);const i=Yd(s,kk).getImmediate({identifier:e}),l=q2("storage");return l&&j3(i,...l),i}function j3(s,e,n,i={}){k3(s,e,n,i)}function E3(s,{instanceIdentifier:e}){const n=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new Fy(n,i,l,e,Wo)}function S3(){Bo(new Zi(kk,E3,"PUBLIC").setMultipleInstances(!0)),ja(c2,u2,""),ja(c2,u2,"esm2020")}S3();const Tk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},qy=Og(Tk),qc=Aw(qy),_e=XI(qy),Ki=T3(qy),N3=Og(Tk,"secondary"),zD=Aw(N3),C3="EYdciKDOi3UYBLk1u8hHams5tmO2",jk=w.createContext();function Xr(){return w.useContext(jk)}function R3({children:s}){const[e,n]=w.useState(null),[i,l]=w.useState(!1),[u,h]=w.useState(!1),[p,g]=w.useState(null),[y,x]=w.useState(!0);w.useEffect(()=>DC(qc,async te=>{if(n(te),te)if(te.uid===C3)l(!0),h(!1),g(null);else{l(!1);try{const X=Mn(Jt(_e,"clients"),xn("uid","==",te.uid)),me=await Tn(X);if(me.empty)h(!1),g(null);else{const Ee=me.docs[0];h(!0),g({id:Ee.id,...Ee.data()})}}catch(X){console.error("Error fetching client data:",X),h(!1),g(null)}}else l(!1),h(!1),g(null);x(!1)}),[]);const U={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:V=>{g(te=>te&&{...te,...V})},login:async(V,te,X=!0)=>(await AC(qc,X?kw:$g),await RC(qc,V,te)),logout:()=>PC(qc),resetPassword:V=>CC(qc,V),loading:y};return a.jsx(jk.Provider,{value:U,children:s})}const Ek=w.createContext();function Pa(){return w.useContext(Ek)}function A3({children:s}){const[e,n]=w.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),n(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(Ek.Provider,{value:p,children:s})}function I3(){const[s,e]=w.useState(""),[n,i]=w.useState(""),[l,u]=w.useState(!0),[h,p]=w.useState(""),[g,y]=w.useState(!1),[x,k]=w.useState(!1),[E,O]=w.useState(!1),{login:G,resetPassword:U,currentUser:V,isAdmin:te,isClient:X,clientData:me,loading:Ee}=Xr(),ze=Zs();if(w.useEffect(()=>{if(!Ee&&V){if(te)ze("/dashboard");else if(X){const j=me?.clientType;ze(j==="core_buddy"?"/client/core-buddy":j==="circuit_vip"||j==="circuit_dropin"?"/client/circuit":"/client")}}},[Ee,V,te,X,me,ze]),Ee)return null;const Le=async j=>{j.preventDefault(),p(""),y(!0);try{await G(s,n,l)}catch(R){p(R.message||"Failed to log in"),y(!1)}},I=async j=>{if(j.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await U(s.trim()),O(!0)}catch(R){R.code==="auth/user-not-found"?p("No account found with this email"):p(R.message||"Failed to send reset email")}y(!1)};return a.jsx("div",{className:"login-container",children:a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:x?"Reset Password":"Client Portal"})]}),h&&a.jsx("div",{className:"error-message",children:h}),E?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):x?a.jsxs("form",{onSubmit:I,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Le,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:n,onChange:j=>i(j.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:j=>u(j.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})})}function Ma({active:s}){const e=Zs(),{clientData:n}=Xr(),i=n?.clientType==="block"&&n?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),i&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Ou(s,e,n,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:n+i*Math.sin(p),x2:e+l*Math.cos(p),y2:n+l*Math.sin(p),thick:h%5===0})}return u}const Hy=Ou(60,100,100,85,96),au=Ou(60,100,100,78,94),M3=Ou(60,100,100,82,94);Ou(60,50,50,38,46);const D3=Ou(60,40,40,30,37),Op=[10,25,50,100,200,500,1e3],Vi=5;function El(s){return s.toISOString().split("T")[0]}function P3(s){let e=0;for(const n of Op){if(s<n)return{prev:e,next:n};e=n}return{prev:Op[Op.length-1],next:s+100}}const L3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},O3={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Vp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Bp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Hc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function V3(s,e=800){return new Promise(n=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>n(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}const yr={first_workout:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 4v16"}),a.jsx("path",{d:"M18 4v16"}),a.jsx("path",{d:"M6 12h12"}),a.jsx("rect",{x:"3",y:"7",width:"6",height:"10",rx:"1"}),a.jsx("rect",{x:"15",y:"7",width:"6",height:"10",rx:"1"})]}),workouts_10:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2c1 3 4 5.5 4 8.5a4 4 0 1 1-8 0C8 7.5 11 5 12 2z"}),a.jsx("path",{d:"M12 14v4"}),a.jsx("path",{d:"M10 18h4"})]}),workouts_25:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),workouts_50:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 12h4"}),a.jsx("path",{d:"M16 12h4"}),a.jsx("path",{d:"M12 4v4"}),a.jsx("path",{d:"M12 16v4"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20z"})]}),workouts_100:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2L15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),streak_2:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M16 2v4"}),a.jsx("path",{d:"M8 2v4"}),a.jsx("path",{d:"M3 10h18"}),a.jsx("path",{d:"M9 16l2 2 4-4"})]}),streak_4:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),a.jsx("path",{d:"M16 2v4"}),a.jsx("path",{d:"M8 2v4"}),a.jsx("path",{d:"M3 10h18"}),a.jsx("path",{d:"M8 16h8"}),a.jsx("path",{d:"M12 14v4"})]}),streak_8:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M10 2c-1.5 3-5 5-5 9a7 7 0 0 0 14 0c0-4-3.5-6-5-9"}),a.jsx("path",{d:"M12 18c-2 0-3-1.5-3-3 0-2 1.5-3 3-5 1.5 2 3 3 3 5 0 1.5-1 3-3 3z"})]}),programme_done:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("path",{d:"M4 22h16"}),a.jsx("path",{d:"M10 22V8a4 4 0 0 0-4-4H8a4 4 0 0 0 4 4h0a4 4 0 0 0 4-4h2a4 4 0 0 0-4 4v14"}),a.jsx("path",{d:"M9 12l2 2 4-4"})]}),habits_7:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),nutrition_7:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a5 5 0 0 1 5 5c0 2-1.5 3.5-3 4.5V20a2 2 0 0 1-4 0v-8.5C8.5 10.5 7 9 7 7a5 5 0 0 1 5-5z"}),a.jsx("path",{d:"M9 7h6"})]}),first_pb:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M12 14v8"}),a.jsx("path",{d:"M9 18l3 3 3-3"}),a.jsx("path",{d:"M10 6l2 2 2-2"})]}),pbs_5:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 20h18"}),a.jsx("path",{d:"M5 20V10l4-6"}),a.jsx("path",{d:"M9 20V4"}),a.jsx("path",{d:"M13 20V10l4-6"}),a.jsx("path",{d:"M17 20V4"}),a.jsx("path",{d:"M21 20V10"})]}),leaderboard_join:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})},d2=[{id:"first_workout",icon:yr.first_workout,name:"First Rep",desc:"Complete your first workout",category:"workouts"},{id:"workouts_10",icon:yr.workouts_10,name:"On Fire",desc:"Complete 10 workouts",category:"workouts"},{id:"workouts_25",icon:yr.workouts_25,name:"Lightning",desc:"Complete 25 workouts",category:"workouts"},{id:"workouts_50",icon:yr.workouts_50,name:"Iron Will",desc:"Complete 50 workouts",category:"workouts"},{id:"workouts_100",icon:yr.workouts_100,name:"Century Club",desc:"Complete 100 workouts",category:"workouts"},{id:"streak_2",icon:yr.streak_2,name:"2 Week Warrior",desc:"2-week workout streak",category:"streak"},{id:"streak_4",icon:yr.streak_4,name:"Month Strong",desc:"4-week workout streak",category:"streak"},{id:"streak_8",icon:yr.streak_8,name:"Unbreakable",desc:"8-week workout streak",category:"streak"},{id:"programme_done",icon:yr.programme_done,name:"Finisher",desc:"Complete a programme",category:"programme"},{id:"habits_7",icon:yr.habits_7,name:"Habit Machine",desc:"7-day perfect habit streak",category:"habits"},{id:"nutrition_7",icon:yr.nutrition_7,name:"Fuel Master",desc:"Log nutrition 7 days in a row",category:"nutrition"},{id:"first_pb",icon:yr.first_pb,name:"Record Breaker",desc:"Set your first PB",category:"pbs"},{id:"pbs_5",icon:yr.pbs_5,name:"Climbing",desc:"Set 5 personal bests",category:"pbs"},{id:"leaderboard_join",icon:yr.leaderboard_join,name:"Competitor",desc:"Join the leaderboard",category:"social"}];function B3(){const{currentUser:s,isClient:e,clientData:n,logout:i,updateClientData:l,loading:u}=Xr(),{isDark:h,toggleTheme:p}=Pa(),g=Zs(),[y,x]=w.useState({hours:0,minutes:0,seconds:0}),[k,E]=w.useState(0),[O,G]=w.useState(0),[U,V]=w.useState(""),[te,X]=w.useState(0),[me,Ee]=w.useState(0),[ze,Le]=w.useState(!1),[I,j]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[R,L]=w.useState(null),[D,z]=w.useState(0),[M,Fe]=w.useState(null),[wt,Y]=w.useState(!1),[Se,Oe]=w.useState(!1),[ht,ae]=w.useState(0),[P,W]=w.useState(0),[ye,Ne]=w.useState([]),[Be,ke]=w.useState([]),[et,gt]=w.useState(null),[Je,Ht]=w.useState(!1),hn=w.useRef(null),[Nt,Ct]=w.useState([]),[oe,yn]=w.useState(null),[$t,Et]=w.useState(0),[Bt,ft]=w.useState(0),[Ye,le]=w.useState(0),[He,tt]=w.useState(0),[pt,Dt]=w.useState(null),at=w.useCallback((A,J="info")=>{Dt({message:A,type:J}),setTimeout(()=>Dt(null),4e3)},[]),[St,ce]=w.useState([]),[xe,Ie]=w.useState(!1),[Qe,Ge]=w.useState(""),[We,nt]=w.useState(null),[st,qe]=w.useState(null),[Kt,nn]=w.useState(!1),[en,Nn]=w.useState(new Set),[Fn,Ut]=w.useState(new Set),[wn,Xn]=w.useState({}),[Dn,us]=w.useState({}),[vs,Hn]=w.useState({}),[hs,ds]=w.useState({}),[Ns,Is]=w.useState({}),[Os,q]=w.useState({}),ge=w.useRef(null),we=w.useRef(null),ve=w.useRef({}),[pe,ot]=w.useState([]),[Rt,ut]=w.useState(!1),_t=w.useRef(null),[bt,dn]=w.useState([]),[er,bs]=w.useState(""),[Ms,Cn]=w.useState(!1),[F,ue]=w.useState(null),[T,C]=w.useState([]),[K,ee]=w.useState(null);w.useEffect(()=>{!u&&!s&&g("/")},[u,s,g]),w.useEffect(()=>{if(n)try{const A=sessionStorage.getItem(`cbDash_${n.id}`);if(A){const J=JSON.parse(A);G(J.programmePct??0),V(J.programmeName??""),X(J.totalWorkouts??0),Ee(J.habitWeekPct??0),j(J.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),L(J.nutritionTargetData??null),z(J.todayHabitsCount??0),Fe(J.nextSession??null),Y(J.hasProgramme??!1),Oe(J.programmeComplete??!1),ae(J.weeklyWorkouts??0),W(J.pbCount??0),Ne(J.topPBs??[]),ke(J.leaderboardTop3??[]),Ct(J.unlockedBadges??[]),Et(J.streakWeeks??0),Le(!0)}}catch{}},[n]),w.useEffect(()=>{n?.photoURL&&gt(n.photoURL)},[n]),w.useEffect(()=>{if(!n)return;const A=Mn(Jt(_e,"notifications"),xn("toId","==",n.id)),J=lM(A,Me=>{const Xe=Me.docs.map(mt=>({id:mt.id,...mt.data()}));Xe.sort((mt,it)=>{const yt=mt.createdAt?.toMillis?.()||0;return(it.createdAt?.toMillis?.()||0)-yt}),ot(Xe.slice(0,50))},Me=>{console.error("Notification listener error:",Me),Me.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>J()},[n]),w.useEffect(()=>{const A=J=>{_t.current&&!_t.current.contains(J.target)&&ut(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]),w.useEffect(()=>{if(!n)return;const A=n.id;(async()=>{try{const[J,Me,Xe]=await Promise.all([Tn(Mn(Jt(_e,"buddies"),xn("user1","==",A))),Tn(Mn(Jt(_e,"buddies"),xn("user2","==",A))),Tn(Jt(_e,"clients"))]),mt=new Set;[...J.docs,...Me.docs].forEach(yt=>{const Pt=yt.data();mt.add(Pt.user1===A?Pt.user2:Pt.user1)});const it={};Xe.docs.forEach(yt=>{it[yt.id]=yt.data()}),dn(Array.from(mt).filter(yt=>it[yt]).map(yt=>({id:yt,name:it[yt].name,photoURL:it[yt].photoURL||null})))}catch(J){console.error("Error loading buddies for mentions:",J)}})()},[n]);const Ue=pe.filter(A=>!A.read).length,Ve=async()=>{const A=pe.filter(Me=>!Me.read);if(!A.length)return;const J=r2(_e);A.forEach(Me=>J.update(Ke(_e,"notifications",Me.id),{read:!0})),await J.commit()},Pe=async()=>{if(!pe.length)return;const A=r2(_e);pe.forEach(J=>A.delete(Ke(_e,"notifications",J.id))),await A.commit()},Vt=async(A,J,Me={})=>{if(!(!n||A===n.id))try{await ri(Jt(_e,"notifications"),{toId:A,fromId:n.id,fromName:n.name||"Someone",fromPhotoURL:n.photoURL||null,type:J,read:!1,createdAt:Kr(),...Me})}catch(Xe){console.error("Notification create error:",Xe),Xe.code==="permission-denied"&&at("Notifications blocked  check Firestore rules","error")}},kt=(A,J)=>{const Me=J==="compose"?ge.current?.selectionStart:null,mt=(Me!=null?A.slice(0,Me):A).match(/@(\w*)$/);if(mt){Cn(!0),ue(J),bs(mt[1].toLowerCase());const it=bt.filter(yt=>yt.name&&yt.name.toLowerCase().includes(mt[1].toLowerCase())).slice(0,5);C(it)}else Cn(!1),C([])},H=(A,J)=>{if(J==="compose"){const Me=ge.current,Xe=Qe,mt=Me?.selectionStart??Xe.length,it=Xe.slice(0,mt),yt=Xe.slice(mt),Pt=it.replace(/@\w*$/,`@${A.name} `);Ge(Pt+yt),setTimeout(()=>{Me?.focus(),Me.selectionStart=Me.selectionEnd=Pt.length},0)}else{const Xe=(Dn[J]||"").replace(/@\w*$/,`@${A.name} `);us(mt=>({...mt,[J]:Xe}))}Cn(!1),C([])},de=A=>A&&A.split(/(@\w[\w\s]*?\s)/g).map((Me,Xe)=>Me.startsWith("@")&&bt.some(mt=>Me.trim()===`@${mt.name}`)?a.jsx("span",{className:"mention-highlight",children:Me.trim()},Xe):Me),re=async A=>{const J=A.target.files?.[0];if(!(!J||!n)){if(!J.type.startsWith("image/")){at("Please select an image file","error");return}if(J.size>5*1024*1024){at("Image must be under 5MB","error");return}Ht(!0);try{const Me=await new Promise(it=>{const yt=new Image;yt.onload=()=>{const Pt=document.createElement("canvas"),Mt=400;let zt=yt.width,Yt=yt.height;zt>Yt?(Yt=Yt/zt*Mt,zt=Mt):(zt=zt/Yt*Mt,Yt=Mt),Pt.width=zt,Pt.height=Yt,Pt.getContext("2d").drawImage(yt,0,0,zt,Yt),Pt.toBlob(Ft=>it(Ft),"image/jpeg",.75)},yt.src=URL.createObjectURL(J)}),Xe=Gi(Ki,`profilePhotos/${n.id}`);await Lp(Xe,Me);const mt=await Oo(Xe);await Hi(Ke(_e,"clients",n.id),{photoURL:mt}),gt(mt),l({photoURL:mt}),at("Profile photo updated!","success")}catch(Me){console.error("Photo upload error:",Me),at("Failed to upload photo","error")}Ht(!1),hn.current&&(hn.current.value="")}};w.useEffect(()=>{const A=()=>{const Me=new Date,Xe=new Date(Me);Xe.setHours(23,59,59,999);const mt=Xe-Me,it=Math.floor(mt/(1e3*60*60)),yt=Math.floor(mt%(1e3*60*60)/(1e3*60)),Pt=Math.floor(mt%(1e3*60)/1e3);x({hours:it,minutes:yt,seconds:Pt}),E(60-Pt)};A();const J=setInterval(A,1e3);return()=>clearInterval(J)},[]),w.useEffect(()=>{const A=setInterval(()=>{tt(J=>(J+1)%Vp.length)},8e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{if(!s||!n)return;(async()=>{let J=null,Me=0,Xe=[],mt=!1;try{const it=El(new Date),yt=await Qn(Ke(_e,"clientProgrammes",n.id));if(yt.exists()){const fs=yt.data(),Ws=L3[fs.templateId];if(Y(!0),Ws){const Gs=fs.completedSessions||{},Tr=Object.keys(Gs).length,jr=Ws.duration*Ws.daysPerWeek;G(jr>0?Math.round(Tr/jr*100):0);const fi=fs.templateId.replace(/_/g," ").replace(/\b\w/g,Zr=>Zr.toUpperCase());V(fi);const uo=O3[fs.templateId];let Or=!1;for(let Zr=1;Zr<=Ws.duration&&!Or;Zr++)for(let ea=0;ea<Ws.daysPerWeek&&!Or;ea++)Gs[`w${Zr}d${ea}`]||(Fe({week:Zr,dayIdx:ea,label:uo?.[ea]||`Day ${ea+1}`}),Or=!0);Or||(Oe(!0),mt=!0)}}const Pt=Jt(_e,"workoutLogs"),Mt=Mn(Pt,xn("clientId","==",n.id));J=await Tn(Mt);const zt=J.docs.filter(fs=>fs.data().type!=="programme").length;X(zt);const Yt=new Date,Ft=Yt.getDay(),vn=Ft===0?6:Ft-1,Wn=new Date(Yt);Wn.setDate(Yt.getDate()-vn),Wn.setHours(0,0,0,0);const Jn=El(Wn),ns=J.docs.filter(fs=>(fs.data().date||"")>=Jn).length;ae(ns);const xs=Jt(_e,"habitLogs"),ur=Mn(xs,xn("clientId","==",n.id),xn("date","==",it)),$s=await Tn(ur);let Gn=0;if(!$s.empty){const fs=$s.docs[0].data().habits||{};Gn=Object.values(fs).filter(Boolean).length}Ee(Math.round(Gn/Vi*100)),z(Gn);const hr=await Qn(Ke(_e,"nutritionTargets",n.id));hr.exists()&&L(hr.data());const tr=await Qn(Ke(_e,"nutritionLogs",`${n.id}_${it}`));if(tr.exists()){const Ws=(tr.data().entries||[]).reduce((Gs,Tr)=>({protein:Gs.protein+(Tr.protein||0),carbs:Gs.carbs+(Tr.carbs||0),fats:Gs.fats+(Tr.fats||0),calories:Gs.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});j(Ws)}}catch(it){console.error("Error loading dashboard stats:",it)}try{let it=[];const yt=await Qn(Ke(_e,"coreBuddyPBs",n.id));if(yt.exists()){const Pt=yt.data().exercises||{};W(Object.keys(Pt).length),Me=Object.keys(Pt).length,it=Object.entries(Pt).sort(([,Mt],[,zt])=>(zt.weight||0)-(Mt.weight||0)).slice(0,3).map(([Mt,zt])=>({name:Mt,weight:zt.weight,reps:zt.reps}))}if(it.length===0){const Pt={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},Mt=Mn(Jt(_e,"personalBests"),xn("clientId","==",n.id)),zt=await Tn(Mt);if(!zt.empty){const Yt={};zt.docs.forEach(vn=>{const Wn=vn.data().benchmarks||{};Object.entries(Wn).forEach(([Jn,ns])=>{if(!ns.weight||!Pt[Jn])return;const xs=(ns.weight||0)*(ns.reps||1);(!Yt[Jn]||xs>(Yt[Jn].weight||0)*(Yt[Jn].reps||1))&&(Yt[Jn]={name:Pt[Jn],weight:ns.weight,reps:ns.reps})})});const Ft=Object.values(Yt);W(Ft.length),Me=Ft.length,it=Ft.sort((vn,Wn)=>(Wn.weight||0)-(vn.weight||0)).slice(0,3)}}Xe=it,Ne(it)}catch(it){console.error("PB fetch error:",it)}try{const it=Jt(_e,"clients"),yt=Mn(it,xn("leaderboardOptIn","==",!0)),Mt=(await Tn(yt)).docs.map(zt=>({id:zt.id,name:zt.data().name,photoURL:zt.data().photoURL||null}));ke(Mt.slice(0,3))}catch(it){console.error("Leaderboard preview error:",it)}try{let it=0;if(J){const vn=J.docs.map(Wn=>Wn.data().date).filter(Boolean).sort().reverse();if(vn.length>0){const Wn=new Date;let Jn=new Date(Wn);e:for(let ns=0;ns<52;ns++){const xs=new Date(Jn),ur=xs.getDay(),$s=ur===0?6:ur-1;xs.setDate(xs.getDate()-$s),xs.setHours(0,0,0,0);const Gn=new Date(xs);Gn.setDate(Gn.getDate()+7);const hr=El(xs),tr=El(Gn);if(vn.some(Ws=>Ws>=hr&&Ws<tr))it++;else{if(ns>0)break e;break}Jn.setDate(Jn.getDate()-7)}}}Et(it);let yt=0;for(let vn=0;vn<30;vn++){const Wn=new Date;Wn.setDate(Wn.getDate()-vn);const Jn=El(Wn);try{const ns=await Tn(Mn(Jt(_e,"habitLogs"),xn("clientId","==",n.id),xn("date","==",Jn)));if(ns.empty)break;{const xs=ns.docs[0].data().habits||{};if(Object.values(xs).filter(Boolean).length>=Vi)yt++;else break}}catch{break}}ft(yt);let Pt=0;for(let vn=0;vn<30;vn++){const Wn=new Date;Wn.setDate(Wn.getDate()-vn);const Jn=El(Wn);try{const ns=await Qn(Ke(_e,"nutritionLogs",`${n.id}_${Jn}`));if(ns.exists()&&(ns.data().entries||[]).length>0)Pt++;else break}catch{break}}le(Pt);const Mt=J?J.docs.length:0,zt=[],Yt=vn=>zt.push(vn);Mt>=1&&Yt("first_workout"),Mt>=10&&Yt("workouts_10"),Mt>=25&&Yt("workouts_25"),Mt>=50&&Yt("workouts_50"),Mt>=100&&Yt("workouts_100"),it>=2&&Yt("streak_2"),it>=4&&Yt("streak_4"),it>=8&&Yt("streak_8"),mt&&Yt("programme_done"),yt>=7&&Yt("habits_7"),Pt>=7&&Yt("nutrition_7"),(Me>0||Xe.length>0)&&Yt("first_pb"),Me>=5&&Yt("pbs_5"),n.leaderboardOptIn&&Yt("leaderboard_join"),Ct(zt);const Ft={};zt.forEach(vn=>{Ft[vn]={unlockedAt:new Date().toISOString()}}),Vn(Ke(_e,"achievements",n.id),{badges:Ft,updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(it){console.error("Achievement computation error:",it)}Le(!0)})()},[s,n]),w.useEffect(()=>{if(!(!ze||!n))try{sessionStorage.setItem(`cbDash_${n.id}`,JSON.stringify({programmePct:O,programmeName:U,totalWorkouts:te,habitWeekPct:me,nutritionTotals:I,nutritionTargetData:R,todayHabitsCount:D,nextSession:M,hasProgramme:wt,programmeComplete:Se,weeklyWorkouts:ht,pbCount:P,topPBs:ye,leaderboardTop3:Be,unlockedBadges:Nt,streakWeeks:$t}))}catch{}},[ze,O,U,te,me,I,R,D,M,wt,Se,ht,P,ye,Be,Nt,$t,n]);const Ce=A=>{const J=A.currentTarget,Me=J.querySelector(".ripple");Me&&Me.remove();const Xe=J.getBoundingClientRect(),mt=Math.max(Xe.width,Xe.height),it=A.clientX-Xe.left-mt/2,yt=A.clientY-Xe.top-mt/2,Pt=document.createElement("span");Pt.className="ripple",Pt.style.cssText=`width:${mt}px;height:${mt}px;left:${it}px;top:${yt}px;`,J.appendChild(Pt),setTimeout(()=>Pt.remove(),600)},De=n?.name?.split(" ")[0]||"there",{prev:rt,next:At}=P3(te),ct=At>rt?Math.round((te-rt)/(At-rt)*100):100,tn=[{label:"Programme",value:`${O}%`,pct:O,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${te}`,pct:ct,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${me}%`,pct:me,color:"#38B6FF",size:"normal"}],Rn=A=>!R||!R[A]?0:Math.min(Math.round(I[A]/R[A]*100),100),fn=(()=>{const A=new Date().getHours();return ze&&D>=Vi&&I.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:A>=5&&A<12?{main:"Rise and grind,",sub:"let's get after it!"}:A>=12&&A<17?{main:"Oye",sub:"crack on and make it count!"}:A>=17&&A<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),mn=ze?wt&&M&&!Se?{label:"NEXT SESSION",message:`Week ${M.week}, Day ${M.dayIdx+1}  ${M.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:O,ringLabel:`${O}%`}:D<Vi?{label:"DAILY HABITS",message:`${D}/${Vi} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:me,ringLabel:`${D}/${Vi}`}:I.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:wt?Se?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,xr=w.useCallback(async()=>{if(n){Ie(!0);try{const A=await Tn(Mn(Jt(_e,"posts"),xn("authorId","==",n.id),Hd("createdAt","desc"),$d(30)));ce(A.docs.map(Me=>({id:Me.id,...Me.data()})));const J=await Tn(Mn(Jt(_e,"postLikes"),xn("userId","==",n.id)));Nn(new Set(J.docs.map(Me=>Me.data().postId)))}catch(A){console.error("Error loading journey:",A)}finally{Ie(!1)}}},[n]);w.useEffect(()=>{ze&&n&&xr()},[ze,n,xr]);const La=A=>{const J=A.target.files?.[0];if(J){if(!J.type.startsWith("image/")){at("Please select an image file","error");return}if(J.size>10*1024*1024){at("Image must be under 10MB","error");return}nt(J),qe(URL.createObjectURL(J))}},Jr=()=>{nt(null),st&&URL.revokeObjectURL(st),qe(null),we.current&&(we.current.value="")},wr=async()=>{if(!(!Qe.trim()&&!We||Kt||!n)){nn(!0);try{let A=null;if(We){const Xe=await V3(We),mt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,it=Gi(Ki,`postImages/${n.id}/${mt}`);await Lp(it,Xe),A=await Oo(it)}await ri(Jt(_e,"posts"),{authorId:n.id,authorName:n.name||"Unknown",authorPhotoURL:n.photoURL||null,content:Qe.trim(),type:A?"image":"text",imageURL:A||null,createdAt:Kr(),likeCount:0,commentCount:0});const Me=Qe.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Me){const Xe=new Set;Me.forEach(mt=>{const it=mt.slice(1).trim(),yt=bt.find(Pt=>Pt.name&&Pt.name.toLowerCase()===it.toLowerCase());yt&&!Xe.has(yt.id)&&(Xe.add(yt.id),Vt(yt.id,"mention",{}))})}Ge(""),Jr(),ge.current&&(ge.current.style.height="auto"),await xr(),at("Posted!","success")}catch(A){console.error("Error posting:",A),at(A?.message||"Failed to post","error")}finally{nn(!1)}}},pn=async A=>{if(window.confirm("Delete this post?"))try{await ar(Ke(_e,"posts",A)),ce(J=>J.filter(Me=>Me.id!==A)),at("Post deleted","info")}catch(J){console.error("Delete error:",J),at("Failed to delete","error")}},$n=async A=>{if(!n)return;const J=n.id,Me=`${A}_${J}`,Xe=en.has(A),mt=new Set(en);Xe?mt.delete(A):mt.add(A),Nn(mt),ce(it=>it.map(yt=>yt.id===A?{...yt,likeCount:Math.max(0,(yt.likeCount||0)+(Xe?-1:1))}:yt));try{if(Xe)await ar(Ke(_e,"postLikes",Me)),await Hi(Ke(_e,"posts",A),{likeCount:Mo(-1)});else{await Vn(Ke(_e,"postLikes",Me),{postId:A,userId:J,createdAt:Kr()}),await Hi(Ke(_e,"posts",A),{likeCount:Mo(1)});const it=St.find(yt=>yt.id===A);it&&Vt(it.authorId,"like",{postId:A})}}catch(it){console.error("Like error:",it),xr()}},Bn=async A=>{try{const J=await Tn(Mn(Jt(_e,"postComments"),xn("postId","==",A),Hd("createdAt","asc"),$d(50)));Xn(Me=>({...Me,[A]:J.docs.map(Xe=>({id:Xe.id,...Xe.data()}))}))}catch(J){console.error("Error loading comments:",J)}},_r=A=>{const J=new Set(Fn);J.has(A)?J.delete(A):(J.add(A),wn[A]||Bn(A)),Ut(J)},cr=async A=>{const J=(Dn[A]||"").trim(),Me=Ns[A];if(!(!J&&!Me||!n)){Hn(Xe=>({...Xe,[A]:!0}));try{let Xe=null;if(Me){const Mt=Gi(Ki,`comment-images/${Date.now()}_${Me.name}`);await Lp(Mt,Me),Xe=await Oo(Mt)}const mt={postId:A,authorId:n.id,authorName:n.name||"Unknown",authorPhotoURL:n.photoURL||null,content:J||"",createdAt:Kr()};Xe&&(mt.imageURL=Xe);const it=hs[A];it&&(mt.replyToId=it.id,mt.replyToName=it.authorName),await ri(Jt(_e,"postComments"),mt),await Hi(Ke(_e,"posts",A),{commentCount:Mo(1)});const yt=St.find(Mt=>Mt.id===A);yt&&Vt(yt.authorId,"comment",{postId:A});const Pt=J.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Pt){const Mt=new Set;Pt.forEach(zt=>{const Yt=zt.slice(1).trim(),Ft=bt.find(vn=>vn.name&&vn.name.toLowerCase()===Yt.toLowerCase());Ft&&!Mt.has(Ft.id)&&(Mt.add(Ft.id),Vt(Ft.id,"mention",{postId:A}))})}us(Mt=>({...Mt,[A]:""})),Is(Mt=>({...Mt,[A]:null})),q(Mt=>({...Mt,[A]:null})),ds(Mt=>({...Mt,[A]:null})),ve.current[A]&&(ve.current[A].value=""),ce(Mt=>Mt.map(zt=>zt.id===A?{...zt,commentCount:(zt.commentCount||0)+1}:zt)),await Bn(A)}catch(Xe){console.error("Comment error:",Xe),at("Failed to comment","error")}finally{Hn(Xe=>({...Xe,[A]:!1}))}}},Cs=async(A,J)=>{try{await ar(Ke(_e,"postComments",J)),await Hi(Ke(_e,"posts",A),{commentCount:Mo(-1)}),Xn(Me=>({...Me,[A]:(Me[A]||[]).filter(Xe=>Xe.id!==J)})),ce(Me=>Me.map(Xe=>Xe.id===A?{...Xe,commentCount:Math.max((Xe.commentCount||1)-1,0)}:Xe))}catch(Me){console.error("Delete comment error:",Me),at("Failed to delete comment","error")}},Ds=(A,J)=>{const Me=J.target.files?.[0];if(!Me)return;if(Me.size>5*1024*1024){at("Image must be under 5MB","error");return}Is(mt=>({...mt,[A]:Me}));const Xe=new FileReader;Xe.onload=mt=>q(it=>({...it,[A]:mt.target.result})),Xe.readAsDataURL(Me)},Lr=A=>{Is(J=>({...J,[A]:null})),q(J=>({...J,[A]:null})),ve.current[A]&&(ve.current[A].value="")},kr=A=>{Ge(A.target.value),A.target.style.height="auto",A.target.style.height=Math.min(A.target.scrollHeight,120)+"px",kt(A.target.value,"compose")},pa=(A,J)=>{us(Me=>({...Me,[A]:J})),kt(J,A)};return a.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:_t,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{ut(!Rt),Rt||Ve()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Ue>0&&a.jsx("span",{className:"header-notif-badge",children:Ue>9?"9+":Ue})]}),Rt&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),pe.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Pe,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:pe.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):pe.map(A=>a.jsxs("div",{className:`notif-item${A.read?"":" unread"}`,onClick:()=>{if(ut(!1),A.type==="buddy_request"||A.type==="buddy_accept")g("/client/core-buddy/buddies");else if((A.type==="like"||A.type==="comment")&&A.postId){if(!Fn.has(A.postId)){const J=new Set(Fn);J.add(A.postId),Ut(J),wn[A.postId]||Bn(A.postId)}setTimeout(()=>{const J=document.getElementById(`post-${A.postId}`);J&&J.scrollIntoView({behavior:"smooth",block:"center"})},150)}else A.type==="like"||A.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):A.type==="mention"&&g(`/client/core-buddy/profile/${A.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:A.fromPhotoURL?a.jsx("img",{src:A.fromPhotoURL,alt:""}):a.jsx("span",{children:(A.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:A.fromName})," ",A.type==="buddy_request"&&"sent you a buddy request",A.type==="buddy_accept"&&"accepted your buddy request",A.type==="like"&&"liked your post",A.type==="comment"&&"commented on your post",A.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Bp(A.createdAt)})]})]},A.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:h?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Hy.map((A,J)=>{const Me=J<k;return a.jsx("line",{x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,className:`ring-tick ${Me?"elapsed":"remaining"}`,strokeWidth:A.thick?"3":"2"},J)})}),a.jsx("div",{className:"cb-ring-center",children:a.jsxs("div",{className:"cb-ring-logo",onClick:()=>hn.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:et||"/Logo.webp",alt:et?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Je?" uploading":""}`,children:Je?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:hn,type:"file",accept:"image/*",onChange:re,style:{display:"none"}})]})})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(y.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(y.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(y.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Vp[He].text," ",a.jsx("strong",{children:Vp[He].bold})]},He)]}),a.jsx("div",{className:"cb-stats-row",children:tn.map(A=>{const J=(A.size==="large",38),Me=2*Math.PI*J,Xe=Me-A.pct/100*Me;return a.jsxs("div",{className:`cb-stat-item${A.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:J}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:J,style:{stroke:A.color},strokeDasharray:Me,strokeDashoffset:Xe})]}),a.jsx("span",{className:"cb-stat-value",style:{color:A.color},children:A.value})]}),a.jsx("span",{className:"cb-stat-label",children:A.label})]},A.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[fn.main," ",a.jsx("strong",{children:De}),"  ",fn.sub]}),mn&&a.jsxs("button",{className:"cb-nudge-card",onClick:mn.action||void 0,style:mn.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-mn.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:mn.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:mn.label}),a.jsx("span",{className:"cb-nudge-title",children:mn.message}),mn.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[mn.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[a.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Rn("protein"),color:"#14b8a6"},{label:"C",pct:Rn("carbs"),color:"var(--color-primary)"},{label:"F",pct:Rn("fats"),color:"#eab308"},{label:"Cal",pct:Rn("calories"),color:"#38B6FF"}].map(A=>{const Me=2*Math.PI*38,Xe=Me-A.pct/100*Me;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:A.color},strokeDasharray:Me,strokeDashoffset:Xe})]}),a.jsx("span",{style:{color:A.color},children:A.label})]},A.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[ht," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[te," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Vi},(A,J)=>a.jsx("span",{className:`cb-habit-dot${J<D?" done":""}`},J))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[D,"/",Vi," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:A=>{Ce(A),g("/client/personal-bests?mode=corebuddy")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"PBs"}),ye.length>0?a.jsx("div",{className:"cb-pb-preview",children:ye.slice(0,2).map(A=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:A.name}),a.jsxs("span",{className:"cb-pb-value",children:[A.weight,"kg"]})]},A.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:A=>{Ce(A),g("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),Be.length>0?a.jsx("div",{className:"cb-lb-preview",children:Be.map((A,J)=>{const Me=["#FFD700","#A8B4C0","#CD7F32"][J],Xe=A.name?A.name.split(" ").map(it=>it[0]).join("").slice(0,2).toUpperCase():"?",mt=A.id===n?.id;return a.jsxs("div",{className:`cb-lb-entry${mt?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Me},children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:Xe})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Me},children:["#",J+1]})]},A.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-achievements-section",children:[a.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),a.jsx("div",{className:"cb-badges-scroll",children:d2.map(A=>{const J=Nt.includes(A.id);return a.jsxs("button",{className:`cb-badge${J?" unlocked":" locked"}`,onClick:()=>yn(oe?.id===A.id?null:A),children:[a.jsx("span",{className:"cb-badge-icon",children:A.icon}),a.jsx("span",{className:"cb-badge-name",children:A.name})]},A.id)})}),oe&&a.jsxs("div",{className:"cb-badge-detail",children:[a.jsx("span",{className:"cb-badge-detail-icon",children:oe.icon}),a.jsxs("div",{className:"cb-badge-detail-info",children:[a.jsx("strong",{children:oe.name}),a.jsx("span",{children:oe.desc}),Nt.includes(oe.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"})]})]}),a.jsxs("p",{className:"cb-badges-count",children:[Nt.length,"/",d2.length," unlocked"]})]}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:et?a.jsx("img",{src:et,alt:""}):a.jsx("span",{children:Hc(n?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:ge,placeholder:"Share your progress... (use @ to mention)",value:Qe,onChange:kr,rows:1,maxLength:500}),Ms&&F==="compose"&&T.length>0&&a.jsx("div",{className:"mention-dropdown",children:T.map(A=>a.jsxs("button",{className:"mention-option",onClick:()=>H(A,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:""}):a.jsx("span",{children:Hc(A.name)})}),a.jsx("span",{children:A.name})]},A.id))}),st&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:st,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Jr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>we.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:we,type:"file",accept:"image/*",onChange:La,hidden:!0}),(Qe.trim()||We)&&a.jsx("button",{className:"journey-post-btn",onClick:wr,disabled:Kt,children:Kt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),xe?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):St.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:St.map(A=>a.jsxs("div",{id:`post-${A.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:A.authorPhotoURL?a.jsx("img",{src:A.authorPhotoURL,alt:""}):a.jsx("span",{children:Hc(A.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:A.authorName}),a.jsx("span",{className:"journey-post-time",children:Bp(A.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>pn(A.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),A.content&&a.jsx("p",{className:"journey-post-content",children:de(A.content)}),A.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:A.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${en.has(A.id)?" liked":""}`,onClick:()=>$n(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:en.has(A.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:A.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(A.id)?" active":""}`,onClick:()=>_r(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:A.commentCount||0})]})]}),Fn.has(A.id)&&a.jsxs("div",{className:"journey-comments",children:[wn[A.id]?.length>0?wn[A.id].map(J=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:J.authorPhotoURL?a.jsx("img",{src:J.authorPhotoURL,alt:""}):a.jsx("span",{children:Hc(J.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:J.authorName}),J.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),J.replyToName]}),J.content&&a.jsx("span",{className:"journey-comment-text",children:de(J.content)}),J.imageURL&&a.jsx("img",{className:"journey-comment-image",src:J.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Bp(J.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>ds(Me=>({...Me,[A.id]:{id:J.id,authorName:J.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Cs(A.id,J.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},J.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),hs[A.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:hs[A.id].authorName})]}),a.jsx("button",{onClick:()=>ds(J=>({...J,[A.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Os[A.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Os[A.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Lr(A.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ve.current[A.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:J=>{ve.current[A.id]=J},type:"file",accept:"image/*",onChange:J=>Ds(A.id,J),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Dn[A.id]||"",onChange:J=>pa(A.id,J.target.value),onKeyDown:J=>{J.key==="Enter"&&cr(A.id)},maxLength:300}),Ms&&F===A.id&&T.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:T.map(J=>a.jsxs("button",{className:"mention-option",onClick:()=>H(J,A.id),children:[a.jsx("div",{className:"mention-option-avatar",children:J.photoURL?a.jsx("img",{src:J.photoURL,alt:""}):a.jsx("span",{children:Hc(J.name)})}),a.jsx("span",{children:J.name})]},J.id))}),a.jsx("button",{onClick:()=>cr(A.id),disabled:!(Dn[A.id]||"").trim()&&!Ns[A.id]||vs[A.id],children:vs[A.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},A.id))})]})]})]}),a.jsx(Ma,{active:"home"}),pt&&a.jsxs("div",{className:`toast-notification ${pt.type}`,children:[pt.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),pt.message]})]})}const Up=new Map;function Bi(){return new Date().toISOString().split("T")[0]}const f2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],U3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function z3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function F3(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=w.useState("loading"),[x,k]=w.useState(null),[E,O]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,U]=w.useState(null),[V,te]=w.useState(Bi()),[X,me]=w.useState({entries:[],water:0}),[Ee,ze]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[Le,I]=w.useState(!1),[j,R]=w.useState(!1),[L,D]=w.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[z,M]=w.useState(z3),[Fe,wt]=w.useState(null),[Y,Se]=w.useState(null),[Oe,ht]=w.useState(!1),[ae,P]=w.useState(null),[W,ye]=w.useState(""),[Ne,Be]=w.useState(!1),[ke,et]=w.useState(""),[gt,Je]=w.useState([]),[Ht,hn]=w.useState(!1),[Nt,Ct]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,yn]=w.useState(null),[$t,Et]=w.useState("100"),[Bt,ft]=w.useState(0),[Ye,le]=w.useState("weight"),[He,tt]=w.useState(0),[pt,Dt]=w.useState(null);w.useRef(null);const at=w.useRef(!1),St=w.useRef(null),ce=w.useRef(null),xe=w.useRef(null),Ie=w.useCallback((T,C="info")=>{Dt({message:T,type:C}),setTimeout(()=>Dt(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!n?.id)return;(async()=>{try{const C=await Qn(Ke(_e,"nutritionTargets",n.id));C.exists()?(k(C.data()),y("dashboard")):y("setup")}catch(C){console.error("Error loading nutrition data:",C),y("setup")}})()},[n?.id]),w.useEffect(()=>{if(!n?.id)return;(async()=>{try{const C=await Qn(Ke(_e,"nutritionLogs",`${n.id}_${V}`));if(C.exists()){const K=C.data();me({entries:K.entries||[],water:K.water||0})}else me({entries:[],water:0})}catch(C){console.error("Error loading log:",C),me({entries:[],water:0})}})()},[n?.id,V]),w.useEffect(()=>{const T=X.entries.reduce((C,K)=>({protein:C.protein+(K.protein||0),carbs:C.carbs+(K.carbs||0),fats:C.fats+(K.fats||0),calories:C.calories+(K.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ze(T)},[X.entries]);const Qe=async T=>{try{await Vn(Ke(_e,"nutritionLogs",`${n.id}_${V}`),{clientId:n.id,date:V,entries:T.entries,water:T.water,updatedAt:xt.now()})}catch(C){console.error("Error saving nutrition log:",C)}},Ge=V===Bi(),We=(T,C)=>new Date(T,C+1,0).getDate(),nt=(T,C)=>new Date(T,C,1).getDay(),st=["January","February","March","April","May","June","July","August","September","October","November","December"],qe=["Su","Mo","Tu","We","Th","Fr","Sa"],Kt=()=>{let T=parseFloat(E.weight);E.weightUnit==="lbs"&&(T*=.453592);let C;E.heightUnit==="cm"?C=parseFloat(E.height):C=(parseFloat(E.heightFeet)||0)*30.48+(parseFloat(E.heightInches)||0)*2.54;const K=parseInt(E.age);let ee=E.gender==="male"?10*T+6.25*C-5*K+5:10*T+6.25*C-5*K-161;const Ve=ee*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[E.dailyActivity],Pe={low:100,moderate:200,high:300,daily:400},Vt=Math.round(Ve+Pe[E.trainingFrequency]);let kt=Vt,H,de;switch(E.goal){case"lose":kt=Vt*(1-{light:.15,moderate:.2,harsh:.25}[E.deficitLevel]),H=2.2,de=.3;break;case"build":kt=Vt*1.1,H=2,de=.22;break;default:H=1.8,de=.25}kt=Math.max(kt,E.gender==="male"?1400:1100);const re=Math.round(T*H),Ce=Math.round(kt*de/9),De=Math.max(0,Math.round((kt-re*4-Ce*9)/4));U({calories:Math.round(kt),protein:re,carbs:De,fats:Ce,bmr:Math.round(ee),neat:Math.round(Ve),exerciseAdd:Pe[E.trainingFrequency],tdee:Math.round(Vt)})},nn=async()=>{if(G)try{const T={clientId:n.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,waterGoal:8,goal:E.goal,updatedAt:xt.now()};await Vn(Ke(_e,"nutritionTargets",n.id),T),k(T),y("dashboard"),Ie("Macro targets saved!","success")}catch(T){console.error("Error saving targets:",T),Ie("Failed to save targets. Please try again.","error")}},en=()=>{const T=E.weight&&parseFloat(E.weight)>0,C=E.age&&parseInt(E.age)>0,K=E.heightUnit==="cm"?E.height&&parseFloat(E.height)>0:E.heightFeet&&parseFloat(E.heightFeet)>0||E.heightInches&&parseFloat(E.heightInches)>0;return T&&C&&K},Nn="nut_favourite_foods",Fn=()=>{try{return JSON.parse(localStorage.getItem(Nn)||"[]")}catch{return[]}},Ut=T=>Fn().some(C=>C.name.toLowerCase()===(T||"").toLowerCase()),wn=T=>{const C=Fn(),K=C.findIndex(ee=>ee.name.toLowerCase()===T.name.toLowerCase());K>=0?C.splice(K,1):C.unshift({name:T.name,protein:T.protein,carbs:T.carbs,fats:T.fats,calories:T.calories,serving:T.serving,per100g:T.per100g||null,servingUnit:T.servingUnit||"g",portion:T.portion||null}),localStorage.setItem(Nn,JSON.stringify(C)),tt(ee=>ee+1)},Xn=T=>{const C=[...X.entries,{...T,meal:z,id:Date.now(),addedAt:new Date().toISOString()}],K={...X,entries:C};me(K),Qe(K),Se(null),yn(null),Et("100"),ft(0),le("weight"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ie("Food added!","success")},Dn=T=>{const C=X.entries.filter(ee=>ee.id!==T),K={...X,entries:C};me(K),Qe(K)},us=w.useRef(null),vs=async()=>{ht(!0);const T=document.querySelector("#barcode-reader");if(!T){ht(!1),Ie("Scanner container not found.","error");return}if(!us.current)try{const K=await Qr(()=>import("./quagga.min-BbicSfvA.js").then(ee=>ee.q),[]);us.current=K.default}catch(K){console.error("Failed to load barcode scanner:",K),ht(!1),Ie("Could not load scanner.","error");return}const C=us.current;C.init({inputStream:{type:"LiveStream",target:T,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},K=>{if(K){console.error("Quagga init error:",K),ht(!1),Ie("Could not access camera. Check permissions.","error");return}C.start(),at.current=!0}),C.onDetected(K=>{const ee=K.codeResult.decodedCodes?.filter(Ve=>Ve.error!==void 0)?.map(Ve=>Ve.error)||[];if((ee.length>0?ee.reduce((Ve,Pe)=>Ve+Pe,0)/ee.length:1)<.15){const Ve=K.codeResult.code;C.offDetected(),P(Ve)}})},Hn=()=>{const T=us.current;at.current&&T&&(T.stop(),T.offDetected(),at.current=!1),ht(!1)},hs=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,ds=T=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((T||"").replace(/\s/g,"")),Ns=T=>{if(!T)return{value:100,unit:"g"};const C=T.toLowerCase().replace(/\s/g,""),K=C.match(/([\d.]+)/),ee=K?parseFloat(K[1]):100;return ds(T)?/cl/.test(C)?{value:ee*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(C)&&!/ml/.test(C)?{value:ee*1e3,unit:"ml"}:{value:ee,unit:"ml"}:{value:ee,unit:"g"}},Is=T=>{if(ds(T.serving_size)||ds(T.quantity))return"ml";const C=T.product_name||T.product_name_en||"";return hs.test(C)?"ml":"g"},Os=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],q=(T,C)=>{const K=T||"",ee=K.match(/\((\d+\.?\d*)\s*g\)/i),Ue=K.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ee&&Ue){const Vt=parseFloat(ee[1]);let kt=Ue[1].replace(/^\d+\s*/,"").trim();if(kt&&Vt>0)return{label:kt,weight:Vt}}const Ve=K.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ve){const Vt=parseFloat(Ve[1]);let kt=Ve[2].replace(/^\d+\s*/,"").trim();if(kt&&Vt>0)return{label:kt,weight:Vt}}const Pe=C||"";for(const{pattern:Vt,label:kt,weight:H}of Os)if(Vt.test(Pe))return{label:kt,weight:H};return null},ge=T=>{const C=T.nutriments||{},K=Is(T),ee=Ns(T.serving_size),Ue=K==="ml"?ee.unit==="ml"?ee.value:100:ee.value,Ve=T.product_name||T.product_name_en||"Unknown Product",Pe=q(T.serving_size,Ve);return{name:Ve,brand:T.brands||"",image:T.image_small_url||T.image_url||null,servingSize:T.serving_size||"100g",servingValue:Ue,servingUnit:K,portion:Pe,protein:Math.round(C.proteins_100g||C.proteins||0),carbs:Math.round(C.carbohydrates_100g||C.carbohydrates||0),fats:Math.round(C.fat_100g||C.fat||0),calories:Math.round(C["energy-kcal_100g"]||C["energy-kcal"]||(C.energy_100g?C.energy_100g/4.184:0)),per100g:!0}},we=async T=>{Be(!0);try{const C=`https://world.openfoodfacts.org/api/v2/product/${T}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,K=await fetch(C);if(!K.ok)throw new Error(`HTTP ${K.status}`);const ee=await K.json();if(ee.status==="success"||ee.status===1||ee.product){const Ue=ge(ee.product);Ue.calories===0&&Ue.protein===0&&Ue.carbs===0?Ie("Product found but no nutrition data available.","error"):(yn(Ue),Ue.portion?(ft(1),Et(String(Ue.portion.weight)),le("portion")):(ft(0),Et(String(Ue.servingValue||100)),le("weight")),ye(""))}else Ie("Product not found. Try search or manual entry.","error")}catch(C){console.error("Barcode lookup error:",C),Ie("Failed to look up product. Check your connection.","error")}Be(!1)},ve=(T,C,K)=>{const ee=T.toLowerCase().trim(),Ue=C.toLowerCase().trim(),Ve=K.toLowerCase().trim();let Pe=0;return(ee===Ve||ee===Ve+"s"||ee+"s"===Ve)&&(Pe+=100),(ee.endsWith(" "+Ve)||ee.endsWith(" "+Ve+"s"))&&(Pe+=40),(ee.startsWith(Ve+" ")||ee.startsWith(Ve+"s "))&&(Pe+=15),Ve.split(/\s+/).some(kt=>Ue===kt||Ue.startsWith(kt))&&(Pe+=30),Pe+=Math.max(0,30-ee.length),Pe},pe=async()=>{if(!ke.trim())return;St.current&&St.current.abort();const T=new AbortController;St.current=T;const C=ke.trim().toLowerCase(),K=C.split(/\s+/).filter(Boolean);if(Up.has(C)){Je(Up.get(C));return}hn(!0);try{const Ue=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(ke.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ve=await fetch(Ue,{signal:T.signal});if(!Ve.ok)throw new Error(`HTTP ${Ve.status}`);const Vt=((await Ve.json()).products||[]).map(kt=>ge(kt)).filter(kt=>kt.name!=="Unknown Product"&&(kt.calories>0||kt.protein>0)).filter(kt=>{const H=(kt.name+" "+kt.brand).toLowerCase();return K.every(de=>H.includes(de))}).sort((kt,H)=>ve(H.name,H.brand,C)-ve(kt.name,kt.brand,C)).slice(0,10);Up.set(C,Vt),Je(Vt),Vt.length===0&&Ie("No results found. Try a different search.","info")}catch(ee){if(ee.name==="AbortError")return;console.error("Search error:",ee),Ie("Search failed. Check your connection.","error")}hn(!1)};w.useEffect(()=>{if(ce.current&&clearTimeout(ce.current),!(!ke.trim()||Y!=="search"||oe))return ce.current=setTimeout(()=>{pe()},700),()=>clearTimeout(ce.current)},[ke]);const ot=()=>{const T={...X,water:X.water+1};me(T),Qe(T)},Rt=()=>{if(X.water<=0)return;const T={...X,water:X.water-1};me(T),Qe(T)},ut={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},_t=80,bt=2*Math.PI*_t,dn=(T,C,K,ee,Ue)=>{const Ve=ee>0?Math.min(100,Math.round(K/ee*100)):0,Pe=bt-Ve/100*bt,Vt=ut[Ue]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:_t}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:_t,style:{stroke:Vt},strokeDasharray:bt,strokeDashoffset:Pe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Vt},children:Math.round(K)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ee,T==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Vt},children:C})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Vt},children:[Ve,"%"]})]})};if(w.useEffect(()=>{if(!ae)return;const T=setTimeout(()=>{const C=ae;Hn(),P(null),we(C)},1500);return()=>clearTimeout(T)},[ae]),w.useEffect(()=>()=>{const T=us.current;if(at.current&&T){try{T.stop(),T.offDetected()}catch{}at.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:E.gender==="male"?"active":"",onClick:()=>{O(T=>({...T,gender:"male"})),U(null)},children:"Male"}),a.jsx("button",{className:E.gender==="female"?"active":"",onClick:()=>{O(T=>({...T,gender:"female"})),U(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:E.age,onChange:T=>{O(C=>({...C,age:T.target.value})),U(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:E.weight,onChange:T=>{O(C=>({...C,weight:T.target.value})),U(null)},placeholder:E.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.weightUnit==="kg"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"kg"})),U(null)},children:"kg"}),a.jsx("button",{className:E.weightUnit==="lbs"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"lbs"})),U(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[E.heightUnit==="cm"?a.jsx("input",{type:"number",value:E.height,onChange:T=>{O(C=>({...C,height:T.target.value})),U(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:E.heightFeet,onChange:T=>{O(C=>({...C,heightFeet:T.target.value})),U(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:E.heightInches,onChange:T=>{O(C=>({...C,heightInches:T.target.value})),U(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.heightUnit==="cm"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"cm"})),U(null)},children:"cm"}),a.jsx("button",{className:E.heightUnit==="ft"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"ft"})),U(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:E.dailyActivity,onChange:T=>{O(C=>({...C,dailyActivity:T.target.value})),U(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:E.trainingFrequency,onChange:T=>{O(C=>({...C,trainingFrequency:T.target.value})),U(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:E.goal==="lose"?"active":"",onClick:()=>{O(T=>({...T,goal:"lose"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:E.goal==="maintain"?"active":"",onClick:()=>{O(T=>({...T,goal:"maintain"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:E.goal==="build"?"active":"",onClick:()=>{O(T=>({...T,goal:"build"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),E.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:E.deficitLevel==="light"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"light"})),U(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="moderate"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"moderate"})),U(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="harsh"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"harsh"})),U(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Kt,disabled:!en(),children:"Calculate Macros"})]}),G&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[dn("Protein","Protein",G.protein,G.protein,"ring-protein"),dn("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),dn("Fats","Fats",G.fats,G.fats,"ring-fats"),dn("Calories","Calories",G.calories,G.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[G.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[G.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[G.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:nn,children:"Set as My Daily Targets"})]})]}),pt&&a.jsx("div",{className:`toast-notification ${pt.type}`,children:pt.message})]});const er=T=>{const C=new Date(T+"T12:00:00"),K=C.getDay(),ee=new Date(C);ee.setDate(C.getDate()-(K+6)%7);const Ue=[];for(let Ve=0;Ve<7;Ve++){const Pe=new Date(ee);Pe.setDate(ee.getDate()+Ve),Ue.push(Pe.toISOString().split("T")[0])}return Ue},bs=["M","T","W","T","F","S","S"],Ms=(T,C="search")=>{M(T),C==="scan"?(Se("scan"),yn(null)):C==="manual"?(Se("manual"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):C==="favourites"?Se("favourites"):(Se("search"),Je([]),et(""))},Cn=er(V),F=new Date(V+"T12:00:00"),ue=`${st[F.getMonth()]} ${F.getFullYear()}`;return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),U(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(V+"T12:00:00");T.setDate(T.getDate()-7);const C=T.toISOString().split("T")[0];te(C)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{I(!Le),D({year:F.getFullYear(),month:F.getMonth()})},children:ue}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(V+"T12:00:00");T.setDate(T.getDate()+7);const C=T.toISOString().split("T")[0];C<=Bi()&&te(C)},"aria-label":"Next week",disabled:Cn[6]>=Bi(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Cn.map((T,C)=>{const K=new Date(T+"T12:00:00").getDate(),ee=T===V,Ue=T>Bi(),Ve=T===Bi();return a.jsxs("button",{className:`nut-week-day${ee?" selected":""}${Ve?" today":""}${Ue?" future":""}`,disabled:Ue,onClick:()=>te(T),children:[a.jsx("span",{className:"nut-week-day-letter",children:bs[C]}),a.jsx("span",{className:"nut-week-day-num",children:K})]},T)})})]}),Le&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>D(T=>{let C=T.month-1,K=T.year;return C<0&&(C=11,K--),{year:K,month:C}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[st[L.month]," ",L.year]}),a.jsx("button",{onClick:()=>D(T=>{let C=T.month+1,K=T.year;return C>11&&(C=0,K++),{year:K,month:C}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:qe.map(T=>a.jsx("span",{children:T},T))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(nt(L.year,L.month))].map((T,C)=>a.jsx("span",{},`e${C}`)),[...Array(We(L.year,L.month))].map((T,C)=>{const K=C+1,ee=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(K).padStart(2,"0")}`,Ue=ee>Bi(),Ve=ee===V,Pe=ee===Bi();return a.jsx("button",{className:`nut-cal-day${Ve?" selected":""}${Pe?" today":""}${Ue?" future":""}`,disabled:Ue,onClick:()=>{te(ee),I(!1)},children:K},K)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[dn("Protein","Protein",Ee.protein,x.protein,"ring-protein"),dn("Carbs","Carbs",Ee.carbs,x.carbs,"ring-carbs"),dn("Fats","Fats",Ee.fats,x.fats,"ring-fats"),dn("Calories","kCal",Ee.calories,x.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Ge&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>R(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[X.water," / ",x?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:f2.map(T=>{const C=X.entries.filter(ee=>(ee.meal||"snacks")===T.key),K=C.reduce((ee,Ue)=>({protein:ee.protein+(Ue.protein||0),carbs:ee.carbs+(Ue.carbs||0),fats:ee.fats+(Ue.fats||0),calories:ee.calories+(Ue.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${T.key}`,children:U3[T.key]}),a.jsx("span",{className:"nut-meal-card-title",children:T.label}),C.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[K.calories," cal"]}),Ge&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>wt(Fe===T.key?null:T.key),"aria-label":`Add to ${T.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),C.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?K.protein/x.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?K.carbs/x.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?K.fats/x.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?K.calories/x.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:K.calories})]})]}),C.length>0&&a.jsx("div",{className:"nut-log-list",children:C.map(ee=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ee.name}),ee.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ee.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ee.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ee.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ee.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ee.calories})]}),Ge&&a.jsx("button",{className:"nut-log-delete",onClick:()=>Dn(ee.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))}),C.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Ge?"Tap + to add food":"No entries"})})]},T.key)})})})]})}),Fe&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>wt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",f2.find(T=>T.key===Fe)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const T=Fe;wt(null),Ms(T,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const T=Fe;wt(null),Ms(T,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const T=Fe;wt(null),Ms(T,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const T=Fe;wt(null),Ms(T,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),j&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>R(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>R(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((T,C)=>a.jsx("div",{className:`nut-water-glass ${C<X.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:C<X.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},C))}),a.jsxs("div",{className:"nut-water-popup-count",children:[X.water," / ",x?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:Rt,disabled:X.water<=0,children:"-"}),a.jsx("button",{onClick:ot,children:"+"})]})]})]})}),Y&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Hn(),P(null),Se(null),yn(null)},children:a.jsxs("div",{className:"nut-modal",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:Y==="scan"?"Scan Barcode":Y==="search"?"Search Food":Y==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{Hn(),P(null),Se(null),yn(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Y==="scan"&&!oe&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Oe&&!ae&&a.jsx("div",{className:"nut-scan-line"}),ae&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ae})]})]}),!Oe&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:vs,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Oe&&!ae&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:W,onChange:T=>ye(T.target.value),onKeyDown:T=>T.key==="Enter"&&W.trim()&&we(W.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>W.trim()&&we(W.trim()),disabled:!W.trim()||Ne,children:Ne?"...":"Look Up"})]})]}),Y==="scan"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=Ye==="portion"&&C?Bt*C.weight:parseFloat($t)||0,ee=K/100,Ue=T==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Ut(oe.name)?" active":""}`,onClick:()=>wn({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Ut(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{le("portion"),Bt<1&&ft(1)},children:"Portions"}),a.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{le("weight"),Et(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),Ye==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Pe=>Et(Pe.target.value),onFocus:Pe=>Pe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ue.map(Pe=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Pe)?" active":""}`,onClick:()=>Et(String(Pe)),children:[Pe,T]},Pe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ee),"p / ",Math.round(oe.carbs*ee),"c / ",Math.round(oe.fats*ee),"f / ",Math.round(oe.calories*ee)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{yn(null),Se("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xn({name:oe.name,protein:Math.round(oe.protein*ee),carbs:Math.round(oe.carbs*ee),fats:Math.round(oe.fats*ee),calories:Math.round(oe.calories*ee),serving:Ve}),children:"Add"})]})]})})(),Y==="search"&&!oe&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:xe,value:ke,onChange:T=>et(T.target.value),onKeyDown:T=>{T.key==="Enter"&&(clearTimeout(ce.current),pe())},onFocus:()=>setTimeout(()=>xe.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:pe,disabled:Ht,children:Ht?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[gt.map((T,C)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{yn(T),T.portion?(ft(1),Et(String(T.portion.weight)),le("portion")):(ft(0),Et(String(T.servingValue||100)),le("weight"))},children:[T.image&&a.jsx("img",{src:T.image,alt:T.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:T.name}),T.brand&&a.jsx("span",{className:"nut-search-item-brand",children:T.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[T.calories," cal  ",T.protein,"p  ",T.carbs,"c  ",T.fats,"f per 100",T.servingUnit||"g"]})]})]},C)),gt.length===0&&ke&&!Ht&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),Y==="search"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=Ye==="portion"&&C?Bt*C.weight:parseFloat($t)||0,ee=K/100,Ue=T==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Ut(oe.name)?" active":""}`,onClick:()=>wn({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Ut(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{le("portion"),Bt<1&&ft(1)},children:"Portions"}),a.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{le("weight"),Et(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),Ye==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Pe=>Et(Pe.target.value),onFocus:Pe=>Pe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ue.map(Pe=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Pe)?" active":""}`,onClick:()=>Et(String(Pe)),children:[Pe,T]},Pe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ee),"p / ",Math.round(oe.carbs*ee),"c / ",Math.round(oe.fats*ee),"f / ",Math.round(oe.calories*ee)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>yn(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xn({name:oe.name,protein:Math.round(oe.protein*ee),carbs:Math.round(oe.carbs*ee),fats:Math.round(oe.fats*ee),calories:Math.round(oe.calories*ee),serving:Ve}),children:"Add"})]})]})})(),Y==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Nt.name,onChange:T=>Ct(C=>({...C,name:T.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Nt.serving,onChange:T=>Ct(C=>({...C,serving:T.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Nt.protein,onChange:T=>Ct(C=>({...C,protein:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Nt.carbs,onChange:T=>Ct(C=>({...C,carbs:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Nt.fats,onChange:T=>Ct(C=>({...C,fats:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Nt.calories,onChange:T=>Ct(C=>({...C,calories:T.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Nt.name.trim(),onClick:()=>Xn({name:Nt.name,protein:parseFloat(Nt.protein)||0,carbs:parseFloat(Nt.carbs)||0,fats:parseFloat(Nt.fats)||0,calories:parseFloat(Nt.calories)||0,serving:Nt.serving||""}),children:"Add Food"})]}),Y==="favourites"&&!oe&&(()=>{const T=Fn(),C=K=>{if(K.per100g){const ee=K.per100g;yn({name:K.name,brand:"",image:null,servingSize:K.serving||"100g",servingValue:100,servingUnit:K.servingUnit||"g",portion:K.portion||null,protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories,per100g:!0}),K.portion?(ft(1),Et(String(K.portion.weight)),le("portion")):(ft(0),Et("100"),le("weight"))}else Xn({name:K.name,protein:K.protein,carbs:K.carbs,fats:K.fats,calories:K.calories,serving:K.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:T.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:T.map((K,ee)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ue=>{Ue.stopPropagation(),wn(K)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>C(K),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:K.name}),a.jsx("span",{className:"nut-recent-item-serving",children:K.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[K.calories," cal"]})]})]},ee))})})})(),Y==="favourites"&&oe&&(()=>{const T=oe.servingUnit||"g",C=oe.portion,K=Ye==="portion"&&C?Bt*C.weight:parseFloat($t)||0,ee=K/100,Ue=T==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(K)}${T})`:`${Math.round(K)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${Ut(oe.name)?" active":""}`,onClick:()=>wn({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Ut(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{le("portion"),Bt<1&&ft(1)},children:"Portions"}),a.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{le("weight"),Et(String(Math.round(K)||100))},children:["Custom (",T,")"]})]}),Ye==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ft(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Pe=>Et(Pe.target.value),onFocus:Pe=>Pe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ue.map(Pe=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Pe)?" active":""}`,onClick:()=>Et(String(Pe)),children:[Pe,T]},Pe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ee),"p / ",Math.round(oe.carbs*ee),"c / ",Math.round(oe.fats*ee),"f / ",Math.round(oe.calories*ee)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>yn(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xn({name:oe.name,protein:Math.round(oe.protein*ee),carbs:Math.round(oe.carbs*ee),fats:Math.round(oe.fats*ee),calories:Math.round(oe.calories*ee),serving:Ve}),children:"Add"})]})]})})()]})}),a.jsx(Ma,{active:"nutrition"}),pt&&a.jsx("div",{className:`toast-notification ${pt.type}`,children:pt.message})]})}const m2="/login/assets/randomiser-glq9YJkL.jpg",q3="/login/assets/programme-card-workout-CnNzTYkz.webp",H3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",$3="/login/assets/mg-arms-BeOQU3wx.jpg",W3=60,zp=5,G3=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],K3={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},Y3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},Q3={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Fp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},qp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:H3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],$c=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:$3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],p2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},g2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Hp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Sl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],X3=[5,10,15,20,30];function J3(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function Z3(s){const e=[...s];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function eD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=w.useState("menu"),[x,k]=w.useState(["bodyweight"]),[E,O]=w.useState("core"),[G,U]=w.useState("intermediate"),[V,te]=w.useState(15),[X,me]=w.useState([]),[Ee,ze]=w.useState(!1),Le=w.useRef(!1),I=w.useRef([]),[j,R]=w.useState([]),[L,D]=w.useState(2),[z,M]=w.useState(Sl[1]),[Fe,wt]=w.useState(1),[Y,Se]=w.useState(0),[Oe,ht]=w.useState("work"),[ae,P]=w.useState(0),[W,ye]=w.useState(!1),[Ne,Be]=w.useState(0),[ke,et]=w.useState(null),gt=w.useRef(null);w.useRef(null),w.useRef(null);const[Je,Ht]=w.useState(null),hn=w.useCallback((H,de="info")=>{Ht({message:H,type:de}),setTimeout(()=>Ht(null),3e3)},[]),[Nt,Ct]=w.useState(null),[oe,yn]=w.useState(null),[$t,Et]=w.useState(0),[Bt,ft]=w.useState(0),[Ye,le]=w.useState([]),[He,tt]=w.useState(""),[pt,Dt]=w.useState(""),[at,St]=w.useState(!1),[ce,xe]=w.useState(0),[Ie,Qe]=w.useState(!1),[Ge,We]=w.useState({}),nt=w.useRef(null),st=w.useRef(null),[qe,Kt]=w.useState([]),[nn,en]=w.useState(null),[Nn,Fn]=w.useState(0),[Ut,wn]=w.useState(0),[Xn,Dn]=w.useState(0),[us,vs]=w.useState(0),[Hn,hs]=w.useState(0),[ds,Ns]=w.useState(0),[Is,Os]=w.useState({beginner:0,intermediate:0,advanced:0}),[q,ge]=w.useState(null),[we,ve]=w.useState(""),[pe,ot]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!n)return;(async()=>{try{const de=Jt(_e,"workoutLogs"),re=Mn(de,xn("clientId","==",n.id)),De=(await Tn(re)).docs.map(pn=>pn.data()),rt=De.filter(pn=>pn.type!=="programme");vs(rt.length);const At=rt.reduce((pn,$n)=>pn+($n.duration||0),0);hs(At);const ct={beginner:0,intermediate:0,advanced:0};rt.forEach(pn=>{pn.level&&ct[pn.level]!==void 0&&ct[pn.level]++}),Os(ct);const tn=new Date,Rn=tn.getDay(),fn=Rn===0?-6:1-Rn,mn=new Date(tn);mn.setDate(tn.getDate()+fn),mn.setHours(0,0,0,0);const xr=mn.getTime(),La=De.filter(pn=>{const $n=pn.completedAt;return $n?($n.toDate?$n.toDate().getTime():new Date($n).getTime())>=xr:!1});Fn(La.filter(pn=>pn.type!=="programme").length);let Jr=0;if(n)try{const pn=await Qn(Ke(_e,"clientProgrammes",n.id));if(pn.exists()){const $n=pn.data(),Bn=$n.templateId;Jr=La.filter(Cs=>Cs.type==="programme"&&Cs.programmeId===Bn).length,ge(Bn);const _r=qp.find(Cs=>Cs.id===Bn);_r&&ve(_r.name);const cr=Y3[Bn];if(cr){const Cs=Object.keys($n.completedSessions||{}).length,Ds=cr.duration*cr.daysPerWeek;Dn(Ds>0?Math.round(Cs/Ds*100):0)}}else ge(null),ve(""),Dn(0)}catch{}wn(Jr);const wr=rt.map(pn=>pn.completedAt).filter(Boolean).map(pn=>pn.toDate?pn.toDate().getTime():new Date(pn).getTime()).sort((pn,$n)=>$n-pn);if(wr.length===0)Ns(0);else{const pn=new Set;wr.forEach(Ds=>{const Lr=new Date(Ds),kr=Lr.getDay(),pa=kr===0?-6:1-kr,A=new Date(Lr);A.setDate(Lr.getDate()+pa),A.setHours(0,0,0,0),pn.add(A.getTime())});const $n=[...pn].sort((Ds,Lr)=>Lr-Ds);let Bn=0;const _r=new Date(tn),cr=tn.getDay()===0?-6:1-tn.getDay();_r.setDate(tn.getDate()+cr),_r.setHours(0,0,0,0);let Cs=_r.getTime();$n.includes(Cs)||(Cs-=10080*60*1e3);for(let Ds=0;Ds<200&&$n.includes(Cs);Ds++)Bn++,Cs-=10080*60*1e3;Ns(Bn)}}catch(de){console.error("Error loading workout stats:",de)}finally{ot(!0)}})()},[s,n,g]);const Rt=()=>{const H=[];let de;E==="mix"?de=["core","upper","lower"]:E==="fullbody"?de=["upper","lower"]:de=[E];for(const re of x)for(const Ce of de)H.push(`exercises/${re}/${Ce}`);return H},ut=async()=>{if(Le.current){for(;Le.current;)await new Promise(H=>setTimeout(H,200));return I.current}Le.current=!0,ze(!0);try{const H=Rt(),de=[];for(const rt of H)try{const At=Gi(Ki,rt),ct=await h2(At);de.push(...ct.items)}catch{console.warn(`Folder ${rt} not found, skipping.`)}if(de.length===0&&x.includes("bodyweight")&&E==="core")try{const rt=Gi(Ki,"core"),At=await h2(rt);de.push(...At.items)}catch{console.warn("Legacy core/ folder not found either.")}if(de.length===0){const rt=x.map(ct=>g2.find(tn=>tn.key===ct)?.label).join(" + "),At=Hp.find(ct=>ct.key===E)?.label;return hn(`No exercises found for ${rt} / ${At}. Upload videos to Firebase Storage.`,"error"),Le.current=!1,ze(!1),[]}const re=new Set,Ce=de.filter(rt=>{const At=rt.name.replace(/\.(mp4|gif)$/i,"");return re.has(At)?!1:(re.add(At),!0)}),De=await Promise.all(Ce.map(async rt=>{const At=await Oo(rt),ct=J3(rt.name.replace(/\.(mp4|gif)$/i,"")),tn=/\.gif$/i.test(rt.name);return{name:ct,videoUrl:At,isGif:tn}}));return I.current=De,me(De),Le.current=!1,ze(!1),De}catch(H){console.error("Error loading exercises:",H);const de=H.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${H.message||H.code||"Unknown error"}`;return hn(de,"error"),Le.current=!1,ze(!1),[]}},_t=async()=>{y("spinning"),I.current=[];const H=await ut();if(H.length===0){y("setup");return}const de=Sl.find(Rn=>Rn.key===G);M(de);const re=de.work+de.rest,Ce=V*60,De=Math.floor(Ce/re);let rt,At;De<=6?(rt=Math.max(3,Math.floor(De/2)),At=Math.floor(De/rt)):De<=12?(rt=Math.min(6,Math.floor(De/2)),At=Math.floor(De/rt)):(rt=Math.min(10,Math.floor(De/2)),At=Math.floor(De/rt)),At=Math.max(2,At);const ct=Z3(H),tn=ct.slice(0,Math.min(rt,ct.length));R(tn),D(At),setTimeout(()=>y("preview"),2e3)},bt=()=>{y("countdown"),Be(3)};w.useEffect(()=>{if(g!=="countdown")return;if(Ne<=0){y("workout"),wt(1),Se(0),ht("work"),P(z.work),ye(!1),Ve();return}Ue();const H=setTimeout(()=>Be(de=>de-1),1e3);return()=>clearTimeout(H)},[Ne,g]),w.useEffect(()=>{if(g!=="workout"||W)return;if(ae<=0){dn();return}ae<=3&&Ue();const H=setTimeout(()=>P(de=>de-1),1e3);return()=>clearTimeout(H)},[ae,g,W]);const dn=()=>{if(Oe==="work")ht("rest"),P(z.rest);else{const H=Y+1;if(H>=j.length){const de=Fe+1;if(de>L){y("complete"),er();return}wt(de),Se(0)}else Se(H);ht("work"),P(z.work),Ve()}},er=async()=>{if(s)try{await ri(Jt(_e,"workoutLogs"),{clientId:n.id,level:G,duration:V,equipment:x,focus:E,exerciseCount:j.length,rounds:L,exercises:j.map(H=>H.name),completedAt:xt.now()}),Fn(H=>H+1),vs(H=>H+1),hs(H=>H+V),Os(H=>({...H,[G]:(H[G]||0)+1}))}catch(H){console.error("Error saving workout log:",H)}},bs=async(H,de,re)=>{if(!(!n||!de))try{const Ce=n.id,De=await Qn(Ke(_e,"coreBuddyPBs",Ce)),At=(De.exists()?De.data():null)?.exercises||{},ct=At[H];let tn=!1;if(ct?(de>(ct.weight||0)||de===(ct.weight||0)&&re>(ct.reps||0))&&(tn=!0):tn=!0,tn){const Rn={...At,[H]:{weight:de,reps:re,achievedAt:xt.now()}};await Vn(Ke(_e,"coreBuddyPBs",Ce),{clientId:n.id,exercises:Rn,updatedAt:xt.now()}),hn(`New PB! ${de}kg  ${re} reps`,"success"),Ue(),await Ms(H,de)}}catch(Ce){console.error("Error checking PB:",Ce)}},Ms=async(H,de)=>{if(n)try{const re=await Qn(Ke(_e,"coreBuddyTargets",n.id));if(!re.exists())return;const De=(re.data().targets||{})[H];if(!De||de<De.targetWeight)return;const rt=await Qn(Ke(_e,"coreBuddyAchievements",n.id)),At=rt.exists()?rt.data():{clientId:n.id,badges:[],totalVolume:0};if(At.badges.some(fn=>fn.type==="pb_target"&&fn.exercise===H&&fn.targetWeight===De.targetWeight))return;const tn={type:"pb_target",exercise:H,group:K3[H]||"push",targetWeight:De.targetWeight,achievedAt:xt.now()},Rn=[...At.badges,tn];await Vn(Ke(_e,"coreBuddyAchievements",n.id),{...At,badges:Rn,updatedAt:xt.now()}),Kt(fn=>[...fn,tn])}catch(re){console.error("Error checking target badge:",re)}},Cn=async H=>{if(!(!n||H<=0))try{const de=await Qn(Ke(_e,"coreBuddyAchievements",n.id)),re=de.exists()?de.data():{clientId:n.id,badges:[],totalVolume:0},Ce=re.totalVolume||0,De=Ce+H,rt=[];G3.forEach(ct=>{De>=ct.threshold&&Ce<ct.threshold&&(re.badges.some(Rn=>Rn.type==="volume_milestone"&&Rn.milestone===ct.threshold)||rt.push({type:"volume_milestone",milestone:ct.threshold,label:ct.label,achievedAt:xt.now()}))});const At=[...re.badges,...rt];await Vn(Ke(_e,"coreBuddyAchievements",n.id),{clientId:n.id,badges:At,totalVolume:Math.round(De),updatedAt:xt.now()}),rt.length>0&&Kt(ct=>[...ct,...rt])}catch(de){console.error("Error updating volume:",de)}},F=async H=>{if(yn(H),H.interval){const Ce=[];for(const De of H.exercises){let rt=null,At=!1;if(De.storagePath)try{const ct=Gi(Ki,De.storagePath);rt=await Oo(ct),At=/\.gif$/i.test(De.storagePath)}catch{}Ce.push({name:De.name,videoUrl:rt,isGif:At})}R(Ce),D(H.rounds),M({work:H.work,rest:H.rest}),y("preview");return}const de={};for(const Ce of H.exercises)if(Ce.storagePath)try{const De=Gi(Ki,Ce.storagePath);de[Ce.name]={url:await Oo(De),isGif:/\.gif$/i.test(Ce.storagePath)}}catch{}We(de);const re=H.exercises.map(Ce=>({name:Ce.name,type:Ce.type,targetSets:Ce.sets,targetReps:Ce.reps||0,targetTime:Ce.time||0,sets:[]}));le(re),Et(0),ft(0),tt(""),Dt(""),Qe(!1),St(!1),xe(0),Kt([]),en(null),y("muscle_workout")},ue=()=>{const H=nt.current;H&&(H.paused?(H.play(),Qe(!0)):(H.pause(),Qe(!1)))};w.useEffect(()=>{if(g!=="muscle_workout"||!at||ce<=0){g==="muscle_workout"&&at&&ce<=0&&(St(!1),Ue());return}return st.current=setTimeout(()=>xe(H=>H-1),1e3),()=>clearTimeout(st.current)},[g,at,ce]);const T=async()=>{const H=Ye[$t];let de={};if(H.type==="weighted"){const De=parseFloat(He)||0,rt=parseInt(pt)||0;if(rt===0){hn("Enter your reps","error");return}de={weight:De,reps:rt}}else if(H.type==="reps"){const De=parseInt(pt)||0;if(De===0){hn("Enter your reps","error");return}de={reps:De}}else if(H.type==="timed"){const De=H.targetTime-ce;de={time:Math.max(De,1)}}const re=[...Ye];re[$t]={...H,sets:[...H.sets,de]},le(re),H.type==="weighted"&&de.weight>0&&await bs(H.name,de.weight,de.reps);const Ce=H.sets.length+1;if(Ce<H.targetSets)ft(Ce),Dt(""),St(!1),xe(0);else if($t+1<Ye.length){const De=$t+1;Et(De),ft(0),tt(""),Dt(""),Qe(!1),St(!1),xe(0)}else await C(re),y("muscle_complete")},C=async H=>{if(!(!s||!n))try{const de=H.reduce((Ce,De)=>Ce+De.sets.reduce((rt,At)=>rt+(At.weight||0)*(At.reps||0),0),0),re=H.reduce((Ce,De)=>Ce+De.sets.length,0);await ri(Jt(_e,"workoutLogs"),{clientId:n.id,type:"muscle_group",muscleGroup:Nt,sessionId:oe?.id,sessionName:oe?.name,exerciseCount:H.length,totalSets:re,duration:Math.round(re*1.5),volume:Math.round(de),exercises:H.map(Ce=>({name:Ce.name,type:Ce.type,sets:Ce.sets})),completedAt:xt.now()}),de>0&&await Cn(de),qe.length>0&&en({badges:[...qe]})}catch(de){console.error("Error saving muscle group workout log:",de)}},K=w.useRef(null),ee=()=>(K.current||(K.current=new(window.AudioContext||window.webkitAudioContext)),K.current),Ue=()=>{try{const H=ee(),de=H.createOscillator(),re=H.createGain();de.connect(re),re.connect(H.destination),de.frequency.value=880,re.gain.value=.3,de.start(H.currentTime),de.stop(H.currentTime+.15)}catch{}},Ve=()=>{try{const H=ee(),de=H.createOscillator(),re=H.createGain();de.connect(re),re.connect(H.destination),de.frequency.value=1200,re.gain.value=.4,de.start(H.currentTime),de.stop(H.currentTime+.3)}catch{}};w.useEffect(()=>{if(g!=="workout"||Oe!=="work"||!j[Y]?.isGif)return;const de=setInterval(()=>{const re=gt.current;if(!re)return;const Ce=re.getAttribute("src");re.removeAttribute("src"),setTimeout(()=>{gt.current&&gt.current.setAttribute("src",Ce)},0)},4e3);return()=>clearInterval(de)},[g,Oe,Y,Fe,j]);const Pe=(H,de,re)=>{const Ce=Math.round(H/de*W3);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:M3.map((De,rt)=>a.jsx("line",{x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,className:rt<Ce?`wk-tick-filled ${re}`:"wk-tick-empty",strokeWidth:De.thick?"3":"2"},rt))})},Vt=()=>{const H=j.length*L;return((Fe-1)*j.length+Y+(Oe==="rest"?.5:0))/H},kt=Je&&a.jsx("div",{className:`toast-notification ${Je.type}`,children:Je.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(g==="menu")return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>y("setup"),children:a.jsx("img",{src:m2,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[qp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:qp.map((H,de)=>H.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:H.id}}),style:{animationDelay:`${de*.06}s`},children:[a.jsx("img",{src:H.image,alt:H.name,className:"wk-prog-img"}),de===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},H.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:H.id}}),style:{animationDelay:`${de*.06}s`},children:[a.jsx("img",{src:q3,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:Q3[H.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[H.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:H.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:H.name.toUpperCase()}),a.jsxs("p",{children:[H.daysPerWeek,"x per week  ",H.focus==="fullbody"?"Full Body":H.focus.charAt(0).toUpperCase()+H.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),de===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},H.id))})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[$c.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:$c.map((H,de)=>a.jsx("button",{className:`wk-muscle-hero-card${H.image?" wk-muscle-thumb":""}`,onClick:()=>{Ct(H.key),y("muscle_sessions")},style:{animationDelay:`${de*.05}s`},children:H.image?a.jsx("img",{src:H.image,alt:H.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:m2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Fp[H.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:H.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:H.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[p2[H.key]?.length||0," sessions"]})]})]})]})},H.key))})]}),a.jsx(Ma,{active:"workouts"}),kt]});if(g==="setup"){const H=Hp.find(re=>re.key===E)?.label||E,de=Sl.find(re=>re.key===G)?.label||G;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${us}`,pct:us>0?Math.min(Math.round(us/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Nn}/${zp}`,pct:Math.round(Math.min(Nn,zp)/zp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${ds}`,pct:ds>0?Math.min(Math.round(ds/12*100),100):0,color:"#38B6FF",size:"normal"}].map(re=>{const De=2*Math.PI*38,rt=De-re.pct/100*De;return a.jsxs("div",{className:`wk-stat-item${re.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:re.color},strokeDasharray:De,strokeDashoffset:rt})]}),a.jsx("span",{className:"wk-stat-value",style:{color:re.color},children:re.value})]}),a.jsx("span",{className:"wk-stat-label",children:re.label})]},re.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Hp.map(re=>a.jsxs("button",{className:`wk-equip-btn${E===re.key?" active":""}${re.key==="mix"?" wk-mix-btn":""}`,onClick:()=>O(re.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:re.icon})}),a.jsx("span",{children:re.label})]},re.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Sl.map(re=>a.jsxs("button",{className:`wk-level-card wk-level-${re.key}${G===re.key?" active":""}`,onClick:()=>U(re.key),children:[a.jsx("span",{className:"wk-level-name",children:re.label}),a.jsx("span",{className:"wk-level-desc",children:re.desc})]},re.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:X3.map(re=>a.jsxs("button",{className:`wk-time-btn${V===re?" active":""}`,onClick:()=>te(re),children:[a.jsx("span",{className:"wk-time-num",children:re}),a.jsx("span",{className:"wk-time-unit",children:"min"})]},re))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:g2.map(re=>{const Ce=x.includes(re.key);return a.jsxs("button",{className:`wk-equip-btn${Ce?" active":""}`,onClick:()=>{k(De=>Ce&&De.length===1?De:Ce?De.filter(rt=>rt!==re.key):[...De,re.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:re.icon})}),a.jsx("span",{children:re.label})]},re.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[H,"  ",de,"  ",V," min"]})})]})]}),a.jsx("div",{className:"wk-go-sticky",children:a.jsx("button",{className:"wk-randomise-btn",onClick:_t,disabled:Ee,children:Ee?"Loading exercises...":"Randomise Workout"})}),kt]})}if(g==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:au.map((H,de)=>a.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:"wk-spin-tick",strokeWidth:H.thick?"3.5":"2",style:{animationDelay:`${de*.03}s`}},de))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),kt]});if(g==="preview"){const H=oe?.interval?{work:oe.work,rest:oe.rest}:Sl.find(re=>re.key===G),de=j.length*L*(H.work+H.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y(oe?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[oe?.interval&&a.jsx("h2",{className:"mg-preview-title",children:oe.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:j.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(de/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[H.work,"/",H.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:j.map((re,Ce)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ce*.06}s`},onClick:()=>et(re),children:[a.jsx("span",{className:"wk-preview-num",children:Ce+1}),a.jsx("div",{className:"wk-preview-thumb",children:re.isGif?a.jsx("img",{src:re.videoUrl,alt:re.name,loading:"lazy"}):a.jsx("video",{src:`${re.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:re.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ce))}),ke&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>et(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:re=>re.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>et(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:ke.isGif?a.jsx("img",{src:ke.videoUrl,alt:ke.name}):a.jsx("video",{src:ke.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:ke.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!oe?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_t(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:bt,children:"Start Workout"})]})]})]})}if(g==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Ne}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(g==="workout"){const H=j[Y],de=Oe==="work"?z.work:z.rest,re=Oe==="rest"?Y+1<j.length?j[Y+1]:Fe<L?j[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"wk-video-container",children:Oe==="work"?H.isGif?a.jsx("img",{ref:gt,className:"wk-video",src:H.videoUrl,alt:H.name},H.videoUrl):a.jsx("video",{className:"wk-video",src:H.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},H.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),re&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",re.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&y("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Y+1," / ",j.length]}),a.jsx("h2",{className:"wk-exercise-name",children:H.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Fe," of ",L]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Pe(ae,de,Oe==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:ae}),a.jsx("span",{className:`wk-timer-phase ${Oe}`,children:Oe==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&y("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>ye(!W),children:W?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{P(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Vt()*100}%`}})})]})}if(g==="complete"){const H=Sl.find(re=>re.key===G),de=j.length*L*(H.work+H.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:au.map((re,Ce)=>a.jsx("line",{x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,className:"wk-tick-complete",strokeWidth:re.thick?"3.5":"2",style:{animationDelay:`${Ce*.02}s`}},Ce))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(de/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:j.length*L}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{yn(null),Ct(null),y("menu")},children:"Done"})})]})})}if(g==="muscle_sessions"){const H=$c.find(re=>re.key===Nt),de=p2[Nt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:Fp[Nt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:H?.icon})})}),a.jsxs("h2",{children:[H?.label," Workouts"]}),a.jsxs("p",{children:[de.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:de.map((re,Ce)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{yn(re),y("muscle_overview")},style:{animationDelay:`${Ce*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:re.name}),a.jsx("p",{children:re.desc}),a.jsx("div",{className:"mg-session-meta",children:re.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[re.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[re.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[re.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const De=re.exercises.map(ct=>ct.sets||0),rt=Math.min(...De),At=Math.max(...De);return rt===At?`${rt} sets each`:`${rt}-${At} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},re.id))})]}),kt]})}if(g==="muscle_overview"){const H=oe;if(!H)return null;const de=$c.find(re=>re.key===Nt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:Fp[Nt]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:de?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:H.name}),H.level&&a.jsx("span",{className:"mg-overview-level",children:H.level})]}),a.jsx("p",{className:"mg-overview-desc",children:H.desc})]}),H.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:H.overview})]}),H.tips&&H.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:H.tips.map((re,Ce)=>a.jsx("li",{children:re},Ce))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",H.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:H.exercises.map((re,Ce)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Ce+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:re.name}),H.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[H.work,"s work / ",H.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[re.sets," sets  ",re.reps?`${re.reps} reps`:`${re.time}s`,re.type==="weighted"&&"  weighted"]})]})]},Ce))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>F(H),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),kt]})}if(g==="muscle_workout"){const H=oe;if(!H)return null;const de=H.exercises[$t],re=Ye[$t];if(!de||!re)return null;const Ce=re.sets.length,De=H.exercises.length,rt=H.exercises.reduce((fn,mn)=>fn+(mn.sets||0),0),ct=Ye.reduce((fn,mn)=>fn+mn.sets.length,0)/rt*100,tn=Ge[de.name];de.type==="timed"&&ce===0&&!at&&Ce===Bt&&setTimeout(()=>xe(de.time),0);const Rn=Ce+1<de.sets?"Log Set":$t+1<De?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${ct}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&y("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",$t+1,"/",De]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[tn?a.jsxs("div",{className:"mg-video-container",onClick:ue,children:[tn.isGif?a.jsx("img",{className:"mg-video",src:tn.url,alt:de.name}):a.jsx("video",{ref:nt,className:"mg-video",src:tn.url,loop:!0,muted:!0,playsInline:!0},de.name),!Ie&&!tn.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:de.name}),a.jsx("span",{className:`mg-ex-type-badge ${de.type}`,children:de.type==="weighted"?"Weight + Reps":de.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ce+1," of ",de.sets]}),de.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",de.reps," reps"]}),de.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",de.time,"s"]})]}),de.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:He,onChange:fn=>tt(fn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:pt,onChange:fn=>Dt(fn.target.value),placeholder:"0"})]})]}),de.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:pt,onChange:fn=>Dt(fn.target.value),placeholder:"0"})]})}),de.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[ce,"s"]})}),at?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>St(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{ce===0&&xe(de.time),St(!0)},children:ce<de.time&&ce>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:T,children:Rn}),re.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:re.sets.map((fn,mn)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",mn+1,": ",fn.weight!=null?`${fn.weight}kg  ${fn.reps}`:fn.reps!=null?`${fn.reps} reps`:`${fn.time}s`]})]},mn))})]})]}),kt]})}if(g==="muscle_complete"){const H=Ye.reduce((Ce,De)=>Ce+De.sets.length,0),de=Ye.reduce((Ce,De)=>Ce+De.sets.reduce((rt,At)=>rt+(At.weight||0)*(At.reps||0),0),0),re=$c.find(Ce=>Ce.key===Nt)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:au.map((Ce,De)=>a.jsx("line",{x1:Ce.x1,y1:Ce.y1,x2:Ce.x2,y2:Ce.y2,className:"wk-tick-complete",strokeWidth:Ce.thick?"3.5":"2",style:{animationDelay:`${De*.02}s`}},De))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[re," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:oe?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Ye.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:H}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),de>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(de).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{yn(null),Ct(null),en(null),y("menu")},children:"Done"})})]}),nn&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>en(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:nn.badges.length===1?"Badge Earned!":`${nn.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:nn.badges.map((Ce,De)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Ce.type==="pb_target"?`${Ce.exercise}  ${Ce.targetWeight}kg`:Ce.label},De))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const tD=60,nD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},sD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],y2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function ad(s,e,n){const i=s.baseReps?s.baseReps+(e-1)*(n.repProg||0):void 0,l=s.baseTime?s.baseTime+(e-1)*(n.timeProg||0):void 0;return{sets:s.sets,reps:i,time:l}}const rD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function aD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),g=ma(),[y,x]=w.useState("loading"),[k,E]=w.useState(null),O=w.useRef(!1),[G,U]=w.useState(null),[V,te]=w.useState(1),[X,me]=w.useState(0),[Ee,ze]=w.useState(0),[Le,I]=w.useState(0),[j,R]=w.useState([]),[L,D]=w.useState(""),[z,M]=w.useState(""),[Fe,wt]=w.useState(!1),[Y,Se]=w.useState(0),Oe=w.useRef(null),[ht,ae]=w.useState({}),[P,W]=w.useState(!1),ye=w.useRef(null),[Ne,Be]=w.useState(null),[ke,et]=w.useState([]);w.useEffect(()=>{window.scrollTo(0,0)},[y]);const[gt,Je]=w.useState(null),Ht=w.useCallback((ce,xe="info")=>{Je({message:ce,type:xe}),setTimeout(()=>Je(null),4e3)},[]),hn=w.useRef(null),Nt=()=>(hn.current||(hn.current=new(window.AudioContext||window.webkitAudioContext)),hn.current),Ct=()=>{try{const ce=Nt(),xe=ce.createOscillator(),Ie=ce.createGain();xe.connect(Ie),Ie.connect(ce.destination),xe.frequency.value=1200,Ie.gain.value=.4,xe.start(ce.currentTime),xe.stop(ce.currentTime+.3)}catch{}};w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!n)return;(async()=>{try{const xe=Ke(_e,"clientProgrammes",n.id),Ie=await Qn(xe);Ie.exists()?(U(Ie.data()),x("dashboard")):g.state?.templateId?x("browse"):p("/client/core-buddy/workouts",{replace:!0})}catch(xe){console.error("Error loading programme:",xe),p("/client/core-buddy/workouts",{replace:!0})}})()},[n]),w.useEffect(()=>{if(O.current||y==="loading")return;const ce=g.state?.templateId;if(!ce)return;const xe=y2.find(Ie=>Ie.id===ce);xe&&(O.current=!0,E(xe),x("overview"))},[y,g.state]),w.useEffect(()=>{if(!Fe||Y<=0){Fe&&Y<=0&&(wt(!1),Ct());return}return Oe.current=setTimeout(()=>Se(ce=>ce-1),1e3),()=>clearTimeout(Oe.current)},[Fe,Y]);const oe=async ce=>{if(n)try{await Vn(Ke(_e,"clientProgrammes",n.id),ce),U(ce)}catch(xe){console.error("Error saving programme:",xe),Ht("Failed to save. Check Firestore rules for clientProgrammes.","error")}},yn=async ce=>{const xe={templateId:ce.id,startDate:xt.now(),completedSessions:{}};await oe(xe),x("dashboard")},$t=async()=>{if(n)try{await ar(Ke(_e,"clientProgrammes",n.id)),U(null),x("browse")}catch(ce){console.error("Error quitting programme:",ce)}},Et=()=>G?y2.find(ce=>ce.id===G.templateId):null,Bt=()=>{if(!G)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ce=G.completedSessions||{},xe=Object.keys(ce).length,Ie=Et();if(!Ie)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Qe=Ie.duration*Ie.daysPerWeek,Ge=Math.min(Math.floor(xe/Ie.daysPerWeek)+1,Ie.duration),We=xe-(Ge-1)*Ie.daysPerWeek;for(let nt=1;nt<=Ie.duration;nt++)for(let st=0;st<Ie.daysPerWeek;st++){const qe=`w${nt}d${st}`;if(!ce[qe])return{currentWeek:nt,completedThisWeek:We,nextDay:st,nextWeek:nt,totalCompleted:xe,totalSessions:Qe}}return{currentWeek:Ie.duration,completedThisWeek:Ie.daysPerWeek,nextDay:-1,totalCompleted:xe,totalSessions:Qe,complete:!0}},ft=(ce,xe,Ie)=>{if(!G||ce<=1)return null;const Qe=`w${ce-1}d${xe}`,Ge=G.completedSessions?.[Qe];if(!Ge)return null;const We=Ge.exercises?.find(nt=>nt.name===Ie);return We?.sets?.length?We.sets[We.sets.length-1]:null},Ye=(ce,xe)=>{const Ie=Et();if(!Ie)return;te(ce),me(xe),ze(0),I(0),R([]),M(""),wt(!1),Se(0),W(!1),ae({});const Qe=Ie.days[xe],Ge=Qe.exercises.map(qe=>{const Kt=ad(qe,ce,Ie);return{name:qe.name,type:qe.type,pbKey:qe.pbKey,targetSets:Kt.sets,targetReps:Kt.reps,targetTime:Kt.time,sets:[]}});R(Ge);const We=Qe.exercises[0],nt=ft(ce,xe,We.name);nt?.weight&&We.type==="weighted"?D(String(nt.weight)):D(""),(async()=>{const qe={};for(const Kt of Qe.exercises)if(Kt.storagePath)try{const nn=Gi(Ki,Kt.storagePath),en=await Oo(nn);qe[Kt.name]={url:en,isGif:/\.gif$/i.test(Kt.storagePath)}}catch(nn){console.warn(`Video not found for ${Kt.name}:`,nn)}ae(qe)})(),x("session")},le=async()=>{Et();const ce=j[Ee];if(!ce)return;let xe={};if(ce.type==="weighted"){const Ge=parseFloat(L)||0,We=parseInt(z)||0;if(We===0){Ht("Enter your reps","error");return}xe={weight:Ge,reps:We}}else if(ce.type==="reps"){const Ge=parseInt(z)||0;if(Ge===0){Ht("Enter your reps","error");return}xe={reps:Ge}}else if(ce.type==="timed"){const Ge=ce.targetTime-Y;xe={time:Math.max(Ge,1)}}const Ie=[...j];Ie[Ee]={...ce,sets:[...ce.sets,xe]},R(Ie),ce.type==="weighted"&&xe.weight>0&&await pt(ce.name,xe.weight,xe.reps);const Qe=ce.sets.length+1;if(Qe<ce.targetSets)I(Qe),D(xe.weight?String(xe.weight):""),M(""),wt(!1),Se(0);else if(Ee+1<j.length){const Ge=Ee+1;ze(Ge),I(0),W(!1);const nt=Et()?.days[X]?.exercises[Ge],st=ft(V,X,nt?.name);st?.weight&&nt?.type==="weighted"?D(String(st.weight)):D(""),M(""),wt(!1),Se(0)}else await He(Ie)},He=async ce=>{if(!G||!n)return;const xe=`w${V}d${X}`,Ie={...G.completedSessions,[xe]:{completedAt:new Date().toISOString(),exercises:ce.map(We=>({name:We.name,type:We.type,sets:We.sets}))}},Qe={...G,completedSessions:Ie};await oe(Qe);const Ge=ce.reduce((We,nt)=>We+nt.sets.reduce((st,qe)=>st+(qe.weight||0)*(qe.reps||0),0),0);Ge>0&&await tt(Ge);try{const We=Et();await ri(Jt(_e,"workoutLogs"),{clientId:n.id,type:"programme",programmeId:We?.id,programmeName:We?.name,week:V,day:X+1,exerciseCount:ce.length,duration:Math.round(ce.reduce((nt,st)=>nt+st.sets.length*1.5,0)),volume:Math.round(Ge),completedAt:xt.now()})}catch(We){console.error("Error saving workout log:",We)}ke.length>0&&(Be({badges:[...ke]}),et([])),x("sessionComplete")},tt=async ce=>{if(n)try{const xe=await Qn(Ke(_e,"coreBuddyAchievements",n.id)),Ie=xe.exists()?xe.data():{clientId:n.id,badges:[],totalVolume:0},Qe=Ie.totalVolume||0,Ge=Qe+ce,We=[];sD.forEach(st=>{Ge>=st.threshold&&Qe<st.threshold&&(Ie.badges.some(Kt=>Kt.type==="volume_milestone"&&Kt.milestone===st.threshold)||We.push({type:"volume_milestone",milestone:st.threshold,label:st.label,achievedAt:xt.now()}))});const nt=[...Ie.badges,...We];await Vn(Ke(_e,"coreBuddyAchievements",n.id),{clientId:n.id,badges:nt,totalVolume:Math.round(Ge),updatedAt:xt.now()}),We.length>0&&et(st=>[...st,...We])}catch(xe){console.error("Error updating volume:",xe)}},pt=async(ce,xe,Ie)=>{if(n)try{const Qe=n.id,Ge=await Qn(Ke(_e,"coreBuddyPBs",Qe)),nt=(Ge.exists()?Ge.data():null)?.exercises||{},st=nt[ce];let qe=!1;if(st?(xe>(st.weight||0)||xe===(st.weight||0)&&Ie>(st.reps||0))&&(qe=!0):qe=!0,qe){const Kt={...nt,[ce]:{weight:xe,reps:Ie,achievedAt:xt.now()}};await Vn(Ke(_e,"coreBuddyPBs",Qe),{clientId:n.id,exercises:Kt,updatedAt:xt.now()}),Ht(`New PB! ${xe}kg  ${Ie} reps`,"success"),Ct(),await Dt(ce,xe)}}catch(Qe){console.error("Error checking PB:",Qe)}},Dt=async(ce,xe)=>{if(n)try{const Ie=await Qn(Ke(_e,"coreBuddyTargets",n.id));if(!Ie.exists())return;const Ge=(Ie.data().targets||{})[ce];if(!Ge||xe<Ge.targetWeight)return;const We=await Qn(Ke(_e,"coreBuddyAchievements",n.id)),nt=We.exists()?We.data():{clientId:n.id,badges:[],totalVolume:0};if(nt.badges.some(nn=>nn.type==="pb_target"&&nn.exercise===ce&&nn.targetWeight===Ge.targetWeight))return;const qe={type:"pb_target",exercise:ce,group:nD[ce]||"push",targetWeight:Ge.targetWeight,achievedAt:xt.now()},Kt=[...nt.badges,qe];await Vn(Ke(_e,"coreBuddyAchievements",n.id),{...nt,badges:Kt,updatedAt:xt.now()}),et(nn=>[...nn,qe])}catch(Ie){console.error("Error checking target badge:",Ie)}},at=gt&&a.jsxs("div",{className:`toast-notification ${gt.type}`,children:[gt.type==="success"&&a.jsx("span",{children:" "}),gt.message]}),St=(ce,xe)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:xe,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const ce=k;return a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[St(ce.name,()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:rD[ce.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:ce.name}),a.jsx("p",{className:"pg-overview-desc",children:ce.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:ce.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:ce.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:ce.duration*ce.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:ce.days.map((xe,Ie)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:xe.name}),a.jsx("span",{className:"pg-day-label",children:xe.label})]}),a.jsx("div",{className:"pg-day-exercises",children:xe.exercises.map((Qe,Ge)=>{const We=ad(Qe,1,ce);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:Qe.name}),a.jsx("span",{className:"pg-day-ex-target",children:Qe.type==="timed"?`${We.sets}${We.time}s`:`${We.sets}${We.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${Qe.type}`,children:Qe.type==="weighted"?"WT":Qe.type==="timed"?"TMR":"BW"})]},Ge)})})]},Ie))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",ce.repProg," reps/week",ce.timeProg?`, +${ce.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>yn(ce),children:"Start Programme"})]}),at]})}if(y==="dashboard"){const ce=Et();if(!ce)return x("browse"),null;const xe=Bt(),Ie=G?.completedSessions||{},Qe=xe.totalSessions?Math.round(xe.totalCompleted/xe.totalSessions*100):0;return Math.round(xe.totalCompleted/(xe.totalSessions||1)*tD),a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[St("Programme",()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Qe/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[Qe,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:ce.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[Qe,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",xe.currentWeek," of ",ce.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:ce.duration},(Ge,We)=>{const nt=We+1;return a.jsxs("div",{className:`pg-week-row${nt===xe.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",nt]}),a.jsx("div",{className:"pg-week-days",children:ce.days.map((st,qe)=>{const Kt=`w${nt}d${qe}`,nn=!!Ie[Kt],en=!xe.complete&&nt===xe.nextWeek&&qe===xe.nextDay;return a.jsx("button",{className:`pg-day-dot${nn?" done":""}${en?" next":""}`,disabled:nn,onClick:()=>{en&&Ye(nt,qe)},children:nn?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):a.jsx("span",{children:st.name.replace("Day ","")})},qe)})})]},We)})}),!xe.complete&&xe.nextDay>=0&&a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:"Next Session"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",xe.nextWeek,"  ",ce.days[xe.nextDay].name,": ",ce.days[xe.nextDay].label]}),a.jsx("div",{className:"pg-next-exercises",children:ce.days[xe.nextDay].exercises.map((Ge,We)=>{const nt=ad(Ge,xe.nextWeek,ce);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:Ge.name}),a.jsx("span",{className:"pg-next-ex-target",children:Ge.type==="timed"?`${nt.sets}${nt.time}s`:`${nt.sets}${nt.reps}`})]},We)})}),a.jsx("button",{className:"pg-start-btn",onClick:()=>Ye(xe.nextWeek,xe.nextDay),children:"Start Session"})]}),xe.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",xe.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:$t,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&$t()},children:"Quit Programme"})]}),a.jsx(Ma,{active:"workouts"}),at]})}if(y==="session"){const ce=Et();if(!ce)return null;const xe=ce.days[X],Ie=xe.exercises[Ee],Qe=ad(Ie,V,ce),Ge=j[Ee],We=Ge?.sets?.length||0,nt=xe.exercises.length,st=(Ee+We/Qe.sets)/nt,qe=ht[Ie.name],Kt=ft(V,X,Ie.name);Ie.type==="timed"&&Y===0&&!Fe&&We===Le&&setTimeout(()=>Se(Qe.time),0);const nn=()=>{qe?.isGif?W(!P):ye.current&&(P?ye.current.pause():ye.current.play(),W(!P))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${st*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&x("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[Ee+1," / ",nt]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",V,"  ",xe.name]})]})]}),qe&&a.jsxs("div",{className:"pg-video-container",onClick:nn,children:[qe.isGif?a.jsx("img",{className:"pg-video",src:qe.url,alt:Ie.name}):a.jsx("video",{ref:ye,className:"pg-video",src:qe.url,loop:!0,muted:!0,playsInline:!0},Ie.name),!P&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Ie.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Ie.type}`,children:Ie.type==="weighted"?"Weight + Reps":Ie.type==="timed"?"Timed":"Reps Only"}),Ie.type==="weighted"&&Kt&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Kt.weight,"kg x ",Kt.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",We+1," of ",Qe.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Ie.type==="timed"?`${Qe.time}s hold`:`${Qe.reps} reps`]})]}),Ie.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:L,onChange:en=>D(en.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:en=>M(en.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})]}),Ie.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:en=>M(en.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})}),Ie.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[Y,"s"]})}),Fe?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>wt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{Y===0&&Se(Qe.time),wt(!0)},children:Y<Qe.time&&Y>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:le,disabled:Ie.type==="timed"&&Fe,children:We+1<Qe.sets?"Log Set":Ee+1<nt?"Log Set  Next Exercise":"Log Set  Complete"}),Ge?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Ge.sets.map((en,Nn)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Nn+1,": ",en.weight!==void 0?`${en.weight}kg  ${en.reps}`:en.time!==void 0?`${en.time}s`:`${en.reps} reps`]})]},Nn))})]}),at]})}if(y==="sessionComplete"){const xe=Et()?.days[X],Ie=j.reduce((Ge,We)=>Ge+We.sets.length,0),Qe=j.reduce((Ge,We)=>Ge+We.sets.reduce((nt,st)=>nt+(st.weight||0)*(st.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:au.map((Ge,We)=>a.jsx("line",{x1:Ge.x1,y1:Ge.y1,x2:Ge.x2,y2:Ge.y2,className:"pg-tick-complete",strokeWidth:Ge.thick?"3.5":"2",style:{animationDelay:`${We*.02}s`}},We))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",V,"  ",xe?.name,": ",xe?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:j.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Ie}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),Qe>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(Qe).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>x("dashboard"),children:"Back to Programme"})]}),Ne&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>Be(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ge=>Ge.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Ne.badges.length===1?"Badge Earned!":`${Ne.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Ne.badges.map((Ge,We)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Ge.type==="pb_target"?`${Ge.exercise}  ${Ge.targetWeight}kg`:Ge.label},We))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>Be(null),children:"Tap to dismiss"})]})}),at]})}return null}const iD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},oD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},$p=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function lD(s){return iD[s]||"push"}function cD(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}T`:`${Math.round(s)}`}function uD(s){return s>=1e6?"million kg":s>=1e3?"tonnes":"kg"}function hD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=w.useState(!0),[x,k]=w.useState(null),[E,O]=w.useState({});w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!n)return;(async()=>{try{const[R,L]=await Promise.all([Qn(Ke(_e,"coreBuddyAchievements",n.id)),Qn(Ke(_e,"coreBuddyPBs",n.id))]);R.exists()&&k(R.data()),L.exists()&&O(L.data().exercises||{})}catch(R){console.error("Error loading achievements:",R)}y(!1)})()},[n]);const G=x?.badges||[],U=x?.totalVolume||0,V=G.filter(j=>j.type==="pb_target"),te=G.filter(j=>j.type==="volume_milestone"),X={push:[],pull:[],lower:[],core:[]};V.forEach(j=>{const R=j.group||lD(j.exercise);X[R]&&X[R].push(j)});const me=$p.find(j=>U<j.threshold),Ee=$p.filter(j=>U>=j.threshold).pop()?.threshold||0,ze=me?(U-Ee)/(me.threshold-Ee):1;if(i||g)return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const Le=G.length,I=Le>0||U>0;return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Le}),a.jsx("span",{className:"ach-stat-label",children:Le===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:cD(U)}),a.jsxs("span",{className:"ach-stat-label",children:[uD(U)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(E).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!I&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:au.map((j,R)=>{const L=R<Math.round(ze*60);return a.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,className:L?"ach-tick-filled":"ach-tick-empty",strokeWidth:j.thick?"3":"2"},R)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(U).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),me&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:me.label})," (",(me.threshold-U).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:$p.map((j,R)=>{const L=U>=j.threshold,D=te.find(z=>z.milestone===j.threshold);return a.jsxs("div",{className:`ach-milestone ${L?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:j.icon})}),a.jsx("span",{className:"ach-milestone-label",children:j.label}),D?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(D.achievedAt.toDate?D.achievedAt.toDate():new Date(D.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},R)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),V.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(X).map(([j,R])=>{if(R.length===0)return null;const L=oD[j];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:L.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:L.color},children:L.label}),a.jsx("span",{className:"ach-group-count",children:R.length})]}),a.jsx("div",{className:"ach-badge-grid",children:R.map((D,z)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${z*.06}s`,"--group-color":L.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:L.color,boxShadow:`0 0 12px ${L.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:L.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:L.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:D.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:L.color},children:[D.targetWeight,"kg"]}),D.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(D.achievedAt.toDate?D.achievedAt.toDate():new Date(D.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},z))})]},j)})]})]}),a.jsx(Ma,{active:"home"})]})}const id=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"}];function dD(s){const e=new Date(s),n=e.getDay(),i=n===0?-6:1-n;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Wp(s){return s.toISOString().split("T")[0]}function fD(s){return Array.from({length:7},(e,n)=>{const i=new Date(s);return i.setDate(s.getDate()+n),i})}function mD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=Pa(),p=Zs(),[g,y]=w.useState({}),[x,k]=w.useState(!0),[E,O]=w.useState(!1),[G,U]=w.useState(0),[V,te]=w.useState(null),[X,me]=w.useState(null),[Ee,ze]=w.useState(!1),Le=w.useRef([]),I=w.useRef([]),j=w.useCallback((W,ye="info")=>{te({message:W,type:ye}),setTimeout(()=>te(null),3e3)},[]),R=new Date,L=Wp(R),D=dD(R),z=fD(D),M=["M","T","W","T","F","S","S"];w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!n)return;(async()=>{try{const ye=Jt(_e,"habitLogs"),Ne=Mn(ye,xn("clientId","==",n.id)),Be=await Tn(Ne),ke={};Be.docs.forEach(Je=>{const Ht=Je.data();ke[Ht.date]={...Ht,_id:Je.id}}),y(ke);let et=0;const gt=new Date(R);for(;;){const Je=Wp(gt),Ht=ke[Je];if(Ht)if(Object.values(Ht.habits||{}).filter(Boolean).length>=3)et++,gt.setDate(gt.getDate()-1);else break;else if(Je===L)gt.setDate(gt.getDate()-1);else break}U(et)}catch(ye){console.error("Error loading habit logs:",ye)}finally{k(!1)}})()},[s,n]);const Fe=g[L]||{habits:{}},wt=async W=>{if(!s||E)return;const ye=Fe.habits?.[W]||!1;ye||(Le.current=[...Array(10)].map((Ne,Be)=>{const ke=Be/10*2*Math.PI,et=18+Math.random()*20;return{tx:Math.cos(ke)*et,ty:Math.sin(ke)*et,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),me(W),setTimeout(()=>me(null),700)),O(!0);try{const Ne=Fe.habits||{},Be={...Ne,[W]:!Ne[W]},ke=Fe._id||`${n.id}_${L}`;await Vn(Ke(_e,"habitLogs",ke),{clientId:n.id,date:L,habits:Be}),y(gt=>({...gt,[L]:{clientId:n.id,date:L,habits:Be,_id:ke}})),Object.values(Be).filter(Boolean).length===id.length&&!ye&&(I.current=[...Array(50)].map((gt,Je)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][Je%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{ze(!0),setTimeout(()=>ze(!1),3500)},500))}catch(Ne){console.error("Error saving habit:",Ne),j("Failed to save. Try again.","error")}finally{O(!1)}},Y=z.map(W=>{const ye=Wp(W),Ne=g[ye],Be=Ne?Object.values(Ne.habits||{}).filter(Boolean).length:0;return{date:W,dateStr:ye,completed:Be,total:id.length}}),Se=Y.reduce((W,ye)=>W+ye.completed,0),Oe=Y.reduce((W,ye)=>W+ye.total,0),ht=Oe>0?Math.round(Se/Oe*100):0,ae=Object.values(Fe.habits||{}).filter(Boolean).length,P=Math.round(ae/id.length*100);return a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||x?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-P/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[P,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:G}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsx("div",{className:"cbc-habits",children:id.map(W=>{const ye=Fe.habits?.[W.key]||!1,Ne=X===W.key;return a.jsxs("button",{className:`cbc-habit-btn cbc-habit-${W.key} ${ye?"cbc-habit-done":""} ${Ne?"cbc-habit-just-checked":""}`,onClick:()=>wt(W.key),disabled:E,children:[a.jsx("div",{className:"cbc-habit-check",children:ye?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12",className:`cbc-check-path ${Ne?"cbc-check-animate":""}`})}):a.jsx("div",{className:"cbc-habit-circle"})}),Ne&&a.jsx("div",{className:"cbc-particles",children:Le.current.map((Be,ke)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${Be.tx}px`,"--ty":`${Be.ty}px`,"--size":`${Be.size}px`,animationDuration:`${Be.duration}s`}},ke))}),a.jsx("div",{className:`cbc-habit-icon cbc-icon-${W.key}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:W.icon})})}),a.jsx("span",{className:"cbc-habit-label",children:W.label})]},W.key)})})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:Y.map((W,ye)=>{const Ne=W.dateStr===L,Be=W.total>0?W.completed/W.total:0,ke=38,et=2*Math.PI*ke,gt=et-Be*et;return a.jsxs("div",{className:`cbc-day-ring ${Ne?"cbc-day-today":""} ${W.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:ke}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:ke,strokeDasharray:et,strokeDashoffset:gt})]}),a.jsx("span",{className:"cbc-day-label",children:M[ye]}),a.jsxs("span",{className:"cbc-day-count",children:[W.completed,"/",W.total]})]},ye)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${ht}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[Se," / ",Oe," habits this week (",ht,"%)"]})]})]})]}),a.jsx(Ma,{active:"home"}),Ee&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>ze(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:I.current.map((W,ye)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${W.x}%`,"--delay":`${W.delay}s`,"--color":W.color,"--drift":`${W.drift}px`,"--spin":`${W.spin}deg`,"--duration":`${W.duration}s`,width:`${W.width}px`,height:`${W.height}px`}},ye))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),V&&a.jsx("div",{className:`toast-notification ${V.type}`,children:V.message})]})}function od(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function v2(s,e){return[s,e].sort().join("_")}function pD(){const{currentUser:s,isClient:e,clientData:n,loading:i}=Xr(),{isDark:l,toggleTheme:u}=Pa(),h=Zs(),[p,g]=w.useState("buddies"),[y,x]=w.useState([]),[k,E]=w.useState([]),[O,G]=w.useState([]),[U,V]=w.useState(""),[te,X]=w.useState([]),[me,Ee]=w.useState([]),[ze,Le]=w.useState(!0),[I,j]=w.useState(null),[R,L]=w.useState(null),D=w.useCallback((ae,P="info")=>{L({message:ae,type:P}),setTimeout(()=>L(null),3500)},[]);w.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const z=w.useCallback(async()=>{if(n){Le(!0);try{const ae=n.id,W=(await Tn(Jt(_e,"clients"))).docs.map(Je=>({id:Je.id,...Je.data()}));Ee(W);const ye=Object.fromEntries(W.map(Je=>[Je.id,Je])),Ne=await Tn(Mn(Jt(_e,"buddies"),xn("user1","==",ae))),Be=await Tn(Mn(Jt(_e,"buddies"),xn("user2","==",ae))),ke=new Set;[...Ne.docs,...Be.docs].forEach(Je=>{const Ht=Je.data(),hn=Ht.user1===ae?Ht.user2:Ht.user1;ke.add(hn)}),x(Array.from(ke).map(Je=>ye[Je]).filter(Boolean));const et=await Tn(Mn(Jt(_e,"buddyRequests"),xn("toId","==",ae),xn("status","==","pending")));E(et.docs.map(Je=>({reqId:Je.id,...Je.data(),fromClient:ye[Je.data().fromId]})).filter(Je=>Je.fromClient));const gt=await Tn(Mn(Jt(_e,"buddyRequests"),xn("fromId","==",ae),xn("status","==","pending")));G(gt.docs.map(Je=>({reqId:Je.id,...Je.data(),toClient:ye[Je.data().toId]})).filter(Je=>Je.toClient))}catch(ae){console.error("Error fetching buddy data:",ae),D("Failed to load buddies","error")}finally{Le(!1)}}},[n,D]);w.useEffect(()=>{z()},[z]),w.useEffect(()=>{if(!U.trim()||!n){X([]);return}const ae=U.toLowerCase(),P=n.id,W=new Set(y.map(ke=>ke.id)),ye=new Set(O.map(ke=>ke.toId)),Ne=new Set(k.map(ke=>ke.fromId)),Be=me.filter(ke=>ke.id===P||!ke.name||!ke.coreBuddyAccess&&ke.clientType!=="core_buddy"?!1:ke.name.toLowerCase().includes(ae)).map(ke=>({...ke,isBuddy:W.has(ke.id),isPendingOut:ye.has(ke.id),isPendingIn:Ne.has(ke.id)})).slice(0,20);X(Be)},[U,me,y,O,k,n]);const M=async(ae,P)=>{if(!(!n||ae===n.id))try{await ri(Jt(_e,"notifications"),{toId:ae,fromId:n.id,fromName:n.name||"Someone",fromPhotoURL:n.photoURL||null,type:P,read:!1,createdAt:Kr()})}catch(W){console.error("Notification error:",W),W.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},Fe=async ae=>{j(ae);try{const P=`${n.id}_${ae}`;await Vn(Ke(_e,"buddyRequests",P),{fromId:n.id,toId:ae,status:"pending",createdAt:Kr()}),await M(ae,"buddy_request"),D("Buddy request sent!","success"),await z()}catch(P){console.error("Error sending request:",P),D("Failed to send request","error")}finally{j(null)}},wt=async ae=>{j(ae.reqId);try{const P=v2(ae.fromId,n.id);await Vn(Ke(_e,"buddies",P),{user1:[ae.fromId,n.id].sort()[0],user2:[ae.fromId,n.id].sort()[1],connectedAt:Kr()}),await ar(Ke(_e,"buddyRequests",ae.reqId)),await M(ae.fromId,"buddy_accept"),D("Buddy added!","success"),await z()}catch(P){console.error("Error accepting request:",P),D("Failed to accept","error")}finally{j(null)}},Y=async ae=>{j(ae.reqId);try{await ar(Ke(_e,"buddyRequests",ae.reqId)),D("Request declined","info"),await z()}catch(P){console.error("Error declining:",P),D("Failed to decline","error")}finally{j(null)}},Se=async ae=>{j(ae.reqId);try{await ar(Ke(_e,"buddyRequests",ae.reqId)),D("Request cancelled","info"),await z()}catch(P){console.error("Error cancelling:",P),D("Failed to cancel","error")}finally{j(null)}},Oe=async ae=>{j(ae);try{const P=v2(n.id,ae);await ar(Ke(_e,"buddies",P)),D("Buddy removed","info"),await z()}catch(P){console.error("Error removing buddy:",P),D("Failed to remove buddy","error")}finally{j(null)}},ht=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!n?null:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),ht>0&&a.jsx("span",{className:"bdy-tab-badge",children:ht})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),ze?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(ae=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${ae.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ae.photoURL?a.jsx("img",{src:ae.photoURL,alt:ae.name}):a.jsx("span",{children:od(ae.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:ae.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Oe(ae.id)},disabled:I===ae.id,"aria-label":"Remove buddy",children:I===ae.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(ae=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ae.fromClient.photoURL?a.jsx("img",{src:ae.fromClient.photoURL,alt:ae.fromClient.name}):a.jsx("span",{children:od(ae.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ae.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>wt(ae),disabled:I===ae.reqId,children:I===ae.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>Y(ae),disabled:I===ae.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ae.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(ae=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ae.toClient?.photoURL?a.jsx("img",{src:ae.toClient.photoURL,alt:ae.toClient.name}):a.jsx("span",{children:od(ae.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ae.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>Se(ae),disabled:I===ae.reqId,children:I===ae.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ae.reqId))})]}),k.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:U,onChange:ae=>V(ae.target.value),autoFocus:!0}),U&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),U.trim()&&te.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',U,'"']})}),te.length>0&&a.jsx("div",{className:"bdy-list",children:te.map(ae=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${ae.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ae.photoURL?a.jsx("img",{src:ae.photoURL,alt:ae.name}):a.jsx("span",{children:od(ae.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ae.name}),ae.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ae.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):ae.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ae.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const W=k.find(ye=>ye.fromId===ae.id);W&&wt(W)},disabled:!!I,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Fe(ae.id)},disabled:I===ae.id,children:I===ae.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ae.id))})]})]})]}),a.jsx(Ma,{}),R&&a.jsxs("div",{className:`toast-notification ${R.type}`,children:[a.jsx("span",{className:"toast-icon",children:R.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):R.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:R.message})]})]})}function ld(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Gp(s,e){return[s,e].sort().join("_")}function b2(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),n=Math.floor((new Date-e)/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function gD(){const{userId:s}=Xj(),{currentUser:e,isClient:n,clientData:i,loading:l}=Xr(),{isDark:u,toggleTheme:h}=Pa(),p=Zs(),[g,y]=w.useState(null),[x,k]=w.useState("none"),[E,O]=w.useState(null),[G,U]=w.useState(!0),[V,te]=w.useState(!1),[X,me]=w.useState(null),[Ee,ze]=w.useState([]),[Le,I]=w.useState(!1),[j,R]=w.useState(new Set),[L,D]=w.useState(new Set),[z,M]=w.useState({}),[Fe,wt]=w.useState({}),[Y,Se]=w.useState({}),[Oe,ht]=w.useState([]),[ae,P]=w.useState(!1),[W,ye]=w.useState(null),[Ne,Be]=w.useState([]),ke=w.useCallback((le,He="info")=>{me({message:le,type:He}),setTimeout(()=>me(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!n)&&p("/")},[e,n,l,p]),w.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let le=!1;return(async()=>{U(!0);try{const pt=(await Tn(Jt(_e,"clients"))).docs.map(ce=>({id:ce.id,...ce.data()})).find(ce=>ce.id===s);if(!pt){le||U(!1);return}le||y(pt);const Dt=i.id,at=Gp(Dt,s);if((await Qn(Ke(_e,"buddies",at))).exists())le||k("buddy");else{const ce=`${Dt}_${s}`,xe=await Qn(Ke(_e,"buddyRequests",ce));if(xe.exists()&&xe.data().status==="pending")le||(k("pending_out"),O(ce));else{const Ie=`${s}_${Dt}`,Qe=await Qn(Ke(_e,"buddyRequests",Ie));Qe.exists()&&Qe.data().status==="pending"?le||(k("pending_in"),O(Ie)):le||k("none")}}}catch(He){console.error("Error loading profile:",He)}finally{le||U(!1)}})(),()=>{le=!0}},[i,s]),w.useEffect(()=>{if(!i)return;const le=i.id;(async()=>{try{const[He,tt,pt]=await Promise.all([Tn(Mn(Jt(_e,"buddies"),xn("user1","==",le))),Tn(Mn(Jt(_e,"buddies"),xn("user2","==",le))),Tn(Jt(_e,"clients"))]),Dt=new Set;[...He.docs,...tt.docs].forEach(St=>{const ce=St.data();Dt.add(ce.user1===le?ce.user2:ce.user1)});const at={};pt.docs.forEach(St=>{at[St.id]=St.data()}),ht(Array.from(Dt).filter(St=>at[St]).map(St=>({id:St,name:at[St].name,photoURL:at[St].photoURL||null})))}catch(He){console.error("Error loading buddies for mentions:",He)}})()},[i]);const et=async(le,He,tt={})=>{if(!(!i||le===i.id))try{await ri(Jt(_e,"notifications"),{toId:le,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:He,read:!1,createdAt:Kr(),...tt})}catch(pt){console.error("Notification error:",pt),pt.code==="permission-denied"&&ke("Notifications blocked  check Firestore rules","error")}},gt=async()=>{te(!0);try{const le=`${i.id}_${s}`;await Vn(Ke(_e,"buddyRequests",le),{fromId:i.id,toId:s,status:"pending",createdAt:Kr()}),await et(s,"buddy_request"),k("pending_out"),O(le),ke("Buddy request sent!","success")}catch(le){console.error(le),ke("Failed to send request","error")}finally{te(!1)}},Je=async()=>{if(E){te(!0);try{const le=Gp(i.id,s);await Vn(Ke(_e,"buddies",le),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Kr()}),await ar(Ke(_e,"buddyRequests",E)),await et(s,"buddy_accept"),k("buddy"),ke("Buddy added!","success")}catch(le){console.error(le),ke("Failed to accept","error")}finally{te(!1)}}},Ht=async()=>{if(E){te(!0);try{await ar(Ke(_e,"buddyRequests",E)),k("none"),ke(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(le){console.error(le),ke("Failed","error")}finally{te(!1)}}},hn=async()=>{te(!0);try{const le=Gp(i.id,s);await ar(Ke(_e,"buddies",le)),k("none"),ke("Buddy removed","info")}catch(le){console.error(le),ke("Failed to remove","error")}finally{te(!1)}},Nt=w.useCallback(async()=>{if(s){I(!0);try{const le=await Tn(Mn(Jt(_e,"posts"),xn("authorId","==",s),Hd("createdAt","desc"),$d(30)));if(ze(le.docs.map(He=>({id:He.id,...He.data()}))),i){const He=await Tn(Mn(Jt(_e,"postLikes"),xn("userId","==",i.id)));R(new Set(He.docs.map(tt=>tt.data().postId)))}}catch(le){console.error("Error loading journey:",le)}finally{I(!1)}}},[s,i]);w.useEffect(()=>{!G&&g&&Nt()},[G,g,Nt]);const Ct=async le=>{if(window.confirm("Delete this post?"))try{await ar(Ke(_e,"posts",le)),ze(He=>He.filter(tt=>tt.id!==le)),ke("Post deleted","info")}catch(He){console.error("Delete error:",He),ke("Failed to delete","error")}},oe=async le=>{if(!i)return;const He=i.id,tt=`${le}_${He}`,pt=j.has(le),Dt=new Set(j);pt?Dt.delete(le):Dt.add(le),R(Dt),ze(at=>at.map(St=>St.id===le?{...St,likeCount:Math.max(0,(St.likeCount||0)+(pt?-1:1))}:St));try{if(pt)await ar(Ke(_e,"postLikes",tt)),await Hi(Ke(_e,"posts",le),{likeCount:Mo(-1)});else{await Vn(Ke(_e,"postLikes",tt),{postId:le,userId:He,createdAt:Kr()}),await Hi(Ke(_e,"posts",le),{likeCount:Mo(1)});const at=Ee.find(St=>St.id===le);at&&et(at.authorId,"like",{postId:le})}}catch(at){console.error("Like error:",at),Nt()}},yn=async le=>{try{const He=await Tn(Mn(Jt(_e,"postComments"),xn("postId","==",le),Hd("createdAt","asc"),$d(50)));M(tt=>({...tt,[le]:He.docs.map(pt=>({id:pt.id,...pt.data()}))}))}catch(He){console.error("Error loading comments:",He)}},$t=le=>{const He=new Set(L);He.has(le)?He.delete(le):(He.add(le),z[le]||yn(le)),D(He)},Et=(le,He)=>{const tt=le.match(/@(\w*)$/);if(tt){P(!0),ye(He);const pt=Oe.filter(Dt=>Dt.name&&Dt.name.toLowerCase().includes(tt[1].toLowerCase())).slice(0,5);Be(pt)}else P(!1),Be([])},Bt=(le,He)=>{const pt=(Fe[He]||"").replace(/@\w*$/,`@${le.name} `);wt(Dt=>({...Dt,[He]:pt})),P(!1),Be([])},ft=(le,He)=>{wt(tt=>({...tt,[le]:He})),Et(He,le)},Ye=async le=>{const He=(Fe[le]||"").trim();if(!(!He||!i)){Se(tt=>({...tt,[le]:!0}));try{await ri(Jt(_e,"postComments"),{postId:le,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:He,createdAt:Kr()}),await Hi(Ke(_e,"posts",le),{commentCount:Mo(1)});const tt=Ee.find(Dt=>Dt.id===le);tt&&et(tt.authorId,"comment",{postId:le});const pt=He.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(pt){const Dt=new Set;pt.forEach(at=>{const St=at.slice(1).trim(),ce=Oe.find(xe=>xe.name&&xe.name.toLowerCase()===St.toLowerCase());ce&&!Dt.has(ce.id)&&(Dt.add(ce.id),et(ce.id,"mention",{postId:le}))})}wt(Dt=>({...Dt,[le]:""})),ze(Dt=>Dt.map(at=>at.id===le?{...at,commentCount:(at.commentCount||0)+1}:at)),await yn(le)}catch(tt){console.error("Comment error:",tt),ke("Failed to comment","error")}finally{Se(tt=>({...tt,[le]:!1}))}}};return l||G||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!n?null:g?a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:ld(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:gt,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ht,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Je,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ht,disabled:V,children:"Decline"})]}),x==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:hn,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Le?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):Ee.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:Ee.map(le=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:le.authorPhotoURL?a.jsx("img",{src:le.authorPhotoURL,alt:""}):a.jsx("span",{children:ld(le.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:le.authorName}),a.jsx("span",{className:"journey-post-time",children:b2(le.createdAt)})]}),le.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ct(le.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),le.content&&a.jsx("p",{className:"journey-post-content",children:le.content}),le.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:le.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${j.has(le.id)?" liked":""}`,onClick:()=>oe(le.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:j.has(le.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:le.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${L.has(le.id)?" active":""}`,onClick:()=>$t(le.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:le.commentCount||0})]})]}),L.has(le.id)&&a.jsxs("div",{className:"journey-comments",children:[z[le.id]?.length>0?z[le.id].map(He=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${He.authorId}`),children:He.authorPhotoURL?a.jsx("img",{src:He.authorPhotoURL,alt:""}):a.jsx("span",{children:ld(He.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:He.authorName}),a.jsx("span",{className:"journey-comment-text",children:He.content})]}),a.jsx("span",{className:"journey-comment-time",children:b2(He.createdAt)})]})]},He.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Fe[le.id]||"",onChange:He=>ft(le.id,He.target.value),onKeyDown:He=>{He.key==="Enter"&&Ye(le.id)},maxLength:300}),ae&&W===le.id&&Ne.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ne.map(He=>a.jsxs("button",{className:"mention-option",onClick:()=>Bt(He,le.id),children:[a.jsx("div",{className:"mention-option-avatar",children:He.photoURL?a.jsx("img",{src:He.photoURL,alt:""}):a.jsx("span",{children:ld(He.name)})}),a.jsx("span",{children:He.name})]},He.id))}),a.jsx("button",{onClick:()=>Ye(le.id),disabled:!(Fe[le.id]||"").trim()||Y[le.id],children:Y[le.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},le.id))})]})]}),a.jsx(Ma,{}),X&&a.jsxs("div",{className:`toast-notification ${X.type}`,children:[a.jsx("span",{className:"toast-icon",children:X.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):X.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:X.message})]})]}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Ma,{})]})}const ia=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Co=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function yD(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function oa(s){const[e,n]=s.split("-");return new Date(parseInt(e),parseInt(n)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function vD(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),n=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(n).toFixed(0)}s`:`${parseFloat(n).toFixed(2)}s`}function bD(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function cd(s,e){if(!e)return"-";switch(s.unit){case"weight":return bD(e.weight,e.reps);case"time":return vD(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Nl(s,e){if(!e)return 0;switch(s.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function Kp(s,e){return!e||e===0?null:(s-e)/e*100}function xD({data:s,exerciseKey:e,unit:n}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const V=U.benchmarks?.[e];if(!V)return 0;switch(n){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,E=i.map((U,V)=>{const te=y+V/(i.length-1)*x,X=y+k-(U-u)/h*k;return{x:te,y:X,value:U}}),O=E.map((U,V)=>`${V===0?"M":"L"} ${U.x} ${U.y}`).join(" "),G=O+` L ${E[E.length-1].x} ${y+k} L ${E[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:G,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),E.map((U,V)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,V)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},V))})]})}function wD(){const[s,e]=w.useState("bests"),[n,i]=w.useState([]),[l,u]=w.useState(!0),[h,p]=w.useState(!1),[g,y]=w.useState(0),[x,k]=w.useState(!1),[E,O]=w.useState(!1),[G,U]=w.useState(!1),[V,te]=w.useState({}),[X,me]=w.useState({}),[Ee,ze]=w.useState({}),[Le,I]=w.useState({}),[j,R]=w.useState({}),[L,D]=w.useState(!1),[z,M]=w.useState({}),[Fe,wt]=w.useState([]),[Y,Se]=w.useState(null),[Oe,ht]=w.useState(null),[ae,P]=w.useState(!1),[W,ye]=w.useState(""),[Ne,Be]=w.useState(""),ke=w.useRef(null),et=w.useRef(0),gt=w.useRef(0),Je=w.useRef("right"),Ht=w.useCallback(q=>{y(ge=>{const we=Math.max(0,Math.min(ia.length-1,q));return we===ge?ge:(Je.current=we>ge?"right":"left",we)})},[]),{currentUser:hn,isClient:Nt,clientData:Ct,loading:oe}=Xr(),{isDark:yn}=Pa(),$t=Zs(),Et=w.useCallback((q,ge="info")=>{ht({message:q,type:ge}),setTimeout(()=>ht(null),4e3)},[]);w.useEffect(()=>{!oe&&(!hn||!Nt)&&$t("/")},[hn,Nt,oe,$t]),w.useEffect(()=>{Ct&&Bt()},[Ct]);const Bt=async()=>{try{const q=Mn(Jt(_e,"juniorPBs"),xn("clientId","==",Ct.id)),we=(await Tn(q)).docs.map(ut=>({id:ut.id,...ut.data()}));we.sort((ut,_t)=>ut.month.localeCompare(_t.month)),i(we);const ve=Mn(Jt(_e,"juniorPBTargets"),xn("clientId","==",Ct.id)),pe=await Tn(ve);if(!pe.empty){const ut=pe.docs[0].data();ze(ut.targets||{}),I(ut.metricTargets||{}),R(ut.targets||{}),M(ut.metricTargets||{})}const ot=Mn(Jt(_e,"juniorAchievements"),xn("clientId","==",Ct.id)),Rt=await Tn(ot);Rt.empty||wt(Rt.docs[0].data().badges||[])}catch(q){console.error("Error fetching junior personal bests:",q)}u(!1)},ft=yD(),Ye=n.find(q=>q.month===ft),le=n.filter(q=>q.month<ft),He=le.length>0?le[le.length-1]:null;w.useEffect(()=>{Ye?(te(Ye.benchmarks||{}),me(Ye.bodyMetrics||{})):(te({}),me({}))},[Ye?.id]);const tt=async(q,ge)=>{const we=[];if(q==="strength"?ia.forEach(ve=>{const pe=Ee[ve.key];if(!pe)return;const ot=ge[ve.key];if(!ot)return;let Rt;if(pe.targetType==="time"){if(!pe.targetValue)return;const ut=pe.startValue||0,_t=ot.time||0,bt=pe.targetValue-ut;Rt=bt===0?_t>=pe.targetValue?1:0:Math.max(0,(_t-ut)/bt)}else if(pe.targetType==="reps"){if(!pe.targetReps)return;const ut=pe.startReps||0,_t=ot.reps||0,bt=pe.targetReps-ut;Rt=bt===0?_t>=pe.targetReps?1:0:Math.max(0,(_t-ut)/bt)}else if(pe.targetType==="distance"){if(!pe.targetDistance)return;const ut=pe.startDistance||0,_t=ot.distance||0,bt=pe.targetDistance-ut;Rt=bt===0?_t>=pe.targetDistance?1:0:Math.max(0,(_t-ut)/bt)}else{if(!pe.targetWeight&&!pe.targetReps)return;const ut=(pe.startWeight||0)*(pe.startReps||0),_t=(pe.targetWeight||0)*(pe.targetReps||0),bt=(ot.weight||0)*(ot.reps||0),dn=_t-ut;Rt=dn===0?bt>=_t?1:0:Math.max(0,(bt-ut)/dn)}if(Rt>=1){let ut,_t;pe.targetType==="time"?(ut=Fe.some(bt=>bt.type==="strength"&&bt.key===ve.key&&bt.targetValue===pe.targetValue),_t=`${ve.name} ${pe.targetValue}s`):pe.targetType==="reps"?(ut=Fe.some(bt=>bt.type==="strength"&&bt.key===ve.key&&bt.targetReps===pe.targetReps),_t=`${ve.name} ${pe.targetReps} reps`):pe.targetType==="distance"?(ut=Fe.some(bt=>bt.type==="strength"&&bt.key===ve.key&&bt.targetDistance===pe.targetDistance),_t=`${ve.name} ${pe.targetDistance}cm`):(ut=Fe.some(bt=>bt.type==="strength"&&bt.key===ve.key&&bt.targetWeight===pe.targetWeight&&bt.targetReps===pe.targetReps),_t=`${ve.name} ${pe.targetWeight}kg  ${pe.targetReps}`),ut||we.push({type:"strength",key:ve.key,...pe.targetType==="time"?{targetType:"time",targetValue:pe.targetValue}:pe.targetType==="reps"?{targetType:"reps",targetReps:pe.targetReps}:pe.targetType==="distance"?{targetType:"distance",targetDistance:pe.targetDistance}:{targetWeight:pe.targetWeight,targetReps:pe.targetReps},achievedMonth:ft,label:_t})}}):Co.forEach(ve=>{const pe=Le[ve.key];if(!pe||!pe.targetValue)return;const ot=ge[ve.key];if(ot==null)return;const Rt=pe.startValue||0,ut=pe.targetValue,_t=ut-Rt;(_t===0?ot===ut?1:0:Math.max(0,(ot-Rt)/_t))>=1&&(Fe.some(er=>er.type==="metric"&&er.key===ve.key&&er.targetValue===ut)||we.push({type:"metric",key:ve.key,targetValue:ut,achievedMonth:ft,label:`${ve.name} ${ut}${ve.suffix}`}))}),we.length>0){const ve=[...Fe,...we];await Vn(Ke(_e,"juniorAchievements",Ct.id),{clientId:Ct.id,badges:ve,updatedAt:xt.now()}),wt(ve),Se(we),setTimeout(()=>Se(null),5e3)}},pt=(q,ge)=>{if(q==="strength"){const we=Ee[ge];if(!we)return!1;switch(ia.find(pe=>pe.key===ge)?.unit){case"time":return Fe.some(pe=>pe.type==="strength"&&pe.key===ge&&pe.targetValue===we.targetValue);case"reps":return Fe.some(pe=>pe.type==="strength"&&pe.key===ge&&pe.targetReps===we.targetReps);case"distance":return Fe.some(pe=>pe.type==="strength"&&pe.key===ge&&pe.targetDistance===we.targetDistance);default:return!we.targetWeight&&!we.targetReps?!1:Fe.some(pe=>pe.type==="strength"&&pe.key===ge&&pe.targetWeight===we.targetWeight&&pe.targetReps===we.targetReps)}}else{const we=Le[ge];return!we||!we.targetValue?!1:Fe.some(ve=>ve.type==="metric"&&ve.key===ge&&ve.targetValue===we.targetValue)}},Dt=async()=>{p(!0);try{const q=`${Ct.id}_${ft}`,ge=Ye||{};await Vn(Ke(_e,"juniorPBs",q),{clientId:Ct.id,month:ft,benchmarks:V,bodyMetrics:ge.bodyMetrics||X||{},createdAt:ge.createdAt||xt.now(),updatedAt:xt.now()}),await tt("strength",V),Et("Benchmarks saved!","success"),k(!1),await Bt()}catch(q){console.error("Error saving benchmarks:",q),Et("Failed to save. Please try again.","error")}p(!1)},at=async()=>{p(!0);try{const q=`${Ct.id}_${ft}`,ge=Ye||{};await Vn(Ke(_e,"juniorPBs",q),{clientId:Ct.id,month:ft,benchmarks:ge.benchmarks||V||{},bodyMetrics:X,createdAt:ge.createdAt||xt.now(),updatedAt:xt.now()}),await tt("metric",X),Et("Body metrics saved!","success"),O(!1),await Bt()}catch(q){console.error("Error saving metrics:",q),Et("Failed to save. Please try again.","error")}p(!1)},St=(q,ge,we)=>{te(ve=>({...ve,[q]:{...ve[q],[ge]:we===""?"":parseFloat(we)}}))},ce=(q,ge)=>{me(we=>({...we,[q]:ge===""?"":parseFloat(ge)}))},xe=(q,ge,we)=>{R(ve=>({...ve,[q]:{...ve[q],[ge]:we===""?"":parseFloat(we)}}))},Ie=async()=>{p(!0);try{const q=`targets_${Ct.id}`,ge=Ye?.benchmarks||{},we={};ia.forEach(ve=>{const pe=ge[ve.key];switch(ve.unit){case"time":j[ve.key]?.targetValue&&(we[ve.key]={targetType:"time",targetValue:j[ve.key].targetValue,startValue:pe?.time||0});break;case"reps":j[ve.key]?.targetReps&&(we[ve.key]={targetType:"reps",targetReps:j[ve.key].targetReps,startReps:pe?.reps||0});break;case"distance":j[ve.key]?.targetDistance&&(we[ve.key]={targetType:"distance",targetDistance:j[ve.key].targetDistance,startDistance:pe?.distance||0});break;default:(j[ve.key]?.targetWeight||j[ve.key]?.targetReps)&&(we[ve.key]={targetWeight:j[ve.key].targetWeight||0,targetReps:j[ve.key].targetReps||0,startWeight:pe?.weight||0,startReps:pe?.reps||0})}}),await Vn(Ke(_e,"juniorPBTargets",q),{clientId:Ct.id,targets:we,metricTargets:Le,updatedAt:xt.now()}),ze(we),R(we),Et("Targets saved!","success"),U(!1)}catch(q){console.error("Error saving targets:",q),Et("Failed to save targets.","error")}p(!1)},Qe=(q,ge)=>{M(we=>({...we,[q]:{...we[q],targetValue:ge===""?"":parseFloat(ge)}}))},Ge=async()=>{p(!0);try{const q=`targets_${Ct.id}`,ge={};Co.forEach(we=>{if(z[we.key]?.targetValue){const ve=Ye?.bodyMetrics?.[we.key]||0;ge[we.key]={targetValue:z[we.key].targetValue,startValue:ve}}}),await Vn(Ke(_e,"juniorPBTargets",q),{clientId:Ct.id,targets:Ee,metricTargets:ge,updatedAt:xt.now()}),I(ge),M(ge),Et("Metric targets saved!","success"),D(!1)}catch(q){console.error("Error saving metric targets:",q),Et("Failed to save targets.","error")}p(!1)},We=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=Ke(_e,"juniorPBTargets",`targets_${Ct.id}`);await ar(q),ze({}),I({}),R({}),M({}),Et("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),Et("Failed to reset goals","error")}p(!1)}},nt=(q,ge)=>{const we=Ee[q];if(!we||!ge)return null;if(we.targetType==="time"){if(!we.targetValue)return null;const ut=we.startValue||0,_t=we.targetValue,bt=ge.time||0,dn=_t-ut;return dn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ut)/dn,1))}if(we.targetType==="reps"){if(!we.targetReps)return null;const ut=we.startReps||0,_t=we.targetReps,bt=ge.reps||0,dn=_t-ut;return dn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ut)/dn,1))}if(we.targetType==="distance"){if(!we.targetDistance)return null;const ut=we.startDistance||0,_t=we.targetDistance,bt=ge.distance||0,dn=_t-ut;return dn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ut)/dn,1))}if(!we.targetWeight&&!we.targetReps)return null;const ve=(we.startWeight||0)*(we.startReps||0),pe=(we.targetWeight||0)*(we.targetReps||0),ot=(ge.weight||0)*(ge.reps||0),Rt=pe-ve;return Rt<=0?ot>=pe?1:0:Math.max(0,Math.min((ot-ve)/Rt,1))},st=q=>{const ge=Le[q];if(!ge||!ge.targetValue)return null;const we=Ye?.bodyMetrics?.[q];if(we==null)return null;const ve=ge.startValue||0,pe=ge.targetValue,ot=pe-ve;return ot===0?we===pe?1:0:Math.max(0,Math.min((we-ve)/ot,1))},qe=q=>{et.current=q.touches[0].clientX,gt.current=0},Kt=q=>{gt.current=q.touches[0].clientX-et.current},nn=()=>{gt.current<-50?Ht(g+1):gt.current>50&&Ht(g-1),gt.current=0},en=q=>{const ge=Ye?.bodyMetrics?.[q],we=He?.bodyMetrics?.[q];return ge==null||we==null?null:parseFloat((ge-we).toFixed(2))},Nn=n.find(q=>q.month===W),Fn=n.find(q=>q.month===Ne);if(oe||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!hn||!Nt||!Ct)return null;const Ut=ia[g],wn=Ye?.benchmarks?.[Ut.key],Xn=He?.benchmarks?.[Ut.key],Dn=Nl(Ut,wn),us=Nl(Ut,Xn),vs=Kp(Dn,us),Hn=nt(Ut.key,wn),hs=Hn!==null,ds=Hn!==null&&Hn>=1,Ns=hs?Math.round(Hn*60):Dn>0?15:0,Is=Ee[Ut.key],Os=q=>q?q.targetType==="time"?`${q.startValue||0}s  ${q.targetValue}s`:q.targetType==="reps"?`${q.startReps||0}  ${q.targetReps} reps`:q.targetType==="distance"?`${q.startDistance||0}  ${q.targetDistance}cm`:`${q.startWeight||0}kg${q.startReps||0}  ${q.targetWeight}kg${q.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>$t("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!x&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:ke,onTouchStart:qe,onTouchMove:Kt,onTouchEnd:nn,children:[a.jsx("div",{className:`pb-ring-container slide-from-${Je.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Hy.map((q,ge)=>{const we=ge<Math.round(Ns);return a.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${we?ds?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},ge)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:Ut.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[Ut.name,pt("strength",Ut.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:wn?cd(Ut,wn):"-"}),vs!==null&&a.jsxs("div",{className:`pb-ring-change ${vs>=0?"positive":"negative"}`,children:[vs>=0?"+":"",vs.toFixed(1),"%"]}),vs===null&&wn&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Is&&a.jsx("div",{className:`pb-ring-target ${ds?"hit":""}`,children:ds?"Target hit!":Os(Is)}),!Is&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:ia.map((q,ge)=>a.jsx("button",{className:`pb-dot ${ge===g?"active":""}`,onClick:()=>Ht(ge)},ge))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ht(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ht(g+1),disabled:g===ia.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(xD,{data:n,exerciseKey:Ut.key,unit:Ut.unit})]})]}),!x&&!G&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Ye?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(Ee).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Ee).length>0||Object.keys(Le).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:We,disabled:h,children:"Reset All Goals"})]}),x&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",oa(ft)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),te(Ye?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:ia.map(q=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[q.key]?.weight??"",onChange:ge=>St(q.key,"weight",ge.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[q.key]?.reps??"",onChange:ge=>St(q.key,"reps",ge.target.value),placeholder:"0"})]})]}):q.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:V[q.key]?.reps??"",onChange:ge=>St(q.key,"reps",ge.target.value),placeholder:"0"})]})}):q.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:V[q.key]?.distance??"",onChange:ge=>St(q.key,"distance",ge.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[q.key]?.time??"",onChange:ge=>St(q.key,"time",ge.target.value),placeholder:"0"})]})})]},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),te(Ye?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Dt,disabled:h,children:h?"Saving...":"Save"})]})]}),G&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),R(Ee)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ia.map(q=>{const ge=Ye?.benchmarks?.[q.key];let we="-";if(ge)switch(q.unit){case"weight":(ge.weight||ge.reps)&&(we=`${ge.weight||0}kg  ${ge.reps||0}`);break;case"time":ge.time&&(we=`${ge.time}s`);break;case"reps":ge.reps&&(we=`${ge.reps} reps`);break;case"distance":ge.distance&&(we=`${ge.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we]})]}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:j[q.key]?.targetWeight??"",onChange:ve=>xe(q.key,"targetWeight",ve.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:j[q.key]?.targetReps??"",onChange:ve=>xe(q.key,"targetReps",ve.target.value),placeholder:"0"})]})]}):q.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:j[q.key]?.targetReps??"",onChange:ve=>xe(q.key,"targetReps",ve.target.value),placeholder:"0"})]})}):q.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:j[q.key]?.targetDistance??"",onChange:ve=>xe(q.key,"targetDistance",ve.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:j[q.key]?.targetValue??"",onChange:ve=>xe(q.key,"targetValue",ve.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),R(Ee)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ie,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!E&&!L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:oa(ft)}),a.jsx("div",{className:"pb-metrics-list",children:Co.map(q=>{const ge=Ye?.bodyMetrics?.[q.key],we=en(q.key),ve=Le[q.key],pe=st(q.key),ot=pe!==null&&pe>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[q.name,pt("metric",q.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),ve&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",ve.targetValue," ",q.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ge!=null?`${ge} ${q.suffix}`:"-"}),we!==null&&a.jsxs("span",{className:`pb-metric-change ${we>0?"up":we<0?"down":"same"}`,children:[we>0?"+":"",we," ",q.suffix]})]})]}),pe!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${ot?"hit":""}`,style:{width:`${Math.round(pe*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${ot?"hit":""}`,children:ot?"Hit!":`${Math.round(pe*100)}%`})]})]},q.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ye?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Le).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Ee).length>0||Object.keys(Le).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:We,disabled:h,children:"Reset All Goals"})]})]}),E&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",oa(ft)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),me(Ye?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Co.map(q=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[q.name," (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:X[q.key]??"",onChange:ge=>ce(q.key,ge.target.value),placeholder:"0"})]})},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),me(Ye?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:at,disabled:h,children:h?"Saving...":"Save"})]})]}),L&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Le)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Co.map(q=>{const ge=Ye?.bodyMetrics?.[q.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ge!=null?`${ge} ${q.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:z[q.key]?.targetValue??"",onChange:we=>Qe(q.key,we.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Le)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ge,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:n.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[Fe.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...Fe].reverse().map((q,ge)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ge*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:q.label}),a.jsx("span",{className:"pb-achievement-date",children:oa(q.achievedMonth)})]})]},ge))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ae?"active":""}`,onClick:()=>{P(!ae),!ae&&n.length>=2&&(ye(n[0].month),Be(n[n.length-1].month))},children:ae?"Back to Timeline":"Compare Months"})}),ae?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:W,onChange:q=>ye(q.target.value),children:n.map(q=>a.jsx("option",{value:q.month,children:oa(q.month)},q.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ne,onChange:q=>Be(q.target.value),children:n.map(q=>a.jsx("option",{value:q.month,children:oa(q.month)},q.month))})]})]}),Nn&&Fn&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:oa(W).split(" ")[0]}),a.jsx("span",{children:oa(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),ia.map(q=>{const ge=Nn.benchmarks?.[q.key],we=Fn.benchmarks?.[q.key],ve=Nl(q,ge),pe=Nl(q,we),ot=Kp(pe,ve);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:ge?cd(q,ge):"-"}),a.jsx("span",{className:"pb-compare-val",children:we?cd(q,we):"-"}),a.jsx("span",{className:`pb-compare-change ${ot!==null?ot>=0?"positive":"negative":""}`,children:ot!==null?`${ot>=0?"+":""}${ot.toFixed(1)}%`:"-"})]},q.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:oa(W).split(" ")[0]}),a.jsx("span",{children:oa(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Co.map(q=>{const ge=Nn.bodyMetrics?.[q.key],we=Fn.bodyMetrics?.[q.key],ve=ge!=null&&we!=null?parseFloat((we-ge).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:ge!=null?`${ge}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ve!==null?ve>0?"positive":ve<0?"negative":"neutral":""}`,children:ve!==null?`${ve>0?"+":""}${ve} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...n].reverse().map((q,ge)=>{const we=n.filter(ve=>ve.month<q.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ge*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:oa(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),ia.map(ve=>{const pe=q.benchmarks[ve.key];if(!pe)return null;const ot=we?.benchmarks?.[ve.key],Rt=Nl(ve,pe),ut=Nl(ve,ot),_t=Kp(Rt,ut);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:ve.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:cd(ve,pe)}),_t!==null&&a.jsxs("span",{className:`pb-timeline-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]})]})]},ve.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Co.map(ve=>{const pe=q.bodyMetrics[ve.key];if(pe==null)return null;const ot=we?.bodyMetrics?.[ve.key],Rt=ot!=null?parseFloat((pe-ot).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:ve.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[pe," ",ve.suffix]}),Rt!==null&&a.jsxs("span",{className:`pb-timeline-change ${Rt>0?"positive":Rt<0?"negative":"neutral"}`,children:[Rt>0?"+":"",Rt," ",ve.suffix]})]})]},ve.key)})]})]})]},q.id)})})]})})]}),Y&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Se(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:Y.length===1?"Target Achieved!":`${Y.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:Y.map((q,ge)=>a.jsx("div",{className:"pb-celebration-badge",children:q.label},ge))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Oe&&a.jsxs("div",{className:`toast-notification ${Oe.type}`,children:[a.jsx("span",{className:"toast-icon",children:Oe.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Oe.message}),a.jsx("button",{className:"toast-close",onClick:()=>ht(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const _a=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Ro=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function _D(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function la(s){const[e,n]=s.split("-");return new Date(parseInt(e),parseInt(n)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function ud(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),n=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(n).toFixed(0)}s`:`${parseFloat(n).toFixed(2)}s`}function x2(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function Cl(s,e){return e?s.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function Yp(s,e){return!e||e===0?null:(s-e)/e*100}function kD({data:s,exerciseKey:e,unit:n}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const V=U.benchmarks?.[e];return V?n==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,E=i.map((U,V)=>{const te=y+V/(i.length-1)*x,X=y+k-(U-u)/h*k;return{x:te,y:X,value:U}}),O=E.map((U,V)=>`${V===0?"M":"L"} ${U.x} ${U.y}`).join(" "),G=O+` L ${E[E.length-1].x} ${y+k} L ${E[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:G,fill:"url(#trendGradient)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),E.map((U,V)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,V)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},V))})]})}function TD(){const[s,e]=w.useState("bests"),[n,i]=w.useState([]),[l,u]=w.useState(!0),[h,p]=w.useState(!1),[g,y]=w.useState(0),[x,k]=w.useState(!1),[E,O]=w.useState(!1),[G,U]=w.useState(!1),[V,te]=w.useState({}),[X,me]=w.useState({}),[Ee,ze]=w.useState({}),[Le,I]=w.useState({}),[j,R]=w.useState({}),[L,D]=w.useState(!1),[z,M]=w.useState({}),[Fe,wt]=w.useState([]),[Y,Se]=w.useState(null),[Oe,ht]=w.useState(null),[ae,P]=w.useState(!1),[W,ye]=w.useState(""),[Ne,Be]=w.useState(""),[ke,et]=w.useState({}),[gt,Je]=w.useState({}),[Ht,hn]=w.useState(null),[Nt,Ct]=w.useState(null),[oe,yn]=w.useState(""),$t=w.useRef(null),Et=w.useRef(0),Bt=w.useRef(0),ft=w.useRef("right"),Ye=w.useCallback(F=>{y(ue=>{const T=Math.max(0,Math.min(_a.length-1,F));return T===ue?ue:(ft.current=T>ue?"right":"left",T)})},[]),{currentUser:le,isClient:He,clientData:tt,loading:pt}=Xr(),{isDark:Dt}=Pa(),at=Zs(),[St]=qE(),ce=St.get("mode")==="corebuddy",xe=!ce&&(!tt?.clientType||tt.clientType==="block"),Ie=w.useCallback((F,ue="info")=>{ht({message:F,type:ue}),setTimeout(()=>ht(null),4e3)},[]);w.useEffect(()=>{!pt&&(!le||!He)&&at("/")},[le,He,pt,at]),w.useEffect(()=>{tt&&(xe?Qe():(async()=>{try{const[ue,T,C]=await Promise.all([Qn(Ke(_e,"coreBuddyPBs",tt.id)),Qn(Ke(_e,"coreBuddyTargets",tt.id)),Qn(Ke(_e,"coreBuddyAchievements",tt.id))]);ue.exists()&&et(ue.data().exercises||{}),T.exists()&&Je(T.data().targets||{}),C.exists()&&hn(C.data())}catch(ue){console.error("Error loading Core Buddy PBs:",ue)}u(!1)})())},[tt]);const Qe=async()=>{try{const F=Mn(Jt(_e,"personalBests"),xn("clientId","==",tt.id)),T=(await Tn(F)).docs.map(Ve=>({id:Ve.id,...Ve.data()}));T.sort((Ve,Pe)=>Ve.month.localeCompare(Pe.month)),i(T);const C=Mn(Jt(_e,"personalBestTargets"),xn("clientId","==",tt.id)),K=await Tn(C);if(!K.empty){const Ve=K.docs[0].data();ze(Ve.targets||{}),I(Ve.metricTargets||{}),R(Ve.targets||{}),M(Ve.metricTargets||{})}const ee=Mn(Jt(_e,"achievements"),xn("clientId","==",tt.id)),Ue=await Tn(ee);Ue.empty||wt(Ue.docs[0].data().badges||[])}catch(F){console.error("Error fetching personal bests:",F)}u(!1)},Ge=async()=>{if(!Nt||!oe||!tt)return;const F=parseFloat(oe),ue=ke[Nt];if(!ue||F<=ue.weight){Ie("Target must be higher than current PB","error");return}p(!0);try{const T={...gt,[Nt]:{targetWeight:F,setAt:xt.now(),currentPBWhenSet:ue.weight}};await Vn(Ke(_e,"coreBuddyTargets",tt.id),{clientId:tt.id,targets:T,updatedAt:xt.now()}),Je(T),Ct(null),yn(""),Ie("Target set!","success")}catch(T){console.error("Error saving target:",T),Ie("Failed to save target","error")}p(!1)},We=F=>{if(!Ht?.badges)return!1;const ue=gt[F];return ue?Ht.badges.some(T=>T.type==="pb_target"&&T.exercise===F&&T.targetWeight===ue.targetWeight):!1},nt=F=>{const ue=gt[F];if(!ue)return null;const T=ke[F];if(!T)return 0;const C=ue.currentPBWhenSet||0,K=ue.targetWeight,ee=K-C;return ee<=0?T.weight>=K?1:0:Math.max(0,Math.min((T.weight-C)/ee,1))},st=_D(),qe=n.find(F=>F.month===st),Kt=n.filter(F=>F.month<st),nn=Kt.length>0?Kt[Kt.length-1]:null;w.useEffect(()=>{qe?(te(qe.benchmarks||{}),me(qe.bodyMetrics||{})):(te({}),me({}))},[qe?.id]);const en=async(F,ue)=>{const T=[];if(F==="strength"?_a.forEach(C=>{const K=Ee[C.key];if(!K)return;const ee=ue[C.key];if(!ee)return;let Ue;if(K.targetType==="time"){if(!K.targetValue)return;const Ve=K.startValue||0,Pe=ee.time||0,Vt=K.targetValue-Ve;Ue=Vt===0?Pe>=K.targetValue?1:0:Math.max(0,(Pe-Ve)/Vt)}else{if(!K.targetWeight&&!K.targetReps)return;const Ve=(K.startWeight||0)*(K.startReps||0),Pe=(K.targetWeight||0)*(K.targetReps||0),Vt=(ee.weight||0)*(ee.reps||0),kt=Pe-Ve;Ue=kt===0?Vt>=Pe?1:0:Math.max(0,(Vt-Ve)/kt)}if(Ue>=1&&!(K.targetType==="time"?Fe.some(Pe=>Pe.type==="strength"&&Pe.key===C.key&&Pe.targetValue===K.targetValue):Fe.some(Pe=>Pe.type==="strength"&&Pe.key===C.key&&Pe.targetWeight===K.targetWeight&&Pe.targetReps===K.targetReps))){const Pe=K.targetType==="time"?`${C.name} ${K.targetValue}s`:`${C.name} ${K.targetWeight}kg  ${K.targetReps}`;T.push({type:"strength",key:C.key,...K.targetType==="time"?{targetType:"time",targetValue:K.targetValue}:{targetWeight:K.targetWeight,targetReps:K.targetReps},achievedMonth:st,label:Pe})}}):Ro.forEach(C=>{const K=Le[C.key];if(!K||!K.targetValue)return;const ee=ue[C.key];if(ee==null)return;const Ue=K.startValue||0,Ve=K.targetValue,Pe=Ve-Ue;(Pe===0?ee===Ve?1:0:Math.max(0,(ee-Ue)/Pe))>=1&&(Fe.some(H=>H.type==="metric"&&H.key===C.key&&H.targetValue===Ve)||T.push({type:"metric",key:C.key,targetValue:Ve,achievedMonth:st,label:`${C.name} ${Ve}${C.suffix}`}))}),T.length>0){const C=[...Fe,...T];await Vn(Ke(_e,"achievements",tt.id),{clientId:tt.id,badges:C,updatedAt:xt.now()}),wt(C),Se(T),setTimeout(()=>Se(null),5e3)}},Nn=(F,ue)=>{if(F==="strength"){const T=Ee[ue];return T?T.targetType==="time"?Fe.some(C=>C.type==="strength"&&C.key===ue&&C.targetValue===T.targetValue):!T.targetWeight&&!T.targetReps?!1:Fe.some(C=>C.type==="strength"&&C.key===ue&&C.targetWeight===T.targetWeight&&C.targetReps===T.targetReps):!1}else{const T=Le[ue];return!T||!T.targetValue?!1:Fe.some(C=>C.type==="metric"&&C.key===ue&&C.targetValue===T.targetValue)}},Fn=async()=>{p(!0);try{const F=`${tt.id}_${st}`,ue=qe||{};await Vn(Ke(_e,"personalBests",F),{clientId:tt.id,month:st,benchmarks:V,bodyMetrics:ue.bodyMetrics||X||{},createdAt:ue.createdAt||xt.now(),updatedAt:xt.now()}),await en("strength",V),Ie("Benchmarks saved!","success"),k(!1),await Qe()}catch(F){console.error("Error saving benchmarks:",F),Ie("Failed to save. Please try again.","error")}p(!1)},Ut=async()=>{p(!0);try{const F=`${tt.id}_${st}`,ue=qe||{};await Vn(Ke(_e,"personalBests",F),{clientId:tt.id,month:st,benchmarks:ue.benchmarks||V||{},bodyMetrics:X,createdAt:ue.createdAt||xt.now(),updatedAt:xt.now()}),await en("metric",X),Ie("Body metrics saved!","success"),O(!1),await Qe()}catch(F){console.error("Error saving metrics:",F),Ie("Failed to save. Please try again.","error")}p(!1)},wn=(F,ue,T)=>{te(C=>({...C,[F]:{...C[F],[ue]:T===""?"":parseFloat(T)}}))},Xn=(F,ue)=>{me(T=>({...T,[F]:ue===""?"":parseFloat(ue)}))},Dn=(F,ue,T)=>{R(C=>({...C,[F]:{...C[F],[ue]:T===""?"":parseFloat(T)}}))},us=async()=>{p(!0);try{const F=`targets_${tt.id}`,ue=qe?.benchmarks||{},T={};_a.forEach(C=>{const K=ue[C.key];C.unit==="time"?j[C.key]?.targetValue&&(T[C.key]={targetType:"time",targetValue:j[C.key].targetValue,startValue:K?.time||0}):(j[C.key]?.targetWeight||j[C.key]?.targetReps)&&(T[C.key]={targetWeight:j[C.key].targetWeight||0,targetReps:j[C.key].targetReps||0,startWeight:K?.weight||0,startReps:K?.reps||0})}),await Vn(Ke(_e,"personalBestTargets",F),{clientId:tt.id,targets:T,metricTargets:Le,updatedAt:xt.now()}),ze(T),R(T),Ie("Targets saved!","success"),U(!1)}catch(F){console.error("Error saving targets:",F),Ie("Failed to save targets.","error")}p(!1)},vs=(F,ue)=>{M(T=>({...T,[F]:{...T[F],targetValue:ue===""?"":parseFloat(ue)}}))},Hn=async()=>{p(!0);try{const F=`targets_${tt.id}`,ue={};Ro.forEach(T=>{if(z[T.key]?.targetValue){const C=qe?.bodyMetrics?.[T.key]||0;ue[T.key]={targetValue:z[T.key].targetValue,startValue:C}}}),await Vn(Ke(_e,"personalBestTargets",F),{clientId:tt.id,targets:Ee,metricTargets:ue,updatedAt:xt.now()}),I(ue),M(ue),Ie("Metric targets saved!","success"),D(!1)}catch(F){console.error("Error saving metric targets:",F),Ie("Failed to save targets.","error")}p(!1)},hs=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=Ke(_e,"personalBestTargets",`targets_${tt.id}`);await ar(F),ze({}),I({}),R({}),M({}),Ie("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),Ie("Failed to reset goals","error")}p(!1)}},ds=(F,ue)=>{const T=Ee[F];if(!T||!ue)return null;if(T.targetType==="time"){if(!T.targetValue)return null;const Ve=T.startValue||0,Pe=T.targetValue,Vt=ue.time||0,kt=Pe-Ve;return kt<=0?Vt>=Pe?1:0:Math.max(0,Math.min((Vt-Ve)/kt,1))}if(!T.targetWeight&&!T.targetReps)return null;const C=(T.startWeight||0)*(T.startReps||0),K=(T.targetWeight||0)*(T.targetReps||0),ee=(ue.weight||0)*(ue.reps||0),Ue=K-C;return Ue<=0?ee>=K?1:0:Math.max(0,Math.min((ee-C)/Ue,1))},Ns=F=>{const ue=Le[F];if(!ue||!ue.targetValue)return null;const T=qe?.bodyMetrics?.[F];if(T==null)return null;const C=ue.startValue||0,K=ue.targetValue,ee=K-C;return ee===0?T===K?1:0:Math.max(0,Math.min((T-C)/ee,1))},Is=F=>{Et.current=F.touches[0].clientX,Bt.current=0},Os=F=>{Bt.current=F.touches[0].clientX-Et.current},q=()=>{Bt.current<-50?Ye(g+1):Bt.current>50&&Ye(g-1),Bt.current=0},ge=F=>{const ue=qe?.bodyMetrics?.[F],T=nn?.bodyMetrics?.[F];return ue==null||T==null?null:parseFloat((ue-T).toFixed(2))},we=n.find(F=>F.month===W),ve=n.find(F=>F.month===Ne);if(pt||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!le||!He||!tt)return null;if(xe&&tt?.isJunior)return a.jsx(wD,{});const pe=_a[g],ot=qe?.benchmarks?.[pe.key],Rt=nn?.benchmarks?.[pe.key],ut=Cl(pe,ot),_t=Cl(pe,Rt),bt=Yp(ut,_t),dn=ds(pe.key,ot),er=dn!==null,bs=dn!==null&&dn>=1,Ms=er?Math.round(dn*60):ut>0?15:0,Cn=Ee[pe.key];return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>at(ce?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:xe?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!xe&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(ke).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(ke).sort(([F],[ue])=>F.localeCompare(ue)).map(([F,ue],T)=>{const C=gt[F],K=nt(F),ee=K!==null&&K>=1,Ue=We(F),Ve=K!==null?Math.round(K*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${T*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:D3.map((Pe,Vt)=>{const kt=Vt<Ve;return a.jsx("line",{x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,className:`pb-ring-tick ${kt?ee?"hit":"filled":"empty"}`,strokeWidth:Pe.thick?"2":"1.5"},Vt)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:Ue?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:F}),a.jsxs("div",{className:"pb-cb-card-value",children:[ue.weight,"kg  ",ue.reps]}),ue.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(ue.achievedAt.toDate?ue.achievedAt.toDate():new Date(ue.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),C&&!ee&&a.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",C.targetWeight,"kg (",Math.round((K||0)*100),"%)"]}),C&&ee&&!Ue&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ue&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:C?ee&&Ue?a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(F),yn("")},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(F),yn("")},children:a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},F)})}),Object.keys(ke).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>at("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Nt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Ct(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:F=>F.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Nt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[ke[Nt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:oe,onChange:F=>yn(F.target.value),placeholder:String((ke[Nt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Ct(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ge,disabled:h,children:h?"Saving...":"Set Target"})]})]})})]}),xe&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!x&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:$t,onTouchStart:Is,onTouchMove:Os,onTouchEnd:q,children:[a.jsx("div",{className:`pb-ring-container slide-from-${ft.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Hy.map((F,ue)=>{const T=ue<Math.round(Ms);return a.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${T?bs?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},ue)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:pe.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[pe.name,Nn("strength",pe.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:ot?pe.unit==="time"?ud(ot.time):x2(ot.weight,ot.reps):"-"}),bt!==null&&a.jsxs("div",{className:`pb-ring-change ${bt>=0?"positive":"negative"}`,children:[bt>=0?"+":"",bt.toFixed(1),"%"]}),bt===null&&ot&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Cn&&a.jsx("div",{className:`pb-ring-target ${bs?"hit":""}`,children:bs?"Target hit!":Cn.targetType==="time"?`${Cn.startValue||0}s  ${Cn.targetValue}s`:`${Cn.startWeight||0}kg${Cn.startReps||0}  ${Cn.targetWeight}kg${Cn.targetReps}`}),!Cn&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:_a.map((F,ue)=>a.jsx("button",{className:`pb-dot ${ue===g?"active":""}`,onClick:()=>Ye(ue)},ue))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ye(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ye(g+1),disabled:g===_a.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(kD,{data:n,exerciseKey:pe.key,unit:pe.unit})]})]}),!x&&!G&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:qe?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(Ee).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Ee).length>0||Object.keys(Le).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:hs,disabled:h,children:"Reset All Goals"})]}),x&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",la(st)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),te(qe?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:_a.map(F=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[F.key]?.weight??"",onChange:ue=>wn(F.key,"weight",ue.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[F.key]?.reps??"",onChange:ue=>wn(F.key,"reps",ue.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[F.key]?.time??"",onChange:ue=>wn(F.key,"time",ue.target.value),placeholder:"0"})]})})]},F.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),te(qe?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Fn,disabled:h,children:h?"Saving...":"Save"})]})]}),G&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),R(Ee)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),_a.map(F=>{const ue=qe?.benchmarks?.[F.key];let T="-";return ue&&(F.unit==="time"&&ue.time?T=`${ue.time}s`:(ue.weight||ue.reps)&&(T=`${ue.weight||0}kg  ${ue.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",T]})]}),F.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:j[F.key]?.targetWeight??"",onChange:C=>Dn(F.key,"targetWeight",C.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:j[F.key]?.targetReps??"",onChange:C=>Dn(F.key,"targetReps",C.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:j[F.key]?.targetValue??"",onChange:C=>Dn(F.key,"targetValue",C.target.value),placeholder:"0"})]})})]},F.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),R(Ee)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:us,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!E&&!L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:la(st)}),a.jsx("div",{className:"pb-metrics-list",children:Ro.map(F=>{const ue=qe?.bodyMetrics?.[F.key],T=ge(F.key),C=Le[F.key],K=Ns(F.key),ee=K!==null&&K>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[F.name,Nn("metric",F.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),C&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",C.targetValue," ",F.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ue!=null?`${ue} ${F.suffix}`:"-"}),T!==null&&a.jsxs("span",{className:`pb-metric-change ${T>0?"up":T<0?"down":"same"}`,children:[T>0?"+":"",T," ",F.suffix]})]})]}),K!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${ee?"hit":""}`,style:{width:`${Math.round(K*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${ee?"hit":""}`,children:ee?"Hit!":`${Math.round(K*100)}%`})]})]},F.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:qe?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Le).length>0?"Edit Targets":"Set Targets"}),(Object.keys(Ee).length>0||Object.keys(Le).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:hs,disabled:h,children:"Reset All Goals"})]})]}),E&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",la(st)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),me(qe?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ro.map(F=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[F.name," (",F.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:X[F.key]??"",onChange:ue=>Xn(F.key,ue.target.value),placeholder:"0"})]})},F.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),me(qe?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ut,disabled:h,children:h?"Saving...":"Save"})]})]}),L&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Le)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ro.map(F=>{const ue=qe?.bodyMetrics?.[F.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ue!=null?`${ue} ${F.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",F.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:z[F.key]?.targetValue??"",onChange:T=>vs(F.key,T.target.value),placeholder:"0"})]})})]},F.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Le)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Hn,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:n.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[Fe.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...Fe].reverse().map((F,ue)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ue*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:F.label}),a.jsx("span",{className:"pb-achievement-date",children:la(F.achievedMonth)})]})]},ue))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ae?"active":""}`,onClick:()=>{P(!ae),!ae&&n.length>=2&&(ye(n[0].month),Be(n[n.length-1].month))},children:ae?"Back to Timeline":"Compare Months"})}),ae?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:W,onChange:F=>ye(F.target.value),children:n.map(F=>a.jsx("option",{value:F.month,children:la(F.month)},F.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ne,onChange:F=>Be(F.target.value),children:n.map(F=>a.jsx("option",{value:F.month,children:la(F.month)},F.month))})]})]}),we&&ve&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:la(W).split(" ")[0]}),a.jsx("span",{children:la(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),_a.map(F=>{const ue=we.benchmarks?.[F.key],T=ve.benchmarks?.[F.key],C=Cl(F,ue),K=Cl(F,T),ee=Yp(K,C);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:F.name}),a.jsx("span",{className:"pb-compare-val",children:ue?F.unit==="time"?ud(ue.time):`${ue.weight}x${ue.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T?F.unit==="time"?ud(T.time):`${T.weight}x${T.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ee!==null?ee>=0?"positive":"negative":""}`,children:ee!==null?`${ee>=0?"+":""}${ee.toFixed(1)}%`:"-"})]},F.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:la(W).split(" ")[0]}),a.jsx("span",{children:la(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ro.map(F=>{const ue=we.bodyMetrics?.[F.key],T=ve.bodyMetrics?.[F.key],C=ue!=null&&T!=null?parseFloat((T-ue).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:F.name}),a.jsx("span",{className:"pb-compare-val",children:ue!=null?`${ue}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T!=null?`${T}`:"-"}),a.jsx("span",{className:`pb-compare-change ${C!==null?C>0?"positive":C<0?"negative":"neutral":""}`,children:C!==null?`${C>0?"+":""}${C} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...n].reverse().map((F,ue)=>{const T=n.find(C=>C.month<F.month&&n.indexOf(C)===n.indexOf(F)-1)||n.filter(C=>C.month<F.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ue*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:la(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),_a.map(C=>{const K=F.benchmarks[C.key];if(!K)return null;const ee=T?.benchmarks?.[C.key],Ue=Cl(C,K),Ve=Cl(C,ee),Pe=Yp(Ue,Ve);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:C.unit==="time"?ud(K.time):x2(K.weight,K.reps)}),Pe!==null&&a.jsxs("span",{className:`pb-timeline-change ${Pe>=0?"positive":"negative"}`,children:[Pe>=0?"+":"",Pe.toFixed(1),"%"]})]})]},C.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Ro.map(C=>{const K=F.bodyMetrics[C.key];if(K==null)return null;const ee=T?.bodyMetrics?.[C.key],Ue=ee!=null?parseFloat((K-ee).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[K," ",C.suffix]}),Ue!==null&&a.jsxs("span",{className:`pb-timeline-change ${Ue>0?"positive":Ue<0?"negative":"neutral"}`,children:[Ue>0?"+":"",Ue," ",C.suffix]})]})]},C.key)})]})]})]},F.id)})})]})})]})]}),Y&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Se(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:Y.length===1?"Target Achieved!":`${Y.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:Y.map((F,ue)=>a.jsx("div",{className:"pb-celebration-badge",children:F.label},ue))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Oe&&a.jsxs("div",{className:`toast-notification ${Oe.type}`,children:[a.jsx("span",{className:"toast-icon",children:Oe.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Oe.message}),a.jsx("button",{className:"toast-close",onClick:()=>ht(null),children:""})]}),xe&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>at("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>at("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>at("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),tt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>at("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),ce&&a.jsx(Ma,{active:"progress"})]})}const jD=w.lazy(()=>Qr(()=>import("./Dashboard-DnsQfpRI.js"),__vite__mapDeps([0,1]))),ED=w.lazy(()=>Qr(()=>import("./AddClient-BKxD1fzZ.js"),__vite__mapDeps([2,3]))),SD=w.lazy(()=>Qr(()=>import("./ClientDashboard-COCwHs7F.js"),[])),ND=w.lazy(()=>Qr(()=>import("./ClientForms-1spnDE0e.js"),__vite__mapDeps([4,5]))),CD=w.lazy(()=>Qr(()=>import("./ClientTools-vOdqpGGW.js"),__vite__mapDeps([6,7]))),RD=w.lazy(()=>Qr(()=>import("./MacroCalculator-BAnCugnW.js"),__vite__mapDeps([8,7]))),AD=w.lazy(()=>Qr(()=>import("./ProteinSnacks-DM7pSRCD.js"),__vite__mapDeps([9,7]))),ID=w.lazy(()=>Qr(()=>import("./DailyMotivation-BE2KKhc2.js"),__vite__mapDeps([10,7]))),MD=w.lazy(()=>Qr(()=>import("./CircuitDashboard-UtYcVFVB.js"),__vite__mapDeps([11,12]))),DD=w.lazy(()=>Qr(()=>import("./CircuitBooking-DxKWSgo4.js"),__vite__mapDeps([13,14,12]))),PD=w.lazy(()=>Qr(()=>import("./Leaderboard-BzEhaGbC.js"),__vite__mapDeps([15,16])));function LD({children:s}){const{pathname:e}=ma();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function OD(){const s=Zs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const n=e.replace("/login","")||"/";s(n,{replace:!0})}},[s]),null}function VD(){return a.jsx(A3,{children:a.jsx(R3,{children:a.jsxs(VE,{basename:"/login",children:[a.jsx(OD,{}),a.jsx(LD,{children:a.jsx(w.Suspense,{fallback:null,children:a.jsxs(fE,{children:[a.jsx(ss,{path:"/",element:a.jsx(I3,{})}),a.jsx(ss,{path:"/dashboard",element:a.jsx(jD,{})}),a.jsx(ss,{path:"/add-client",element:a.jsx(ED,{})}),a.jsx(ss,{path:"/client",element:a.jsx(SD,{})}),a.jsx(ss,{path:"/client/forms",element:a.jsx(ND,{})}),a.jsx(ss,{path:"/client/tools",element:a.jsx(CD,{})}),a.jsx(ss,{path:"/client/tools/macros",element:a.jsx(RD,{})}),a.jsx(ss,{path:"/client/tools/snacks",element:a.jsx(AD,{})}),a.jsx(ss,{path:"/client/tools/motivation",element:a.jsx(ID,{})}),a.jsx(ss,{path:"/client/personal-bests",element:a.jsx(TD,{})}),a.jsx(ss,{path:"/client/circuit",element:a.jsx(MD,{})}),a.jsx(ss,{path:"/client/circuit/booking",element:a.jsx(DD,{})}),a.jsx(ss,{path:"/client/core-buddy",element:a.jsx(B3,{})}),a.jsx(ss,{path:"/client/core-buddy/nutrition",element:a.jsx(F3,{})}),a.jsx(ss,{path:"/client/core-buddy/workouts",element:a.jsx(eD,{})}),a.jsx(ss,{path:"/client/core-buddy/programmes",element:a.jsx(aD,{})}),a.jsx(ss,{path:"/client/core-buddy/achievements",element:a.jsx(hD,{})}),a.jsx(ss,{path:"/client/core-buddy/consistency",element:a.jsx(mD,{})}),a.jsx(ss,{path:"/client/core-buddy/buddies",element:a.jsx(pD,{})}),a.jsx(ss,{path:"/client/core-buddy/profile/:userId",element:a.jsx(gD,{})}),a.jsx(ss,{path:"/client/leaderboard",element:a.jsx(PD,{})}),a.jsx(ss,{path:"*",element:a.jsx(hE,{to:"/",replace:!0})})]})})})]})})})}dj.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(VD,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Ma as C,xt as T,ri as a,ar as b,Jt as c,_e as d,Ke as e,BD as f,Tn as g,PC as h,Qn as i,a as j,Xr as k,Pa as l,Zs as m,Hy as n,Hd as o,Vn as p,Mn as q,w as r,zD as s,Hi as u,xn as w};
