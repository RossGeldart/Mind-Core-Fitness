const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-i9G5O8CM.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-uyC5AmZj.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-DTaRSEwu.js","assets/ClientForms-BUCkS4zY.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-CBnUG-Xo.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-Y5xrOQLi.js","assets/ProteinSnacks-BhPtMVMe.js","assets/DailyMotivation-CuB5mjSK.js","assets/CircuitDashboard-C1HhL03l.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-jsISYcqf.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-CHBm1dCP.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-DYTFgYaE.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-B0bN50-v.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var _p={exports:{}},Zc={};var j1;function NT(){if(j1)return Zc;j1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Zc.Fragment=e,Zc.jsx=t,Zc.jsxs=t,Zc}var T1;function CT(){return T1||(T1=1,_p.exports=NT()),_p.exports}var r=CT(),kp={exports:{}},ds={};var S1;function RT(){if(S1)return ds;S1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,D={};function te(P,ne,De){this.props=P,this.context=ne,this.refs=D,this.updater=De||G}te.prototype.isReactComponent={},te.prototype.setState=function(P,ne){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ne,"setState")},te.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Y(){}Y.prototype=te.prototype;function Z(P,ne,De){this.props=P,this.context=ne,this.refs=D,this.updater=De||G}var _e=Z.prototype=new Y;_e.constructor=Z,B(_e,te.prototype),_e.isPureReactComponent=!0;var Me=Array.isArray;function we(){}var N={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function M(P,ne,De){var ze=De.ref;return{$$typeof:n,type:P,key:ne,ref:ze!==void 0?ze:null,props:De}}function V(P,ne){return M(P.type,ne,P.props)}function I(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function L(P){var ne={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(De){return ne[De]})}var R=/\/+/g;function Ie(P,ne){return typeof P=="object"&&P!==null&&P.key!=null?L(""+P.key):ne.toString(36)}function mt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(we,we):(P.status="pending",P.then(function(ne){P.status==="pending"&&(P.status="fulfilled",P.value=ne)},function(ne){P.status==="pending"&&(P.status="rejected",P.reason=ne)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function $(P,ne,De,ze,Be){var Pe=typeof P;(Pe==="undefined"||Pe==="boolean")&&(P=null);var ut=!1;if(P===null)ut=!0;else switch(Pe){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(P.$$typeof){case n:case e:ut=!0;break;case x:return ut=P._init,$(ut(P._payload),ne,De,ze,Be)}}if(ut)return Be=Be(P),ut=ze===""?"."+Ie(P,0):ze,Me(Be)?(De="",ut!=null&&(De=ut.replace(R,"$&/")+"/"),$(Be,ne,De,"",function(os){return os})):Be!=null&&(I(Be)&&(Be=V(Be,De+(Be.key==null||P&&P.key===Be.key?"":(""+Be.key).replace(R,"$&/")+"/")+ut)),ne.push(Be)),1;ut=0;var bt=ze===""?".":ze+":";if(Me(P))for(var ot=0;ot<P.length;ot++)ze=P[ot],Pe=bt+Ie(ze,ot),ut+=$(ze,ne,De,Pe,Be);else if(ot=O(P),typeof ot=="function")for(P=ot.call(P),ot=0;!(ze=P.next()).done;)ze=ze.value,Pe=bt+Ie(ze,ot++),ut+=$(ze,ne,De,Pe,Be);else if(Pe==="object"){if(typeof P.then=="function")return $(mt(P),ne,De,ze,Be);throw ne=String(P),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return ut}function ye(P,ne,De){if(P==null)return P;var ze=[],Be=0;return $(P,ze,"","",function(Pe){return ne.call(De,Pe,Be++)}),ze}function Ue(P){if(P._status===-1){var ne=P._result;ne=ne(),ne.then(function(De){(P._status===0||P._status===-1)&&(P._status=1,P._result=De)},function(De){(P._status===0||P._status===-1)&&(P._status=2,P._result=De)}),P._status===-1&&(P._status=0,P._result=ne)}if(P._status===1)return P._result.default;throw P._result}var Ye=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},X={map:ye,forEach:function(P,ne,De){ye(P,function(){ne.apply(this,arguments)},De)},count:function(P){var ne=0;return ye(P,function(){ne++}),ne},toArray:function(P){return ye(P,function(ne){return ne})||[]},only:function(P){if(!I(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return ds.Activity=_,ds.Children=X,ds.Component=te,ds.Fragment=t,ds.Profiler=l,ds.PureComponent=Z,ds.StrictMode=i,ds.Suspense=g,ds.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,ds.__COMPILER_RUNTIME={__proto__:null,c:function(P){return N.H.useMemoCache(P)}},ds.cache=function(P){return function(){return P.apply(null,arguments)}},ds.cacheSignal=function(){return null},ds.cloneElement=function(P,ne,De){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var ze=B({},P.props),Be=P.key;if(ne!=null)for(Pe in ne.key!==void 0&&(Be=""+ne.key),ne)!T.call(ne,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&ne.ref===void 0||(ze[Pe]=ne[Pe]);var Pe=arguments.length-2;if(Pe===1)ze.children=De;else if(1<Pe){for(var ut=Array(Pe),bt=0;bt<Pe;bt++)ut[bt]=arguments[bt+2];ze.children=ut}return M(P.type,Be,ze)},ds.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},ds.createElement=function(P,ne,De){var ze,Be={},Pe=null;if(ne!=null)for(ze in ne.key!==void 0&&(Pe=""+ne.key),ne)T.call(ne,ze)&&ze!=="key"&&ze!=="__self"&&ze!=="__source"&&(Be[ze]=ne[ze]);var ut=arguments.length-2;if(ut===1)Be.children=De;else if(1<ut){for(var bt=Array(ut),ot=0;ot<ut;ot++)bt[ot]=arguments[ot+2];Be.children=bt}if(P&&P.defaultProps)for(ze in ut=P.defaultProps,ut)Be[ze]===void 0&&(Be[ze]=ut[ze]);return M(P,Pe,Be)},ds.createRef=function(){return{current:null}},ds.forwardRef=function(P){return{$$typeof:p,render:P}},ds.isValidElement=I,ds.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:Ue}},ds.memo=function(P,ne){return{$$typeof:y,type:P,compare:ne===void 0?null:ne}},ds.startTransition=function(P){var ne=N.T,De={};N.T=De;try{var ze=P(),Be=N.S;Be!==null&&Be(De,ze),typeof ze=="object"&&ze!==null&&typeof ze.then=="function"&&ze.then(we,Ye)}catch(Pe){Ye(Pe)}finally{ne!==null&&De.types!==null&&(ne.types=De.types),N.T=ne}},ds.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},ds.use=function(P){return N.H.use(P)},ds.useActionState=function(P,ne,De){return N.H.useActionState(P,ne,De)},ds.useCallback=function(P,ne){return N.H.useCallback(P,ne)},ds.useContext=function(P){return N.H.useContext(P)},ds.useDebugValue=function(){},ds.useDeferredValue=function(P,ne){return N.H.useDeferredValue(P,ne)},ds.useEffect=function(P,ne){return N.H.useEffect(P,ne)},ds.useEffectEvent=function(P){return N.H.useEffectEvent(P)},ds.useId=function(){return N.H.useId()},ds.useImperativeHandle=function(P,ne,De){return N.H.useImperativeHandle(P,ne,De)},ds.useInsertionEffect=function(P,ne){return N.H.useInsertionEffect(P,ne)},ds.useLayoutEffect=function(P,ne){return N.H.useLayoutEffect(P,ne)},ds.useMemo=function(P,ne){return N.H.useMemo(P,ne)},ds.useOptimistic=function(P,ne){return N.H.useOptimistic(P,ne)},ds.useReducer=function(P,ne,De){return N.H.useReducer(P,ne,De)},ds.useRef=function(P){return N.H.useRef(P)},ds.useState=function(P){return N.H.useState(P)},ds.useSyncExternalStore=function(P,ne,De){return N.H.useSyncExternalStore(P,ne,De)},ds.useTransition=function(){return N.H.useTransition()},ds.version="19.2.4",ds}var E1;function Bg(){return E1||(E1=1,kp.exports=RT()),kp.exports}var b=Bg(),jp={exports:{}},eu={},Tp={exports:{}},Sp={};var N1;function AT(){return N1||(N1=1,(function(n){function e($,ye){var Ue=$.length;$.push(ye);e:for(;0<Ue;){var Ye=Ue-1>>>1,X=$[Ye];if(0<l(X,ye))$[Ye]=ye,$[Ue]=X,Ue=Ye;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var ye=$[0],Ue=$.pop();if(Ue!==ye){$[0]=Ue;e:for(var Ye=0,X=$.length,P=X>>>1;Ye<P;){var ne=2*(Ye+1)-1,De=$[ne],ze=ne+1,Be=$[ze];if(0>l(De,Ue))ze<X&&0>l(Be,De)?($[Ye]=Be,$[ze]=Ue,Ye=ze):($[Ye]=De,$[ne]=Ue,Ye=ne);else if(ze<X&&0>l(Be,Ue))$[Ye]=Be,$[ze]=Ue,Ye=ze;else break e}}return ye}function l($,ye){var Ue=$.sortIndex-ye.sortIndex;return Ue!==0?Ue:$.id-ye.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,_=null,j=3,O=!1,G=!1,B=!1,D=!1,te=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function _e($){for(var ye=t(y);ye!==null;){if(ye.callback===null)i(y);else if(ye.startTime<=$)i(y),ye.sortIndex=ye.expirationTime,e(g,ye);else break;ye=t(y)}}function Me($){if(B=!1,_e($),!G)if(t(g)!==null)G=!0,we||(we=!0,L());else{var ye=t(y);ye!==null&&mt(Me,ye.startTime-$)}}var we=!1,N=-1,T=5,M=-1;function V(){return D?!0:!(n.unstable_now()-M<T)}function I(){if(D=!1,we){var $=n.unstable_now();M=$;var ye=!0;try{e:{G=!1,B&&(B=!1,Y(N),N=-1),O=!0;var Ue=j;try{t:{for(_e($),_=t(g);_!==null&&!(_.expirationTime>$&&V());){var Ye=_.callback;if(typeof Ye=="function"){_.callback=null,j=_.priorityLevel;var X=Ye(_.expirationTime<=$);if($=n.unstable_now(),typeof X=="function"){_.callback=X,_e($),ye=!0;break t}_===t(g)&&i(g),_e($)}else i(g);_=t(g)}if(_!==null)ye=!0;else{var P=t(y);P!==null&&mt(Me,P.startTime-$),ye=!1}}break e}finally{_=null,j=Ue,O=!1}ye=void 0}}finally{ye?L():we=!1}}}var L;if(typeof Z=="function")L=function(){Z(I)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,Ie=R.port2;R.port1.onmessage=I,L=function(){Ie.postMessage(null)}}else L=function(){te(I,0)};function mt($,ye){N=te(function(){$(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function($){switch(j){case 1:case 2:case 3:var ye=3;break;default:ye=j}var Ue=j;j=ye;try{return $()}finally{j=Ue}},n.unstable_requestPaint=function(){D=!0},n.unstable_runWithPriority=function($,ye){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Ue=j;j=$;try{return ye()}finally{j=Ue}},n.unstable_scheduleCallback=function($,ye,Ue){var Ye=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?Ye+Ue:Ye):Ue=Ye,$){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Ue+X,$={id:x++,callback:ye,priorityLevel:$,startTime:Ue,expirationTime:X,sortIndex:-1},Ue>Ye?($.sortIndex=Ue,e(y,$),t(g)===null&&$===t(y)&&(B?(Y(N),N=-1):B=!0,mt(Me,Ue-Ye))):($.sortIndex=X,e(g,$),G||O||(G=!0,we||(we=!0,L()))),$},n.unstable_shouldYield=V,n.unstable_wrapCallback=function($){var ye=j;return function(){var Ue=j;j=ye;try{return $.apply(this,arguments)}finally{j=Ue}}}})(Sp)),Sp}var C1;function MT(){return C1||(C1=1,Tp.exports=AT()),Tp.exports}var Ep={exports:{}},ur={};var R1;function IT(){if(R1)return ur;R1=1;var n=Bg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ur.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ur.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},ur.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},ur.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},ur.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ur.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:_,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ur.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},ur.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ur.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},ur.requestFormReset=function(g){i.d.r(g)},ur.unstable_batchedUpdates=function(g,y){return g(y)},ur.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},ur.useFormStatus=function(){return d.H.useHostTransitionStatus()},ur.version="19.2.4",ur}var A1;function DT(){if(A1)return Ep.exports;A1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ep.exports=IT(),Ep.exports}var M1;function PT(){if(M1)return eu;M1=1;var n=MT(),e=Bg(),t=DT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,E=m.child;E;){if(E===o){w=!0,o=m,c=f;break}if(E===c){w=!0,c=m,o=f;break}E=E.sibling}if(!w){for(E=f.child;E;){if(E===o){w=!0,o=f,c=m;break}if(E===c){w=!0,c=f,o=m;break}E=E.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),_e=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var R=Symbol.for("react.client.reference");function Ie(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===R?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case te:return"Profiler";case D:return"StrictMode";case Me:return"Suspense";case we:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case G:return"Portal";case Z:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case _e:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return a=s.displayName||null,a!==null?a:Ie(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return Ie(s(a))}catch{}}return null}var mt=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue={pending:!1,data:null,method:null,action:null},Ye=[],X=-1;function P(s){return{current:s}}function ne(s){0>X||(s.current=Ye[X],Ye[X]=null,X--)}function De(s,a){X++,Ye[X]=s.current,s.current=a}var ze=P(null),Be=P(null),Pe=P(null),ut=P(null);function bt(s,a){switch(De(Pe,a),De(Be,s),De(ze,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?G0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=G0(a),s=K0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ne(ze),De(ze,s)}function ot(){ne(ze),ne(Be),ne(Pe)}function os(s){s.memoizedState!==null&&De(ut,s);var a=ze.current,o=K0(a,s.type);a!==o&&(De(Be,s),De(ze,o))}function As(s){Be.current===s&&(ne(ze),ne(Be)),ut.current===s&&(ne(ut),Yc._currentValue=Ue)}var ts,Rt;function Pt(s){if(ts===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);ts=a&&a[1]||"",Rt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ts+s+Rt}var qt=!1;function It(s,a){if(!s||qt)return"";qt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var qe=function(){throw Error()};if(Object.defineProperty(qe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(qe,[])}catch(xe){var fe=xe}Reflect.construct(s,[],qe)}else{try{qe.call()}catch(xe){fe=xe}s.call(qe.prototype)}}else{try{throw Error()}catch(xe){fe=xe}(qe=s())&&typeof qe.catch=="function"&&qe.catch(function(){})}}catch(xe){if(xe&&fe&&typeof xe.stack=="string")return[xe.stack,fe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],E=f[1];if(w&&E){var H=w.split(`
`),ce=E.split(`
`);for(m=c=0;c<H.length&&!H[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ce.length&&!ce[m].includes("DetermineComponentFrameRoot");)m++;if(c===H.length||m===ce.length)for(c=H.length-1,m=ce.length-1;1<=c&&0<=m&&H[c]!==ce[m];)m--;for(;1<=c&&0<=m;c--,m--)if(H[c]!==ce[m]){if(c!==1||m!==1)do if(c--,m--,0>m||H[c]!==ce[m]){var Re=`
`+H[c].replace(" at new "," at ");return s.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",s.displayName)),Re}while(1<=c&&0<=m);break}}}finally{qt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Pt(o):""}function Ms(s,a){switch(s.tag){case 26:case 27:case 5:return Pt(s.type);case 16:return Pt("Lazy");case 13:return s.child!==a&&a!==null?Pt("Suspense Fallback"):Pt("Suspense");case 19:return Pt("SuspenseList");case 0:case 15:return It(s.type,!1);case 11:return It(s.type.render,!1);case 1:return It(s.type,!0);case 31:return Pt("Activity");default:return""}}function Vt(s){try{var a="",o=null;do a+=Ms(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ot=Object.prototype.hasOwnProperty,se=n.unstable_scheduleCallback,Ht=n.unstable_cancelCallback,Dt=n.unstable_shouldYield,zt=n.unstable_requestPaint,wt=n.unstable_now,gt=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,rs=n.unstable_UserBlockingPriority,vs=n.unstable_NormalPriority,tn=n.unstable_LowPriority,Ys=n.unstable_IdlePriority,Qs=n.log,ls=n.unstable_setDisableYieldValue,xs=null,ge=null;function Le(s){if(typeof Qs=="function"&&ls(s),ge&&typeof ge.setStrictMode=="function")try{ge.setStrictMode(xs,s)}catch{}}var je=Math.clz32?Math.clz32:rt,st=Math.log,We=Math.LN2;function rt(s){return s>>>=0,s===0?32:31-(st(s)/We|0)|0}var pt=256,J=262144,re=4194304;function Ze(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Et(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var E=c&134217727;return E!==0?(c=E&~f,c!==0?m=Ze(c):(w&=E,w!==0?m=Ze(w):o||(o=E&~s,o!==0&&(m=Ze(o))))):(E=c&~f,E!==0?m=Ze(E):w!==0?m=Ze(w):o||(o=c&~s,o!==0&&(m=Ze(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function tt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Nt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q(){var s=re;return re<<=1,(re&62914560)===0&&(re=4194304),s}function Ae(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Qe(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function dt(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var E=s.entanglements,H=s.expirationTimes,ce=s.hiddenUpdates;for(o=w&~o;0<o;){var Re=31-je(o),qe=1<<Re;E[Re]=0,H[Re]=-1;var fe=ce[Re];if(fe!==null)for(ce[Re]=null,Re=0;Re<fe.length;Re++){var xe=fe[Re];xe!==null&&(xe.lane&=-536870913)}o&=~qe}c!==0&&at(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function at(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-je(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function ss(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-je(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function ns(s,a){var o=a&-a;return o=(o&42)!==0?1:F(o),(o&(s.suspendedLanes|a))!==0?0:o}function F(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function pe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ne(){var s=ye.p;return s!==0?s:(s=window.event,s===void 0?32:y1(s.type))}function Ee(s,a){var o=ye.p;try{return ye.p=s,a()}finally{ye.p=o}}var Ce=Math.random().toString(36).slice(2),xt="__reactFiber$"+Ce,At="__reactProps$"+Ce,ht="__reactContainer$"+Ce,$t="__reactEvents$"+Ce,Bt="__reactListeners$"+Ce,$s="__reactHandles$"+Ce,yn="__reactResources$"+Ce,dn="__reactMarker$"+Ce;function In(s){delete s[xt],delete s[At],delete s[$t],delete s[Bt],delete s[$s]}function hn(s){var a=s[xt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[ht]||o[xt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=t1(s);s!==null;){if(o=s[xt])return o;s=t1(s)}return a}s=o,o=s.parentNode}return null}function sn(s){if(s=s[xt]||s[ht]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function ys(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function K(s){var a=s[yn];return a||(a=s[yn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function he(s){s[dn]=!0}var ie=new Set,be={};function Ge(s,a){Tt(s,a),Tt(s+"Capture",a)}function Tt(s,a){for(be[s]=a,s=0;s<a.length;s++)ie.add(a[s])}var Xt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lt={},Wt={};function ps(s){return Ot.call(Wt,s)?!0:Ot.call(Lt,s)?!1:Xt.test(s)?Wt[s]=!0:(Lt[s]=!0,!1)}function Vs(s,a,o){if(ps(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function Is(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function C(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function q(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function de(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ke(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function it(s){if(!s._valueTracker){var a=de(s)?"checked":"value";s._valueTracker=ke(s,a,""+s[a])}}function _t(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=de(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function yt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _s=/[\n"\\]/g;function Gt(s){return s.replace(_s,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function vn(s,a,o,c,m,f,w,E){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+q(a)):s.value!==""+q(a)&&(s.value=""+q(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?yr(s,w,q(a)):o!=null?yr(s,w,q(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.name=""+q(E):s.removeAttribute("name")}function gr(s,a,o,c,m,f,w,E){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){it(s);return}o=o!=null?""+q(o):"",a=a!=null?""+q(a):o,E||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=E?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),it(s)}function yr(s,a,o){a==="number"&&yt(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function $n(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+q(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function ma(s,a,o){if(a!=null&&(a=""+q(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+q(o):""}function Vr(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(mt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=q(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),it(s)}function Wn(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Mi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ei(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Mi.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Er(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&ei(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&ei(s,f,a[f])}function Da(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ii=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ur(s){return Zr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Gn(){}var Kn=null;function xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Fr=null,br=null;function fa(s){var a=sn(s);if(a&&(s=a.stateNode)){var o=s[At]||null;e:switch(s=a.stateNode,a.type){case"input":if(vn(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Gt(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[At]||null;if(!m)throw Error(i(90));vn(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&_t(c)}break e;case"textarea":ma(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&$n(s,!!o.multiple,a,!1)}}}var lr=!1;function z(s,a,o){if(lr)return s(a,o);lr=!0;try{var c=s(a);return c}finally{if(lr=!1,(Fr!==null||br!==null)&&(Ld(),Fr&&(a=Fr,s=br,br=Fr=null,fa(a),s)))for(a=0;a<s.length;a++)fa(s[a])}}function le(s,a){var o=s.stateNode;if(o===null)return null;var c=o[At]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var ue=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fe=!1;if(ue)try{var Se={};Object.defineProperty(Se,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",Se,Se),window.removeEventListener("test",Se,Se)}catch{Fe=!1}var et=null,vt=null,Kt=null;function cs(){if(Kt)return Kt;var s,a=vt,o=a.length,c,m="value"in et?et.value:et.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return Kt=m.slice(s,1<c?1-c:void 0)}function S(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function U(){return!0}function Te(){return!1}function Xe(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var E in s)s.hasOwnProperty(E)&&(o=s[E],this[E]=o?o(f):f[E]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?U:Te,this.isPropagationStopped=Te,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=U)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=U)},persist:function(){},isPersistent:U}),a}var He={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nt=Xe(He),Ke=_({},He,{view:0,detail:0}),lt=Xe(Ke),jt,us,as,ws=_({},Ke,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pa,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==as&&(as&&s.type==="mousemove"?(jt=s.screenX-as.screenX,us=s.screenY-as.screenY):us=jt=0,as=s),jt)},movementY:function(s){return"movementY"in s?s.movementY:us}}),ln=Xe(ws),mn=_({},ws,{dataTransfer:0}),zs=Xe(mn),an=_({},Ke,{relatedTarget:0}),Nn=Xe(an),wn=_({},He,{animationName:0,elapsedTime:0,pseudoElement:0}),Xn=Xe(wn),Jn=_({},He,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Nr=Xe(Jn),vr=_({},He,{data:0}),_n=Xe(vr),Fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function So(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Rr[s])?!!a[s]:!1}function Pa(){return So}var Zn=_({},Ke,{key:function(s){if(s.key){var a=Fn[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=S(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Cr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pa,charCode:function(s){return s.type==="keypress"?S(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?S(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ti=Xe(Zn),pa=_({},ws,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cr=Xe(pa),h=_({},Ke,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pa}),v=Xe(h),k=_({},He,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Xe(k),ae=_({},ws,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ve=Xe(ae),ct=_({},He,{newState:0,oldState:0}),ms=Xe(ct),Cn=[9,13,27,32],qs=ue&&"CompositionEvent"in window,fn=null;ue&&"documentMode"in document&&(fn=document.documentMode);var ea=ue&&"TextEvent"in window&&!fn,La=ue&&(!qs||fn&&8<fn&&11>=fn),ga=" ",ya=!1;function Eo(s,a){switch(s){case"keyup":return Cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ul(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var dl=!1;function Jk(s,a){switch(s){case"compositionend":return ul(a);case"keypress":return a.which!==32?null:(ya=!0,ga);case"textInput":return s=a.data,s===ga&&ya?null:s;default:return null}}function Zk(s,a){if(dl)return s==="compositionend"||!qs&&Eo(s,a)?(s=cs(),Kt=vt=et=null,dl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return La&&a.locale!=="ko"?null:a.data;default:return null}}var ej={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!ej[s.type]:a==="textarea"}function ab(s,a,o,c){Fr?br?br.push(c):br=[c]:Fr=c,a=qd(a,"onChange"),0<a.length&&(o=new nt("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var yc=null,bc=null;function tj(s){F0(s,0)}function td(s){var a=ys(s);if(_t(a))return s}function ib(s,a){if(s==="change")return a}var ob=!1;if(ue){var Nm;if(ue){var Cm="oninput"in document;if(!Cm){var lb=document.createElement("div");lb.setAttribute("oninput","return;"),Cm=typeof lb.oninput=="function"}Nm=Cm}else Nm=!1;ob=Nm&&(!document.documentMode||9<document.documentMode)}function cb(){yc&&(yc.detachEvent("onpropertychange",ub),bc=yc=null)}function ub(s){if(s.propertyName==="value"&&td(bc)){var a=[];ab(a,bc,s,xn(s)),z(tj,a)}}function sj(s,a,o){s==="focusin"?(cb(),yc=a,bc=o,yc.attachEvent("onpropertychange",ub)):s==="focusout"&&cb()}function nj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return td(bc)}function rj(s,a){if(s==="click")return td(a)}function aj(s,a){if(s==="input"||s==="change")return td(a)}function ij(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var zr=typeof Object.is=="function"?Object.is:ij;function vc(s,a){if(zr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Ot.call(a,m)||!zr(s[m],a[m]))return!1}return!0}function db(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function hb(s,a){var o=db(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=db(o)}}function mb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?mb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function fb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=yt(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=yt(s.document)}return a}function Rm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var oj=ue&&"documentMode"in document&&11>=document.documentMode,hl=null,Am=null,xc=null,Mm=!1;function pb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Mm||hl==null||hl!==yt(c)||(c=hl,"selectionStart"in c&&Rm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),xc&&vc(xc,c)||(xc=c,c=qd(Am,"onSelect"),0<c.length&&(a=new nt("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=hl)))}function No(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ml={animationend:No("Animation","AnimationEnd"),animationiteration:No("Animation","AnimationIteration"),animationstart:No("Animation","AnimationStart"),transitionrun:No("Transition","TransitionRun"),transitionstart:No("Transition","TransitionStart"),transitioncancel:No("Transition","TransitionCancel"),transitionend:No("Transition","TransitionEnd")},Im={},gb={};ue&&(gb=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Co(s){if(Im[s])return Im[s];if(!ml[s])return s;var a=ml[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in gb)return Im[s]=a[o];return s}var yb=Co("animationend"),bb=Co("animationiteration"),vb=Co("animationstart"),lj=Co("transitionrun"),cj=Co("transitionstart"),uj=Co("transitioncancel"),xb=Co("transitionend"),wb=new Map,Dm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dm.push("scrollEnd");function ba(s,a){wb.set(s,a),Ge(a,[s])}var sd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ta=[],fl=0,Pm=0;function nd(){for(var s=fl,a=Pm=fl=0;a<s;){var o=ta[a];ta[a++]=null;var c=ta[a];ta[a++]=null;var m=ta[a];ta[a++]=null;var f=ta[a];if(ta[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&_b(o,m,f)}}function rd(s,a,o,c){ta[fl++]=s,ta[fl++]=a,ta[fl++]=o,ta[fl++]=c,Pm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Lm(s,a,o,c){return rd(s,a,o,c),ad(s)}function Ro(s,a){return rd(s,null,null,a),ad(s)}function _b(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-je(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ad(s){if(50<zc)throw zc=0,Wf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var pl={};function dj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(s,a,o,c){return new dj(s,a,o,c)}function Om(s){return s=s.prototype,!(!s||!s.isReactComponent)}function si(s,a){var o=s.alternate;return o===null?(o=qr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function kb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function id(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Om(s)&&(w=1);else if(typeof s=="string")w=gT(s,o,ze.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=qr(31,o,a,m),s.elementType=M,s.lanes=f,s;case B:return Ao(o.children,m,f,a);case D:w=8,m|=24;break;case te:return s=qr(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case Me:return s=qr(13,o,a,m),s.elementType=Me,s.lanes=f,s;case we:return s=qr(19,o,a,m),s.elementType=we,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Z:w=10;break e;case Y:w=9;break e;case _e:w=11;break e;case N:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=qr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function Ao(s,a,o,c){return s=qr(7,s,c,a),s.lanes=o,s}function Bm(s,a,o){return s=qr(6,s,null,a),s.lanes=o,s}function jb(s){var a=qr(18,null,null,0);return a.stateNode=s,a}function Vm(s,a,o){return a=qr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Tb=new WeakMap;function sa(s,a){if(typeof s=="object"&&s!==null){var o=Tb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Vt(a)},Tb.set(s,a),a)}return{value:s,source:a,stack:Vt(a)}}var gl=[],yl=0,od=null,wc=0,na=[],ra=0,Di=null,Oa=1,Ba="";function ni(s,a){gl[yl++]=wc,gl[yl++]=od,od=s,wc=a}function Sb(s,a,o){na[ra++]=Oa,na[ra++]=Ba,na[ra++]=Di,Di=s;var c=Oa;s=Ba;var m=32-je(c)-1;c&=~(1<<m),o+=1;var f=32-je(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Oa=1<<32-je(a)+m|o<<m|c,Ba=f+s}else Oa=1<<f|o<<m|c,Ba=s}function Um(s){s.return!==null&&(ni(s,1),Sb(s,1,0))}function Fm(s){for(;s===od;)od=gl[--yl],gl[yl]=null,wc=gl[--yl],gl[yl]=null;for(;s===Di;)Di=na[--ra],na[ra]=null,Ba=na[--ra],na[ra]=null,Oa=na[--ra],na[ra]=null}function Eb(s,a){na[ra++]=Oa,na[ra++]=Ba,na[ra++]=Di,Oa=a.id,Ba=a.overflow,Di=s}var er=null,cn=null,Ds=!1,Pi=null,aa=!1,zm=Error(i(519));function Li(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _c(sa(a,s)),zm}function Nb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[xt]=s,a[At]=c,o){case"dialog":js("cancel",a),js("close",a);break;case"iframe":case"object":case"embed":js("load",a);break;case"video":case"audio":for(o=0;o<Hc.length;o++)js(Hc[o],a);break;case"source":js("error",a);break;case"img":case"image":case"link":js("error",a),js("load",a);break;case"details":js("toggle",a);break;case"input":js("invalid",a),gr(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":js("invalid",a);break;case"textarea":js("invalid",a),Vr(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||$0(a.textContent,o)?(c.popover!=null&&(js("beforetoggle",a),js("toggle",a)),c.onScroll!=null&&js("scroll",a),c.onScrollEnd!=null&&js("scrollend",a),c.onClick!=null&&(a.onclick=Gn),a=!0):a=!1,a||Li(s,!0)}function Cb(s){for(er=s.return;er;)switch(er.tag){case 5:case 31:case 13:aa=!1;return;case 27:case 3:aa=!0;return;default:er=er.return}}function bl(s){if(s!==er)return!1;if(!Ds)return Cb(s),Ds=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||op(s.type,s.memoizedProps)),o=!o),o&&cn&&Li(s),Cb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));cn=e1(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));cn=e1(s)}else a===27?(a=cn,Qi(s.type)?(s=hp,hp=null,cn=s):cn=a):cn=er?oa(s.stateNode.nextSibling):null;return!0}function Mo(){cn=er=null,Ds=!1}function qm(){var s=Pi;return s!==null&&(Dr===null?Dr=s:Dr.push.apply(Dr,s),Pi=null),s}function _c(s){Pi===null?Pi=[s]:Pi.push(s)}var Hm=P(null),Io=null,ri=null;function Oi(s,a,o){De(Hm,a._currentValue),a._currentValue=o}function ai(s){s._currentValue=Hm.current,ne(Hm)}function $m(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Wm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var E=f;f=m;for(var H=0;H<a.length;H++)if(E.context===a[H]){f.lanes|=o,E=f.alternate,E!==null&&(E.lanes|=o),$m(f.return,o,s),c||(w=null);break e}f=E.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),$m(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function vl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var E=m.type;zr(m.pendingProps.value,w.value)||(s!==null?s.push(E):s=[E])}}else if(m===ut.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Yc):s=[Yc])}m=m.return}s!==null&&Wm(a,s,o,c),a.flags|=262144}function ld(s){for(s=s.firstContext;s!==null;){if(!zr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Do(s){Io=s,ri=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function tr(s){return Rb(Io,s)}function cd(s,a){return Io===null&&Do(s),Rb(s,a)}function Rb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},ri===null){if(s===null)throw Error(i(308));ri=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else ri=ri.next=a;return o}var hj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},mj=n.unstable_scheduleCallback,fj=n.unstable_NormalPriority,Dn={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gm(){return{controller:new hj,data:new Map,refCount:0}}function kc(s){s.refCount--,s.refCount===0&&mj(fj,function(){s.controller.abort()})}var jc=null,Km=0,xl=0,wl=null;function pj(s,a){if(jc===null){var o=jc=[];Km=0,xl=Jf(),wl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Km++,a.then(Ab,Ab),a}function Ab(){if(--Km===0&&jc!==null){wl!==null&&(wl.status="fulfilled");var s=jc;jc=null,xl=0,wl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function gj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Mb=$.S;$.S=function(s,a){p0=wt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&pj(s,a),Mb!==null&&Mb(s,a)};var Po=P(null);function Ym(){var s=Po.current;return s!==null?s:nn.pooledCache}function ud(s,a){a===null?De(Po,Po.current):De(Po,a.pool)}function Ib(){var s=Ym();return s===null?null:{parent:Dn._currentValue,pool:s}}var _l=Error(i(460)),Qm=Error(i(474)),dd=Error(i(542)),hd={then:function(){}};function Db(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Pb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Gn,Gn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s;default:if(typeof a.status=="string")a.then(Gn,Gn);else{if(s=nn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s}throw Oo=a,_l}}function Lo(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Oo=o,_l):o}}var Oo=null;function Lb(){if(Oo===null)throw Error(i(459));var s=Oo;return Oo=null,s}function Ob(s){if(s===_l||s===dd)throw Error(i(483))}var kl=null,Tc=0;function md(s){var a=Tc;return Tc+=1,kl===null&&(kl=[]),Pb(kl,s,a)}function Sc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function fd(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Bb(s){function a(ee,W){if(s){var oe=ee.deletions;oe===null?(ee.deletions=[W],ee.flags|=16):oe.push(W)}}function o(ee,W){if(!s)return null;for(;W!==null;)a(ee,W),W=W.sibling;return null}function c(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function m(ee,W){return ee=si(ee,W),ee.index=0,ee.sibling=null,ee}function f(ee,W,oe){return ee.index=oe,s?(oe=ee.alternate,oe!==null?(oe=oe.index,oe<W?(ee.flags|=67108866,W):oe):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function w(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function E(ee,W,oe,Ve){return W===null||W.tag!==6?(W=Bm(oe,ee.mode,Ve),W.return=ee,W):(W=m(W,oe),W.return=ee,W)}function H(ee,W,oe,Ve){var Ut=oe.type;return Ut===B?Re(ee,W,oe.props.children,Ve,oe.key):W!==null&&(W.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===T&&Lo(Ut)===W.type)?(W=m(W,oe.props),Sc(W,oe),W.return=ee,W):(W=id(oe.type,oe.key,oe.props,null,ee.mode,Ve),Sc(W,oe),W.return=ee,W)}function ce(ee,W,oe,Ve){return W===null||W.tag!==4||W.stateNode.containerInfo!==oe.containerInfo||W.stateNode.implementation!==oe.implementation?(W=Vm(oe,ee.mode,Ve),W.return=ee,W):(W=m(W,oe.children||[]),W.return=ee,W)}function Re(ee,W,oe,Ve,Ut){return W===null||W.tag!==7?(W=Ao(oe,ee.mode,Ve,Ut),W.return=ee,W):(W=m(W,oe),W.return=ee,W)}function qe(ee,W,oe){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Bm(""+W,ee.mode,oe),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case O:return oe=id(W.type,W.key,W.props,null,ee.mode,oe),Sc(oe,W),oe.return=ee,oe;case G:return W=Vm(W,ee.mode,oe),W.return=ee,W;case T:return W=Lo(W),qe(ee,W,oe)}if(mt(W)||L(W))return W=Ao(W,ee.mode,oe,null),W.return=ee,W;if(typeof W.then=="function")return qe(ee,md(W),oe);if(W.$$typeof===Z)return qe(ee,cd(ee,W),oe);fd(ee,W)}return null}function fe(ee,W,oe,Ve){var Ut=W!==null?W.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Ut!==null?null:E(ee,W,""+oe,Ve);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:return oe.key===Ut?H(ee,W,oe,Ve):null;case G:return oe.key===Ut?ce(ee,W,oe,Ve):null;case T:return oe=Lo(oe),fe(ee,W,oe,Ve)}if(mt(oe)||L(oe))return Ut!==null?null:Re(ee,W,oe,Ve,null);if(typeof oe.then=="function")return fe(ee,W,md(oe),Ve);if(oe.$$typeof===Z)return fe(ee,W,cd(ee,oe),Ve);fd(ee,oe)}return null}function xe(ee,W,oe,Ve,Ut){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return ee=ee.get(oe)||null,E(W,ee,""+Ve,Ut);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case O:return ee=ee.get(Ve.key===null?oe:Ve.key)||null,H(W,ee,Ve,Ut);case G:return ee=ee.get(Ve.key===null?oe:Ve.key)||null,ce(W,ee,Ve,Ut);case T:return Ve=Lo(Ve),xe(ee,W,oe,Ve,Ut)}if(mt(Ve)||L(Ve))return ee=ee.get(oe)||null,Re(W,ee,Ve,Ut,null);if(typeof Ve.then=="function")return xe(ee,W,oe,md(Ve),Ut);if(Ve.$$typeof===Z)return xe(ee,W,oe,cd(W,Ve),Ut);fd(W,Ve)}return null}function St(ee,W,oe,Ve){for(var Ut=null,Us=null,Mt=W,gs=W=0,Ss=null;Mt!==null&&gs<oe.length;gs++){Mt.index>gs?(Ss=Mt,Mt=null):Ss=Mt.sibling;var Fs=fe(ee,Mt,oe[gs],Ve);if(Fs===null){Mt===null&&(Mt=Ss);break}s&&Mt&&Fs.alternate===null&&a(ee,Mt),W=f(Fs,W,gs),Us===null?Ut=Fs:Us.sibling=Fs,Us=Fs,Mt=Ss}if(gs===oe.length)return o(ee,Mt),Ds&&ni(ee,gs),Ut;if(Mt===null){for(;gs<oe.length;gs++)Mt=qe(ee,oe[gs],Ve),Mt!==null&&(W=f(Mt,W,gs),Us===null?Ut=Mt:Us.sibling=Mt,Us=Mt);return Ds&&ni(ee,gs),Ut}for(Mt=c(Mt);gs<oe.length;gs++)Ss=xe(Mt,ee,gs,oe[gs],Ve),Ss!==null&&(s&&Ss.alternate!==null&&Mt.delete(Ss.key===null?gs:Ss.key),W=f(Ss,W,gs),Us===null?Ut=Ss:Us.sibling=Ss,Us=Ss);return s&&Mt.forEach(function(to){return a(ee,to)}),Ds&&ni(ee,gs),Ut}function Jt(ee,W,oe,Ve){if(oe==null)throw Error(i(151));for(var Ut=null,Us=null,Mt=W,gs=W=0,Ss=null,Fs=oe.next();Mt!==null&&!Fs.done;gs++,Fs=oe.next()){Mt.index>gs?(Ss=Mt,Mt=null):Ss=Mt.sibling;var to=fe(ee,Mt,Fs.value,Ve);if(to===null){Mt===null&&(Mt=Ss);break}s&&Mt&&to.alternate===null&&a(ee,Mt),W=f(to,W,gs),Us===null?Ut=to:Us.sibling=to,Us=to,Mt=Ss}if(Fs.done)return o(ee,Mt),Ds&&ni(ee,gs),Ut;if(Mt===null){for(;!Fs.done;gs++,Fs=oe.next())Fs=qe(ee,Fs.value,Ve),Fs!==null&&(W=f(Fs,W,gs),Us===null?Ut=Fs:Us.sibling=Fs,Us=Fs);return Ds&&ni(ee,gs),Ut}for(Mt=c(Mt);!Fs.done;gs++,Fs=oe.next())Fs=xe(Mt,ee,gs,Fs.value,Ve),Fs!==null&&(s&&Fs.alternate!==null&&Mt.delete(Fs.key===null?gs:Fs.key),W=f(Fs,W,gs),Us===null?Ut=Fs:Us.sibling=Fs,Us=Fs);return s&&Mt.forEach(function(ET){return a(ee,ET)}),Ds&&ni(ee,gs),Ut}function Zs(ee,W,oe,Ve){if(typeof oe=="object"&&oe!==null&&oe.type===B&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:e:{for(var Ut=oe.key;W!==null;){if(W.key===Ut){if(Ut=oe.type,Ut===B){if(W.tag===7){o(ee,W.sibling),Ve=m(W,oe.props.children),Ve.return=ee,ee=Ve;break e}}else if(W.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===T&&Lo(Ut)===W.type){o(ee,W.sibling),Ve=m(W,oe.props),Sc(Ve,oe),Ve.return=ee,ee=Ve;break e}o(ee,W);break}else a(ee,W);W=W.sibling}oe.type===B?(Ve=Ao(oe.props.children,ee.mode,Ve,oe.key),Ve.return=ee,ee=Ve):(Ve=id(oe.type,oe.key,oe.props,null,ee.mode,Ve),Sc(Ve,oe),Ve.return=ee,ee=Ve)}return w(ee);case G:e:{for(Ut=oe.key;W!==null;){if(W.key===Ut)if(W.tag===4&&W.stateNode.containerInfo===oe.containerInfo&&W.stateNode.implementation===oe.implementation){o(ee,W.sibling),Ve=m(W,oe.children||[]),Ve.return=ee,ee=Ve;break e}else{o(ee,W);break}else a(ee,W);W=W.sibling}Ve=Vm(oe,ee.mode,Ve),Ve.return=ee,ee=Ve}return w(ee);case T:return oe=Lo(oe),Zs(ee,W,oe,Ve)}if(mt(oe))return St(ee,W,oe,Ve);if(L(oe)){if(Ut=L(oe),typeof Ut!="function")throw Error(i(150));return oe=Ut.call(oe),Jt(ee,W,oe,Ve)}if(typeof oe.then=="function")return Zs(ee,W,md(oe),Ve);if(oe.$$typeof===Z)return Zs(ee,W,cd(ee,oe),Ve);fd(ee,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,W!==null&&W.tag===6?(o(ee,W.sibling),Ve=m(W,oe),Ve.return=ee,ee=Ve):(o(ee,W),Ve=Bm(oe,ee.mode,Ve),Ve.return=ee,ee=Ve),w(ee)):o(ee,W)}return function(ee,W,oe,Ve){try{Tc=0;var Ut=Zs(ee,W,oe,Ve);return kl=null,Ut}catch(Mt){if(Mt===_l||Mt===dd)throw Mt;var Us=qr(29,Mt,null,ee.mode);return Us.lanes=Ve,Us.return=ee,Us}}}var Bo=Bb(!0),Vb=Bb(!1),Bi=!1;function Xm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Vi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ui(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Hs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ad(s),_b(s,null,o),a}return rd(s,c,a,o),ad(s)}function Ec(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ss(s,o)}}function Zm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var ef=!1;function Nc(){if(ef){var s=wl;if(s!==null)throw s}}function Cc(s,a,o,c){ef=!1;var m=s.updateQueue;Bi=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,E=m.shared.pending;if(E!==null){m.shared.pending=null;var H=E,ce=H.next;H.next=null,w===null?f=ce:w.next=ce,w=H;var Re=s.alternate;Re!==null&&(Re=Re.updateQueue,E=Re.lastBaseUpdate,E!==w&&(E===null?Re.firstBaseUpdate=ce:E.next=ce,Re.lastBaseUpdate=H))}if(f!==null){var qe=m.baseState;w=0,Re=ce=H=null,E=f;do{var fe=E.lane&-536870913,xe=fe!==E.lane;if(xe?(Ts&fe)===fe:(c&fe)===fe){fe!==0&&fe===xl&&(ef=!0),Re!==null&&(Re=Re.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var St=s,Jt=E;fe=a;var Zs=o;switch(Jt.tag){case 1:if(St=Jt.payload,typeof St=="function"){qe=St.call(Zs,qe,fe);break e}qe=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Jt.payload,fe=typeof St=="function"?St.call(Zs,qe,fe):St,fe==null)break e;qe=_({},qe,fe);break e;case 2:Bi=!0}}fe=E.callback,fe!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=m.callbacks,xe===null?m.callbacks=[fe]:xe.push(fe))}else xe={lane:fe,tag:E.tag,payload:E.payload,callback:E.callback,next:null},Re===null?(ce=Re=xe,H=qe):Re=Re.next=xe,w|=fe;if(E=E.next,E===null){if(E=m.shared.pending,E===null)break;xe=E,E=xe.next,xe.next=null,m.lastBaseUpdate=xe,m.shared.pending=null}}while(!0);Re===null&&(H=qe),m.baseState=H,m.firstBaseUpdate=ce,m.lastBaseUpdate=Re,f===null&&(m.shared.lanes=0),$i|=w,s.lanes=w,s.memoizedState=qe}}function Ub(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Fb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ub(o[s],a)}var jl=P(null),pd=P(0);function zb(s,a){s=fi,De(pd,s),De(jl,a),fi=s|a.baseLanes}function tf(){De(pd,fi),De(jl,jl.current)}function sf(){fi=pd.current,ne(jl),ne(pd)}var Hr=P(null),ia=null;function Fi(s){var a=s.alternate;De(Rn,Rn.current&1),De(Hr,s),ia===null&&(a===null||jl.current!==null||a.memoizedState!==null)&&(ia=s)}function nf(s){De(Rn,Rn.current),De(Hr,s),ia===null&&(ia=s)}function qb(s){s.tag===22?(De(Rn,Rn.current),De(Hr,s),ia===null&&(ia=s)):zi()}function zi(){De(Rn,Rn.current),De(Hr,Hr.current)}function $r(s){ne(Hr),ia===s&&(ia=null),ne(Rn)}var Rn=P(0);function gd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||up(o)||dp(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ii=0,fs=null,Xs=null,Pn=null,yd=!1,Tl=!1,Vo=!1,bd=0,Rc=0,Sl=null,yj=0;function kn(){throw Error(i(321))}function rf(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!zr(s[o],a[o]))return!1;return!0}function af(s,a,o,c,m,f){return ii=f,fs=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,$.H=s===null||s.memoizedState===null?Sv:wf,Vo=!1,f=o(c,m),Vo=!1,Tl&&(f=$b(a,o,c,m)),Hb(s),f}function Hb(s){$.H=Ic;var a=Xs!==null&&Xs.next!==null;if(ii=0,Pn=Xs=fs=null,yd=!1,Rc=0,Sl=null,a)throw Error(i(300));s===null||Ln||(s=s.dependencies,s!==null&&ld(s)&&(Ln=!0))}function $b(s,a,o,c){fs=s;var m=0;do{if(Tl&&(Sl=null),Rc=0,Tl=!1,25<=m)throw Error(i(301));if(m+=1,Pn=Xs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}$.H=Ev,f=a(o,c)}while(Tl);return f}function bj(){var s=$.H,a=s.useState()[0];return a=typeof a.then=="function"?Ac(a):a,s=s.useState()[0],(Xs!==null?Xs.memoizedState:null)!==s&&(fs.flags|=1024),a}function of(){var s=bd!==0;return bd=0,s}function lf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function cf(s){if(yd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}yd=!1}ii=0,Pn=Xs=fs=null,Tl=!1,Rc=bd=0,Sl=null}function xr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?fs.memoizedState=Pn=s:Pn=Pn.next=s,Pn}function An(){if(Xs===null){var s=fs.alternate;s=s!==null?s.memoizedState:null}else s=Xs.next;var a=Pn===null?fs.memoizedState:Pn.next;if(a!==null)Pn=a,Xs=s;else{if(s===null)throw fs.alternate===null?Error(i(467)):Error(i(310));Xs=s,s={memoizedState:Xs.memoizedState,baseState:Xs.baseState,baseQueue:Xs.baseQueue,queue:Xs.queue,next:null},Pn===null?fs.memoizedState=Pn=s:Pn=Pn.next=s}return Pn}function vd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ac(s){var a=Rc;return Rc+=1,Sl===null&&(Sl=[]),s=Pb(Sl,s,a),a=fs,(Pn===null?a.memoizedState:Pn.next)===null&&(a=a.alternate,$.H=a===null||a.memoizedState===null?Sv:wf),s}function xd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ac(s);if(s.$$typeof===Z)return tr(s)}throw Error(i(438,String(s)))}function uf(s){var a=null,o=fs.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=fs.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=vd(),fs.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=V;return a.index++,o}function oi(s,a){return typeof a=="function"?a(s):a}function wd(s){var a=An();return df(a,Xs,s)}function df(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var E=w=null,H=null,ce=a,Re=!1;do{var qe=ce.lane&-536870913;if(qe!==ce.lane?(Ts&qe)===qe:(ii&qe)===qe){var fe=ce.revertLane;if(fe===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),qe===xl&&(Re=!0);else if((ii&fe)===fe){ce=ce.next,fe===xl&&(Re=!0);continue}else qe={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},H===null?(E=H=qe,w=f):H=H.next=qe,fs.lanes|=fe,$i|=fe;qe=ce.action,Vo&&o(f,qe),f=ce.hasEagerState?ce.eagerState:o(f,qe)}else fe={lane:qe,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},H===null?(E=H=fe,w=f):H=H.next=fe,fs.lanes|=qe,$i|=qe;ce=ce.next}while(ce!==null&&ce!==a);if(H===null?w=f:H.next=E,!zr(f,s.memoizedState)&&(Ln=!0,Re&&(o=wl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=H,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function hf(s){var a=An(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);zr(f,a.memoizedState)||(Ln=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Wb(s,a,o){var c=fs,m=An(),f=Ds;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!zr((Xs||m).memoizedState,o);if(w&&(m.memoizedState=o,Ln=!0),m=m.queue,pf(Yb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Pn!==null&&Pn.memoizedState.tag&1){if(c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,m,o,a),null),nn===null)throw Error(i(349));f||(ii&127)!==0||Gb(c,a,o)}return o}function Gb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=fs.updateQueue,a===null?(a=vd(),fs.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Kb(s,a,o,c){a.value=o,a.getSnapshot=c,Qb(a)&&Xb(s)}function Yb(s,a,o){return o(function(){Qb(a)&&Xb(s)})}function Qb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!zr(s,o)}catch{return!0}}function Xb(s){var a=Ro(s,2);a!==null&&Pr(a,s,2)}function mf(s){var a=xr();if(typeof s=="function"){var o=s;if(s=o(),Vo){Le(!0);try{o()}finally{Le(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:s},a}function Jb(s,a,o,c){return s.baseState=o,df(s,Xs,typeof c=="function"?c:oi)}function vj(s,a,o,c,m){if(jd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};$.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Zb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Zb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=$.T,w={};$.T=w;try{var E=o(m,c),H=$.S;H!==null&&H(w,E),ev(s,a,E)}catch(ce){ff(s,a,ce)}finally{f!==null&&w.types!==null&&(f.types=w.types),$.T=f}}else try{f=o(m,c),ev(s,a,f)}catch(ce){ff(s,a,ce)}}function ev(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){tv(s,a,c)},function(c){return ff(s,a,c)}):tv(s,a,o)}function tv(s,a,o){a.status="fulfilled",a.value=o,sv(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Zb(s,o)))}function ff(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,sv(a),a=a.next;while(a!==c)}s.action=null}function sv(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function nv(s,a){return a}function rv(s,a){if(Ds){var o=nn.formState;if(o!==null){e:{var c=fs;if(Ds){if(cn){t:{for(var m=cn,f=aa;m.nodeType!==8;){if(!f){m=null;break t}if(m=oa(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){cn=oa(m.nextSibling),c=m.data==="F!";break e}}Li(c)}c=!1}c&&(a=o[0])}}return o=xr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nv,lastRenderedState:a},o.queue=c,o=kv.bind(null,fs,c),c.dispatch=o,c=mf(!1),f=xf.bind(null,fs,!1,c.queue),c=xr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=vj.bind(null,fs,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function av(s){var a=An();return iv(a,Xs,s)}function iv(s,a,o){if(a=df(s,a,nv)[0],s=wd(oi)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Ac(a)}catch(w){throw w===_l?dd:w}else c=a;a=An();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(fs.flags|=2048,El(9,{destroy:void 0},xj.bind(null,m,o),null)),[c,f,s]}function xj(s,a){s.action=a}function ov(s){var a=An(),o=Xs;if(o!==null)return iv(a,o,s);An(),a=a.memoizedState,o=An();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function El(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=fs.updateQueue,a===null&&(a=vd(),fs.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function lv(){return An().memoizedState}function _d(s,a,o,c){var m=xr();fs.flags|=s,m.memoizedState=El(1|a,{destroy:void 0},o,c===void 0?null:c)}function kd(s,a,o,c){var m=An();c=c===void 0?null:c;var f=m.memoizedState.inst;Xs!==null&&c!==null&&rf(c,Xs.memoizedState.deps)?m.memoizedState=El(a,f,o,c):(fs.flags|=s,m.memoizedState=El(1|a,f,o,c))}function cv(s,a){_d(8390656,8,s,a)}function pf(s,a){kd(2048,8,s,a)}function wj(s){fs.flags|=4;var a=fs.updateQueue;if(a===null)a=vd(),fs.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function uv(s){var a=An().memoizedState;return wj({ref:a,nextImpl:s}),function(){if((Hs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function dv(s,a){return kd(4,2,s,a)}function hv(s,a){return kd(4,4,s,a)}function mv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function fv(s,a,o){o=o!=null?o.concat([s]):null,kd(4,4,mv.bind(null,a,s),o)}function gf(){}function pv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&rf(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function gv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&rf(a,c[1]))return c[0];if(c=s(),Vo){Le(!0);try{s()}finally{Le(!1)}}return o.memoizedState=[c,a],c}function yf(s,a,o){return o===void 0||(ii&1073741824)!==0&&(Ts&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=y0(),fs.lanes|=s,$i|=s,o)}function yv(s,a,o,c){return zr(o,a)?o:jl.current!==null?(s=yf(s,o,c),zr(s,a)||(Ln=!0),s):(ii&42)===0||(ii&1073741824)!==0&&(Ts&261930)===0?(Ln=!0,s.memoizedState=o):(s=y0(),fs.lanes|=s,$i|=s,a)}function bv(s,a,o,c,m){var f=ye.p;ye.p=f!==0&&8>f?f:8;var w=$.T,E={};$.T=E,xf(s,!1,a,o);try{var H=m(),ce=$.S;if(ce!==null&&ce(E,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var Re=gj(H,c);Mc(s,a,Re,Kr(s))}else Mc(s,a,c,Kr(s))}catch(qe){Mc(s,a,{then:function(){},status:"rejected",reason:qe},Kr())}finally{ye.p=f,w!==null&&E.types!==null&&(w.types=E.types),$.T=w}}function _j(){}function bf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=vv(s).queue;bv(s,m,a,Ue,o===null?_j:function(){return xv(s),o(c)})}function vv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:Ue},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function xv(s){var a=vv(s);a.next===null&&(a=s.alternate.memoizedState),Mc(s,a.next.queue,{},Kr())}function vf(){return tr(Yc)}function wv(){return An().memoizedState}function _v(){return An().memoizedState}function kj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Kr();s=Vi(o);var c=Ui(a,s,o);c!==null&&(Pr(c,a,o),Ec(c,a,o)),a={cache:Gm()},s.payload=a;return}a=a.return}}function jj(s,a,o){var c=Kr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},jd(s)?jv(a,o):(o=Lm(s,a,o,c),o!==null&&(Pr(o,s,c),Tv(o,a,c)))}function kv(s,a,o){var c=Kr();Mc(s,a,o,c)}function Mc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(jd(s))jv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,E=f(w,o);if(m.hasEagerState=!0,m.eagerState=E,zr(E,w))return rd(s,a,m,0),nn===null&&nd(),!1}catch{}if(o=Lm(s,a,m,c),o!==null)return Pr(o,s,c),Tv(o,a,c),!0}return!1}function xf(s,a,o,c){if(c={lane:2,revertLane:Jf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jd(s)){if(a)throw Error(i(479))}else a=Lm(s,o,c,2),a!==null&&Pr(a,s,2)}function jd(s){var a=s.alternate;return s===fs||a!==null&&a===fs}function jv(s,a){Tl=yd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function Tv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ss(s,o)}}var Ic={readContext:tr,use:xd,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useLayoutEffect:kn,useInsertionEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useSyncExternalStore:kn,useId:kn,useHostTransitionStatus:kn,useFormState:kn,useActionState:kn,useOptimistic:kn,useMemoCache:kn,useCacheRefresh:kn};Ic.useEffectEvent=kn;var Sv={readContext:tr,use:xd,useCallback:function(s,a){return xr().memoizedState=[s,a===void 0?null:a],s},useContext:tr,useEffect:cv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,_d(4194308,4,mv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return _d(4194308,4,s,a)},useInsertionEffect:function(s,a){_d(4,2,s,a)},useMemo:function(s,a){var o=xr();a=a===void 0?null:a;var c=s();if(Vo){Le(!0);try{s()}finally{Le(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=xr();if(o!==void 0){var m=o(a);if(Vo){Le(!0);try{o(a)}finally{Le(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=jj.bind(null,fs,s),[c.memoizedState,s]},useRef:function(s){var a=xr();return s={current:s},a.memoizedState=s},useState:function(s){s=mf(s);var a=s.queue,o=kv.bind(null,fs,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:gf,useDeferredValue:function(s,a){var o=xr();return yf(o,s,a)},useTransition:function(){var s=mf(!1);return s=bv.bind(null,fs,s.queue,!0,!1),xr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=fs,m=xr();if(Ds){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),nn===null)throw Error(i(349));(Ts&127)!==0||Gb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,cv(Yb.bind(null,c,f,s),[s]),c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,f,o,a),null),o},useId:function(){var s=xr(),a=nn.identifierPrefix;if(Ds){var o=Ba,c=Oa;o=(c&~(1<<32-je(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=bd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=yj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:vf,useFormState:rv,useActionState:rv,useOptimistic:function(s){var a=xr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=xf.bind(null,fs,!0,o),o.dispatch=a,[s,a]},useMemoCache:uf,useCacheRefresh:function(){return xr().memoizedState=kj.bind(null,fs)},useEffectEvent:function(s){var a=xr(),o={impl:s};return a.memoizedState=o,function(){if((Hs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},wf={readContext:tr,use:xd,useCallback:pv,useContext:tr,useEffect:pf,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:wd,useRef:lv,useState:function(){return wd(oi)},useDebugValue:gf,useDeferredValue:function(s,a){var o=An();return yv(o,Xs.memoizedState,s,a)},useTransition:function(){var s=wd(oi)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Ac(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:vf,useFormState:av,useActionState:av,useOptimistic:function(s,a){var o=An();return Jb(o,Xs,s,a)},useMemoCache:uf,useCacheRefresh:_v};wf.useEffectEvent=uv;var Ev={readContext:tr,use:xd,useCallback:pv,useContext:tr,useEffect:pf,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:hf,useRef:lv,useState:function(){return hf(oi)},useDebugValue:gf,useDeferredValue:function(s,a){var o=An();return Xs===null?yf(o,s,a):yv(o,Xs.memoizedState,s,a)},useTransition:function(){var s=hf(oi)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Ac(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:vf,useFormState:ov,useActionState:ov,useOptimistic:function(s,a){var o=An();return Xs!==null?Jb(o,Xs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:uf,useCacheRefresh:_v};Ev.useEffectEvent=uv;function _f(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:_({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var kf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Kr(),m=Vi(c);m.payload=a,o!=null&&(m.callback=o),a=Ui(s,m,c),a!==null&&(Pr(a,s,c),Ec(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Kr(),m=Vi(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ui(s,m,c),a!==null&&(Pr(a,s,c),Ec(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Kr(),c=Vi(o);c.tag=2,a!=null&&(c.callback=a),a=Ui(s,c,o),a!==null&&(Pr(a,s,o),Ec(a,s,o))}};function Nv(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!vc(o,c)||!vc(m,f):!0}function Cv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&kf.enqueueReplaceState(a,a.state,null)}function Uo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=_({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Rv(s){sd(s)}function Av(s){console.error(s)}function Mv(s){sd(s)}function Td(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Iv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function jf(s,a,o){return o=Vi(o),o.tag=3,o.payload={element:null},o.callback=function(){Td(s,a)},o}function Dv(s){return s=Vi(s),s.tag=3,s}function Pv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Iv(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Iv(a,o,c),typeof m!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function Tj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&vl(a,o,m,!0),o=Hr.current,o!==null){switch(o.tag){case 31:case 13:return ia===null?Od():o.alternate===null&&jn===0&&(jn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Yf(s,c,m)),!1;case 22:return o.flags|=65536,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Yf(s,c,m)),!1}throw Error(i(435,o.tag))}return Yf(s,c,m),Od(),!1}if(Ds)return a=Hr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==zm&&(s=Error(i(422),{cause:c}),_c(sa(s,o)))):(c!==zm&&(a=Error(i(423),{cause:c}),_c(sa(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=sa(c,o),m=jf(s.stateNode,c,m),Zm(s,m),jn!==4&&(jn=2)),!1;var f=Error(i(520),{cause:c});if(f=sa(f,o),Fc===null?Fc=[f]:Fc.push(f),jn!==4&&(jn=2),a===null)return!0;c=sa(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=jf(o.stateNode,c,s),Zm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Wi===null||!Wi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Dv(m),Pv(m,s,o,c),Zm(o,m),!1}o=o.return}while(o!==null);return!1}var Tf=Error(i(461)),Ln=!1;function sr(s,a,o,c){a.child=s===null?Vb(a,null,o,c):Bo(a,s.child,o,c)}function Lv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var E in c)E!=="ref"&&(w[E]=c[E])}else w=c;return Do(a),c=af(s,a,o,w,f,m),E=of(),s!==null&&!Ln?(lf(s,a,m),li(s,a,m)):(Ds&&E&&Um(a),a.flags|=1,sr(s,a,c,m),a.child)}function Ov(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Om(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Bv(s,a,f,c,m)):(s=id(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!If(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:vc,o(w,c)&&s.ref===a.ref)return li(s,a,m)}return a.flags|=1,s=si(f,c),s.ref=a.ref,s.return=a,a.child=s}function Bv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(vc(f,c)&&s.ref===a.ref)if(Ln=!1,a.pendingProps=c=f,If(s,m))(s.flags&131072)!==0&&(Ln=!0);else return a.lanes=s.lanes,li(s,a,m)}return Sf(s,a,o,c,m)}function Vv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Uv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ud(a,f!==null?f.cachePool:null),f!==null?zb(a,f):tf(),qb(a);else return c=a.lanes=536870912,Uv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ud(a,f.cachePool),zb(a,f),zi(),a.memoizedState=null):(s!==null&&ud(a,null),tf(),zi());return sr(s,a,m,o),a.child}function Dc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Uv(s,a,o,c,m){var f=Ym();return f=f===null?null:{parent:Dn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ud(a,null),tf(),qb(a),s!==null&&vl(s,a,c,!0),a.childLanes=m,null}function Sd(s,a){return a=Nd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Fv(s,a,o){return Bo(a,s.child,null,o),s=Sd(a,a.pendingProps),s.flags|=2,$r(a),a.memoizedState=null,s}function Sj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Ds){if(c.mode==="hidden")return s=Sd(a,c),a.lanes=536870912,Dc(null,s);if(nf(a),(s=cn)?(s=Z0(s,aa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Di!==null?{id:Oa,overflow:Ba}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,er=a,cn=null)):s=null,s===null)throw Li(a);return a.lanes=536870912,null}return Sd(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(nf(a),m)if(a.flags&256)a.flags&=-257,a=Fv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(Ln||vl(s,a,o,!1),m=(o&s.childLanes)!==0,Ln||m){if(c=nn,c!==null&&(w=ns(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,Ro(s,w),Pr(c,s,w),Tf;Od(),a=Fv(s,a,o)}else s=f.treeContext,cn=oa(w.nextSibling),er=a,Ds=!0,Pi=null,aa=!1,s!==null&&Eb(a,s),a=Sd(a,c),a.flags|=4096;return a}return s=si(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Ed(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function Sf(s,a,o,c,m){return Do(a),o=af(s,a,o,c,void 0,m),c=of(),s!==null&&!Ln?(lf(s,a,m),li(s,a,m)):(Ds&&c&&Um(a),a.flags|=1,sr(s,a,o,m),a.child)}function zv(s,a,o,c,m,f){return Do(a),a.updateQueue=null,o=$b(a,c,o,m),Hb(s),c=of(),s!==null&&!Ln?(lf(s,a,f),li(s,a,f)):(Ds&&c&&Um(a),a.flags|=1,sr(s,a,o,f),a.child)}function qv(s,a,o,c,m){if(Do(a),a.stateNode===null){var f=pl,w=o.contextType;typeof w=="object"&&w!==null&&(f=tr(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=kf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Xm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?tr(w):pl,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(_f(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&kf.enqueueReplaceState(f,f.state,null),Cc(a,c,f,m),Nc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var E=a.memoizedProps,H=Uo(o,E);f.props=H;var ce=f.context,Re=o.contextType;w=pl,typeof Re=="object"&&Re!==null&&(w=tr(Re));var qe=o.getDerivedStateFromProps;Re=typeof qe=="function"||typeof f.getSnapshotBeforeUpdate=="function",E=a.pendingProps!==E,Re||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(E||ce!==w)&&Cv(a,f,c,w),Bi=!1;var fe=a.memoizedState;f.state=fe,Cc(a,c,f,m),Nc(),ce=a.memoizedState,E||fe!==ce||Bi?(typeof qe=="function"&&(_f(a,o,qe,c),ce=a.memoizedState),(H=Bi||Nv(a,o,H,c,fe,ce,w))?(Re||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ce),f.props=c,f.state=ce,f.context=w,c=H):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Jm(s,a),w=a.memoizedProps,Re=Uo(o,w),f.props=Re,qe=a.pendingProps,fe=f.context,ce=o.contextType,H=pl,typeof ce=="object"&&ce!==null&&(H=tr(ce)),E=o.getDerivedStateFromProps,(ce=typeof E=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==qe||fe!==H)&&Cv(a,f,c,H),Bi=!1,fe=a.memoizedState,f.state=fe,Cc(a,c,f,m),Nc();var xe=a.memoizedState;w!==qe||fe!==xe||Bi||s!==null&&s.dependencies!==null&&ld(s.dependencies)?(typeof E=="function"&&(_f(a,o,E,c),xe=a.memoizedState),(Re=Bi||Nv(a,o,Re,c,fe,xe,H)||s!==null&&s.dependencies!==null&&ld(s.dependencies))?(ce||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,xe,H),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,xe,H)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=xe),f.props=c,f.state=xe,f.context=H,c=Re):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,Ed(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Bo(a,s.child,null,m),a.child=Bo(a,null,o,m)):sr(s,a,o,m),a.memoizedState=f.state,s=a.child):s=li(s,a,m),s}function Hv(s,a,o,c){return Mo(),a.flags|=256,sr(s,a,o,c),a.child}var Ef={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nf(s){return{baseLanes:s,cachePool:Ib()}}function Cf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Gr),s}function $v(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(Ds){if(m?Fi(a):zi(),(s=cn)?(s=Z0(s,aa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Di!==null?{id:Oa,overflow:Ba}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,er=a,cn=null)):s=null,s===null)throw Li(a);return dp(s)?a.lanes=32:a.lanes=536870912,null}var E=c.children;return c=c.fallback,m?(zi(),m=a.mode,E=Nd({mode:"hidden",children:E},m),c=Ao(c,m,o,null),E.return=a,c.return=a,E.sibling=c,a.child=E,c=a.child,c.memoizedState=Nf(o),c.childLanes=Cf(s,w,o),a.memoizedState=Ef,Dc(null,c)):(Fi(a),Rf(a,E))}var H=s.memoizedState;if(H!==null&&(E=H.dehydrated,E!==null)){if(f)a.flags&256?(Fi(a),a.flags&=-257,a=Af(s,a,o)):a.memoizedState!==null?(zi(),a.child=s.child,a.flags|=128,a=null):(zi(),E=c.fallback,m=a.mode,c=Nd({mode:"visible",children:c.children},m),E=Ao(E,m,o,null),E.flags|=2,c.return=a,E.return=a,c.sibling=E,a.child=c,Bo(a,s.child,null,o),c=a.child,c.memoizedState=Nf(o),c.childLanes=Cf(s,w,o),a.memoizedState=Ef,a=Dc(null,c));else if(Fi(a),dp(E)){if(w=E.nextSibling&&E.nextSibling.dataset,w)var ce=w.dgst;w=ce,c=Error(i(419)),c.stack="",c.digest=w,_c({value:c,source:null,stack:null}),a=Af(s,a,o)}else if(Ln||vl(s,a,o,!1),w=(o&s.childLanes)!==0,Ln||w){if(w=nn,w!==null&&(c=ns(w,o),c!==0&&c!==H.retryLane))throw H.retryLane=c,Ro(s,c),Pr(w,s,c),Tf;up(E)||Od(),a=Af(s,a,o)}else up(E)?(a.flags|=192,a.child=s.child,a=null):(s=H.treeContext,cn=oa(E.nextSibling),er=a,Ds=!0,Pi=null,aa=!1,s!==null&&Eb(a,s),a=Rf(a,c.children),a.flags|=4096);return a}return m?(zi(),E=c.fallback,m=a.mode,H=s.child,ce=H.sibling,c=si(H,{mode:"hidden",children:c.children}),c.subtreeFlags=H.subtreeFlags&65011712,ce!==null?E=si(ce,E):(E=Ao(E,m,o,null),E.flags|=2),E.return=a,c.return=a,c.sibling=E,a.child=c,Dc(null,c),c=a.child,E=s.child.memoizedState,E===null?E=Nf(o):(m=E.cachePool,m!==null?(H=Dn._currentValue,m=m.parent!==H?{parent:H,pool:H}:m):m=Ib(),E={baseLanes:E.baseLanes|o,cachePool:m}),c.memoizedState=E,c.childLanes=Cf(s,w,o),a.memoizedState=Ef,Dc(s.child,c)):(Fi(a),o=s.child,s=o.sibling,o=si(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Rf(s,a){return a=Nd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Nd(s,a){return s=qr(22,s,null,a),s.lanes=0,s}function Af(s,a,o){return Bo(a,s.child,null,o),s=Rf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Wv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),$m(s.return,a,o)}function Mf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function Gv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Rn.current,E=(w&2)!==0;if(E?(w=w&1|2,a.flags|=128):w&=1,De(Rn,w),sr(s,a,c,o),c=Ds?wc:0,!E&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wv(s,o,a);else if(s.tag===19)Wv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&gd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Mf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&gd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Mf(a,!0,o,null,f,c);break;case"together":Mf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function li(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),$i|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(vl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=si(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=si(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function If(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ld(s)))}function Ej(s,a,o){switch(a.tag){case 3:bt(a,a.stateNode.containerInfo),Oi(a,Dn,s.memoizedState.cache),Mo();break;case 27:case 5:os(a);break;case 4:bt(a,a.stateNode.containerInfo);break;case 10:Oi(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,nf(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Fi(a),a.flags|=128,null):(o&a.child.childLanes)!==0?$v(s,a,o):(Fi(a),s=li(s,a,o),s!==null?s.sibling:null);Fi(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(vl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Gv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),De(Rn,Rn.current),c)break;return null;case 22:return a.lanes=0,Vv(s,a,o,a.pendingProps);case 24:Oi(a,Dn,s.memoizedState.cache)}return li(s,a,o)}function Kv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)Ln=!0;else{if(!If(s,o)&&(a.flags&128)===0)return Ln=!1,Ej(s,a,o);Ln=(s.flags&131072)!==0}else Ln=!1,Ds&&(a.flags&1048576)!==0&&Sb(a,wc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Lo(a.elementType),a.type=s,typeof s=="function")Om(s)?(c=Uo(s,c),a.tag=1,a=qv(null,a,s,c,o)):(a.tag=0,a=Sf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===_e){a.tag=11,a=Lv(null,a,s,c,o);break e}else if(m===N){a.tag=14,a=Ov(null,a,s,c,o);break e}}throw a=Ie(s)||s,Error(i(306,a,""))}}return a;case 0:return Sf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Uo(c,a.pendingProps),qv(s,a,c,m,o);case 3:e:{if(bt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Jm(s,a),Cc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Oi(a,Dn,c),c!==f.cache&&Wm(a,[Dn],o,!0),Nc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Hv(s,a,c,o);break e}else if(c!==m){m=sa(Error(i(424)),a),_c(m),a=Hv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,cn=oa(s.firstChild),er=a,Ds=!0,Pi=null,aa=!0,o=Vb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mo(),c===m){a=li(s,a,o);break e}sr(s,a,c,o)}a=a.child}return a;case 26:return Ed(s,a),s===null?(o=a1(a.type,null,a.pendingProps,null))?a.memoizedState=o:Ds||(o=a.type,s=a.pendingProps,c=Hd(Pe.current).createElement(o),c[xt]=a,c[At]=s,nr(c,o,s),he(c),a.stateNode=c):a.memoizedState=a1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return os(a),s===null&&Ds&&(c=a.stateNode=s1(a.type,a.pendingProps,Pe.current),er=a,aa=!0,m=cn,Qi(a.type)?(hp=m,cn=oa(c.firstChild)):cn=m),sr(s,a,a.pendingProps.children,o),Ed(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Ds&&((m=c=cn)&&(c=nT(c,a.type,a.pendingProps,aa),c!==null?(a.stateNode=c,er=a,cn=oa(c.firstChild),aa=!1,m=!0):m=!1),m||Li(a)),os(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,op(m,f)?c=null:w!==null&&op(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=af(s,a,bj,null,null,o),Yc._currentValue=m),Ed(s,a),sr(s,a,c,o),a.child;case 6:return s===null&&Ds&&((s=o=cn)&&(o=rT(o,a.pendingProps,aa),o!==null?(a.stateNode=o,er=a,cn=null,s=!0):s=!1),s||Li(a)),null;case 13:return $v(s,a,o);case 4:return bt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Bo(a,null,c,o):sr(s,a,c,o),a.child;case 11:return Lv(s,a,a.type,a.pendingProps,o);case 7:return sr(s,a,a.pendingProps,o),a.child;case 8:return sr(s,a,a.pendingProps.children,o),a.child;case 12:return sr(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Oi(a,a.type,c.value),sr(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Do(a),m=tr(m),c=c(m),a.flags|=1,sr(s,a,c,o),a.child;case 14:return Ov(s,a,a.type,a.pendingProps,o);case 15:return Bv(s,a,a.type,a.pendingProps,o);case 19:return Gv(s,a,o);case 31:return Sj(s,a,o);case 22:return Vv(s,a,o,a.pendingProps);case 24:return Do(a),c=tr(Dn),s===null?(m=Ym(),m===null&&(m=nn,f=Gm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Xm(a),Oi(a,Dn,m)):((s.lanes&o)!==0&&(Jm(s,a),Cc(a,null,null,o),Nc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Oi(a,Dn,c)):(c=f.cache,Oi(a,Dn,c),c!==m.cache&&Wm(a,[Dn],o,!0))),sr(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ci(s){s.flags|=4}function Df(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(w0())s.flags|=8192;else throw Oo=hd,Qm}else s.flags&=-16777217}function Yv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!u1(a))if(w0())s.flags|=8192;else throw Oo=hd,Qm}function Cd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Q():536870912,s.lanes|=a,Al|=a)}function Pc(s,a){if(!Ds)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function un(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function Nj(s,a,o){var c=a.pendingProps;switch(Fm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(a),null;case 1:return un(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ai(Dn),ot(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(bl(a)?ci(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,qm())),un(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ci(a),f!==null?(un(a),Yv(a,f)):(un(a),Df(a,m,null,c,o))):f?f!==s.memoizedState?(ci(a),un(a),Yv(a,f)):(un(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ci(a),un(a),Df(a,m,s,c,o)),null;case 27:if(As(a),o=Pe.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ci(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return un(a),null}s=ze.current,bl(a)?Nb(a):(s=s1(m,c,o),a.stateNode=s,ci(a))}return un(a),null;case 5:if(As(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ci(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return un(a),null}if(f=ze.current,bl(a))Nb(a);else{var w=Hd(Pe.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[xt]=a,f[At]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(nr(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ci(a)}}return un(a),Df(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ci(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Pe.current,bl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=er,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[xt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||$0(s.nodeValue,o)),s||Li(a,!0)}else s=Hd(s).createTextNode(c),s[xt]=a,a.stateNode=s}return un(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=bl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[xt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;un(a),s=!1}else o=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?($r(a),a):($r(a),null);if((a.flags&128)!==0)throw Error(i(558))}return un(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=bl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[xt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;un(a),m=!1}else m=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?($r(a),a):($r(a),null)}return $r(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Cd(a,a.updateQueue),un(a),null);case 4:return ot(),s===null&&sp(a.stateNode.containerInfo),un(a),null;case 10:return ai(a.type),un(a),null;case 19:if(ne(Rn),c=a.memoizedState,c===null)return un(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Pc(c,!1);else{if(jn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=gd(s),f!==null){for(a.flags|=128,Pc(c,!1),s=f.updateQueue,a.updateQueue=s,Cd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)kb(o,s),o=o.sibling;return De(Rn,Rn.current&1|2),Ds&&ni(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&wt()>Dd&&(a.flags|=128,m=!0,Pc(c,!1),a.lanes=4194304)}else{if(!m)if(s=gd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Cd(a,s),Pc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Ds)return un(a),null}else 2*wt()-c.renderingStartTime>Dd&&o!==536870912&&(a.flags|=128,m=!0,Pc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=wt(),s.sibling=null,o=Rn.current,De(Rn,m?o&1|2:o&1),Ds&&ni(a,c.treeForkCount),s):(un(a),null);case 22:case 23:return $r(a),sf(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(un(a),a.subtreeFlags&6&&(a.flags|=8192)):un(a),o=a.updateQueue,o!==null&&Cd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&ne(Po),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),ai(Dn),un(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Cj(s,a){switch(Fm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return ai(Dn),ot(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return As(a),null;case 31:if(a.memoizedState!==null){if($r(a),a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if($r(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ne(Rn),null;case 4:return ot(),null;case 10:return ai(a.type),null;case 22:case 23:return $r(a),sf(),s!==null&&ne(Po),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return ai(Dn),null;case 25:return null;default:return null}}function Qv(s,a){switch(Fm(a),a.tag){case 3:ai(Dn),ot();break;case 26:case 27:case 5:As(a);break;case 4:ot();break;case 31:a.memoizedState!==null&&$r(a);break;case 13:$r(a);break;case 19:ne(Rn);break;case 10:ai(a.type);break;case 22:case 23:$r(a),sf(),s!==null&&ne(Po);break;case 24:ai(Dn)}}function Lc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(E){Ks(a,a.return,E)}}function qi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,E=w.destroy;if(E!==void 0){w.destroy=void 0,m=a;var H=o,ce=E;try{ce()}catch(Re){Ks(m,H,Re)}}}c=c.next}while(c!==f)}}catch(Re){Ks(a,a.return,Re)}}function Xv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Fb(a,o)}catch(c){Ks(s,s.return,c)}}}function Jv(s,a,o){o.props=Uo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Ks(s,a,c)}}function Oc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Ks(s,a,m)}}function Va(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Ks(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ks(s,a,m)}else o.current=null}function Zv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Ks(s,s.return,m)}}function Pf(s,a,o){try{var c=s.stateNode;Xj(c,s.type,o,a),c[At]=a}catch(m){Ks(s,s.return,m)}}function e0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Qi(s.type)||s.tag===4}function Lf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||e0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Qi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Of(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Gn));else if(c!==4&&(c===27&&Qi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Of(s,a,o),s=s.sibling;s!==null;)Of(s,a,o),s=s.sibling}function Rd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Qi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Rd(s,a,o),s=s.sibling;s!==null;)Rd(s,a,o),s=s.sibling}function t0(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);nr(a,c,o),a[xt]=s,a[At]=o}catch(f){Ks(s,s.return,f)}}var ui=!1,On=!1,Bf=!1,s0=typeof WeakSet=="function"?WeakSet:Set,Yn=null;function Rj(s,a){if(s=s.containerInfo,ap=Xd,s=fb(s),Rm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,E=-1,H=-1,ce=0,Re=0,qe=s,fe=null;t:for(;;){for(var xe;qe!==o||m!==0&&qe.nodeType!==3||(E=w+m),qe!==f||c!==0&&qe.nodeType!==3||(H=w+c),qe.nodeType===3&&(w+=qe.nodeValue.length),(xe=qe.firstChild)!==null;)fe=qe,qe=xe;for(;;){if(qe===s)break t;if(fe===o&&++ce===m&&(E=w),fe===f&&++Re===c&&(H=w),(xe=qe.nextSibling)!==null)break;qe=fe,fe=qe.parentNode}qe=xe}o=E===-1||H===-1?null:{start:E,end:H}}else o=null}o=o||{start:0,end:0}}else o=null;for(ip={focusedElem:s,selectionRange:o},Xd=!1,Yn=a;Yn!==null;)if(a=Yn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Yn=s;else for(;Yn!==null;){switch(a=Yn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var St=Uo(o.type,m);s=c.getSnapshotBeforeUpdate(St,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Jt){Ks(o,o.return,Jt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)cp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Yn=s;break}Yn=a.return}}function n0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:hi(s,o),c&4&&Lc(5,o);break;case 1:if(hi(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Ks(o,o.return,w)}else{var m=Uo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Ks(o,o.return,w)}}c&64&&Xv(o),c&512&&Oc(o,o.return);break;case 3:if(hi(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Fb(s,a)}catch(w){Ks(o,o.return,w)}}break;case 27:a===null&&c&4&&t0(o);case 26:case 5:hi(s,o),a===null&&c&4&&Zv(o),c&512&&Oc(o,o.return);break;case 12:hi(s,o);break;case 31:hi(s,o),c&4&&i0(s,o);break;case 13:hi(s,o),c&4&&o0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Vj.bind(null,o),aT(s,o))));break;case 22:if(c=o.memoizedState!==null||ui,!c){a=a!==null&&a.memoizedState!==null||On,m=ui;var f=On;ui=c,(On=a)&&!f?mi(s,o,(o.subtreeFlags&8772)!==0):hi(s,o),ui=m,On=f}break;case 30:break;default:hi(s,o)}}function r0(s){var a=s.alternate;a!==null&&(s.alternate=null,r0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&In(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,Ar=!1;function di(s,a,o){for(o=o.child;o!==null;)a0(s,a,o),o=o.sibling}function a0(s,a,o){if(ge&&typeof ge.onCommitFiberUnmount=="function")try{ge.onCommitFiberUnmount(xs,o)}catch{}switch(o.tag){case 26:On||Va(o,a),di(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:On||Va(o,a);var c=pn,m=Ar;Qi(o.type)&&(pn=o.stateNode,Ar=!1),di(s,a,o),Wc(o.stateNode),pn=c,Ar=m;break;case 5:On||Va(o,a);case 6:if(c=pn,m=Ar,pn=null,di(s,a,o),pn=c,Ar=m,pn!==null)if(Ar)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(o.stateNode)}catch(f){Ks(o,a,f)}else try{pn.removeChild(o.stateNode)}catch(f){Ks(o,a,f)}break;case 18:pn!==null&&(Ar?(s=pn,X0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Vl(s)):X0(pn,o.stateNode));break;case 4:c=pn,m=Ar,pn=o.stateNode.containerInfo,Ar=!0,di(s,a,o),pn=c,Ar=m;break;case 0:case 11:case 14:case 15:qi(2,o,a),On||qi(4,o,a),di(s,a,o);break;case 1:On||(Va(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Jv(o,a,c)),di(s,a,o);break;case 21:di(s,a,o);break;case 22:On=(c=On)||o.memoizedState!==null,di(s,a,o),On=c;break;default:di(s,a,o)}}function i0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Vl(s)}catch(o){Ks(a,a.return,o)}}}function o0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Vl(s)}catch(o){Ks(a,a.return,o)}}function Aj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new s0),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new s0),a;default:throw Error(i(435,s.tag))}}function Ad(s,a){var o=Aj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Uj.bind(null,s,c);c.then(m,m)}})}function Mr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,E=w;e:for(;E!==null;){switch(E.tag){case 27:if(Qi(E.type)){pn=E.stateNode,Ar=!1;break e}break;case 5:pn=E.stateNode,Ar=!1;break e;case 3:case 4:pn=E.stateNode.containerInfo,Ar=!0;break e}E=E.return}if(pn===null)throw Error(i(160));a0(f,w,m),pn=null,Ar=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)l0(a,s),a=a.sibling}var va=null;function l0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Mr(a,s),Ir(s),c&4&&(qi(3,s,s.return),Lc(3,s),qi(5,s,s.return));break;case 1:Mr(a,s),Ir(s),c&512&&(On||o===null||Va(o,o.return)),c&64&&ui&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=va;if(Mr(a,s),Ir(s),c&512&&(On||o===null||Va(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[dn]||f[xt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),nr(f,c,o),f[xt]=s,he(f),c=f;break e;case"link":var w=l1("link","href",m).get(c+(o.href||""));if(w){for(var E=0;E<w.length;E++)if(f=w[E],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(E,1);break t}}f=m.createElement(c),nr(f,c,o),m.head.appendChild(f);break;case"meta":if(w=l1("meta","content",m).get(c+(o.content||""))){for(E=0;E<w.length;E++)if(f=w[E],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(E,1);break t}}f=m.createElement(c),nr(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[xt]=s,he(f),c=f}s.stateNode=c}else c1(m,s.type,s.stateNode);else s.stateNode=o1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?c1(m,s.type,s.stateNode):o1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Pf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Mr(a,s),Ir(s),c&512&&(On||o===null||Va(o,o.return)),o!==null&&c&4&&Pf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Mr(a,s),Ir(s),c&512&&(On||o===null||Va(o,o.return)),s.flags&32){m=s.stateNode;try{Wn(m,"")}catch(St){Ks(s,s.return,St)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Pf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Bf=!0);break;case 6:if(Mr(a,s),Ir(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(St){Ks(s,s.return,St)}}break;case 3:if(Gd=null,m=va,va=$d(a.containerInfo),Mr(a,s),va=m,Ir(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Vl(a.containerInfo)}catch(St){Ks(s,s.return,St)}Bf&&(Bf=!1,c0(s));break;case 4:c=va,va=$d(s.stateNode.containerInfo),Mr(a,s),Ir(s),va=c;break;case 12:Mr(a,s),Ir(s);break;case 31:Mr(a,s),Ir(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 13:Mr(a,s),Ir(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Id=wt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 22:m=s.memoizedState!==null;var H=o!==null&&o.memoizedState!==null,ce=ui,Re=On;if(ui=ce||m,On=Re||H,Mr(a,s),On=Re,ui=ce,Ir(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||H||ui||On||Fo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){H=o=a;try{if(f=H.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{E=H.stateNode;var qe=H.memoizedProps.style,fe=qe!=null&&qe.hasOwnProperty("display")?qe.display:null;E.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(St){Ks(H,H.return,St)}}}else if(a.tag===6){if(o===null){H=a;try{H.stateNode.nodeValue=m?"":H.memoizedProps}catch(St){Ks(H,H.return,St)}}}else if(a.tag===18){if(o===null){H=a;try{var xe=H.stateNode;m?J0(xe,!0):J0(H.stateNode,!1)}catch(St){Ks(H,H.return,St)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ad(s,o))));break;case 19:Mr(a,s),Ir(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 30:break;case 21:break;default:Mr(a,s),Ir(s)}}function Ir(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(e0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Lf(s);Rd(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Wn(w,""),o.flags&=-33);var E=Lf(s);Rd(s,E,w);break;case 3:case 4:var H=o.stateNode.containerInfo,ce=Lf(s);Of(s,ce,H);break;default:throw Error(i(161))}}catch(Re){Ks(s,s.return,Re)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function c0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;c0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function hi(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)n0(s,a.alternate,a),a=a.sibling}function Fo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:qi(4,a,a.return),Fo(a);break;case 1:Va(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Jv(a,a.return,o),Fo(a);break;case 27:Wc(a.stateNode);case 26:case 5:Va(a,a.return),Fo(a);break;case 22:a.memoizedState===null&&Fo(a);break;case 30:Fo(a);break;default:Fo(a)}s=s.sibling}}function mi(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:mi(m,f,o),Lc(4,f);break;case 1:if(mi(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ce){Ks(c,c.return,ce)}if(c=f,m=c.updateQueue,m!==null){var E=c.stateNode;try{var H=m.shared.hiddenCallbacks;if(H!==null)for(m.shared.hiddenCallbacks=null,m=0;m<H.length;m++)Ub(H[m],E)}catch(ce){Ks(c,c.return,ce)}}o&&w&64&&Xv(f),Oc(f,f.return);break;case 27:t0(f);case 26:case 5:mi(m,f,o),o&&c===null&&w&4&&Zv(f),Oc(f,f.return);break;case 12:mi(m,f,o);break;case 31:mi(m,f,o),o&&w&4&&i0(m,f);break;case 13:mi(m,f,o),o&&w&4&&o0(m,f);break;case 22:f.memoizedState===null&&mi(m,f,o),Oc(f,f.return);break;case 30:break;default:mi(m,f,o)}a=a.sibling}}function Vf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&kc(o))}function Uf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&kc(s))}function xa(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)u0(s,a,o,c),a=a.sibling}function u0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:xa(s,a,o,c),m&2048&&Lc(9,a);break;case 1:xa(s,a,o,c);break;case 3:xa(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&kc(s)));break;case 12:if(m&2048){xa(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,E=f.onPostCommit;typeof E=="function"&&E(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(H){Ks(a,a.return,H)}}else xa(s,a,o,c);break;case 31:xa(s,a,o,c);break;case 13:xa(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?xa(s,a,o,c):Bc(s,a):f._visibility&2?xa(s,a,o,c):(f._visibility|=2,Nl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Vf(w,a);break;case 24:xa(s,a,o,c),m&2048&&Uf(a.alternate,a);break;default:xa(s,a,o,c)}}function Nl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,E=o,H=c,ce=w.flags;switch(w.tag){case 0:case 11:case 15:Nl(f,w,E,H,m),Lc(8,w);break;case 23:break;case 22:var Re=w.stateNode;w.memoizedState!==null?Re._visibility&2?Nl(f,w,E,H,m):Bc(f,w):(Re._visibility|=2,Nl(f,w,E,H,m)),m&&ce&2048&&Vf(w.alternate,w);break;case 24:Nl(f,w,E,H,m),m&&ce&2048&&Uf(w.alternate,w);break;default:Nl(f,w,E,H,m)}a=a.sibling}}function Bc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Bc(o,c),m&2048&&Vf(c.alternate,c);break;case 24:Bc(o,c),m&2048&&Uf(c.alternate,c);break;default:Bc(o,c)}a=a.sibling}}var Vc=8192;function Cl(s,a,o){if(s.subtreeFlags&Vc)for(s=s.child;s!==null;)d0(s,a,o),s=s.sibling}function d0(s,a,o){switch(s.tag){case 26:Cl(s,a,o),s.flags&Vc&&s.memoizedState!==null&&yT(o,va,s.memoizedState,s.memoizedProps);break;case 5:Cl(s,a,o);break;case 3:case 4:var c=va;va=$d(s.stateNode.containerInfo),Cl(s,a,o),va=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Vc,Vc=16777216,Cl(s,a,o),Vc=c):Cl(s,a,o));break;default:Cl(s,a,o)}}function h0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Uc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Yn=c,f0(c,s)}h0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)m0(s),s=s.sibling}function m0(s){switch(s.tag){case 0:case 11:case 15:Uc(s),s.flags&2048&&qi(9,s,s.return);break;case 3:Uc(s);break;case 12:Uc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Md(s)):Uc(s);break;default:Uc(s)}}function Md(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Yn=c,f0(c,s)}h0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:qi(8,a,a.return),Md(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Md(a));break;default:Md(a)}s=s.sibling}}function f0(s,a){for(;Yn!==null;){var o=Yn;switch(o.tag){case 0:case 11:case 15:qi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:kc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Yn=c;else e:for(o=s;Yn!==null;){c=Yn;var m=c.sibling,f=c.return;if(r0(c),c===o){Yn=null;break e}if(m!==null){m.return=f,Yn=m;break e}Yn=f}}}var Mj={getCacheForType:function(s){var a=tr(Dn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return tr(Dn).controller.signal}},Ij=typeof WeakMap=="function"?WeakMap:Map,Hs=0,nn=null,ks=null,Ts=0,Gs=0,Wr=null,Hi=!1,Rl=!1,Ff=!1,fi=0,jn=0,$i=0,zo=0,zf=0,Gr=0,Al=0,Fc=null,Dr=null,qf=!1,Id=0,p0=0,Dd=1/0,Pd=null,Wi=null,zn=0,Gi=null,Ml=null,pi=0,Hf=0,$f=null,g0=null,zc=0,Wf=null;function Kr(){return(Hs&2)!==0&&Ts!==0?Ts&-Ts:$.T!==null?Jf():Ne()}function y0(){if(Gr===0)if((Ts&536870912)===0||Ds){var s=J;J<<=1,(J&3932160)===0&&(J=262144),Gr=s}else Gr=536870912;return s=Hr.current,s!==null&&(s.flags|=32),Gr}function Pr(s,a,o){(s===nn&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)&&(Il(s,0),Ki(s,Ts,Gr,!1)),Qe(s,o),((Hs&2)===0||s!==nn)&&(s===nn&&((Hs&2)===0&&(zo|=o),jn===4&&Ki(s,Ts,Gr,!1)),Ua(s))}function b0(s,a,o){if((Hs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||tt(s,a),m=c?Lj(s,a):Kf(s,a,!0),f=c;do{if(m===0){Rl&&!c&&Ki(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Dj(o)){m=Kf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var E=s;m=Fc;var H=E.current.memoizedState.isDehydrated;if(H&&(Il(E,w).flags|=256),w=Kf(E,w,!1),w!==2){if(Ff&&!H){E.errorRecoveryDisabledLanes|=f,zo|=f,m=4;break e}f=Dr,Dr=m,f!==null&&(Dr===null?Dr=f:Dr.push.apply(Dr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Il(s,0),Ki(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ki(c,a,Gr,!Hi);break e;case 2:Dr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Id+300-wt(),10<m)){if(Ki(c,a,Gr,!Hi),Et(c,0,!0)!==0)break e;pi=a,c.timeoutHandle=Y0(v0.bind(null,c,o,Dr,Pd,qf,a,Gr,zo,Al,Hi,f,"Throttled",-0,0),m);break e}v0(c,o,Dr,Pd,qf,a,Gr,zo,Al,Hi,f,null,-0,0)}}break}while(!0);Ua(s)}function v0(s,a,o,c,m,f,w,E,H,ce,Re,qe,fe,xe){if(s.timeoutHandle=-1,qe=a.subtreeFlags,qe&8192||(qe&16785408)===16785408){qe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gn},d0(a,f,qe);var St=(f&62914560)===f?Id-wt():(f&4194048)===f?p0-wt():0;if(St=bT(qe,St),St!==null){pi=f,s.cancelPendingCommit=St(E0.bind(null,s,a,f,o,c,m,w,E,H,Re,qe,null,fe,xe)),Ki(s,f,w,!ce);return}}E0(s,a,f,o,c,m,w,E,H)}function Dj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!zr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ki(s,a,o,c){a&=~zf,a&=~zo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-je(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&at(s,o,a)}function Ld(){return(Hs&6)===0?(qc(0),!1):!0}function Gf(){if(ks!==null){if(Gs===0)var s=ks.return;else s=ks,ri=Io=null,cf(s),kl=null,Tc=0,s=ks;for(;s!==null;)Qv(s.alternate,s),s=s.return;ks=null}}function Il(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,eT(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),pi=0,Gf(),nn=s,ks=o=si(s.current,null),Ts=a,Gs=0,Wr=null,Hi=!1,Rl=tt(s,a),Ff=!1,Al=Gr=zf=zo=$i=jn=0,Dr=Fc=null,qf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-je(c),f=1<<m;a|=s[m],c&=~f}return fi=a,nd(),o}function x0(s,a){fs=null,$.H=Ic,a===_l||a===dd?(a=Lb(),Gs=3):a===Qm?(a=Lb(),Gs=4):Gs=a===Tf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Wr=a,ks===null&&(jn=1,Td(s,sa(a,s.current)))}function w0(){var s=Hr.current;return s===null?!0:(Ts&4194048)===Ts?ia===null:(Ts&62914560)===Ts||(Ts&536870912)!==0?s===ia:!1}function _0(){var s=$.H;return $.H=Ic,s===null?Ic:s}function k0(){var s=$.A;return $.A=Mj,s}function Od(){jn=4,Hi||(Ts&4194048)!==Ts&&Hr.current!==null||(Rl=!0),($i&134217727)===0&&(zo&134217727)===0||nn===null||Ki(nn,Ts,Gr,!1)}function Kf(s,a,o){var c=Hs;Hs|=2;var m=_0(),f=k0();(nn!==s||Ts!==a)&&(Pd=null,Il(s,a)),a=!1;var w=jn;e:do try{if(Gs!==0&&ks!==null){var E=ks,H=Wr;switch(Gs){case 8:Gf(),w=6;break e;case 3:case 2:case 9:case 6:Hr.current===null&&(a=!0);var ce=Gs;if(Gs=0,Wr=null,Dl(s,E,H,ce),o&&Rl){w=0;break e}break;default:ce=Gs,Gs=0,Wr=null,Dl(s,E,H,ce)}}Pj(),w=jn;break}catch(Re){x0(s,Re)}while(!0);return a&&s.shellSuspendCounter++,ri=Io=null,Hs=c,$.H=m,$.A=f,ks===null&&(nn=null,Ts=0,nd()),w}function Pj(){for(;ks!==null;)j0(ks)}function Lj(s,a){var o=Hs;Hs|=2;var c=_0(),m=k0();nn!==s||Ts!==a?(Pd=null,Dd=wt()+500,Il(s,a)):Rl=tt(s,a);e:do try{if(Gs!==0&&ks!==null){a=ks;var f=Wr;t:switch(Gs){case 1:Gs=0,Wr=null,Dl(s,a,f,1);break;case 2:case 9:if(Db(f)){Gs=0,Wr=null,T0(a);break}a=function(){Gs!==2&&Gs!==9||nn!==s||(Gs=7),Ua(s)},f.then(a,a);break e;case 3:Gs=7;break e;case 4:Gs=5;break e;case 7:Db(f)?(Gs=0,Wr=null,T0(a)):(Gs=0,Wr=null,Dl(s,a,f,7));break;case 5:var w=null;switch(ks.tag){case 26:w=ks.memoizedState;case 5:case 27:var E=ks;if(w?u1(w):E.stateNode.complete){Gs=0,Wr=null;var H=E.sibling;if(H!==null)ks=H;else{var ce=E.return;ce!==null?(ks=ce,Bd(ce)):ks=null}break t}}Gs=0,Wr=null,Dl(s,a,f,5);break;case 6:Gs=0,Wr=null,Dl(s,a,f,6);break;case 8:Gf(),jn=6;break e;default:throw Error(i(462))}}Oj();break}catch(Re){x0(s,Re)}while(!0);return ri=Io=null,$.H=c,$.A=m,Hs=o,ks!==null?0:(nn=null,Ts=0,nd(),jn)}function Oj(){for(;ks!==null&&!Dt();)j0(ks)}function j0(s){var a=Kv(s.alternate,s,fi);s.memoizedProps=s.pendingProps,a===null?Bd(s):ks=a}function T0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=zv(o,a,a.pendingProps,a.type,void 0,Ts);break;case 11:a=zv(o,a,a.pendingProps,a.type.render,a.ref,Ts);break;case 5:cf(a);default:Qv(o,a),a=ks=kb(a,fi),a=Kv(o,a,fi)}s.memoizedProps=s.pendingProps,a===null?Bd(s):ks=a}function Dl(s,a,o,c){ri=Io=null,cf(a),kl=null,Tc=0;var m=a.return;try{if(Tj(s,m,a,o,Ts)){jn=1,Td(s,sa(o,s.current)),ks=null;return}}catch(f){if(m!==null)throw ks=m,f;jn=1,Td(s,sa(o,s.current)),ks=null;return}a.flags&32768?(Ds||c===1?s=!0:Rl||(Ts&536870912)!==0?s=!1:(Hi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Hr.current,c!==null&&c.tag===13&&(c.flags|=16384))),S0(a,s)):Bd(a)}function Bd(s){var a=s;do{if((a.flags&32768)!==0){S0(a,Hi);return}s=a.return;var o=Nj(a.alternate,a,fi);if(o!==null){ks=o;return}if(a=a.sibling,a!==null){ks=a;return}ks=a=s}while(a!==null);jn===0&&(jn=5)}function S0(s,a){do{var o=Cj(s.alternate,s);if(o!==null){o.flags&=32767,ks=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){ks=s;return}ks=s=o}while(s!==null);jn=6,ks=null}function E0(s,a,o,c,m,f,w,E,H){s.cancelPendingCommit=null;do Vd();while(zn!==0);if((Hs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Pm,dt(s,o,f,w,E,H),s===nn&&(ks=nn=null,Ts=0),Ml=a,Gi=s,pi=o,Hf=f,$f=m,g0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Fj(vs,function(){return M0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,m=ye.p,ye.p=2,w=Hs,Hs|=4;try{Rj(s,a,o)}finally{Hs=w,ye.p=m,$.T=c}}zn=1,N0(),C0(),R0()}}function N0(){if(zn===1){zn=0;var s=Gi,a=Ml,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=$.T,$.T=null;var c=ye.p;ye.p=2;var m=Hs;Hs|=4;try{l0(a,s);var f=ip,w=fb(s.containerInfo),E=f.focusedElem,H=f.selectionRange;if(w!==E&&E&&E.ownerDocument&&mb(E.ownerDocument.documentElement,E)){if(H!==null&&Rm(E)){var ce=H.start,Re=H.end;if(Re===void 0&&(Re=ce),"selectionStart"in E)E.selectionStart=ce,E.selectionEnd=Math.min(Re,E.value.length);else{var qe=E.ownerDocument||document,fe=qe&&qe.defaultView||window;if(fe.getSelection){var xe=fe.getSelection(),St=E.textContent.length,Jt=Math.min(H.start,St),Zs=H.end===void 0?Jt:Math.min(H.end,St);!xe.extend&&Jt>Zs&&(w=Zs,Zs=Jt,Jt=w);var ee=hb(E,Jt),W=hb(E,Zs);if(ee&&W&&(xe.rangeCount!==1||xe.anchorNode!==ee.node||xe.anchorOffset!==ee.offset||xe.focusNode!==W.node||xe.focusOffset!==W.offset)){var oe=qe.createRange();oe.setStart(ee.node,ee.offset),xe.removeAllRanges(),Jt>Zs?(xe.addRange(oe),xe.extend(W.node,W.offset)):(oe.setEnd(W.node,W.offset),xe.addRange(oe))}}}}for(qe=[],xe=E;xe=xe.parentNode;)xe.nodeType===1&&qe.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<qe.length;E++){var Ve=qe[E];Ve.element.scrollLeft=Ve.left,Ve.element.scrollTop=Ve.top}}Xd=!!ap,ip=ap=null}finally{Hs=m,ye.p=c,$.T=o}}s.current=a,zn=2}}function C0(){if(zn===2){zn=0;var s=Gi,a=Ml,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=$.T,$.T=null;var c=ye.p;ye.p=2;var m=Hs;Hs|=4;try{n0(s,a.alternate,a)}finally{Hs=m,ye.p=c,$.T=o}}zn=3}}function R0(){if(zn===4||zn===3){zn=0,zt();var s=Gi,a=Ml,o=pi,c=g0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?zn=5:(zn=0,Ml=Gi=null,A0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Wi=null),pe(o),a=a.stateNode,ge&&typeof ge.onCommitFiberRoot=="function")try{ge.onCommitFiberRoot(xs,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=$.T,m=ye.p,ye.p=2,$.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var E=c[w];f(E.value,{componentStack:E.stack})}}finally{$.T=a,ye.p=m}}(pi&3)!==0&&Vd(),Ua(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Wf?zc++:(zc=0,Wf=s):zc=0,qc(0)}}function A0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,kc(a)))}function Vd(){return N0(),C0(),R0(),M0()}function M0(){if(zn!==5)return!1;var s=Gi,a=Hf;Hf=0;var o=pe(pi),c=$.T,m=ye.p;try{ye.p=32>o?32:o,$.T=null,o=$f,$f=null;var f=Gi,w=pi;if(zn=0,Ml=Gi=null,pi=0,(Hs&6)!==0)throw Error(i(331));var E=Hs;if(Hs|=4,m0(f.current),u0(f,f.current,w,o),Hs=E,qc(0,!1),ge&&typeof ge.onPostCommitFiberRoot=="function")try{ge.onPostCommitFiberRoot(xs,f)}catch{}return!0}finally{ye.p=m,$.T=c,A0(s,a)}}function I0(s,a,o){a=sa(o,a),a=jf(s.stateNode,a,2),s=Ui(s,a,2),s!==null&&(Qe(s,2),Ua(s))}function Ks(s,a,o){if(s.tag===3)I0(s,s,o);else for(;a!==null;){if(a.tag===3){I0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Wi===null||!Wi.has(c))){s=sa(o,s),o=Dv(2),c=Ui(a,o,2),c!==null&&(Pv(o,c,a,s),Qe(c,2),Ua(c));break}}a=a.return}}function Yf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Ij;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Ff=!0,m.add(o),s=Bj.bind(null,s,a,o),a.then(s,s))}function Bj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,nn===s&&(Ts&o)===o&&(jn===4||jn===3&&(Ts&62914560)===Ts&&300>wt()-Id?(Hs&2)===0&&Il(s,0):zf|=o,Al===Ts&&(Al=0)),Ua(s)}function D0(s,a){a===0&&(a=Q()),s=Ro(s,a),s!==null&&(Qe(s,a),Ua(s))}function Vj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),D0(s,o)}function Uj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),D0(s,o)}function Fj(s,a){return se(s,a)}var Ud=null,Pl=null,Qf=!1,Fd=!1,Xf=!1,Yi=0;function Ua(s){s!==Pl&&s.next===null&&(Pl===null?Ud=Pl=s:Pl=Pl.next=s),Fd=!0,Qf||(Qf=!0,qj())}function qc(s,a){if(!Xf&&Fd){Xf=!0;do for(var o=!1,c=Ud;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,E=c.pingedLanes;f=(1<<31-je(42|s)+1)-1,f&=m&~(w&~E),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,B0(c,f))}else f=Ts,f=Et(c,c===nn?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||tt(c,f)||(o=!0,B0(c,f));c=c.next}while(o);Xf=!1}}function zj(){P0()}function P0(){Fd=Qf=!1;var s=0;Yi!==0&&Zj()&&(s=Yi);for(var a=wt(),o=null,c=Ud;c!==null;){var m=c.next,f=L0(c,a);f===0?(c.next=null,o===null?Ud=m:o.next=m,m===null&&(Pl=o)):(o=c,(s!==0||(f&3)!==0)&&(Fd=!0)),c=m}zn!==0&&zn!==5||qc(s),Yi!==0&&(Yi=0)}function L0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-je(f),E=1<<w,H=m[w];H===-1?((E&o)===0||(E&c)!==0)&&(m[w]=Nt(E,a)):H<=a&&(s.expiredLanes|=E),f&=~E}if(a=nn,o=Ts,o=Et(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Ht(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||tt(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Ht(c),pe(o)){case 2:case 8:o=rs;break;case 32:o=vs;break;case 268435456:o=Ys;break;default:o=vs}return c=O0.bind(null,s),o=se(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Ht(c),s.callbackPriority=2,s.callbackNode=null,2}function O0(s,a){if(zn!==0&&zn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Vd()&&s.callbackNode!==o)return null;var c=Ts;return c=Et(s,s===nn?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(b0(s,c,a),L0(s,wt()),s.callbackNode!=null&&s.callbackNode===o?O0.bind(null,s):null)}function B0(s,a){if(Vd())return null;b0(s,a,!0)}function qj(){tT(function(){(Hs&6)!==0?se(Qt,zj):P0()})}function Jf(){if(Yi===0){var s=xl;s===0&&(s=pt,pt<<=1,(pt&261888)===0&&(pt=256)),Yi=s}return Yi}function V0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ur(""+s)}function U0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Hj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=V0((m[At]||null).action),w=c.submitter;w&&(a=(a=w[At]||null)?V0(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var E=new nt("action","action",null,c,m);s.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Yi!==0){var H=w?U0(m,w):new FormData(m);bf(o,{pending:!0,data:H,method:m.method,action:f},null,H)}}else typeof f=="function"&&(E.preventDefault(),H=w?U0(m,w):new FormData(m),bf(o,{pending:!0,data:H,method:m.method,action:f},f,H))},currentTarget:m}]})}}for(var Zf=0;Zf<Dm.length;Zf++){var ep=Dm[Zf],$j=ep.toLowerCase(),Wj=ep[0].toUpperCase()+ep.slice(1);ba($j,"on"+Wj)}ba(yb,"onAnimationEnd"),ba(bb,"onAnimationIteration"),ba(vb,"onAnimationStart"),ba("dblclick","onDoubleClick"),ba("focusin","onFocus"),ba("focusout","onBlur"),ba(lj,"onTransitionRun"),ba(cj,"onTransitionStart"),ba(uj,"onTransitionCancel"),ba(xb,"onTransitionEnd"),Tt("onMouseEnter",["mouseout","mouseover"]),Tt("onMouseLeave",["mouseout","mouseover"]),Tt("onPointerEnter",["pointerout","pointerover"]),Tt("onPointerLeave",["pointerout","pointerover"]),Ge("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ge("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ge("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ge("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hc));function F0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var E=c[w],H=E.instance,ce=E.currentTarget;if(E=E.listener,H!==f&&m.isPropagationStopped())break e;f=E,m.currentTarget=ce;try{f(m)}catch(Re){sd(Re)}m.currentTarget=null,f=H}else for(w=0;w<c.length;w++){if(E=c[w],H=E.instance,ce=E.currentTarget,E=E.listener,H!==f&&m.isPropagationStopped())break e;f=E,m.currentTarget=ce;try{f(m)}catch(Re){sd(Re)}m.currentTarget=null,f=H}}}}function js(s,a){var o=a[$t];o===void 0&&(o=a[$t]=new Set);var c=s+"__bubble";o.has(c)||(z0(a,s,2,!1),o.add(c))}function tp(s,a,o){var c=0;a&&(c|=4),z0(o,s,c,a)}var zd="_reactListening"+Math.random().toString(36).slice(2);function sp(s){if(!s[zd]){s[zd]=!0,ie.forEach(function(o){o!=="selectionchange"&&(Gj.has(o)||tp(o,!1,s),tp(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[zd]||(a[zd]=!0,tp("selectionchange",!1,a))}}function z0(s,a,o,c){switch(y1(a)){case 2:var m=wT;break;case 8:m=_T;break;default:m=yp}o=m.bind(null,a,o,s),m=void 0,!Fe||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function np(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var E=c.stateNode.containerInfo;if(E===m)break;if(w===4)for(w=c.return;w!==null;){var H=w.tag;if((H===3||H===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;E!==null;){if(w=hn(E),w===null)return;if(H=w.tag,H===5||H===6||H===26||H===27){c=f=w;continue e}E=E.parentNode}}c=c.return}z(function(){var ce=f,Re=xn(o),qe=[];e:{var fe=wb.get(s);if(fe!==void 0){var xe=nt,St=s;switch(s){case"keypress":if(S(o)===0)break e;case"keydown":case"keyup":xe=ti;break;case"focusin":St="focus",xe=Nn;break;case"focusout":St="blur",xe=Nn;break;case"beforeblur":case"afterblur":xe=Nn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=ln;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=zs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=v;break;case yb:case bb:case vb:xe=Xn;break;case xb:xe=A;break;case"scroll":case"scrollend":xe=lt;break;case"wheel":xe=ve;break;case"copy":case"cut":case"paste":xe=Nr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=cr;break;case"toggle":case"beforetoggle":xe=ms}var Jt=(a&4)!==0,Zs=!Jt&&(s==="scroll"||s==="scrollend"),ee=Jt?fe!==null?fe+"Capture":null:fe;Jt=[];for(var W=ce,oe;W!==null;){var Ve=W;if(oe=Ve.stateNode,Ve=Ve.tag,Ve!==5&&Ve!==26&&Ve!==27||oe===null||ee===null||(Ve=le(W,ee),Ve!=null&&Jt.push($c(W,Ve,oe))),Zs)break;W=W.return}0<Jt.length&&(fe=new xe(fe,St,null,o,Re),qe.push({event:fe,listeners:Jt}))}}if((a&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",fe&&o!==Kn&&(St=o.relatedTarget||o.fromElement)&&(hn(St)||St[ht]))break e;if((xe||fe)&&(fe=Re.window===Re?Re:(fe=Re.ownerDocument)?fe.defaultView||fe.parentWindow:window,xe?(St=o.relatedTarget||o.toElement,xe=ce,St=St?hn(St):null,St!==null&&(Zs=u(St),Jt=St.tag,St!==Zs||Jt!==5&&Jt!==27&&Jt!==6)&&(St=null)):(xe=null,St=ce),xe!==St)){if(Jt=ln,Ve="onMouseLeave",ee="onMouseEnter",W="mouse",(s==="pointerout"||s==="pointerover")&&(Jt=cr,Ve="onPointerLeave",ee="onPointerEnter",W="pointer"),Zs=xe==null?fe:ys(xe),oe=St==null?fe:ys(St),fe=new Jt(Ve,W+"leave",xe,o,Re),fe.target=Zs,fe.relatedTarget=oe,Ve=null,hn(Re)===ce&&(Jt=new Jt(ee,W+"enter",St,o,Re),Jt.target=oe,Jt.relatedTarget=Zs,Ve=Jt),Zs=Ve,xe&&St)t:{for(Jt=Kj,ee=xe,W=St,oe=0,Ve=ee;Ve;Ve=Jt(Ve))oe++;Ve=0;for(var Ut=W;Ut;Ut=Jt(Ut))Ve++;for(;0<oe-Ve;)ee=Jt(ee),oe--;for(;0<Ve-oe;)W=Jt(W),Ve--;for(;oe--;){if(ee===W||W!==null&&ee===W.alternate){Jt=ee;break t}ee=Jt(ee),W=Jt(W)}Jt=null}else Jt=null;xe!==null&&q0(qe,fe,xe,Jt,!1),St!==null&&Zs!==null&&q0(qe,Zs,St,Jt,!0)}}e:{if(fe=ce?ys(ce):window,xe=fe.nodeName&&fe.nodeName.toLowerCase(),xe==="select"||xe==="input"&&fe.type==="file")var Us=ib;else if(rb(fe))if(ob)Us=aj;else{Us=nj;var Mt=sj}else xe=fe.nodeName,!xe||xe.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ce&&Da(ce.elementType)&&(Us=ib):Us=rj;if(Us&&(Us=Us(s,ce))){ab(qe,Us,o,Re);break e}Mt&&Mt(s,fe,ce),s==="focusout"&&ce&&fe.type==="number"&&ce.memoizedProps.value!=null&&yr(fe,"number",fe.value)}switch(Mt=ce?ys(ce):window,s){case"focusin":(rb(Mt)||Mt.contentEditable==="true")&&(hl=Mt,Am=ce,xc=null);break;case"focusout":xc=Am=hl=null;break;case"mousedown":Mm=!0;break;case"contextmenu":case"mouseup":case"dragend":Mm=!1,pb(qe,o,Re);break;case"selectionchange":if(oj)break;case"keydown":case"keyup":pb(qe,o,Re)}var gs;if(qs)e:{switch(s){case"compositionstart":var Ss="onCompositionStart";break e;case"compositionend":Ss="onCompositionEnd";break e;case"compositionupdate":Ss="onCompositionUpdate";break e}Ss=void 0}else dl?Eo(s,o)&&(Ss="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ss="onCompositionStart");Ss&&(La&&o.locale!=="ko"&&(dl||Ss!=="onCompositionStart"?Ss==="onCompositionEnd"&&dl&&(gs=cs()):(et=Re,vt="value"in et?et.value:et.textContent,dl=!0)),Mt=qd(ce,Ss),0<Mt.length&&(Ss=new _n(Ss,s,null,o,Re),qe.push({event:Ss,listeners:Mt}),gs?Ss.data=gs:(gs=ul(o),gs!==null&&(Ss.data=gs)))),(gs=ea?Jk(s,o):Zk(s,o))&&(Ss=qd(ce,"onBeforeInput"),0<Ss.length&&(Mt=new _n("onBeforeInput","beforeinput",null,o,Re),qe.push({event:Mt,listeners:Ss}),Mt.data=gs)),Hj(qe,s,ce,o,Re)}F0(qe,a)})}function $c(s,a,o){return{instance:s,listener:a,currentTarget:o}}function qd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=le(s,o),m!=null&&c.unshift($c(s,m,f)),m=le(s,a),m!=null&&c.push($c(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Kj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function q0(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var E=o,H=E.alternate,ce=E.stateNode;if(E=E.tag,H!==null&&H===c)break;E!==5&&E!==26&&E!==27||ce===null||(H=ce,m?(ce=le(o,f),ce!=null&&w.unshift($c(o,ce,H))):m||(ce=le(o,f),ce!=null&&w.push($c(o,ce,H)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Yj=/\r\n?/g,Qj=/\u0000|\uFFFD/g;function H0(s){return(typeof s=="string"?s:""+s).replace(Yj,`
`).replace(Qj,"")}function $0(s,a){return a=H0(a),H0(s)===a}function Js(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Wn(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Wn(s,""+c);break;case"className":Is(s,"class",c);break;case"tabIndex":Is(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Is(s,o,c);break;case"style":Er(s,c,f);break;case"data":if(a!=="object"){Is(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ur(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Js(s,a,"name",m.name,m,null),Js(s,a,"formEncType",m.formEncType,m,null),Js(s,a,"formMethod",m.formMethod,m,null),Js(s,a,"formTarget",m.formTarget,m,null)):(Js(s,a,"encType",m.encType,m,null),Js(s,a,"method",m.method,m,null),Js(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ur(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Gn);break;case"onScroll":c!=null&&js("scroll",s);break;case"onScrollEnd":c!=null&&js("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Ur(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":js("beforetoggle",s),js("toggle",s),Vs(s,"popover",c);break;case"xlinkActuate":C(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":C(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":C(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":C(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":C(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":C(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":C(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":C(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":C(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Vs(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ii.get(o)||o,Vs(s,o,c))}}function rp(s,a,o,c,m,f){switch(o){case"style":Er(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Wn(s,c):(typeof c=="number"||typeof c=="bigint")&&Wn(s,""+c);break;case"onScroll":c!=null&&js("scroll",s);break;case"onScrollEnd":c!=null&&js("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Gn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!be.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[At]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):Vs(s,o,c)}}}function nr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":js("error",s),js("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Js(s,a,f,w,o,null)}}m&&Js(s,a,"srcSet",o.srcSet,o,null),c&&Js(s,a,"src",o.src,o,null);return;case"input":js("invalid",s);var E=f=w=m=null,H=null,ce=null;for(c in o)if(o.hasOwnProperty(c)){var Re=o[c];if(Re!=null)switch(c){case"name":m=Re;break;case"type":w=Re;break;case"checked":H=Re;break;case"defaultChecked":ce=Re;break;case"value":f=Re;break;case"defaultValue":E=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(i(137,a));break;default:Js(s,a,c,Re,o,null)}}gr(s,f,E,H,ce,w,m,!1);return;case"select":js("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(E=o[m],E!=null))switch(m){case"value":f=E;break;case"defaultValue":w=E;break;case"multiple":c=E;default:Js(s,a,m,E,o,null)}a=f,o=w,s.multiple=!!c,a!=null?$n(s,!!c,a,!1):o!=null&&$n(s,!!c,o,!0);return;case"textarea":js("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(E=o[w],E!=null))switch(w){case"value":c=E;break;case"defaultValue":m=E;break;case"children":f=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:Js(s,a,w,E,o,null)}Vr(s,c,m,f);return;case"option":for(H in o)o.hasOwnProperty(H)&&(c=o[H],c!=null)&&(H==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Js(s,a,H,c,o,null));return;case"dialog":js("beforetoggle",s),js("toggle",s),js("cancel",s),js("close",s);break;case"iframe":case"object":js("load",s);break;case"video":case"audio":for(c=0;c<Hc.length;c++)js(Hc[c],s);break;case"image":js("error",s),js("load",s);break;case"details":js("toggle",s);break;case"embed":case"source":case"link":js("error",s),js("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in o)if(o.hasOwnProperty(ce)&&(c=o[ce],c!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Js(s,a,ce,c,o,null)}return;default:if(Da(a)){for(Re in o)o.hasOwnProperty(Re)&&(c=o[Re],c!==void 0&&rp(s,a,Re,c,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(c=o[E],c!=null&&Js(s,a,E,c,o,null))}function Xj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,E=null,H=null,ce=null,Re=null;for(xe in o){var qe=o[xe];if(o.hasOwnProperty(xe)&&qe!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":H=qe;default:c.hasOwnProperty(xe)||Js(s,a,xe,null,c,qe)}}for(var fe in c){var xe=c[fe];if(qe=o[fe],c.hasOwnProperty(fe)&&(xe!=null||qe!=null))switch(fe){case"type":f=xe;break;case"name":m=xe;break;case"checked":ce=xe;break;case"defaultChecked":Re=xe;break;case"value":w=xe;break;case"defaultValue":E=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(i(137,a));break;default:xe!==qe&&Js(s,a,fe,xe,c,qe)}}vn(s,w,E,H,ce,Re,f,m);return;case"select":xe=w=E=fe=null;for(f in o)if(H=o[f],o.hasOwnProperty(f)&&H!=null)switch(f){case"value":break;case"multiple":xe=H;default:c.hasOwnProperty(f)||Js(s,a,f,null,c,H)}for(m in c)if(f=c[m],H=o[m],c.hasOwnProperty(m)&&(f!=null||H!=null))switch(m){case"value":fe=f;break;case"defaultValue":E=f;break;case"multiple":w=f;default:f!==H&&Js(s,a,m,f,c,H)}a=E,o=w,c=xe,fe!=null?$n(s,!!o,fe,!1):!!c!=!!o&&(a!=null?$n(s,!!o,a,!0):$n(s,!!o,o?[]:"",!1));return;case"textarea":xe=fe=null;for(E in o)if(m=o[E],o.hasOwnProperty(E)&&m!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Js(s,a,E,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":fe=m;break;case"defaultValue":xe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Js(s,a,w,m,c,f)}ma(s,fe,xe);return;case"option":for(var St in o)fe=o[St],o.hasOwnProperty(St)&&fe!=null&&!c.hasOwnProperty(St)&&(St==="selected"?s.selected=!1:Js(s,a,St,null,c,fe));for(H in c)fe=c[H],xe=o[H],c.hasOwnProperty(H)&&fe!==xe&&(fe!=null||xe!=null)&&(H==="selected"?s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol":Js(s,a,H,fe,c,xe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in o)fe=o[Jt],o.hasOwnProperty(Jt)&&fe!=null&&!c.hasOwnProperty(Jt)&&Js(s,a,Jt,null,c,fe);for(ce in c)if(fe=c[ce],xe=o[ce],c.hasOwnProperty(ce)&&fe!==xe&&(fe!=null||xe!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,a));break;default:Js(s,a,ce,fe,c,xe)}return;default:if(Da(a)){for(var Zs in o)fe=o[Zs],o.hasOwnProperty(Zs)&&fe!==void 0&&!c.hasOwnProperty(Zs)&&rp(s,a,Zs,void 0,c,fe);for(Re in c)fe=c[Re],xe=o[Re],!c.hasOwnProperty(Re)||fe===xe||fe===void 0&&xe===void 0||rp(s,a,Re,fe,c,xe);return}}for(var ee in o)fe=o[ee],o.hasOwnProperty(ee)&&fe!=null&&!c.hasOwnProperty(ee)&&Js(s,a,ee,null,c,fe);for(qe in c)fe=c[qe],xe=o[qe],!c.hasOwnProperty(qe)||fe===xe||fe==null&&xe==null||Js(s,a,qe,fe,c,xe)}function W0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Jj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,E=m.duration;if(f&&E&&W0(w)){for(w=0,E=m.responseEnd,c+=1;c<o.length;c++){var H=o[c],ce=H.startTime;if(ce>E)break;var Re=H.transferSize,qe=H.initiatorType;Re&&W0(qe)&&(H=H.responseEnd,w+=Re*(H<E?1:(E-ce)/(H-ce)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ap=null,ip=null;function Hd(s){return s.nodeType===9?s:s.ownerDocument}function G0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function op(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var lp=null;function Zj(){var s=window.event;return s&&s.type==="popstate"?s===lp?!1:(lp=s,!0):(lp=null,!1)}var Y0=typeof setTimeout=="function"?setTimeout:void 0,eT=typeof clearTimeout=="function"?clearTimeout:void 0,Q0=typeof Promise=="function"?Promise:void 0,tT=typeof queueMicrotask=="function"?queueMicrotask:typeof Q0<"u"?function(s){return Q0.resolve(null).then(s).catch(sT)}:Y0;function sT(s){setTimeout(function(){throw s})}function Qi(s){return s==="head"}function X0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Vl(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Wc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Wc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,E=f.nodeName;f[dn]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Wc(s.ownerDocument.body);o=m}while(o);Vl(a)}function J0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function cp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cp(o),In(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function nT(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[dn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=oa(s.nextSibling),s===null)break}return null}function rT(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=oa(s.nextSibling),s===null))return null;return s}function Z0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=oa(s.nextSibling),s===null))return null;return s}function up(s){return s.data==="$?"||s.data==="$~"}function dp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function oa(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var hp=null;function e1(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return oa(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function t1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function s1(s,a,o){switch(a=Hd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Wc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);In(s)}var la=new Map,n1=new Set;function $d(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var gi=ye.d;ye.d={f:iT,r:oT,D:lT,C:cT,L:uT,m:dT,X:mT,S:hT,M:fT};function iT(){var s=gi.f(),a=Ld();return s||a}function oT(s){var a=sn(s);a!==null&&a.tag===5&&a.type==="form"?xv(a):gi.r(s)}var Ll=typeof document>"u"?null:document;function r1(s,a,o){var c=Ll;if(c&&typeof a=="string"&&a){var m=Gt(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),n1.has(m)||(n1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),nr(a,"link",s),he(a),c.head.appendChild(a)))}}function lT(s){gi.D(s),r1("dns-prefetch",s,null)}function cT(s,a){gi.C(s,a),r1("preconnect",s,a)}function uT(s,a,o){gi.L(s,a,o);var c=Ll;if(c&&s&&a){var m='link[rel="preload"][as="'+Gt(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Gt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Gt(o.imageSizes)+'"]')):m+='[href="'+Gt(s)+'"]';var f=m;switch(a){case"style":f=Ol(s);break;case"script":f=Bl(s)}la.has(f)||(s=_({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),la.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Gc(f))||a==="script"&&c.querySelector(Kc(f))||(a=c.createElement("link"),nr(a,"link",s),he(a),c.head.appendChild(a)))}}function dT(s,a){gi.m(s,a);var o=Ll;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Gt(c)+'"][href="'+Gt(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Bl(s)}if(!la.has(f)&&(s=_({rel:"modulepreload",href:s},a),la.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Kc(f)))return}c=o.createElement("link"),nr(c,"link",s),he(c),o.head.appendChild(c)}}}function hT(s,a,o){gi.S(s,a,o);var c=Ll;if(c&&s){var m=K(c).hoistableStyles,f=Ol(s);a=a||"default";var w=m.get(f);if(!w){var E={loading:0,preload:null};if(w=c.querySelector(Gc(f)))E.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":a},o),(o=la.get(f))&&mp(s,o);var H=w=c.createElement("link");he(H),nr(H,"link",s),H._p=new Promise(function(ce,Re){H.onload=ce,H.onerror=Re}),H.addEventListener("load",function(){E.loading|=1}),H.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Wd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:E},m.set(f,w)}}}function mT(s,a){gi.X(s,a);var o=Ll;if(o&&s){var c=K(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Kc(m)),f||(s=_({src:s,async:!0},a),(a=la.get(m))&&fp(s,a),f=o.createElement("script"),he(f),nr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function fT(s,a){gi.M(s,a);var o=Ll;if(o&&s){var c=K(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Kc(m)),f||(s=_({src:s,async:!0,type:"module"},a),(a=la.get(m))&&fp(s,a),f=o.createElement("script"),he(f),nr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function a1(s,a,o,c){var m=(m=Pe.current)?$d(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Ol(o.href),o=K(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ol(o.href);var f=K(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Gc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),la.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},la.set(s,o),f||pT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Bl(o),o=K(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ol(s){return'href="'+Gt(s)+'"'}function Gc(s){return'link[rel="stylesheet"]['+s+"]"}function i1(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function pT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),nr(a,"link",o),he(a),s.head.appendChild(a))}function Bl(s){return'[src="'+Gt(s)+'"]'}function Kc(s){return"script[async]"+s}function o1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+Gt(o.href)+'"]');if(c)return a.instance=c,he(c),c;var m=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),he(c),nr(c,"style",m),Wd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Ol(o.href);var f=s.querySelector(Gc(m));if(f)return a.state.loading|=4,a.instance=f,he(f),f;c=i1(o),(m=la.get(m))&&mp(c,m),f=(s.ownerDocument||s).createElement("link"),he(f);var w=f;return w._p=new Promise(function(E,H){w.onload=E,w.onerror=H}),nr(f,"link",c),a.state.loading|=4,Wd(f,o.precedence,s),a.instance=f;case"script":return f=Bl(o.src),(m=s.querySelector(Kc(f)))?(a.instance=m,he(m),m):(c=o,(m=la.get(f))&&(c=_({},o),fp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),he(m),nr(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Wd(c,o.precedence,s));return a.instance}function Wd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var E=c[w];if(E.dataset.precedence===a)f=E;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function mp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function fp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Gd=null;function l1(s,a,o){if(Gd===null){var c=new Map,m=Gd=new Map;m.set(o,c)}else m=Gd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[dn]||f[xt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var E=c.get(w);E?E.push(f):c.set(w,[f])}}return c}function c1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function gT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function u1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ol(c.href),f=a.querySelector(Gc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Kd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,he(f);return}f=a.ownerDocument||a,c=i1(c),(m=la.get(m))&&mp(c,m),f=f.createElement("link"),he(f);var w=f;w._p=new Promise(function(E,H){w.onload=E,w.onerror=H}),nr(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Kd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var pp=0;function bT(s,a){return s.stylesheets&&s.count===0&&Qd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&pp===0&&(pp=62500*Jj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>pp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Kd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yd=null;function Qd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yd=new Map,a.forEach(vT,s),Yd=null,Kd.call(s))}function vT(s,a){if(!(a.state.loading&4)){var o=Yd.get(s);if(o)var c=o.get(null);else{o=new Map,Yd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Kd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Yc={$$typeof:Z,Provider:null,Consumer:null,_currentValue:Ue,_currentValue2:Ue,_threadCount:0};function xT(s,a,o,c,m,f,w,E,H){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function d1(s,a,o,c,m,f,w,E,H,ce,Re,qe){return s=new xT(s,a,o,w,H,ce,Re,qe,E),a=1,f===!0&&(a|=24),f=qr(3,null,null,a),s.current=f,f.stateNode=s,a=Gm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Xm(f),s}function h1(s){return s?(s=pl,s):pl}function m1(s,a,o,c,m,f){m=h1(m),c.context===null?c.context=m:c.pendingContext=m,c=Vi(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ui(s,c,a),o!==null&&(Pr(o,s,a),Ec(o,s,a))}function f1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function gp(s,a){f1(s,a),(s=s.alternate)&&f1(s,a)}function p1(s){if(s.tag===13||s.tag===31){var a=Ro(s,67108864);a!==null&&Pr(a,s,67108864),gp(s,67108864)}}function g1(s){if(s.tag===13||s.tag===31){var a=Kr();a=F(a);var o=Ro(s,a);o!==null&&Pr(o,s,a),gp(s,a)}}var Xd=!0;function wT(s,a,o,c){var m=$.T;$.T=null;var f=ye.p;try{ye.p=2,yp(s,a,o,c)}finally{ye.p=f,$.T=m}}function _T(s,a,o,c){var m=$.T;$.T=null;var f=ye.p;try{ye.p=8,yp(s,a,o,c)}finally{ye.p=f,$.T=m}}function yp(s,a,o,c){if(Xd){var m=bp(c);if(m===null)np(s,a,c,Jd,o),b1(s,c);else if(jT(m,s,a,o,c))c.stopPropagation();else if(b1(s,c),a&4&&-1<kT.indexOf(s)){for(;m!==null;){var f=sn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=Ze(f.pendingLanes);if(w!==0){var E=f;for(E.pendingLanes|=2,E.entangledLanes|=2;w;){var H=1<<31-je(w);E.entanglements[1]|=H,w&=~H}Ua(f),(Hs&6)===0&&(Dd=wt()+500,qc(0))}}break;case 31:case 13:E=Ro(f,2),E!==null&&Pr(E,f,2),Ld(),gp(f,2)}if(f=bp(c),f===null&&np(s,a,c,Jd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else np(s,a,c,null,o)}}function bp(s){return s=xn(s),vp(s)}var Jd=null;function vp(s){if(Jd=null,s=hn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Jd=s,null}function y1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gt()){case Qt:return 2;case rs:return 8;case vs:case tn:return 32;case Ys:return 268435456;default:return 32}default:return 32}}var xp=!1,Xi=null,Ji=null,Zi=null,Qc=new Map,Xc=new Map,eo=[],kT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b1(s,a){switch(s){case"focusin":case"focusout":Xi=null;break;case"dragenter":case"dragleave":Ji=null;break;case"mouseover":case"mouseout":Zi=null;break;case"pointerover":case"pointerout":Qc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xc.delete(a.pointerId)}}function Jc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=sn(a),a!==null&&p1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function jT(s,a,o,c,m){switch(a){case"focusin":return Xi=Jc(Xi,s,a,o,c,m),!0;case"dragenter":return Ji=Jc(Ji,s,a,o,c,m),!0;case"mouseover":return Zi=Jc(Zi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Qc.set(f,Jc(Qc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Xc.set(f,Jc(Xc.get(f)||null,s,a,o,c,m)),!0}return!1}function v1(s){var a=hn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){g1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){g1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Zd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=bp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Kn=c,o.target.dispatchEvent(c),Kn=null}else return a=sn(o),a!==null&&p1(a),s.blockedOn=o,!1;a.shift()}return!0}function x1(s,a,o){Zd(s)&&o.delete(a)}function TT(){xp=!1,Xi!==null&&Zd(Xi)&&(Xi=null),Ji!==null&&Zd(Ji)&&(Ji=null),Zi!==null&&Zd(Zi)&&(Zi=null),Qc.forEach(x1),Xc.forEach(x1)}function eh(s,a){s.blockedOn===a&&(s.blockedOn=null,xp||(xp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,TT)))}var th=null;function w1(s){th!==s&&(th=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){th===s&&(th=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(vp(c||o)===null)continue;break}var f=sn(o);f!==null&&(s.splice(a,3),a-=3,bf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Vl(s){function a(H){return eh(H,s)}Xi!==null&&eh(Xi,s),Ji!==null&&eh(Ji,s),Zi!==null&&eh(Zi,s),Qc.forEach(a),Xc.forEach(a);for(var o=0;o<eo.length;o++){var c=eo[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<eo.length&&(o=eo[0],o.blockedOn===null);)v1(o),o.blockedOn===null&&eo.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[At]||null;if(typeof f=="function")w||w1(o);else if(w){var E=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[At]||null)E=w.formAction;else if(vp(m)!==null)continue}else E=w.action;typeof E=="function"?o[c+1]=E:(o.splice(c,3),c-=3),w1(o)}}}function _1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function wp(s){this._internalRoot=s}sh.prototype.render=wp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Kr();m1(o,c,s,a,null,null)},sh.prototype.unmount=wp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;m1(s.current,2,null,s,null,null),Ld(),a[ht]=null}};function sh(s){this._internalRoot=s}sh.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ne();s={blockedOn:null,target:s,priority:a};for(var o=0;o<eo.length&&a!==0&&a<eo[o].priority;o++);eo.splice(o,0,s),o===0&&v1(s)}};var k1=e.version;if(k1!=="19.2.4")throw Error(i(527,k1,"19.2.4"));ye.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var ST={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nh.isDisabled&&nh.supportsFiber)try{xs=nh.inject(ST),ge=nh}catch{}}return eu.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Rv,f=Av,w=Mv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=d1(s,1,!1,null,null,o,c,null,m,f,w,_1),s[ht]=a.current,sp(s),new wp(a)},eu.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Rv,w=Av,E=Mv,H=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(H=o.formState)),a=d1(s,1,!0,a,o??null,c,m,H,f,w,E,_1),a.context=h1(null),o=a.current,c=Kr(),c=F(c),m=Vi(c),m.callback=null,Ui(o,m,c),o=c,a.current.lanes=o,Qe(a,o),Ua(a),s[ht]=a.current,sp(s),new sh(a)},eu.version="19.2.4",eu}var I1;function LT(){if(I1)return jp.exports;I1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),jp.exports=PT(),jp.exports}var OT=LT();const BT="modulepreload",VT=function(n){return"/login/"+n},D1={},Sr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=VT(y),y in D1)return;D1[y]=!0;const x=y.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":BT,x||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),x)return new Promise((O,G)=>{j.addEventListener("load",O),j.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var P1="popstate";function UT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return ig("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:wu(l)}return zT(e,t,null,n)}function gn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ha(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FT(){return Math.random().toString(36).substring(2,10)}function L1(n,e){return{usr:n.state,key:n.key,idx:e}}function ig(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?oc(e):e,state:t,key:e&&e.key||i||FT()}}function wu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function oc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function zT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function _(){p="POP";let D=x(),te=D==null?null:D-y;y=D,g&&g({action:p,location:B.location,delta:te})}function j(D,te){p="PUSH";let Y=ig(B.location,D,te);y=x()+1;let Z=L1(Y,y),_e=B.createHref(Y);try{d.pushState(Z,"",_e)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;l.location.assign(_e)}u&&g&&g({action:p,location:B.location,delta:1})}function O(D,te){p="REPLACE";let Y=ig(B.location,D,te);y=x();let Z=L1(Y,y),_e=B.createHref(Y);d.replaceState(Z,"",_e),u&&g&&g({action:p,location:B.location,delta:0})}function G(D){return qT(D)}let B={get action(){return p},get location(){return n(l,d)},listen(D){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(P1,_),g=D,()=>{l.removeEventListener(P1,_),g=null}},createHref(D){return e(l,D)},createURL:G,encodeLocation(D){let te=G(D);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:j,replace:O,go(D){return d.go(D)}};return B}function qT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),gn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:wu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function U2(n,e,t="/"){return HT(n,e,t,!1)}function HT(n,e,t,i){let l=typeof e=="string"?oc(e):e,u=ji(l.pathname||"/",t);if(u==null)return null;let d=F2(n);$T(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=sS(u);p=eS(d[g],y,i)}return p}function F2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;gn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let _=wi([i,x.relativePath]),j=t.concat(x);d.children&&d.children.length>0&&(gn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),F2(d.children,e,j,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:JT(_,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of z2(d.path))u(d,p,!0,g)}),e}function z2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=z2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function $T(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:ZT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var WT=/^:[\w-]+$/,GT=3,KT=2,YT=1,QT=10,XT=-2,O1=n=>n==="*";function JT(n,e){let t=n.split("/"),i=t.length;return t.some(O1)&&(i+=XT),e&&(i+=KT),t.filter(l=>!O1(l)).reduce((l,u)=>l+(WT.test(u)?GT:u===""?YT:QT),i)}function ZT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function eS(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",_=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),j=g.route;if(!_&&y&&t&&!i[i.length-1].route.index&&(_=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!_)return null;Object.assign(l,_.params),d.push({params:l,pathname:wi([u,_.pathname]),pathnameBase:iS(wi([u,_.pathnameBase])),route:j}),_.pathnameBase!=="/"&&(u=wi([u,_.pathnameBase]))}return d}function Ih(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=tS(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:_},j)=>{if(x==="*"){let G=p[j]||"";d=u.slice(0,u.length-G.length).replace(/(.)\/+$/,"$1")}const O=p[j];return _&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function tS(n,e=!1,t=!0){ha(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function sS(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ha(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ji(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rS(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?oc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=B1(t.substring(1),"/"):u=B1(t,e)):u=e,{pathname:u,search:oS(i),hash:lS(l)}}function B1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Np(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aS(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vg(n){let e=aS(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ug(n,e,t,i=!1){let l;typeof n=="string"?l=oc(n):(l={...n},gn(!l.pathname||!l.pathname.includes("?"),Np("?","pathname","search",l)),gn(!l.pathname||!l.pathname.includes("#"),Np("#","pathname","hash",l)),gn(!l.search||!l.search.includes("#"),Np("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let _=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),_-=1;l.pathname=j.join("/")}p=_>=0?e[_]:"/"}let g=rS(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var wi=n=>n.join("/").replace(/\/\/+/g,"/"),iS=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oS=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lS=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,cS=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function uS(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function dS(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var q2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function H2(n,e){let t=n;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(q2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ji(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ha(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $2=["POST","PUT","PATCH","DELETE"];new Set($2);var hS=["GET",...$2];new Set(hS);var lc=b.createContext(null);lc.displayName="DataRouter";var tm=b.createContext(null);tm.displayName="DataRouterState";var mS=b.createContext(!1),W2=b.createContext({isTransitioning:!1});W2.displayName="ViewTransition";var fS=b.createContext(new Map);fS.displayName="Fetchers";var pS=b.createContext(null);pS.displayName="Await";var Jr=b.createContext(null);Jr.displayName="Navigation";var Lu=b.createContext(null);Lu.displayName="Location";var Aa=b.createContext({outlet:null,matches:[],isDataRoute:!1});Aa.displayName="Route";var Fg=b.createContext(null);Fg.displayName="RouteError";var G2="REACT_ROUTER_ERROR",gS="REDIRECT",yS="ROUTE_ERROR_RESPONSE";function bS(n){if(n.startsWith(`${G2}:${gS}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(n){if(n.startsWith(`${G2}:${yS}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new cS(e.status,e.statusText,e.data)}catch{}}function xS(n,{relative:e}={}){gn(cc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=b.useContext(Jr),{hash:l,pathname:u,search:d}=Ou(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:wi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function cc(){return b.useContext(Lu)!=null}function Ma(){return gn(cc(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Lu).location}var K2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y2(n){b.useContext(Jr).static||b.useLayoutEffect(n)}function or(){let{isDataRoute:n}=b.useContext(Aa);return n?DS():wS()}function wS(){gn(cc(),"useNavigate() may be used only in the context of a <Router> component.");let n=b.useContext(lc),{basename:e,navigator:t}=b.useContext(Jr),{matches:i}=b.useContext(Aa),{pathname:l}=Ma(),u=JSON.stringify(Vg(i)),d=b.useRef(!1);return Y2(()=>{d.current=!0}),b.useCallback((g,y={})=>{if(ha(d.current,K2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Ug(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:wi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}b.createContext(null);function _S(){let{matches:n}=b.useContext(Aa),e=n[n.length-1];return e?e.params:{}}function Ou(n,{relative:e}={}){let{matches:t}=b.useContext(Aa),{pathname:i}=Ma(),l=JSON.stringify(Vg(t));return b.useMemo(()=>Ug(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function kS(n,e){return Q2(n,e)}function Q2(n,e,t,i,l){gn(cc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=b.useContext(Jr),{matches:d}=b.useContext(Aa),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",_=p&&p.route;{let Y=_&&_.path||"";J2(y,!_||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let j=Ma(),O;if(e){let Y=typeof e=="string"?oc(e):e;gn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),O=Y}else O=j;let G=O.pathname||"/",B=G;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");B="/"+G.replace(/^\//,"").split("/").slice(Y.length).join("/")}let D=U2(n,{pathname:B});ha(_||D!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ha(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=NS(D&&D.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:wi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:wi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&te?b.createElement(Lu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function jS(){let n=IS(),e=uS(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:u},"ErrorBoundary")," or"," ",b.createElement("code",{style:u},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:l},t):null,d)}var TS=b.createElement(jS,null),X2=class extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=vS(n.digest);t&&(n=t)}let e=n!==void 0?b.createElement(Aa.Provider,{value:this.props.routeContext},b.createElement(Fg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?b.createElement(SS,{error:n},e):e}};X2.contextType=mS;var Cp=new WeakMap;function SS({children:n,error:e}){let{basename:t}=b.useContext(Jr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=bS(e.digest);if(i){let l=Cp.get(e);if(l)throw l;let u=H2(i.location,t);if(q2&&!Cp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Cp.set(e,d),d}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function ES({routeContext:n,match:e,children:t}){let i=b.useContext(lc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Aa.Provider,{value:n},t)}function NS(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);gn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let _=u[x];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=x),_.route.id){let{loaderData:j,errors:O}=t,G=_.route.loader&&!j.hasOwnProperty(_.route.id)&&(!O||O[_.route.id]===void 0);if(_.route.lazy||G){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,_)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:dS(t.matches),errorInfo:_})}:void 0;return u.reduceRight((x,_,j)=>{let O,G=!1,B=null,D=null;t&&(O=d&&_.route.id?d[_.route.id]:void 0,B=_.route.errorElement||TS,p&&(g<0&&j===0?(J2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,D=null):g===j&&(G=!0,D=_.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,j+1)),Y=()=>{let Z;return O?Z=B:G?Z=D:_.route.Component?Z=b.createElement(_.route.Component,null):_.route.element?Z=_.route.element:Z=x,b.createElement(ES,{match:_,routeContext:{outlet:x,matches:te,isDataRoute:t!=null},children:Z})};return t&&(_.route.ErrorBoundary||_.route.errorElement||j===0)?b.createElement(X2,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:Y(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):Y()},null)}function zg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(n){let e=b.useContext(lc);return gn(e,zg(n)),e}function RS(n){let e=b.useContext(tm);return gn(e,zg(n)),e}function AS(n){let e=b.useContext(Aa);return gn(e,zg(n)),e}function qg(n){let e=AS(n),t=e.matches[e.matches.length-1];return gn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function MS(){return qg("useRouteId")}function IS(){let n=b.useContext(Fg),e=RS("useRouteError"),t=qg("useRouteError");return n!==void 0?n:e.errors?.[t]}function DS(){let{router:n}=CS("useNavigate"),e=qg("useNavigate"),t=b.useRef(!1);return Y2(()=>{t.current=!0}),b.useCallback(async(l,u={})=>{ha(t.current,K2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var V1={};function J2(n,e,t){!e&&!V1[n]&&(V1[n]=!0,ha(!1,t))}b.memo(PS);function PS({routes:n,future:e,state:t,onError:i}){return Q2(n,void 0,t,i,e)}function Z2({to:n,replace:e,state:t,relative:i}){gn(cc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=b.useContext(Jr);ha(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=b.useContext(Aa),{pathname:d}=Ma(),p=or(),g=Ug(n,Vg(u),d,i==="path"),y=JSON.stringify(g);return b.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function rn(n){gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){gn(!cc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=oc(t));let{pathname:y="/",search:x="",hash:_="",state:j=null,key:O="default"}=t,G=b.useMemo(()=>{let B=ji(y,p);return B==null?null:{location:{pathname:B,search:x,hash:_,state:j,key:O},navigationType:i}},[p,y,x,_,j,O,i]);return ha(G!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${_}" because it does not start with the basename, so the <Router> won't render anything.`),G==null?null:b.createElement(Jr.Provider,{value:g},b.createElement(Lu.Provider,{children:e,value:G}))}function OS({children:n,location:e}){return kS(og(n),e)}function og(n,e=[]){let t=[];return b.Children.forEach(n,(i,l)=>{if(!b.isValidElement(i))return;let u=[...e,l];if(i.type===b.Fragment){t.push.apply(t,og(i.props.children,u));return}gn(i.type===rn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=og(i.props.children,u)),t.push(d)}),t}var xh="get",wh="application/x-www-form-urlencoded";function sm(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function BS(n){return sm(n)&&n.tagName.toLowerCase()==="button"}function VS(n){return sm(n)&&n.tagName.toLowerCase()==="form"}function US(n){return sm(n)&&n.tagName.toLowerCase()==="input"}function FS(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zS(n,e){return n.button===0&&(!e||e==="_self")&&!FS(n)}function lg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function qS(n,e){let t=lg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var rh=null;function HS(){if(rh===null)try{new FormData(document.createElement("form"),0),rh=!1}catch{rh=!0}return rh}var $S=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Rp(n){return n!=null&&!$S.has(n)?(ha(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wh}"`),null):n}function WS(n,e){let t,i,l,u,d;if(VS(n)){let p=n.getAttribute("action");i=p?ji(p,e):null,t=n.getAttribute("method")||xh,l=Rp(n.getAttribute("enctype"))||wh,u=new FormData(n)}else if(BS(n)||US(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?ji(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||xh,l=Rp(n.getAttribute("formenctype"))||Rp(p.getAttribute("enctype"))||wh,u=new FormData(p,n),!HS()){let{name:y,type:x,value:_}=n;if(x==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,_)}}else{if(sm(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xh,i=null,l=wh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function GS(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ji(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function KS(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YS(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function QS(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await KS(u,t);return d.links?d.links():[]}return[]}));return eE(i.flat(1).filter(YS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function U1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function XS(n,e,{includeHydrateFallback:t}={}){return JS(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function JS(n){return[...new Set(n)]}function ZS(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function eE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(ZS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function ew(){let n=b.useContext(lc);return Hg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tE(){let n=b.useContext(tm);return Hg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var $g=b.createContext(void 0);$g.displayName="FrameworkContext";function tw(){let n=b.useContext($g);return Hg(n,"You must render this element inside a <HydratedRouter> element"),n}function sE(n,e){let t=b.useContext($g),[i,l]=b.useState(!1),[u,d]=b.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:_}=e,j=b.useRef(null);b.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let B=te=>{te.forEach(Y=>{d(Y.isIntersecting)})},D=new IntersectionObserver(B,{threshold:.5});return j.current&&D.observe(j.current),()=>{D.disconnect()}}},[n]),b.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let O=()=>{l(!0)},G=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:tu(p,O),onBlur:tu(g,G),onMouseEnter:tu(y,O),onMouseLeave:tu(x,G),onTouchStart:tu(_,O)}]:[!1,j,{}]}function tu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function nE({page:n,...e}){let{router:t}=ew(),i=b.useMemo(()=>U2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?b.createElement(aE,{page:n,matches:i,...e}):null}function rE(n){let{manifest:e,routeModules:t}=tw(),[i,l]=b.useState([]);return b.useEffect(()=>{let u=!1;return QS(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function aE({page:n,matches:e,...t}){let i=Ma(),{future:l,manifest:u,routeModules:d}=tw(),{basename:p}=ew(),{loaderData:g,matches:y}=tE(),x=b.useMemo(()=>U1(n,e,y,u,i,"data"),[n,e,y,u,i]),_=b.useMemo(()=>U1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=b.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let B=new Set,D=!1;if(e.forEach(Y=>{let Z=u.routes[Y.route.id];!Z||!Z.hasLoader||(!x.some(_e=>_e.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||Z.hasClientLoader?D=!0:B.add(Y.route.id))}),B.size===0)return[];let te=GS(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return D&&B.size>0&&te.searchParams.set("_routes",e.filter(Y=>B.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),O=b.useMemo(()=>XS(_,u),[_,u]),G=rE(_);return b.createElement(b.Fragment,null,j.map(B=>b.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),O.map(B=>b.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),G.map(({key:B,link:D})=>b.createElement("link",{key:B,nonce:t.nonce,...D,crossOrigin:D.crossOrigin??t.crossOrigin})))}function iE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var oE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oE&&(window.__reactRouterVersion="7.13.0")}catch{}function lE({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=b.useRef();l.current==null&&(l.current=UT({window:i,v5Compat:!0}));let u=l.current,[d,p]=b.useState({action:u.action,location:u.location}),g=b.useCallback(y=>{t===!1?p(y):b.startTransition(()=>p(y))},[t]);return b.useLayoutEffect(()=>u.listen(g),[u,g]),b.createElement(LS,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nw=b.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},G){let{basename:B,unstable_useTransitions:D}=b.useContext(Jr),te=typeof y=="string"&&sw.test(y),Y=H2(y,B);y=Y.to;let Z=xS(y,{relative:l}),[_e,Me,we]=sE(i,O),N=hE(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:j,unstable_useTransitions:D});function T(V){e&&e(V),V.defaultPrevented||N(V)}let M=b.createElement("a",{...O,...we,href:Y.absoluteURL||Z,onClick:Y.isExternal||u?e:T,ref:iE(G,Me),target:g,"data-discover":!te&&t==="render"?"true":void 0});return _e&&!te?b.createElement(b.Fragment,null,M,b.createElement(nE,{page:Z})):M});nw.displayName="Link";var cE=b.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let _=Ou(d,{relative:y.relative}),j=Ma(),O=b.useContext(tm),{navigator:G,basename:B}=b.useContext(Jr),D=O!=null&&bE(_)&&p===!0,te=G.encodeLocation?G.encodeLocation(_).pathname:_.pathname,Y=j.pathname,Z=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),Z=Z?Z.toLowerCase():null,te=te.toLowerCase()),Z&&B&&(Z=ji(Z,B)||Z);const _e=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let Me=Y===te||!l&&Y.startsWith(te)&&Y.charAt(_e)==="/",we=Z!=null&&(Z===te||!l&&Z.startsWith(te)&&Z.charAt(te.length)==="/"),N={isActive:Me,isPending:we,isTransitioning:D},T=Me?e:void 0,M;typeof i=="function"?M=i(N):M=[i,Me?"active":null,we?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(N):u;return b.createElement(nw,{...y,"aria-current":T,className:M,ref:x,style:V,to:d,viewTransition:p},typeof g=="function"?g(N):g)});cE.displayName="NavLink";var uE=b.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=xh,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},G)=>{let{unstable_useTransitions:B}=b.useContext(Jr),D=gE(),te=yE(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",Z=typeof p=="string"&&sw.test(p),_e=Me=>{if(g&&g(Me),Me.defaultPrevented)return;Me.preventDefault();let we=Me.nativeEvent.submitter,N=we?.getAttribute("formmethod")||d,T=()=>D(we||Me.currentTarget,{fetcherKey:e,method:N,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j});B&&t!==!1?b.startTransition(()=>T()):T()};return b.createElement("form",{ref:G,method:Y,action:te,onSubmit:i?g:_e,...O,"data-discover":!Z&&n==="render"?"true":void 0})});uE.displayName="Form";function dE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(n){let e=b.useContext(lc);return gn(e,dE(n)),e}function hE(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=or(),x=Ma(),_=Ou(n,{relative:u});return b.useCallback(j=>{if(zS(j,e)){j.preventDefault();let O=t!==void 0?t:wu(x)===wu(_),G=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?b.startTransition(()=>G()):G()}},[x,y,_,t,i,e,n,l,u,d,p,g])}function mE(n){ha(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(lg(n)),t=b.useRef(!1),i=Ma(),l=b.useMemo(()=>qS(i.search,t.current?null:e.current),[i.search]),u=or(),d=b.useCallback((p,g)=>{const y=lg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var fE=0,pE=()=>`__${String(++fE)}__`;function gE(){let{router:n}=rw("useSubmit"),{basename:e}=b.useContext(Jr),t=MS(),i=n.fetch,l=n.navigate;return b.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:_}=WS(u,e);if(d.navigate===!1){let j=d.fetcherKey||pE();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function yE(n,{relative:e}={}){let{basename:t}=b.useContext(Jr),i=b.useContext(Aa);gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ou(n||".",{relative:e})},d=Ma();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:wi([t,u.pathname])),wu(u)}function bE(n,{relative:e}={}){let t=b.useContext(W2);gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=rw("useViewTransitionState"),l=Ou(n,{relative:e});if(!t.isTransitioning)return!1;let u=ji(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ji(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ih(l.pathname,d)!=null||Ih(l.pathname,u)!=null}const vE=()=>{};var F1={};const aw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},xE=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},iw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,_=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[x],t[_],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):xE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const _=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||_==null)throw new wE;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),_!==64){const G=y<<6&192|_;i.push(G)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class wE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _E=function(n){const e=aw(n);return iw.encodeByteArray(e,!0)},Dh=function(n){return _E(n).replace(/\./g,"")},ow=function(n){try{return iw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function kE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const jE=()=>kE().__FIREBASE_DEFAULTS__,TE=()=>{if(typeof process>"u"||typeof F1>"u")return;const n=F1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SE=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ow(n[1]);return e&&JSON.parse(e)},nm=()=>{try{return vE()||jE()||TE()||SE()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},lw=n=>nm()?.emulatorHosts?.[n],cw=n=>{const e=lw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},uw=()=>nm()?.config,dw=n=>nm()?.[`_${n}`];class EE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function _o(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Wg(n){return(await fetch(n,{credentials:"include"})).ok}function hw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const fu={};function NE(){const n={prod:[],emulator:[]};for(const e of Object.keys(fu))fu[e]?n.emulator.push(e):n.prod.push(e);return n}function CE(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let z1=!1;function Gg(n,e){if(typeof window>"u"||typeof document>"u"||!_o(window.location.host)||fu[n]===e||fu[n]||z1)return;fu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=NE().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{z1=!0,d()},j}function x(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function _(){const j=CE(i),O=t("text"),G=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),D=document.getElementById(B)||document.createElement("a"),te=t("preprendIcon"),Y=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const Z=j.element;p(Z),x(D,B);const _e=y();g(Y,te),Z.append(Y,G,D,_e),document.body.appendChild(Z)}u?(G.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,G.innerText="Preview backend running in this workspace."),G.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function pr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pr())}function AE(){const n=nm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ME(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IE(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PE(){const n=pr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function LE(){return!AE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OE(){try{return typeof indexedDB=="object"}catch{return!1}}function BE(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const VE="FirebaseError";class Za extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=VE,Object.setPrototypeOf(this,Za.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?UE(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Za(l,p,i)}}function UE(n,e){return n.replace(FE,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const FE=/\{\$([^}]+)}/g;function zE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(q1(u)&&q1(d)){if(!Zo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function q1(n){return n!==null&&typeof n=="object"}function Vu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function cu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qE(n,e){const t=new HE(n,e);return t.subscribe.bind(t)}class HE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");$E(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Ap),l.error===void 0&&(l.error=Ap),l.complete===void 0&&(l.complete=Ap);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $E(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ap(){}function en(n){return n&&n._delegate?n._delegate:n}class po{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Go="[DEFAULT]";class WE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EE;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(KE(e))try{this.getOrInitializeService({instanceIdentifier:Go})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Go){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Go){return this.instances.has(e)}getOptions(e=Go){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:GE(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Go){return this.component?this.component.multipleInstances?e:Go:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GE(n){return n===Go?void 0:n}function KE(n){return n.instantiationMode==="EAGER"}class YE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new WE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Es;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Es||(Es={}));const QE={debug:Es.DEBUG,verbose:Es.VERBOSE,info:Es.INFO,warn:Es.WARN,error:Es.ERROR,silent:Es.SILENT},XE=Es.INFO,JE={[Es.DEBUG]:"log",[Es.VERBOSE]:"log",[Es.INFO]:"info",[Es.WARN]:"warn",[Es.ERROR]:"error"},ZE=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=JE[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kg{constructor(e){this.name=e,this._logLevel=XE,this._logHandler=ZE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Es))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Es.DEBUG,...e),this._logHandler(this,Es.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Es.VERBOSE,...e),this._logHandler(this,Es.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Es.INFO,...e),this._logHandler(this,Es.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Es.WARN,...e),this._logHandler(this,Es.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Es.ERROR,...e),this._logHandler(this,Es.ERROR,...e)}}const eN=(n,e)=>e.some(t=>n instanceof t);let H1,$1;function tN(){return H1||(H1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sN(){return $1||($1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mw=new WeakMap,cg=new WeakMap,fw=new WeakMap,Mp=new WeakMap,Yg=new WeakMap;function nN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(co(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&mw.set(t,n)}).catch(()=>{}),Yg.set(e,n),e}function rN(n){if(cg.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});cg.set(n,e)}let ug={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aN(n){ug=n(ug)}function iN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ip(this),e,...t);return fw.set(i,e.sort?e.sort():[e]),co(i)}:sN().includes(n)?function(...e){return n.apply(Ip(this),e),co(mw.get(this))}:function(...e){return co(n.apply(Ip(this),e))}}function oN(n){return typeof n=="function"?iN(n):(n instanceof IDBTransaction&&rN(n),eN(n,tN())?new Proxy(n,ug):n)}function co(n){if(n instanceof IDBRequest)return nN(n);if(Mp.has(n))return Mp.get(n);const e=oN(n);return e!==n&&(Mp.set(n,e),Yg.set(e,n)),e}const Ip=n=>Yg.get(n);function lN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=co(d);return i&&d.addEventListener("upgradeneeded",g=>{i(co(d.result),g.oldVersion,g.newVersion,co(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const cN=["get","getKey","getAll","getAllKeys","count"],uN=["put","add","delete","clear"],Dp=new Map;function W1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=uN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||cN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Dp.set(e,u),u}aN(n=>({...n,get:(e,t,i)=>W1(e,t)||n.get(e,t,i),has:(e,t)=>!!W1(e,t)||n.has(e,t)}));class dN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function hN(n){return n.getComponent()?.type==="VERSION"}const dg="@firebase/app",G1="0.14.7";const Ti=new Kg("@firebase/app"),mN="@firebase/app-compat",fN="@firebase/analytics-compat",pN="@firebase/analytics",gN="@firebase/app-check-compat",yN="@firebase/app-check",bN="@firebase/auth",vN="@firebase/auth-compat",xN="@firebase/database",wN="@firebase/data-connect",_N="@firebase/database-compat",kN="@firebase/functions",jN="@firebase/functions-compat",TN="@firebase/installations",SN="@firebase/installations-compat",EN="@firebase/messaging",NN="@firebase/messaging-compat",CN="@firebase/performance",RN="@firebase/performance-compat",AN="@firebase/remote-config",MN="@firebase/remote-config-compat",IN="@firebase/storage",DN="@firebase/storage-compat",PN="@firebase/firestore",LN="@firebase/ai",ON="@firebase/firestore-compat",BN="firebase",VN="12.8.0";const hg="[DEFAULT]",UN={[dg]:"fire-core",[mN]:"fire-core-compat",[pN]:"fire-analytics",[fN]:"fire-analytics-compat",[yN]:"fire-app-check",[gN]:"fire-app-check-compat",[bN]:"fire-auth",[vN]:"fire-auth-compat",[xN]:"fire-rtdb",[wN]:"fire-data-connect",[_N]:"fire-rtdb-compat",[kN]:"fire-fn",[jN]:"fire-fn-compat",[TN]:"fire-iid",[SN]:"fire-iid-compat",[EN]:"fire-fcm",[NN]:"fire-fcm-compat",[CN]:"fire-perf",[RN]:"fire-perf-compat",[AN]:"fire-rc",[MN]:"fire-rc-compat",[IN]:"fire-gcs",[DN]:"fire-gcs-compat",[PN]:"fire-fst",[ON]:"fire-fst-compat",[LN]:"fire-vertex","fire-js":"fire-js",[BN]:"fire-js-all"};const Ph=new Map,FN=new Map,mg=new Map;function K1(n,e){try{n.container.addComponent(e)}catch(t){Ti.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function el(n){const e=n.name;if(mg.has(e))return Ti.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,n);for(const t of Ph.values())K1(t,n);for(const t of FN.values())K1(t,n);return!0}function rm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yr(n){return n==null?!1:n.settings!==void 0}const zN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uo=new Bu("app","Firebase",zN);class qN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uo.create("app-deleted",{appName:this._name})}}const ol=VN;function Qg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:hg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw uo.create("bad-app-name",{appName:String(l)});if(t||(t=uw()),!t)throw uo.create("no-options");const u=Ph.get(l);if(u){if(Zo(t,u.options)&&Zo(i,u.config))return u;throw uo.create("duplicate-app",{appName:l})}const d=new YE(l);for(const g of mg.values())d.addComponent(g);const p=new qN(t,i,d);return Ph.set(l,p),p}function Xg(n=hg){const e=Ph.get(n);if(!e&&n===hg&&uw())return Qg();if(!e)throw uo.create("no-app",{appName:n});return e}function $a(n,e,t){let i=UN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ti.warn(d.join(" "));return}el(new po(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const HN="firebase-heartbeat-database",$N=1,_u="firebase-heartbeat-store";let Pp=null;function pw(){return Pp||(Pp=lN(HN,$N,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_u)}catch(t){console.warn(t)}}}}).catch(n=>{throw uo.create("idb-open",{originalErrorMessage:n.message})})),Pp}async function WN(n){try{const t=(await pw()).transaction(_u),i=await t.objectStore(_u).get(gw(n));return await t.done,i}catch(e){if(e instanceof Za)Ti.warn(e.message);else{const t=uo.create("idb-get",{originalErrorMessage:e?.message});Ti.warn(t.message)}}}async function Y1(n,e){try{const i=(await pw()).transaction(_u,"readwrite");await i.objectStore(_u).put(e,gw(n)),await i.done}catch(t){if(t instanceof Za)Ti.warn(t.message);else{const i=uo.create("idb-set",{originalErrorMessage:t?.message});Ti.warn(i.message)}}}function gw(n){return`${n.name}!${n.options.appId}`}const GN=1024,KN=30;class YN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Q1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>KN){const l=JN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ti.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Q1(),{heartbeatsToSend:t,unsentEntries:i}=QN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return Ti.warn(e),""}}}function Q1(){return new Date().toISOString().substring(0,10)}function QN(n,e=GN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),X1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),X1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class XN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OE()?BE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await WN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function X1(n){return Dh(JSON.stringify({version:2,heartbeats:n})).length}function JN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function ZN(n){el(new po("platform-logger",e=>new dN(e),"PRIVATE")),el(new po("heartbeat",e=>new YN(e),"PRIVATE")),$a(dg,G1,n),$a(dg,G1,"esm2020"),$a("fire-js","")}ZN("");function yw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eC=yw,bw=new Bu("auth","Firebase",yw());const Lh=new Kg("@firebase/auth");function tC(n,...e){Lh.logLevel<=Es.WARN&&Lh.warn(`Auth (${ol}): ${n}`,...e)}function _h(n,...e){Lh.logLevel<=Es.ERROR&&Lh.error(`Auth (${ol}): ${n}`,...e)}function Ea(n,...e){throw Jg(n,...e)}function Wa(n,...e){return Jg(n,...e)}function vw(n,e,t){const i={...eC(),[e]:t};return new Bu("auth","Firebase",i).create(e,{appName:n.name})}function _i(n){return vw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return bw.create(n,...e)}function Zt(n,e,...t){if(!n)throw Jg(e,...t)}function yi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw _h(e),new Error(e)}function Si(n,e){n||yi(e)}function fg(){return typeof self<"u"&&self.location?.href||""}function sC(){return J1()==="http:"||J1()==="https:"}function J1(){return typeof self<"u"&&self.location?.protocol||null}function nC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sC()||IE()||"connection"in navigator)?navigator.onLine:!0}function rC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Si(t>e,"Short delay should be less than long delay!"),this.isMobile=RE()||DE()}get(){return nC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zg(n,e){Si(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class xw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;yi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;yi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;yi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const aC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const iC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],oC=new Uu(3e4,6e4);function Ci(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ri(n,e,t,i,l={}){return ww(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Vu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return ME()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&_o(n.emulatorConfig.host)&&(y.credentials="include"),xw.fetch()(await _w(n,n.config.apiHost,t,p),y)})}async function ww(n,e,t){n._canInitEmulator=!1;const i={...aC,...e};try{const l=new cC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw ah(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw ah(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw vw(n,x,y);Ea(n,x)}}catch(l){if(l instanceof Za)throw l;Ea(n,"network-request-failed",{message:String(l)})}}async function Fu(n,e,t,i,l={}){const u=await Ri(n,e,t,i,l);return"mfaPendingCredential"in u&&Ea(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function _w(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Zg(n.config,l):`${n.config.apiScheme}://${l}`;return iC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function lC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Wa(this.auth,"network-request-failed")),oC.get())})}}function ah(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Wa(n,e,i);return l.customData._tokenResponse=t,l}function Z1(n){return n!==void 0&&n.enterprise!==void 0}class uC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return lC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function dC(n,e){return Ri(n,"GET","/v2/recaptchaConfig",Ci(n,e))}async function hC(n,e){return Ri(n,"POST","/v1/accounts:delete",e)}async function Oh(n,e){return Ri(n,"POST","/v1/accounts:lookup",e)}function pu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mC(n,e=!1){const t=en(n),i=await t.getIdToken(e),l=ey(i);Zt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:pu(Lp(l.auth_time)),issuedAtTime:pu(Lp(l.iat)),expirationTime:pu(Lp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Lp(n){return Number(n)*1e3}function ey(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const l=ow(t);return l?JSON.parse(l):(_h("Failed to decode base64 JWT payload"),null)}catch(l){return _h("Caught error parsing JWT payload as JSON",l?.toString()),null}}function ex(n){const e=ey(n);return Zt(e,"internal-error"),Zt(typeof e.exp<"u","internal-error"),Zt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ku(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Za&&fC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function fC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class pC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class pg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Bh(n){const e=n.auth,t=await n.getIdToken(),i=await ku(n,Oh(e,{idToken:t}));Zt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?kw(l.providerUserInfo):[],d=yC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function gC(n){const e=en(n);await Bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function kw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function bC(n,e){const t=await ww(n,{},async()=>{const i=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await _w(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&_o(n.emulatorConfig.host)&&(g.credentials="include"),xw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function vC(n,e){return Ri(n,"POST","/v2/accounts:revokeToken",Ci(n,e))}class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Zt(e.idToken,"internal-error"),Zt(typeof e.idToken<"u","internal-error"),Zt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Zt(e.length!==0,"internal-error");const t=ex(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Zt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await bC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Ql;return i&&(Zt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Zt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Zt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return yi("not implemented")}}function so(n,e){Zt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ta{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new pC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new pg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ku(this,this.stsTokenManager.getToken(this.auth,e));return Zt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return mC(this,e)}reload(){return gC(this)}_assign(e){this!==e&&(Zt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ta({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Zt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Bh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yr(this.auth.app))return Promise.reject(_i(this.auth));const e=await this.getIdToken();return await ku(this,hC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:_,emailVerified:j,isAnonymous:O,providerData:G,stsTokenManager:B}=t;Zt(_&&B,e,"internal-error");const D=Ql.fromJSON(this.name,B);Zt(typeof _=="string",e,"internal-error"),so(i,e.name),so(l,e.name),Zt(typeof j=="boolean",e,"internal-error"),Zt(typeof O=="boolean",e,"internal-error"),so(u,e.name),so(d,e.name),so(p,e.name),so(g,e.name),so(y,e.name),so(x,e.name);const te=new Ta({uid:_,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:D,createdAt:y,lastLoginAt:x});return G&&Array.isArray(G)&&(te.providerData=G.map(Y=>({...Y}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new Ql;l.updateFromServerResponse(t);const u=new Ta({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Bh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Zt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?kw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Ql;p.updateFromIdToken(i);const g=new Ta({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const tx=new Map;function bi(n){Si(n instanceof Function,"Expected a class definition");let e=tx.get(n);return e?(Si(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tx.set(n,e),e)}class jw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jw.type="NONE";const sx=jw;function kh(n,e,t){return`firebase:${n}:${e}:${t}`}class Xl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=kh(this.userKey,l.apiKey,u),this.fullPersistenceKey=kh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Oh(this.auth,{idToken:e}).catch(()=>{});return t?Ta._fromGetAccountInfoResponse(this.auth,t,e):null}return Ta._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Xl(bi(sx),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||bi(sx);const d=kh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let _;if(typeof x=="string"){const j=await Oh(e,{idToken:x}).catch(()=>{});if(!j)break;_=await Ta._fromGetAccountInfoResponse(e,j,x)}else _=Ta._fromJSON(e,x);y!==u&&(p=_),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Xl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Xl(u,e,i))}}function nx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rw(e))return"Blackberry";if(Aw(e))return"Webos";if(Sw(e))return"Safari";if((e.includes("chrome/")||Ew(e))&&!e.includes("edge/"))return"Chrome";if(Cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Tw(n=pr()){return/firefox\//i.test(n)}function Sw(n=pr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ew(n=pr()){return/crios\//i.test(n)}function Nw(n=pr()){return/iemobile/i.test(n)}function Cw(n=pr()){return/android/i.test(n)}function Rw(n=pr()){return/blackberry/i.test(n)}function Aw(n=pr()){return/webos/i.test(n)}function ty(n=pr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xC(n=pr()){return ty(n)&&!!window.navigator?.standalone}function wC(){return PE()&&document.documentMode===10}function Mw(n=pr()){return ty(n)||Cw(n)||Aw(n)||Rw(n)||/windows phone/i.test(n)||Nw(n)}function Iw(n,e=[]){let t;switch(n){case"Browser":t=nx(pr());break;case"Worker":t=`${nx(pr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ol}/${i}`}class _C{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function kC(n,e={}){return Ri(n,"GET","/v2/passwordPolicy",Ci(n,e))}const jC=6;class TC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??jC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class SC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rx(this),this.idTokenSubscription=new rx(this),this.beforeStateQueue=new _C(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Oh(this,{idToken:e}),i=await Ta._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Yr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Zt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Bh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yr(this.app))return Promise.reject(_i(this));const t=e?en(e):null;return t&&Zt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Zt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yr(this.app)?Promise.reject(_i(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yr(this.app)?Promise.reject(_i(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kC(this),t=new TC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await vC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bi(e)||this._popupRedirectResolver;Zt(t,this,"argument-error"),this.redirectPersistenceManager=await Xl.create(this,[bi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Zt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Zt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&tC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ko(n){return en(n)}class rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=qE(t=>this.observer=t)}get next(){return Zt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let am={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EC(n){am=n}function Dw(n){return am.loadJS(n)}function NC(){return am.recaptchaEnterpriseScript}function CC(){return am.gapiScript}function RC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class AC{constructor(){this.enterprise=new MC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class MC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const IC="recaptcha-enterprise",Pw="NO_RECAPTCHA";class DC{constructor(e){this.type=IC,this.auth=ko(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{dC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new uC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Z1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Z1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=NC();g.length!==0&&(g+=p),Dw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function ax(n,e,t,i=!1,l=!1){const u=new DC(n);let d;if(l)d=Pw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Vh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ax(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await ax(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function PC(n,e){const t=rm(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Zo(u,e??{}))return l;Ea(l,"already-initialized")}return t.initialize({options:e})}function LC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(bi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function OC(n,e,t){const i=ko(n);Zt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Lw(e),{host:d,port:p}=BC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Zt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Zt(Zo(y,i.config.emulator)&&Zo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,_o(d)?(Wg(`${u}//${d}${g}`),Gg("Auth",!0)):VC()}function Lw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BC(n){const e=Lw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:ix(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:ix(d)}}}function ix(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function VC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class sy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return yi("not implemented")}_getIdTokenResponse(e){return yi("not implemented")}_linkToIdToken(e,t){return yi("not implemented")}_getReauthenticationResolver(e){return yi("not implemented")}}async function UC(n,e){return Ri(n,"POST","/v1/accounts:signUp",e)}async function FC(n,e){return Fu(n,"POST","/v1/accounts:signInWithPassword",Ci(n,e))}async function Ow(n,e){return Ri(n,"POST","/v1/accounts:sendOobCode",Ci(n,e))}async function zC(n,e){return Ow(n,e)}async function qC(n,e){return Ow(n,e)}async function HC(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ci(n,e))}async function $C(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ci(n,e))}class ju extends sy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ju(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,t,"signInWithPassword",FC);case"emailLink":return HC(e,{email:this._email,oobCode:this._password});default:Ea(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,i,"signUpPassword",UC);case"emailLink":return $C(e,{idToken:t,email:this._email,oobCode:this._password});default:Ea(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jl(n,e){return Fu(n,"POST","/v1/accounts:signInWithIdp",Ci(n,e))}const WC="http://localhost";class tl extends sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ea("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new tl(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Jl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jl(e,t)}buildRequest(){const e={requestUri:WC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vu(t)}return e}}function GC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KC(n){const e=lu(cu(n)).link,t=e?lu(cu(e)).deep_link_id:null,i=lu(cu(n)).deep_link_id;return(i?lu(cu(i)).link:null)||i||t||e||n}class ny{constructor(e){const t=lu(cu(e)),i=t.apiKey??null,l=t.oobCode??null,u=GC(t.mode??null);Zt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=KC(e);try{return new ny(t)}catch{return null}}}class uc{constructor(){this.providerId=uc.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ny.parseLink(t);return Zt(i,"argument-error"),ju._fromEmailAndCode(e,i.code,i.tenantId)}}uc.PROVIDER_ID="password";uc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";uc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Bw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zu extends Bw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class no extends zu{constructor(){super("facebook.com")}static credential(e){return tl._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.FACEBOOK_SIGN_IN_METHOD="facebook.com";no.PROVIDER_ID="facebook.com";class ro extends zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tl._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ro.credential(t,i)}catch{return null}}}ro.GOOGLE_SIGN_IN_METHOD="google.com";ro.PROVIDER_ID="google.com";class ao extends zu{constructor(){super("github.com")}static credential(e){return tl._fromParams({providerId:ao.PROVIDER_ID,signInMethod:ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ao.credentialFromTaggedObject(e)}static credentialFromError(e){return ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ao.credential(e.oauthAccessToken)}catch{return null}}}ao.GITHUB_SIGN_IN_METHOD="github.com";ao.PROVIDER_ID="github.com";class io extends zu{constructor(){super("twitter.com")}static credential(e,t){return tl._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return io.credentialFromTaggedObject(e)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return io.credential(t,i)}catch{return null}}}io.TWITTER_SIGN_IN_METHOD="twitter.com";io.PROVIDER_ID="twitter.com";async function YC(n,e){return Fu(n,"POST","/v1/accounts:signUp",Ci(n,e))}class sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await Ta._fromIdTokenResponse(e,i,l),d=ox(i);return new sl({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ox(i);return new sl({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ox(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Uh extends Za{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Uh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Uh(e,t,i,l)}}function Vw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Uh._fromErrorAndOperation(n,u,e,i):u})}async function QC(n,e,t=!1){const i=await ku(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return sl._forOperation(n,"link",i)}async function XC(n,e,t=!1){const{auth:i}=n;if(Yr(i.app))return Promise.reject(_i(i));const l="reauthenticate";try{const u=await ku(n,Vw(i,l,e,n),t);Zt(u.idToken,i,"internal-error");const d=ey(u.idToken);Zt(d,i,"internal-error");const{sub:p}=d;return Zt(n.uid===p,i,"user-mismatch"),sl._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&Ea(i,"user-mismatch"),u}}async function Uw(n,e,t=!1){if(Yr(n.app))return Promise.reject(_i(n));const i="signIn",l=await Vw(n,i,e),u=await sl._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function JC(n,e){return Uw(ko(n),e)}async function Fw(n){const e=ko(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ZC(n,e,t){const i=ko(n);await Vh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",qC)}async function e4(n,e,t){if(Yr(n.app))return Promise.reject(_i(n));const i=ko(n),d=await Vh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",YC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Fw(n),g}),p=await sl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function t4(n,e,t){return Yr(n.app)?Promise.reject(_i(n)):JC(en(n),uc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Fw(n),i})}async function gP(n,e){const t=en(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await zC(t.auth,l);u!==n.email&&await n.reload()}function lx(n,e){return en(n).setPersistence(e)}function s4(n,e,t,i){return en(n).onIdTokenChanged(e,t,i)}function n4(n,e,t){return en(n).beforeAuthStateChanged(e,t)}function r4(n,e,t,i){return en(n).onAuthStateChanged(e,t,i)}function a4(n){return en(n).signOut()}const Fh="__sak";class zw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fh,"1"),this.storage.removeItem(Fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const i4=1e3,o4=10;class qw extends zw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);wC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,o4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},i4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qw.type="LOCAL";const gg=qw;class Hw extends zw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hw.type="SESSION";const ry=Hw;function l4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class im{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new im(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await l4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}im.receivers=[];function ay(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class c4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ay("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(_){const j=_;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ga(){return window}function u4(n){Ga().location.href=n}function $w(){return typeof Ga().WorkerGlobalScope<"u"&&typeof Ga().importScripts=="function"}async function d4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function h4(){return navigator?.serviceWorker?.controller||null}function m4(){return $w()?self:null}const Ww="firebaseLocalStorageDb",f4=1,zh="firebaseLocalStorage",Gw="fbase_key";class qu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function om(n,e){return n.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function p4(){const n=indexedDB.deleteDatabase(Ww);return new qu(n).toPromise()}function yg(){const n=indexedDB.open(Ww,f4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(zh,{keyPath:Gw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(zh)?e(i):(i.close(),await p4(),e(await yg()))})})}async function cx(n,e,t){const i=om(n,!0).put({[Gw]:e,value:t});return new qu(i).toPromise()}async function g4(n,e){const t=om(n,!1).get(e),i=await new qu(t).toPromise();return i===void 0?null:i.value}function ux(n,e){const t=om(n,!0).delete(e);return new qu(t).toPromise()}const y4=800,b4=3;class Kw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>b4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=im._getInstance(m4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await d4(),!this.activeServiceWorker)return;this.sender=new c4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||h4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yg();return await cx(e,Fh,"1"),await ux(e,Fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>cx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>g4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ux(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=om(l,!1).getAll();return new qu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),y4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kw.type="LOCAL";const v4=Kw;new Uu(3e4,6e4);function x4(n,e){return e?bi(e):(Zt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class iy extends sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function w4(n){return Uw(n.auth,new iy(n),n.bypassAuthState)}function _4(n){const{auth:e,user:t}=n;return Zt(t,e,"internal-error"),XC(t,new iy(n),n.bypassAuthState)}async function k4(n){const{auth:e,user:t}=n;return Zt(t,e,"internal-error"),QC(t,new iy(n),n.bypassAuthState)}class Yw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w4;case"linkViaPopup":case"linkViaRedirect":return k4;case"reauthViaPopup":case"reauthViaRedirect":return _4;default:Ea(this.auth,"internal-error")}}resolve(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const j4=new Uu(2e3,1e4);class Yl extends Yw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Yl.currentPopupAction&&Yl.currentPopupAction.cancel(),Yl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Zt(e,this.auth,"internal-error"),e}async onExecution(){Si(this.filter.length===1,"Popup operations only handle one event");const e=ay();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Wa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,j4.get())};e()}}Yl.currentPopupAction=null;const T4="pendingRedirect",jh=new Map;class S4 extends Yw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=jh.get(this.auth._key());if(!e){try{const i=await E4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}jh.set(this.auth._key(),e)}return this.bypassAuthState||jh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E4(n,e){const t=R4(e),i=C4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function N4(n,e){jh.set(n._key(),e)}function C4(n){return bi(n._redirectPersistence)}function R4(n){return kh(T4,n.config.apiKey,n.name)}async function A4(n,e,t=!1){if(Yr(n.app))return Promise.reject(_i(n));const i=ko(n),l=x4(i,e),d=await new S4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const M4=600*1e3;class I4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!D4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Qw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Wa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=M4&&this.cachedEventUids.clear(),this.cachedEventUids.has(dx(e))}saveEventToCache(e){this.cachedEventUids.add(dx(e)),this.lastProcessedEventTime=Date.now()}}function dx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function D4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qw(n);default:return!1}}async function P4(n,e={}){return Ri(n,"GET","/v1/projects",e)}const L4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O4=/^https?/;async function B4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await P4(n);for(const t of e)try{if(V4(t))return}catch{}Ea(n,"unauthorized-domain")}function V4(n){const e=fg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!O4.test(t))return!1;if(L4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const U4=new Uu(3e4,6e4);function hx(){const n=Ga().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function F4(n){return new Promise((e,t)=>{function i(){hx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hx(),t(Wa(n,"network-request-failed"))},timeout:U4.get()})}if(Ga().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ga().gapi?.load)i();else{const l=RC("iframefcb");return Ga()[l]=()=>{gapi.load?i():t(Wa(n,"network-request-failed"))},Dw(`${CC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function z4(n){return Th=Th||F4(n),Th}const q4=new Uu(5e3,15e3),H4="__/auth/iframe",$4="emulator/auth/iframe",W4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K4(n){const e=n.config;Zt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zg(e,$4):`https://${n.config.authDomain}/${H4}`,i={apiKey:e.apiKey,appName:n.name,v:ol},l=G4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Vu(i).slice(1)}`}async function Y4(n){const e=await z4(n),t=Ga().gapi;return Zt(t,n,"internal-error"),e.open({where:document.body,url:K4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Wa(n,"network-request-failed"),p=Ga().setTimeout(()=>{u(d)},q4.get());function g(){Ga().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const Q4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},X4=500,J4=600,Z4="_blank",eR="http://localhost";class mx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tR(n,e,t,i=X4,l=J4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...Q4,width:i.toString(),height:l.toString(),top:u,left:d},y=pr().toLowerCase();t&&(p=Ew(y)?Z4:t),Tw(y)&&(e=e||eR,g.scrollbars="yes");const x=Object.entries(g).reduce((j,[O,G])=>`${j}${O}=${G},`,"");if(xC(y)&&p!=="_self")return sR(e||"",p),new mx(null);const _=window.open(e||"",p,x);Zt(_,n,"popup-blocked");try{_.focus()}catch{}return new mx(_)}function sR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const nR="__/auth/handler",rR="emulator/auth/handler",aR=encodeURIComponent("fac");async function fx(n,e,t,i,l,u){Zt(n.config.authDomain,n,"auth-domain-config-required"),Zt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ol,eventId:l};if(e instanceof Bw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",zE(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries({}))d[x]=_}if(e instanceof zu){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${aR}=${encodeURIComponent(g)}`:"";return`${iR(n)}?${Vu(p).slice(1)}${y}`}function iR({config:n}){return n.emulator?Zg(n,rR):`https://${n.authDomain}/${nR}`}const Op="webStorageSupport";class oR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ry,this._completeRedirectFn=A4,this._overrideRedirectResult=N4}async _openPopup(e,t,i,l){Si(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await fx(e,t,i,fg(),l);return tR(e,u,ay())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await fx(e,t,i,fg(),l);return u4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(Si(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Y4(e),i=new I4(e);return t.register("authEvent",l=>(Zt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Op,{type:Op},l=>{const u=l?.[0]?.[Op];u!==void 0&&t(!!u),Ea(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=B4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mw()||Sw()||ty()}}const lR=oR;var px="@firebase/auth",gx="1.12.0";class cR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Zt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function uR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dR(n){el(new po("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Zt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iw(n)},y=new SC(i,l,u,g);return LC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),el(new po("auth-internal",e=>{const t=ko(e.getProvider("auth").getImmediate());return(i=>new cR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$a(px,gx,uR(n)),$a(px,gx,"esm2020")}const hR=300,mR=dw("authIdTokenMaxAge")||hR;let yx=null;const fR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>mR)return;const l=t?.token;yx!==l&&(yx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Xw(n=Xg()){const e=rm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=PC(n,{popupRedirectResolver:lR,persistence:[v4,gg,ry]}),i=dw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=fR(u.toString());n4(t,d,()=>d(t.currentUser)),s4(t,p=>d(p))}}const l=lw("auth");return l&&OC(t,`http://${l}`),t}function pR(){return document.getElementsByTagName("head")?.[0]??document}EC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Wa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",pR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dR("Browser");var bx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ho,Jw;(function(){var n;function e(N,T){function M(){}M.prototype=T.prototype,N.F=T.prototype,N.prototype=new M,N.prototype.constructor=N,N.D=function(V,I,L){for(var R=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)R[Ie-2]=arguments[Ie];return T.prototype[I].apply(V,R)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(N,T,M){M||(M=0);const V=Array(16);if(typeof T=="string")for(var I=0;I<16;++I)V[I]=T.charCodeAt(M++)|T.charCodeAt(M++)<<8|T.charCodeAt(M++)<<16|T.charCodeAt(M++)<<24;else for(I=0;I<16;++I)V[I]=T[M++]|T[M++]<<8|T[M++]<<16|T[M++]<<24;T=N.g[0],M=N.g[1],I=N.g[2];let L=N.g[3],R;R=T+(L^M&(I^L))+V[0]+3614090360&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(I^T&(M^I))+V[1]+3905402710&4294967295,L=T+(R<<12&4294967295|R>>>20),R=I+(M^L&(T^M))+V[2]+606105819&4294967295,I=L+(R<<17&4294967295|R>>>15),R=M+(T^I&(L^T))+V[3]+3250441966&4294967295,M=I+(R<<22&4294967295|R>>>10),R=T+(L^M&(I^L))+V[4]+4118548399&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(I^T&(M^I))+V[5]+1200080426&4294967295,L=T+(R<<12&4294967295|R>>>20),R=I+(M^L&(T^M))+V[6]+2821735955&4294967295,I=L+(R<<17&4294967295|R>>>15),R=M+(T^I&(L^T))+V[7]+4249261313&4294967295,M=I+(R<<22&4294967295|R>>>10),R=T+(L^M&(I^L))+V[8]+1770035416&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(I^T&(M^I))+V[9]+2336552879&4294967295,L=T+(R<<12&4294967295|R>>>20),R=I+(M^L&(T^M))+V[10]+4294925233&4294967295,I=L+(R<<17&4294967295|R>>>15),R=M+(T^I&(L^T))+V[11]+2304563134&4294967295,M=I+(R<<22&4294967295|R>>>10),R=T+(L^M&(I^L))+V[12]+1804603682&4294967295,T=M+(R<<7&4294967295|R>>>25),R=L+(I^T&(M^I))+V[13]+4254626195&4294967295,L=T+(R<<12&4294967295|R>>>20),R=I+(M^L&(T^M))+V[14]+2792965006&4294967295,I=L+(R<<17&4294967295|R>>>15),R=M+(T^I&(L^T))+V[15]+1236535329&4294967295,M=I+(R<<22&4294967295|R>>>10),R=T+(I^L&(M^I))+V[1]+4129170786&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^I&(T^M))+V[6]+3225465664&4294967295,L=T+(R<<9&4294967295|R>>>23),R=I+(T^M&(L^T))+V[11]+643717713&4294967295,I=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(I^L))+V[0]+3921069994&4294967295,M=I+(R<<20&4294967295|R>>>12),R=T+(I^L&(M^I))+V[5]+3593408605&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^I&(T^M))+V[10]+38016083&4294967295,L=T+(R<<9&4294967295|R>>>23),R=I+(T^M&(L^T))+V[15]+3634488961&4294967295,I=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(I^L))+V[4]+3889429448&4294967295,M=I+(R<<20&4294967295|R>>>12),R=T+(I^L&(M^I))+V[9]+568446438&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^I&(T^M))+V[14]+3275163606&4294967295,L=T+(R<<9&4294967295|R>>>23),R=I+(T^M&(L^T))+V[3]+4107603335&4294967295,I=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(I^L))+V[8]+1163531501&4294967295,M=I+(R<<20&4294967295|R>>>12),R=T+(I^L&(M^I))+V[13]+2850285829&4294967295,T=M+(R<<5&4294967295|R>>>27),R=L+(M^I&(T^M))+V[2]+4243563512&4294967295,L=T+(R<<9&4294967295|R>>>23),R=I+(T^M&(L^T))+V[7]+1735328473&4294967295,I=L+(R<<14&4294967295|R>>>18),R=M+(L^T&(I^L))+V[12]+2368359562&4294967295,M=I+(R<<20&4294967295|R>>>12),R=T+(M^I^L)+V[5]+4294588738&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^I)+V[8]+2272392833&4294967295,L=T+(R<<11&4294967295|R>>>21),R=I+(L^T^M)+V[11]+1839030562&4294967295,I=L+(R<<16&4294967295|R>>>16),R=M+(I^L^T)+V[14]+4259657740&4294967295,M=I+(R<<23&4294967295|R>>>9),R=T+(M^I^L)+V[1]+2763975236&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^I)+V[4]+1272893353&4294967295,L=T+(R<<11&4294967295|R>>>21),R=I+(L^T^M)+V[7]+4139469664&4294967295,I=L+(R<<16&4294967295|R>>>16),R=M+(I^L^T)+V[10]+3200236656&4294967295,M=I+(R<<23&4294967295|R>>>9),R=T+(M^I^L)+V[13]+681279174&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^I)+V[0]+3936430074&4294967295,L=T+(R<<11&4294967295|R>>>21),R=I+(L^T^M)+V[3]+3572445317&4294967295,I=L+(R<<16&4294967295|R>>>16),R=M+(I^L^T)+V[6]+76029189&4294967295,M=I+(R<<23&4294967295|R>>>9),R=T+(M^I^L)+V[9]+3654602809&4294967295,T=M+(R<<4&4294967295|R>>>28),R=L+(T^M^I)+V[12]+3873151461&4294967295,L=T+(R<<11&4294967295|R>>>21),R=I+(L^T^M)+V[15]+530742520&4294967295,I=L+(R<<16&4294967295|R>>>16),R=M+(I^L^T)+V[2]+3299628645&4294967295,M=I+(R<<23&4294967295|R>>>9),R=T+(I^(M|~L))+V[0]+4096336452&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~I))+V[7]+1126891415&4294967295,L=T+(R<<10&4294967295|R>>>22),R=I+(T^(L|~M))+V[14]+2878612391&4294967295,I=L+(R<<15&4294967295|R>>>17),R=M+(L^(I|~T))+V[5]+4237533241&4294967295,M=I+(R<<21&4294967295|R>>>11),R=T+(I^(M|~L))+V[12]+1700485571&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~I))+V[3]+2399980690&4294967295,L=T+(R<<10&4294967295|R>>>22),R=I+(T^(L|~M))+V[10]+4293915773&4294967295,I=L+(R<<15&4294967295|R>>>17),R=M+(L^(I|~T))+V[1]+2240044497&4294967295,M=I+(R<<21&4294967295|R>>>11),R=T+(I^(M|~L))+V[8]+1873313359&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~I))+V[15]+4264355552&4294967295,L=T+(R<<10&4294967295|R>>>22),R=I+(T^(L|~M))+V[6]+2734768916&4294967295,I=L+(R<<15&4294967295|R>>>17),R=M+(L^(I|~T))+V[13]+1309151649&4294967295,M=I+(R<<21&4294967295|R>>>11),R=T+(I^(M|~L))+V[4]+4149444226&4294967295,T=M+(R<<6&4294967295|R>>>26),R=L+(M^(T|~I))+V[11]+3174756917&4294967295,L=T+(R<<10&4294967295|R>>>22),R=I+(T^(L|~M))+V[2]+718787259&4294967295,I=L+(R<<15&4294967295|R>>>17),R=M+(L^(I|~T))+V[9]+3951481745&4294967295,N.g[0]=N.g[0]+T&4294967295,N.g[1]=N.g[1]+(I+(R<<21&4294967295|R>>>11))&4294967295,N.g[2]=N.g[2]+I&4294967295,N.g[3]=N.g[3]+L&4294967295}i.prototype.v=function(N,T){T===void 0&&(T=N.length);const M=T-this.blockSize,V=this.C;let I=this.h,L=0;for(;L<T;){if(I==0)for(;L<=M;)l(this,N,L),L+=this.blockSize;if(typeof N=="string"){for(;L<T;)if(V[I++]=N.charCodeAt(L++),I==this.blockSize){l(this,V),I=0;break}}else for(;L<T;)if(V[I++]=N[L++],I==this.blockSize){l(this,V),I=0;break}}this.h=I,this.o+=T},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var T=1;T<N.length-8;++T)N[T]=0;T=this.o*8;for(var M=N.length-8;M<N.length;++M)N[M]=T&255,T/=256;for(this.v(N),N=Array(16),T=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)N[T++]=this.g[M]>>>V&255;return N};function u(N,T){var M=p;return Object.prototype.hasOwnProperty.call(M,N)?M[N]:M[N]=T(N)}function d(N,T){this.h=T;const M=[];let V=!0;for(let I=N.length-1;I>=0;I--){const L=N[I]|0;V&&L==T||(M[I]=L,V=!1)}this.g=M}var p={};function g(N){return-128<=N&&N<128?u(N,function(T){return new d([T|0],T<0?-1:0)}):new d([N|0],N<0?-1:0)}function y(N){if(isNaN(N)||!isFinite(N))return _;if(N<0)return D(y(-N));const T=[];let M=1;for(let V=0;N>=M;V++)T[V]=N/M|0,M*=4294967296;return new d(T,0)}function x(N,T){if(N.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(N.charAt(0)=="-")return D(x(N.substring(1),T));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(T,8));let V=_;for(let L=0;L<N.length;L+=8){var I=Math.min(8,N.length-L);const R=parseInt(N.substring(L,L+I),T);I<8?(I=y(Math.pow(T,I)),V=V.j(I).add(y(R))):(V=V.j(M),V=V.add(y(R)))}return V}var _=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(B(this))return-D(this).m();let N=0,T=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);N+=(V>=0?V:4294967296+V)*T,T*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(G(this))return"0";if(B(this))return"-"+D(this).toString(N);const T=y(Math.pow(N,6));var M=this;let V="";for(;;){const I=_e(M,T).g;M=te(M,I.j(T));let L=((M.g.length>0?M.g[0]:M.h)>>>0).toString(N);if(M=I,G(M))return L+V;for(;L.length<6;)L="0"+L;V=L+V}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function G(N){if(N.h!=0)return!1;for(let T=0;T<N.g.length;T++)if(N.g[T]!=0)return!1;return!0}function B(N){return N.h==-1}n.l=function(N){return N=te(this,N),B(N)?-1:G(N)?0:1};function D(N){const T=N.g.length,M=[];for(let V=0;V<T;V++)M[V]=~N.g[V];return new d(M,~N.h).add(j)}n.abs=function(){return B(this)?D(this):this},n.add=function(N){const T=Math.max(this.g.length,N.g.length),M=[];let V=0;for(let I=0;I<=T;I++){let L=V+(this.i(I)&65535)+(N.i(I)&65535),R=(L>>>16)+(this.i(I)>>>16)+(N.i(I)>>>16);V=R>>>16,L&=65535,R&=65535,M[I]=R<<16|L}return new d(M,M[M.length-1]&-2147483648?-1:0)};function te(N,T){return N.add(D(T))}n.j=function(N){if(G(this)||G(N))return _;if(B(this))return B(N)?D(this).j(D(N)):D(D(this).j(N));if(B(N))return D(this.j(D(N)));if(this.l(O)<0&&N.l(O)<0)return y(this.m()*N.m());const T=this.g.length+N.g.length,M=[];for(var V=0;V<2*T;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let I=0;I<N.g.length;I++){const L=this.i(V)>>>16,R=this.i(V)&65535,Ie=N.i(I)>>>16,mt=N.i(I)&65535;M[2*V+2*I]+=R*mt,Y(M,2*V+2*I),M[2*V+2*I+1]+=L*mt,Y(M,2*V+2*I+1),M[2*V+2*I+1]+=R*Ie,Y(M,2*V+2*I+1),M[2*V+2*I+2]+=L*Ie,Y(M,2*V+2*I+2)}for(N=0;N<T;N++)M[N]=M[2*N+1]<<16|M[2*N];for(N=T;N<2*T;N++)M[N]=0;return new d(M,0)};function Y(N,T){for(;(N[T]&65535)!=N[T];)N[T+1]+=N[T]>>>16,N[T]&=65535,T++}function Z(N,T){this.g=N,this.h=T}function _e(N,T){if(G(T))throw Error("division by zero");if(G(N))return new Z(_,_);if(B(N))return T=_e(D(N),T),new Z(D(T.g),D(T.h));if(B(T))return T=_e(N,D(T)),new Z(D(T.g),T.h);if(N.g.length>30){if(B(N)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var M=j,V=T;V.l(N)<=0;)M=Me(M),V=Me(V);var I=we(M,1),L=we(V,1);for(V=we(V,2),M=we(M,2);!G(V);){var R=L.add(V);R.l(N)<=0&&(I=I.add(M),L=R),V=we(V,1),M=we(M,1)}return T=te(N,I.j(T)),new Z(I,T)}for(I=_;N.l(T)>=0;){for(M=Math.max(1,Math.floor(N.m()/T.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),L=y(M),R=L.j(T);B(R)||R.l(N)>0;)M-=V,L=y(M),R=L.j(T);G(L)&&(L=j),I=I.add(L),N=te(N,R)}return new Z(I,N)}n.B=function(N){return _e(this,N).h},n.and=function(N){const T=Math.max(this.g.length,N.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)&N.i(V);return new d(M,this.h&N.h)},n.or=function(N){const T=Math.max(this.g.length,N.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)|N.i(V);return new d(M,this.h|N.h)},n.xor=function(N){const T=Math.max(this.g.length,N.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)^N.i(V);return new d(M,this.h^N.h)};function Me(N){const T=N.g.length+1,M=[];for(let V=0;V<T;V++)M[V]=N.i(V)<<1|N.i(V-1)>>>31;return new d(M,N.h)}function we(N,T){const M=T>>5;T%=32;const V=N.g.length-M,I=[];for(let L=0;L<V;L++)I[L]=T>0?N.i(L+M)>>>T|N.i(L+M+1)<<32-T:N.i(L+M);return new d(I,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Jw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ho=d}).apply(typeof bx<"u"?bx:typeof self<"u"?self:typeof window<"u"?window:{});var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zw,uu,e_,Sh,bg,t_,s_,n_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ih=="object"&&ih];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ae=h[A];if(!(ae in k))break e;k=k[ae]}h=h[h.length-1],A=k[h],v=v(A),v!=A&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&k.push([A,v[A]]);return k}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,k){return h.call.apply(h.bind,arguments)}function y(h,v,k){return y=g,y.apply(null,arguments)}function x(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var A=k.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function _(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(A,ae,ve){for(var ct=Array(arguments.length-2),ms=2;ms<arguments.length;ms++)ct[ms-2]=arguments[ms];return v.prototype[ae].apply(A,ct)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const v=h.length;if(v>0){const k=Array(v);for(let A=0;A<v;A++)k[A]=h[A];return k}return[]}function G(h,v){for(let A=1;A<arguments.length;A++){const ae=arguments[A];var k=typeof ae;if(k=k!="object"?k:ae?Array.isArray(ae)?"array":k:"null",k=="array"||k=="object"&&typeof ae.length=="number"){k=h.length||0;const ve=ae.length||0;h.length=k+ve;for(let ct=0;ct<ve;ct++)h[k+ct]=ae[ct]}else h.push(ae)}}class B{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function D(h){d.setTimeout(()=>{throw h},0)}function te(){var h=N;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Y{constructor(){this.h=this.g=null}add(v,k){const A=Z.get();A.set(v,k),this.h?this.h.next=A:this.g=A,this.h=A}}var Z=new B(()=>new _e,h=>h.reset());class _e{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,we=!1,N=new Y,T=()=>{const h=Promise.resolve(void 0);Me=()=>{h.then(M)}};function M(){for(var h;h=te();){try{h.h.call(h.g)}catch(k){D(k)}var v=Z;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}we=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function R(h){return/^[\s\xa0]*$/.test(h)}function Ie(h,v){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}_(Ie,I),Ie.prototype.init=function(h,v){const k=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Ie.Z.h.call(this)},Ie.prototype.h=function(){Ie.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var mt="closure_listenable_"+(Math.random()*1e6|0),$=0;function ye(h,v,k,A,ae){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!A,this.ha=ae,this.key=++$,this.da=this.fa=!1}function Ue(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ye(h,v,k){for(const A in h)v.call(k,h[A],A,h)}function X(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function P(h){const v={};for(const k in h)v[k]=h[k];return v}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(h,v){let k,A;for(let ae=1;ae<arguments.length;ae++){A=arguments[ae];for(k in A)h[k]=A[k];for(let ve=0;ve<ne.length;ve++)k=ne[ve],Object.prototype.hasOwnProperty.call(A,k)&&(h[k]=A[k])}}function ze(h){this.src=h,this.g={},this.h=0}ze.prototype.add=function(h,v,k,A,ae){const ve=h.toString();h=this.g[ve],h||(h=this.g[ve]=[],this.h++);const ct=Pe(h,v,A,ae);return ct>-1?(v=h[ct],k||(v.fa=!1)):(v=new ye(v,this.src,ve,!!A,ae),v.fa=k,h.push(v)),v};function Be(h,v){const k=v.type;if(k in h.g){var A=h.g[k],ae=Array.prototype.indexOf.call(A,v,void 0),ve;(ve=ae>=0)&&Array.prototype.splice.call(A,ae,1),ve&&(Ue(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Pe(h,v,k,A){for(let ae=0;ae<h.length;++ae){const ve=h[ae];if(!ve.da&&ve.listener==v&&ve.capture==!!k&&ve.ha==A)return ae}return-1}var ut="closure_lm_"+(Math.random()*1e6|0),bt={};function ot(h,v,k,A,ae){if(Array.isArray(v)){for(let ve=0;ve<v.length;ve++)ot(h,v[ve],k,A,ae);return null}return k=Vt(k),h&&h[mt]?h.J(v,k,p(A)?!!A.capture:!1,ae):os(h,v,k,!1,A,ae)}function os(h,v,k,A,ae,ve){if(!v)throw Error("Invalid event type");const ct=p(ae)?!!ae.capture:!!ae;let ms=It(h);if(ms||(h[ut]=ms=new ze(h)),k=ms.add(v,k,A,ct,ve),k.proxy)return k;if(A=As(),k.proxy=A,A.src=h,A.listener=k,h.addEventListener)L||(ae=ct),ae===void 0&&(ae=!1),h.addEventListener(v.toString(),A,ae);else if(h.attachEvent)h.attachEvent(Pt(v.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return k}function As(){function h(k){return v.call(h.src,h.listener,k)}const v=qt;return h}function ts(h,v,k,A,ae){if(Array.isArray(v))for(var ve=0;ve<v.length;ve++)ts(h,v[ve],k,A,ae);else A=p(A)?!!A.capture:!!A,k=Vt(k),h&&h[mt]?(h=h.i,ve=String(v).toString(),ve in h.g&&(v=h.g[ve],k=Pe(v,k,A,ae),k>-1&&(Ue(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[ve],h.h--)))):h&&(h=It(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Pe(v,k,A,ae)),(k=h>-1?v[h]:null)&&Rt(k))}function Rt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[mt])Be(v.i,h);else{var k=h.type,A=h.proxy;v.removeEventListener?v.removeEventListener(k,A,h.capture):v.detachEvent?v.detachEvent(Pt(k),A):v.addListener&&v.removeListener&&v.removeListener(A),(k=It(v))?(Be(k,h),k.h==0&&(k.src=null,v[ut]=null)):Ue(h)}}}function Pt(h){return h in bt?bt[h]:bt[h]="on"+h}function qt(h,v){if(h.da)h=!0;else{v=new Ie(v,this);const k=h.listener,A=h.ha||h.src;h.fa&&Rt(h),h=k.call(A,v)}return h}function It(h){return h=h[ut],h instanceof ze?h:null}var Ms="__closure_events_fn_"+(Math.random()*1e9>>>0);function Vt(h){return typeof h=="function"?h:(h[Ms]||(h[Ms]=function(v){return h.handleEvent(v)}),h[Ms])}function Ot(){V.call(this),this.i=new ze(this),this.M=this,this.G=null}_(Ot,V),Ot.prototype[mt]=!0,Ot.prototype.removeEventListener=function(h,v,k,A){ts(this,h,v,k,A)};function se(h,v){var k,A=h.G;if(A)for(k=[];A;A=A.G)k.push(A);if(h=h.M,A=v.type||v,typeof v=="string")v=new I(v,h);else if(v instanceof I)v.target=v.target||h;else{var ae=v;v=new I(A,h),De(v,ae)}ae=!0;let ve,ct;if(k)for(ct=k.length-1;ct>=0;ct--)ve=v.g=k[ct],ae=Ht(ve,A,!0,v)&&ae;if(ve=v.g=h,ae=Ht(ve,A,!0,v)&&ae,ae=Ht(ve,A,!1,v)&&ae,k)for(ct=0;ct<k.length;ct++)ve=v.g=k[ct],ae=Ht(ve,A,!1,v)&&ae}Ot.prototype.N=function(){if(Ot.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let A=0;A<k.length;A++)Ue(k[A]);delete h.g[v],h.h--}}this.G=null},Ot.prototype.J=function(h,v,k,A){return this.i.add(String(h),v,!1,k,A)},Ot.prototype.K=function(h,v,k,A){return this.i.add(String(h),v,!0,k,A)};function Ht(h,v,k,A){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let ae=!0;for(let ve=0;ve<v.length;++ve){const ct=v[ve];if(ct&&!ct.da&&ct.capture==k){const ms=ct.listener,Cn=ct.ha||ct.src;ct.fa&&Be(h.i,ct),ae=ms.call(Cn,A)!==!1&&ae}}return ae&&!A.defaultPrevented}function Dt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function zt(h){h.g=Dt(()=>{h.g=null,h.i&&(h.i=!1,zt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class wt extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:zt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gt(h){V.call(this),this.h=h,this.g={}}_(gt,V);var Qt=[];function rs(h){Ye(h.g,function(v,k){this.g.hasOwnProperty(k)&&Rt(v)},h),h.g={}}gt.prototype.N=function(){gt.Z.N.call(this),rs(this)},gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vs=d.JSON.stringify,tn=d.JSON.parse,Ys=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Qs(){}function ls(){}var xs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ge(){I.call(this,"d")}_(ge,I);function Le(){I.call(this,"c")}_(Le,I);var je={},st=null;function We(){return st=st||new Ot}je.Ia="serverreachability";function rt(h){I.call(this,je.Ia,h)}_(rt,I);function pt(h){const v=We();se(v,new rt(v))}je.STAT_EVENT="statevent";function J(h,v){I.call(this,je.STAT_EVENT,h),this.stat=v}_(J,I);function re(h){const v=We();se(v,new J(v,h))}je.Ja="timingevent";function Ze(h,v){I.call(this,je.Ja,h),this.size=v}_(Ze,I);function Et(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function tt(){this.g=!0}tt.prototype.ua=function(){this.g=!1};function Nt(h,v,k,A,ae,ve){h.info(function(){if(h.g)if(ve){var ct="",ms=ve.split("&");for(let qs=0;qs<ms.length;qs++){var Cn=ms[qs].split("=");if(Cn.length>1){const fn=Cn[0];Cn=Cn[1];const ea=fn.split("_");ct=ea.length>=2&&ea[1]=="type"?ct+(fn+"="+Cn+"&"):ct+(fn+"=redacted&")}}}else ct=null;else ct=ve;return"XMLHTTP REQ ("+A+") [attempt "+ae+"]: "+v+`
`+k+`
`+ct})}function Q(h,v,k,A,ae,ve,ct){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ae+"]: "+v+`
`+k+`
`+ve+" "+ct})}function Ae(h,v,k,A){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+dt(h,k)+(A?" "+A:"")})}function Qe(h,v){h.info(function(){return"TIMEOUT: "+v})}tt.prototype.info=function(){};function dt(h,v){if(!h.g)return v;if(!v)return null;try{const ve=JSON.parse(v);if(ve){for(h=0;h<ve.length;h++)if(Array.isArray(ve[h])){var k=ve[h];if(!(k.length<2)){var A=k[1];if(Array.isArray(A)&&!(A.length<1)){var ae=A[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let ct=1;ct<A.length;ct++)A[ct]=""}}}}return vs(ve)}catch{return v}}var at={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ss={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ns;function F(){}_(F,Qs),F.prototype.g=function(){return new XMLHttpRequest},ns=new F;function pe(h){return encodeURIComponent(String(h))}function Ne(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Ee(h,v,k,A){this.j=h,this.i=v,this.l=k,this.S=A||1,this.V=new gt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ce}function Ce(){this.i=null,this.g="",this.h=!1}var xt={},At={};function ht(h,v,k){h.M=1,h.A=_t(C(v)),h.u=k,h.R=!0,$t(h,null)}function $t(h,v){h.F=Date.now(),dn(h),h.B=C(h.A);var k=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Da(k.i,"t",A),h.C=0,k=h.j.L,h.h=new Ce,h.g=Rr(h.j,k?v:null,!h.u),h.P>0&&(h.O=new wt(y(h.Y,h,h.g),h.P)),v=h.V,k=h.g,A=h.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(Qt[0]=ae.toString()),ae=Qt);for(let ve=0;ve<ae.length;ve++){const ct=ot(k,ae[ve],A||v.handleEvent,!1,v.h||v);if(!ct)break;v.g[ct.key]=ct}v=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),pt(),Nt(h.i,h.v,h.B,h.l,h.S,h.u)}Ee.prototype.ba=function(h){h=h.target;const v=this.O;v&&Te(h)==3?v.j():this.Y(h)},Ee.prototype.Y=function(h){try{if(h==this.g)e:{const ms=Te(this.g),Cn=this.g.ya(),qs=this.g.ca();if(!(ms<3)&&(ms!=3||this.g&&(this.h.h||this.g.la()||Xe(this.g)))){this.K||ms!=4||Cn==7||(Cn==8||qs<=0?pt(3):pt(2)),hn(this);var v=this.g.ca();this.X=v;var k=Bt(this);if(this.o=v==200,Q(this.i,this.v,this.B,this.l,this.S,ms,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ae=this.g;if((A=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(A)){var ve=A;break t}}ve=null}if(h=ve)Ae(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,K(this,h);else{this.o=!1,this.m=3,re(12),ys(this),sn(this);break e}}if(this.R){h=!0;let fn;for(;!this.K&&this.C<k.length;)if(fn=yn(this,k),fn==At){ms==4&&(this.m=4,re(14),h=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==xt){this.m=4,re(15),Ae(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Ae(this.i,this.l,fn,null),K(this,fn);if($s(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ms!=4||k.length!=0||this.h.h||(this.m=1,re(16),h=!1),this.o=this.o&&h,!h)Ae(this.i,this.l,k,"[Invalid Chunked Response]"),ys(this),sn(this);else if(k.length>0&&!this.W){this.W=!0;var ct=this.j;ct.g==this&&ct.aa&&!ct.P&&(ct.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),wn(ct),ct.P=!0,re(11))}}else Ae(this.i,this.l,k,null),K(this,k);ms==4&&ys(this),this.o&&!this.K&&(ms==4?Nr(this.j,this):(this.o=!1,dn(this)))}else He(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,re(12)):(this.m=0,re(13)),ys(this),sn(this)}}}catch{}};function Bt(h){if(!$s(h))return h.g.la();const v=Xe(h.g);if(v==="")return"";let k="";const A=v.length,ae=Te(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ys(h),sn(h),"";h.h.i=new d.TextDecoder}for(let ve=0;ve<A;ve++)h.h.h=!0,k+=h.h.i.decode(v[ve],{stream:!(ae&&ve==A-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function $s(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function yn(h,v){var k=h.C,A=v.indexOf(`
`,k);return A==-1?At:(k=Number(v.substring(k,A)),isNaN(k)?xt:(A+=1,A+k>v.length?At:(v=v.slice(A,A+k),h.C=A+k,v)))}Ee.prototype.cancel=function(){this.K=!0,ys(this)};function dn(h){h.T=Date.now()+h.H,In(h,h.H)}function In(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Et(y(h.aa,h),v)}function hn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Ee.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Qe(this.i,this.B),this.M!=2&&(pt(),re(17)),ys(this),this.m=2,sn(this)):In(this,this.T-h)};function sn(h){h.j.I==0||h.K||Nr(h.j,h)}function ys(h){hn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,rs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function K(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||Tt(k.h,h))){if(!h.L&&Tt(k.h,h)&&k.I==3){try{var A=k.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ae=A;if(ae[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)Jn(k),jt(k);else break e;Nn(k),re(18)}}else k.xa=ae[1],0<k.xa-k.K&&ae[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Et(y(k.Va,k),6e3));Ge(k.h)<=1&&k.ta&&(k.ta=void 0)}else _n(k,11)}else if((h.L||k.g==h)&&Jn(k),!R(v))for(ae=k.Ba.g.parse(v),v=0;v<ae.length;v++){let qs=ae[v];const fn=qs[0];if(!(fn<=k.K))if(k.K=fn,qs=qs[1],k.I==2)if(qs[0]=="c"){k.M=qs[1],k.ba=qs[2];const ea=qs[3];ea!=null&&(k.ka=ea,k.j.info("VER="+k.ka));const La=qs[4];La!=null&&(k.za=La,k.j.info("SVER="+k.za));const ga=qs[5];ga!=null&&typeof ga=="number"&&ga>0&&(A=1.5*ga,k.O=A,k.j.info("backChannelRequestTimeoutMs_="+A)),A=k;const ya=h.g;if(ya){const Eo=ya.g?ya.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Eo){var ve=A.h;ve.g||Eo.indexOf("spdy")==-1&&Eo.indexOf("quic")==-1&&Eo.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(Xt(ve,ve.h),ve.h=null))}if(A.G){const ul=ya.g?ya.g.getResponseHeader("X-HTTP-Session-Id"):null;ul&&(A.wa=ul,it(A.J,A.G,ul))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),A=k;var ct=h;if(A.na=Cr(A,A.L?A.ba:null,A.W),ct.L){Lt(A.h,ct);var ms=ct,Cn=A.O;Cn&&(ms.H=Cn),ms.D&&(hn(ms),dn(ms)),A.g=ct}else an(A);k.i.length>0&&as(k)}else qs[0]!="stop"&&qs[0]!="close"||_n(k,7);else k.I==3&&(qs[0]=="stop"||qs[0]=="close"?qs[0]=="stop"?_n(k,7):lt(k):qs[0]!="noop"&&k.l&&k.l.qa(qs),k.A=0)}}pt(4)}catch{}}var he=class{constructor(h,v){this.g=h,this.map=v}};function ie(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function be(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ge(h){return h.h?1:h.g?h.g.size:0}function Tt(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Xt(h,v){h.g?h.g.add(v):h.h=v}function Lt(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ie.prototype.cancel=function(){if(this.i=Wt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Wt(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return O(h.i)}var ps=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vs(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const A=h[k].indexOf("=");let ae,ve=null;A>=0?(ae=h[k].substring(0,A),ve=h[k].substring(A+1)):ae=h[k],v(ae,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function Is(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Is?(this.l=h.l,q(this,h.j),this.o=h.o,this.g=h.g,de(this,h.u),this.h=h.h,ke(this,Ii(h.i)),this.m=h.m):h&&(v=String(h).match(ps))?(this.l=!1,q(this,v[1]||"",!0),this.o=yt(v[2]||""),this.g=yt(v[3]||"",!0),de(this,v[4]),this.h=yt(v[5]||"",!0),ke(this,v[6]||"",!0),this.m=yt(v[7]||"")):(this.l=!1,this.i=new Vr(null,this.l))}Is.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(_s(v,vn,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(_s(v,vn,!0),"@"),h.push(pe(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(_s(k,k.charAt(0)=="/"?yr:gr,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",_s(k,ma)),h.join("")},Is.prototype.resolve=function(h){const v=C(this);let k=!!h.j;k?q(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var A=h.h;if(k)de(v,h.u);else if(k=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ae=v.h.lastIndexOf("/");ae!=-1&&(A=v.h.slice(0,ae+1)+A)}if(ae=A,ae==".."||ae==".")A="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){A=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const ve=[];for(let ct=0;ct<ae.length;){const ms=ae[ct++];ms=="."?A&&ct==ae.length&&ve.push(""):ms==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),A&&ct==ae.length&&ve.push("")):(ve.push(ms),A=!0)}A=ve.join("/")}else A=ae}return k?v.h=A:k=h.i.toString()!=="",k?ke(v,Ii(h.i)):k=!!h.m,k&&(v.m=h.m),v};function C(h){return new Is(h)}function q(h,v,k){h.j=k?yt(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function de(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function ke(h,v,k){v instanceof Vr?(h.i=v,Ur(h.i,h.l)):(k||(v=_s(v,$n)),h.i=new Vr(v,h.l))}function it(h,v,k){h.i.set(v,k)}function _t(h){return it(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function yt(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function _s(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,Gt),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Gt(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var vn=/[#\/\?@]/g,gr=/[#\?:]/g,yr=/[#\?]/g,$n=/[#\?@]/g,ma=/#/g;function Vr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Wn(h){h.g||(h.g=new Map,h.h=0,h.i&&Vs(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}n=Vr.prototype,n.add=function(h,v){Wn(this),this.i=null,h=Zr(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function Mi(h,v){Wn(h),v=Zr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function ei(h,v){return Wn(h),v=Zr(h,v),h.g.has(v)}n.forEach=function(h,v){Wn(this),this.g.forEach(function(k,A){k.forEach(function(ae){h.call(v,ae,A,this)},this)},this)};function Er(h,v){Wn(h);let k=[];if(typeof v=="string")ei(h,v)&&(k=k.concat(h.g.get(Zr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}n.set=function(h,v){return Wn(this),this.i=null,h=Zr(this,h),ei(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=Er(this,h),h.length>0?String(h[0]):v):v};function Da(h,v,k){Mi(h,v),k.length>0&&(h.i=null,h.g.set(Zr(h,v),O(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var k=v[A];const ae=pe(k);k=Er(this,k);for(let ve=0;ve<k.length;ve++){let ct=ae;k[ve]!==""&&(ct+="="+pe(k[ve])),h.push(ct)}}return this.i=h.join("&")};function Ii(h){const v=new Vr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Zr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Ur(h,v){v&&!h.j&&(Wn(h),h.i=null,h.g.forEach(function(k,A){const ae=A.toLowerCase();A!=ae&&(Mi(this,A),Da(this,ae,k))},h)),h.j=v}function Gn(h,v){const k=new tt;if(d.Image){const A=new Image;A.onload=x(xn,k,"TestLoadImage: loaded",!0,v,A),A.onerror=x(xn,k,"TestLoadImage: error",!1,v,A),A.onabort=x(xn,k,"TestLoadImage: abort",!1,v,A),A.ontimeout=x(xn,k,"TestLoadImage: timeout",!1,v,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else v(!1)}function Kn(h,v){const k=new tt,A=new AbortController,ae=setTimeout(()=>{A.abort(),xn(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:A.signal}).then(ve=>{clearTimeout(ae),ve.ok?xn(k,"TestPingServer: ok",!0,v):xn(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ae),xn(k,"TestPingServer: error",!1,v)})}function xn(h,v,k,A,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),A(k)}catch{}}function Fr(){this.g=new Ys}function br(h){this.i=h.Sb||null,this.h=h.ab||!1}_(br,Qs),br.prototype.g=function(){return new fa(this.i,this.h)};function fa(h,v){Ot.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(fa,Ot),n=fa.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,le(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,z(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,le(this)),this.g&&(this.readyState=3,le(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;lr(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function lr(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?z(this):le(this),this.readyState==3&&lr(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,z(this))},n.Na=function(h){this.g&&(this.response=h,z(this))},n.ga=function(){this.g&&z(this)};function z(h){h.readyState=4,h.l=null,h.j=null,h.B=null,le(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function le(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ue(h){let v="";return Ye(h,function(k,A){v+=A,v+=":",v+=k,v+=`\r
`}),v}function Fe(h,v,k){e:{for(A in k){var A=!1;break e}A=!0}A||(k=ue(k),typeof h=="string"?k!=null&&pe(k):it(h,v,k))}function Se(h){Ot.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(Se,Ot);var et=/^https?$/i,vt=["POST","PUT"];n=Se.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,k,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ns.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(ve){Kt(this,ve);return}if(h=k||"",k=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ae in A)k.set(ae,A[ae]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ve of A.keys())k.set(ve,A.get(ve));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(k.keys()).find(ve=>ve.toLowerCase()=="content-type"),ae=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(vt,v,void 0)>=0)||A||ae||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,ct]of k)this.g.setRequestHeader(ve,ct);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ve){Kt(this,ve)}};function Kt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,cs(h),U(h)}function cs(h){h.A||(h.A=!0,se(h,"complete"),se(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,se(this,"complete"),se(this,"abort"),U(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),U(this,!0)),Se.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?S(this):this.Xa())},n.Xa=function(){S(this)};function S(h){if(h.h&&typeof u<"u"){if(h.v&&Te(h)==4)setTimeout(h.Ca.bind(h),0);else if(se(h,"readystatechange"),Te(h)==4){h.h=!1;try{const ve=h.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var A;if(A=ve===0){let ct=String(h.D).match(ps)[1]||null;!ct&&d.self&&d.self.location&&(ct=d.self.location.protocol.slice(0,-1)),A=!et.test(ct?ct.toLowerCase():"")}k=A}if(k)se(h,"complete"),se(h,"success");else{h.o=6;try{var ae=Te(h)>2?h.g.statusText:""}catch{ae=""}h.l=ae+" ["+h.ca()+"]",cs(h)}}finally{U(h)}}}}function U(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||se(h,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Te(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Te(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),tn(v)}};function Xe(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function He(h){const v={};h=(h.g&&Te(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(R(h[A]))continue;var k=Ne(h[A]);const ae=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ve=v[ae]||[];v[ae]=ve,ve.push(k)}X(v,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function nt(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function Ke(h){this.za=0,this.i=[],this.j=new tt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=nt("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=nt("baseRetryDelayMs",5e3,h),this.Za=nt("retryDelaySeedMs",1e4,h),this.Ta=nt("forwardChannelMaxRetries",2,h),this.va=nt("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ie(h&&h.concurrentRequestLimit),this.Ba=new Fr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ke.prototype,n.ka=8,n.I=1,n.connect=function(h,v,k,A){re(0),this.W=h,this.H=v||{},k&&A!==void 0&&(this.H.OSID=k,this.H.OAID=A),this.F=this.X,this.J=Cr(this,null,this.W),as(this)};function lt(h){if(us(h),h.I==3){var v=h.V++,k=C(h.J);if(it(k,"SID",h.M),it(k,"RID",v),it(k,"TYPE","terminate"),mn(h,k),v=new Ee(h,h.j,v),v.M=2,v.A=_t(C(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=Rr(v.j,null),v.g.ea(v.A)),v.F=Date.now(),dn(v)}Fn(h)}function jt(h){h.g&&(wn(h),h.g.cancel(),h.g=null)}function us(h){jt(h),h.v&&(d.clearTimeout(h.v),h.v=null),Jn(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function as(h){if(!be(h.h)&&!h.m){h.m=!0;var v=h.Ea;Me||T(),we||(Me(),we=!0),N.add(v,h),h.D=0}}function ws(h,v){return Ge(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Et(y(h.Ea,h,v),vr(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ae=new Ee(this,this.j,h);let ve=this.o;if(this.U&&(ve?(ve=P(ve),De(ve,this.U)):ve=this.U),this.u!==null||this.R||(ae.J=ve,ve=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var A=this.i[k];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=zs(this,ae,v),k=C(this.J),it(k,"RID",h),it(k,"CVER",22),this.G&&it(k,"X-HTTP-Session-Id",this.G),mn(this,k),ve&&(this.R?v="headers="+pe(ue(ve))+"&"+v:this.u&&Fe(k,this.u,ve)),Xt(this.h,ae),this.Ra&&it(k,"TYPE","init"),this.S?(it(k,"$req",v),it(k,"SID","null"),ae.U=!0,ht(ae,k,null)):ht(ae,k,v),this.I=2}}else this.I==3&&(h?ln(this,h):this.i.length==0||be(this.h)||ln(this))};function ln(h,v){var k;v?k=v.l:k=h.V++;const A=C(h.J);it(A,"SID",h.M),it(A,"RID",k),it(A,"AID",h.K),mn(h,A),h.u&&h.o&&Fe(A,h.u,h.o),k=new Ee(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=zs(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Xt(h.h,k),ht(k,A,v)}function mn(h,v){h.H&&Ye(h.H,function(k,A){it(v,A,k)}),h.l&&Ye({},function(k,A){it(v,A,k)})}function zs(h,v,k){k=Math.min(h.i.length,k);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var ae=h.i;let ms=-1;for(;;){const Cn=["count="+k];ms==-1?k>0?(ms=ae[0].g,Cn.push("ofs="+ms)):ms=0:Cn.push("ofs="+ms);let qs=!0;for(let fn=0;fn<k;fn++){var ve=ae[fn].g;const ea=ae[fn].map;if(ve-=ms,ve<0)ms=Math.max(0,ae[fn].g-100),qs=!1;else try{ve="req"+ve+"_"||"";try{var ct=ea instanceof Map?ea:Object.entries(ea);for(const[La,ga]of ct){let ya=ga;p(ga)&&(ya=vs(ga)),Cn.push(ve+La+"="+encodeURIComponent(ya))}}catch(La){throw Cn.push(ve+"type="+encodeURIComponent("_badmap")),La}}catch{A&&A(ea)}}if(qs){ct=Cn.join("&");break e}}ct=void 0}return h=h.i.splice(0,k),v.G=h,ct}function an(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;Me||T(),we||(Me(),we=!0),N.add(v,h),h.A=0}}function Nn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Et(y(h.Da,h),vr(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Xn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Et(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,re(10),jt(this),Xn(this))};function wn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Xn(h){h.g=new Ee(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=C(h.na);it(v,"RID","rpc"),it(v,"SID",h.M),it(v,"AID",h.K),it(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&it(v,"TO",h.ia),it(v,"TYPE","xmlhttp"),mn(h,v),h.u&&h.o&&Fe(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=_t(C(v)),k.u=null,k.R=!0,$t(k,h)}n.Va=function(){this.C!=null&&(this.C=null,jt(this),Nn(this),re(19))};function Jn(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Nr(h,v){var k=null;if(h.g==v){Jn(h),wn(h),h.g=null;var A=2}else if(Tt(h.h,v))k=v.G,Lt(h.h,v),A=1;else return;if(h.I!=0){if(v.o)if(A==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var ae=h.D;A=We(),se(A,new Ze(A,k)),as(h)}else an(h);else if(ae=v.m,ae==3||ae==0&&v.X>0||!(A==1&&ws(h,v)||A==2&&Nn(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),ae){case 1:_n(h,5);break;case 4:_n(h,10);break;case 3:_n(h,6);break;default:_n(h,2)}}}function vr(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function _n(h,v){if(h.j.info("Error code "+v),v==2){var k=y(h.bb,h),A=h.Ua;const ae=!A;A=new Is(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||q(A,"https"),_t(A),ae?Gn(A.toString(),k):Kn(A.toString(),k)}else re(2);h.I=0,h.l&&h.l.pa(v),Fn(h),us(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),re(2)):(this.j.info("Failed to ping google.com"),re(1))};function Fn(h){if(h.I=0,h.ja=[],h.l){const v=Wt(h.h);(v.length!=0||h.i.length!=0)&&(G(h.ja,v),G(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function Cr(h,v,k){var A=k instanceof Is?C(k):new Is(k);if(A.g!="")v&&(A.g=v+"."+A.g),de(A,A.u);else{var ae=d.location;A=ae.protocol,v=v?v+"."+ae.hostname:ae.hostname,ae=+ae.port;const ve=new Is(null);A&&q(ve,A),v&&(ve.g=v),ae&&de(ve,ae),k&&(ve.h=k),A=ve}return k=h.G,v=h.wa,k&&v&&it(A,k,v),it(A,"VER",h.ka),mn(h,A),A}function Rr(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Se(new br({ab:k})):new Se(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function So(){}n=So.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Pa(){}Pa.prototype.g=function(h,v){return new Zn(h,v)};function Zn(h,v){Ot.call(this),this.g=new Ke(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!R(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new cr(this)}_(Zn,Ot),Zn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){lt(this.g)},Zn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=vs(h),h=k);v.i.push(new he(v.Ya++,h)),v.I==3&&as(v)},Zn.prototype.N=function(){this.g.l=null,delete this.j,lt(this.g),delete this.g,Zn.Z.N.call(this)};function ti(h){ge.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}_(ti,ge);function pa(){Le.call(this),this.status=1}_(pa,Le);function cr(h){this.g=h}_(cr,So),cr.prototype.ra=function(){se(this.g,"a")},cr.prototype.qa=function(h){se(this.g,new ti(h))},cr.prototype.pa=function(h){se(this.g,new pa)},cr.prototype.oa=function(){se(this.g,"b")},Pa.prototype.createWebChannel=Pa.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,n_=function(){return new Pa},s_=function(){return We()},t_=je,bg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},at.NO_ERROR=0,at.TIMEOUT=8,at.HTTP_ERROR=6,Sh=at,ss.COMPLETE="complete",e_=ss,ls.EventType=xs,xs.OPEN="a",xs.CLOSE="b",xs.ERROR="c",xs.MESSAGE="d",Ot.prototype.listen=Ot.prototype.J,uu=ls,Se.prototype.listenOnce=Se.prototype.K,Se.prototype.getLastError=Se.prototype.Ha,Se.prototype.getLastErrorCode=Se.prototype.ya,Se.prototype.getStatus=Se.prototype.ca,Se.prototype.getResponseJson=Se.prototype.La,Se.prototype.getResponseText=Se.prototype.la,Se.prototype.send=Se.prototype.ea,Se.prototype.setWithCredentials=Se.prototype.Fa,Zw=Se}).apply(typeof ih<"u"?ih:typeof self<"u"?self:typeof window<"u"?window:{});class hr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hr.UNAUTHENTICATED=new hr(null),hr.GOOGLE_CREDENTIALS=new hr("google-credentials-uid"),hr.FIRST_PARTY=new hr("first-party-uid"),hr.MOCK_USER=new hr("mock-user");let dc="12.8.0";function gR(n){dc=n}const nl=new Kg("@firebase/firestore");function $l(){return nl.logLevel}function kt(n,...e){if(nl.logLevel<=Es.DEBUG){const t=e.map(oy);nl.debug(`Firestore (${dc}): ${n}`,...t)}}function Ei(n,...e){if(nl.logLevel<=Es.ERROR){const t=e.map(oy);nl.error(`Firestore (${dc}): ${n}`,...t)}}function tc(n,...e){if(nl.logLevel<=Es.WARN){const t=e.map(oy);nl.warn(`Firestore (${dc}): ${n}`,...t)}}function oy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function es(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,r_(n,i,t)}function r_(n,e,t){let i=`FIRESTORE (${dc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ei(i),new Error(i)}function Ws(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||r_(e,l,i)}function hs(n,e){return n}const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ft extends Za{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ki{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class a_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(hr.UNAUTHENTICATED)))}shutdown(){}}class bR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vR{constructor(e){this.t=e,this.currentUser=hr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ws(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new ki;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ki,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{kt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(kt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ki)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(kt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ws(typeof i.accessToken=="string",31837,{l:i}),new a_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ws(e===null||typeof e=="string",2055,{h:e}),new hr(e)}}class xR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=hr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class wR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new xR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(hr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _R{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ws(this.o===void 0,3512);const i=u=>{u.error!=null&&kt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,kt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{kt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):kt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ws(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function kR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=kR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Cs(n,e){return n<e?-1:n>e?1:0}function vg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Bp(l)===Bp(u)?Cs(l,u):Bp(l)?1:-1}return Cs(n.length,e.length)}const jR=55296,TR=57343;function Bp(n){const e=n.charCodeAt(0);return e>=jR&&e<=TR}function sc(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const xx="__name__";class qa{constructor(e,t,i){t===void 0?t=0:t>e.length&&es(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&es(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=qa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Cs(e.length,t.length)}static compareSegments(e,t){const i=qa.isNumericId(e),l=qa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?qa.extractNumericId(e).compare(qa.extractNumericId(t)):vg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ho.fromString(e.substring(4,e.length-2))}}class on extends qa{construct(e,t,i){return new on(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ft(Oe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new on(t)}static emptyPath(){return new on([])}}const SR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ar extends qa{construct(e,t,i){return new ar(e,t,i)}static isValidIdentifier(e){return SR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ar.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xx}static keyField(){return new ar([xx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new ft(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new ft(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ft(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new ft(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ar(t)}static emptyPath(){return new ar([])}}class Ft{constructor(e){this.path=e}static fromPath(e){return new Ft(on.fromString(e))}static fromName(e){return new Ft(on.fromString(e).popFirst(5))}static empty(){return new Ft(on.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&on.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return on.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ft(new on(e.slice()))}}function i_(n,e,t){if(!t)throw new ft(Oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ER(n,e,t,i){if(e===!0&&i===!0)throw new ft(Oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wx(n){if(!Ft.isDocumentKey(n))throw new ft(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _x(n){if(Ft.isDocumentKey(n))throw new ft(Oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function o_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":es(12329,{type:typeof n})}function jr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ft(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lm(n);throw new ft(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function NR(n,e){if(e<=0)throw new ft(Oe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Un(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hu(n,e){if(!o_(n))throw new ft(Oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new ft(Oe.INVALID_ARGUMENT,t);return!0}const kx=-62135596800,jx=1e6;class Ct{static now(){return Ct.fromMillis(Date.now())}static fromDate(e){return Ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*jx);return new Ct(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ft(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ft(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kx)throw new ft(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ft(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jx}_compareTo(e){return this.seconds===e.seconds?Cs(this.nanoseconds,e.nanoseconds):Cs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ct._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hu(e,Ct._jsonSchema))return new Ct(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ct._jsonSchemaVersion="firestore/timestamp/1.0",Ct._jsonSchema={type:Un("string",Ct._jsonSchemaVersion),seconds:Un("number"),nanoseconds:Un("number")};class is{static fromTimestamp(e){return new is(e)}static min(){return new is(new Ct(0,0))}static max(){return new is(new Ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Tu=-1;function CR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=is.fromTimestamp(i===1e9?new Ct(t+1,0):new Ct(t,i));return new go(l,Ft.empty(),e)}function RR(n){return new go(n.readTime,n.key,Tu)}class go{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new go(is.min(),Ft.empty(),Tu)}static max(){return new go(is.max(),Ft.empty(),Tu)}}function AR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ft.comparator(n.documentKey,e.documentKey),t!==0?t:Cs(n.largestBatchId,e.largestBatchId))}const MR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function hc(n){if(n.code!==Oe.FAILED_PRECONDITION||n.message!==MR)throw n;kt("LocalStore","Unexpectedly lost primary lease")}class $e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&es(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $e(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof $e?t:$e.resolve(t)}catch(t){return $e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):$e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):$e.reject(t)}static resolve(e){return new $e(((t,i)=>{t(e)}))}static reject(e){return new $e(((t,i)=>{i(e)}))}static waitFor(e){return new $e(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=$e.resolve(!1);for(const i of e)t=t.next((l=>l?$e.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new $e(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new $e(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function DR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function mc(n){return n.name==="IndexedDbTransactionError"}class cm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cm.ce=-1;const cy=-1;function um(n){return n==null}function qh(n){return n===0&&1/n==-1/0}function PR(n){return typeof n=="number"&&Number.isInteger(n)&&!qh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const l_="";function LR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tx(e)),e=OR(n.get(t),e);return Tx(e)}function OR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case l_:t+="";break;default:t+=u}}return t}function Tx(n){return n+l_+""}function Sx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function c_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class bn{constructor(e,t){this.comparator=e,this.root=t||rr.EMPTY}insert(e,t){return new bn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rr.BLACK,null,null))}remove(e){return new bn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??rr.RED,this.left=l??rr.EMPTY,this.right=u??rr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new rr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return rr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return rr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw es(43730,{key:this.key,value:this.value});if(this.right.isRed())throw es(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw es(27949);return e+(this.isRed()?0:1)}}rr.EMPTY=null,rr.RED=!0,rr.BLACK=!1;rr.EMPTY=new class{constructor(){this.size=0}get key(){throw es(57766)}get value(){throw es(16141)}get color(){throw es(16727)}get left(){throw es(29726)}get right(){throw es(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new rr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hn{constructor(e){this.comparator=e,this.data=new bn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ex(this.data.getIterator())}getIteratorFrom(e){return new Ex(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Hn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Hn(this.comparator);return t.data=e,t}}class Ex{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Qr{constructor(e){this.fields=e,e.sort(ar.comparator)}static empty(){return new Qr([])}unionWith(e){let t=new Hn(ar.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Qr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class u_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ir{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new u_("Invalid base64 string: "+u):u}})(e);return new ir(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new ir(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Cs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ir.EMPTY_BYTE_STRING=new ir("");const BR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(n){if(Ws(!!n,39018),typeof n=="string"){let e=0;const t=BR.exec(n);if(Ws(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mn(n.seconds),nanos:Mn(n.nanos)}}function Mn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bo(n){return typeof n=="string"?ir.fromBase64String(n):ir.fromUint8Array(n)}const d_="server_timestamp",h_="__type__",m_="__previous_value__",f_="__local_write_time__";function uy(n){return(n?.mapValue?.fields||{})[h_]?.stringValue===d_}function dm(n){const e=n.mapValue.fields[m_];return uy(e)?dm(e):e}function Su(n){const e=yo(n.mapValue.fields[f_].timestampValue);return new Ct(e.seconds,e.nanos)}class VR{constructor(e,t,i,l,u,d,p,g,y,x,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=_}}const Hh="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}function UR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ft(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(n.options.projectId,e)}const p_="__type__",FR="__max__",lh={mapValue:{}},g_="__vector__",$h="value";function vo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uy(n)?4:qR(n)?9007199254740991:zR(n)?10:11:es(28295,{value:n})}function Xa(n,e){if(n===e)return!0;const t=vo(n);if(t!==vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Su(n).isEqual(Su(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=yo(l.timestampValue),p=yo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return bo(l.bytesValue).isEqual(bo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Mn(l.geoPointValue.latitude)===Mn(u.geoPointValue.latitude)&&Mn(l.geoPointValue.longitude)===Mn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Mn(l.integerValue)===Mn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Mn(l.doubleValue),p=Mn(u.doubleValue);return d===p?qh(d)===qh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return sc(n.arrayValue.values||[],e.arrayValue.values||[],Xa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Sx(d)!==Sx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Xa(d[g],p[g])))return!1;return!0})(n,e);default:return es(52216,{left:n})}}function Nu(n,e){return(n.values||[]).find((t=>Xa(t,e)))!==void 0}function nc(n,e){if(n===e)return 0;const t=vo(n),i=vo(e);if(t!==i)return Cs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Cs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Mn(u.integerValue||u.doubleValue),g=Mn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Nx(n.timestampValue,e.timestampValue);case 4:return Nx(Su(n),Su(e));case 5:return vg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=bo(u),g=bo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=Cs(p[y],g[y]);if(x!==0)return x}return Cs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=Cs(Mn(u.latitude),Mn(d.latitude));return p!==0?p:Cs(Mn(u.longitude),Mn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Cx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[$h]?.arrayValue,x=g[$h]?.arrayValue,_=Cs(y?.values?.length||0,x?.values?.length||0);return _!==0?_:Cx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===lh.mapValue&&d===lh.mapValue)return 0;if(u===lh.mapValue)return 1;if(d===lh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let _=0;_<g.length&&_<x.length;++_){const j=vg(g[_],x[_]);if(j!==0)return j;const O=nc(p[g[_]],y[x[_]]);if(O!==0)return O}return Cs(g.length,x.length)})(n.mapValue,e.mapValue);default:throw es(23264,{he:t})}}function Nx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Cs(n,e);const t=yo(n),i=yo(e),l=Cs(t.seconds,i.seconds);return l!==0?l:Cs(t.nanos,i.nanos)}function Cx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=nc(t[l],i[l]);if(u)return u}return Cs(t.length,i.length)}function rc(n){return xg(n)}function xg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=yo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return bo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=xg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${xg(t.fields[d])}`;return l+"}"})(n.mapValue):es(61005,{value:n})}function Eh(n){switch(vo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dm(n);return e?16+Eh(e):16;case 5:return 2*n.stringValue.length;case 6:return bo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Eh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return jo(i.fields,((u,d)=>{l+=u.length+Eh(d)})),l})(n.mapValue);default:throw es(13486,{value:n})}}function Rx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wg(n){return!!n&&"integerValue"in n}function dy(n){return!!n&&"arrayValue"in n}function Ax(n){return!!n&&"nullValue"in n}function Mx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Nh(n){return!!n&&"mapValue"in n}function zR(n){return(n?.mapValue?.fields||{})[p_]?.stringValue===g_}function gu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return jo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gu(n.arrayValue.values[t]);return e}return{...n}}function qR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===FR}class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gu(t)}setAll(e){let t=ar.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=gu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Nh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){jo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Or(gu(this.value))}}function y_(n){const e=[];return jo(n.fields,((t,i)=>{const l=new ar([t]);if(Nh(i)){const u=y_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Qr(e)}class mr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new mr(e,0,is.min(),is.min(),is.min(),Or.empty(),0)}static newFoundDocument(e,t,i,l){return new mr(e,1,t,is.min(),i,l,0)}static newNoDocument(e,t){return new mr(e,2,t,is.min(),is.min(),Or.empty(),0)}static newUnknownDocument(e,t){return new mr(e,3,t,is.min(),is.min(),Or.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(is.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=is.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function Ix(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Ft.comparator(Ft.fromName(d.referenceValue),t.key):i=nc(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Dx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xa(n.position[t],e.position[t]))return!1;return!0}class Cu{constructor(e,t="asc"){this.field=e,this.dir=t}}function HR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class b_{}class Vn extends b_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new WR(e,t,i):t==="array-contains"?new YR(e,i):t==="in"?new QR(e,i):t==="not-in"?new XR(e,i):t==="array-contains-any"?new JR(e,i):new Vn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new GR(e,i):new KR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nc(t,this.value)):t!==null&&vo(this.value)===vo(t)&&this.matchesComparison(nc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return es(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends b_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Na(e,t)}matches(e){return v_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function v_(n){return n.op==="and"}function x_(n){return $R(n)&&v_(n)}function $R(n){for(const e of n.filters)if(e instanceof Na)return!1;return!0}function _g(n){if(n instanceof Vn)return n.field.canonicalString()+n.op.toString()+rc(n.value);if(x_(n))return n.filters.map((e=>_g(e))).join(",");{const e=n.filters.map((t=>_g(t))).join(",");return`${n.op}(${e})`}}function w_(n,e){return n instanceof Vn?(function(i,l){return l instanceof Vn&&i.op===l.op&&i.field.isEqual(l.field)&&Xa(i.value,l.value)})(n,e):n instanceof Na?(function(i,l){return l instanceof Na&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&w_(d,l.filters[p])),!0):!1})(n,e):void es(19439)}function __(n){return n instanceof Vn?(function(t){return`${t.field.canonicalString()} ${t.op} ${rc(t.value)}`})(n):n instanceof Na?(function(t){return t.op.toString()+" {"+t.getFilters().map(__).join(" ,")+"}"})(n):"Filter"}class WR extends Vn{constructor(e,t,i){super(e,t,i),this.key=Ft.fromName(i.referenceValue)}matches(e){const t=Ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class GR extends Vn{constructor(e,t){super(e,"in",t),this.keys=k_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class KR extends Vn{constructor(e,t){super(e,"not-in",t),this.keys=k_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function k_(n,e){return(e.arrayValue?.values||[]).map((t=>Ft.fromName(t.referenceValue)))}class YR extends Vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dy(t)&&Nu(t.arrayValue,this.value)}}class QR extends Vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nu(this.value.arrayValue,t)}}class XR extends Vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nu(this.value.arrayValue,t)}}class JR extends Vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Nu(this.value.arrayValue,i)))}}class ZR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Px(n,e=null,t=[],i=[],l=null,u=null,d=null){return new ZR(n,e,t,i,l,u,d)}function hy(n){const e=hs(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>_g(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),um(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>rc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>rc(i))).join(",")),e.Te=t}return e.Te}function my(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!HR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!w_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Dx(n.startAt,e.startAt)&&Dx(n.endAt,e.endAt)}function kg(n){return Ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class fc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function eA(n,e,t,i,l,u,d,p){return new fc(n,e,t,i,l,u,d,p)}function hm(n){return new fc(n)}function Lx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tA(n){return Ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function j_(n){return n.collectionGroup!==null}function yu(n){const e=hs(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Hn(ar.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Cu(u,i))})),t.has(ar.keyField().canonicalString())||e.Ie.push(new Cu(ar.keyField(),i))}return e.Ie}function Ka(n){const e=hs(n);return e.Ee||(e.Ee=sA(e,yu(n))),e.Ee}function sA(n,e){if(n.limitType==="F")return Px(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Cu(l.field,u)}));const t=n.endAt?new Wh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Wh(n.startAt.position,n.startAt.inclusive):null;return Px(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jg(n,e){const t=n.filters.concat([e]);return new fc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nA(n,e){const t=n.explicitOrderBy.concat([e]);return new fc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Gh(n,e,t){return new fc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function mm(n,e){return my(Ka(n),Ka(e))&&n.limitType===e.limitType}function T_(n){return`${hy(Ka(n))}|lt:${n.limitType}`}function Wl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>__(l))).join(", ")}]`),um(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>rc(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>rc(l))).join(",")),`Target(${i})`})(Ka(n))}; limitType=${n.limitType})`}function fm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Ft.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of yu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,yu(i),l)||i.endAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,yu(i),l))})(n,e)}function rA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function S_(n){return(e,t)=>{let i=!1;for(const l of yu(n)){const u=aA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function aA(n,e,t){const i=n.field.isKeyField()?Ft.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?nc(g,y):es(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return es(19790,{direction:n.dir})}}class ll{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return c_(this.inner)}size(){return this.innerSize}}const iA=new bn(Ft.comparator);function Ni(){return iA}const E_=new bn(Ft.comparator);function du(...n){let e=E_;for(const t of n)e=e.insert(t.key,t);return e}function N_(n){let e=E_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ko(){return bu()}function C_(){return bu()}function bu(){return new ll((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oA=new bn(Ft.comparator),lA=new Hn(Ft.comparator);function Rs(...n){let e=lA;for(const t of n)e=e.add(t);return e}const cA=new Hn(Cs);function uA(){return cA}function fy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function R_(n){return{integerValue:""+n}}function A_(n,e){return PR(e)?R_(e):fy(n,e)}class pm{constructor(){this._=void 0}}function dA(n,e,t){return n instanceof Ru?(function(l,u){const d={fields:{[h_]:{stringValue:d_},[f_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&uy(u)&&(u=dm(u)),u&&(d.fields[m_]=u),{mapValue:d}})(t,e):n instanceof Au?I_(n,e):n instanceof Mu?D_(n,e):(function(l,u){const d=M_(l,u),p=Ox(d)+Ox(l.Ae);return wg(d)&&wg(l.Ae)?R_(p):fy(l.serializer,p)})(n,e)}function hA(n,e,t){return n instanceof Au?I_(n,e):n instanceof Mu?D_(n,e):t}function M_(n,e){return n instanceof Iu?(function(i){return wg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Ru extends pm{}class Au extends pm{constructor(e){super(),this.elements=e}}function I_(n,e){const t=P_(e);for(const i of n.elements)t.some((l=>Xa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Mu extends pm{constructor(e){super(),this.elements=e}}function D_(n,e){let t=P_(e);for(const i of n.elements)t=t.filter((l=>!Xa(l,i)));return{arrayValue:{values:t}}}class Iu extends pm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ox(n){return Mn(n.integerValue||n.doubleValue)}function P_(n){return dy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class L_{constructor(e,t){this.field=e,this.transform=t}}function mA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Au&&l instanceof Au||i instanceof Mu&&l instanceof Mu?sc(i.elements,l.elements,Xa):i instanceof Iu&&l instanceof Iu?Xa(i.Ae,l.Ae):i instanceof Ru&&l instanceof Ru})(n.transform,e.transform)}class fA{constructor(e,t){this.version=e,this.transformResults=t}}class Tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tr}static exists(e){return new Tr(void 0,e)}static updateTime(e){return new Tr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class gm{}function O_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ym(n.key,Tr.none()):new $u(n.key,n.data,Tr.none());{const t=n.data,i=Or.empty();let l=new Hn(ar.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new To(n.key,i,new Qr(l.toArray()),Tr.none())}}function pA(n,e,t){n instanceof $u?(function(l,u,d){const p=l.value.clone(),g=Vx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof To?(function(l,u,d){if(!Ch(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Vx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(B_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function vu(n,e,t,i){return n instanceof $u?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=u.value.clone(),x=Ux(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof To?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=Ux(u.fieldTransforms,g,d),x=d.data;return x.setAll(B_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(n,e,t,i):(function(u,d,p){return Ch(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function gA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=M_(i.transform,l||null);u!=null&&(t===null&&(t=Or.empty()),t.set(i.field,u))}return t||null}function Bx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&sc(i,l,((u,d)=>mA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $u extends gm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class To extends gm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function B_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Vx(n,e,t){const i=new Map;Ws(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,hA(d,p,t[l]))}return i}function Ux(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,dA(u,d,e))}return i}class ym extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yA extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&pA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=C_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=O_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(is.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Rs())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,i)=>Bx(t,i)))&&sc(this.baseMutations,e.baseMutations,((t,i)=>Bx(t,i)))}}class py{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Ws(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return oA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new py(e,t,i,l)}}class vA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class xA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Bn,Os;function wA(n){switch(n){case Oe.OK:return es(64938);case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0;default:return es(15467,{code:n})}}function V_(n){if(n===void 0)return Ei("GRPC error has no .code"),Oe.UNKNOWN;switch(n){case Bn.OK:return Oe.OK;case Bn.CANCELLED:return Oe.CANCELLED;case Bn.UNKNOWN:return Oe.UNKNOWN;case Bn.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Bn.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Bn.INTERNAL:return Oe.INTERNAL;case Bn.UNAVAILABLE:return Oe.UNAVAILABLE;case Bn.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Bn.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Bn.NOT_FOUND:return Oe.NOT_FOUND;case Bn.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Bn.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Bn.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Bn.ABORTED:return Oe.ABORTED;case Bn.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Bn.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Bn.DATA_LOSS:return Oe.DATA_LOSS;default:return es(39323,{code:n})}}(Os=Bn||(Bn={}))[Os.OK=0]="OK",Os[Os.CANCELLED=1]="CANCELLED",Os[Os.UNKNOWN=2]="UNKNOWN",Os[Os.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Os[Os.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Os[Os.NOT_FOUND=5]="NOT_FOUND",Os[Os.ALREADY_EXISTS=6]="ALREADY_EXISTS",Os[Os.PERMISSION_DENIED=7]="PERMISSION_DENIED",Os[Os.UNAUTHENTICATED=16]="UNAUTHENTICATED",Os[Os.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Os[Os.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Os[Os.ABORTED=10]="ABORTED",Os[Os.OUT_OF_RANGE=11]="OUT_OF_RANGE",Os[Os.UNIMPLEMENTED=12]="UNIMPLEMENTED",Os[Os.INTERNAL=13]="INTERNAL",Os[Os.UNAVAILABLE=14]="UNAVAILABLE",Os[Os.DATA_LOSS=15]="DATA_LOSS";function _A(){return new TextEncoder}const kA=new ho([4294967295,4294967295],0);function Fx(n){const e=_A().encode(n),t=new Jw;return t.update(e),new Uint8Array(t.digest())}function zx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ho([t,i],0),new ho([l,u],0)]}class gy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new hu(`Invalid padding: ${t}`);if(i<0)throw new hu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new hu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new hu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ho.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ho.fromNumber(i)));return l.compare(kA)===1&&(l=new ho([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new gy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Wu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new bm(is.min(),l,new bn(Cs),Ni(),Rs())}}class Wu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Wu(i,t,Rs(),Rs(),Rs())}}class Rh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class U_{constructor(e,t){this.targetId=e,this.Ce=t}}class F_{constructor(e,t,i=ir.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class qx{constructor(){this.ve=0,this.Fe=Hx(),this.Me=ir.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Rs(),t=Rs(),i=Rs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:es(38017,{changeType:u})}})),new Wu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Hx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ws(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class jA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ni(),this.He=ch(),this.Je=ch(),this.Ze=new bn(Cs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:es(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(kg(u))if(i===0){const d=new Ft(u.path);this.et(t,d,mr.newNoDocument(d,is.min()))}else Ws(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=bo(i).toUint8Array()}catch(g){if(g instanceof u_)return tc("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new gy(d,l,u)}catch(g){return tc(g instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&kg(p.target)){const g=new Ft(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,mr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Rs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new bm(e,t,this.Ze,this.je,i);return this.je=Ni(),this.He=ch(),this.Je=ch(),this.Ze=new bn(Cs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new qx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Hn(Cs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Hn(Cs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||kt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ch(){return new bn(Ft.comparator)}function Hx(){return new bn(Ft.comparator)}const TA={asc:"ASCENDING",desc:"DESCENDING"},SA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EA={and:"AND",or:"OR"};class NA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Tg(n,e){return n.useProto3Json||um(e)?e:{value:e}}function Kh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CA(n,e){return Kh(n,e.toTimestamp())}function Ya(n){return Ws(!!n,49232),is.fromTimestamp((function(t){const i=yo(t);return new Ct(i.seconds,i.nanos)})(n))}function yy(n,e){return Sg(n,e).canonicalString()}function Sg(n,e){const t=(function(l){return new on(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function q_(n){const e=on.fromString(n);return Ws(K_(e),10190,{key:e.toString()}),e}function Eg(n,e){return yy(n.databaseId,e.path)}function Vp(n,e){const t=q_(e);if(t.get(1)!==n.databaseId.projectId)throw new ft(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ft(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ft($_(t))}function H_(n,e){return yy(n.databaseId,e)}function RA(n){const e=q_(n);return e.length===4?on.emptyPath():$_(e)}function Ng(n){return new on(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $_(n){return Ws(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $x(n,e,t){return{name:Eg(n,e),fields:t.value.mapValue.fields}}function AA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:es(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Ws(x===void 0||typeof x=="string",58123),ir.fromBase64String(x||"")):(Ws(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),ir.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Oe.UNKNOWN:V_(y.code);return new ft(x,y.message||"")})(d);t=new F_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Vp(n,i.document.name),u=Ya(i.document.updateTime),d=i.document.createTime?Ya(i.document.createTime):is.min(),p=new Or({mapValue:{fields:i.document.fields}}),g=mr.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Rh(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Vp(n,i.document),u=i.readTime?Ya(i.readTime):is.min(),d=mr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Rh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Vp(n,i.document),u=i.removedTargetIds||[];t=new Rh([],u,l,null)}else{if(!("filter"in e))return es(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new xA(l,u),p=i.targetId;t=new U_(p,d)}}return t}function MA(n,e){let t;if(e instanceof $u)t={update:$x(n,e.key,e.value)};else if(e instanceof ym)t={delete:Eg(n,e.key)};else if(e instanceof To)t={update:$x(n,e.key,e.data),updateMask:FA(e.fieldMask)};else{if(!(e instanceof yA))return es(16599,{dt:e.type});t={verify:Eg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Ru)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Au)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Mu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Iu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw es(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:CA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:es(27497)})(n,e.precondition)),t}function IA(n,e){return n&&n.length>0?(Ws(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ya(l.updateTime):Ya(u);return d.isEqual(is.min())&&(d=Ya(u)),new fA(d,l.transformResults||[])})(t,e)))):[]}function DA(n,e){return{documents:[H_(n,e.path)]}}function PA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=H_(n,l);const u=(function(y){if(y.length!==0)return G_(Na.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(j){return{field:Gl(j.field),direction:BA(j.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Tg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function LA(n){let e=RA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Ws(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(_){const j=W_(_);return j instanceof Na&&x_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((j=>(function(G){return new Cu(Kl(G.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(G.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(_){let j;return j=typeof _=="object"?_.value:_,um(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(_){const j=!!_.before,O=_.values||[];return new Wh(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(_){const j=!_.before,O=_.values||[];return new Wh(O,j)})(t.endAt)),eA(e,l,d,u,p,"F",g,y)}function OA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return es(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function W_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Kl(t.unaryFilter.field);return Vn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Kl(t.unaryFilter.field);return Vn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Kl(t.unaryFilter.field);return Vn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Kl(t.unaryFilter.field);return Vn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return es(61313);default:return es(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Vn.create(Kl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return es(58110);default:return es(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Na.create(t.compositeFilter.filters.map((i=>W_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return es(1026)}})(t.compositeFilter.op))})(n):es(30097,{filter:n})}function BA(n){return TA[n]}function VA(n){return SA[n]}function UA(n){return EA[n]}function Gl(n){return{fieldPath:n.canonicalString()}}function Kl(n){return ar.fromServerFormat(n.fieldPath)}function G_(n){return n instanceof Vn?(function(t){if(t.op==="=="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gl(t.field),op:VA(t.op),value:t.value}}})(n):n instanceof Na?(function(t){const i=t.getFilters().map((l=>G_(l)));return i.length===1?i[0]:{compositeFilter:{op:UA(t.op),filters:i}}})(n):es(54877,{filter:n})}function FA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function K_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Y_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class lo{constructor(e,t,i,l,u=is.min(),d=is.min(),p=ir.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zA{constructor(e){this.yt=e}}function qA(n){const e=LA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Gh(e,e.limit,"L"):e}class HA{constructor(){this.Sn=new $A}addToCollectionParentIndex(e,t){return this.Sn.add(t),$e.resolve()}getCollectionParents(e,t){return $e.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return $e.resolve()}deleteFieldIndex(e,t){return $e.resolve()}deleteAllFieldIndexes(e){return $e.resolve()}createTargetIndexes(e,t){return $e.resolve()}getDocumentsMatchingTarget(e,t){return $e.resolve(null)}getIndexType(e,t){return $e.resolve(0)}getFieldIndexes(e,t){return $e.resolve([])}getNextCollectionGroupToUpdate(e){return $e.resolve(null)}getMinOffset(e,t){return $e.resolve(go.min())}getMinOffsetFromCollectionGroup(e,t){return $e.resolve(go.min())}updateCollectionGroup(e,t,i){return $e.resolve()}updateIndexEntries(e,t){return $e.resolve()}}class $A{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Hn(on.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Hn(on.comparator)).toArray()}}const Wx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Q_=41943040;class Lr{static withCacheSize(e){return new Lr(e,Lr.DEFAULT_COLLECTION_PERCENTILE,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Lr.DEFAULT_COLLECTION_PERCENTILE=10,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lr.DEFAULT=new Lr(Q_,Lr.DEFAULT_COLLECTION_PERCENTILE,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lr.DISABLED=new Lr(-1,0,0);class ac{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ac(0)}static ar(){return new ac(-1)}}const Gx="LruGarbageCollector",WA=1048576;function Kx([n,e],[t,i]){const l=Cs(n,t);return l===0?Cs(e,i):l}class GA{constructor(e){this.Pr=e,this.buffer=new Hn(Kx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Kx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){kt(Gx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){mc(t)?kt(Gx,"Ignoring IndexedDB error during garbage collection: ",t):await hc(t)}await this.Ar(3e5)}))}}class YA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return $e.resolve(cm.ce);const i=new GA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(kt("LruGarbageCollector","Garbage collection skipped; disabled"),$e.resolve(Wx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(kt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(kt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),l=this.params.maximumSequenceNumbersToCollect):l=_,d=Date.now(),this.nthSequenceNumber(e,l)))).next((_=>(i=_,p=Date.now(),this.removeTargets(e,i,t)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(y=Date.now(),$l()<=Es.DEBUG&&kt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),$e.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:_}))))}}function QA(n,e){return new YA(n,e)}class XA{constructor(){this.changes=new ll((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?$e.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class JA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&vu(i.mutation,l,Qr.empty(),Ct.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Rs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Rs()){const l=Ko();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=du();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ko();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Rs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=Ni();const d=bu(),p=(function(){return bu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof To)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),vu(x.mutation,y,x.mutation.getFieldMask(),Ct.now())):d.set(y.key,Qr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new JA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=bu();let l=new bn(((d,p)=>d-p)),u=Rs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Qr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const _=(l.get(p.batchId)||Rs()).add(g);l=l.insert(p.batchId,_)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,_=C_();x.forEach((j=>{if(!u.has(j)){const O=O_(t.get(j),i.get(j));O!==null&&_.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,_))}return $e.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return tA(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):$e.resolve(Ko());let p=Tu,g=u;return d.next((y=>$e.forEach(y,((x,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(x)?$e.resolve():this.remoteDocumentCache.getEntry(e,x).next((j=>{g=g.insert(x,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Rs()))).next((x=>({batchId:p,changes:N_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ft(t)).next((i=>{let l=du();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=du();return this.indexManager.getCollectionParents(e,u).next((p=>$e.forEach(p,(g=>{const y=(function(_,j){return new fc(j,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((_,j)=>{d=d.insert(_,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,mr.newInvalidDocument(x)))}));let p=du();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&vu(x.mutation,y,Qr.empty(),Ct.now()),fm(t,y)&&(p=p.insert(g,y))})),p}))}}class e3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return $e.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ya(l.createTime)}})(t)),$e.resolve()}getNamedQuery(e,t){return $e.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:qA(l.bundledQuery),readTime:Ya(l.readTime)}})(t)),$e.resolve()}}class t3{constructor(){this.overlays=new bn(Ft.comparator),this.Lr=new Map}getOverlay(e,t){return $e.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ko();return $e.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),$e.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),$e.resolve()}getOverlaysForCollection(e,t,i){const l=Ko(),u=t.length+1,d=new Ft(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return $e.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new bn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Ko(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Ko(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return $e.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new vA(t,i));let u=this.Lr.get(t);u===void 0&&(u=Rs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class s3{constructor(){this.sessionToken=ir.EMPTY_BYTE_STRING}getSessionToken(e){return $e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$e.resolve()}}class by{constructor(){this.kr=new Hn(Qn.Kr),this.qr=new Hn(Qn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Qn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Qn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ft(new on([])),i=new Qn(t,e),l=new Qn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ft(new on([])),i=new Qn(t,e),l=new Qn(t,e+1);let u=Rs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Qn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Qn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ft.comparator(e.key,t.key)||Cs(e.Hr,t.Hr)}static Ur(e,t){return Cs(e.Hr,t.Hr)||Ft.comparator(e.key,t.key)}}class n3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Hn(Qn.Kr)}checkEmpty(e){return $e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new bA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Qn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return $e.resolve(d)}lookupMutationBatch(e,t){return $e.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return $e.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return $e.resolve(this.mutationQueue.length===0?cy:this.Yn-1)}getAllMutationBatches(e){return $e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Qn(t,0),l=new Qn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),$e.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Hn(Cs);return t.forEach((l=>{const u=new Qn(l,0),d=new Qn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),$e.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Ft.isDocumentKey(u)||(u=u.child(""));const d=new Qn(new Ft(u),0);let p=new Hn(Cs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),$e.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Ws(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return $e.forEach(t.mutations,(l=>{const u=new Qn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Qn(t,0),l=this.Jr.firstAfterOrEqual(i);return $e.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,$e.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class r3{constructor(e){this.ti=e,this.docs=(function(){return new bn(Ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return $e.resolve(i?i.document.mutableCopy():mr.newInvalidDocument(t))}getEntries(e,t){let i=Ni();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():mr.newInvalidDocument(l))})),$e.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=Ni();const d=t.path,p=new Ft(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||AR(RR(x),i)<=0||(l.has(x.key)||fm(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return $e.resolve(u)}getAllFromCollectionGroup(e,t,i,l){es(9500)}ni(e,t){return $e.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new a3(this)}getSize(e){return $e.resolve(this.size)}}class a3 extends XA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),$e.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class i3{constructor(e){this.persistence=e,this.ri=new ll((t=>hy(t)),my),this.lastRemoteSnapshotVersion=is.min(),this.highestTargetId=0,this.ii=0,this.si=new by,this.targetCount=0,this.oi=ac._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),$e.resolve()}getLastRemoteSnapshotVersion(e){return $e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $e.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),$e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),$e.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ac(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,$e.resolve()}updateTargetData(e,t){return this.lr(t),$e.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,$e.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),$e.waitFor(u).next((()=>l))}getTargetCount(e){return $e.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return $e.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),$e.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),$e.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),$e.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return $e.resolve(i)}containsKey(e,t){return $e.resolve(this.si.containsKey(t))}}class X_{constructor(e,t){this._i={},this.overlays={},this.ai=new cm(0),this.ui=!1,this.ui=!0,this.ci=new s3,this.referenceDelegate=e(this),this.li=new i3(this),this.indexManager=new HA,this.remoteDocumentCache=(function(l){return new r3(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new zA(t),this.Pi=new e3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new t3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new n3(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){kt("MemoryPersistence","Starting transaction:",e);const l=new o3(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return $e.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class o3 extends IR{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new by,this.Ai=null}static Vi(e){return new vy(e)}get di(){if(this.Ai)return this.Ai;throw es(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),$e.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),$e.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),$e.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $e.forEach(this.di,(i=>{const l=Ft.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,is.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return $e.or([()=>$e.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new ll((i=>LR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=QA(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return $e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return $e.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?$e.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,is.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),$e.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),$e.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),$e.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),$e.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Eh(e.data.value)),t}wr(e,t,i){return $e.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return $e.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class xy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Rs(),l=Rs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new xy(e,t.fromCache,i,l)}}class l3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class c3{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return LE()?8:DR(pr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new l3;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?($l()<=Es.DEBUG&&kt("QueryEngine","SDK will not create cache indexes for query:",Wl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),$e.resolve()):($l()<=Es.DEBUG&&kt("QueryEngine","Query:",Wl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?($l()<=Es.DEBUG&&kt("QueryEngine","The SDK decides to create cache indexes for query:",Wl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ka(t))):$e.resolve())}gs(e,t){if(Lx(t))return $e.resolve(null);let i=Ka(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=Ka(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Rs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Lx(t)||l.isEqual(is.min())?$e.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?$e.resolve(null):($l()<=Es.DEBUG&&kt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Wl(t)),this.Ds(e,d,t,CR(l,Tu)).next((p=>p)))}))}bs(e,t){let i=new Hn(S_(e));return t.forEach(((l,u)=>{fm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return $l()<=Es.DEBUG&&kt("QueryEngine","Using full collection scan to execute query:",Wl(t)),this.fs.getDocumentsMatchingQuery(e,t,go.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const wy="LocalStore",u3=3e8;class d3{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new bn(Cs),this.Fs=new ll((u=>hy(u)),my),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function h3(n,e,t,i){return new d3(n,e,t,i)}async function J_(n,e){const t=hs(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=Rs();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function m3(n,e){const t=hs(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const _=y.batch,j=_.keys();let O=$e.resolve();return j.forEach((G=>{O=O.next((()=>x.getEntry(g,G))).next((B=>{const D=y.docVersions.get(G);Ws(D!==null,48541),B.version.compareTo(D)<0&&(_.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),x.addEntry(B)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Rs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Z_(n){const e=hs(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function f3(n,e){const t=hs(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,_)=>{const j=l.get(_);if(!j)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,_).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,_))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?O=O.withResumeToken(ir.EMPTY_BYTE_STRING,is.min()).withLastLimboFreeSnapshotVersion(is.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(_,O),(function(B,D,te){return B.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=u3?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(j,O,x)&&p.push(t.li.updateTargetData(u,O))}));let g=Ni(),y=Rs();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(p3(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(is.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((_=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return $e.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function p3(n,e,t){let i=Rs(),l=Rs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=Ni();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(is.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):kt(wy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function g3(n,e){const t=hs(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function y3(n,e){const t=hs(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,$e.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new lo(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Cg(n,e,t){const i=hs(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!mc(d))throw d;kt(wy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Yx(n,e,t){const i=hs(n);let l=is.min(),u=Rs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const _=hs(g),j=_.Fs.get(x);return j!==void 0?$e.resolve(_.vs.get(j)):_.li.getTargetData(y,x)})(i,d,Ka(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:is.min(),t?u:Rs()))).next((p=>(b3(i,rA(e),p),{documents:p,ks:u})))))}function b3(n,e,t){let i=n.Ms.get(e)||is.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Qx{constructor(){this.activeTargetIds=uA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class v3{constructor(){this.vo=new Qx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Qx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class x3{Mo(e){}shutdown(){}}const Xx="ConnectivityMonitor";class Jx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){kt(Xx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){kt(Xx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let uh=null;function Rg(){return uh===null?uh=(function(){return 268435456+Math.round(2147483648*Math.random())})():uh++,"0x"+uh.toString(16)}const Up="RestConnection",w3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class _3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Hh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Rg(),p=this.Qo(e,t.toUriEncodedString());kt(Up,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=_o(y);return this.zo(e,p,g,i,x).then((_=>(kt(Up,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw tc(Up,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",i),_}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+dc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=w3[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class k3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const dr="WebChannelConnection",su=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Zl extends _3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Zl.c_){const e=s_();su(e,t_.STAT_EVENT,(t=>{t.stat===bg.PROXY?kt(dr,"STAT_EVENT: detected buffering proxy"):t.stat===bg.NOPROXY&&kt(dr,"STAT_EVENT: detected no buffering proxy")})),Zl.c_=!0}}zo(e,t,i,l,u){const d=Rg();return new Promise(((p,g)=>{const y=new Zw;y.setWithCredentials(!0),y.listenOnce(e_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Sh.NO_ERROR:const _=y.getResponseJson();kt(dr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case Sh.TIMEOUT:kt(dr,`RPC '${e}' ${d} timed out`),g(new ft(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case Sh.HTTP_ERROR:const j=y.getStatus();if(kt(dr,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const G=O?.error;if(G&&G.status&&G.message){const B=(function(te){const Y=te.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(Y)>=0?Y:Oe.UNKNOWN})(G.status);g(new ft(B,G.message))}else g(new ft(Oe.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ft(Oe.UNAVAILABLE,"Connection failed."));break;default:es(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{kt(dr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);kt(dr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Rg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");kt(dr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let _=!1,j=!1;const O=new k3({Ho:G=>{j?kt(dr,`Not sending because RPC '${e}' stream ${l} is closed:`,G):(_||(kt(dr,`Opening RPC '${e}' stream ${l} transport.`),x.open(),_=!0),kt(dr,`RPC '${e}' stream ${l} sending:`,G),x.send(G))},Jo:()=>x.close()});return su(x,uu.EventType.OPEN,(()=>{j||(kt(dr,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),su(x,uu.EventType.CLOSE,(()=>{j||(j=!0,kt(dr,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),su(x,uu.EventType.ERROR,(G=>{j||(j=!0,tc(dr,`RPC '${e}' stream ${l} transport errored. Name:`,G.name,"Message:",G.message),O.o_(new ft(Oe.UNAVAILABLE,"The operation could not be completed")))})),su(x,uu.EventType.MESSAGE,(G=>{if(!j){const B=G.data[0];Ws(!!B,16349);const D=B,te=D?.error||D[0]?.error;if(te){kt(dr,`RPC '${e}' stream ${l} received error:`,te);const Y=te.status;let Z=(function(we){const N=Bn[we];if(N!==void 0)return V_(N)})(Y),_e=te.message;Z===void 0&&(Z=Oe.INTERNAL,_e="Unknown error status: "+Y+" with message "+te.message),j=!0,O.o_(new ft(Z,_e)),x.close()}else kt(dr,`RPC '${e}' stream ${l} received:`,B),O.__(B)}})),Zl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return n_()}}function j3(n){return new Zl(n)}function Fp(){return typeof document<"u"?document:null}function vm(n){return new NA(n,!0)}Zl.c_=!1;class ek{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&kt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Zx="PersistentStream";class tk{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ek(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Oe.RESOURCE_EXHAUSTED?(Ei(t.toString()),Ei("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new ft(Oe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return kt(Zx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(kt(Zx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class T3 extends tk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return is.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?is.min():d.readTime?Ya(d.readTime):is.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Ng(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=kg(g)?{documents:DA(u,g)}:{query:PA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=z_(u,d.resumeToken);const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(is.min())>0){p.readTime=Kh(u,d.snapshotVersion.toTimestamp());const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=OA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Ng(this.serializer),t.removeTarget=e,this.K_(t)}}class S3 extends tk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ws(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ws(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ws(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IA(e.writeResults,e.commitTime),i=Ya(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Ng(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>MA(this.serializer,i)))};this.K_(t)}}class E3{}class N3 extends E3{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new ft(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Sg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ft(Oe.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Sg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ft(Oe.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function C3(n,e,t,i){return new N3(n,e,t,i)}class R3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ei(t),this.aa=!1):kt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const rl="RemoteStore";class A3{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{cl(this)&&(kt(rl,"Restarting streams for network reachability change."),await(async function(g){const y=hs(g);y.Ea.add(4),await Gu(y),y.Va.set("Unknown"),y.Ea.delete(4),await xm(y)})(this))}))})),this.Va=new R3(i,l)}}async function xm(n){if(cl(n))for(const e of n.Ra)await e(!0)}async function Gu(n){for(const e of n.Ra)await e(!1)}function sk(n,e){const t=hs(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ty(t)?jy(t):pc(t).O_()&&ky(t,e))}function _y(n,e){const t=hs(n),i=pc(t);t.Ia.delete(e),i.O_()&&nk(t,e),t.Ia.size===0&&(i.O_()?i.L_():cl(t)&&t.Va.set("Unknown"))}function ky(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(is.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pc(n).Z_(e)}function nk(n,e){n.da.$e(e),pc(n).X_(e)}function jy(n){n.da=new jA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),pc(n).start(),n.Va.ua()}function Ty(n){return cl(n)&&!pc(n).x_()&&n.Ia.size>0}function cl(n){return hs(n).Ea.size===0}function rk(n){n.da=void 0}async function M3(n){n.Va.set("Online")}async function I3(n){n.Ia.forEach(((e,t)=>{ky(n,e)}))}async function D3(n,e){rk(n),Ty(n)?(n.Va.ha(e),jy(n)):n.Va.set("Unknown")}async function P3(n,e,t){if(n.Va.set("Online"),e instanceof F_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){kt(rl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(n,i)}else if(e instanceof Rh?n.da.Xe(e):e instanceof U_?n.da.st(e):n.da.tt(e),!t.isEqual(is.min()))try{const i=await Z_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(ir.EMPTY_BYTE_STRING,x.snapshotVersion)),nk(u,g);const _=new lo(x.target,g,y,x.sequenceNumber);ky(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){kt(rl,"Failed to raise snapshot:",i),await Qh(n,i)}}async function Qh(n,e,t){if(!mc(e))throw e;n.Ea.add(1),await Gu(n),n.Va.set("Offline"),t||(t=()=>Z_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{kt(rl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await xm(n)}))}function ak(n,e){return e().catch((t=>Qh(n,t,e)))}async function wm(n){const e=hs(n),t=xo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cy;for(;L3(e);)try{const l=await g3(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,O3(e,l)}catch(l){await Qh(e,l)}ik(e)&&ok(e)}function L3(n){return cl(n)&&n.Ta.length<10}function O3(n,e){n.Ta.push(e);const t=xo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ik(n){return cl(n)&&!xo(n).x_()&&n.Ta.length>0}function ok(n){xo(n).start()}async function B3(n){xo(n).ra()}async function V3(n){const e=xo(n);for(const t of n.Ta)e.ea(t.mutations)}async function U3(n,e,t){const i=n.Ta.shift(),l=py.from(i,e,t);await ak(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await wm(n)}async function F3(n,e){e&&xo(n).Y_&&await(async function(i,l){if((function(d){return wA(d)&&d!==Oe.ABORTED})(l.code)){const u=i.Ta.shift();xo(i).B_(),await ak(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await wm(i)}})(n,e),ik(n)&&ok(n)}async function e2(n,e){const t=hs(n);t.asyncQueue.verifyOperationInProgress(),kt(rl,"RemoteStore received new credentials");const i=cl(t);t.Ea.add(3),await Gu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xm(t)}async function z3(n,e){const t=hs(n);e?(t.Ea.delete(2),await xm(t)):e||(t.Ea.add(2),await Gu(t),t.Va.set("Unknown"))}function pc(n){return n.ma||(n.ma=(function(t,i,l){const u=hs(t);return u.sa(),new T3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:M3.bind(null,n),Yo:I3.bind(null,n),t_:D3.bind(null,n),J_:P3.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Ty(n)?jy(n):n.Va.set("Unknown")):(await n.ma.stop(),rk(n))}))),n.ma}function xo(n){return n.fa||(n.fa=(function(t,i,l){const u=hs(t);return u.sa(),new S3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:B3.bind(null,n),t_:F3.bind(null,n),ta:V3.bind(null,n),na:U3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await wm(n)):(await n.fa.stop(),n.Ta.length>0&&(kt(rl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Sy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Sy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ft(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ey(n,e){if(Ei("AsyncQueue",`${e}: ${n}`),mc(n))return new ft(Oe.UNAVAILABLE,`${e}: ${n}`);throw n}class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ft.comparator(t.key,i.key):(t,i)=>Ft.comparator(t.key,i.key),this.keyedMap=du(),this.sortedSet=new bn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ec;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class t2{constructor(){this.ga=new bn(Ft.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):es(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ic{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ic(e,t,ec.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class q3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class H3{constructor(){this.queries=s2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=hs(t),u=l.queries;l.queries=s2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new ft(Oe.ABORTED,"Firestore shutting down"))}}function s2(){return new ll((n=>T_(n)),mm)}async function Ny(n,e){const t=hs(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new q3,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ey(d,`Initialization of query '${Wl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ry(t)}async function Cy(n,e){const t=hs(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $3(n,e){const t=hs(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ry(t)}function W3(n,e,t){const i=hs(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ry(n){n.Ca.forEach((e=>{e.next()}))}var Ag,n2;(n2=Ag||(Ag={})).Ma="default",n2.Cache="cache";class Ay{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ic(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ag.Cache}}class lk{constructor(e){this.key=e}}class ck{constructor(e){this.key=e}}class G3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Rs(),this.mutatedKeys=Rs(),this.eu=S_(e),this.tu=new ec(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new t2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,_)=>{const j=l.get(x),O=fm(this.query,_)?_:null,G=!!j&&this.mutatedKeys.has(j.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let D=!1;j&&O?j.data.isEqual(O.data)?G!==B&&(i.track({type:3,doc:O}),D=!0):this.su(j,O)||(i.track({type:2,doc:O}),D=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),D=!0):j&&!O&&(i.track({type:1,doc:j}),D=!0,(g||y)&&(p=!0)),D&&(O?(d=d.add(O),u=B?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,_)=>(function(O,G){const B=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return es(20277,{Vt:D})}};return B(O)-B(G)})(x.type,_.type)||this.eu(x.doc,_.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ic(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new t2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Rs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new ck(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new lk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Rs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ic.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const My="SyncEngine";class K3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Y3{constructor(e){this.key=e,this.hu=!1}}class Q3{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new ll((p=>T_(p)),mm),this.Iu=new Map,this.Eu=new Set,this.Ru=new bn(Ft.comparator),this.Au=new Map,this.Vu=new by,this.du={},this.mu=new Map,this.fu=ac.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function X3(n,e,t=!0){const i=pk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await uk(i,e,t,!0),l}async function J3(n,e){const t=pk(n);await uk(t,e,!0,!1)}async function uk(n,e,t,i){const l=await y3(n.localStore,Ka(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await Z3(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&sk(n.remoteStore,l),p}async function Z3(n,e,t,i,l){n.pu=(_,j,O)=>(async function(B,D,te,Y){let Z=D.view.ru(te);Z.Ss&&(Z=await Yx(B.localStore,D.query,!1).then((({documents:N})=>D.view.ru(N,Z))));const _e=Y&&Y.targetChanges.get(D.targetId),Me=Y&&Y.targetMismatches.get(D.targetId)!=null,we=D.view.applyChanges(Z,B.isPrimaryClient,_e,Me);return a2(B,D.targetId,we.au),we.snapshot})(n,_,j,O);const u=await Yx(n.localStore,e,!0),d=new G3(e,u.ks),p=d.ru(u.documents),g=Wu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);a2(n,t,y.au);const x=new K3(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function eM(n,e,t){const i=hs(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!mm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Cg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&_y(i.remoteStore,l.targetId),Mg(i,l.targetId)})).catch(hc)):(Mg(i,l.targetId),await Cg(i.localStore,l.targetId,!0))}async function tM(n,e){const t=hs(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),_y(t.remoteStore,i.targetId))}async function sM(n,e,t){const i=cM(n);try{const l=await(function(d,p){const g=hs(d),y=Ct.now(),x=p.reduce(((O,G)=>O.add(G.key)),Rs());let _,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let G=Ni(),B=Rs();return g.xs.getEntries(O,x).next((D=>{G=D,G.forEach(((te,Y)=>{Y.isValidDocument()||(B=B.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,G))).next((D=>{_=D;const te=[];for(const Y of p){const Z=gA(Y,_.get(Y.key).overlayedDocument);Z!=null&&te.push(new To(Y.key,Z,y_(Z.value.mapValue),Tr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((D=>{j=D;const te=D.applyToLocalDocumentSet(_,B);return g.documentOverlayCache.saveOverlays(O,D.batchId,te)}))})).then((()=>({batchId:j.batchId,changes:N_(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new bn(Cs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Ku(i,l.changes),await wm(i.remoteStore)}catch(l){const u=Ey(l,"Failed to persist write");t.reject(u)}}async function dk(n,e){const t=hs(n);try{const i=await f3(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Ws(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Ws(d.hu,14607):l.removedDocuments.size>0&&(Ws(d.hu,42227),d.hu=!1))})),await Ku(t,i,e)}catch(i){await hc(i)}}function r2(n,e,t){const i=hs(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=hs(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,_)=>{for(const j of _.ba)j.va(p)&&(y=!0)})),y&&Ry(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nM(n,e,t){const i=hs(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new bn(Ft.comparator);d=d.insert(u,mr.newNoDocument(u,is.min()));const p=Rs().add(u),g=new bm(is.min(),new Map,new bn(Cs),d,p);await dk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Iy(i)}else await Cg(i.localStore,e,!1).then((()=>Mg(i,e,t))).catch(hc)}async function rM(n,e){const t=hs(n),i=e.batch.batchId;try{const l=await m3(t.localStore,e);mk(t,i,null),hk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ku(t,l)}catch(l){await hc(l)}}async function aM(n,e,t){const i=hs(n);try{const l=await(function(d,p){const g=hs(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((_=>(Ws(_!==null,37113),x=_.keys(),g.mutationQueue.removeMutationBatch(y,_)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);mk(i,e,t),hk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ku(i,l)}catch(l){await hc(l)}}function hk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function mk(n,e,t){const i=hs(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Mg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||fk(n,i)}))}function fk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(_y(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Iy(n))}function a2(n,e,t){for(const i of t)i instanceof lk?(n.Vu.addReference(i.key,e),iM(n,i)):i instanceof ck?(kt(My,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||fk(n,i.key)):es(19791,{wu:i})}function iM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(kt(My,"New document in limbo: "+t),n.Eu.add(i),Iy(n))}function Iy(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ft(on.fromString(e)),i=n.fu.next();n.Au.set(i,new Y3(t)),n.Ru=n.Ru.insert(t,i),sk(n.remoteStore,new lo(Ka(hm(t.path)),i,"TargetPurposeLimboResolution",cm.ce))}}async function Ku(n,e,t){const i=hs(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=xy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=hs(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>$e.forEach(y,(j=>$e.forEach(j.Ts,(O=>x.persistence.referenceDelegate.addReference(_,j.targetId,O))).next((()=>$e.forEach(j.Is,(O=>x.persistence.referenceDelegate.removeReference(_,j.targetId,O)))))))))}catch(_){if(!mc(_))throw _;kt(wy,"Failed to update sequence numbers: "+_)}for(const _ of y){const j=_.targetId;if(!_.fromCache){const O=x.vs.get(j),G=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(G);x.vs=x.vs.insert(j,B)}}})(i.localStore,u))}async function oM(n,e){const t=hs(n);if(!t.currentUser.isEqual(e)){kt(My,"User change. New user:",e.toKey());const i=await J_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new ft(Oe.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ku(t,i.Ns)}}function lM(n,e){const t=hs(n),i=t.Au.get(e);if(i&&i.hu)return Rs().add(i.key);{let l=Rs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function pk(n){const e=hs(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.J_=$3.bind(null,e.eventManager),e.Pu.yu=W3.bind(null,e.eventManager),e}function cM(n){const e=hs(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aM.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return h3(this.persistence,new c3,e.initialUser,this.serializer)}Cu(e){return new X_(vy.Vi,this.serializer)}Du(e){return new v3}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class uM extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ws(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new KA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Lr.withCacheSize(this.cacheSizeBytes):Lr.DEFAULT;return new X_((i=>Yh.Vi(i,t)),this.serializer)}}class Ig{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>r2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await z3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new H3})()}createDatastore(e){const t=vm(e.databaseInfo.databaseId),i=j3(e.databaseInfo);return C3(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new A3(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>r2(this.syncEngine,t,0)),(function(){return Jx.v()?new Jx:new x3})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const _=new Q3(l,u,d,p,g,y);return x&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=hs(t);kt(rl,"RemoteStore shutting down."),i.Ea.add(5),await Gu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ig.provider={build:()=>new Ig};class Dy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ei("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const wo="FirestoreClient";class dM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=hr.UNAUTHENTICATED,this.clientId=ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{kt(wo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(kt(wo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ey(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function zp(n,e){n.asyncQueue.verifyOperationInProgress(),kt(wo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await J_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function i2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hM(n);kt(wo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>e2(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>e2(e.remoteStore,l))),n._onlineComponents=e}async function hM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){kt(wo,"Using user provided OfflineComponentProvider");try{await zp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Oe.FAILED_PRECONDITION||l.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;tc("Error using user provided cache. Falling back to memory cache: "+t),await zp(n,new Xh)}}else kt(wo,"Using default OfflineComponentProvider"),await zp(n,new uM(void 0));return n._offlineComponents}async function gk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(kt(wo,"Using user provided OnlineComponentProvider"),await i2(n,n._uninitializedComponentsProvider._online)):(kt(wo,"Using default OnlineComponentProvider"),await i2(n,new Ig))),n._onlineComponents}function mM(n){return gk(n).then((e=>e.syncEngine))}async function Jh(n){const e=await gk(n),t=e.eventManager;return t.onListen=X3.bind(null,e.syncEngine),t.onUnlisten=eM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),t}function fM(n,e,t,i){const l=new Dy(i),u=new Ay(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ny(await Jh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Cy(await Jh(n),u)))}}function pM(n,e,t={}){const i=new ki;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new ft(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new ft(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(hm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Jh(n),n.asyncQueue,e,t,i))),i.promise}function gM(n,e,t={}){const i=new ki;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_))),j.fromCache&&g.source==="server"?y.reject(new ft(Oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(p,x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Jh(n),n.asyncQueue,e,t,i))),i.promise}function yM(n,e){const t=new ki;return n.asyncQueue.enqueueAndForget((async()=>sM(await mM(n),e,t))),t.promise}function yk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const bM="ComponentProvider",o2=new Map;function vM(n,e,t,i,l){return new VR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,yk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const bk="firestore.googleapis.com",l2=!0;class c2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ft(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bk,this.ssl=l2}else this.host=e.host,this.ssl=e.ssl??l2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Q_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WA)throw new ft(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ER("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ft(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ft(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ft(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _m{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ft(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ft(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new yR;switch(i.type){case"firstParty":return new wR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ft(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=o2.get(t);i&&(kt(bM,"Removing Datastore"),o2.delete(t),i.terminate())})(this),Promise.resolve()}}function xM(n,e,t,i={}){n=jr(n,_m);const l=_o(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Wg(`https://${p}`),Gg("Firestore",!0)),u.host!==bk&&u.host!==p&&tc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Zo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=hr.MOCK_USER;else{y=hw(i.mockUserToken,n._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new ft(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new hr(_)}n._authCredentials=new bR(new a_(y,x))}}class Ai{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ai(this.firestore,e,this._query)}}class Tn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Hu(t,Tn._jsonSchema))return new Tn(e,i||null,new Ft(on.fromString(t.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:Un("string",Tn._jsonSchemaVersion),referencePath:Un("string")};class mo extends Ai{constructor(e,t,i){super(e,t,hm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Ft(e))}withConverter(e){return new mo(this.firestore,e,this._path)}}function Yt(n,e,...t){if(n=en(n),i_("collection","path",e),n instanceof _m){const i=on.fromString(e,...t);return _x(i),new mo(n,null,i)}{if(!(n instanceof Tn||n instanceof mo))throw new ft(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(on.fromString(e,...t));return _x(i),new mo(n.firestore,null,i)}}function Je(n,e,...t){if(n=en(n),arguments.length===1&&(e=ly.newId()),i_("doc","path",e),n instanceof _m){const i=on.fromString(e,...t);return wx(i),new Tn(n,null,new Ft(i))}{if(!(n instanceof Tn||n instanceof mo))throw new ft(Oe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(on.fromString(e,...t));return wx(i),new Tn(n.firestore,n instanceof mo?n.converter:null,new Ft(i))}}const u2="AsyncQueue";class d2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ek(this,"async_queue_retry"),this._c=()=>{const i=Fp();i&&kt(u2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Fp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ki;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!mc(e))throw e;kt(u2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ei("INTERNAL UNHANDLED ERROR: ",h2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Sy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&es(47125,{Pc:h2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function h2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ja extends _m{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new d2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d2(e),this._firestoreClient=void 0,await e}}}function wM(n,e){const t=typeof n=="object"?n:Xg(),i=typeof n=="string"?n:Hh,l=rm(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=cw("firestore");u&&xM(l,...u)}return l}function Yu(n){if(n._terminated)throw new ft(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_M(n),n._firestoreClient}function _M(n){const e=n._freezeSettings(),t=vM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new dM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class da{constructor(e){this._byteString=e}static fromBase64String(e){try{return new da(ir.fromBase64String(e))}catch(t){throw new ft(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new da(ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:da._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hu(e,da._jsonSchema))return da.fromBase64String(e.bytes)}}da._jsonSchemaVersion="firestore/bytes/1.0",da._jsonSchema={type:Un("string",da._jsonSchemaVersion),bytes:Un("string")};class km{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ft(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ar(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qu{constructor(e){this._methodName=e}}class Qa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ft(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ft(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Cs(this._lat,e._lat)||Cs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qa._jsonSchemaVersion}}static fromJSON(e){if(Hu(e,Qa._jsonSchema))return new Qa(e.latitude,e.longitude)}}Qa._jsonSchemaVersion="firestore/geoPoint/1.0",Qa._jsonSchema={type:Un("string",Qa._jsonSchemaVersion),latitude:Un("number"),longitude:Un("number")};class Sa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Sa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hu(e,Sa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Sa(e.vectorValues);throw new ft(Oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Sa._jsonSchemaVersion="firestore/vectorValue/1.0",Sa._jsonSchema={type:Un("string",Sa._jsonSchemaVersion),vectorValues:Un("object")};const kM=/^__.*__$/;class jM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new To(e,this.data,this.fieldMask,t,this.fieldTransforms):new $u(e,this.data,t,this.fieldTransforms)}}class vk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new To(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw es(40011,{dataSource:n})}}class Py{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Py({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(xk(this.dataSource)&&kM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class TM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||vm(e)}createContext(e,t,i,l=!1){return new Py({dataSource:e,methodName:t,targetDoc:i,path:ar.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(n){const e=n._freezeSettings(),t=vm(n._databaseId);return new TM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ly(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Vy("Data must be an object, but it was:",d,i);const p=kk(i,d);let g,y;if(u.merge)g=new Qr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const _ of u.mergeFields){const j=al(e,_,t);if(!d.contains(j))throw new ft(Oe.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);Sk(x,j)||x.push(j)}g=new Qr(x),y=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,y=d.fieldTransforms;return new jM(new Or(p),g,y)}class jm extends Qu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jm}}class Oy extends Qu{_toFieldTransform(e){return new L_(e.path,new Ru)}isEqual(e){return e instanceof Oy}}class By extends Qu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Iu(e.serializer,A_(e.serializer,this.Vc));return new L_(e.path,t)}isEqual(e){return e instanceof By&&this.Vc===e.Vc}}function wk(n,e,t,i){const l=n.createContext(1,e,t);Vy("Data must be an object, but it was:",l,i);const u=[],d=Or.empty();jo(i,((g,y)=>{const x=Tk(e,g,t);y=en(y);const _=l.childContextForFieldPath(x);if(y instanceof jm)u.push(x);else{const j=Ju(y,_);j!=null&&(u.push(x),d.set(x,j))}}));const p=new Qr(u);return new vk(d,p,l.fieldTransforms)}function _k(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[al(e,i,t)],g=[l];if(u.length%2!=0)throw new ft(Oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(al(e,u[j])),g.push(u[j+1]);const y=[],x=Or.empty();for(let j=p.length-1;j>=0;--j)if(!Sk(y,p[j])){const O=p[j];let G=g[j];G=en(G);const B=d.childContextForFieldPath(O);if(G instanceof jm)y.push(O);else{const D=Ju(G,B);D!=null&&(y.push(O),x.set(O,D))}}const _=new Qr(y);return new vk(x,_,d.fieldTransforms)}function SM(n,e,t,i=!1){return Ju(t,n.createContext(i?4:3,e))}function Ju(n,e){if(jk(n=en(n)))return Vy("Unsupported field value:",e,n),kk(n,e);if(n instanceof Qu)return(function(i,l){if(!xk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Ju(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=en(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return A_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Ct.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ct){const u=new Ct(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Qa)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof da)return{bytesValue:z_(l.serializer,i._byteString)};if(i instanceof Tn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:yy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof Sa)return(function(d,p){const g=d instanceof Sa?d.toArray():d;return{mapValue:{fields:{[p_]:{stringValue:g_},[$h]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return fy(p.serializer,x)}))}}}}}})(i,l);if(Y_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${lm(i)}`)})(n,e)}function kk(n,e){const t={};return c_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(n,((i,l)=>{const u=Ju(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function jk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ct||n instanceof Qa||n instanceof da||n instanceof Tn||n instanceof Qu||n instanceof Sa||Y_(n))}function Vy(n,e,t){if(!jk(t)||!o_(t)){const i=lm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function al(n,e,t){if((e=en(e))instanceof km)return e._internalPath;if(typeof e=="string")return Tk(n,e);throw Zh("Field path arguments must be of type string or ",n,!1,void 0,t)}const EM=new RegExp("[~\\*/\\[\\]]");function Tk(n,e,t){if(e.search(EM)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new km(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Zh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new ft(Oe.INVALID_ARGUMENT,p+n+g)}function Sk(n,e){return n.some((t=>t.isEqual(e)))}class NM{convertValue(e,t="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw es(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return jo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>Mn(i.doubleValue)));return new Sa(t)}convertGeoPoint(e){return new Qa(Mn(e.latitude),Mn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=dm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Su(e));default:return null}}convertTimestamp(e){const t=yo(e);return new Ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=on.fromString(e);Ws(K_(i),9688,{name:e});const l=new Eu(i.get(1),i.get(3)),u=new Ft(i.popFirst(5));return l.isEqual(t)||Ei(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Uy extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,t)}}function _r(){return new Oy("serverTimestamp")}function Yo(n){return new By("increment",n)}const m2="@firebase/firestore",f2="4.10.0";function p2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Ek{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(al("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class CM extends Ek{data(){return super.data()}}function Nk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ft(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class zy extends Fy{}function Bs(n,e,...t){let i=[];e instanceof Fy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof qy)).length,p=u.filter((g=>g instanceof Tm)).length;if(d>1||d>0&&p>0)throw new ft(Oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class Tm extends zy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Tm(e,t,i)}_apply(e){const t=this._parse(e);return Ck(e._query,t),new Ai(e.firestore,e.converter,jg(e._query,t))}_parse(e){const t=Xu(e.firestore);return(function(u,d,p,g,y,x,_){let j;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ft(Oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){y2(_,x);const G=[];for(const B of _)G.push(g2(g,u,B));j={arrayValue:{values:G}}}else j=g2(g,u,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||y2(_,x),j=SM(p,d,_,x==="in"||x==="not-in");return Vn.create(y,x,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bs(n,e,t){const i=e,l=al("where",n);return Tm._create(l,i,t)}class qy extends Fy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Na.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)Ck(d,g),d=jg(d,g)})(e._query,t),new Ai(e.firestore,e.converter,jg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hy extends zy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new ft(Oe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new ft(Oe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cu(u,d)})(e._query,this._field,this._direction);return new Ai(e.firestore,e.converter,nA(e._query,t))}}function Du(n,e="asc"){const t=e,i=al("orderBy",n);return Hy._create(i,t)}class $y extends zy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new $y(e,t,i)}_apply(e){return new Ai(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function Pu(n){return NR("limit",n),$y._create("limit",n,"F")}function g2(n,e,t){if(typeof(t=en(t))=="string"){if(t==="")throw new ft(Oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j_(e)&&t.indexOf("/")!==-1)throw new ft(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(on.fromString(t));if(!Ft.isDocumentKey(i))throw new ft(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Rx(n,new Ft(i))}if(t instanceof Tn)return Rx(n,t._key);throw new ft(Oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lm(t)}.`)}function y2(n,e){if(!Array.isArray(n)||n.length===0)throw new ft(Oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ck(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ft(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ft(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Wy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class mu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qo extends Ek{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(al("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ft(Oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qo._jsonSchema={type:Un("string",Qo._jsonSchemaVersion),bundleSource:Un("string","DocumentSnapshot"),bundleName:Un("string"),bundle:Un("string")};class Ah extends Qo{data(e={}){return super.data(e)}}class Xo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new mu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ah(this._firestore,this._userDataWriter,i.key,i,new mu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ft(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new mu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new mu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:RM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ft(Oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return es(61501,{type:n})}}Xo._jsonSchemaVersion="firestore/querySnapshot/1.0",Xo._jsonSchema={type:Un("string",Xo._jsonSchemaVersion),bundleSource:Un("string","QuerySnapshot"),bundleName:Un("string"),bundle:Un("string")};class AM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,i){this._verifyNotCommitted();const l=qp(e,this._firestore),u=Wy(l.converter,t,i),d=Ly(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Tr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=qp(e,this._firestore);let d;return d=typeof(t=en(t))=="string"||t instanceof km?_k(this._dataReader,"WriteBatch.update",u._key,t,i,l):wk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qp(e,this._firestore);return this._mutations=this._mutations.concat(new ym(t._key,Tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ft(Oe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qp(n,e){if((n=en(n)).firestore!==e)throw new ft(Oe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Ps(n){n=jr(n,Tn);const e=jr(n.firestore,Ja),t=Yu(e);return pM(t,n._key).then((i=>Ak(e,n,i)))}function Ns(n){n=jr(n,Ai);const e=jr(n.firestore,Ja),t=Yu(e),i=new Uy(e);return Nk(n._query),gM(t,n._query).then((l=>new Xo(e,i,n,l)))}function Ls(n,e,t){n=jr(n,Tn);const i=jr(n.firestore,Ja),l=Wy(n.converter,e,t),u=Xu(i);return Zu(i,[Ly(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Tr.none())])}function ua(n,e,t,...i){n=jr(n,Tn);const l=jr(n.firestore,Ja),u=Xu(l);let d;return d=typeof(e=en(e))=="string"||e instanceof km?_k(u,"updateDoc",n._key,e,t,i):wk(u,"updateDoc",n._key,e),Zu(l,[d.toMutation(n._key,Tr.exists(!0))])}function fr(n){return Zu(jr(n.firestore,Ja),[new ym(n._key,Tr.none())])}function Xr(n,e){const t=jr(n.firestore,Ja),i=Je(n),l=Wy(n.converter,e),u=Xu(n.firestore);return Zu(t,[Ly(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Tr.exists(!1))]).then((()=>i))}function Rk(n,...e){n=en(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||p2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(p2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof Tn)d=jr(n.firestore,Ja),p=hm(n._key.path),u={next:y=>{e[i]&&e[i](Ak(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=jr(n,Ai);d=jr(y.firestore,Ja),p=y._query;const x=new Uy(d);u={next:_=>{e[i]&&e[i](new Xo(d,x,y,_))},error:e[i+1],complete:e[i+2]},Nk(n._query)}const g=Yu(d);return fM(g,p,l,u)}function Zu(n,e){const t=Yu(n);return yM(t,e)}function Ak(n,e,t){const i=t.docs.get(e._key),l=new Uy(n);return new Qo(n,l,e._key,i,new mu(t.hasPendingWrites,t.fromCache),e.converter)}function b2(n){return n=jr(n,Ja),Yu(n),new AM(n,(e=>Zu(n,e)))}(function(e,t=!0){gR(ol),el(new po("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ja(new vR(i.getProvider("auth-internal")),new _R(d,i.getProvider("app-check-internal")),UR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),$a(m2,f2,e),$a(m2,f2,"esm2020")})();var MM="firebase",IM="12.8.0";$a(MM,IM,"app");const Mk="firebasestorage.googleapis.com",Ik="storageBucket",DM=120*1e3,PM=600*1e3;class En extends Za{constructor(e,t,i=0){super(Hp(e),`Firebase Storage: ${t} (${Hp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,En.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function Hp(n){return"storage/"+n}function Gy(){const n="An unknown error occurred, please check the error payload for server response.";return new En(Sn.UNKNOWN,n)}function LM(n){return new En(Sn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function OM(n){return new En(Sn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function BM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new En(Sn.UNAUTHENTICATED,n)}function VM(){return new En(Sn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function UM(n){return new En(Sn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function FM(){return new En(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zM(){return new En(Sn.CANCELED,"User canceled the upload/download.")}function qM(n){return new En(Sn.INVALID_URL,"Invalid URL '"+n+"'.")}function HM(n){return new En(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function $M(){return new En(Sn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ik+"' property when initializing the app?")}function WM(){return new En(Sn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function GM(){return new En(Sn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function KM(n){return new En(Sn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Dg(n){return new En(Sn.INVALID_ARGUMENT,n)}function Dk(){return new En(Sn.APP_DELETED,"The Firebase app was deleted.")}function YM(n){return new En(Sn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function xu(n,e){return new En(Sn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function nu(n){throw new En(Sn.INTERNAL_ERROR,"Internal error: "+n)}class kr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=kr.makeFromUrl(e,t)}catch{return new kr(e,"")}if(i.path==="")return i;throw HM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(_e){_e.path.charAt(_e.path.length-1)==="/"&&(_e.path_=_e.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(_e){_e.path_=decodeURIComponent(_e.path)}const x="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${_}/${x}/b/${l}/o${j}`,"i"),G={bucket:1,path:3},B=t===Mk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,D="([^?#]*)",te=new RegExp(`^https?://${B}/${l}/${D}`,"i"),Z=[{regex:p,indices:g,postModify:u},{regex:O,indices:G,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let _e=0;_e<Z.length;_e++){const Me=Z[_e],we=Me.regex.exec(e);if(we){const N=we[Me.indices.bucket];let T=we[Me.indices.path];T||(T=""),i=new kr(N,T),Me.postModify(i);break}}if(i==null)throw qM(e);return i}}class QM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function XM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...D){y||(y=!0,e.apply(null,D))}function _(D){l=setTimeout(()=>{l=null,n(O,g())},D)}function j(){u&&clearTimeout(u)}function O(D,...te){if(y){j();return}if(D){j(),x.call(null,D,...te);return}if(g()||d){j(),x.call(null,D,...te);return}i<64&&(i*=2);let Z;p===1?(p=2,Z=0):Z=(i+Math.random())*1e3,_(Z)}let G=!1;function B(D){G||(G=!0,j(),!y&&(l!==null?(D||(p=2),clearTimeout(l),_(0)):D||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,B(!0)},t),B}function JM(n){n(!1)}function ZM(n){return n!==void 0}function eI(n){return typeof n=="object"&&!Array.isArray(n)}function Ky(n){return typeof n=="string"||n instanceof String}function v2(n){return Yy()&&n instanceof Blob}function Yy(){return typeof Blob<"u"}function Pg(n,e,t,i){if(i<e)throw Dg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Dg(`Invalid value for '${n}'. Expected ${t} or less.`)}function Sm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Pk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Jo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Jo||(Jo={}));function tI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class sI{constructor(e,t,i,l,u,d,p,g,y,x,_,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=_,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((G,B)=>{this.resolve_=G,this.reject_=B,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new dh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Jo.NO_ERROR,g=u.getStatus();if(!p||tI(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Jo.ABORT;i(!1,new dh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new dh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());ZM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Gy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Dk():zM();d(g)}else{const g=FM();d(g)}};this.canceled_?t(!1,new dh(!1,null,!0)):this.backoffId_=XM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&JM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function nI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function aI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function iI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function oI(n,e,t,i,l,u,d=!0,p=!1){const g=Pk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return aI(x,e),nI(x,t),rI(x,u),iI(x,i),new sI(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function lI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function cI(...n){const e=lI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Yy())return new Blob(n);throw new En(Sn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function uI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function dI(n){if(typeof atob>"u")throw KM("base-64");return atob(n)}const Ha={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $p{constructor(e,t){this.data=e,this.contentType=t||null}}function hI(n,e){switch(n){case Ha.RAW:return new $p(Lk(e));case Ha.BASE64:case Ha.BASE64URL:return new $p(Ok(n,e));case Ha.DATA_URL:return new $p(fI(e),pI(e))}throw Gy()}function Lk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function mI(n){let e;try{e=decodeURIComponent(n)}catch{throw xu(Ha.DATA_URL,"Malformed data URL.")}return Lk(e)}function Ok(n,e){switch(n){case Ha.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw xu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ha.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw xu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dI(e)}catch(l){throw l.message.includes("polyfill")?l:xu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Bk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw xu(Ha.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=gI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function fI(n){const e=new Bk(n);return e.base64?Ok(Ha.BASE64,e.rest):mI(e.rest)}function pI(n){return new Bk(n).contentType}function gI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class oo{constructor(e,t){let i=0,l="";v2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(v2(this.data_)){const i=this.data_,l=uI(i,e,t);return l===null?null:new oo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new oo(i,!0)}}static getBlob(...e){if(Yy()){const t=e.map(i=>i instanceof oo?i.data_:i);return new oo(cI.apply(null,t))}else{const t=e.map(d=>Ky(d)?hI(Ha.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new oo(l,!0)}}uploadData(){return this.data_}}function Qy(n){let e;try{e=JSON.parse(n)}catch{return null}return eI(e)?e:null}function yI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function bI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Vk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function vI(n,e){return e}class wr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||vI}}let hh=null;function xI(n){return!Ky(n)||n.length<2?n:Vk(n)}function Uk(){if(hh)return hh;const n=[];n.push(new wr("bucket")),n.push(new wr("generation")),n.push(new wr("metageneration")),n.push(new wr("name","fullPath",!0));function e(u,d){return xI(d)}const t=new wr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new wr("size");return l.xform=i,n.push(l),n.push(new wr("timeCreated")),n.push(new wr("updated")),n.push(new wr("md5Hash",null,!0)),n.push(new wr("cacheControl",null,!0)),n.push(new wr("contentDisposition",null,!0)),n.push(new wr("contentEncoding",null,!0)),n.push(new wr("contentLanguage",null,!0)),n.push(new wr("contentType",null,!0)),n.push(new wr("metadata","customMetadata",!0)),hh=n,hh}function wI(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new kr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function _I(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return wI(i,n),i}function Fk(n,e,t){const i=Qy(e);return i===null?null:_I(n,i,t)}function kI(n,e,t,i){const l=Qy(e);if(l===null||!Ky(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,_=n.fullPath,j="/b/"+d(x)+"/o/"+d(_),O=Sm(j,t,i),G=Pk({alt:"media",token:y});return O+G})[0]}function jI(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const x2="prefixes",w2="items";function TI(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[x2])for(const l of t[x2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new kr(e,u));i.prefixes.push(d)}if(t[w2])for(const l of t[w2]){const u=n._makeStorageReference(new kr(e,l.name));i.items.push(u)}return i}function SI(n,e,t){const i=Qy(t);return i===null?null:TI(n,e,i)}class Xy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Jy(n){if(!n)throw Gy()}function EI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),u}return t}function NI(n,e){function t(i,l){const u=SI(n,e,l);return Jy(u!==null),u}return t}function CI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),kI(u,l,n.host,n._protocol)}return t}function Zy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=VM():l=BM():t.getStatus()===402?l=OM(n.bucket):t.getStatus()===403?l=UM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function RI(n){const e=Zy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=LM(n.path)),u.serverResponse=l.serverResponse,u}return t}function AI(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Sm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Xy(p,g,NI(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Zy(e),x}function MI(n,e,t){const i=e.fullServerUrl(),l=Sm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Xy(l,u,CI(n,t),d);return p.errorHandler=RI(e),p}function II(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=II(null,e)),i}function PI(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let Z="";for(let _e=0;_e<2;_e++)Z=Z+Math.random().toString().slice(2);return Z}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=DI(e,i,l),x=jI(y,t),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=oo.getBlob(_,i,j);if(O===null)throw WM();const G={name:y.fullPath},B=Sm(u,n.host,n._protocol),D="POST",te=n.maxUploadRetryTime,Y=new Xy(B,D,EI(n,t),te);return Y.urlParams=G,Y.headers=d,Y.body=O.uploadData(),Y.errorHandler=Zy(e),Y}class LI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Jo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Jo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw nu("cannot .send() more than once");if(_o(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw nu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw nu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw nu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw nu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class OI extends LI{initXhr(){this.xhr_.responseType="text"}}function eb(){return new OI}class il{constructor(e,t){this._service=e,t instanceof kr?this._location=t:this._location=kr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new il(e,t)}get root(){const e=new kr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Vk(this._location.path)}get storage(){return this._service}get parent(){const e=yI(this._location.path);if(e===null)return null;const t=new kr(this._location.bucket,e);return new il(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw YM(e)}}function BI(n,e,t){n._throwIfRoot("uploadBytes");const i=PI(n.storage,n._location,Uk(),new oo(e,!0),t);return n.storage.makeRequestWithTokens(i,eb).then(l=>({metadata:l,ref:n}))}function VI(n){const e={prefixes:[],items:[]};return zk(n,e).then(()=>e)}async function zk(n,e,t){const l=await UI(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await zk(n,e,l.nextPageToken)}function UI(n,e){e!=null&&typeof e.maxResults=="number"&&Pg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=AI(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,eb)}function FI(n){n._throwIfRoot("getDownloadURL");const e=MI(n.storage,n._location,Uk());return n.storage.makeRequestWithTokens(e,eb).then(t=>{if(t===null)throw GM();return t})}function zI(n,e){const t=bI(n._location.path,e),i=new kr(n._location.bucket,t);return new il(n.storage,i)}function qI(n){return/^[A-Za-z]+:\/\//.test(n)}function HI(n,e){return new il(n,e)}function qk(n,e){if(n instanceof tb){const t=n;if(t._bucket==null)throw $M();const i=new il(t,t._bucket);return e!=null?qk(i,e):i}else return e!==void 0?zI(n,e):n}function $I(n,e){if(e&&qI(e)){if(n instanceof tb)return HI(n,e);throw Dg("To use ref(service, url), the first argument must be a Storage instance.")}else return qk(n,e)}function _2(n,e){const t=e?.[Ik];return t==null?null:kr.makeFromBucketSpec(t,n)}function WI(n,e,t,i={}){n.host=`${e}:${t}`;const l=_o(e);l&&(Wg(`https://${n.host}/b`),Gg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:hw(u,n.app.options.projectId))}class tb{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Mk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DM,this._maxUploadRetryTime=PM,this._requests=new Set,l!=null?this._bucket=kr.makeFromBucketSpec(l,this._host):this._bucket=_2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=kr.makeFromBucketSpec(this._url,e):this._bucket=_2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new QM(Dk());{const d=oI(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const k2="@firebase/storage",j2="0.14.0";const Hk="storage";function Mh(n,e,t){return n=en(n),BI(n,e,t)}function T2(n){return n=en(n),VI(n)}function fo(n){return n=en(n),FI(n)}function vi(n,e){return n=en(n),$I(n,e)}function GI(n=Xg(),e){n=en(n);const i=rm(n,Hk).getImmediate({identifier:e}),l=cw("storage");return l&&KI(i,...l),i}function KI(n,e,t,i={}){WI(n,e,t,i)}function YI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new tb(t,i,l,e,ol)}function QI(){el(new po(Hk,YI,"PUBLIC").setMultipleInstances(!0)),$a(k2,j2,""),$a(k2,j2,"esm2020")}QI();const $k={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},sb=Qg($k),qo=Xw(sb),me=wM(sb),xi=GI(sb),XI=Qg($k,"secondary"),bP=Xw(XI),JI="EYdciKDOi3UYBLk1u8hHams5tmO2",Wk=b.createContext();function Br(){return b.useContext(Wk)}function ZI({children:n}){const[e,t]=b.useState(null),[i,l]=b.useState(!1),[u,d]=b.useState(!1),[p,g]=b.useState(null),[y,x]=b.useState(!0);b.useEffect(()=>{let Y=null;const Z=r4(qo,_e=>{if(t(_e),Y&&(Y(),Y=null),_e)if(_e.uid===JI)l(!0),d(!1),g(null),x(!1);else{l(!1);const Me=Bs(Yt(me,"clients"),bs("uid","==",_e.uid)),we=async()=>{const N=localStorage.getItem("mcf_clientId");if(N)try{const T=await Ps(Je(me,"clients",N));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Y=Rk(Me,async N=>{if(N.empty)await we();else{const T=N.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}x(!1)},async N=>{console.error("Error listening to client data:",N),await we(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{Z(),Y&&Y()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(Z=>Z?{...Z,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const Z=await Ps(Je(me,"clients",Y));if(Z.exists()){const _e={id:Z.id,...Z.data()};return d(!0),g(_e),_e}}catch(Z){console.error("resolveClient direct read failed:",Z)}if(e){const Z=Bs(Yt(me,"clients"),bs("uid","==",e.uid)),_e=await Ns(Z);if(!_e.empty){const Me={id:_e.docs[0].id,..._e.docs[0].data()};return d(!0),g(Me),Me}}return null},login:async(Y,Z,_e=!0)=>(await lx(qo,_e?gg:ry),await t4(qo,Y,Z)),signup:async(Y,Z,_e)=>{await lx(qo,gg);const Me=await e4(qo,Z.trim().toLowerCase(),_e),we=Me.user,N=Je(Yt(me,"clients")),T={uid:we.uid,name:Y.trim(),email:Z.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Ct.now()};await Ls(N,T),d(!0),g({id:N.id,...T});try{localStorage.setItem("mcf_clientId",N.id)}catch{}return Me},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return a4(qo)},resetPassword:Y=>ZC(qo,Y),loading:y};return r.jsx(Wk.Provider,{value:te,children:n})}const Gk=b.createContext();function Ia(){return b.useContext(Gk)}function eD({children:n}){const[e,t]=b.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=b.useState(()=>localStorage.getItem("accent")||"red");b.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),b.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Gk.Provider,{value:p,children:n})}const Kk=b.createContext();function gc(){return b.useContext(Kk)}const tD=["nutrition","personalBests","achievements","buddies","programmes"],sD=[5,10],nD=3,rD=1;function aD({children:n}){const{clientData:e,loading:t}=Br(),i=b.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!tD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:sD,FREE_RANDOMISER_WEEKLY_LIMIT:nD,FREE_HABIT_LIMIT:rD}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Kk.Provider,{value:i,children:n})}function iD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function oD({className:n=""}){const{isDark:e,toggleTheme:t}=Ia();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function lD(){const[n,e]=b.useState(""),[t,i]=b.useState(""),[l,u]=b.useState(!0),[d,p]=b.useState(""),[g,y]=b.useState(!1),[x,_]=b.useState(!1),[j,O]=b.useState(!1),{login:G,resetPassword:B,currentUser:D,isAdmin:te,isClient:Y,clientData:Z,loading:_e}=Br(),Me=or();if(b.useEffect(()=>{!_e&&D&&(te?Me("/dashboard"):Y?Me(iD(Z)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[_e,D,te,Y,Z,Me]),_e||D)return r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const we=async T=>{T.preventDefault(),p(""),y(!0);try{await G(n,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},N=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await B(n.trim()),O(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(oD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{_(!1),O(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:N,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:we,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Me("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ul({feature:n,children:e}){const{canAccess:t,loading:i}=gc();return i||t(n)?e:r.jsx(Z2,{to:"/upgrade",replace:!0})}function Ca({active:n}){const e=or(),{clientData:t}=Br(),{isPremium:i}=gc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Ra({children:n,onRefresh:e}){const[t,i]=b.useState(0),[l,u]=b.useState(!1),d=b.useRef(null),p=b.useRef(0),g=b.useRef(!1),y=b.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),x=b.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),_=b.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:_,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function ed(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Em=ed(60,100,100,85,96),Yk=ed(60,100,100,78,94),cD=ed(60,100,100,82,94);ed(60,50,50,38,46);const S2=ed(60,40,40,30,37),uD="/login/assets/first_workout-B8SFkzJX.PNG",dD="/login/assets/workouts_10-Z5R3u0xH.PNG",hD="/login/assets/workouts_25-CzxSlcAj.PNG",mD="/login/assets/workouts_50-BpzWup3V.PNG",fD="/login/assets/workouts_100-D7_r6tn1.PNG",pD="/login/assets/streak_2-CsRr-XA9.PNG",gD="/login/assets/streak_4-BHO09tbw.PNG",yD="/login/assets/streak_8-DX2UWMko.PNG",bD="/login/assets/first_pb-aVf_CNWy.PNG",vD="/login/assets/pbs_5-Cippawgg.PNG",xD="/login/assets/pbs_10-CZgGh9Kv.PNG",wD="/login/assets/pbs_100-C67b1wfS.PNG",_D="/login/assets/nutrition_7-CHVV11fj.PNG",kD="/login/assets/leaderboard_join-BLoId4Hz.PNG",jD="/login/assets/habits_7-Dvki70KO.PNG",qn=[{id:"first_workout",img:uD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:dD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:hD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:mD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:fD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:pD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:gD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:yD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:bD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:vD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:xD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:wD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:_D,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:kD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:jD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function TD({steps:n,onFinish:e,active:t}){const[i,l]=b.useState(0),[u,d]=b.useState(null),[p,g]=b.useState("below"),[y,x]=b.useState(!1),_=b.useRef(null),j=b.useRef(t);j.current=t,b.useEffect(()=>{t||l(0)},[t]),b.useEffect(()=>{if(!t)return;const Me=we=>we.preventDefault();return document.addEventListener("touchmove",Me,{passive:!1}),document.addEventListener("wheel",Me,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Me),document.removeEventListener("wheel",Me),document.body.style.overflow=""}},[t]);const O=b.useMemo(()=>t?n.filter(Me=>document.querySelector(Me.selector)):[],[t]),G=O[i],B=i===O.length-1,D=G?.selector,te=b.useCallback(()=>{if(!D)return;const Me=document.querySelector(D);if(!Me){d(null);return}const we=Me.getBoundingClientRect(),N=8;d({top:we.top-N,left:we.left-N,width:we.width+N*2,height:we.height+N*2});const T=window.innerHeight-we.bottom;g(T<260?"above":"below")},[D]);if(b.useEffect(()=>{if(!t||!D)return;x(!0);const Me=document.querySelector(D);if(Me){document.body.style.overflow="",Me.scrollIntoView({behavior:"smooth",block:"center"});let we=null,N=0,T=0;const M=60,V=()=>{T++;const R=Me.getBoundingClientRect(),Ie=Math.round(R.top);if(we!==null&&Ie===we?N++:N=0,we=Ie,N>=3||T>=M){j.current&&(document.body.style.overflow="hidden"),te(),x(!1);return}I=requestAnimationFrame(V)};let I;const L=setTimeout(()=>{I=requestAnimationFrame(V)},120);return()=>{clearTimeout(L),I&&cancelAnimationFrame(I),j.current&&(document.body.style.overflow="hidden")}}},[t,i,D,te]),b.useEffect(()=>{if(!t)return;const Me=()=>{_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(te)};return window.addEventListener("scroll",Me,!0),window.addEventListener("resize",Me),()=>{window.removeEventListener("scroll",Me,!0),window.removeEventListener("resize",Me),_.current&&cancelAnimationFrame(_.current)}},[t,te]),!t||!G||O.length===0)return null;const Y=()=>{B?e():l(i+1)},Z=()=>{i>0&&l(i-1)},_e=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Me=>{Me.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Me,we)=>r.jsx("span",{className:`st-dot${we===i?" active":""}${we<i?" done":""}`},we))}),r.jsx("h3",{className:"st-title",children:G.title}),r.jsx("p",{className:"st-body",children:G.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:Z,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:G.cta||(B?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:_e,children:"Skip tour"})]})]})}const E2=3,SD=5;function ru(n){return n.toISOString().split("T")[0]}const ED={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},ND={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Wp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Gp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function au(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function CD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function RD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Br(),{isDark:d,toggleTheme:p}=Ia(),{isPremium:g,FREE_HABIT_LIMIT:y}=gc(),x=or(),_=g?SD:y,[j,O]=b.useState({hours:0,minutes:0,seconds:0}),[G,B]=b.useState(0),[D,te]=b.useState(0),[Y,Z]=b.useState(""),[_e,Me]=b.useState(0),[we,N]=b.useState(0),[T,M]=b.useState(!1),[V,I]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[L,R]=b.useState(null),[Ie,mt]=b.useState(0),[$,ye]=b.useState(null),[Ue,Ye]=b.useState(!1),[X,P]=b.useState(!1),[ne,De]=b.useState(0),[ze,Be]=b.useState(E2),[Pe,ut]=b.useState(!1),[bt,ot]=b.useState(!1),[os,As]=b.useState(0),[ts,Rt]=b.useState([]),[Pt,qt]=b.useState([]),[It,Ms]=b.useState(null),[Vt,Ot]=b.useState(!1),se=b.useRef(null),[Ht,Dt]=b.useState([]),[zt,wt]=b.useState(null),[gt,Qt]=b.useState(null),rs=b.useRef(null),[vs,tn]=b.useState(0),[Ys,Qs]=b.useState(0),[ls,xs]=b.useState(0),[ge,Le]=b.useState(0),[je,st]=b.useState(null),We=b.useCallback((S,U="info")=>{st({message:S,type:U}),setTimeout(()=>st(null),4e3)},[]),[rt,pt]=b.useState([]),[J,re]=b.useState(!1),[Ze,Et]=b.useState(""),[tt,Nt]=b.useState(null),[Q,Ae]=b.useState(null),[Qe,dt]=b.useState(!1),[at,ss]=b.useState(new Set),[ns,F]=b.useState(new Set),[pe,Ne]=b.useState({}),[Ee,Ce]=b.useState({}),[xt,At]=b.useState({}),[ht,$t]=b.useState({}),[Bt,$s]=b.useState({}),[yn,dn]=b.useState({}),In=b.useRef(null),hn=b.useRef(null),sn=b.useRef({}),[ys,K]=b.useState([]),[he,ie]=b.useState(!1),be=b.useRef(null),[Ge,Tt]=b.useState([]),[Xt,Lt]=b.useState(""),[Wt,ps]=b.useState(!1),[Vs,Is]=b.useState(null),[C,q]=b.useState([]),[de,ke]=b.useState(null),[it,_t]=b.useState(!1),yt=b.useRef(!1),_s=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();b.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),b.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),b.useEffect(()=>{let S=t?.tourComplete||yt.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!S){const U=setTimeout(()=>_t(!0),600);return()=>clearTimeout(U)}},[T,t]),b.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>ot(!0),1500);return()=>clearTimeout(S)}}},[T,t]),b.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const U=JSON.parse(S);te(U.programmePct??0),Z(U.programmeName??""),Me(U.totalWorkouts??0),N(U.habitWeekPct??0),I(U.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),R(U.nutritionTargetData??null),mt(U.todayHabitsCount??0),ye(U.nextSession??null),Ye(U.hasProgramme??!1),P(U.programmeComplete??!1),De(U.weeklyWorkouts??0),Be(U.weeklyWorkoutTarget??E2),As(U.pbCount??0),Rt(U.topPBs??[]),qt(U.leaderboardTop3??[]),Dt(U.unlockedBadges??[]),rs.current=U.unlockedBadges??[],tn(U.streakWeeks??0),M(!0)}}catch{}},[t]),b.useEffect(()=>{t?.photoURL&&Ms(t.photoURL),t?.weeklyWorkoutTarget&&Be(t.weeklyWorkoutTarget)},[t]),b.useEffect(()=>{if(!t)return;const S=Bs(Yt(me,"notifications"),bs("toId","==",t.id)),U=Rk(S,Te=>{const Xe=Te.docs.map(He=>({id:He.id,...He.data()}));Xe.sort((He,nt)=>{const Ke=He.createdAt?.toMillis?.()||0;return(nt.createdAt?.toMillis?.()||0)-Ke}),K(Xe.slice(0,50))},Te=>{console.error("Notification listener error:",Te),Te.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>U()},[t]),b.useEffect(()=>{const S=U=>{be.current&&!be.current.contains(U.target)&&ie(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),b.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[U,Te,Xe]=await Promise.all([Ns(Bs(Yt(me,"buddies"),bs("user1","==",S))),Ns(Bs(Yt(me,"buddies"),bs("user2","==",S))),Ns(Yt(me,"clients"))]),He=new Set;[...U.docs,...Te.docs].forEach(Ke=>{const lt=Ke.data();He.add(lt.user1===S?lt.user2:lt.user1)});const nt={};Xe.docs.forEach(Ke=>{nt[Ke.id]=Ke.data()}),Tt(Array.from(He).filter(Ke=>nt[Ke]).map(Ke=>({id:Ke,name:nt[Ke].name,photoURL:nt[Ke].photoURL||null})))}catch(U){console.error("Error loading buddies for mentions:",U)}})()},[t]);const Gt=ys.filter(S=>!S.read).length,vn=async()=>{const S=ys.filter(Te=>!Te.read);if(!S.length)return;const U=b2(me);S.forEach(Te=>U.update(Je(me,"notifications",Te.id),{read:!0})),await U.commit()},gr=async()=>{if(!ys.length)return;const S=b2(me);ys.forEach(U=>S.delete(Je(me,"notifications",U.id))),await S.commit()},yr=async(S,U,Te={})=>{if(!(!t||S===t.id))try{await Xr(Yt(me,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:U,read:!1,createdAt:_r(),...Te})}catch(Xe){console.error("Notification create error:",Xe),Xe.code==="permission-denied"&&We("Notifications blocked  check Firestore rules","error")}},$n=(S,U)=>{const Te=U==="compose"?In.current?.selectionStart:null,He=(Te!=null?S.slice(0,Te):S).match(/@(\w*)$/);if(He){ps(!0),Is(U),Lt(He[1].toLowerCase());const nt=Ge.filter(Ke=>Ke.name&&Ke.name.toLowerCase().includes(He[1].toLowerCase())).slice(0,5);q(nt)}else ps(!1),q([])},ma=(S,U)=>{if(U==="compose"){const Te=In.current,Xe=Ze,He=Te?.selectionStart??Xe.length,nt=Xe.slice(0,He),Ke=Xe.slice(He),lt=nt.replace(/@\w*$/,`@${S.name} `);Et(lt+Ke),setTimeout(()=>{Te?.focus(),Te.selectionStart=Te.selectionEnd=lt.length},0)}else{const Xe=(Ee[U]||"").replace(/@\w*$/,`@${S.name} `);Ce(He=>({...He,[U]:Xe}))}ps(!1),q([])},Vr=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((Te,Xe)=>Te.startsWith("@")&&Ge.some(He=>Te.trim()===`@${He.name}`)?r.jsx("span",{className:"mention-highlight",children:Te.trim()},Xe):Te),Wn=async S=>{const U=S.target.files?.[0];if(!(!U||!t)){if(!U.type.startsWith("image/")){We("Please select an image file","error");return}if(U.size>5*1024*1024){We("Image must be under 5MB","error");return}Ot(!0);try{const Te=await new Promise(nt=>{const Ke=new Image;Ke.onload=()=>{const lt=document.createElement("canvas"),jt=400;let us=Ke.width,as=Ke.height;us>as?(as=as/us*jt,us=jt):(us=us/as*jt,as=jt),lt.width=us,lt.height=as,lt.getContext("2d").drawImage(Ke,0,0,us,as),lt.toBlob(ws=>nt(ws),"image/jpeg",.75)},Ke.src=URL.createObjectURL(U)}),Xe=vi(xi,`profilePhotos/${t.id}`);await Mh(Xe,Te);const He=await fo(Xe);await ua(Je(me,"clients",t.id),{photoURL:He}),Ms(He),l({photoURL:He}),We("Profile photo updated!","success")}catch(Te){console.error("Photo upload error:",Te),We("Failed to upload photo","error")}Ot(!1),se.current&&(se.current.value="")}};b.useEffect(()=>{const S=()=>{const Te=new Date,Xe=new Date(Te);Xe.setHours(23,59,59,999);const He=Xe-Te,nt=Math.floor(He/(1e3*60*60)),Ke=Math.floor(He%(1e3*60*60)/(1e3*60)),lt=Math.floor(He%(1e3*60)/1e3);O({hours:nt,minutes:Ke,seconds:lt}),B(60-lt)};S();const U=setInterval(S,1e3);return()=>clearInterval(U)},[]),b.useEffect(()=>{const S=setInterval(()=>{Le(U=>(U+1)%Wp.length)},8e3);return()=>clearInterval(S)},[]),b.useEffect(()=>{if(!n||!t)return;(async()=>{let U=null,Te=0,Xe=[],He=!1,nt=null;try{const Ke=ru(new Date),lt=await Ps(Je(me,"clientProgrammes",t.id));if(lt.exists()){const _n=lt.data(),Fn=ED[_n.templateId];if(Ye(!0),Fn){const Cr=_n.completedSessions||{},Rr=Object.keys(Cr).length,So=Fn.duration*Fn.daysPerWeek;te(So>0?Math.round(Rr/So*100):0);const Pa=_n.templateId.replace(/_/g," ").replace(/\b\w/g,pa=>pa.toUpperCase());Z(Pa);const Zn=ND[_n.templateId];let ti=!1;for(let pa=1;pa<=Fn.duration&&!ti;pa++)for(let cr=0;cr<Fn.daysPerWeek&&!ti;cr++)Cr[`w${pa}d${cr}`]||(ye({week:pa,dayIdx:cr,label:Zn?.[cr]||`Day ${cr+1}`}),ti=!0);ti||(P(!0),He=!0)}}const jt=Yt(me,"workoutLogs"),us=Bs(jt,bs("clientId","==",t.id));U=await Ns(us),Me(U.docs.length);const as=new Date,ws=as.getDay(),ln=ws===0?6:ws-1,mn=new Date(as);mn.setDate(as.getDate()-ln),mn.setHours(0,0,0,0);const zs=mn.getTime(),an=U.docs.filter(_n=>{const Fn=_n.data().completedAt;return Fn?(Fn.toDate?Fn.toDate().getTime():new Date(Fn).getTime())>=zs:!1}).length;De(an);const Nn=Yt(me,"habitLogs"),wn=Bs(Nn,bs("clientId","==",t.id),bs("date","==",Ke)),Xn=await Ns(wn);let Jn=0;if(!Xn.empty){const _n=Xn.docs[0].data().habits||{};Jn=Math.min(Object.values(_n).filter(Boolean).length,_)}N(Math.round(Jn/_*100)),mt(Jn);const Nr=await Ps(Je(me,"nutritionTargets",t.id));Nr.exists()&&(R(Nr.data()),nt=Nr.data());const vr=await Ps(Je(me,"nutritionLogs",`${t.id}_${Ke}`));if(vr.exists()){const Fn=(vr.data().entries||[]).reduce((Cr,Rr)=>({protein:Cr.protein+(Rr.protein||0),carbs:Cr.carbs+(Rr.carbs||0),fats:Cr.fats+(Rr.fats||0),calories:Cr.calories+(Rr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});I(Fn)}}catch(Ke){console.error("Error loading dashboard stats:",Ke)}try{let Ke=[];const lt=await Ps(Je(me,"coreBuddyPBs",t.id));if(lt.exists()){const jt=lt.data().exercises||{};As(Object.keys(jt).length),Te=Object.keys(jt).length,Ke=Object.entries(jt).sort(([,us],[,as])=>(as.weight||0)-(us.weight||0)).slice(0,3).map(([us,as])=>({name:us,weight:as.weight,reps:as.reps}))}Xe=Ke,Rt(Ke)}catch(Ke){console.error("PB fetch error:",Ke)}try{const Ke=Yt(me,"clients"),lt=Bs(Ke,bs("leaderboardOptIn","==",!0)),us=(await Ns(lt)).docs.map(as=>({id:as.id,name:as.data().name,photoURL:as.data().photoURL||null}));qt(us.slice(0,3))}catch(Ke){console.error("Leaderboard preview error:",Ke)}try{let Ke=0;if(U){const zs=U.docs.map(an=>an.data().date).filter(Boolean).sort().reverse();if(zs.length>0){const an=new Date;let Nn=new Date(an);e:for(let wn=0;wn<52;wn++){const Xn=new Date(Nn),Jn=Xn.getDay(),Nr=Jn===0?6:Jn-1;Xn.setDate(Xn.getDate()-Nr),Xn.setHours(0,0,0,0);const vr=new Date(Xn);vr.setDate(vr.getDate()+7);const _n=ru(Xn),Fn=ru(vr);if(zs.some(Rr=>Rr>=_n&&Rr<Fn))Ke++;else{if(wn>0)break e;break}Nn.setDate(Nn.getDate()-7)}}}tn(Ke);let lt=0;for(let zs=0;zs<30;zs++){const an=new Date;an.setDate(an.getDate()-zs);const Nn=ru(an);try{const wn=await Ns(Bs(Yt(me,"habitLogs"),bs("clientId","==",t.id),bs("date","==",Nn)));if(wn.empty)break;{const Xn=wn.docs[0].data().habits||{};if(Object.values(Xn).filter(Boolean).length>=_)lt++;else break}}catch{break}}Qs(lt);let jt=0;for(let zs=0;zs<30;zs++){const an=new Date;an.setDate(an.getDate()-zs);const Nn=ru(an);try{const wn=await Ps(Je(me,"nutritionLogs",`${t.id}_${Nn}`));if(wn.exists()&&(wn.data().entries||[]).length>0)if(nt){const Jn=(wn.data().entries||[]).reduce((Nr,vr)=>({protein:Nr.protein+(vr.protein||0),carbs:Nr.carbs+(vr.carbs||0),fats:Nr.fats+(vr.fats||0)}),{protein:0,carbs:0,fats:0});if(Jn.protein>=(nt.protein||0)&&Jn.carbs>=(nt.carbs||0)&&Jn.fats>=(nt.fats||0))jt++;else break}else jt++;else break}catch{break}}xs(jt);const us=U?U.docs.length:0,as=[],ws=zs=>as.push(zs);us>=1&&ws("first_workout"),us>=10&&ws("workouts_10"),us>=25&&ws("workouts_25"),us>=50&&ws("workouts_50"),us>=100&&ws("workouts_100"),Ke>=2&&ws("streak_2"),Ke>=4&&ws("streak_4"),Ke>=8&&ws("streak_8"),Te>=1&&ws("first_pb"),Te>=5&&ws("pbs_5"),Te>=10&&ws("pbs_10"),Te>=100&&ws("pbs_100"),jt>=7&&ws("nutrition_7"),t.leaderboardOptIn&&ws("leaderboard_join"),lt>=7&&ws("habits_7"),Dt(as);const ln=rs.current;if(ln!==null){const zs=as.filter(an=>!ln.includes(an));if(zs.length>0){const an=qn.find(Nn=>Nn.id===zs[zs.length-1]);an&&setTimeout(()=>Qt(an),600)}}rs.current=as;const mn={};as.forEach(zs=>{mn[zs]={unlockedAt:new Date().toISOString()}}),Ls(Je(me,"achievements",t.id),{badges:mn,progress:{streakWeeks:Ke,pbCount:Te,nutritionStreak:jt,habitStreak:lt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(Ke){console.error("Achievement computation error:",Ke)}M(!0)})()},[n,t,_]),b.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:D,programmeName:Y,totalWorkouts:_e,habitWeekPct:we,nutritionTotals:V,nutritionTargetData:L,todayHabitsCount:Ie,nextSession:$,hasProgramme:Ue,programmeComplete:X,weeklyWorkouts:ne,weeklyWorkoutTarget:ze,pbCount:os,topPBs:ts,leaderboardTop3:Pt,unlockedBadges:Ht,streakWeeks:vs}))}catch{}},[T,D,Y,_e,we,V,L,Ie,$,Ue,X,ne,ze,os,ts,Pt,Ht,vs,t]);const Mi=b.useCallback(async()=>{if(yt.current=!0,_t(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await ua(Je(me,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),ei=b.useCallback(async S=>{if(Be(S),ut(!1),ot(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await ua(Je(me,"clients",t.id),{weeklyWorkoutTarget:S})}catch(U){console.error("Failed to save weekly target:",U)}}},[t]),Er=S=>{const U=S.currentTarget,Te=U.querySelector(".ripple");Te&&Te.remove();const Xe=U.getBoundingClientRect(),He=Math.max(Xe.width,Xe.height),nt=S.clientX-Xe.left-He/2,Ke=S.clientY-Xe.top-He/2,lt=document.createElement("span");lt.className="ripple",lt.style.cssText=`width:${He}px;height:${He}px;left:${nt}px;top:${Ke}px;`,U.appendChild(lt),setTimeout(()=>lt.remove(),600)},Da=t?.name?.split(" ")[0]||"there",Ii=Math.min(Math.round(ne/ze*100),100),Zr=[{label:"Programme",value:`${D}%`,pct:D,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${ne}/${ze}`,pct:Ii,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${we}%`,pct:we,color:"var(--color-primary)",size:"normal"}],Ur=S=>!L||!L[S]?0:Math.min(Math.round(V[S]/L[S]*100),100),Gn=(()=>{const S=new Date().getHours();return T&&Ie>=_&&V.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:S>=5&&S<12?{main:"Rise and grind,",sub:"let's get after it!"}:S>=12&&S<17?{main:"Oye",sub:"crack on and make it count!"}:S>=17&&S<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Kn=T?g&&Ue&&$&&!X?{label:"NEXT SESSION",message:`Week ${$.week}, Day ${$.dayIdx+1}  ${$.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:D,ringLabel:`${D}%`}:Ie<_?{label:"DAILY HABITS",message:`${Ie}/${_} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:we,ringLabel:`${Ie}/${_}`}:g&&V.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!Ue?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&X?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,xn=b.useCallback(async()=>{if(t){re(!0);try{const S=await Ns(Bs(Yt(me,"posts"),bs("authorId","==",t.id),Du("createdAt","desc"),Pu(30)));pt(S.docs.map(Te=>({id:Te.id,...Te.data()})));const U=await Ns(Bs(Yt(me,"postLikes"),bs("userId","==",t.id)));ss(new Set(U.docs.map(Te=>Te.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{re(!1)}}},[t]);b.useEffect(()=>{T&&t&&xn()},[T,t,xn]);const Fr=S=>{const U=S.target.files?.[0];if(U){if(!U.type.startsWith("image/")){We("Please select an image file","error");return}if(U.size>10*1024*1024){We("Image must be under 10MB","error");return}Nt(U),Ae(URL.createObjectURL(U))}},br=()=>{Nt(null),Q&&URL.revokeObjectURL(Q),Ae(null),hn.current&&(hn.current.value="")},fa=async()=>{if(!(!Ze.trim()&&!tt||Qe||!t)){dt(!0);try{let S=null;if(tt){const Xe=await CD(tt),He=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,nt=vi(xi,`postImages/${t.id}/${He}`);await Mh(nt,Xe),S=await fo(nt)}await Xr(Yt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ze.trim(),type:S?"image":"text",imageURL:S||null,createdAt:_r(),likeCount:0,commentCount:0});const Te=Ze.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Te){const Xe=new Set;Te.forEach(He=>{const nt=He.slice(1).trim(),Ke=Ge.find(lt=>lt.name&&lt.name.toLowerCase()===nt.toLowerCase());Ke&&!Xe.has(Ke.id)&&(Xe.add(Ke.id),yr(Ke.id,"mention",{}))})}Et(""),br(),In.current&&(In.current.style.height="auto"),await xn(),We("Posted!","success")}catch(S){console.error("Error posting:",S),We(S?.message||"Failed to post","error")}finally{dt(!1)}}},lr=async S=>{if(window.confirm("Delete this post?"))try{await fr(Je(me,"posts",S)),pt(U=>U.filter(Te=>Te.id!==S)),We("Post deleted","info")}catch(U){console.error("Delete error:",U),We("Failed to delete","error")}},z=async S=>{if(!t)return;const U=t.id,Te=`${S}_${U}`,Xe=at.has(S),He=new Set(at);Xe?He.delete(S):He.add(S),ss(He),pt(nt=>nt.map(Ke=>Ke.id===S?{...Ke,likeCount:Math.max(0,(Ke.likeCount||0)+(Xe?-1:1))}:Ke));try{if(Xe)await fr(Je(me,"postLikes",Te)),await ua(Je(me,"posts",S),{likeCount:Yo(-1)});else{await Ls(Je(me,"postLikes",Te),{postId:S,userId:U,createdAt:_r()}),await ua(Je(me,"posts",S),{likeCount:Yo(1)});const nt=rt.find(Ke=>Ke.id===S);nt&&yr(nt.authorId,"like",{postId:S})}}catch(nt){console.error("Like error:",nt),xn()}},le=async S=>{try{const U=await Ns(Bs(Yt(me,"postComments"),bs("postId","==",S),Du("createdAt","asc"),Pu(50)));Ne(Te=>({...Te,[S]:U.docs.map(Xe=>({id:Xe.id,...Xe.data()}))}))}catch(U){console.error("Error loading comments:",U)}},ue=S=>{const U=new Set(ns);U.has(S)?U.delete(S):(U.add(S),pe[S]||le(S)),F(U)},Fe=async S=>{const U=(Ee[S]||"").trim(),Te=Bt[S];if(!(!U&&!Te||!t)){At(Xe=>({...Xe,[S]:!0}));try{let Xe=null;if(Te){const jt=vi(xi,`comment-images/${Date.now()}_${Te.name}`);await Mh(jt,Te),Xe=await fo(jt)}const He={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:U||"",createdAt:_r()};Xe&&(He.imageURL=Xe);const nt=ht[S];nt&&(He.replyToId=nt.id,He.replyToName=nt.authorName),await Xr(Yt(me,"postComments"),He),await ua(Je(me,"posts",S),{commentCount:Yo(1)});const Ke=rt.find(jt=>jt.id===S);Ke&&yr(Ke.authorId,"comment",{postId:S});const lt=U.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(lt){const jt=new Set;lt.forEach(us=>{const as=us.slice(1).trim(),ws=Ge.find(ln=>ln.name&&ln.name.toLowerCase()===as.toLowerCase());ws&&!jt.has(ws.id)&&(jt.add(ws.id),yr(ws.id,"mention",{postId:S}))})}Ce(jt=>({...jt,[S]:""})),$s(jt=>({...jt,[S]:null})),dn(jt=>({...jt,[S]:null})),$t(jt=>({...jt,[S]:null})),sn.current[S]&&(sn.current[S].value=""),pt(jt=>jt.map(us=>us.id===S?{...us,commentCount:(us.commentCount||0)+1}:us)),await le(S)}catch(Xe){console.error("Comment error:",Xe),We("Failed to comment","error")}finally{At(Xe=>({...Xe,[S]:!1}))}}},Se=async(S,U)=>{try{await fr(Je(me,"postComments",U)),await ua(Je(me,"posts",S),{commentCount:Yo(-1)}),Ne(Te=>({...Te,[S]:(Te[S]||[]).filter(Xe=>Xe.id!==U)})),pt(Te=>Te.map(Xe=>Xe.id===S?{...Xe,commentCount:Math.max((Xe.commentCount||1)-1,0)}:Xe))}catch(Te){console.error("Delete comment error:",Te),We("Failed to delete comment","error")}},et=(S,U)=>{const Te=U.target.files?.[0];if(!Te)return;if(Te.size>5*1024*1024){We("Image must be under 5MB","error");return}$s(He=>({...He,[S]:Te}));const Xe=new FileReader;Xe.onload=He=>dn(nt=>({...nt,[S]:He.target.result})),Xe.readAsDataURL(Te)},vt=S=>{$s(U=>({...U,[S]:null})),dn(U=>({...U,[S]:null})),sn.current[S]&&(sn.current[S].value="")},Kt=S=>{Et(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",$n(S.target.value,"compose")},cs=(S,U)=>{Ce(Te=>({...Te,[S]:U})),$n(U,S)};return r.jsx(Ra,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:be,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{ie(!he),he||vn()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Gt>0&&r.jsx("span",{className:"header-notif-badge",children:Gt>9?"9+":Gt})]}),he&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ys.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:gr,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:ys.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ys.map(S=>r.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(ie(!1),S.type==="buddy_request"||S.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!ns.has(S.postId)){const U=new Set(ns);U.add(S.postId),F(U),pe[S.postId]||le(S.postId)}setTimeout(()=>{const U=document.getElementById(`post-${S.postId}`);U&&U.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&x(`/client/core-buddy/profile/${S.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?r.jsx("img",{src:S.fromPhotoURL,alt:""}):r.jsx("span",{children:(S.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Gp(S.createdAt)})]})]},S.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Em.map((S,U)=>{const Te=U<G;return r.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${Te?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},U)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>se.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:It||"/Logo.webp",alt:It?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Vt?" uploading":""}`,children:Vt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:se,type:"file",accept:"image/*",onChange:Wn,style:{display:"none"}})]}),!It&&!Vt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>se.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[Wp[ge].text," ",r.jsx("strong",{children:Wp[ge].bold})]},ge)]}),r.jsx("div",{className:"cb-stats-row",children:Zr.map(S=>{const U=(S.size==="large",38),Te=2*Math.PI*U,Xe=Te-S.pct/100*Te,He=S.editable;return r.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:`cb-stat-ring${He?" cb-stat-tappable":""}${He&&bt?" cb-stat-hint":""}`,onClick:He?()=>{ut(!0),ot(!1)}:void 0,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:U}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:U,style:{stroke:S.color},strokeDasharray:Te,strokeDashoffset:Xe})]}),r.jsx("span",{className:"cb-stat-value",style:{color:S.color},children:S.value})]}),r.jsx("span",{className:"cb-stat-label",children:S.label})]},S.label)})}),Pe&&r.jsx("div",{className:"cb-target-overlay",onClick:()=>ut(!1),children:r.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[r.jsx("h4",{children:"Weekly workout goal"}),r.jsx("p",{children:"How many sessions per week?"}),r.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>r.jsx("button",{className:`cb-target-option${S===ze?" active":""}`,onClick:()=>ei(S),children:S},S))})]})}),r.jsxs("p",{className:"cb-coach-msg",children:[Gn.main," ",r.jsx("strong",{children:Da}),"  ",Gn.sub]}),Kn&&r.jsxs("button",{className:"cb-nudge-card",onClick:Kn.action||void 0,style:Kn.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Kn.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Kn.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Kn.label}),r.jsx("span",{className:"cb-nudge-title",children:Kn.message}),Kn.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Kn.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[g&&r.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:S=>{Er(S),x("/client/core-buddy/nutrition")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsx("h3",{children:"Today's Nutrition"})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ur("protein"),color:"var(--color-primary)"},{label:"C",pct:Ur("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ur("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Ur("calories"),color:"var(--color-primary)"}].map(S=>{const Te=2*Math.PI*38,Xe=Te-S.pct/100*Te;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:Te,strokeDashoffset:Xe})]}),r.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:S=>{Er(S),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ne," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[_e," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-grid-row${g?"":" cb-grid-single"}`,children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:S=>{Er(S),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_},(S,U)=>r.jsx("span",{className:`cb-habit-dot${U<Ie?" done":""}`},U))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[Ie,"/",_," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:S=>{Er(S),x("/client/personal-bests?mode=corebuddy")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"PBs"}),ts.length>0?r.jsx("div",{className:"cb-pb-preview",children:ts.slice(0,2).map(S=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:S.name}),r.jsxs("span",{className:"cb-pb-value",children:[S.weight,"kg"]})]},S.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{Er(S),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),Pt.length>0?r.jsx("div",{className:"cb-lb-preview",children:Pt.map((S,U)=>{const Te=["#FFD700","#A8B4C0","#CD7F32"][U],Xe=S.name?S.name.split(" ").map(nt=>nt[0]).join("").slice(0,2).toUpperCase():"?",He=S.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${He?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Te},children:S.photoURL?r.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Xe})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Te},children:["#",U+1]})]},S.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{Er(S),x("/client/core-buddy/buddies")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Buddies"}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("div",{className:"cb-achievements-section",children:[r.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),r.jsx("div",{className:"cb-badges-scroll",children:qn.map(S=>{const U=Ht.includes(S.id);return r.jsx("button",{className:`cb-badge${U?" unlocked":" locked"}`,onClick:()=>wt(S),children:r.jsx("img",{src:S.img,alt:S.name,className:"cb-badge-img"})},S.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[Ht.length,"/",qn.length," unlocked"]})]}),g&&r.jsxs("div",{className:"cb-journey-section",children:[r.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:It?r.jsx("img",{src:It,alt:""}):r.jsx("span",{children:au(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:In,placeholder:"Share your progress... (use @ to mention)",value:Ze,onChange:Kt,rows:1,maxLength:500}),Wt&&Vs==="compose"&&C.length>0&&r.jsx("div",{className:"mention-dropdown",children:C.map(S=>r.jsxs("button",{className:"mention-option",onClick:()=>ma(S,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:S.photoURL?r.jsx("img",{src:S.photoURL,alt:""}):r.jsx("span",{children:au(S.name)})}),r.jsx("span",{children:S.name})]},S.id))}),Q&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Q,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:br,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>hn.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:hn,type:"file",accept:"image/*",onChange:Fr,hidden:!0}),(Ze.trim()||tt)&&r.jsx("button",{className:"journey-post-btn",onClick:fa,disabled:Qe,children:Qe?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),J?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):rt.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:rt.map(S=>r.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?r.jsx("img",{src:S.authorPhotoURL,alt:""}):r.jsx("span",{children:au(S.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:S.authorName}),r.jsx("span",{className:"journey-post-time",children:Gp(S.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>lr(S.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(U=>`${U.value} ${U.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(qn.find(U=>U.name===S.metadata.title)||qn.find(U=>S.metadata.badges?.includes(U.name)))?.img||"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),(S.metadata.badgeDesc||(qn.find(U=>U.name===S.metadata.title)||qn.find(U=>S.metadata.badges?.includes(U.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc||(qn.find(U=>U.name===S.metadata.title)||qn.find(U=>S.metadata.badges?.includes(U.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(U=>`${U.value} ${U.label}`).join("    ")}),S.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[S.content&&r.jsx("p",{className:"journey-post-content",children:Vr(S.content)}),S.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${at.has(S.id)?" liked":""}`,onClick:()=>z(S.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:at.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:S.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${ns.has(S.id)?" active":""}`,onClick:()=>ue(S.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:S.commentCount||0})]})]}),ns.has(S.id)&&r.jsxs("div",{className:"journey-comments",children:[pe[S.id]?.length>0?pe[S.id].map(U=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:U.authorPhotoURL?r.jsx("img",{src:U.authorPhotoURL,alt:""}):r.jsx("span",{children:au(U.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:U.authorName}),U.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),U.replyToName]}),U.content&&r.jsx("span",{className:"journey-comment-text",children:Vr(U.content)}),U.imageURL&&r.jsx("img",{className:"journey-comment-image",src:U.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Gp(U.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>$t(Te=>({...Te,[S.id]:{id:U.id,authorName:U.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Se(S.id,U.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},U.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),ht[S.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:ht[S.id].authorName})]}),r.jsx("button",{onClick:()=>$t(U=>({...U,[S.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),yn[S.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:yn[S.id],alt:"Preview"}),r.jsx("button",{onClick:()=>vt(S.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>sn.current[S.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:U=>{sn.current[S.id]=U},type:"file",accept:"image/*",onChange:U=>et(S.id,U),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Ee[S.id]||"",onChange:U=>cs(S.id,U.target.value),onKeyDown:U=>{U.key==="Enter"&&Fe(S.id)},maxLength:300}),Wt&&Vs===S.id&&C.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:C.map(U=>r.jsxs("button",{className:"mention-option",onClick:()=>ma(U,S.id),children:[r.jsx("div",{className:"mention-option-avatar",children:U.photoURL?r.jsx("img",{src:U.photoURL,alt:""}):r.jsx("span",{children:au(U.name)})}),r.jsx("span",{children:U.name})]},U.id))}),r.jsx("button",{onClick:()=>Fe(S.id),disabled:!(Ee[S.id]||"").trim()&&!Bt[S.id]||xt[S.id],children:xt[S.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!g&&r.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>x("/upgrade"),children:[r.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),r.jsx("span",{className:"cb-upgrade-cta-sub",children:"Nutrition, buddies, achievements & more"}),r.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),zt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>wt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:S=>S.stopPropagation(),children:[r.jsx("img",{src:zt.img,alt:zt.name,className:`cb-badge-overlay-img${Ht.includes(zt.id)?"":" cb-badge-overlay-img-locked"}`}),Ht.includes(zt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>wt(null),children:"Tap to close"})]})}),r.jsx(Ca,{active:"home"}),je&&r.jsxs("div",{className:`toast-notification ${je.type}`,children:[je.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),je.message]}),r.jsx(TD,{steps:_s,active:it,onFinish:Mi}),gt&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>Qt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(S,U)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][U%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},U))}),r.jsxs("div",{className:"cb-celebration-content",onClick:S=>S.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:gt.img,alt:gt.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:gt.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>Qt(null),children:"Tap to continue"})]})]})]})})}const Kp=new Map;function wa(){return new Date().toISOString().split("T")[0]}const N2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],AD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function MD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=or(),[g,y]=b.useState("loading"),[x,_]=b.useState(null),[j,O]=b.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,B]=b.useState(null),[D,te]=b.useState(wa()),[Y,Z]=b.useState({entries:[],water:0}),[_e,Me]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[we,N]=b.useState(!1),[T,M]=b.useState(!1),[V,I]=b.useState(()=>{const C=new Date;return{year:C.getFullYear(),month:C.getMonth()}}),[L,R]=b.useState(!1),[Ie,mt]=b.useState(()=>{const C=new Date;return{year:C.getFullYear(),month:C.getMonth()}}),[$,ye]=b.useState(!1),[Ue,Ye]=b.useState(MD),[X,P]=b.useState(null),[ne,De]=b.useState(null),[ze,Be]=b.useState(!1),[Pe,ut]=b.useState(null),[bt,ot]=b.useState(""),[os,As]=b.useState(!1),[ts,Rt]=b.useState(""),[Pt,qt]=b.useState([]),[It,Ms]=b.useState(!1),[Vt,Ot]=b.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[se,Ht]=b.useState(null),[Dt,zt]=b.useState("100"),[wt,gt]=b.useState(0),[Qt,rs]=b.useState("weight"),[vs,tn]=b.useState(0),[Ys,Qs]=b.useState(null);b.useRef(null);const ls=b.useRef(!1),xs=b.useRef(null),ge=b.useRef(null),Le=b.useRef(null),je=b.useCallback((C,q="info")=>{Qs({message:C,type:q}),setTimeout(()=>Qs(null),3e3)},[]);b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await Ps(Je(me,"nutritionTargets",t.id));q.exists()?(_(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await Ps(Je(me,"nutritionLogs",`${t.id}_${D}`));if(q.exists()){const de=q.data();Z({entries:de.entries||[],water:de.water||0})}else Z({entries:[],water:0})}catch(q){console.error("Error loading log:",q),Z({entries:[],water:0})}})()},[t?.id,D]),b.useEffect(()=>{const C=Y.entries.reduce((q,de)=>({protein:q.protein+(de.protein||0),carbs:q.carbs+(de.carbs||0),fats:q.fats+(de.fats||0),calories:q.calories+(de.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Me(C)},[Y.entries]);const st=async C=>{try{await Ls(Je(me,"nutritionLogs",`${t.id}_${D}`),{clientId:t.id,date:D,entries:C.entries,water:C.water,updatedAt:Ct.now()})}catch(q){console.error("Error saving nutrition log:",q)}},We=D===wa(),rt=(C,q)=>new Date(C,q+1,0).getDate(),pt=(C,q)=>new Date(C,q,1).getDay(),J=C=>{if(C===wa())return"Today";const q=new Date(C+"T12:00:00"),de=new Date;return de.setDate(de.getDate()-1),C===de.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},re=["January","February","March","April","May","June","July","August","September","October","November","December"],Ze=["Su","Mo","Tu","We","Th","Fr","Sa"],Et=()=>{let C=parseFloat(j.weight);j.weightUnit==="lbs"&&(C*=.453592);let q;j.heightUnit==="cm"?q=parseFloat(j.height):q=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const de=parseInt(j.age);let ke=j.gender==="male"?10*C+6.25*q-5*de+5:10*C+6.25*q-5*de-161;const _t=ke*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],yt={low:100,moderate:200,high:300,daily:400},_s=Math.round(_t+yt[j.trainingFrequency]);let Gt=_s,vn,gr;switch(j.goal){case"lose":Gt=_s*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),vn=2.2,gr=.3;break;case"build":Gt=_s*1.1,vn=2,gr=.22;break;default:vn=1.8,gr=.25}Gt=Math.max(Gt,j.gender==="male"?1400:1100);const yr=Math.round(C*vn),$n=Math.round(Gt*gr/9),ma=Math.max(0,Math.round((Gt-yr*4-$n*9)/4));B({calories:Math.round(Gt),protein:yr,carbs:ma,fats:$n,bmr:Math.round(ke),neat:Math.round(_t),exerciseAdd:yt[j.trainingFrequency],tdee:Math.round(_s)})},tt=async()=>{if(G)try{const C={clientId:t.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,waterGoal:8,goal:j.goal,updatedAt:Ct.now()};await Ls(Je(me,"nutritionTargets",t.id),C),_(C),y("dashboard"),je("Macro targets saved!","success")}catch(C){console.error("Error saving targets:",C),je("Failed to save targets. Please try again.","error")}},Nt=()=>{const C=j.weight&&parseFloat(j.weight)>0,q=j.age&&parseInt(j.age)>0,de=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return C&&q&&de},Q="nut_favourite_foods",Ae=()=>{try{return JSON.parse(localStorage.getItem(Q)||"[]")}catch{return[]}};b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await Ps(Je(me,"favouriteFoods",t.id));if(q.exists()){const de=q.data().items||[];localStorage.setItem(Q,JSON.stringify(de)),tn(ke=>ke+1)}else{const de=Ae();de.length>0&&await Ls(Je(me,"favouriteFoods",t.id),{items:de,updatedAt:Ct.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const Qe=C=>Ae().some(q=>q.name.toLowerCase()===(C||"").toLowerCase()),dt=C=>{const q=Ae(),de=q.findIndex(ke=>ke.name.toLowerCase()===C.name.toLowerCase());de>=0?q.splice(de,1):q.unshift({name:C.name,protein:C.protein,carbs:C.carbs,fats:C.fats,calories:C.calories,serving:C.serving,per100g:C.per100g||null,servingUnit:C.servingUnit||"g",portion:C.portion||null}),localStorage.setItem(Q,JSON.stringify(q)),t?.id&&Ls(Je(me,"favouriteFoods",t.id),{items:q,updatedAt:Ct.now()}).catch(ke=>console.error("Error saving favourites:",ke)),tn(ke=>ke+1)},at=C=>{const q=[...Y.entries,{...C,meal:Ue,id:Date.now(),addedAt:new Date().toISOString()}],de={...Y,entries:q};Z(de),st(de),De(null),Ht(null),zt("100"),gt(0),rs("weight"),Ot({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),je("Food added!","success")},ss=C=>{const q=Y.entries.filter(ke=>ke.id!==C),de={...Y,entries:q};Z(de),st(de)},ns=async C=>{if(!(!t?.id||C===D)){ye(!0);try{const q=await Ps(Je(me,"nutritionLogs",`${t.id}_${C}`));if(!q.exists()||!q.data().entries?.length){je("No food logged on that day","error");return}const de=q.data().entries.map(_t=>({..._t,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ke=[...Y.entries,...de],it={...Y,entries:ke};Z(it),st(it),R(!1),je(`Copied ${de.length} items from ${J(C)}`,"success")}catch(q){console.error("Error copying day:",q),je("Failed to copy day","error")}finally{ye(!1)}}},F=b.useRef(null),pe=b.useRef([]),Ne=3,Ee=5,Ce=async()=>{Be(!0);const C=document.querySelector("#barcode-reader");if(!C){Be(!1),je("Scanner container not found.","error");return}if(!F.current)try{const de=await Sr(()=>import("./quagga.min-BbicSfvA.js").then(ke=>ke.q),[]);F.current=de.default}catch(de){console.error("Failed to load barcode scanner:",de),Be(!1),je("Could not load scanner.","error");return}const q=F.current;q.init({inputStream:{type:"LiveStream",target:C,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},de=>{if(de){console.error("Quagga init error:",de),Be(!1),je("Could not access camera. Check permissions.","error");return}q.start(),ls.current=!0}),pe.current=[],q.onDetected(de=>{const ke=de.codeResult.decodedCodes?.filter(_t=>_t.error!==void 0)?.map(_t=>_t.error)||[];if((ke.length>0?ke.reduce((_t,yt)=>_t+yt,0)/ke.length:1)<.15){const _t=de.codeResult.code,yt=pe.current;yt.push(_t),yt.length>Ee&&yt.shift(),yt.filter(Gt=>Gt===_t).length>=Ne&&(q.offDetected(),pe.current=[],ut(_t))}})},xt=()=>{const C=F.current;ls.current&&C&&(C.stop(),C.offDetected(),ls.current=!1),Be(!1)},At=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,ht=C=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((C||"").replace(/\s/g,"")),$t=C=>{if(!C)return{value:100,unit:"g"};const q=C.toLowerCase().replace(/\s/g,""),de=q.match(/([\d.]+)/),ke=de?parseFloat(de[1]):100;return ht(C)?/cl/.test(q)?{value:ke*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:ke*1e3,unit:"ml"}:{value:ke,unit:"ml"}:{value:ke,unit:"g"}},Bt=C=>{if(ht(C.serving_size)||ht(C.quantity))return"ml";const q=C.product_name||C.product_name_en||"";return At.test(q)?"ml":"g"},$s=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],yn=(C,q)=>{const de=C||"",ke=de.match(/\((\d+\.?\d*)\s*g\)/i),it=de.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ke&&it){const _s=parseFloat(ke[1]);let Gt=it[1].replace(/^\d+\s*/,"").trim();if(Gt&&_s>0)return{label:Gt,weight:_s}}const _t=de.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(_t){const _s=parseFloat(_t[1]);let Gt=_t[2].replace(/^\d+\s*/,"").trim();if(Gt&&_s>0)return{label:Gt,weight:_s}}const yt=q||"";for(const{pattern:_s,label:Gt,weight:vn}of $s)if(_s.test(yt))return{label:Gt,weight:vn};return null},dn=C=>{const q=C.nutriments||{},de=Bt(C),ke=$t(C.serving_size),it=de==="ml"?ke.unit==="ml"?ke.value:100:ke.value,_t=C.product_name||C.product_name_en||"Unknown Product",yt=yn(C.serving_size,_t);return{name:_t,brand:C.brands||"",image:C.image_small_url||C.image_url||null,servingSize:C.serving_size||"100g",servingValue:it,servingUnit:de,portion:yt,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},In=async C=>{As(!0);try{const q=`https://world.openfoodfacts.org/api/v2/product/${C}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,de=await fetch(q);if(!de.ok)throw new Error(`HTTP ${de.status}`);const ke=await de.json();if(ke.status==="success"||ke.status===1||ke.product){const it=dn(ke.product);it.calories===0&&it.protein===0&&it.carbs===0?je("Product found but no nutrition data available.","error"):(Ht(it),it.portion?(gt(1),zt(String(it.portion.weight)),rs("portion")):(gt(0),zt(String(it.servingValue||100)),rs("weight")),ot(""))}else je("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),je("Failed to look up product. Check your connection.","error")}As(!1)},hn=(C,q,de)=>{const ke=C.toLowerCase().trim(),it=q.toLowerCase().trim(),_t=de.toLowerCase().trim();let yt=0;return(ke===_t||ke===_t+"s"||ke+"s"===_t)&&(yt+=100),(ke.endsWith(" "+_t)||ke.endsWith(" "+_t+"s"))&&(yt+=40),(ke.startsWith(_t+" ")||ke.startsWith(_t+"s "))&&(yt+=15),_t.split(/\s+/).some(Gt=>it===Gt||it.startsWith(Gt))&&(yt+=30),yt+=Math.max(0,30-ke.length),yt},sn=async()=>{if(!ts.trim())return;xs.current&&xs.current.abort();const C=new AbortController;xs.current=C;const q=ts.trim().toLowerCase(),de=q.split(/\s+/).filter(Boolean);if(Kp.has(q)){qt(Kp.get(q));return}Ms(!0);try{const it=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(ts.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,_t=await fetch(it,{signal:C.signal});if(!_t.ok)throw new Error(`HTTP ${_t.status}`);const _s=((await _t.json()).products||[]).map(Gt=>dn(Gt)).filter(Gt=>Gt.name!=="Unknown Product"&&(Gt.calories>0||Gt.protein>0)).filter(Gt=>{const vn=(Gt.name+" "+Gt.brand).toLowerCase();return de.every(gr=>vn.includes(gr))}).sort((Gt,vn)=>hn(vn.name,vn.brand,q)-hn(Gt.name,Gt.brand,q)).slice(0,10);Kp.set(q,_s),qt(_s),_s.length===0&&je("No results found. Try a different search.","info")}catch(ke){if(ke.name==="AbortError")return;console.error("Search error:",ke),je("Search failed. Check your connection.","error")}Ms(!1)};b.useEffect(()=>{if(ge.current&&clearTimeout(ge.current),!(!ts.trim()||ne!=="search"||se))return ge.current=setTimeout(()=>{sn()},700),()=>clearTimeout(ge.current)},[ts]);const ys=()=>{const C={...Y,water:Y.water+1};Z(C),st(C)},K=()=>{if(Y.water<=0)return;const C={...Y,water:Y.water-1};Z(C),st(C)},he=l,ie={"ring-protein":he?"#2dd4bf":"#14b8a6","ring-carbs":he?"#fbbf24":"#f59e0b","ring-fats":he?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},be=80,Ge=2*Math.PI*be,Tt=(C,q,de,ke,it)=>{const _t=ke>0?Math.min(100,Math.round(de/ke*100)):0,yt=Ge-_t/100*Ge,_s=ie[it]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:be}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:be,style:{stroke:_s},strokeDasharray:Ge,strokeDashoffset:yt})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:_s},children:Math.round(de)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",ke,C==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:_s},children:q})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:_s},children:[_t,"%"]})]})};if(b.useEffect(()=>{if(!Pe)return;const C=setTimeout(()=>{const q=Pe;xt(),ut(null),In(q)},1500);return()=>clearTimeout(C)},[Pe]),b.useEffect(()=>()=>{const C=F.current;if(ls.current&&C){try{C.stop(),C.offDetected()}catch{}ls.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(C=>({...C,gender:"male"})),B(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(C=>({...C,gender:"female"})),B(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:C=>{O(q=>({...q,age:C.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:C=>{O(q=>({...q,weight:C.target.value})),B(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(C=>({...C,weightUnit:"kg"})),B(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(C=>({...C,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:C=>{O(q=>({...q,height:C.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:C=>{O(q=>({...q,heightFeet:C.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:C=>{O(q=>({...q,heightInches:C.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(C=>({...C,heightUnit:"cm"})),B(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(C=>({...C,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:C=>{O(q=>({...q,dailyActivity:C.target.value})),B(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:C=>{O(q=>({...q,trainingFrequency:C.target.value})),B(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(C=>({...C,goal:"lose"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(C=>({...C,goal:"maintain"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(C=>({...C,goal:"build"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(C=>({...C,deficitLevel:"light"})),B(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(C=>({...C,deficitLevel:"moderate"})),B(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(C=>({...C,deficitLevel:"harsh"})),B(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Et,disabled:!Nt(),children:"Calculate Macros"})]}),G&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[Tt("Protein","Protein",G.protein,G.protein,"ring-protein"),Tt("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),Tt("Fats","Fats",G.fats,G.fats,"ring-fats"),Tt("Calories","Calories",G.calories,G.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[G.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[G.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[G.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:tt,children:"Set as My Daily Targets"})]})]}),Ys&&r.jsx("div",{className:`toast-notification ${Ys.type}`,children:Ys.message})]});const Xt=C=>{const q=new Date(C+"T12:00:00"),de=q.getDay(),ke=new Date(q);ke.setDate(q.getDate()-(de+6)%7);const it=[];for(let _t=0;_t<7;_t++){const yt=new Date(ke);yt.setDate(ke.getDate()+_t),it.push(yt.toISOString().split("T")[0])}return it},Lt=["M","T","W","T","F","S","S"],Wt=(C,q="search")=>{Ye(C),q==="scan"?(De("scan"),Ht(null)):q==="manual"?(De("manual"),Ot({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?De("favourites"):(De("search"),qt([]),Rt(""))},ps=Xt(D),Vs=new Date(D+"T12:00:00"),Is=`${re[Vs.getMonth()]} ${Vs.getFullYear()}`;return r.jsx(Ra,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const C=new Date(D+"T12:00:00");C.setDate(C.getDate()-7);const q=C.toISOString().split("T")[0];te(q)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{N(!we),I({year:Vs.getFullYear(),month:Vs.getMonth()})},children:Is}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const C=new Date(D+"T12:00:00");C.setDate(C.getDate()+7);const q=C.toISOString().split("T")[0];q<=wa()&&te(q)},"aria-label":"Next week",disabled:ps[6]>=wa(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:ps.map((C,q)=>{const de=new Date(C+"T12:00:00").getDate(),ke=C===D,it=C>wa(),_t=C===wa();return r.jsxs("button",{className:`nut-week-day${ke?" selected":""}${_t?" today":""}${it?" future":""}`,disabled:it,onClick:()=>te(C),children:[r.jsx("span",{className:"nut-week-day-letter",children:Lt[q]}),r.jsx("span",{className:"nut-week-day-num",children:de})]},C)})})]}),we&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>I(C=>{let q=C.month-1,de=C.year;return q<0&&(q=11,de--),{year:de,month:q}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[re[V.month]," ",V.year]}),r.jsx("button",{onClick:()=>I(C=>{let q=C.month+1,de=C.year;return q>11&&(q=0,de++),{year:de,month:q}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ze.map(C=>r.jsx("span",{children:C},C))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(pt(V.year,V.month))].map((C,q)=>r.jsx("span",{},`e${q}`)),[...Array(rt(V.year,V.month))].map((C,q)=>{const de=q+1,ke=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(de).padStart(2,"0")}`,it=ke>wa(),_t=ke===D,yt=ke===wa();return r.jsx("button",{className:`nut-cal-day${_t?" selected":""}${yt?" today":""}${it?" future":""}`,disabled:it,onClick:()=>{te(ke),N(!1)},children:de},de)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Tt("Protein","Protein",_e.protein,x.protein,"ring-protein"),Tt("Carbs","Carbs",_e.carbs,x.carbs,"ring-carbs"),Tt("Fats","Fats",_e.fats,x.fats,"ring-fats"),Tt("Calories","kCal",_e.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[We&&r.jsxs("div",{className:"nut-quick-row",children:[r.jsxs("button",{className:"nut-water-quick",onClick:()=>M(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{R(!0),mt({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),r.jsx("span",{children:"Copy day"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:N2.map(C=>{const q=Y.entries.filter(ke=>(ke.meal||"snacks")===C.key),de=q.reduce((ke,it)=>({protein:ke.protein+(it.protein||0),carbs:ke.carbs+(it.carbs||0),fats:ke.fats+(it.fats||0),calories:ke.calories+(it.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${C.key}`,children:AD[C.key]}),r.jsx("span",{className:"nut-meal-card-title",children:C.label}),q.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[de.calories," cal"]}),We&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>P(X===C.key?null:C.key),"aria-label":`Add to ${C.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?de.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[de.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?de.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[de.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?de.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[de.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?de.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:de.calories})]})]}),q.length>0&&r.jsx("div",{className:"nut-log-list",children:q.map(ke=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${Qe(ke.name)?" active":""}`,onClick:()=>dt(ke),"aria-label":Qe(ke.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:Qe(ke.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:ke.name}),ke.serving&&r.jsx("span",{className:"nut-log-item-serving",children:ke.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ke.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[ke.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[ke.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:ke.calories})]}),We&&r.jsx("button",{className:"nut-log-delete",onClick:()=>ss(ke.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ke.id))}),q.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:We?"Tap + to add food":"No entries"})})]},C.key)})})})]})}),X&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>P(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",N2.find(C=>C.key===X)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const C=X;P(null),Wt(C,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const C=X;P(null),Wt(C,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const C=X;P(null),Wt(C,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const C=X;P(null),Wt(C,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),L&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>R(!1),children:r.jsxs("div",{className:"nut-copy-from-popup",onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{className:"nut-copy-from-header",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),r.jsx("span",{children:"Copy from..."}),r.jsx("button",{className:"nut-modal-close",onClick:()=>R(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>mt(C=>{let q=C.month-1,de=C.year;return q<0&&(q=11,de--),{year:de,month:q}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[re[Ie.month]," ",Ie.year]}),r.jsx("button",{onClick:()=>mt(C=>{let q=C.month+1,de=C.year;return q>11&&(q=0,de++),{year:de,month:q}}),disabled:Ie.year===new Date().getFullYear()&&Ie.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ze.map(C=>r.jsx("span",{children:C},C))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(pt(Ie.year,Ie.month))].map((C,q)=>r.jsx("span",{},`e${q}`)),[...Array(rt(Ie.year,Ie.month))].map((C,q)=>{const de=q+1,ke=`${Ie.year}-${String(Ie.month+1).padStart(2,"0")}-${String(de).padStart(2,"0")}`,it=ke>wa(),_t=ke===D,yt=ke===wa(),_s=it||_t;return r.jsx("button",{className:`nut-cal-day${_t?" selected":""}${yt?" today":""}${it?" future":""}`,disabled:_s,onClick:()=>ns(ke),children:de},de)})]}),$&&r.jsxs("div",{className:"nut-copy-from-loading",children:[r.jsx("div",{className:"wk-loading-spinner"}),r.jsx("span",{children:"Copying..."})]})]})}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((C,q)=>r.jsx("div",{className:`nut-water-glass ${q<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:q<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},q))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:K,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:ys,children:"+"})]})]})]})}),ne&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{xt(),ut(null),De(null),Ht(null)},children:r.jsxs("div",{className:"nut-modal",onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:ne==="scan"?"Scan Barcode":ne==="search"?"Search Food":ne==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{xt(),ut(null),De(null),Ht(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),ne==="scan"&&!se&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ze&&!Pe&&r.jsx("div",{className:"nut-scan-line"}),Pe&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:Pe})]})]}),!ze&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:Ce,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ze&&!Pe&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:bt,onChange:C=>ot(C.target.value),onKeyDown:C=>C.key==="Enter"&&bt.trim()&&In(bt.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>bt.trim()&&In(bt.trim()),disabled:!bt.trim()||os,children:os?"...":"Look Up"})]})]}),ne==="scan"&&se&&(()=>{const C=se.servingUnit||"g",q=se.portion,de=Qt==="portion"&&q?wt*q.weight:parseFloat(Dt)||0,ke=de/100,it=C==="ml"?[100,200,250,500]:[50,100,150,200],_t=Qt==="portion"&&q?`${wt} ${q.label}${wt!==1?"s":""} (${Math.round(de)}${C})`:`${Math.round(de)}${C}`;return r.jsxs("div",{className:"nut-product-result",children:[se.image&&r.jsx("img",{src:se.image,alt:se.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:se.name}),r.jsx("button",{className:`nut-fav-star confirm${Qe(se.name)?" active":""}`,onClick:()=>dt({name:se.name,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,serving:se.servingSize,per100g:{protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories},servingUnit:se.servingUnit||"g",portion:se.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Qe(se.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),se.brand&&r.jsx("p",{className:"nut-product-brand",children:se.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",C,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[se.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[se.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[se.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[se.calories," cal"]})]}),q&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Qt==="portion"?"active":"",onClick:()=>{rs("portion"),wt<1&&gt(1)},children:"Portions"}),r.jsxs("button",{className:Qt==="weight"?"active":"",onClick:()=>{rs("weight"),zt(String(Math.round(de)||100))},children:["Custom (",C,")"]})]}),Qt==="portion"&&q?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,wt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:wt}),r.jsxs("span",{className:"nut-stepper-label",children:[q.label,wt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(de),C]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(wt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",C,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Dt,onChange:yt=>zt(yt.target.value),onFocus:yt=>yt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:it.map(yt=>r.jsxs("button",{className:`nut-quick-btn${Dt===String(yt)?" active":""}`,onClick:()=>zt(String(yt)),children:[yt,C]},yt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(se.protein*ke),"p / ",Math.round(se.carbs*ke),"c / ",Math.round(se.fats*ke),"f / ",Math.round(se.calories*ke)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Ht(null),De("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>at({name:se.name,protein:Math.round(se.protein*ke),carbs:Math.round(se.carbs*ke),fats:Math.round(se.fats*ke),calories:Math.round(se.calories*ke),serving:_t}),children:"Add"})]})]})})(),ne==="search"&&!se&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Le,value:ts,onChange:C=>Rt(C.target.value),onKeyDown:C=>{C.key==="Enter"&&(clearTimeout(ge.current),sn())},onFocus:()=>setTimeout(()=>Le.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:sn,disabled:It,children:It?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[Pt.map((C,q)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Ht(C),C.portion?(gt(1),zt(String(C.portion.weight)),rs("portion")):(gt(0),zt(String(C.servingValue||100)),rs("weight"))},children:[C.image&&r.jsx("img",{src:C.image,alt:C.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:C.name}),C.brand&&r.jsx("span",{className:"nut-search-item-brand",children:C.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[C.calories," cal  ",C.protein,"p  ",C.carbs,"c  ",C.fats,"f per 100",C.servingUnit||"g"]})]})]},q)),Pt.length===0&&ts&&!It&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),ne==="search"&&se&&(()=>{const C=se.servingUnit||"g",q=se.portion,de=Qt==="portion"&&q?wt*q.weight:parseFloat(Dt)||0,ke=de/100,it=C==="ml"?[100,200,250,500]:[50,100,150,200],_t=Qt==="portion"&&q?`${wt} ${q.label}${wt!==1?"s":""} (${Math.round(de)}${C})`:`${Math.round(de)}${C}`;return r.jsxs("div",{className:"nut-product-result",children:[se.image&&r.jsx("img",{src:se.image,alt:se.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:se.name}),r.jsx("button",{className:`nut-fav-star confirm${Qe(se.name)?" active":""}`,onClick:()=>dt({name:se.name,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,serving:se.servingSize,per100g:{protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories},servingUnit:se.servingUnit||"g",portion:se.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Qe(se.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),se.brand&&r.jsx("p",{className:"nut-product-brand",children:se.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",C,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[se.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[se.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[se.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[se.calories," cal"]})]}),q&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Qt==="portion"?"active":"",onClick:()=>{rs("portion"),wt<1&&gt(1)},children:"Portions"}),r.jsxs("button",{className:Qt==="weight"?"active":"",onClick:()=>{rs("weight"),zt(String(Math.round(de)||100))},children:["Custom (",C,")"]})]}),Qt==="portion"&&q?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,wt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:wt}),r.jsxs("span",{className:"nut-stepper-label",children:[q.label,wt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(de),C]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(wt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",C,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Dt,onChange:yt=>zt(yt.target.value),onFocus:yt=>yt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:it.map(yt=>r.jsxs("button",{className:`nut-quick-btn${Dt===String(yt)?" active":""}`,onClick:()=>zt(String(yt)),children:[yt,C]},yt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(se.protein*ke),"p / ",Math.round(se.carbs*ke),"c / ",Math.round(se.fats*ke),"f / ",Math.round(se.calories*ke)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ht(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>at({name:se.name,protein:Math.round(se.protein*ke),carbs:Math.round(se.carbs*ke),fats:Math.round(se.fats*ke),calories:Math.round(se.calories*ke),serving:_t}),children:"Add"})]})]})})(),ne==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:Vt.name,onChange:C=>Ot(q=>({...q,name:C.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:Vt.serving,onChange:C=>Ot(q=>({...q,serving:C.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:Vt.protein,onChange:C=>Ot(q=>({...q,protein:C.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:Vt.carbs,onChange:C=>Ot(q=>({...q,carbs:C.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:Vt.fats,onChange:C=>Ot(q=>({...q,fats:C.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:Vt.calories,onChange:C=>Ot(q=>({...q,calories:C.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!Vt.name.trim(),onClick:()=>at({name:Vt.name,protein:parseFloat(Vt.protein)||0,carbs:parseFloat(Vt.carbs)||0,fats:parseFloat(Vt.fats)||0,calories:parseFloat(Vt.calories)||0,serving:Vt.serving||""}),children:"Add Food"})]}),ne==="favourites"&&!se&&(()=>{const C=Ae(),q=de=>{if(de.per100g){const ke=de.per100g;Ht({name:de.name,brand:"",image:null,servingSize:de.serving||"100g",servingValue:100,servingUnit:de.servingUnit||"g",portion:de.portion||null,protein:ke.protein,carbs:ke.carbs,fats:ke.fats,calories:ke.calories,per100g:!0}),de.portion?(gt(1),zt(String(de.portion.weight)),rs("portion")):(gt(0),zt("100"),rs("weight"))}else at({name:de.name,protein:de.protein,carbs:de.carbs,fats:de.fats,calories:de.calories,serving:de.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:C.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:C.map((de,ke)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:it=>{it.stopPropagation(),dt(de)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>q(de),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:de.name}),r.jsx("span",{className:"nut-recent-item-serving",children:de.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[de.calories," cal"]})]})]},ke))})})})(),ne==="favourites"&&se&&(()=>{const C=se.servingUnit||"g",q=se.portion,de=Qt==="portion"&&q?wt*q.weight:parseFloat(Dt)||0,ke=de/100,it=C==="ml"?[100,200,250,500]:[50,100,150,200],_t=Qt==="portion"&&q?`${wt} ${q.label}${wt!==1?"s":""} (${Math.round(de)}${C})`:`${Math.round(de)}${C}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:se.name}),r.jsx("button",{className:`nut-fav-star confirm${Qe(se.name)?" active":""}`,onClick:()=>dt({name:se.name,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,serving:se.servingSize,per100g:{protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories},servingUnit:se.servingUnit||"g",portion:se.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Qe(se.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",C,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[se.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[se.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[se.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[se.calories," cal"]})]}),q&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Qt==="portion"?"active":"",onClick:()=>{rs("portion"),wt<1&&gt(1)},children:"Portions"}),r.jsxs("button",{className:Qt==="weight"?"active":"",onClick:()=>{rs("weight"),zt(String(Math.round(de)||100))},children:["Custom (",C,")"]})]}),Qt==="portion"&&q?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,wt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:wt}),r.jsxs("span",{className:"nut-stepper-label",children:[q.label,wt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(de),C]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(wt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",C,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Dt,onChange:yt=>zt(yt.target.value),onFocus:yt=>yt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:it.map(yt=>r.jsxs("button",{className:`nut-quick-btn${Dt===String(yt)?" active":""}`,onClick:()=>zt(String(yt)),children:[yt,C]},yt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(se.protein*ke),"p / ",Math.round(se.carbs*ke),"c / ",Math.round(se.fats*ke),"f / ",Math.round(se.calories*ke)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ht(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>at({name:se.name,protein:Math.round(se.protein*ke),carbs:Math.round(se.carbs*ke),fats:Math.round(se.fats*ke),calories:Math.round(se.calories*ke),serving:_t}),children:"Add"})]})]})})()]})}),r.jsx(Ca,{active:"nutrition"}),Ys&&r.jsx("div",{className:`toast-notification ${Ys.type}`,children:Ys.message})]})})}async function nb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),_="#2a2a28",j="#ffffff",O="#A12F3A",G="#1a1a1a",B="#555555";x.fillStyle=_,x.fillRect(0,0,p,g);const D=Math.round(p*.82),te=Math.round(g*.75),Y=Math.round((p-D)/2),Z=Math.round((g-te)/2),_e=28,Me=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,C2(x,Y,Z,D,te,_e),x.fillStyle=j,x.fill(),x.restore(),x.save(),C2(x,Y,Z,D,te,_e),x.strokeStyle=O,x.lineWidth=Me,x.stroke(),x.restore();const we=220,N=50,T=52,M=68,V=10,I=36,L=48,R=30,Ie=34,mt=46,$=30,ye=28;x.font=`bold ${T}px 'Orbitron', sans-serif`;const Ue=iu(x,t.toUpperCase(),D-100);x.font=`500 ${I}px 'Montserrat', sans-serif`;let Ye=[];e==="badge"&&d?Ye=iu(x,d,D-120):e==="badge"&&l.length>0?Ye=iu(x,l.join("    "),D-120):i.length>0&&(Ye=iu(x,i.map(qt=>`${qt.value} ${qt.label}`).join("    "),D-120));const X=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${Ie}px 'Montserrat', sans-serif`;const P=iu(x,X,D-80);let ne=Ue.length*M;Ye.length>0&&(ne+=V+Ye.length*L),ne+=R+P.length*mt,ne+=$+ye;const ze=Z+te-60-ne,Pe=Z+40,ut=ze-N,bt=p/2,ot=(Pe+ut)/2,os=e==="badge"&&u?u:"/Logo.webp";x.save();const As=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",ts=x.createRadialGradient(bt,ot,we*.6,bt,ot,we*1.5);ts.addColorStop(0,As),ts.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=ts,x.fillRect(bt-we*1.5,ot-we*1.5,we*3,we*3),x.restore(),x.beginPath(),x.arc(bt,ot,we+6,0,Math.PI*2),x.fillStyle=j,x.fill();const Rt=e==="badge"?"#ffc107":O;x.beginPath(),x.arc(bt,ot,we,0,Math.PI*2),x.strokeStyle=Rt,x.lineWidth=5,x.stroke();try{const qt=await DD(os);x.save(),x.beginPath(),x.arc(bt,ot,we-6,0,Math.PI*2),x.clip();const It=(we-6)*2;x.drawImage(qt,bt-we+6,ot-we+6,It,It),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=O,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",bt,ot)}let Pt=ze;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=G,x.font=`bold ${T}px 'Orbitron', sans-serif`;for(const qt of Ue)x.fillText(qt,p/2,Pt),Pt+=M;if(Ye.length>0){Pt+=V,x.fillStyle=B,x.font=`500 ${I}px 'Montserrat', sans-serif`;for(const qt of Ye)x.fillText(qt,p/2,Pt),Pt+=L}Pt+=R,x.fillStyle=G,x.font=`bold ${Ie}px 'Montserrat', sans-serif`;for(const qt of P)x.fillText(qt,p/2,Pt),Pt+=mt;return Pt+=$,x.fillStyle=O,x.font=`600 ${ye}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,Pt),new Promise(qt=>{y.toBlob(It=>qt(It),"image/png")})}function C2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function DD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function iu(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function PD(){const n=b.useRef(null),e=b.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),_=u.createGain();x.type="sine",x.frequency.value=70,_.gain.value=.2,_.gain.setTargetAtTime(0,d+.22,.04),x.connect(_).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return b.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const LD=2e3,Lg=42,Fl=2*Math.PI*Lg,OD=1200,R2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function em({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:x=!1}){const[_,j]=b.useState("hold"),[O,G]=b.useState(!1),[B,D]=b.useState(0),[te,Y]=b.useState(!1),[Z,_e]=b.useState(!1),[Me,we]=b.useState(null),N=PD(),T=b.useRef(null),M=b.useRef(null),V=b.useRef(null),I=b.useRef(null),L=b.useRef(!1),R=b.useRef(!1),Ie=b.useRef(0),mt=b.useRef(R2[Math.floor(Math.random()*R2.length)]),$=b.useRef([...Array(80)].map((Be,Pe)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Pe%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Pe%3}))),ye=b.useCallback(()=>{if(L.current)return;L.current=!0,R.current=!1,Ie.current=0,G(!0),D(0),I.current=performance.now(),N.tap(),T.current&&(T.current.style.strokeDashoffset=Fl);const Be=Pe=>{const ut=Pe-I.current,bt=Math.min(ut/LD,1);if(T.current&&(T.current.style.strokeDashoffset=Fl-bt*Fl),M.current){const ot=8*(1-bt),os=1-bt,As=1+bt*.15;M.current.style.filter=`blur(${ot}px) grayscale(${os})`,M.current.style.transform=`scale(${As})`}D(bt),ut-Ie.current>=OD&&(Ie.current=ut,N.tick()),bt<1?V.current=requestAnimationFrame(Be):(L.current=!1,R.current=!0,V.current=null,G(!1),D(1),N.complete(),j("celebrate"))};V.current=requestAnimationFrame(Be)},[N]),Ue=b.useCallback(()=>{L.current&&(L.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),T.current&&(T.current.style.strokeDashoffset=Fl),M.current&&(M.current.style.filter="",M.current.style.transform=""),G(!1),D(0))},[]),Ye=b.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),X=b.useCallback(()=>{const Be=[n||"Workout Complete!"];return e&&Be.push(e),t?.length&&Be.push(t.map(Pe=>`${Pe.value} ${Pe.label}`).join(" | ")),Be.push("#MindCoreFitness"),Be.join(`
`)},[n,e,t]),P=b.useCallback(async()=>{if(!(Z||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:mt.current}),_e(!0),we("Posted to Journey!"),setTimeout(()=>we(null),2500)}catch(Be){console.error("Journey post failed:",Be),we(Be?.message||"Failed to post"),setTimeout(()=>we(null),3500)}},[Z,u,n,e,t]),[ne,De]=b.useState(!1),ze=b.useCallback(async()=>{De(!0);try{const Be=await nb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:mt.current,userName:d}),Pe=X();if(navigator.share&&navigator.canShare?.({files:[new File([Be],"workout.png",{type:"image/png"})]})){const ut=new File([Be],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Pe,files:[ut]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Pe}):(await navigator.clipboard.writeText(Pe),we("Copied to clipboard!"),setTimeout(()=>we(null),2500))}catch{try{await navigator.clipboard.writeText(X()),we("Copied to clipboard!"),setTimeout(()=>we(null),2500)}catch{}}finally{De(!1)}},[n,e,t,d,X]);return _==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Be=>{Be.preventDefault(),ye()},onPointerUp:Ue,onPointerLeave:Ue,onPointerCancel:Ue,onClick:Be=>{Be.stopPropagation(),R.current&&(R.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Be=>{(Be.key==="Enter"||Be.key===" ")&&(Be.preventDefault(),N.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Lg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Lg,style:{strokeDasharray:Fl,strokeDashoffset:Fl}})]}),r.jsx("img",{ref:M,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${te?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:$.current.map((Be,Pe)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Be.shape}`,style:{"--x":`${Be.x}%`,"--delay":`${Be.delay}s`,"--color":Be.color,"--drift":`${Be.drift}px`,"--spin":`${Be.spin}deg`,"--duration":`${Be.duration}s`,width:`${Be.width}px`,height:`${Be.height}px`}},Pe))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:mt.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Be,Pe)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:Be.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:Be.label})]},Pe))}),!x&&r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${Z?"wc-share-done":""}`,onClick:P,disabled:Z,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Z?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:ze,disabled:ne,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ne?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:Ye,children:p}),Me&&r.jsx("div",{className:"wc-share-toast",children:Me})]})]})}const A2="/login/assets/randomiser-glq9YJkL.jpg",M2="/login/assets/programme-card-workout-CnNzTYkz.webp",BD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",VD="/login/assets/muscle-group-arms-C9AdZL4-.png",UD="/login/assets/arms-bicep-BUrmT1o-.png",FD="/login/assets/arms-tricep-D9tAnFnS.png",zD="/login/assets/arms-full-arms-BY3TvpJm.png",qD="/login/assets/muscle-group-chest-Cxfuc7XI.png",HD="/login/assets/chest-strength-BR4BAFTH.png",$D="/login/assets/chest-hypertrophy-B8yNrvjB.png",WD="/login/assets/chest-endurance-e-OSWtWO.png",GD="/login/assets/muscle-group-shoulders-DibNtCLF.png",KD="/login/assets/shoulders-strength-CKlZBF5A.png",YD="/login/assets/shoulders-hypertrophy-BUd76jiS.png",QD="/login/assets/shoulders-endurance-HuqNG5rD.png",XD="/login/assets/muscle-group-core-CPR-bdRg.png",JD="/login/assets/core-lower-abs-TVcqGMFJ.png",ZD="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e6="/login/assets/core-weighted-core-4Kwh9mTv.png",t6="/login/assets/muscle-group-back-8JPV-YUo.png",s6="/login/assets/back-strength-BmSRxnwo.png",n6="/login/assets/back-hypertrophy-CXHmsnCz.png",r6="/login/assets/back-endurance-C8qJ8l5I.png",a6="/login/assets/muscle-group-legs-B8jcbdov.png",i6="/login/assets/legs-quads-DbnfsebI.png",o6="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l6="/login/assets/legs-power-plyo-D2qBXeUR.png",c6=60,Yp=5,u6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],d6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},h6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},m6={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Qp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Xp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:BD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],ou=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:VD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:qD},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t6},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:GD},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:a6},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:XD}],I2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:HD,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$D,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:WD,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:s6,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:n6,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r6,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:KD,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:YD,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:QD,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:UD,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:FD,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:zD,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:i6,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o6,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l6,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:JD,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:ZD,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e6,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},Jp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],ca=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Fa=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Zp=[5,10,15,20,30],mh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},D2=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function f6(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function p6(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function g6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=gc(),x=or(),[_,j]=b.useState("menu"),[O,G]=b.useState(["bodyweight"]),[B,D]=b.useState("core"),[te,Y]=b.useState("intermediate"),[Z,_e]=b.useState(p?15:5),[Me,we]=b.useState([]),[N,T]=b.useState(!1),M=b.useRef(!1),V=b.useRef([]),[I,L]=b.useState([]),[R,Ie]=b.useState(2),[mt,$]=b.useState(Fa[1]),[ye,Ue]=b.useState(1),[Ye,X]=b.useState(0),[P,ne]=b.useState("work"),[De,ze]=b.useState(0),[Be,Pe]=b.useState(!1),[ut,bt]=b.useState(0),[ot,os]=b.useState(!1),[As,ts]=b.useState(!1),[Rt,Pt]=b.useState(null),qt=b.useRef(null);b.useRef(null),b.useRef(null);const[It,Ms]=b.useState(null),Vt=b.useCallback((z,le="info")=>{Ms({message:z,type:le}),setTimeout(()=>Ms(null),3e3)},[]),Ot=b.useCallback(async z=>{if(!t)throw new Error("Not signed in");const le=z&&typeof z=="object"&&z.type;await Xr(Yt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:le?"":z,type:le?z.type:"text",imageURL:null,createdAt:_r(),likeCount:0,commentCount:0,...le?{metadata:{title:z.title||"",subtitle:z.subtitle||"",stats:z.stats||[],quote:z.quote||"",badges:z.badges||[]}}:{}})},[t]),[se,Ht]=b.useState(null),[Dt,zt]=b.useState(null),[wt,gt]=b.useState(0),[Qt,rs]=b.useState(0),[vs,tn]=b.useState([]),[Ys,Qs]=b.useState(""),[ls,xs]=b.useState(""),[ge,Le]=b.useState(!1),[je,st]=b.useState(0),[We,rt]=b.useState(!1),[pt,J]=b.useState({}),re=b.useRef(null),Ze=b.useRef(null),[Et,tt]=b.useState([]),[Nt,Q]=b.useState(null),[Ae,Qe]=b.useState(0),[dt,at]=b.useState(0),[ss,ns]=b.useState(0),[F,pe]=b.useState(0),[Ne,Ee]=b.useState(0),[Ce,xt]=b.useState(0),[At,ht]=b.useState({beginner:0,intermediate:0,advanced:0}),$t=p?Zp:Zp.filter(z=>g.includes(z)),Bt=!p&&Ae>=y,[$s,yn]=b.useState([]),[dn,In]=b.useState(!1),[hn,sn]=b.useState({}),[ys,K]=b.useState(!1),[he,ie]=b.useState(!1),[be,Ge]=b.useState(""),[Tt,Xt]=b.useState(null),[Lt,Wt]=b.useState([]),[ps,Vs]=b.useState({total:0,favouriteFocus:null,streak:0}),[Is,C]=b.useState(null),[q,de]=b.useState(""),[ke,it]=b.useState(!1);b.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const le=Yt(me,"workoutLogs"),ue=Bs(le,bs("clientId","==",t.id)),Se=(await Ns(ue)).docs.map(lt=>lt.data()),et=Se.filter(lt=>lt.type!=="programme");pe(et.length);const vt=et.reduce((lt,jt)=>lt+(jt.duration||0),0);Ee(vt);const Kt={beginner:0,intermediate:0,advanced:0};et.forEach(lt=>{lt.level&&Kt[lt.level]!==void 0&&Kt[lt.level]++}),ht(Kt);const cs=new Date,S=cs.getDay(),U=S===0?-6:1-S,Te=new Date(cs);Te.setDate(cs.getDate()+U),Te.setHours(0,0,0,0);const Xe=Te.getTime(),He=Se.filter(lt=>{const jt=lt.completedAt;return jt?(jt.toDate?jt.toDate().getTime():new Date(jt).getTime())>=Xe:!1});Qe(He.filter(lt=>lt.type!=="programme").length);let nt=0;if(t)try{const lt=await Ps(Je(me,"clientProgrammes",t.id));if(lt.exists()){const jt=lt.data(),us=jt.templateId;nt=He.filter(ln=>ln.type==="programme"&&ln.programmeId===us).length,C(us);const as=Xp.find(ln=>ln.id===us);as&&de(as.name);const ws=h6[us];if(ws){const ln=Object.keys(jt.completedSessions||{}).length,mn=ws.duration*ws.daysPerWeek;ns(mn>0?Math.round(ln/mn*100):0)}}else C(null),de(""),ns(0)}catch{}at(nt);const Ke=et.map(lt=>lt.completedAt).filter(Boolean).map(lt=>lt.toDate?lt.toDate().getTime():new Date(lt).getTime()).sort((lt,jt)=>jt-lt);if(Ke.length===0)xt(0);else{const lt=new Set;Ke.forEach(mn=>{const zs=new Date(mn),an=zs.getDay(),Nn=an===0?-6:1-an,wn=new Date(zs);wn.setDate(zs.getDate()+Nn),wn.setHours(0,0,0,0),lt.add(wn.getTime())});const jt=[...lt].sort((mn,zs)=>zs-mn);let us=0;const as=new Date(cs),ws=cs.getDay()===0?-6:1-cs.getDay();as.setDate(cs.getDate()+ws),as.setHours(0,0,0,0);let ln=as.getTime();jt.includes(ln)||(ln-=10080*60*1e3);for(let mn=0;mn<200&&jt.includes(ln);mn++)us++,ln-=10080*60*1e3;xt(us)}}catch(le){console.error("Error loading workout stats:",le)}finally{it(!0)}})()},[n,t,_]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const le=Bs(Yt(me,"savedWorkouts"),bs("clientId","==",t.id)),Fe=(await Ns(le)).docs.map(Se=>({id:Se.id,...Se.data()}));Fe.sort((Se,et)=>{const vt=Se.savedAt?.toMillis?.()||Se.savedAt?.seconds*1e3||0;return(et.savedAt?.toMillis?.()||et.savedAt?.seconds*1e3||0)-vt}),yn(Fe)}catch(le){console.error("Error loading saved workouts:",le)}finally{In(!0)}})()},[n,t]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const le=Bs(Yt(me,"workoutLogs"),bs("clientId","==",t.id),Du("completedAt","desc"),Pu(20)),Se=(await Ns(le)).docs.map(He=>He.data()).filter(He=>He.type!=="programme"&&He.type!=="muscle_group");Wt(Se.slice(0,3));const et=Se.length,vt={};Se.forEach(He=>{He.focus&&(vt[He.focus]=(vt[He.focus]||0)+1)});const Kt=Object.keys(vt).sort((He,nt)=>vt[nt]-vt[He])[0]||null;let cs=0;if(Se.length>0){const He=new Set;Se.forEach(lt=>{const jt=lt.completedAt?.toDate?lt.completedAt.toDate():lt.completedAt?new Date(lt.completedAt):null;jt&&He.add(new Date(jt.getFullYear(),jt.getMonth(),jt.getDate()).toDateString())});const nt=new Date;nt.setHours(0,0,0,0);let Ke=new Date(nt);for(He.has(Ke.toDateString())||Ke.setDate(Ke.getDate()-1);He.has(Ke.toDateString());)cs++,Ke.setDate(Ke.getDate()-1)}Vs({total:et,favouriteFocus:Kt,streak:cs});const S={core:null,upper:null,lower:null,fullbody:null};Se.forEach(He=>{if(He.focus&&S[He.focus]===null&&He.completedAt){const nt=He.completedAt.toDate?He.completedAt.toDate():new Date(He.completedAt);S[He.focus]=nt}});let U=null,Te=new Date;const Xe=["core","upper","lower","fullbody"];for(const He of Xe){if(S[He]===null){const nt=ca.find(Ke=>Ke.key===He)?.label||He;U={focus:He,label:nt,daysAgo:null,message:`You haven't tried ${nt} yet`};break}if(S[He]<Te){Te=S[He];const nt=Math.floor((Date.now()-S[He].getTime())/864e5);if(nt>=5){const Ke=ca.find(lt=>lt.key===He)?.label||He;U={focus:He,label:Ke,daysAgo:nt,message:`${Ke}  ${nt} days ago`}}}}Xt(U)}catch(le){console.error("Error loading recent workouts:",le)}})()},[n,t,_]);const _t=async z=>{if(!(!n||!t||I.length===0)){K(!0);try{const le=ca.find(Se=>Se.key===B)?.label||B,ue=z||`${le} ${Z}min`,Fe=await Xr(Yt(me,"savedWorkouts"),{clientId:t.id,name:ue,equipment:O,focus:B,level:te,duration:Z,exercises:I.map(Se=>({name:Se.name,videoUrl:Se.videoUrl,isGif:Se.isGif||!1})),rounds:R,savedAt:Ct.now()});yn(Se=>[{id:Fe.id,clientId:t.id,name:ue,equipment:O,focus:B,level:te,duration:Z,exercises:I.map(et=>({name:et.name,videoUrl:et.videoUrl,isGif:et.isGif||!1})),rounds:R,savedAt:Ct.now()},...Se]),Vt("Workout saved!","success")}catch(le){console.error("Error saving workout:",le),Vt("Failed to save workout","error")}finally{K(!1),ie(!1),Ge("")}}},yt=async z=>{try{await fr(Je(me,"savedWorkouts",z)),yn(le=>le.filter(ue=>ue.id!==z)),Vt("Workout removed","info")}catch(le){console.error("Error deleting saved workout:",le),Vt("Failed to remove workout","error")}},_s=z=>{G(z.equipment||["bodyweight"]),D(z.focus||"core"),Y(z.level||"intermediate"),_e(z.duration||15);const le=Fa.find(ue=>ue.key===(z.level||"intermediate"));$(le),L(z.exercises||[]),Ie(z.rounds||2),j("preview")},Gt=async()=>{const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");z&&(G(z.equipment||["bodyweight"]),D(z.focus||"core"),Y(z.level||"intermediate"),_e(z.duration||15)),setTimeout(()=>$n(),50)},vn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:B,level:te,duration:Z}))};localStorage.getItem("mcf_last_randomiser");const gr=()=>{const z=[];let le;B==="mix"?le=["core","upper","lower"]:B==="fullbody"?le=["upper","lower"]:le=[B];for(const ue of O)for(const Fe of le)z.push(`exercises/${ue}/${Fe}`);return z},yr=async()=>{if(M.current){for(;M.current;)await new Promise(z=>setTimeout(z,200));return V.current}M.current=!0,T(!0);try{const z=gr(),le=[];for(const et of z)try{const vt=vi(xi,et),Kt=await T2(vt);le.push(...Kt.items)}catch{console.warn(`Folder ${et} not found, skipping.`)}if(le.length===0&&O.includes("bodyweight")&&B==="core")try{const et=vi(xi,"core"),vt=await T2(et);le.push(...vt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(le.length===0){const et=O.map(Kt=>Jp.find(cs=>cs.key===Kt)?.label).join(" + "),vt=ca.find(Kt=>Kt.key===B)?.label;return Vt(`No exercises found for ${et} / ${vt}. Upload videos to Firebase Storage.`,"error"),M.current=!1,T(!1),[]}const ue=new Set,Fe=le.filter(et=>{const vt=et.name.replace(/\.(mp4|gif)$/i,"");return ue.has(vt)?!1:(ue.add(vt),!0)}),Se=await Promise.all(Fe.map(async et=>{const vt=await fo(et),Kt=f6(et.name.replace(/\.(mp4|gif)$/i,"")),cs=/\.gif$/i.test(et.name);return{name:Kt,videoUrl:vt,isGif:cs}}));return V.current=Se,we(Se),M.current=!1,T(!1),Se}catch(z){console.error("Error loading exercises:",z);const le=z.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${z.message||z.code||"Unknown error"}`;return Vt(le,"error"),M.current=!1,T(!1),[]}},$n=async()=>{if(Bt)return;vn(),j("spinning"),V.current=[];const z=await yr();if(z.length===0){j("setup");return}const le=Fa.find(S=>S.key===te);$(le);const ue=le.work+le.rest,Fe=Z*60,Se=Math.floor(Fe/ue);let et,vt;Se<=6?(et=Math.max(3,Math.floor(Se/2)),vt=Math.floor(Se/et)):Se<=12?(et=Math.min(6,Math.floor(Se/2)),vt=Math.floor(Se/et)):(et=Math.min(10,Math.floor(Se/2)),vt=Math.floor(Se/et)),vt=Math.max(2,vt);const Kt=p6(z),cs=Kt.slice(0,Math.min(et,Kt.length));L(cs),Ie(vt),setTimeout(()=>j("preview"),2e3)},ma=()=>{j("countdown"),bt(3)};b.useEffect(()=>{if(_!=="countdown")return;if(ut<=0){j("workout"),Ue(1),X(0),ne("work"),ze(mt.work),Pe(!1),Fr();return}xn();const z=setTimeout(()=>bt(le=>le-1),1e3);return()=>clearTimeout(z)},[ut,_]),b.useEffect(()=>{if(_!=="workout"||Be)return;if(De<=0){Vr();return}De<=3&&xn();const z=setTimeout(()=>ze(le=>le-1),1e3);return()=>clearTimeout(z)},[De,_,Be]);const Vr=()=>{if(P==="work")ne("rest"),ze(mt.rest);else{const z=Ye+1;if(z>=I.length){const le=ye+1;if(le>R){os(!0),Wn();return}Ue(le),X(0)}else X(z);ne("work"),ze(mt.work),Fr()}},Wn=async()=>{if(n)try{await Xr(Yt(me,"workoutLogs"),{clientId:t.id,level:te,duration:Z,equipment:O,focus:B,exerciseCount:I.length,rounds:R,exercises:I.map(z=>z.name),completedAt:Ct.now()}),Qe(z=>z+1),pe(z=>z+1),Ee(z=>z+Z),ht(z=>({...z,[te]:(z[te]||0)+1}))}catch(z){console.error("Error saving workout log:",z)}},Mi=async(z,le,ue)=>{if(!(!t||!le))try{const Fe=t.id,Se=await Ps(Je(me,"coreBuddyPBs",Fe)),vt=(Se.exists()?Se.data():null)?.exercises||{},Kt=vt[z];let cs=!1;if(Kt?(le>(Kt.weight||0)||le===(Kt.weight||0)&&ue>(Kt.reps||0))&&(cs=!0):cs=!0,cs){const S={...vt,[z]:{weight:le,reps:ue,achievedAt:Ct.now()}};await Ls(Je(me,"coreBuddyPBs",Fe),{clientId:t.id,exercises:S,updatedAt:Ct.now()}),Vt(`New PB! ${le}kg  ${ue} reps`,"success"),xn(),await ei(z,le)}}catch(Fe){console.error("Error checking PB:",Fe)}},ei=async(z,le)=>{if(t)try{const ue=await Ps(Je(me,"coreBuddyTargets",t.id));if(!ue.exists())return;const Se=(ue.data().targets||{})[z];if(!Se||le<Se.targetWeight)return;const et=await Ps(Je(me,"coreBuddyAchievements",t.id)),vt=et.exists()?et.data():{clientId:t.id,badges:[],totalVolume:0};if(vt.badges.some(U=>U.type==="pb_target"&&U.exercise===z&&U.targetWeight===Se.targetWeight))return;const cs={type:"pb_target",exercise:z,group:d6[z]||"push",targetWeight:Se.targetWeight,achievedAt:Ct.now()},S=[...vt.badges,cs];await Ls(Je(me,"coreBuddyAchievements",t.id),{...vt,badges:S,updatedAt:Ct.now()}),tt(U=>[...U,cs])}catch(ue){console.error("Error checking target badge:",ue)}},Er=async z=>{if(!(!t||z<=0))try{const le=await Ps(Je(me,"coreBuddyAchievements",t.id)),ue=le.exists()?le.data():{clientId:t.id,badges:[],totalVolume:0},Fe=ue.totalVolume||0,Se=Fe+z,et=[];u6.forEach(Kt=>{Se>=Kt.threshold&&Fe<Kt.threshold&&(ue.badges.some(S=>S.type==="volume_milestone"&&S.milestone===Kt.threshold)||et.push({type:"volume_milestone",milestone:Kt.threshold,label:Kt.label,achievedAt:Ct.now()}))});const vt=[...ue.badges,...et];await Ls(Je(me,"coreBuddyAchievements",t.id),{clientId:t.id,badges:vt,totalVolume:Math.round(Se),updatedAt:Ct.now()}),et.length>0&&tt(Kt=>[...Kt,...et])}catch(le){console.error("Error updating volume:",le)}},Da=async z=>{if(zt(z),z.interval){const Fe=[];for(const Se of z.exercises){let et=null,vt=!1;if(Se.storagePath)try{const Kt=vi(xi,Se.storagePath);et=await fo(Kt),vt=/\.gif$/i.test(Se.storagePath)}catch{}Fe.push({name:Se.name,videoUrl:et,isGif:vt})}L(Fe),Ie(z.rounds),$({work:z.work,rest:z.rest}),j("preview");return}const le={};for(const Fe of z.exercises)if(Fe.storagePath)try{const Se=vi(xi,Fe.storagePath);le[Fe.name]={url:await fo(Se),isGif:/\.gif$/i.test(Fe.storagePath)}}catch{}J(le);const ue=z.exercises.map(Fe=>({name:Fe.name,type:Fe.type,targetSets:Fe.sets,targetReps:Fe.reps||0,targetTime:Fe.time||0,sets:[]}));tn(ue),gt(0),rs(0),Qs(""),xs(""),rt(!1),Le(!1),st(0),tt([]),Q(null),j("muscle_workout")},Ii=()=>{const z=re.current;z&&(z.paused?(z.play(),rt(!0)):(z.pause(),rt(!1)))};b.useEffect(()=>{if(_!=="muscle_workout"||!ge||je<=0){_==="muscle_workout"&&ge&&je<=0&&(Le(!1),xn());return}return Ze.current=setTimeout(()=>st(z=>z-1),1e3),()=>clearTimeout(Ze.current)},[_,ge,je]);const Zr=async()=>{const z=vs[wt];let le={};if(z.type==="weighted"){const Se=parseFloat(Ys)||0,et=parseInt(ls)||0;if(et===0){Vt("Enter your reps","error");return}le={weight:Se,reps:et}}else if(z.type==="reps"){const Se=parseInt(ls)||0;if(Se===0){Vt("Enter your reps","error");return}le={reps:Se}}else if(z.type==="timed"){const Se=z.targetTime-je;le={time:Math.max(Se,1)}}const ue=[...vs];ue[wt]={...z,sets:[...z.sets,le]},tn(ue),z.type==="weighted"&&le.weight>0&&await Mi(z.name,le.weight,le.reps);const Fe=z.sets.length+1;if(Fe<z.targetSets)rs(Fe),xs(""),Le(!1),st(0);else if(wt+1<vs.length){const Se=wt+1;gt(Se),rs(0),Qs(""),xs(""),rt(!1),Le(!1),st(0)}else await Ur(ue),ts(!0)},Ur=async z=>{if(!(!n||!t))try{const le=z.reduce((Fe,Se)=>Fe+Se.sets.reduce((et,vt)=>et+(vt.weight||0)*(vt.reps||0),0),0),ue=z.reduce((Fe,Se)=>Fe+Se.sets.length,0);await Xr(Yt(me,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:se,sessionId:Dt?.id,sessionName:Dt?.name,exerciseCount:z.length,totalSets:ue,duration:Math.round(ue*1.5),volume:Math.round(le),exercises:z.map(Fe=>({name:Fe.name,type:Fe.type,sets:Fe.sets})),completedAt:Ct.now()}),le>0&&await Er(le),Et.length>0&&Q({badges:[...Et]})}catch(le){console.error("Error saving muscle group workout log:",le)}},Gn=b.useRef(null),Kn=()=>(Gn.current||(Gn.current=new(window.AudioContext||window.webkitAudioContext)),Gn.current),xn=()=>{try{const z=Kn(),le=z.createOscillator(),ue=z.createGain();le.connect(ue),ue.connect(z.destination),le.frequency.value=880,ue.gain.value=.3,le.start(z.currentTime),le.stop(z.currentTime+.15)}catch{}},Fr=()=>{try{const z=Kn(),le=z.createOscillator(),ue=z.createGain();le.connect(ue),ue.connect(z.destination),le.frequency.value=1200,ue.gain.value=.4,le.start(z.currentTime),le.stop(z.currentTime+.3)}catch{}};b.useEffect(()=>{if(_!=="workout"||P!=="work"||!I[Ye]?.isGif)return;const le=setInterval(()=>{const ue=qt.current;if(!ue)return;const Fe=ue.getAttribute("src");ue.removeAttribute("src"),setTimeout(()=>{qt.current&&qt.current.setAttribute("src",Fe)},0)},4e3);return()=>clearInterval(le)},[_,P,Ye,ye,I]);const br=(z,le,ue)=>{const Fe=Math.round(z/le*c6);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:cD.map((Se,et)=>r.jsx("line",{x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,className:et<Fe?`wk-tick-filled ${ue}`:"wk-tick-empty",strokeWidth:Se.thick?"3":"2"},et))})},fa=()=>{const z=I.length*R;return((ye-1)*I.length+Ye+(P==="rest"?.5:0))/z},lr=It&&r.jsx("div",{className:`toast-notification ${It.type}`,children:It.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(_==="menu")return r.jsx(Ra,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("randomiser_hub"),children:r.jsx("img",{src:A2,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&r.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>x("/upgrade"),children:[r.jsx("img",{src:M2,alt:"Programmes",className:"wk-hero-bg"}),r.jsx("div",{className:"wk-free-card-overlay"}),r.jsxs("div",{className:"wk-free-card-content",children:[r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Programmes"}),r.jsxs("span",{className:"wk-section-count",children:[Xp.length," available"]})]}),r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Xp.map((z,le)=>z.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${le*.06}s`},children:[r.jsx("img",{src:z.image,alt:z.name,className:"wk-prog-img"}),le===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${le*.06}s`},children:[r.jsx("img",{src:M2,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:m6[z.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[z.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:z.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:z.name.toUpperCase()}),r.jsxs("p",{children:[z.daysPerWeek,"x per week  ",z.focus==="fullbody"?"Full Body":z.focus.charAt(0).toUpperCase()+z.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),le===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id))})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Muscle Groups"}),r.jsxs("span",{className:"wk-section-count",children:[ou.length," groups"]})]}),r.jsx("div",{className:"wk-muscle-grid",children:ou.map((z,le)=>r.jsx("button",{className:`wk-muscle-hero-card${z.image?" wk-muscle-thumb":""}`,onClick:()=>{Ht(z.key),j("muscle_sessions")},style:{animationDelay:`${le*.05}s`},children:z.image?r.jsx("img",{src:z.image,alt:z.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:A2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Qp[z.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:z.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:z.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[I2[z.key]?.length||0," sessions"]})]})]})]})},z.key))})]})]}),r.jsx(Ca,{active:"workouts"}),lr]})});if(_==="randomiser_hub"){const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null"),le=z?ca.find(Fe=>Fe.key===z.focus)?.label||z.focus:null,ue=z?Fa.find(Fe=>Fe.key===z.level)?.label||z.level:null;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-hub-heading",children:[r.jsx("div",{className:"wk-hub-icon-wrap",children:r.jsxs("svg",{className:"wk-hub-dice-icon",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"12",cy:"12",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"8.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"})]})}),r.jsx("h2",{children:"Randomiser"}),r.jsx("p",{children:"Generate, save & replay workouts"})]}),ps.total>0&&r.jsxs("div",{className:"wk-hub-stats",children:[r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value",children:ps.total}),r.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),ps.streak>0&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsxs("span",{className:"wk-hub-stat-value",children:[ps.streak,r.jsx("small",{children:"d"})]}),r.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),ps.favouriteFocus&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:mh[ps.favouriteFocus]||"var(--color-primary)"},children:ca.find(Fe=>Fe.key===ps.favouriteFocus)?.label||ps.favouriteFocus}),r.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),r.jsxs("div",{className:"wk-hub-tip",children:[r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),D2[Math.floor(Date.now()/864e5)%D2.length]]}),r.jsxs("div",{className:"wk-hub-actions",children:[r.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>j("setup"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),z&&r.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Gt,disabled:Bt,children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",r.jsxs("span",{className:"wk-hub-quick-meta",children:[le,"  ",ue,"  ",z.duration,"min"]})]})]}),Tt&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Suggested For You"]}),r.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{D(Tt.focus),j("setup")},children:[r.jsxs("div",{className:"wk-hub-suggestion-info",children:[r.jsx("span",{className:"wk-hub-suggestion-label",children:Tt.message}),r.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",$s.length>0&&r.jsx("span",{className:"wk-hub-count",children:$s.length})]}),dn?$s.length===0?r.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[r.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),r.jsx("p",{children:r.jsx("strong",{children:"No saved workouts yet"})}),r.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):r.jsx("div",{className:"wk-hub-saved-categories",children:ca.map(Fe=>{const Se=$s.filter(vt=>vt.focus===Fe.key);if(Se.length===0)return null;const et=hn[Fe.key]||!1;return r.jsxs("div",{className:"wk-hub-saved-cat",children:[r.jsxs("button",{className:`wk-hub-saved-cat-header${et?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":mh[Fe.key]||"var(--color-primary)"},onClick:()=>sn(vt=>({...vt,[Fe.key]:!vt[Fe.key]})),children:[r.jsxs("span",{className:"wk-hub-saved-cat-label",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[Fe.key]||"var(--color-primary)"},children:Fe.label}),r.jsx("span",{className:"wk-hub-saved-cat-count",children:Se.length})]}),r.jsx("svg",{className:`wk-hub-saved-cat-chevron${et?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),et&&r.jsx("div",{className:"wk-hub-saved-list",children:Se.map((vt,Kt)=>{const cs=(vt.equipment||[]).map(U=>Jp.find(Te=>Te.key===U)?.label||U).join(", "),S=Fa.find(U=>U.key===vt.level)?.label||vt.level;return r.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${Kt*.05}s`},children:[r.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>_s(vt),children:[r.jsxs("div",{className:"wk-hub-saved-info",children:[r.jsx("span",{className:"wk-hub-saved-name",children:vt.name}),r.jsx("span",{className:"wk-hub-saved-tags",children:r.jsxs("span",{className:"wk-hub-saved-meta",children:[S,"  ",vt.duration,"min  ",(vt.exercises||[]).length," ex"]})}),cs&&r.jsx("span",{className:"wk-hub-saved-equip",children:cs})]}),r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),r.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>yt(vt.id),"aria-label":"Remove saved workout",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},vt.id)})})]},Fe.key)})}):r.jsx("div",{className:"wk-hub-empty",children:r.jsx("div",{className:"wk-loading-spinner"})})]}),Lt.length>0&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),r.jsx("div",{className:"wk-hub-recent-list",children:Lt.map((Fe,Se)=>{const et=ca.find(S=>S.key===Fe.focus)?.label||Fe.focus||"",vt=Fa.find(S=>S.key===Fe.level)?.label||Fe.level||"",Kt=Fe.completedAt?.toDate?Fe.completedAt.toDate():Fe.completedAt?new Date(Fe.completedAt):null,cs=Kt?(()=>{const S=Math.floor((Date.now()-Kt.getTime())/1e3);return S<3600?`${Math.floor(S/60)}m ago`:S<86400?`${Math.floor(S/3600)}h ago`:`${Math.floor(S/86400)}d ago`})():"";return r.jsxs("div",{className:"wk-hub-recent-card",style:{animationDelay:`${Se*.05}s`},children:[r.jsx("div",{className:"wk-hub-recent-info",children:r.jsxs("span",{className:"wk-hub-recent-tags",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[Fe.focus]||"var(--color-primary)"},children:et}),r.jsxs("span",{className:"wk-hub-recent-meta",children:[vt,"  ",Fe.duration||"?","min  ",Fe.exerciseCount||"?"," ex"]})]})}),r.jsx("span",{className:"wk-hub-recent-time",children:cs})]},Se)})})]})]}),lr]})}if(_==="setup"){const z=ca.find(ue=>ue.key===B)?.label||B,le=Fa.find(ue=>ue.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${F}`,pct:F>0?Math.min(Math.round(F/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ae}/${Yp}`,pct:Math.round(Math.min(Ae,Yp)/Yp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ce}`,pct:Ce>0?Math.min(Math.round(Ce/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ue=>{const Se=2*Math.PI*38,et=Se-ue.pct/100*Se;return r.jsxs("div",{className:`wk-stat-item${ue.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ue.color},strokeDasharray:Se,strokeDashoffset:et})]}),r.jsx("span",{className:"wk-stat-value",style:{color:ue.color},children:ue.value})]}),r.jsx("span",{className:"wk-stat-label",children:ue.label})]},ue.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:ca.map(ue=>r.jsxs("button",{className:`wk-equip-btn${B===ue.key?" active":""}${ue.key==="mix"?" wk-mix-btn":""}`,onClick:()=>D(ue.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ue.icon})}),r.jsx("span",{children:ue.label})]},ue.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Fa.map(ue=>r.jsxs("button",{className:`wk-level-card wk-level-${ue.key}${te===ue.key?" active":""}`,onClick:()=>Y(ue.key),children:[r.jsx("span",{className:"wk-level-name",children:ue.label}),r.jsx("span",{className:"wk-level-desc",children:ue.desc})]},ue.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Zp.map(ue=>{const Fe=!$t.includes(ue);return r.jsxs("button",{className:`wk-time-btn${Z===ue?" active":""}${Fe?" locked":""}`,onClick:()=>!Fe&&_e(ue),disabled:Fe,children:[r.jsx("span",{className:"wk-time-num",children:ue}),r.jsx("span",{className:"wk-time-unit",children:Fe?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},ue)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:Jp.map(ue=>{const Fe=O.includes(ue.key);return r.jsxs("button",{className:`wk-equip-btn${Fe?" active":""}`,onClick:()=>{G(Se=>Fe&&Se.length===1?Se:Fe?Se.filter(et=>et!==ue.key):[...Se,ue.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ue.icon})}),r.jsx("span",{children:ue.label})]},ue.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[z,"  ",le,"  ",Z," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[Bt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:$n,disabled:N||Bt,children:N?"Loading exercises...":Bt?"Limit Reached":"Randomise Workout"})]}),lr]})}if(_==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Yk.map((z,le)=>r.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:"wk-spin-tick",strokeWidth:z.thick?"3.5":"2",style:{animationDelay:`${le*.03}s`}},le))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),lr]});if(_==="preview"){const z=Dt?.interval?{work:Dt.work,rest:Dt.rest}:Fa.find(ue=>ue.key===te),le=I.length*R*(z.work+z.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(Dt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Dt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Dt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:R}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(le/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[z.work,"/",z.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:I.map((ue,Fe)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Fe*.06}s`},onClick:()=>Pt(ue),children:[r.jsx("span",{className:"wk-preview-num",children:Fe+1}),r.jsx("div",{className:"wk-preview-thumb",children:ue.isGif?r.jsx("img",{src:ue.videoUrl,alt:ue.name,loading:"lazy"}):r.jsx("video",{src:`${ue.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:ue.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Fe))}),Rt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Pt(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:ue=>ue.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Pt(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:Rt.isGif?r.jsx("img",{src:Rt.videoUrl,alt:Rt.name}):r.jsx("video",{src:Rt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:Rt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Dt?.interval&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>$n(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsxs("button",{className:"wk-btn-save",onClick:()=>ie(!0),disabled:ys,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),r.jsx("button",{className:"wk-btn-primary",onClick:ma,children:"Start Workout"})]}),he&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>ie(!1),children:r.jsxs("div",{className:"wk-save-modal",onClick:ue=>ue.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:be,onChange:ue=>Ge(ue.target.value),placeholder:`${ca.find(ue=>ue.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>ie(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>_t(be),disabled:ys,children:ys?"Saving...":"Save"})]})]})})]})]})}if(_==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:ut}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(_==="workout"){const z=I[Ye],le=P==="work"?mt.work:mt.rest,ue=P==="rest"?Ye+1<I.length?I[Ye+1]:ye<R?I[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?z.isGif?r.jsx("img",{ref:qt,className:"wk-video",src:z.videoUrl,alt:z.name},z.videoUrl):r.jsx("video",{className:"wk-video",src:z.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},z.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),ue&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",ue.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Ye+1," / ",I.length]}),r.jsx("h2",{className:"wk-exercise-name",children:z.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",ye," of ",R]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[br(De,le,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:De}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Pe(!Be),children:Be?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{ze(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${fa()*100}%`}})}),ot&&(()=>{const Fe=Fa.find(et=>et.key===te),Se=I.length*R*(Fe.work+Fe.rest);return r.jsxs(r.Fragment,{children:[r.jsx(em,{title:"Workout Complete!",stats:[{value:Math.ceil(Se/60),label:"Minutes"},{value:I.length*R,label:"Intervals"},{value:R,label:"Rounds"}],hideShare:!p,onShareJourney:t?Ot:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{os(!1),zt(null),Ht(null)}}),!Dt?.interval&&r.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>ie(!0),disabled:ys,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),he&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>ie(!1),style:{zIndex:10001},children:r.jsxs("div",{className:"wk-save-modal",onClick:et=>et.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:be,onChange:et=>Ge(et.target.value),placeholder:`${ca.find(et=>et.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>ie(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>_t(be),disabled:ys,children:ys?"Saving...":"Save"})]})]})})]})})()]})}if(_==="muscle_sessions"){const z=ou.find(ue=>ue.key===se),le=I2[se]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Qp[se]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:z?.icon})})}),r.jsxs("h2",{children:[z?.label," Workouts"]}),r.jsxs("p",{children:[le.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:le.map((ue,Fe)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{zt(ue),j("muscle_overview")},style:{animationDelay:`${Fe*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:ue.name}),r.jsx("p",{children:ue.desc}),r.jsx("div",{className:"mg-session-meta",children:ue.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[ue.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[ue.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[ue.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Se=ue.exercises.map(Kt=>Kt.sets||0),et=Math.min(...Se),vt=Math.max(...Se);return et===vt?`${et} sets each`:`${et}-${vt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ue.id))})]}),lr]})}if(_==="muscle_overview"){const z=Dt;if(!z)return null;const le=ou.find(ue=>ue.key===se);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:z.image?void 0:{background:Qp[se]},children:z.image?r.jsx("img",{src:z.image,alt:z.name,className:"mg-overview-hero-img"}):r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:le?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:z.name}),z.level&&r.jsx("span",{className:"mg-overview-level",children:z.level})]}),r.jsx("p",{className:"mg-overview-desc",children:z.desc})]}),z.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:z.overview})]}),z.tips&&z.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:z.tips.map((ue,Fe)=>r.jsx("li",{children:ue},Fe))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",z.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:z.exercises.map((ue,Fe)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Fe+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:ue.name}),z.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[z.work,"s work / ",z.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[ue.sets," sets  ",ue.reps?`${ue.reps} reps`:`${ue.time}s`,ue.type==="weighted"&&"  weighted"]})]})]},Fe))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Da(z),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),lr]})}if(_==="muscle_workout"){const z=Dt;if(!z)return null;const le=z.exercises[wt],ue=vs[wt];if(!le||!ue)return null;const Fe=ue.sets.length,Se=z.exercises.length,et=z.exercises.reduce((U,Te)=>U+(Te.sets||0),0),Kt=vs.reduce((U,Te)=>U+Te.sets.length,0)/et*100,cs=pt[le.name];le.type==="timed"&&je===0&&!ge&&Fe===Qt&&setTimeout(()=>st(le.time),0);const S=Fe+1<le.sets?"Log Set":wt+1<Se?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Kt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",wt+1,"/",Se]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[cs?r.jsxs("div",{className:"mg-video-container",onClick:Ii,children:[cs.isGif?r.jsx("img",{className:"mg-video",src:cs.url,alt:le.name}):r.jsx("video",{ref:re,className:"mg-video",src:cs.url,loop:!0,muted:!0,playsInline:!0},le.name),!We&&!cs.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:le.name}),r.jsx("span",{className:`mg-ex-type-badge ${le.type}`,children:le.type==="weighted"?"Weight + Reps":le.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Fe+1," of ",le.sets]}),le.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",le.reps," reps"]}),le.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",le.time,"s"]})]}),le.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ys,onChange:U=>Qs(U.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ls,onChange:U=>xs(U.target.value),placeholder:"0"})]})]}),le.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ls,onChange:U=>xs(U.target.value),placeholder:"0"})]})}),le.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[je,"s"]})}),ge?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Le(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{je===0&&st(le.time),Le(!0)},children:je<le.time&&je>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Zr,children:S}),ue.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:ue.sets.map((U,Te)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Te+1,": ",U.weight!=null?`${U.weight}kg  ${U.reps}`:U.reps!=null?`${U.reps} reps`:`${U.time}s`]})]},Te))})]})]}),lr,As&&(()=>{const U=vs.reduce((nt,Ke)=>nt+Ke.sets.length,0),Te=vs.reduce((nt,Ke)=>nt+Ke.sets.reduce((lt,jt)=>lt+(jt.weight||0)*(jt.reps||0),0),0),Xe=ou.find(nt=>nt.key===se)?.label||"",He=[{value:vs.length,label:"Exercises"},{value:U,label:"Sets"}];return Te>0&&He.push({value:Math.round(Te).toLocaleString(),label:"Volume (kg)"}),r.jsx(em,{title:`${Xe} Complete!`,subtitle:Dt?.name,stats:He,hideShare:!p,onShareJourney:t?Ot:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{ts(!1),zt(null),Ht(null),Q(null)}})})(),Nt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>Q(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:Nt.badges.length===1?"Badge Earned!":`${Nt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:Nt.badges.map((U,Te)=>r.jsx("div",{className:"mg-badge-celebration-item",children:U.type==="pb_target"?`${U.exercise}  ${U.targetWeight}kg`:U.label},Te))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async U=>{U.stopPropagation();const Te=Nt.badges[0],Xe=Nt.badges.map(nt=>nt.type==="pb_target"?`PB Target Hit: ${nt.exercise}  ${nt.targetWeight}kg`:nt.label),He=qn.find(nt=>nt.id===Te?.id)||qn.find(nt=>nt.name===Te?.label);await Ot({type:"badge_earned",title:Xe.length===1?Xe[0]:`${Xe.length} Badges Earned!`,badges:Xe,badgeDesc:He?.desc}),Vt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async U=>{U.stopPropagation();const Te=Nt.badges[0],Xe=Nt.badges.map(Ke=>Ke.type==="pb_target"?`PB Target Hit: ${Ke.exercise}  ${Ke.targetWeight}kg`:Ke.label),He=qn.find(Ke=>Ke.id===Te?.id)||qn.find(Ke=>Ke.name===Te?.label),nt=`Badge Earned! ${Xe.join(", ")}
#MindCoreFitness`;try{const Ke=await nb({type:"badge",title:Xe.length===1?Xe[0]:"Badges Earned!",badges:Xe,badgeImage:He?.img,badgeDesc:He?.desc});navigator.share&&navigator.canShare?.({files:[new File([Ke],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:nt,files:[new File([Ke],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:nt}):(await navigator.clipboard.writeText(nt),Vt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(nt),Vt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const y6=60,b6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},v6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],P2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function fh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const x6={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function w6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isPremium:l}=gc(),{isDark:u,toggleTheme:d,accent:p}=Ia(),g=or(),y=Ma(),[x,_]=b.useState("loading"),[j,O]=b.useState(null),G=b.useRef(!1),[B,D]=b.useState(null),[te,Y]=b.useState(!1),[Z,_e]=b.useState(1),[Me,we]=b.useState(0),[N,T]=b.useState(0),[M,V]=b.useState(0),[I,L]=b.useState([]),[R,Ie]=b.useState(""),[mt,$]=b.useState(""),[ye,Ue]=b.useState(!1),[Ye,X]=b.useState(0),P=b.useRef(null),[ne,De]=b.useState({}),[ze,Be]=b.useState(!1),Pe=b.useRef(null),[ut,bt]=b.useState(null),[ot,os]=b.useState([]);b.useEffect(()=>{window.scrollTo(0,0)},[x]);const[As,ts]=b.useState(null),Rt=b.useCallback((ge,Le="info")=>{ts({message:ge,type:Le}),setTimeout(()=>ts(null),4e3)},[]),Pt=b.useCallback(async ge=>{if(!t)throw new Error("Not signed in");const Le=ge&&typeof ge=="object"&&ge.type;await Xr(Yt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Le?"":ge,type:Le?ge.type:"text",imageURL:null,createdAt:_r(),likeCount:0,commentCount:0,...Le?{metadata:{title:ge.title||"",subtitle:ge.subtitle||"",stats:ge.stats||[],quote:ge.quote||"",badges:ge.badges||[]}}:{}})},[t]),qt=b.useRef(null),It=()=>(qt.current||(qt.current=new(window.AudioContext||window.webkitAudioContext)),qt.current),Ms=()=>{try{const ge=It(),Le=ge.createOscillator(),je=ge.createGain();Le.connect(je),je.connect(ge.destination),Le.frequency.value=1200,je.gain.value=.4,Le.start(ge.currentTime),Le.stop(ge.currentTime+.3)}catch{}};b.useEffect(()=>{!i&&(!n||!e)&&g("/")},[n,e,i,g]),b.useEffect(()=>{if(!t)return;(async()=>{try{const Le=Je(me,"clientProgrammes",t.id),je=await Ps(Le);je.exists()&&D(je.data());const st=y.state?.templateId;if(st&&!G.current){const We=P2.find(rt=>rt.id===st);if(We){G.current=!0,O(We),_("overview");return}}je.exists()?_("dashboard"):g("/client/core-buddy/workouts",{replace:!0})}catch(Le){console.error("Error loading programme:",Le),g("/client/core-buddy/workouts",{replace:!0})}})()},[t]),b.useEffect(()=>{if(!ye||Ye<=0){ye&&Ye<=0&&(Ue(!1),Ms());return}return P.current=setTimeout(()=>X(ge=>ge-1),1e3),()=>clearTimeout(P.current)},[ye,Ye]);const Vt=async ge=>{if(t)try{await Ls(Je(me,"clientProgrammes",t.id),ge),D(ge)}catch(Le){console.error("Error saving programme:",Le),Rt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Ot=async ge=>{const Le={templateId:ge.id,startDate:Ct.now(),completedSessions:{}};await Vt(Le),_("dashboard")},se=async()=>{if(t)try{await fr(Je(me,"clientProgrammes",t.id)),D(null),_("browse")}catch(ge){console.error("Error quitting programme:",ge)}},Ht=()=>B?P2.find(ge=>ge.id===B.templateId):null,Dt=()=>{if(!B?.startDate)return 1;const ge=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),je=new Date-ge,st=Math.floor(je/(1e3*60*60*24));return Math.floor(st/7)+1},zt=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ge=B.completedSessions||{},Le=Object.keys(ge).length,je=Ht();if(!je)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const st=je.duration*je.daysPerWeek,We=Dt(),rt=Math.min(We,je.duration);let pt=0;for(let re=0;re<je.daysPerWeek;re++)ge[`w${rt}d${re}`]&&pt++;if(Le>=st)return{currentWeek:je.duration,completedThisWeek:je.daysPerWeek,nextDay:-1,totalCompleted:Le,totalSessions:st,complete:!0};if(We>je.duration)return{currentWeek:je.duration,completedThisWeek:pt,nextDay:-1,totalCompleted:Le,totalSessions:st,complete:!0};let J=-1;for(let re=0;re<je.daysPerWeek;re++)if(!ge[`w${rt}d${re}`]){J=re;break}return{currentWeek:rt,completedThisWeek:pt,nextDay:J,nextWeek:rt,totalCompleted:Le,totalSessions:st}},wt=ge=>{const Le=Dt();return ge<Le},gt=(ge,Le,je)=>{if(!B||ge<=1)return null;const st=`w${ge-1}d${Le}`,We=B.completedSessions?.[st];if(!We)return null;const rt=We.exercises?.find(pt=>pt.name===je);return rt?.sets?.length?rt.sets[rt.sets.length-1]:null},Qt=(ge,Le)=>{const je=Ht();if(!je)return;_e(ge),we(Le),T(0),V(0),L([]),$(""),Ue(!1),X(0),Be(!1),De({});const st=je.days[Le],We=st.exercises.map(re=>{const Ze=fh(re,ge,je);return{name:re.name,type:re.type,pbKey:re.pbKey,targetSets:Ze.sets,targetReps:Ze.reps,targetTime:Ze.time,sets:[]}});L(We);const rt=st.exercises[0],pt=gt(ge,Le,rt.name);pt?.weight&&rt.type==="weighted"?Ie(String(pt.weight)):Ie(""),(async()=>{const re={};for(const Ze of st.exercises)if(Ze.storagePath)try{const Et=vi(xi,Ze.storagePath),tt=await fo(Et);re[Ze.name]={url:tt,isGif:/\.gif$/i.test(Ze.storagePath)}}catch(Et){console.warn(`Video not found for ${Ze.name}:`,Et)}De(re)})(),_("session")},rs=async()=>{Ht();const ge=I[N];if(!ge)return;let Le={};if(ge.type==="weighted"){const We=parseFloat(R)||0,rt=parseInt(mt)||0;if(rt===0){Rt("Enter your reps","error");return}Le={weight:We,reps:rt}}else if(ge.type==="reps"){const We=parseInt(mt)||0;if(We===0){Rt("Enter your reps","error");return}Le={reps:We}}else if(ge.type==="timed"){const We=ge.targetTime-Ye;Le={time:Math.max(We,1)}}const je=[...I];je[N]={...ge,sets:[...ge.sets,Le]},L(je),ge.type==="weighted"&&Le.weight>0&&await Ys(ge.name,Le.weight,Le.reps);const st=ge.sets.length+1;if(st<ge.targetSets)V(st),Ie(Le.weight?String(Le.weight):""),$(""),Ue(!1),X(0);else if(N+1<I.length){const We=N+1;T(We),V(0),Be(!1);const pt=Ht()?.days[Me]?.exercises[We],J=gt(Z,Me,pt?.name);J?.weight&&pt?.type==="weighted"?Ie(String(J.weight)):Ie(""),$(""),Ue(!1),X(0)}else await vs(je)},vs=async ge=>{if(!B||!t)return;const Le=`w${Z}d${Me}`,je={...B.completedSessions,[Le]:{completedAt:new Date().toISOString(),exercises:ge.map(rt=>({name:rt.name,type:rt.type,sets:rt.sets}))}},st={...B,completedSessions:je};await Vt(st);const We=ge.reduce((rt,pt)=>rt+pt.sets.reduce((J,re)=>J+(re.weight||0)*(re.reps||0),0),0);We>0&&await tn(We);try{const rt=Ht();await Xr(Yt(me,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:rt?.id,programmeName:rt?.name,week:Z,day:Me+1,exerciseCount:ge.length,duration:Math.round(ge.reduce((pt,J)=>pt+J.sets.length*1.5,0)),volume:Math.round(We),completedAt:Ct.now()})}catch(rt){console.error("Error saving workout log:",rt)}ot.length>0&&(bt({badges:[...ot]}),os([])),Y(!0)},tn=async ge=>{if(t)try{const Le=await Ps(Je(me,"coreBuddyAchievements",t.id)),je=Le.exists()?Le.data():{clientId:t.id,badges:[],totalVolume:0},st=je.totalVolume||0,We=st+ge,rt=[];v6.forEach(J=>{We>=J.threshold&&st<J.threshold&&(je.badges.some(Ze=>Ze.type==="volume_milestone"&&Ze.milestone===J.threshold)||rt.push({type:"volume_milestone",milestone:J.threshold,label:J.label,achievedAt:Ct.now()}))});const pt=[...je.badges,...rt];await Ls(Je(me,"coreBuddyAchievements",t.id),{clientId:t.id,badges:pt,totalVolume:Math.round(We),updatedAt:Ct.now()}),rt.length>0&&os(J=>[...J,...rt])}catch(Le){console.error("Error updating volume:",Le)}},Ys=async(ge,Le,je)=>{if(t)try{const st=t.id,We=await Ps(Je(me,"coreBuddyPBs",st)),pt=(We.exists()?We.data():null)?.exercises||{},J=pt[ge];let re=!1;if(J?(Le>(J.weight||0)||Le===(J.weight||0)&&je>(J.reps||0))&&(re=!0):re=!0,re){const Ze={...pt,[ge]:{weight:Le,reps:je,achievedAt:Ct.now()}};await Ls(Je(me,"coreBuddyPBs",st),{clientId:t.id,exercises:Ze,updatedAt:Ct.now()}),Rt(`New PB! ${Le}kg  ${je} reps`,"success"),Ms(),await Qs(ge,Le)}}catch(st){console.error("Error checking PB:",st)}},Qs=async(ge,Le)=>{if(t)try{const je=await Ps(Je(me,"coreBuddyTargets",t.id));if(!je.exists())return;const We=(je.data().targets||{})[ge];if(!We||Le<We.targetWeight)return;const rt=await Ps(Je(me,"coreBuddyAchievements",t.id)),pt=rt.exists()?rt.data():{clientId:t.id,badges:[],totalVolume:0};if(pt.badges.some(Et=>Et.type==="pb_target"&&Et.exercise===ge&&Et.targetWeight===We.targetWeight))return;const re={type:"pb_target",exercise:ge,group:b6[ge]||"push",targetWeight:We.targetWeight,achievedAt:Ct.now()},Ze=[...pt.badges,re];await Ls(Je(me,"coreBuddyAchievements",t.id),{...pt,badges:Ze,updatedAt:Ct.now()}),os(Et=>[...Et,re])}catch(je){console.error("Error checking target badge:",je)}},ls=As&&r.jsxs("div",{className:`toast-notification ${As.type}`,children:[As.type==="success"&&r.jsx("span",{children:" "}),As.message]}),xs=(ge,Le)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Le,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||x==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(x==="browse")return g("/client/core-buddy/workouts",{replace:!0}),null;if(x==="overview"&&j){const ge=j;return r.jsx(Ra,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[xs(ge.name,()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:x6[ge.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ge.name}),r.jsx("p",{className:"pg-overview-desc",children:ge.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ge.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ge.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ge.duration*ge.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ge.days.map((Le,je)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Le.name}),r.jsx("span",{className:"pg-day-label",children:Le.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Le.exercises.map((st,We)=>{const rt=fh(st,1,ge);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:st.name}),r.jsx("span",{className:"pg-day-ex-target",children:st.type==="timed"?`${rt.sets}${rt.time}s`:`${rt.sets}${rt.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${st.type}`,children:st.type==="weighted"?"WT":st.type==="timed"?"TMR":"BW"})]},We)})})]},je))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ge.repProg," reps/week",ge.timeProg?`, +${ge.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Ot(ge),children:"Start Programme"})]}),ls]})})}if(x==="dashboard"){const ge=Ht();if(!ge)return _("browse"),null;const Le=zt(),je=B?.completedSessions||{},st=Le.totalSessions?Math.round(Le.totalCompleted/Le.totalSessions*100):0;return Math.round(Le.totalCompleted/(Le.totalSessions||1)*y6),r.jsx(Ra,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[xs("Programme",()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-st/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[st,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ge.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[st,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Le.currentWeek," of ",ge.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ge.duration},(We,rt)=>{const pt=rt+1,J=wt(pt);return r.jsxs("div",{className:`pg-week-row${pt===Le.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",pt]}),r.jsx("div",{className:"pg-week-days",children:ge.days.map((re,Ze)=>{const Et=`w${pt}d${Ze}`,tt=!!je[Et],Nt=!tt&&J,Q=!tt&&!Nt&&pt===Le.currentWeek&&!Le.complete;return r.jsx("button",{className:`pg-day-dot${tt?" done":""}${Nt?" missed":""}${Q?" next":""}`,disabled:!Q,onClick:()=>{Q&&Qt(pt,Ze)},children:tt?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):Nt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:re.name.replace("Day ","")})},Ze)})})]},rt)})}),!Le.complete&&(()=>{const We=ge.days.map((rt,pt)=>({day:rt,d:pt})).filter(({d:rt})=>!je[`w${Le.currentWeek}d${rt}`]);return We.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:We.length===ge.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Le.currentWeek,"  ",We.length," session",We.length!==1?"s":""," left this week"]}),We.map(({day:rt,d:pt})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[rt.name,": ",rt.label]}),rt.exercises.map((J,re)=>{const Ze=fh(J,Le.currentWeek,ge);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:J.name}),r.jsx("span",{className:"pg-next-ex-target",children:J.type==="timed"?`${Ze.sets}${Ze.time}s`:`${Ze.sets}${Ze.reps}`})]},re)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>Qt(Le.currentWeek,pt),children:["Start ",rt.name]})]},pt))]})})(),Le.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Le.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:se,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&se()},children:"Quit Programme"})]}),r.jsx(Ca,{active:"workouts"}),ls]})})}if(x==="session"){const ge=Ht();if(!ge)return null;const Le=ge.days[Me],je=Le.exercises[N],st=fh(je,Z,ge),We=I[N],rt=We?.sets?.length||0,pt=Le.exercises.length,J=(N+rt/st.sets)/pt,re=ne[je.name],Ze=gt(Z,Me,je.name);je.type==="timed"&&Ye===0&&!ye&&rt===M&&setTimeout(()=>X(st.time),0);const Et=()=>{re?.isGif?Be(!ze):Pe.current&&(ze?Pe.current.pause():Pe.current.play(),Be(!ze))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":u?"dark":"light","data-accent":p,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${J*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&_("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[N+1," / ",pt]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",Z,"  ",Le.name]})]})]}),re&&r.jsxs("div",{className:"pg-video-container",onClick:Et,children:[re.isGif?r.jsx("img",{className:"pg-video",src:re.url,alt:je.name}):r.jsx("video",{ref:Pe,className:"pg-video",src:re.url,loop:!0,muted:!0,playsInline:!0},je.name),!ze&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:je.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${je.type}`,children:je.type==="weighted"?"Weight + Reps":je.type==="timed"?"Timed":"Reps Only"}),je.type==="weighted"&&Ze&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[Ze.weight,"kg x ",Ze.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",rt+1," of ",st.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",je.type==="timed"?`${st.time}s hold`:`${st.reps} reps`]})]}),je.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:R,onChange:tt=>Ie(tt.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:mt,onChange:tt=>$(tt.target.value),placeholder:String(st.reps),className:"pg-input"})]})]}),je.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:mt,onChange:tt=>$(tt.target.value),placeholder:String(st.reps),className:"pg-input"})]})}),je.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Ye,"s"]})}),ye?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>Ue(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Ye===0&&X(st.time),Ue(!0)},children:Ye<st.time&&Ye>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:rs,disabled:je.type==="timed"&&ye,children:rt+1<st.sets?"Log Set":N+1<pt?"Log Set  Next Exercise":"Log Set  Complete"}),We?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:We.sets.map((tt,Nt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Nt+1,": ",tt.weight!==void 0?`${tt.weight}kg  ${tt.reps}`:tt.time!==void 0?`${tt.time}s`:`${tt.reps} reps`]})]},Nt))})]}),te&&(()=>{const Nt=Ht()?.days[Me],Q=I.reduce((dt,at)=>dt+at.sets.length,0),Ae=I.reduce((dt,at)=>dt+at.sets.reduce((ss,ns)=>ss+(ns.weight||0)*(ns.reps||0),0),0),Qe=[{value:I.length,label:"Exercises"},{value:Q,label:"Sets"}];return Ae>0&&Qe.push({value:Math.round(Ae).toLocaleString(),label:"Volume (kg)"}),r.jsx(em,{title:"Session Complete!",subtitle:`Week ${Z}  ${Nt?.name}: ${Nt?.label}`,stats:Qe,buttonLabel:"Back to Programme",hideShare:!l,onShareJourney:t?Pt:null,userName:t?.name,onDismissStart:()=>_("dashboard"),onDone:()=>{Y(!1)}})})(),ut&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>bt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:tt=>tt.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:ut.badges.length===1?"Badge Earned!":`${ut.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:ut.badges.map((tt,Nt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:tt.type==="pb_target"?`${tt.exercise}  ${tt.targetWeight}kg`:tt.label},Nt))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async tt=>{tt.stopPropagation();const Nt=ut.badges[0],Q=ut.badges.map(Qe=>Qe.type==="pb_target"?`PB Target Hit: ${Qe.exercise}  ${Qe.targetWeight}kg`:Qe.label),Ae=qn.find(Qe=>Qe.id===Nt?.id)||qn.find(Qe=>Qe.name===Nt?.label);await Pt({type:"badge_earned",title:Q.length===1?Q[0]:`${Q.length} Badges Earned!`,badges:Q,badgeDesc:Ae?.desc}),Rt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async tt=>{tt.stopPropagation();const Nt=ut.badges[0],Q=ut.badges.map(dt=>dt.type==="pb_target"?`PB Target Hit: ${dt.exercise}  ${dt.targetWeight}kg`:dt.label),Ae=qn.find(dt=>dt.id===Nt?.id)||qn.find(dt=>dt.name===Nt?.label),Qe=`Badge Earned! ${Q.join(", ")}
#MindCoreFitness`;try{const dt=await nb({type:"badge",title:Q.length===1?Q[0]:"Badges Earned!",badges:Q,badgeImage:Ae?.img,badgeDesc:Ae?.desc});navigator.share&&navigator.canShare?.({files:[new File([dt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Qe,files:[new File([dt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Qe}):(await navigator.clipboard.writeText(Qe),Rt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Qe),Rt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>bt(null),children:"Tap to dismiss"})]})}),ls]})}return null}const _6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},k6={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},eg=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function j6(n){return _6[n]||"push"}function T6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function S6(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function E6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=or(),[g,y]=b.useState(!0),[x,_]=b.useState(null),[j,O]=b.useState({}),[G,B]=b.useState([]),[D,te]=b.useState(null),[Y,Z]=b.useState(0),[_e,Me]=b.useState({});b.useRef(null),b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t)return;(async()=>{try{const[ye,Ue,Ye,X]=await Promise.all([Ps(Je(me,"coreBuddyAchievements",t.id)),Ps(Je(me,"coreBuddyPBs",t.id)),Ps(Je(me,"achievements",t.id)),Ns(Bs(Yt(me,"workoutLogs"),bs("clientId","==",t.id)))]);ye.exists()&&_(ye.data()),Ue.exists()&&O(Ue.data().exercises||{}),Ye.exists()&&(B(Object.keys(Ye.data().badges||{})),Me(Ye.data().progress||{})),Z(X.docs.length)}catch(ye){console.error("Error loading achievements:",ye)}y(!1)})()},[t]);const we=x?.badges||[],N=x?.totalVolume||0,T=we.filter($=>$.type==="pb_target"),M=we.filter($=>$.type==="volume_milestone"),V={push:[],pull:[],lower:[],core:[]};T.forEach($=>{const ye=$.group||j6($.exercise);V[ye]&&V[ye].push($)});const I=eg.find($=>N<$.threshold),L=eg.filter($=>N>=$.threshold).pop()?.threshold||0,R=I?(N-L)/(I.threshold-L):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const Ie=we.length+G.length,mt=Ie>0||N>0||Y>0;return r.jsx(Ra,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Ie}),r.jsx("span",{className:"ach-stat-label",children:Ie===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:T6(N)}),r.jsxs("span",{className:"ach-stat-label",children:[S6(N)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!mt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const ye=qn.filter(X=>X.category===$.key);if(ye.length===0)return null;const Ue=(()=>{switch($.key){case"workouts":return Y;case"streaks":return _e.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return _e.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return _e.habitStreak||0;default:return 0}})(),Ye=ye.filter(X=>G.includes(X.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:$.iconPath})}),$.title]}),r.jsx("div",{className:"ach-workout-carousel",children:ye.map(X=>{const P=G.includes(X.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>te(X),children:[r.jsx("img",{src:X.img,alt:X.name,className:"ach-workout-badge-img"}),!P&&X.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ue/X.threshold*100,100)}%`}})})]},X.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Ye,"/",ye.length," unlocked"]})]},$.key)}),D&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[r.jsx("img",{src:D.img,alt:D.name,className:`ach-badge-overlay-img${G.includes(D.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:D.desc}),G.includes(D.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Yk.map(($,ye)=>{const Ue=ye<Math.round(R*60);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Ue?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},ye)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(N).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),I&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:I.label})," (",(I.threshold-N).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:eg.map(($,ye)=>{const Ue=N>=$.threshold,Ye=M.find(X=>X.milestone===$.threshold);return r.jsxs("div",{className:`ach-milestone ${Ue?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),r.jsx("span",{className:"ach-milestone-label",children:$.label}),Ye?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Ye.achievedAt.toDate?Ye.achievedAt.toDate():new Date(Ye.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},ye)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(V).map(([$,ye])=>{if(ye.length===0)return null;const Ue=k6[$];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ue.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Ue.color},children:Ue.label}),r.jsx("span",{className:"ach-group-count",children:ye.length})]}),r.jsx("div",{className:"ach-badge-grid",children:ye.map((Ye,X)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${X*.06}s`,"--group-color":Ue.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ue.color,boxShadow:`0 0 12px ${Ue.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ue.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Ue.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Ye.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Ue.color},children:[Ye.targetWeight,"kg"]}),Ye.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Ye.achievedAt.toDate?Ye.achievedAt.toDate():new Date(Ye.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},X))})]},$)})]})]}),r.jsx(Ca,{active:"home"})]})})}const N6=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],C6="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",R6="#e91e63",A6="#FF4D88",M6=700,Og=42,zl=2*Math.PI*Og,ph=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function I6(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ho(n){return n.toISOString().split("T")[0]}function D6(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function P6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_HABIT_LIMIT:g}=gc(),y=or(),[x,_]=b.useState({}),[j,O]=b.useState([]),[G,B]=b.useState(!0),[D,te]=b.useState(!1),[Y,Z]=b.useState(0),[_e,Me]=b.useState(null),[we,N]=b.useState(null),[T,M]=b.useState(!1),[V,I]=b.useState(!1),[L,R]=b.useState(!1),[Ie,mt]=b.useState(!1),[$,ye]=b.useState(""),[Ue,Ye]=b.useState(null),[X,P]=b.useState([]),[ne,De]=b.useState(null),ze=b.useRef(null),Be=b.useRef(null),Pe=b.useRef(null),ut=b.useRef(null),bt=b.useRef(!1),ot=b.useRef({}),os=b.useRef([]),As=b.useRef([]),ts=b.useRef(null),Rt=b.useRef(ph[Math.floor(Math.random()*ph.length)]),Pt=b.useCallback((Q,Ae="info")=>{Me({message:Q,type:Ae}),setTimeout(()=>Me(null),3e3)},[]),qt=new Date,It=Ho(qt),Ms=I6(qt),Vt=D6(Ms),Ot=["M","T","W","T","F","S","S"],se=(Q,Ae)=>l&&Ae?Ae:Q,Ht=[...N6.filter(Q=>!X.includes(Q.key)).map(Q=>({...Q,color:se(Q.color,Q.darkColor)})),...j.map(Q=>({key:`custom_${Q.id}`,label:Q.label,icon:C6,color:se(R6,A6),isCustom:!0,id:Q.id}))],Dt=p?Ht:Ht.slice(0,g);b.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ae=Yt(me,"habitLogs"),Qe=Bs(Ae,bs("clientId","==",t.id)),dt=await Ns(Qe),at={};dt.docs.forEach(pe=>{const Ne=pe.data();at[Ne.date]={...Ne,_id:pe.id}}),_(at);const ss=await Ps(Je(me,"customHabits",t.id));if(ss.exists()){const pe=ss.data();O(pe.habits||[]),P(pe.hiddenDefaults||[])}let ns=0;const F=new Date(qt);for(;;){const pe=Ho(F),Ne=at[pe];if(Ne)if(Object.values(Ne.habits||{}).filter(Boolean).length>=3)ns++,F.setDate(F.getDate()-1);else break;else if(pe===It)F.setDate(F.getDate()-1);else break}Z(ns)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{B(!1)}})()},[n,t]);const zt=x[It]||{habits:{}};b.useEffect(()=>{Object.values(zt.habits||{}).filter(Boolean).length<Dt.length&&L&&R(!1)},[Dt.length,zt.habits]);const wt=async Q=>{if(!(!n||D||zt.habits?.[Q])){os.current=[...Array(10)].map((Qe,dt)=>{const at=dt/10*2*Math.PI,ss=18+Math.random()*20;return{tx:Math.cos(at)*ss,ty:Math.sin(at)*ss,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),N(Q),setTimeout(()=>N(null),700),navigator.vibrate&&navigator.vibrate(50),te(!0);try{const dt={...zt.habits||{},[Q]:!0},at=zt._id||`${t.id}_${It}`;_(ns=>({...ns,[It]:{clientId:t.id,date:It,habits:dt,_id:at}})),await Ls(Je(me,"habitLogs",at),{clientId:t.id,date:It,habits:dt}),Object.values(dt).filter(Boolean).length===Dt.length&&!L&&(Rt.current=ph[Math.floor(Math.random()*ph.length)],As.current=[...Array(80)].map((ns,F)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][F%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:F%3})),setTimeout(()=>{M(!0),R(!0),setTimeout(()=>ts.current?.focus(),1100)},400))}catch(Qe){console.error("Error saving habit:",Qe),Pt("Failed to save. Try again.","error"),_(dt=>({...dt,[It]:{...dt[It],habits:{...dt[It]?.habits||{},[Q]:!1}}}))}finally{te(!1)}}},gt=async Q=>{if(!(!n||D)){te(!0);try{const Qe={...zt.habits||{},[Q]:!1},dt=zt._id||`${t.id}_${It}`;await Ls(Je(me,"habitLogs",dt),{clientId:t.id,date:It,habits:Qe}),_(at=>({...at,[It]:{clientId:t.id,date:It,habits:Qe,_id:dt}}))}catch(Ae){console.error("Error undoing habit:",Ae),Pt("Failed to undo. Try again.","error")}finally{te(!1)}}},Qt=Q=>{if(zt.habits?.[Q]||!1||D||ut.current)return;ut.current=Q,De(Q),Be.current=performance.now();const Qe=ot.current[Q];Qe&&(Qe.style.strokeDashoffset=zl);const dt=at=>{const ss=at-Be.current,ns=Math.min(ss/M6,1),F=ot.current[Q];F&&(F.style.strokeDashoffset=zl-ns*zl),ns<1?Pe.current=requestAnimationFrame(dt):(ut.current=null,bt.current=!0,Pe.current=null,De(null),wt(Q))};Pe.current=requestAnimationFrame(dt)},rs=()=>{if(!ut.current)return;const Q=ut.current;ut.current=null,Pe.current&&(cancelAnimationFrame(Pe.current),Pe.current=null),ze.current&&(clearTimeout(ze.current),ze.current=null),ot.current[Q]&&(ot.current[Q].style.strokeDashoffset=zl),De(null),Be.current=null};b.useEffect(()=>()=>{Pe.current&&cancelAnimationFrame(Pe.current),ze.current&&clearTimeout(ze.current)},[]);const vs=b.useCallback(async Q=>{if(!t)throw new Error("Not signed in");const Ae=Q&&typeof Q=="object"&&Q.type;await Xr(Yt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":Q,type:Ae?Q.type:"text",imageURL:null,createdAt:_r(),likeCount:0,commentCount:0,...Ae?{metadata:{title:Q.title||"",subtitle:Q.subtitle||"",stats:Q.stats||[],quote:Q.quote||"",badges:Q.badges||[]}}:{}})},[t]),tn=async()=>{const Q=$.trim();if(!Q)return;if(!t?.id){Pt("Still loading, try again","error");return}const Ae=Date.now().toString(36),Qe=[...j,{id:Ae,label:Q}];try{await Ls(Je(me,"customHabits",t.id),{clientId:t.id,habits:Qe,hiddenDefaults:X},{merge:!0}),O(Qe),ye(""),mt(!1),Pt(`Added "${Q}"`,"success")}catch(dt){console.error("Error adding custom habit:",dt),Pt(dt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${dt?.message||"Unknown error"}`,"error")}},Ys=async Q=>{if(!t?.id)return;const Ae=j.filter(Qe=>Qe.id!==Q);try{await Ls(Je(me,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:X},{merge:!0}),O(Ae),Ye(null),Pt("Habit removed","success")}catch(Qe){console.error("Error deleting habit:",Qe),Pt("Failed to remove","error")}},Qs=async Q=>{if(!t?.id)return;const Ae=[...X,Q];try{await Ls(Je(me,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Ae},{merge:!0}),P(Ae),Ye(null),Pt("Habit removed","success")}catch(Qe){console.error("Error hiding default habit:",Qe),Pt("Failed to remove","error")}},ls=Vt.map(Q=>{const Ae=Ho(Q),Qe=x[Ae],dt=Qe?Object.values(Qe.habits||{}).filter(Boolean).length:0;return{date:Q,dateStr:Ae,completed:dt,total:Dt.length}}),xs=ls.reduce((Q,Ae)=>Q+Ae.completed,0),ge=ls.reduce((Q,Ae)=>Q+Ae.total,0),Le=ge>0?Math.round(xs/ge*100):0,je=Object.values(zt.habits||{}).filter(Boolean).length,st=Dt.length>0?Math.round(je/Dt.length*100):0,We=je===Dt.length&&Dt.length>0,rt=(()=>{const Q=Object.keys(x).sort();let Ae=0,Qe=0,dt=null;for(const at of Q){const ss=x[at];if(Object.values(ss.habits||{}).filter(Boolean).length>=3){if(dt){const F=new Date(dt);Qe=(new Date(at)-F)/(1e3*60*60*24)===1?Qe+1:1}else Qe=1;Qe>Ae&&(Ae=Qe),dt=at}else Qe=0,dt=null}return Math.max(Ae,Y)})(),pt=new Date(qt.getFullYear(),qt.getMonth(),1),J=pt.toLocaleString("default",{month:"long"}),re=new Date(qt.getFullYear(),qt.getMonth()+1,0).getDate(),Ze=(pt.getDay()+6)%7,Et=Array.from({length:re},(Q,Ae)=>{const Qe=new Date(qt.getFullYear(),qt.getMonth(),Ae+1),dt=Ho(Qe),at=x[dt],ss=at?Object.values(at.habits||{}).filter(Boolean).length:0,ns=Qe>qt;return{day:Ae+1,dateStr:dt,completed:ss,total:Dt.length,isFuture:ns,isToday:dt===It}}),tt=Dt.map(Q=>({...Q,days:Vt.map(Ae=>{const Qe=Ho(Ae);return x[Qe]?.habits?.[Q.key]||!1})})),Nt=ls.filter(Q=>Q.completed===Q.total&&Q.total>0).length;return r.jsx(Ra,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||G?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-hero anim-fade-up",children:[r.jsxs("div",{className:`cbc-progress-ring${We?" cbc-ring-complete":""}`,children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-st/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-count",children:[je,r.jsx("span",{className:"cbc-ring-divider",children:"/"}),Dt.length]}),r.jsx("span",{className:"cbc-ring-label",children:We?"complete":"today"})]})]}),r.jsx("p",{className:"cbc-hero-tagline",children:We?"You showed up for yourself today.":je===0?"Start your day strong.":`${Dt.length-je} to go  keep pushing.`})]}),r.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[r.jsx("div",{className:"cbc-streak-icon",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),r.jsxs("div",{className:"cbc-streak-info",children:[r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),r.jsxs("div",{className:"cbc-streak-best",children:[r.jsx("span",{className:"cbc-streak-best-val",children:rt}),r.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[Dt.map(Q=>{const Ae=zt.habits?.[Q.key]||!1,Qe=we===Q.key,dt=ne===Q.key;return r.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Qe?"cbc-habit-just-checked":""}`,style:{"--habit-color":Q.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:at=>{at.stopPropagation(),Ye(Q.isCustom?{type:"custom",id:Q.id,label:Q.label}:{type:"default",key:Q.key,label:Q.label})},"aria-label":`Remove ${Q.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${dt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:at=>{Ae||(at.preventDefault(),Qt(Q.key))},onPointerUp:rs,onPointerLeave:rs,onPointerCancel:rs,onClick:at=>{if(at.stopPropagation(),bt.current){bt.current=!1;return}Ae&&gt(Q.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${Q.label}`:`Press and hold to complete ${Q.label}`,onKeyDown:at=>{(at.key==="Enter"||at.key===" ")&&(at.preventDefault(),Ae?gt(Q.key):wt(Q.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Og}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:at=>{at&&(ot.current[Q.key]=at)},cx:"50",cy:"50",r:Og,style:{stroke:Q.color,strokeDasharray:zl,strokeDashoffset:Ae?0:zl}})]}),Ae&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":Q.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:Q.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:Q.icon})})}),Qe&&r.jsx("div",{className:"cbc-particles",children:os.current.map((at,ss)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${at.tx}px`,"--ty":`${at.ty}px`,"--size":`${at.size}px`,"--particle-color":Q.color,animationDuration:`${at.duration}s`}},ss))})]}),r.jsx("span",{className:"cbc-habit-label",children:Q.label}),Ae?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},Q.key)}),p?r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>mt(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):r.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-unlock-ring",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[r.jsxs("div",{className:"cbc-section-header",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsxs("span",{className:"cbc-section-badge",children:[Nt,"/7 perfect"]})]}),r.jsxs("div",{className:"cbc-weekly-card",children:[r.jsxs("div",{className:"cbc-weekly-header",children:[r.jsx("span",{className:"cbc-weekly-habit-name"}),Ot.map((Q,Ae)=>r.jsx("span",{className:`cbc-weekly-day-label${Vt[Ae]&&Ho(Vt[Ae])===It?" cbc-today-label":""}`,children:Q},Ae))]}),tt.map(Q=>(Q.days.filter(Boolean).length,r.jsxs("div",{className:"cbc-weekly-row",children:[r.jsx("span",{className:"cbc-weekly-habit-name",style:{color:Q.color},children:Q.label}),Q.days.map((Ae,Qe)=>r.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${Vt[Qe]&&Ho(Vt[Qe])===It?" cbc-dot-today":""}`,style:Ae?{background:Q.color,borderColor:Q.color,boxShadow:`0 0 6px ${Q.color}40`}:void 0},Qe))]},Q.key))),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Le}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[xs,"/",ge," completed (",Le,"%)"]})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:J}),r.jsxs("div",{className:"cbc-calendar-card",children:[r.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((Q,Ae)=>r.jsx("span",{className:"cbc-cal-day-label",children:Q},Ae))}),r.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Ze},(Q,Ae)=>r.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),Et.map(Q=>{const Ae=Q.total>0?Q.completed/Q.total:0,Qe=Q.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return r.jsx("span",{className:`cbc-cal-cell${Q.isToday?" cbc-cal-today":""}${Qe===4?" cbc-cal-perfect":""} cbc-cal-heat-${Qe<0?"future":Qe}`,children:Q.day},Q.day)})]}),r.jsxs("div",{className:"cbc-cal-legend",children:[r.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),r.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),r.jsx(Ca,{active:"home"}),Ie&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>mt(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:$,onChange:Q=>ye(Q.target.value),maxLength:30,autoFocus:!0,onKeyDown:Q=>Q.key==="Enter"&&tn()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{mt(!1),ye("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:tn,disabled:!$.trim(),children:"Add"})]})]})}),Ue&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ye(null),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ue.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Ye(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ue.type==="custom"?Ys(Ue.id):Qs(Ue.key),children:"Remove"})]})]})}),T&&r.jsx(em,{title:"All Habits Complete!",subtitle:Rt.current,stats:[{value:`${je}/${Dt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?vs:null,userName:t?.name,onDone:()=>{M(!1),I(!1)}}),_e&&r.jsx("div",{className:`toast-notification ${_e.type}`,children:_e.message})]})})}function gh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function L2(n,e){return[n,e].sort().join("_")}function L6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u}=Ia(),d=or(),[p,g]=b.useState("buddies"),[y,x]=b.useState([]),[_,j]=b.useState([]),[O,G]=b.useState([]),[B,D]=b.useState(""),[te,Y]=b.useState([]),[Z,_e]=b.useState([]),[Me,we]=b.useState(!0),[N,T]=b.useState(null),[M,V]=b.useState(null),I=b.useCallback((X,P="info")=>{V({message:X,type:P}),setTimeout(()=>V(null),3500)},[]);b.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const L=b.useCallback(async()=>{if(t){we(!0);try{const X=t.id,ne=(await Ns(Yt(me,"clients"))).docs.map(ot=>({id:ot.id,...ot.data()}));_e(ne);const De=Object.fromEntries(ne.map(ot=>[ot.id,ot])),ze=await Ns(Bs(Yt(me,"buddies"),bs("user1","==",X))),Be=await Ns(Bs(Yt(me,"buddies"),bs("user2","==",X))),Pe=new Set;[...ze.docs,...Be.docs].forEach(ot=>{const os=ot.data(),As=os.user1===X?os.user2:os.user1;Pe.add(As)}),x(Array.from(Pe).map(ot=>De[ot]).filter(Boolean));const ut=await Ns(Bs(Yt(me,"buddyRequests"),bs("toId","==",X),bs("status","==","pending")));j(ut.docs.map(ot=>({reqId:ot.id,...ot.data(),fromClient:De[ot.data().fromId]})).filter(ot=>ot.fromClient));const bt=await Ns(Bs(Yt(me,"buddyRequests"),bs("fromId","==",X),bs("status","==","pending")));G(bt.docs.map(ot=>({reqId:ot.id,...ot.data(),toClient:De[ot.data().toId]})).filter(ot=>ot.toClient))}catch(X){console.error("Error fetching buddy data:",X),I("Failed to load buddies","error")}finally{we(!1)}}},[t,I]);b.useEffect(()=>{L()},[L]),b.useEffect(()=>{if(!B.trim()||!t){Y([]);return}const X=B.toLowerCase(),P=t.id,ne=new Set(y.map(Pe=>Pe.id)),De=new Set(O.map(Pe=>Pe.toId)),ze=new Set(_.map(Pe=>Pe.fromId)),Be=Z.filter(Pe=>Pe.id===P||!Pe.name||!Pe.coreBuddyAccess&&Pe.clientType!=="core_buddy"?!1:Pe.name.toLowerCase().includes(X)).map(Pe=>({...Pe,isBuddy:ne.has(Pe.id),isPendingOut:De.has(Pe.id),isPendingIn:ze.has(Pe.id)})).slice(0,20);Y(Be)},[B,Z,y,O,_,t]);const R=async(X,P)=>{if(!(!t||X===t.id))try{await Xr(Yt(me,"notifications"),{toId:X,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:_r()})}catch(ne){console.error("Notification error:",ne),ne.code==="permission-denied"&&I("Notifications blocked  check Firestore rules","error")}},Ie=async X=>{T(X);try{const P=`${t.id}_${X}`;await Ls(Je(me,"buddyRequests",P),{fromId:t.id,toId:X,status:"pending",createdAt:_r()}),await R(X,"buddy_request"),I("Buddy request sent!","success"),await L()}catch(P){console.error("Error sending request:",P),I("Failed to send request","error")}finally{T(null)}},mt=async X=>{T(X.reqId);try{const P=L2(X.fromId,t.id);await Ls(Je(me,"buddies",P),{user1:[X.fromId,t.id].sort()[0],user2:[X.fromId,t.id].sort()[1],connectedAt:_r()}),await fr(Je(me,"buddyRequests",X.reqId)),await R(X.fromId,"buddy_accept"),I("Buddy added!","success"),await L()}catch(P){console.error("Error accepting request:",P),I("Failed to accept","error")}finally{T(null)}},$=async X=>{T(X.reqId);try{await fr(Je(me,"buddyRequests",X.reqId)),I("Request declined","info"),await L()}catch(P){console.error("Error declining:",P),I("Failed to decline","error")}finally{T(null)}},ye=async X=>{T(X.reqId);try{await fr(Je(me,"buddyRequests",X.reqId)),I("Request cancelled","info"),await L()}catch(P){console.error("Error cancelling:",P),I("Failed to cancel","error")}finally{T(null)}},Ue=async X=>{T(X);try{const P=L2(t.id,X);await fr(Je(me,"buddies",P)),I("Buddy removed","info"),await L()}catch(P){console.error("Error removing buddy:",P),I("Failed to remove buddy","error")}finally{T(null)}},Ye=_.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Ra,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Ye>0&&r.jsx("span",{className:"bdy-tab-badge",children:Ye})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Me?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:gh(X.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:X.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Ue(X.id)},disabled:N===X.id,"aria-label":"Remove buddy",children:N===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},X.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[_.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:_.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.fromClient.photoURL?r.jsx("img",{src:X.fromClient.photoURL,alt:X.fromClient.name}):r.jsx("span",{children:gh(X.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>mt(X),disabled:N===X.reqId,children:N===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(X),disabled:N===X.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},X.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.toClient?.photoURL?r.jsx("img",{src:X.toClient.photoURL,alt:X.toClient.name}):r.jsx("span",{children:gh(X.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ye(X),disabled:N===X.reqId,children:N===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},X.reqId))})]}),_.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:B,onChange:X=>D(X.target.value),autoFocus:!0}),B&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>D(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',B,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:gh(X.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.name}),X.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),X.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):X.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):X.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const ne=_.find(De=>De.fromId===X.id);ne&&mt(ne)},disabled:!!N,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Ie(X.id)},disabled:N===X.id,children:N===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},X.id))})]})]})]}),r.jsx(Ca,{}),M&&r.jsxs("div",{className:`toast-notification ${M.type}`,children:[r.jsx("span",{className:"toast-icon",children:M.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:M.message})]})]})})}function yh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function tg(n,e){return[n,e].sort().join("_")}const O6=5;function sg(n){return n.toISOString().split("T")[0]}function B6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const V6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function O2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function U6(){const{userId:n}=_S(),{currentUser:e,isClient:t,clientData:i,loading:l}=Br(),{isDark:u,toggleTheme:d}=Ia(),p=or(),[g,y]=b.useState(null),[x,_]=b.useState("none"),[j,O]=b.useState(null),[G,B]=b.useState(!0),[D,te]=b.useState(!1),[Y,Z]=b.useState(null),[_e,Me]=b.useState([]),[we,N]=b.useState(!1),[T,M]=b.useState(new Set),[V,I]=b.useState(new Set),[L,R]=b.useState({}),[Ie,mt]=b.useState({}),[$,ye]=b.useState({}),[Ue,Ye]=b.useState(!0),[X,P]=b.useState(0),[ne,De]=b.useState(0),[ze,Be]=b.useState(0),[Pe,ut]=b.useState(0),[bt,ot]=b.useState([]),[os,As]=b.useState([]),[ts,Rt]=b.useState(null),[Pt,qt]=b.useState(null),[It,Ms]=b.useState(0),[Vt,Ot]=b.useState([]),[se,Ht]=b.useState(!1),[Dt,zt]=b.useState(null),[wt,gt]=b.useState([]),Qt=b.useCallback((J,re="info")=>{Z({message:J,type:re}),setTimeout(()=>Z(null),3500)},[]);b.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),b.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),b.useEffect(()=>{if(!i||!n||i.id===n)return;let J=!1;return(async()=>{B(!0);try{const Et=(await Ns(Yt(me,"clients"))).docs.map(Ae=>({id:Ae.id,...Ae.data()})).find(Ae=>Ae.id===n);if(!Et){J||B(!1);return}J||y(Et);const tt=i.id,Nt=tg(tt,n);if((await Ps(Je(me,"buddies",Nt))).exists())J||_("buddy");else{const Ae=`${tt}_${n}`,Qe=await Ps(Je(me,"buddyRequests",Ae));if(Qe.exists()&&Qe.data().status==="pending")J||(_("pending_out"),O(Ae));else{const dt=`${n}_${tt}`,at=await Ps(Je(me,"buddyRequests",dt));at.exists()&&at.data().status==="pending"?J||(_("pending_in"),O(dt)):J||_("none")}}}catch(re){console.error("Error loading profile:",re)}finally{J||B(!1)}})(),()=>{J=!0}},[i,n]),b.useEffect(()=>{if(!n||!g)return;let J=!1;return(async()=>{Ye(!0);try{const[re,Ze,Et,tt]=await Promise.all([Ns(Bs(Yt(me,"workoutLogs"),bs("clientId","==",n))),Ps(Je(me,"coreBuddyAchievements",n)),Ps(Je(me,"coreBuddyPBs",n)),Ps(Je(me,"clientProgrammes",n))]);if(J)return;const Nt=re.docs.length;P(Nt),Ze.exists()&&De(Ze.data().totalVolume||0);let Q=0;const Ae=re.docs.map(at=>at.data().date).filter(Boolean).sort().reverse();if(Ae.length>0){const at=new Date;let ss=new Date(at);for(let ns=0;ns<52;ns++){const F=new Date(ss),pe=F.getDay(),Ne=pe===0?6:pe-1;F.setDate(F.getDate()-Ne),F.setHours(0,0,0,0);const Ee=new Date(F);Ee.setDate(Ee.getDate()+7);const Ce=sg(F),xt=sg(Ee);if(Ae.some(ht=>ht>=Ce&&ht<xt))Q++;else{if(ns>0)break;break}ss.setDate(ss.getDate()-7)}}if(J||Be(Q),Et.exists()){const at=Et.data().exercises||{},ss=Object.entries(at).sort(([,ns],[,F])=>(F.weight||0)-(ns.weight||0)).slice(0,3).map(([ns,F])=>({name:ns,weight:F.weight,reps:F.reps}));J||ot(ss)}if(tt.exists()){const at=tt.data(),ss=V6[at.templateId];if(ss){const ns=Object.keys(at.completedSessions||{}).length,F=ss.duration*ss.daysPerWeek;J||(qt(at.templateId.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase())),Ms(F>0?Math.round(ns/F*100):0))}}const Qe=await Ps(Je(me,"achievements",n));if(!J&&Qe.exists()){const at=Qe.data().badges||{};As(Object.keys(at))}let dt=0;for(let at=0;at<30;at++){const ss=new Date;ss.setDate(ss.getDate()-at);const ns=sg(ss);try{const F=await Ns(Bs(Yt(me,"habitLogs"),bs("clientId","==",n),bs("date","==",ns)));if(F.empty)break;{const pe=F.docs[0].data().habits||{};if(Object.values(pe).filter(Boolean).length>=O6)dt++;else break}}catch{break}}J||ut(dt)}catch(re){console.error("Error loading buddy stats:",re)}finally{J||Ye(!1)}})(),()=>{J=!0}},[n,g]),b.useEffect(()=>{if(!i)return;const J=i.id;(async()=>{try{const[re,Ze,Et]=await Promise.all([Ns(Bs(Yt(me,"buddies"),bs("user1","==",J))),Ns(Bs(Yt(me,"buddies"),bs("user2","==",J))),Ns(Yt(me,"clients"))]),tt=new Set;[...re.docs,...Ze.docs].forEach(Q=>{const Ae=Q.data();tt.add(Ae.user1===J?Ae.user2:Ae.user1)});const Nt={};Et.docs.forEach(Q=>{Nt[Q.id]=Q.data()}),Ot(Array.from(tt).filter(Q=>Nt[Q]).map(Q=>({id:Q,name:Nt[Q].name,photoURL:Nt[Q].photoURL||null})))}catch(re){console.error("Error loading buddies for mentions:",re)}})()},[i]);const rs=async(J,re,Ze={})=>{if(!(!i||J===i.id))try{await Xr(Yt(me,"notifications"),{toId:J,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:re,read:!1,createdAt:_r(),...Ze})}catch(Et){console.error("Notification error:",Et),Et.code==="permission-denied"&&Qt("Notifications blocked  check Firestore rules","error")}},vs=async()=>{te(!0);try{const J=`${i.id}_${n}`;await Ls(Je(me,"buddyRequests",J),{fromId:i.id,toId:n,status:"pending",createdAt:_r()}),await rs(n,"buddy_request"),_("pending_out"),O(J),Qt("Buddy request sent!","success")}catch(J){console.error(J),Qt("Failed to send request","error")}finally{te(!1)}},tn=async()=>{if(j){te(!0);try{const J=tg(i.id,n);await Ls(Je(me,"buddies",J),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:_r()}),await fr(Je(me,"buddyRequests",j)),await rs(n,"buddy_accept"),_("buddy"),Qt("Buddy added!","success")}catch(J){console.error(J),Qt("Failed to accept","error")}finally{te(!1)}}},Ys=async()=>{if(j){te(!0);try{await fr(Je(me,"buddyRequests",j)),_("none"),Qt(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(J){console.error(J),Qt("Failed","error")}finally{te(!1)}}},Qs=async()=>{te(!0);try{const J=tg(i.id,n);await fr(Je(me,"buddies",J)),_("none"),Qt("Buddy removed","info")}catch(J){console.error(J),Qt("Failed to remove","error")}finally{te(!1)}},ls=b.useCallback(async()=>{if(n){N(!0);try{const J=await Ns(Bs(Yt(me,"posts"),bs("authorId","==",n),Du("createdAt","desc"),Pu(30)));if(Me(J.docs.map(re=>({id:re.id,...re.data()}))),i){const re=await Ns(Bs(Yt(me,"postLikes"),bs("userId","==",i.id)));M(new Set(re.docs.map(Ze=>Ze.data().postId)))}}catch(J){console.error("Error loading journey:",J)}finally{N(!1)}}},[n,i]);b.useEffect(()=>{!G&&g&&ls()},[G,g,ls]);const xs=async J=>{if(window.confirm("Delete this post?"))try{await fr(Je(me,"posts",J)),Me(re=>re.filter(Ze=>Ze.id!==J)),Qt("Post deleted","info")}catch(re){console.error("Delete error:",re),Qt("Failed to delete","error")}},ge=async J=>{if(!i)return;const re=i.id,Ze=`${J}_${re}`,Et=T.has(J),tt=new Set(T);Et?tt.delete(J):tt.add(J),M(tt),Me(Nt=>Nt.map(Q=>Q.id===J?{...Q,likeCount:Math.max(0,(Q.likeCount||0)+(Et?-1:1))}:Q));try{if(Et)await fr(Je(me,"postLikes",Ze)),await ua(Je(me,"posts",J),{likeCount:Yo(-1)});else{await Ls(Je(me,"postLikes",Ze),{postId:J,userId:re,createdAt:_r()}),await ua(Je(me,"posts",J),{likeCount:Yo(1)});const Nt=_e.find(Q=>Q.id===J);Nt&&rs(Nt.authorId,"like",{postId:J})}}catch(Nt){console.error("Like error:",Nt),ls()}},Le=async J=>{try{const re=await Ns(Bs(Yt(me,"postComments"),bs("postId","==",J),Du("createdAt","asc"),Pu(50)));R(Ze=>({...Ze,[J]:re.docs.map(Et=>({id:Et.id,...Et.data()}))}))}catch(re){console.error("Error loading comments:",re)}},je=J=>{const re=new Set(V);re.has(J)?re.delete(J):(re.add(J),L[J]||Le(J)),I(re)},st=(J,re)=>{const Ze=J.match(/@(\w*)$/);if(Ze){Ht(!0),zt(re);const Et=Vt.filter(tt=>tt.name&&tt.name.toLowerCase().includes(Ze[1].toLowerCase())).slice(0,5);gt(Et)}else Ht(!1),gt([])},We=(J,re)=>{const Et=(Ie[re]||"").replace(/@\w*$/,`@${J.name} `);mt(tt=>({...tt,[re]:Et})),Ht(!1),gt([])},rt=(J,re)=>{mt(Ze=>({...Ze,[J]:re})),st(re,J)},pt=async J=>{const re=(Ie[J]||"").trim();if(!(!re||!i)){ye(Ze=>({...Ze,[J]:!0}));try{await Xr(Yt(me,"postComments"),{postId:J,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:re,createdAt:_r()}),await ua(Je(me,"posts",J),{commentCount:Yo(1)});const Ze=_e.find(tt=>tt.id===J);Ze&&rs(Ze.authorId,"comment",{postId:J});const Et=re.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Et){const tt=new Set;Et.forEach(Nt=>{const Q=Nt.slice(1).trim(),Ae=Vt.find(Qe=>Qe.name&&Qe.name.toLowerCase()===Q.toLowerCase());Ae&&!tt.has(Ae.id)&&(tt.add(Ae.id),rs(Ae.id,"mention",{postId:J}))})}mt(tt=>({...tt,[J]:""})),Me(tt=>tt.map(Nt=>Nt.id===J?{...Nt,commentCount:(Nt.commentCount||0)+1}:Nt)),await Le(J)}catch(Ze){console.error("Comment error:",Ze),Qt("Failed to comment","error")}finally{ye(Ze=>({...Ze,[J]:!1}))}}};return l||G||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Ra,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:yh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:vs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ys,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:tn,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ys,disabled:D,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Qs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ue?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:X}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[B6(ne),r.jsx("span",{className:"prf-stat-unit",children:ne>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[ne>=1e6?"Million kg":ne>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[ze,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(Pt||Pe>0)&&r.jsxs("div",{className:"prf-info-row",children:[Pt&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:Pt}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(It,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[It,"% complete"]})]})]}),Pe>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Pe," day",Pe!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),bt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:bt.map((J,re)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:re===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${re+1}`}),r.jsx("span",{className:"prf-pb-name",children:J.name}),r.jsxs("span",{className:"prf-pb-weight",children:[J.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",J.reps]})]},re))})]}),os.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",os.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:os.map(J=>{const re=qn.find(Ze=>Ze.id===J);return re?r.jsx("button",{className:"prf-badge-chip",onClick:()=>Rt(re),children:r.jsx("img",{src:re.img,alt:re.name,className:"prf-badge-chip-img"})},J):null})})]}),ts&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>Rt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:J=>J.stopPropagation(),children:[r.jsx("img",{src:ts.img,alt:ts.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:ts.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Rt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),we?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):_e.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:_e.map(J=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:J.authorPhotoURL?r.jsx("img",{src:J.authorPhotoURL,alt:""}):r.jsx("span",{children:yh(J.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:J.authorName}),r.jsx("span",{className:"journey-post-time",children:O2(J.createdAt)})]}),J.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>xs(J.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),J.content&&r.jsx("p",{className:"journey-post-content",children:J.content}),J.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:J.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(J.id)?" liked":""}`,onClick:()=>ge(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(J.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:J.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${V.has(J.id)?" active":""}`,onClick:()=>je(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:J.commentCount||0})]})]}),V.has(J.id)&&r.jsxs("div",{className:"journey-comments",children:[L[J.id]?.length>0?L[J.id].map(re=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${re.authorId}`),children:re.authorPhotoURL?r.jsx("img",{src:re.authorPhotoURL,alt:""}):r.jsx("span",{children:yh(re.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:re.authorName}),r.jsx("span",{className:"journey-comment-text",children:re.content})]}),r.jsx("span",{className:"journey-comment-time",children:O2(re.createdAt)})]})]},re.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ie[J.id]||"",onChange:re=>rt(J.id,re.target.value),onKeyDown:re=>{re.key==="Enter"&&pt(J.id)},maxLength:300}),se&&Dt===J.id&&wt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:wt.map(re=>r.jsxs("button",{className:"mention-option",onClick:()=>We(re,J.id),children:[r.jsx("div",{className:"mention-option-avatar",children:re.photoURL?r.jsx("img",{src:re.photoURL,alt:""}):r.jsx("span",{children:yh(re.name)})}),r.jsx("span",{children:re.name})]},re.id))}),r.jsx("button",{onClick:()=>pt(J.id),disabled:!(Ie[J.id]||"").trim()||$[J.id],children:$[J.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},J.id))})]})]}),r.jsx(Ca,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(Ca,{})]})}const ng=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],B2=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"achievements",label:"Achievements",desc:"Badge showcase and progress",icon:"medal"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function F6(n){switch(n){case"rings":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),r.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),r.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),r.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 17v4"})]});case"apple":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),r.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),r.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),r.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"15",r:"6"}),r.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 18h6"}),r.jsx("path",{d:"M10 22h4"}),r.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function z6(){const n=or(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Br(),[u,d]=b.useState({hours:0,minutes:0,seconds:0}),[p,g]=b.useState(0),[y,x]=b.useState(0),[_,j]=b.useState(null),[O,G]=b.useState(!1),B=b.useRef(null),[D,te]=b.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:B2.filter(R=>R.defaultOn).map(R=>R.id)}),[Y,Z]=b.useState(!1),[_e,Me]=b.useState(!1),[we,N]=b.useState(null);b.useEffect(()=>{e?.photoURL&&j(e.photoURL)},[e?.photoURL]),b.useEffect(()=>{const L=()=>{const Ie=new Date,mt=new Date(Ie);mt.setHours(23,59,59,999);const $=mt-Ie;d({hours:Math.floor($/36e5),minutes:Math.floor($%36e5/6e4),seconds:Math.floor($%6e4/1e3)}),g(60-Math.floor($%6e4/1e3))};L();const R=setInterval(L,1e3);return()=>clearInterval(R)},[]),b.useEffect(()=>{const L=setInterval(()=>x(R=>(R+1)%ng.length),8e3);return()=>clearInterval(L)},[]);const T=async L=>{const R=L.target.files?.[0];if(!(!R||!e?.id)){G(!0);try{const Ie=vi(xi,`profilePhotos/${e.id}`);await Mh(Ie,R);const mt=await fo(Ie);await ua(Je(me,"clients",e.id),{photoURL:mt}),j(mt),i({photoURL:mt})}catch(Ie){console.error("Photo upload error:",Ie)}finally{G(!1)}}},M=L=>{Me(!1),te(R=>R.includes(L)?R.filter(Ie=>Ie!==L):[...R,L])},V=(L,R)=>{Me(!1),te(Ie=>{const mt=Ie.indexOf(L);if(mt<0)return Ie;const $=mt+R;if($<0||$>=Ie.length)return Ie;const ye=[...Ie];return[ye[mt],ye[$]]=[ye[$],ye[mt]],ye})},I=async()=>{Z(!0),N(null);try{const L=e||await l();if(!L?.id){N("Could not find your profile. Try refreshing."),Z(!1);return}await ua(Je(me,"clients",L.id),{dashboardWidgets:D}),i({dashboardWidgets:D}),Me(!0)}catch(L){console.error("Save config error:",L),N("Save failed  please try again.")}finally{Z(!1)}};return r.jsx(Ra,{children:r.jsxs("div",{className:"bldr-page",children:[r.jsxs("div",{className:"bldr-container",children:[r.jsxs("div",{className:"bldr-header",children:[r.jsx("button",{className:"bldr-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),r.jsxs("div",{className:"bldr-ring-container",children:[r.jsxs("div",{className:"bldr-ring",children:[r.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Em.map((L,R)=>r.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${R<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},R))}),r.jsxs("div",{className:"bldr-ring-center",children:[r.jsxs("div",{className:"bldr-ring-photo",onClick:()=>B.current?.click(),children:[r.jsx("img",{src:_||"/Logo.webp",alt:_?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?r.jsx("div",{className:"bldr-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:B,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!_&&!O&&r.jsx("div",{className:"bldr-photo-badge",onClick:()=>B.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"bldr-countdown",children:[r.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),r.jsxs("p",{className:"bldr-tagline",children:[ng[y].text," ",r.jsx("strong",{children:ng[y].bold})]})]}),r.jsxs("div",{className:"bldr-section",children:[r.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),r.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),r.jsx("div",{className:"bldr-widgets-list",children:B2.map(L=>{const R=D.includes(L.id),Ie=D.indexOf(L.id);return r.jsxs("div",{className:`bldr-widget-card${R?" active":""}`,children:[r.jsx("div",{className:"bldr-widget-icon",children:F6(L.icon)}),r.jsxs("div",{className:"bldr-widget-info",children:[r.jsx("div",{className:"bldr-widget-label",children:L.label}),r.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),r.jsxs("div",{className:"bldr-widget-actions",children:[R&&r.jsxs("div",{className:"bldr-widget-order",children:[r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,-1),disabled:Ie===0,"aria-label":"Move up",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M18 15l-6-6-6 6"})})}),r.jsx("span",{className:"bldr-order-num",children:Ie+1}),r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,1),disabled:Ie===D.length-1,"aria-label":"Move down",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),r.jsx("button",{className:`bldr-toggle${R?" on":""}`,onClick:()=>M(L.id),"aria-label":R?`Remove ${L.label}`:`Add ${L.label}`,children:r.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),r.jsxs("div",{className:"bldr-save-wrap",children:[r.jsx("button",{className:`bldr-save-btn${_e?" saved":""}`,onClick:I,disabled:Y||_e,children:Y?"Saving...":_e?"Saved":"Save Dashboard"}),we&&r.jsx("p",{className:"bldr-save-error",children:we}),_e&&r.jsx("button",{className:"bldr-view-btn",onClick:()=>n("/client/core-buddy"),children:"View Dashboard"})]})]}),r.jsx(Ca,{active:"home"})]})})}const _a=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],$o=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ka(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function H6(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function $6(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function bh(n,e){if(!e)return"-";switch(n.unit){case"weight":return $6(e.weight,e.reps);case"time":return H6(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function ql(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function rg(n,e){return!e||e===0?null:(n-e)/e*100}function W6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];if(!D)return 0;switch(t){case"weight":return(D.weight||0)*(D.reps||0);case"time":return D.time||0;case"reps":return D.reps||0;case"distance":return D.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const te=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:te,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),G=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:G,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function G6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[G,B]=b.useState(!1),[D,te]=b.useState({}),[Y,Z]=b.useState({}),[_e,Me]=b.useState({}),[we,N]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,R]=b.useState({}),[Ie,mt]=b.useState([]),[$,ye]=b.useState(null),[Ue,Ye]=b.useState(null),[X,P]=b.useState(!1),[ne,De]=b.useState(""),[ze,Be]=b.useState(""),Pe=b.useRef(null),ut=b.useRef(0),bt=b.useRef(0),ot=b.useRef("right"),os=b.useCallback(F=>{y(pe=>{const Ne=Math.max(0,Math.min(_a.length-1,F));return Ne===pe?pe:(ot.current=Ne>pe?"right":"left",Ne)})},[]),{currentUser:As,isClient:ts,clientData:Rt,loading:Pt}=Br(),{isDark:qt}=Ia(),It=or(),Ms=b.useCallback((F,pe="info")=>{Ye({message:F,type:pe}),setTimeout(()=>Ye(null),4e3)},[]);b.useEffect(()=>{!Pt&&(!As||!ts)&&It("/")},[As,ts,Pt,It]),b.useEffect(()=>{Rt&&Vt()},[Rt]);const Vt=async()=>{try{const F=Bs(Yt(me,"juniorPBs"),bs("clientId","==",Rt.id)),Ne=(await Ns(F)).docs.map(ht=>({id:ht.id,...ht.data()}));Ne.sort((ht,$t)=>ht.month.localeCompare($t.month)),i(Ne);const Ee=Bs(Yt(me,"juniorPBTargets"),bs("clientId","==",Rt.id)),Ce=await Ns(Ee);if(!Ce.empty){const ht=Ce.docs[0].data();Me(ht.targets||{}),N(ht.metricTargets||{}),M(ht.targets||{}),R(ht.metricTargets||{})}const xt=Bs(Yt(me,"juniorAchievements"),bs("clientId","==",Rt.id)),At=await Ns(xt);At.empty||mt(At.docs[0].data().badges||[])}catch(F){console.error("Error fetching junior personal bests:",F)}u(!1)},Ot=q6(),se=t.find(F=>F.month===Ot),Ht=t.filter(F=>F.month<Ot),Dt=Ht.length>0?Ht[Ht.length-1]:null;b.useEffect(()=>{se?(te(se.benchmarks||{}),Z(se.bodyMetrics||{})):(te({}),Z({}))},[se?.id]);const zt=async(F,pe)=>{const Ne=[];if(F==="strength"?_a.forEach(Ee=>{const Ce=_e[Ee.key];if(!Ce)return;const xt=pe[Ee.key];if(!xt)return;let At;if(Ce.targetType==="time"){if(!Ce.targetValue)return;const ht=Ce.startValue||0,$t=xt.time||0,Bt=Ce.targetValue-ht;At=Bt===0?$t>=Ce.targetValue?1:0:Math.max(0,($t-ht)/Bt)}else if(Ce.targetType==="reps"){if(!Ce.targetReps)return;const ht=Ce.startReps||0,$t=xt.reps||0,Bt=Ce.targetReps-ht;At=Bt===0?$t>=Ce.targetReps?1:0:Math.max(0,($t-ht)/Bt)}else if(Ce.targetType==="distance"){if(!Ce.targetDistance)return;const ht=Ce.startDistance||0,$t=xt.distance||0,Bt=Ce.targetDistance-ht;At=Bt===0?$t>=Ce.targetDistance?1:0:Math.max(0,($t-ht)/Bt)}else{if(!Ce.targetWeight&&!Ce.targetReps)return;const ht=(Ce.startWeight||0)*(Ce.startReps||0),$t=(Ce.targetWeight||0)*(Ce.targetReps||0),Bt=(xt.weight||0)*(xt.reps||0),$s=$t-ht;At=$s===0?Bt>=$t?1:0:Math.max(0,(Bt-ht)/$s)}if(At>=1){let ht,$t;Ce.targetType==="time"?(ht=Ie.some(Bt=>Bt.type==="strength"&&Bt.key===Ee.key&&Bt.targetValue===Ce.targetValue),$t=`${Ee.name} ${Ce.targetValue}s`):Ce.targetType==="reps"?(ht=Ie.some(Bt=>Bt.type==="strength"&&Bt.key===Ee.key&&Bt.targetReps===Ce.targetReps),$t=`${Ee.name} ${Ce.targetReps} reps`):Ce.targetType==="distance"?(ht=Ie.some(Bt=>Bt.type==="strength"&&Bt.key===Ee.key&&Bt.targetDistance===Ce.targetDistance),$t=`${Ee.name} ${Ce.targetDistance}cm`):(ht=Ie.some(Bt=>Bt.type==="strength"&&Bt.key===Ee.key&&Bt.targetWeight===Ce.targetWeight&&Bt.targetReps===Ce.targetReps),$t=`${Ee.name} ${Ce.targetWeight}kg  ${Ce.targetReps}`),ht||Ne.push({type:"strength",key:Ee.key,...Ce.targetType==="time"?{targetType:"time",targetValue:Ce.targetValue}:Ce.targetType==="reps"?{targetType:"reps",targetReps:Ce.targetReps}:Ce.targetType==="distance"?{targetType:"distance",targetDistance:Ce.targetDistance}:{targetWeight:Ce.targetWeight,targetReps:Ce.targetReps},achievedMonth:Ot,label:$t})}}):$o.forEach(Ee=>{const Ce=we[Ee.key];if(!Ce||!Ce.targetValue)return;const xt=pe[Ee.key];if(xt==null)return;const At=Ce.startValue||0,ht=Ce.targetValue,$t=ht-At;($t===0?xt===ht?1:0:Math.max(0,(xt-At)/$t))>=1&&(Ie.some(yn=>yn.type==="metric"&&yn.key===Ee.key&&yn.targetValue===ht)||Ne.push({type:"metric",key:Ee.key,targetValue:ht,achievedMonth:Ot,label:`${Ee.name} ${ht}${Ee.suffix}`}))}),Ne.length>0){const Ee=[...Ie,...Ne];await Ls(Je(me,"juniorAchievements",Rt.id),{clientId:Rt.id,badges:Ee,updatedAt:Ct.now()}),mt(Ee),ye(Ne),setTimeout(()=>ye(null),5e3)}},wt=(F,pe)=>{if(F==="strength"){const Ne=_e[pe];if(!Ne)return!1;switch(_a.find(Ce=>Ce.key===pe)?.unit){case"time":return Ie.some(Ce=>Ce.type==="strength"&&Ce.key===pe&&Ce.targetValue===Ne.targetValue);case"reps":return Ie.some(Ce=>Ce.type==="strength"&&Ce.key===pe&&Ce.targetReps===Ne.targetReps);case"distance":return Ie.some(Ce=>Ce.type==="strength"&&Ce.key===pe&&Ce.targetDistance===Ne.targetDistance);default:return!Ne.targetWeight&&!Ne.targetReps?!1:Ie.some(Ce=>Ce.type==="strength"&&Ce.key===pe&&Ce.targetWeight===Ne.targetWeight&&Ce.targetReps===Ne.targetReps)}}else{const Ne=we[pe];return!Ne||!Ne.targetValue?!1:Ie.some(Ee=>Ee.type==="metric"&&Ee.key===pe&&Ee.targetValue===Ne.targetValue)}},gt=async()=>{p(!0);try{const F=`${Rt.id}_${Ot}`,pe=se||{};await Ls(Je(me,"juniorPBs",F),{clientId:Rt.id,month:Ot,benchmarks:D,bodyMetrics:pe.bodyMetrics||Y||{},createdAt:pe.createdAt||Ct.now(),updatedAt:Ct.now()}),await zt("strength",D),Ms("Benchmarks saved!","success"),_(!1),await Vt()}catch(F){console.error("Error saving benchmarks:",F),Ms("Failed to save. Please try again.","error")}p(!1)},Qt=async()=>{p(!0);try{const F=`${Rt.id}_${Ot}`,pe=se||{};await Ls(Je(me,"juniorPBs",F),{clientId:Rt.id,month:Ot,benchmarks:pe.benchmarks||D||{},bodyMetrics:Y,createdAt:pe.createdAt||Ct.now(),updatedAt:Ct.now()}),await zt("metric",Y),Ms("Body metrics saved!","success"),O(!1),await Vt()}catch(F){console.error("Error saving metrics:",F),Ms("Failed to save. Please try again.","error")}p(!1)},rs=(F,pe,Ne)=>{te(Ee=>({...Ee,[F]:{...Ee[F],[pe]:Ne===""?"":parseFloat(Ne)}}))},vs=(F,pe)=>{Z(Ne=>({...Ne,[F]:pe===""?"":parseFloat(pe)}))},tn=(F,pe,Ne)=>{M(Ee=>({...Ee,[F]:{...Ee[F],[pe]:Ne===""?"":parseFloat(Ne)}}))},Ys=async()=>{p(!0);try{const F=`targets_${Rt.id}`,pe=se?.benchmarks||{},Ne={};_a.forEach(Ee=>{const Ce=pe[Ee.key];switch(Ee.unit){case"time":T[Ee.key]?.targetValue&&(Ne[Ee.key]={targetType:"time",targetValue:T[Ee.key].targetValue,startValue:Ce?.time||0});break;case"reps":T[Ee.key]?.targetReps&&(Ne[Ee.key]={targetType:"reps",targetReps:T[Ee.key].targetReps,startReps:Ce?.reps||0});break;case"distance":T[Ee.key]?.targetDistance&&(Ne[Ee.key]={targetType:"distance",targetDistance:T[Ee.key].targetDistance,startDistance:Ce?.distance||0});break;default:(T[Ee.key]?.targetWeight||T[Ee.key]?.targetReps)&&(Ne[Ee.key]={targetWeight:T[Ee.key].targetWeight||0,targetReps:T[Ee.key].targetReps||0,startWeight:Ce?.weight||0,startReps:Ce?.reps||0})}}),await Ls(Je(me,"juniorPBTargets",F),{clientId:Rt.id,targets:Ne,metricTargets:we,updatedAt:Ct.now()}),Me(Ne),M(Ne),Ms("Targets saved!","success"),B(!1)}catch(F){console.error("Error saving targets:",F),Ms("Failed to save targets.","error")}p(!1)},Qs=(F,pe)=>{R(Ne=>({...Ne,[F]:{...Ne[F],targetValue:pe===""?"":parseFloat(pe)}}))},ls=async()=>{p(!0);try{const F=`targets_${Rt.id}`,pe={};$o.forEach(Ne=>{if(L[Ne.key]?.targetValue){const Ee=se?.bodyMetrics?.[Ne.key]||0;pe[Ne.key]={targetValue:L[Ne.key].targetValue,startValue:Ee}}}),await Ls(Je(me,"juniorPBTargets",F),{clientId:Rt.id,targets:_e,metricTargets:pe,updatedAt:Ct.now()}),N(pe),R(pe),Ms("Metric targets saved!","success"),I(!1)}catch(F){console.error("Error saving metric targets:",F),Ms("Failed to save targets.","error")}p(!1)},xs=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=Je(me,"juniorPBTargets",`targets_${Rt.id}`);await fr(F),Me({}),N({}),M({}),R({}),Ms("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),Ms("Failed to reset goals","error")}p(!1)}},ge=(F,pe)=>{const Ne=_e[F];if(!Ne||!pe)return null;if(Ne.targetType==="time"){if(!Ne.targetValue)return null;const ht=Ne.startValue||0,$t=Ne.targetValue,Bt=pe.time||0,$s=$t-ht;return $s<=0?Bt>=$t?1:0:Math.max(0,Math.min((Bt-ht)/$s,1))}if(Ne.targetType==="reps"){if(!Ne.targetReps)return null;const ht=Ne.startReps||0,$t=Ne.targetReps,Bt=pe.reps||0,$s=$t-ht;return $s<=0?Bt>=$t?1:0:Math.max(0,Math.min((Bt-ht)/$s,1))}if(Ne.targetType==="distance"){if(!Ne.targetDistance)return null;const ht=Ne.startDistance||0,$t=Ne.targetDistance,Bt=pe.distance||0,$s=$t-ht;return $s<=0?Bt>=$t?1:0:Math.max(0,Math.min((Bt-ht)/$s,1))}if(!Ne.targetWeight&&!Ne.targetReps)return null;const Ee=(Ne.startWeight||0)*(Ne.startReps||0),Ce=(Ne.targetWeight||0)*(Ne.targetReps||0),xt=(pe.weight||0)*(pe.reps||0),At=Ce-Ee;return At<=0?xt>=Ce?1:0:Math.max(0,Math.min((xt-Ee)/At,1))},Le=F=>{const pe=we[F];if(!pe||!pe.targetValue)return null;const Ne=se?.bodyMetrics?.[F];if(Ne==null)return null;const Ee=pe.startValue||0,Ce=pe.targetValue,xt=Ce-Ee;return xt===0?Ne===Ce?1:0:Math.max(0,Math.min((Ne-Ee)/xt,1))},je=F=>{ut.current=F.touches[0].clientX,bt.current=0},st=F=>{bt.current=F.touches[0].clientX-ut.current},We=()=>{bt.current<-50?os(g+1):bt.current>50&&os(g-1),bt.current=0},rt=F=>{const pe=se?.bodyMetrics?.[F],Ne=Dt?.bodyMetrics?.[F];return pe==null||Ne==null?null:parseFloat((pe-Ne).toFixed(2))},pt=t.find(F=>F.month===ne),J=t.find(F=>F.month===ze);if(Pt||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!As||!ts||!Rt)return null;const re=_a[g],Ze=se?.benchmarks?.[re.key],Et=Dt?.benchmarks?.[re.key],tt=ql(re,Ze),Nt=ql(re,Et),Q=rg(tt,Nt),Ae=ge(re.key,Ze),Qe=Ae!==null,dt=Ae!==null&&Ae>=1,at=Qe?Math.round(Ae*60):tt>0?15:0,ss=_e[re.key],ns=F=>F?F.targetType==="time"?`${F.startValue||0}s  ${F.targetValue}s`:F.targetType==="reps"?`${F.startReps||0}  ${F.targetReps} reps`:F.targetType==="distance"?`${F.startDistance||0}  ${F.targetDistance}cm`:`${F.startWeight||0}kg${F.startReps||0}  ${F.targetWeight}kg${F.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>It("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Pe,onTouchStart:je,onTouchMove:st,onTouchEnd:We,children:[r.jsx("div",{className:`pb-ring-container slide-from-${ot.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Em.map((F,pe)=>{const Ne=pe<Math.round(at);return r.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${Ne?dt?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},pe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:re.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[re.name,wt("strength",re.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Ze?bh(re,Ze):"-"}),Q!==null&&r.jsxs("div",{className:`pb-ring-change ${Q>=0?"positive":"negative"}`,children:[Q>=0?"+":"",Q.toFixed(1),"%"]}),Q===null&&Ze&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ss&&r.jsx("div",{className:`pb-ring-target ${dt?"hit":""}`,children:dt?"Target hit!":ns(ss)}),!ss&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:_a.map((F,pe)=>r.jsx("button",{className:`pb-dot ${pe===g?"active":""}`,onClick:()=>os(pe)},pe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>os(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>os(g+1),disabled:g===_a.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(W6,{data:t,exerciseKey:re.key,unit:re.unit})]})]}),!x&&!G&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:se?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(_e).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:xs,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ka(Ot)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),te(se?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:_a.map(F=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[F.key]?.weight??"",onChange:pe=>rs(F.key,"weight",pe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[F.key]?.reps??"",onChange:pe=>rs(F.key,"reps",pe.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:D[F.key]?.reps??"",onChange:pe=>rs(F.key,"reps",pe.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:D[F.key]?.distance??"",onChange:pe=>rs(F.key,"distance",pe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[F.key]?.time??"",onChange:pe=>rs(F.key,"time",pe.target.value),placeholder:"0"})]})})]},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),te(se?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:gt,disabled:d,children:d?"Saving...":"Save"})]})]}),G&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),_a.map(F=>{const pe=se?.benchmarks?.[F.key];let Ne="-";if(pe)switch(F.unit){case"weight":(pe.weight||pe.reps)&&(Ne=`${pe.weight||0}kg  ${pe.reps||0}`);break;case"time":pe.time&&(Ne=`${pe.time}s`);break;case"reps":pe.reps&&(Ne=`${pe.reps} reps`);break;case"distance":pe.distance&&(Ne=`${pe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ne]})]}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetWeight??"",onChange:Ee=>tn(F.key,"targetWeight",Ee.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Ee=>tn(F.key,"targetReps",Ee.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Ee=>tn(F.key,"targetReps",Ee.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetDistance??"",onChange:Ee=>tn(F.key,"targetDistance",Ee.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[F.key]?.targetValue??"",onChange:Ee=>tn(F.key,"targetValue",Ee.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ys,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ka(Ot)}),r.jsx("div",{className:"pb-metrics-list",children:$o.map(F=>{const pe=se?.bodyMetrics?.[F.key],Ne=rt(F.key),Ee=we[F.key],Ce=Le(F.key),xt=Ce!==null&&Ce>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[F.name,wt("metric",F.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Ee&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Ee.targetValue," ",F.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:pe!=null?`${pe} ${F.suffix}`:"-"}),Ne!==null&&r.jsxs("span",{className:`pb-metric-change ${Ne>0?"up":Ne<0?"down":"same"}`,children:[Ne>0?"+":"",Ne," ",F.suffix]})]})]}),Ce!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${xt?"hit":""}`,style:{width:`${Math.round(Ce*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${xt?"hit":""}`,children:xt?"Hit!":`${Math.round(Ce*100)}%`})]})]},F.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:se?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(_e).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:xs,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ka(Ot)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(se?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:$o.map(F=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[F.name," (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[F.key]??"",onChange:pe=>vs(F.key,pe.target.value),placeholder:"0"})]})},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(se?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Qt,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),R(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),$o.map(F=>{const pe=se?.bodyMetrics?.[F.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",pe!=null?`${pe} ${F.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[F.key]?.targetValue??"",onChange:Ne=>Qs(F.key,Ne.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),R(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ls,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ie.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ie].reverse().map((F,pe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${pe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:F.label}),r.jsx("span",{className:"pb-achievement-date",children:ka(F.achievedMonth)})]})]},pe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(De(t[0].month),Be(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ne,onChange:F=>De(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:ka(F.month)},F.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:ze,onChange:F=>Be(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:ka(F.month)},F.month))})]})]}),pt&&J&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ka(ne).split(" ")[0]}),r.jsx("span",{children:ka(ze).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),_a.map(F=>{const pe=pt.benchmarks?.[F.key],Ne=J.benchmarks?.[F.key],Ee=ql(F,pe),Ce=ql(F,Ne),xt=rg(Ce,Ee);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:pe?bh(F,pe):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ne?bh(F,Ne):"-"}),r.jsx("span",{className:`pb-compare-change ${xt!==null?xt>=0?"positive":"negative":""}`,children:xt!==null?`${xt>=0?"+":""}${xt.toFixed(1)}%`:"-"})]},F.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ka(ne).split(" ")[0]}),r.jsx("span",{children:ka(ze).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),$o.map(F=>{const pe=pt.bodyMetrics?.[F.key],Ne=J.bodyMetrics?.[F.key],Ee=pe!=null&&Ne!=null?parseFloat((Ne-pe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:pe!=null?`${pe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ne!=null?`${Ne}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ee!==null?Ee>0?"positive":Ee<0?"negative":"neutral":""}`,children:Ee!==null?`${Ee>0?"+":""}${Ee} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((F,pe)=>{const Ne=t.filter(Ee=>Ee.month<F.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${pe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ka(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),_a.map(Ee=>{const Ce=F.benchmarks[Ee.key];if(!Ce)return null;const xt=Ne?.benchmarks?.[Ee.key],At=ql(Ee,Ce),ht=ql(Ee,xt),$t=rg(At,ht);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:bh(Ee,Ce)}),$t!==null&&r.jsxs("span",{className:`pb-timeline-change ${$t>=0?"positive":"negative"}`,children:[$t>=0?"+":"",$t.toFixed(1),"%"]})]})]},Ee.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),$o.map(Ee=>{const Ce=F.bodyMetrics[Ee.key];if(Ce==null)return null;const xt=Ne?.bodyMetrics?.[Ee.key],At=xt!=null?parseFloat((Ce-xt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[Ce," ",Ee.suffix]}),At!==null&&r.jsxs("span",{className:`pb-timeline-change ${At>0?"positive":At<0?"negative":"neutral"}`,children:[At>0?"+":"",At," ",Ee.suffix]})]})]},Ee.key)})]})]})]},F.id)})})]})})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((F,pe)=>r.jsx("div",{className:"pb-celebration-badge",children:F.label},pe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ue&&r.jsxs("div",{className:`toast-notification ${Ue.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ue.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ue.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ye(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>It("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>It("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>It("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Rt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>It("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Qk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Qk.filter(n=>n.storagePath!==null);const K6=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Xk={};Qk.forEach(n=>{Xk[n.name]=n.group});function Y6(n){return Xk[n]||null}const za=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Wo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ja(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function vh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function V2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Hl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function ag(n,e){return!e||e===0?null:(n-e)/e*100}function X6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];return D?t==="time"?D.time||0:(D.weight||0)*(D.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const te=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:te,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),G=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:G,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function J6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[G,B]=b.useState(!1),[D,te]=b.useState({}),[Y,Z]=b.useState({}),[_e,Me]=b.useState({}),[we,N]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,R]=b.useState({}),[Ie,mt]=b.useState([]),[$,ye]=b.useState(null),[Ue,Ye]=b.useState(null),[X,P]=b.useState(!1),[ne,De]=b.useState(""),[ze,Be]=b.useState(""),[Pe,ut]=b.useState({}),[bt,ot]=b.useState({}),[os,As]=b.useState(null),[ts,Rt]=b.useState(null),[Pt,qt]=b.useState(""),[It,Ms]=b.useState({}),Vt=b.useRef(null),Ot=b.useRef(0),se=b.useRef(0),Ht=b.useRef("right"),Dt=b.useCallback(K=>{y(he=>{const ie=Math.max(0,Math.min(za.length-1,K));return ie===he?he:(Ht.current=ie>he?"right":"left",ie)})},[]),{currentUser:zt,isClient:wt,clientData:gt,loading:Qt}=Br(),{isDark:rs}=Ia(),vs=or(),[tn]=mE(),Ys=tn.get("mode")==="corebuddy",Qs=!Ys&&(!gt?.clientType||gt.clientType==="block"),ls=b.useCallback((K,he="info")=>{Ye({message:K,type:he}),setTimeout(()=>Ye(null),4e3)},[]);b.useEffect(()=>{!Qt&&(!zt||!wt)&&vs("/")},[zt,wt,Qt,vs]),b.useEffect(()=>{gt&&(Qs?xs():(async()=>{try{const[he,ie,be]=await Promise.all([Ps(Je(me,"coreBuddyPBs",gt.id)),Ps(Je(me,"coreBuddyTargets",gt.id)),Ps(Je(me,"coreBuddyAchievements",gt.id))]);he.exists()&&ut(he.data().exercises||{}),ie.exists()&&ot(ie.data().targets||{}),be.exists()&&As(be.data())}catch(he){console.error("Error loading Core Buddy PBs:",he)}u(!1)})())},[gt]);const xs=async()=>{try{const K=Bs(Yt(me,"personalBests"),bs("clientId","==",gt.id)),ie=(await Ns(K)).docs.map(Lt=>({id:Lt.id,...Lt.data()}));ie.sort((Lt,Wt)=>Lt.month.localeCompare(Wt.month)),i(ie);const be=Bs(Yt(me,"personalBestTargets"),bs("clientId","==",gt.id)),Ge=await Ns(be);if(!Ge.empty){const Lt=Ge.docs[0].data();Me(Lt.targets||{}),N(Lt.metricTargets||{}),M(Lt.targets||{}),R(Lt.metricTargets||{})}const Tt=Bs(Yt(me,"achievements"),bs("clientId","==",gt.id)),Xt=await Ns(Tt);Xt.empty||mt(Xt.docs[0].data().badges||[])}catch(K){console.error("Error fetching personal bests:",K)}u(!1)},ge=async()=>{if(!ts||!Pt||!gt)return;const K=parseFloat(Pt),he=Pe[ts];if(!he||K<=he.weight){ls("Target must be higher than current PB","error");return}p(!0);try{const ie={...bt,[ts]:{targetWeight:K,setAt:Ct.now(),currentPBWhenSet:he.weight}};await Ls(Je(me,"coreBuddyTargets",gt.id),{clientId:gt.id,targets:ie,updatedAt:Ct.now()}),ot(ie),Rt(null),qt(""),ls("Target set!","success")}catch(ie){console.error("Error saving target:",ie),ls("Failed to save target","error")}p(!1)},Le=K=>{if(!os?.badges)return!1;const he=bt[K];return he?os.badges.some(ie=>ie.type==="pb_target"&&ie.exercise===K&&ie.targetWeight===he.targetWeight):!1},je=K=>{const he=bt[K];if(!he)return null;const ie=Pe[K];if(!ie)return 0;const be=he.currentPBWhenSet||0,Ge=he.targetWeight,Tt=Ge-be;return Tt<=0?ie.weight>=Ge?1:0:Math.max(0,Math.min((ie.weight-be)/Tt,1))},st=Q6(),We=t.find(K=>K.month===st),rt=t.filter(K=>K.month<st),pt=rt.length>0?rt[rt.length-1]:null;b.useEffect(()=>{We?(te(We.benchmarks||{}),Z(We.bodyMetrics||{})):(te({}),Z({}))},[We?.id]);const J=async(K,he)=>{const ie=[];if(K==="strength"?za.forEach(be=>{const Ge=_e[be.key];if(!Ge)return;const Tt=he[be.key];if(!Tt)return;let Xt;if(Ge.targetType==="time"){if(!Ge.targetValue)return;const Lt=Ge.startValue||0,Wt=Tt.time||0,ps=Ge.targetValue-Lt;Xt=ps===0?Wt>=Ge.targetValue?1:0:Math.max(0,(Wt-Lt)/ps)}else{if(!Ge.targetWeight&&!Ge.targetReps)return;const Lt=(Ge.startWeight||0)*(Ge.startReps||0),Wt=(Ge.targetWeight||0)*(Ge.targetReps||0),ps=(Tt.weight||0)*(Tt.reps||0),Vs=Wt-Lt;Xt=Vs===0?ps>=Wt?1:0:Math.max(0,(ps-Lt)/Vs)}if(Xt>=1&&!(Ge.targetType==="time"?Ie.some(Wt=>Wt.type==="strength"&&Wt.key===be.key&&Wt.targetValue===Ge.targetValue):Ie.some(Wt=>Wt.type==="strength"&&Wt.key===be.key&&Wt.targetWeight===Ge.targetWeight&&Wt.targetReps===Ge.targetReps))){const Wt=Ge.targetType==="time"?`${be.name} ${Ge.targetValue}s`:`${be.name} ${Ge.targetWeight}kg  ${Ge.targetReps}`;ie.push({type:"strength",key:be.key,...Ge.targetType==="time"?{targetType:"time",targetValue:Ge.targetValue}:{targetWeight:Ge.targetWeight,targetReps:Ge.targetReps},achievedMonth:st,label:Wt})}}):Wo.forEach(be=>{const Ge=we[be.key];if(!Ge||!Ge.targetValue)return;const Tt=he[be.key];if(Tt==null)return;const Xt=Ge.startValue||0,Lt=Ge.targetValue,Wt=Lt-Xt;(Wt===0?Tt===Lt?1:0:Math.max(0,(Tt-Xt)/Wt))>=1&&(Ie.some(Is=>Is.type==="metric"&&Is.key===be.key&&Is.targetValue===Lt)||ie.push({type:"metric",key:be.key,targetValue:Lt,achievedMonth:st,label:`${be.name} ${Lt}${be.suffix}`}))}),ie.length>0){const be=[...Ie,...ie];await Ls(Je(me,"achievements",gt.id),{clientId:gt.id,badges:be,updatedAt:Ct.now()}),mt(be),ye(ie),setTimeout(()=>ye(null),5e3)}},re=(K,he)=>{if(K==="strength"){const ie=_e[he];return ie?ie.targetType==="time"?Ie.some(be=>be.type==="strength"&&be.key===he&&be.targetValue===ie.targetValue):!ie.targetWeight&&!ie.targetReps?!1:Ie.some(be=>be.type==="strength"&&be.key===he&&be.targetWeight===ie.targetWeight&&be.targetReps===ie.targetReps):!1}else{const ie=we[he];return!ie||!ie.targetValue?!1:Ie.some(be=>be.type==="metric"&&be.key===he&&be.targetValue===ie.targetValue)}},Ze=async()=>{p(!0);try{const K=`${gt.id}_${st}`,he=We||{};await Ls(Je(me,"personalBests",K),{clientId:gt.id,month:st,benchmarks:D,bodyMetrics:he.bodyMetrics||Y||{},createdAt:he.createdAt||Ct.now(),updatedAt:Ct.now()}),await J("strength",D),ls("Benchmarks saved!","success"),_(!1),await xs()}catch(K){console.error("Error saving benchmarks:",K),ls("Failed to save. Please try again.","error")}p(!1)},Et=async()=>{p(!0);try{const K=`${gt.id}_${st}`,he=We||{};await Ls(Je(me,"personalBests",K),{clientId:gt.id,month:st,benchmarks:he.benchmarks||D||{},bodyMetrics:Y,createdAt:he.createdAt||Ct.now(),updatedAt:Ct.now()}),await J("metric",Y),ls("Body metrics saved!","success"),O(!1),await xs()}catch(K){console.error("Error saving metrics:",K),ls("Failed to save. Please try again.","error")}p(!1)},tt=(K,he,ie)=>{te(be=>({...be,[K]:{...be[K],[he]:ie===""?"":parseFloat(ie)}}))},Nt=(K,he)=>{Z(ie=>({...ie,[K]:he===""?"":parseFloat(he)}))},Q=(K,he,ie)=>{M(be=>({...be,[K]:{...be[K],[he]:ie===""?"":parseFloat(ie)}}))},Ae=async()=>{p(!0);try{const K=`targets_${gt.id}`,he=We?.benchmarks||{},ie={};za.forEach(be=>{const Ge=he[be.key];be.unit==="time"?T[be.key]?.targetValue&&(ie[be.key]={targetType:"time",targetValue:T[be.key].targetValue,startValue:Ge?.time||0}):(T[be.key]?.targetWeight||T[be.key]?.targetReps)&&(ie[be.key]={targetWeight:T[be.key].targetWeight||0,targetReps:T[be.key].targetReps||0,startWeight:Ge?.weight||0,startReps:Ge?.reps||0})}),await Ls(Je(me,"personalBestTargets",K),{clientId:gt.id,targets:ie,metricTargets:we,updatedAt:Ct.now()}),Me(ie),M(ie),ls("Targets saved!","success"),B(!1)}catch(K){console.error("Error saving targets:",K),ls("Failed to save targets.","error")}p(!1)},Qe=(K,he)=>{R(ie=>({...ie,[K]:{...ie[K],targetValue:he===""?"":parseFloat(he)}}))},dt=async()=>{p(!0);try{const K=`targets_${gt.id}`,he={};Wo.forEach(ie=>{if(L[ie.key]?.targetValue){const be=We?.bodyMetrics?.[ie.key]||0;he[ie.key]={targetValue:L[ie.key].targetValue,startValue:be}}}),await Ls(Je(me,"personalBestTargets",K),{clientId:gt.id,targets:_e,metricTargets:he,updatedAt:Ct.now()}),N(he),R(he),ls("Metric targets saved!","success"),I(!1)}catch(K){console.error("Error saving metric targets:",K),ls("Failed to save targets.","error")}p(!1)},at=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const K=Je(me,"personalBestTargets",`targets_${gt.id}`);await fr(K),Me({}),N({}),M({}),R({}),ls("All goals have been reset","success")}catch(K){console.error("Error resetting targets:",K),ls("Failed to reset goals","error")}p(!1)}},ss=(K,he)=>{const ie=_e[K];if(!ie||!he)return null;if(ie.targetType==="time"){if(!ie.targetValue)return null;const Lt=ie.startValue||0,Wt=ie.targetValue,ps=he.time||0,Vs=Wt-Lt;return Vs<=0?ps>=Wt?1:0:Math.max(0,Math.min((ps-Lt)/Vs,1))}if(!ie.targetWeight&&!ie.targetReps)return null;const be=(ie.startWeight||0)*(ie.startReps||0),Ge=(ie.targetWeight||0)*(ie.targetReps||0),Tt=(he.weight||0)*(he.reps||0),Xt=Ge-be;return Xt<=0?Tt>=Ge?1:0:Math.max(0,Math.min((Tt-be)/Xt,1))},ns=K=>{const he=we[K];if(!he||!he.targetValue)return null;const ie=We?.bodyMetrics?.[K];if(ie==null)return null;const be=he.startValue||0,Ge=he.targetValue,Tt=Ge-be;return Tt===0?ie===Ge?1:0:Math.max(0,Math.min((ie-be)/Tt,1))},F=K=>{Ot.current=K.touches[0].clientX,se.current=0},pe=K=>{se.current=K.touches[0].clientX-Ot.current},Ne=()=>{se.current<-50?Dt(g+1):se.current>50&&Dt(g-1),se.current=0},Ee=K=>{const he=We?.bodyMetrics?.[K],ie=pt?.bodyMetrics?.[K];return he==null||ie==null?null:parseFloat((he-ie).toFixed(2))},Ce=t.find(K=>K.month===ne),xt=t.find(K=>K.month===ze);if(Qt||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!zt||!wt||!gt)return null;if(Qs&&gt?.isJunior)return r.jsx(G6,{});const At=za[g],ht=We?.benchmarks?.[At.key],$t=pt?.benchmarks?.[At.key],Bt=Hl(At,ht),$s=Hl(At,$t),yn=ag(Bt,$s),dn=ss(At.key,ht),In=dn!==null,hn=dn!==null&&dn>=1,sn=In?Math.round(dn*60):Bt>0?15:0,ys=_e[At.key];return r.jsx(Ra,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>vs(Ys?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Qs?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Qs&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Pe).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const K={},he=[];return Object.entries(Pe).forEach(([ie,be])=>{const Ge=Y6(ie);Ge?(K[Ge]||(K[Ge]=[]),K[Ge].push([ie,be])):he.push([ie,be])}),Object.values(K).forEach(ie=>ie.sort(([be],[Ge])=>be.localeCompare(Ge))),he.sort(([ie],[be])=>ie.localeCompare(be)),r.jsxs(r.Fragment,{children:[K6.map(ie=>{const be=K[ie.key];if(!be||be.length===0)return null;const Ge=!!It[ie.key],Tt=be.reduce((Xt,[,Lt])=>!Xt||Lt.weight>Xt.weight?Lt:Xt,null);return r.jsxs("div",{className:`pb-cb-group ${Ge?"open":""}`,style:{"--group-color":ie.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Ms(Xt=>({...Xt,[ie.key]:!Xt[ie.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ie.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:ie.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:ie.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[be.length," PB",be.length!==1?"s":""]}),Tt&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Tt.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${Ge?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:Ge?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:be.map(([Xt,Lt],Wt)=>{const ps=bt[Xt],Vs=je(Xt),Is=Vs!==null&&Vs>=1,C=Le(Xt),q=Vs!==null?Math.round(Vs*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":ie.color,animationDelay:`${Wt*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((de,ke)=>{const it=ke<q;return r.jsx("line",{x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,className:`pb-ring-tick ${it?Is?"hit":"filled":"empty"}`,style:it&&!Is?{stroke:ie.color}:void 0,strokeWidth:de.thick?"2":"1.5"},ke)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:ie.color},children:C?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ie.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Xt}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:ie.color},children:[Lt.weight,"kg  ",Lt.reps]}),Lt.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(Lt.achievedAt.toDate?Lt.achievedAt.toDate():new Date(Lt.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ps&&Is&&!C&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),C&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:ie.color,background:`color-mix(in srgb, ${ie.color} 10%, transparent)`,color:ie.color},onClick:()=>{Rt(Xt),qt("")},children:ps?Is&&C?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ps&&!Is&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[Lt.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:ie.color},children:["Target: ",ps.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Vs||0)*100)}%`,background:ie.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:ie.color},children:[Math.round((Vs||0)*100),"%"]})]}),ps&&Is&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Xt)})})})]},ie.key)}),he.length>0&&(()=>{const ie=!!It.other;return r.jsxs("div",{className:`pb-cb-group ${ie?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Ms(be=>({...be,other:!be.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[he.length," PB",he.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${ie?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ie?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:he.map(([be,Ge],Tt)=>{const Xt=bt[be],Lt=je(be),Wt=Lt!==null&&Lt>=1,ps=Le(be),Vs=Lt!==null?Math.round(Lt*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Tt*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((Is,C)=>{const q=C<Vs;return r.jsx("line",{x1:Is.x1,y1:Is.y1,x2:Is.x2,y2:Is.y2,className:`pb-ring-tick ${q?Wt?"hit":"filled":"empty"}`,strokeWidth:Is.thick?"2":"1.5"},C)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:ps?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:be}),r.jsxs("div",{className:"pb-cb-card-value",children:[Ge.weight,"kg  ",Ge.reps]}),Ge.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(Ge.achievedAt.toDate?Ge.achievedAt.toDate():new Date(Ge.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Xt&&Wt&&!ps&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ps&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Rt(be),qt("")},children:Xt?Wt&&ps?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Xt&&!Wt&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[Ge.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Xt.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Lt||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((Lt||0)*100),"%"]})]}),Xt&&Wt&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},be)})})})]})})()]})})()}),Object.keys(Pe).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>vs("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),ts&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Rt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:K=>K.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:ts}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Pe[ts]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:Pt,onChange:K=>qt(K.target.value),placeholder:String((Pe[ts]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>Rt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ge,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Qs&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Vt,onTouchStart:F,onTouchMove:pe,onTouchEnd:Ne,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Ht.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Em.map((K,he)=>{const ie=he<Math.round(sn);return r.jsx("line",{x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,className:`pb-ring-tick ${ie?hn?"hit":"filled":"empty"}`,strokeWidth:K.thick?"3":"2"},he)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:At.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[At.name,re("strength",At.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:ht?At.unit==="time"?vh(ht.time):V2(ht.weight,ht.reps):"-"}),yn!==null&&r.jsxs("div",{className:`pb-ring-change ${yn>=0?"positive":"negative"}`,children:[yn>=0?"+":"",yn.toFixed(1),"%"]}),yn===null&&ht&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ys&&r.jsx("div",{className:`pb-ring-target ${hn?"hit":""}`,children:hn?"Target hit!":ys.targetType==="time"?`${ys.startValue||0}s  ${ys.targetValue}s`:`${ys.startWeight||0}kg${ys.startReps||0}  ${ys.targetWeight}kg${ys.targetReps}`}),!ys&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:za.map((K,he)=>r.jsx("button",{className:`pb-dot ${he===g?"active":""}`,onClick:()=>Dt(he)},he))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Dt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Dt(g+1),disabled:g===za.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(X6,{data:t,exerciseKey:At.key,unit:At.unit})]})]}),!x&&!G&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:We?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(_e).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:at,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ja(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),te(We?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:za.map(K=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:K.name}),K.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[K.key]?.weight??"",onChange:he=>tt(K.key,"weight",he.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[K.key]?.reps??"",onChange:he=>tt(K.key,"reps",he.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[K.key]?.time??"",onChange:he=>tt(K.key,"time",he.target.value),placeholder:"0"})]})})]},K.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),te(We?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ze,disabled:d,children:d?"Saving...":"Save"})]})]}),G&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),za.map(K=>{const he=We?.benchmarks?.[K.key];let ie="-";return he&&(K.unit==="time"&&he.time?ie=`${he.time}s`:(he.weight||he.reps)&&(ie=`${he.weight||0}kg  ${he.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:K.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ie]})]}),K.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[K.key]?.targetWeight??"",onChange:be=>Q(K.key,"targetWeight",be.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[K.key]?.targetReps??"",onChange:be=>Q(K.key,"targetReps",be.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[K.key]?.targetValue??"",onChange:be=>Q(K.key,"targetValue",be.target.value),placeholder:"0"})]})})]},K.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ae,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ja(st)}),r.jsx("div",{className:"pb-metrics-list",children:Wo.map(K=>{const he=We?.bodyMetrics?.[K.key],ie=Ee(K.key),be=we[K.key],Ge=ns(K.key),Tt=Ge!==null&&Ge>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[K.name,re("metric",K.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),be&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",be.targetValue," ",K.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:he!=null?`${he} ${K.suffix}`:"-"}),ie!==null&&r.jsxs("span",{className:`pb-metric-change ${ie>0?"up":ie<0?"down":"same"}`,children:[ie>0?"+":"",ie," ",K.suffix]})]})]}),Ge!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Tt?"hit":""}`,style:{width:`${Math.round(Ge*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Tt?"hit":""}`,children:Tt?"Hit!":`${Math.round(Ge*100)}%`})]})]},K.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:We?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(_e).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:at,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ja(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(We?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Wo.map(K=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[K.name," (",K.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[K.key]??"",onChange:he=>Nt(K.key,he.target.value),placeholder:"0"})]})},K.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(We?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Et,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),R(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Wo.map(K=>{const he=We?.bodyMetrics?.[K.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:K.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",he!=null?`${he} ${K.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",K.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[K.key]?.targetValue??"",onChange:ie=>Qe(K.key,ie.target.value),placeholder:"0"})]})})]},K.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),R(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:dt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ie.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ie].reverse().map((K,he)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:K.label}),r.jsx("span",{className:"pb-achievement-date",children:ja(K.achievedMonth)})]})]},he))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(De(t[0].month),Be(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ne,onChange:K=>De(K.target.value),children:t.map(K=>r.jsx("option",{value:K.month,children:ja(K.month)},K.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:ze,onChange:K=>Be(K.target.value),children:t.map(K=>r.jsx("option",{value:K.month,children:ja(K.month)},K.month))})]})]}),Ce&&xt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ja(ne).split(" ")[0]}),r.jsx("span",{children:ja(ze).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),za.map(K=>{const he=Ce.benchmarks?.[K.key],ie=xt.benchmarks?.[K.key],be=Hl(K,he),Ge=Hl(K,ie),Tt=ag(Ge,be);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:K.name}),r.jsx("span",{className:"pb-compare-val",children:he?K.unit==="time"?vh(he.time):`${he.weight}x${he.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ie?K.unit==="time"?vh(ie.time):`${ie.weight}x${ie.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Tt!==null?Tt>=0?"positive":"negative":""}`,children:Tt!==null?`${Tt>=0?"+":""}${Tt.toFixed(1)}%`:"-"})]},K.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ja(ne).split(" ")[0]}),r.jsx("span",{children:ja(ze).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Wo.map(K=>{const he=Ce.bodyMetrics?.[K.key],ie=xt.bodyMetrics?.[K.key],be=he!=null&&ie!=null?parseFloat((ie-he).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:K.name}),r.jsx("span",{className:"pb-compare-val",children:he!=null?`${he}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ie!=null?`${ie}`:"-"}),r.jsx("span",{className:`pb-compare-change ${be!==null?be>0?"positive":be<0?"negative":"neutral":""}`,children:be!==null?`${be>0?"+":""}${be} ${K.suffix}`:"-"})]},K.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((K,he)=>{const ie=t.find(be=>be.month<K.month&&t.indexOf(be)===t.indexOf(K)-1)||t.filter(be=>be.month<K.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ja(K.month)}),K.benchmarks&&Object.keys(K.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),za.map(be=>{const Ge=K.benchmarks[be.key];if(!Ge)return null;const Tt=ie?.benchmarks?.[be.key],Xt=Hl(be,Ge),Lt=Hl(be,Tt),Wt=ag(Xt,Lt);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:be.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:be.unit==="time"?vh(Ge.time):V2(Ge.weight,Ge.reps)}),Wt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Wt>=0?"positive":"negative"}`,children:[Wt>=0?"+":"",Wt.toFixed(1),"%"]})]})]},be.key)})]}),K.bodyMetrics&&Object.keys(K.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Wo.map(be=>{const Ge=K.bodyMetrics[be.key];if(Ge==null)return null;const Tt=ie?.bodyMetrics?.[be.key],Xt=Tt!=null?parseFloat((Ge-Tt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:be.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[Ge," ",be.suffix]}),Xt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Xt>0?"positive":Xt<0?"negative":"neutral"}`,children:[Xt>0?"+":"",Xt," ",be.suffix]})]})]},be.key)})]})]})]},K.id)})})]})})]})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((K,he)=>r.jsx("div",{className:"pb-celebration-badge",children:K.label},he))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ue&&r.jsxs("div",{className:`toast-notification ${Ue.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ue.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ue.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ye(null),children:""})]}),Qs&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>vs("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>vs("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>vs("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),gt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>vs("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Ys&&r.jsx(Ca,{active:"progress"})]})})}const Z6=b.lazy(()=>Sr(()=>import("./Dashboard-i9G5O8CM.js"),__vite__mapDeps([0,1,2]))),eP=b.lazy(()=>Sr(()=>import("./AddClient-uyC5AmZj.js"),__vite__mapDeps([3,4]))),tP=b.lazy(()=>Sr(()=>import("./ClientDashboard-DTaRSEwu.js"),__vite__mapDeps([5,1]))),sP=b.lazy(()=>Sr(()=>import("./ClientForms-BUCkS4zY.js"),__vite__mapDeps([6,7]))),nP=b.lazy(()=>Sr(()=>import("./ClientTools-CBnUG-Xo.js"),__vite__mapDeps([8,9]))),rP=b.lazy(()=>Sr(()=>import("./MacroCalculator-Y5xrOQLi.js"),__vite__mapDeps([10,9]))),aP=b.lazy(()=>Sr(()=>import("./ProteinSnacks-BhPtMVMe.js"),__vite__mapDeps([11,9]))),iP=b.lazy(()=>Sr(()=>import("./DailyMotivation-CuB5mjSK.js"),__vite__mapDeps([12,9]))),oP=b.lazy(()=>Sr(()=>import("./CircuitDashboard-C1HhL03l.js"),__vite__mapDeps([13,14]))),lP=b.lazy(()=>Sr(()=>import("./CircuitBooking-jsISYcqf.js"),__vite__mapDeps([15,16,14]))),cP=b.lazy(()=>Sr(()=>import("./Leaderboard-CHBm1dCP.js"),__vite__mapDeps([17,18]))),uP=b.lazy(()=>Sr(()=>import("./UpgradePage-DYTFgYaE.js"),__vite__mapDeps([19,20]))),dP=b.lazy(()=>Sr(()=>import("./SignUp-CNieL0t5.js"),[])),hP=b.lazy(()=>Sr(()=>import("./Onboarding-B0bN50-v.js"),__vite__mapDeps([21,22])));function mP({children:n}){const{pathname:e}=Ma();return b.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),b.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function fP(){const n=or();return b.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function pP(){return r.jsx(eD,{children:r.jsx(ZI,{children:r.jsx(aD,{children:r.jsxs(lE,{basename:"/login",children:[r.jsx(fP,{}),r.jsx(mP,{children:r.jsx(b.Suspense,{fallback:r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:r.jsxs(OS,{children:[r.jsx(rn,{path:"/",element:r.jsx(lD,{})}),r.jsx(rn,{path:"/dashboard",element:r.jsx(Z6,{})}),r.jsx(rn,{path:"/add-client",element:r.jsx(eP,{})}),r.jsx(rn,{path:"/client",element:r.jsx(tP,{})}),r.jsx(rn,{path:"/client/forms",element:r.jsx(sP,{})}),r.jsx(rn,{path:"/client/tools",element:r.jsx(nP,{})}),r.jsx(rn,{path:"/client/tools/macros",element:r.jsx(rP,{})}),r.jsx(rn,{path:"/client/tools/snacks",element:r.jsx(aP,{})}),r.jsx(rn,{path:"/client/tools/motivation",element:r.jsx(iP,{})}),r.jsx(rn,{path:"/client/personal-bests",element:r.jsx(J6,{})}),r.jsx(rn,{path:"/client/circuit",element:r.jsx(oP,{})}),r.jsx(rn,{path:"/client/circuit/booking",element:r.jsx(lP,{})}),r.jsx(rn,{path:"/client/core-buddy",element:r.jsx(RD,{})}),r.jsx(rn,{path:"/client/core-buddy/nutrition",element:r.jsx(Ul,{feature:"nutrition",children:r.jsx(ID,{})})}),r.jsx(rn,{path:"/client/core-buddy/workouts",element:r.jsx(g6,{})}),r.jsx(rn,{path:"/client/core-buddy/programmes",element:r.jsx(Ul,{feature:"programmes",children:r.jsx(w6,{})})}),r.jsx(rn,{path:"/client/core-buddy/achievements",element:r.jsx(Ul,{feature:"achievements",children:r.jsx(E6,{})})}),r.jsx(rn,{path:"/client/core-buddy/consistency",element:r.jsx(Ul,{feature:"consistency",children:r.jsx(P6,{})})}),r.jsx(rn,{path:"/client/core-buddy/buddies",element:r.jsx(Ul,{feature:"buddies",children:r.jsx(L6,{})})}),r.jsx(rn,{path:"/client/core-buddy/builder",element:r.jsx(z6,{})}),r.jsx(rn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(U6,{})}),r.jsx(rn,{path:"/client/leaderboard",element:r.jsx(Ul,{feature:"leaderboard",children:r.jsx(cP,{})})}),r.jsx(rn,{path:"/signup",element:r.jsx(dP,{})}),r.jsx(rn,{path:"/onboarding",element:r.jsx(hP,{})}),r.jsx(rn,{path:"/upgrade",element:r.jsx(uP,{})}),r.jsx(rn,{path:"*",element:r.jsx(Z2,{to:"/",replace:!0})})]})})})]})})})})}OT.createRoot(document.getElementById("root")).render(r.jsx(b.StrictMode,{children:r.jsx(pP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(n=>{setInterval(()=>n.update(),3600*1e3)}).catch(n=>console.warn("SW registration failed:",n))});export{_r as A,Ca as C,Ra as P,Ct as T,Xr as a,fr as b,Yt as c,me as d,Je as e,e4 as f,Ns as g,a4 as h,Ls as i,r as j,Ps as k,Br as l,Ia as m,or as n,Du as o,Em as p,Bs as q,b as r,bP as s,gc as t,ua as u,oD as v,bs as w,iD as x,gP as y,mE as z};
