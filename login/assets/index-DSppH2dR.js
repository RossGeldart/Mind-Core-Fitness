const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-C4kNE1i_.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-kPI2o4xJ.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-XSHX89hS.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-CMyQaite.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-CMrFWjiU.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BBzs14tx.js","assets/ProteinSnacks-By9MieVQ.js","assets/DailyMotivation-BqwN8IIl.js","assets/CircuitDashboard-DcFyQqQH.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-Dj59WD9o.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-BLX9ctUC.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-Bs_IgDkb.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CtnYn_Qi.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-C-oHrvV-.js","assets/Onboarding-DvZF-mkH.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var jp={exports:{}},$c={};var qb;function Sj(){if(qb)return $c;qb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return $c.Fragment=e,$c.jsx=t,$c.jsxs=t,$c}var Hb;function Cj(){return Hb||(Hb=1,jp.exports=Sj()),jp.exports}var a=Cj(),Sp={exports:{}},Tt={};var $b;function Nj(){if($b)return Tt;$b=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),S=Symbol.iterator;function R(O){return O===null||typeof O!="object"?null:(O=S&&O[S]||O["@@iterator"],typeof O=="function"?O:null)}var q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,U={};function W(O,se,Ee){this.props=O,this.context=se,this.refs=U,this.updater=Ee||q}W.prototype.isReactComponent={},W.prototype.setState=function(O,se){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,se,"setState")},W.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function G(){}G.prototype=W.prototype;function Q(O,se,Ee){this.props=O,this.context=se,this.refs=U,this.updater=Ee||q}var me=Q.prototype=new G;me.constructor=Q,$(me,W.prototype),me.isPureReactComponent=!0;var ke=Array.isArray;function xe(){}var C={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function I(O,se,Ee){var Se=Ee.ref;return{$$typeof:s,type:O,key:se,ref:Se!==void 0?Se:null,props:Ee}}function P(O,se){return I(O.type,se,O.props)}function V(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function L(O){var se={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(Ee){return se[Ee]})}var A=/\/+/g;function De(O,se){return typeof O=="object"&&O!==null&&O.key!=null?L(""+O.key):se.toString(36)}function tt(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(xe,xe):(O.status="pending",O.then(function(se){O.status==="pending"&&(O.status="fulfilled",O.value=se)},function(se){O.status==="pending"&&(O.status="rejected",O.reason=se)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function X(O,se,Ee,Se,ye){var Ne=typeof O;(Ne==="undefined"||Ne==="boolean")&&(O=null);var Ve=!1;if(O===null)Ve=!0;else switch(Ne){case"bigint":case"string":case"number":Ve=!0;break;case"object":switch(O.$$typeof){case s:case e:Ve=!0;break;case b:return Ve=O._init,X(Ve(O._payload),se,Ee,Se,ye)}}if(Ve)return ye=ye(O),Ve=Se===""?"."+De(O,0):Se,ke(ye)?(Ee="",Ve!=null&&(Ee=Ve.replace(A,"$&/")+"/"),X(ye,se,Ee,"",function(Ut){return Ut})):ye!=null&&(V(ye)&&(ye=P(ye,Ee+(ye.key==null||O&&O.key===ye.key?"":(""+ye.key).replace(A,"$&/")+"/")+Ve)),se.push(ye)),1;Ve=0;var We=Se===""?".":Se+":";if(ke(O))for(var Ue=0;Ue<O.length;Ue++)Se=O[Ue],Ne=We+De(Se,Ue),Ve+=X(Se,se,Ee,Ne,ye);else if(Ue=R(O),typeof Ue=="function")for(O=Ue.call(O),Ue=0;!(Se=O.next()).done;)Se=Se.value,Ne=We+De(Se,Ue++),Ve+=X(Se,se,Ee,Ne,ye);else if(Ne==="object"){if(typeof O.then=="function")return X(tt(O),se,Ee,Se,ye);throw se=String(O),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Ve}function Ce(O,se,Ee){if(O==null)return O;var Se=[],ye=0;return X(O,Se,"","",function(Ne){return se.call(Ee,Ne,ye++)}),Se}function Me(O){if(O._status===-1){var se=O._result;se=se(),se.then(function(Ee){(O._status===0||O._status===-1)&&(O._status=1,O._result=Ee)},function(Ee){(O._status===0||O._status===-1)&&(O._status=2,O._result=Ee)}),O._status===-1&&(O._status=0,O._result=se)}if(O._status===1)return O._result.default;throw O._result}var Re=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},Z={map:Ce,forEach:function(O,se,Ee){Ce(O,function(){se.apply(this,arguments)},Ee)},count:function(O){var se=0;return Ce(O,function(){se++}),se},toArray:function(O){return Ce(O,function(se){return se})||[]},only:function(O){if(!V(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Tt.Activity=k,Tt.Children=Z,Tt.Component=W,Tt.Fragment=t,Tt.Profiler=l,Tt.PureComponent=Q,Tt.StrictMode=i,Tt.Suspense=y,Tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Tt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},Tt.cache=function(O){return function(){return O.apply(null,arguments)}},Tt.cacheSignal=function(){return null},Tt.cloneElement=function(O,se,Ee){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Se=$({},O.props),ye=O.key;if(se!=null)for(Ne in se.key!==void 0&&(ye=""+se.key),se)!T.call(se,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&se.ref===void 0||(Se[Ne]=se[Ne]);var Ne=arguments.length-2;if(Ne===1)Se.children=Ee;else if(1<Ne){for(var Ve=Array(Ne),We=0;We<Ne;We++)Ve[We]=arguments[We+2];Se.children=Ve}return I(O.type,ye,Se)},Tt.createContext=function(O){return O={$$typeof:d,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:u,_context:O},O},Tt.createElement=function(O,se,Ee){var Se,ye={},Ne=null;if(se!=null)for(Se in se.key!==void 0&&(Ne=""+se.key),se)T.call(se,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(ye[Se]=se[Se]);var Ve=arguments.length-2;if(Ve===1)ye.children=Ee;else if(1<Ve){for(var We=Array(Ve),Ue=0;Ue<Ve;Ue++)We[Ue]=arguments[Ue+2];ye.children=We}if(O&&O.defaultProps)for(Se in Ve=O.defaultProps,Ve)ye[Se]===void 0&&(ye[Se]=Ve[Se]);return I(O,Ne,ye)},Tt.createRef=function(){return{current:null}},Tt.forwardRef=function(O){return{$$typeof:p,render:O}},Tt.isValidElement=V,Tt.lazy=function(O){return{$$typeof:b,_payload:{_status:-1,_result:O},_init:Me}},Tt.memo=function(O,se){return{$$typeof:g,type:O,compare:se===void 0?null:se}},Tt.startTransition=function(O){var se=C.T,Ee={};C.T=Ee;try{var Se=O(),ye=C.S;ye!==null&&ye(Ee,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(xe,Re)}catch(Ne){Re(Ne)}finally{se!==null&&Ee.types!==null&&(se.types=Ee.types),C.T=se}},Tt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Tt.use=function(O){return C.H.use(O)},Tt.useActionState=function(O,se,Ee){return C.H.useActionState(O,se,Ee)},Tt.useCallback=function(O,se){return C.H.useCallback(O,se)},Tt.useContext=function(O){return C.H.useContext(O)},Tt.useDebugValue=function(){},Tt.useDeferredValue=function(O,se){return C.H.useDeferredValue(O,se)},Tt.useEffect=function(O,se){return C.H.useEffect(O,se)},Tt.useEffectEvent=function(O){return C.H.useEffectEvent(O)},Tt.useId=function(){return C.H.useId()},Tt.useImperativeHandle=function(O,se,Ee){return C.H.useImperativeHandle(O,se,Ee)},Tt.useInsertionEffect=function(O,se){return C.H.useInsertionEffect(O,se)},Tt.useLayoutEffect=function(O,se){return C.H.useLayoutEffect(O,se)},Tt.useMemo=function(O,se){return C.H.useMemo(O,se)},Tt.useOptimistic=function(O,se){return C.H.useOptimistic(O,se)},Tt.useReducer=function(O,se,Ee){return C.H.useReducer(O,se,Ee)},Tt.useRef=function(O){return C.H.useRef(O)},Tt.useState=function(O){return C.H.useState(O)},Tt.useSyncExternalStore=function(O,se,Ee){return C.H.useSyncExternalStore(O,se,Ee)},Tt.useTransition=function(){return C.H.useTransition()},Tt.version="19.2.4",Tt}var Wb;function Xg(){return Wb||(Wb=1,Sp.exports=Nj()),Sp.exports}var w=Xg(),Cp={exports:{}},Wc={},Np={exports:{}},Ap={};var Gb;function Aj(){return Gb||(Gb=1,(function(s){function e(X,Ce){var Me=X.length;X.push(Ce);e:for(;0<Me;){var Re=Me-1>>>1,Z=X[Re];if(0<l(Z,Ce))X[Re]=Ce,X[Me]=Z,Me=Re;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var Ce=X[0],Me=X.pop();if(Me!==Ce){X[0]=Me;e:for(var Re=0,Z=X.length,O=Z>>>1;Re<O;){var se=2*(Re+1)-1,Ee=X[se],Se=se+1,ye=X[Se];if(0>l(Ee,Me))Se<Z&&0>l(ye,Ee)?(X[Re]=ye,X[Se]=Me,Re=Se):(X[Re]=Ee,X[se]=Me,Re=se);else if(Se<Z&&0>l(ye,Me))X[Re]=ye,X[Se]=Me,Re=Se;else break e}}return Ce}function l(X,Ce){var Me=X.sortIndex-Ce.sortIndex;return Me!==0?Me:X.id-Ce.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var y=[],g=[],b=1,k=null,S=3,R=!1,q=!1,$=!1,U=!1,W=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function me(X){for(var Ce=t(g);Ce!==null;){if(Ce.callback===null)i(g);else if(Ce.startTime<=X)i(g),Ce.sortIndex=Ce.expirationTime,e(y,Ce);else break;Ce=t(g)}}function ke(X){if($=!1,me(X),!q)if(t(y)!==null)q=!0,xe||(xe=!0,L());else{var Ce=t(g);Ce!==null&&tt(ke,Ce.startTime-X)}}var xe=!1,C=-1,T=5,I=-1;function P(){return U?!0:!(s.unstable_now()-I<T)}function V(){if(U=!1,xe){var X=s.unstable_now();I=X;var Ce=!0;try{e:{q=!1,$&&($=!1,G(C),C=-1),R=!0;var Me=S;try{t:{for(me(X),k=t(y);k!==null&&!(k.expirationTime>X&&P());){var Re=k.callback;if(typeof Re=="function"){k.callback=null,S=k.priorityLevel;var Z=Re(k.expirationTime<=X);if(X=s.unstable_now(),typeof Z=="function"){k.callback=Z,me(X),Ce=!0;break t}k===t(y)&&i(y),me(X)}else i(y);k=t(y)}if(k!==null)Ce=!0;else{var O=t(g);O!==null&&tt(ke,O.startTime-X),Ce=!1}}break e}finally{k=null,S=Me,R=!1}Ce=void 0}}finally{Ce?L():xe=!1}}}var L;if(typeof Q=="function")L=function(){Q(V)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,De=A.port2;A.port1.onmessage=V,L=function(){De.postMessage(null)}}else L=function(){W(V,0)};function tt(X,Ce){C=W(function(){X(s.unstable_now())},Ce)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_next=function(X){switch(S){case 1:case 2:case 3:var Ce=3;break;default:Ce=S}var Me=S;S=Ce;try{return X()}finally{S=Me}},s.unstable_requestPaint=function(){U=!0},s.unstable_runWithPriority=function(X,Ce){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Me=S;S=X;try{return Ce()}finally{S=Me}},s.unstable_scheduleCallback=function(X,Ce,Me){var Re=s.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?Re+Me:Re):Me=Re,X){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Me+Z,X={id:b++,callback:Ce,priorityLevel:X,startTime:Me,expirationTime:Z,sortIndex:-1},Me>Re?(X.sortIndex=Me,e(g,X),t(y)===null&&X===t(g)&&($?(G(C),C=-1):$=!0,tt(ke,Me-Re))):(X.sortIndex=Z,e(y,X),q||R||(q=!0,xe||(xe=!0,L()))),X},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(X){var Ce=S;return function(){var Me=S;S=Ce;try{return X.apply(this,arguments)}finally{S=Me}}}})(Ap)),Ap}var Kb;function Rj(){return Kb||(Kb=1,Np.exports=Aj()),Np.exports}var Rp={exports:{}},Gs={};var Yb;function Ij(){if(Yb)return Gs;Yb=1;var s=Xg();function e(y){var g="https://react.dev/errors/"+y;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(y,g,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:y,containerInfo:g,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(y,g){if(y==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Gs.createPortal=function(y,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return u(y,g,null,b)},Gs.flushSync=function(y){var g=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=g,i.p=b,i.d.f()}},Gs.preconnect=function(y,g){typeof y=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(y,g))},Gs.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},Gs.preinit=function(y,g){if(typeof y=="string"&&g&&typeof g.as=="string"){var b=g.as,k=p(b,g.crossOrigin),S=typeof g.integrity=="string"?g.integrity:void 0,R=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?i.d.S(y,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:k,integrity:S,fetchPriority:R}):b==="script"&&i.d.X(y,{crossOrigin:k,integrity:S,fetchPriority:R,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Gs.preinitModule=function(y,g){if(typeof y=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=p(g.as,g.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(y)},Gs.preload=function(y,g){if(typeof y=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,k=p(b,g.crossOrigin);i.d.L(y,b,{crossOrigin:k,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Gs.preloadModule=function(y,g){if(typeof y=="string")if(g){var b=p(g.as,g.crossOrigin);i.d.m(y,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(y)},Gs.requestFormReset=function(y){i.d.r(y)},Gs.unstable_batchedUpdates=function(y,g){return y(g)},Gs.useFormState=function(y,g,b){return d.H.useFormState(y,g,b)},Gs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Gs.version="19.2.4",Gs}var Qb;function Mj(){if(Qb)return Rp.exports;Qb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rp.exports=Ij(),Rp.exports}var Xb;function Dj(){if(Xb)return Wc;Xb=1;var s=Rj(),e=Xg(),t=Mj();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(u(n)!==n)throw Error(i(188))}function g(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===c)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,j=f.child;j;){if(j===o){x=!0,o=f,c=m;break}if(j===c){x=!0,c=f,o=m;break}j=j.sibling}if(!x){for(j=m.child;j;){if(j===o){x=!0,o=m,c=f;break}if(j===c){x=!0,c=m,o=f;break}j=j.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,S=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),q=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function De(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $:return"Fragment";case W:return"Profiler";case U:return"StrictMode";case ke:return"Suspense";case xe:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case q:return"Portal";case Q:return n.displayName||"Context";case G:return(n._context.displayName||"Context")+".Consumer";case me:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return r=n.displayName||null,r!==null?r:De(n.type)||"Memo";case T:r=n._payload,n=n._init;try{return De(n(r))}catch{}}return null}var tt=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},Re=[],Z=-1;function O(n){return{current:n}}function se(n){0>Z||(n.current=Re[Z],Re[Z]=null,Z--)}function Ee(n,r){Z++,Re[Z]=n.current,n.current=r}var Se=O(null),ye=O(null),Ne=O(null),Ve=O(null);function We(n,r){switch(Ee(Ne,r),Ee(ye,n),Ee(Se,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?hb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=hb(r),n=fb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}se(Se),Ee(Se,n)}function Ue(){se(Se),se(ye),se(Ne)}function Ut(n){n.memoizedState!==null&&Ee(Ve,n);var r=Se.current,o=fb(r,n.type);r!==o&&(Ee(ye,n),Ee(Se,o))}function St(n){ye.current===n&&(se(Se),se(ye)),Ve.current===n&&(se(Ve),zc._currentValue=Me)}var Tn,Un;function Pt(n){if(Tn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Tn=r&&r[1]||"",Un=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tn+n+Un}var kt=!1;function Xt(n,r){if(!n||kt)return"";kt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(fe){var oe=fe}Reflect.construct(n,[],_e)}else{try{_e.call()}catch(fe){oe=fe}n.call(_e.prototype)}}else{try{throw Error()}catch(fe){oe=fe}(_e=n())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(fe){if(fe&&oe&&typeof fe.stack=="string")return[fe.stack,oe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],j=m[1];if(x&&j){var B=x.split(`
`),ie=j.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ie.length&&!ie[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===ie.length)for(c=B.length-1,f=ie.length-1;1<=c&&0<=f&&B[c]!==ie[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==ie[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==ie[f]){var pe=`
`+B[c].replace(" at new "," at ");return n.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",n.displayName)),pe}while(1<=c&&0<=f);break}}}finally{kt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Pt(o):""}function Ge(n,r){switch(n.tag){case 26:case 27:case 5:return Pt(n.type);case 16:return Pt("Lazy");case 13:return n.child!==r&&r!==null?Pt("Suspense Fallback"):Pt("Suspense");case 19:return Pt("SuspenseList");case 0:case 15:return Xt(n.type,!1);case 11:return Xt(n.type.render,!1);case 1:return Xt(n.type,!0);case 31:return Pt("Activity");default:return""}}function Cn(n){try{var r="",o=null;do r+=Ge(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var le=Object.prototype.hasOwnProperty,It=s.unstable_scheduleCallback,Nt=s.unstable_cancelCallback,gt=s.unstable_shouldYield,Ye=s.unstable_requestPaint,ot=s.unstable_now,nn=s.unstable_getCurrentPriorityLevel,Jt=s.unstable_ImmediatePriority,Jn=s.unstable_UserBlockingPriority,Nn=s.unstable_NormalPriority,cs=s.unstable_LowPriority,Zn=s.unstable_IdlePriority,Hn=s.log,Bn=s.unstable_setDisableYieldValue,rn=null,Bt=null;function vt(n){if(typeof Hn=="function"&&Bn(n),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(rn,n)}catch{}}var Ct=Math.clz32?Math.clz32:ht,J=Math.log,Ae=Math.LN2;function ht(n){return n>>>=0,n===0?32:31-(J(n)/Ae|0)|0}var xt=256,ft=262144,st=4194304;function nt(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function yt(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var j=c&134217727;return j!==0?(c=j&~m,c!==0?f=nt(c):(x&=j,x!==0?f=nt(x):o||(o=j&~n,o!==0&&(f=nt(o))))):(j=c&~m,j!==0?f=nt(j):x!==0?f=nt(x):o||(o=c&~n,o!==0&&(f=nt(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Zt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function fn(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rn(){var n=st;return st<<=1,(st&62914560)===0&&(st=4194304),n}function ae(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Ie(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Qe(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var j=n.entanglements,B=n.expirationTimes,ie=n.hiddenUpdates;for(o=x&~o;0<o;){var pe=31-Ct(o),_e=1<<pe;j[pe]=0,B[pe]=-1;var oe=ie[pe];if(oe!==null)for(ie[pe]=null,pe=0;pe<oe.length;pe++){var fe=oe[pe];fe!==null&&(fe.lane&=-536870913)}o&=~_e}c!==0&&lt(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function lt(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Ct(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function at(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Ct(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Vt(n,r){var o=r&-r;return o=(o&42)!==0?1:en(o),(o&(n.suspendedLanes|r))!==0?0:o}function en(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function zt(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function mn(){var n=Ce.p;return n!==0?n:(n=window.event,n===void 0?32:Ob(n.type))}function In(n,r){var o=Ce.p;try{return Ce.p=n,r()}finally{Ce.p=o}}var Mn=Math.random().toString(36).slice(2),yn="__reactFiber$"+Mn,cn="__reactProps$"+Mn,ws="__reactContainer$"+Mn,Ls="__reactEvents$"+Mn,Qr="__reactListeners$"+Mn,Oi="__reactHandles$"+Mn,gi="__reactResources$"+Mn,Ns="__reactMarker$"+Mn;function xs(n){delete n[yn],delete n[cn],delete n[Ls],delete n[Qr],delete n[Oi]}function us(n){var r=n[yn];if(r)return r;for(var o=n.parentNode;o;){if(r=o[ws]||o[yn]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=wb(n);n!==null;){if(o=n[yn])return o;n=wb(n)}return r}n=o,o=n.parentNode}return null}function Wn(n){if(n=n[yn]||n[ws]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function Dn(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function es(n){var r=n[gi];return r||(r=n[gi]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function un(n){n[Ns]=!0}var ts=new Set,Xr={};function _s(n,r){ks(n,r),ks(n+"Capture",r)}function ks(n,r){for(Xr[n]=r,n=0;n<r.length;n++)ts.add(r[n])}var Es=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Os={},Jr={};function M(n){return le.call(Jr,n)?!0:le.call(Os,n)?!1:Es.test(n)?Jr[n]=!0:(Os[n]=!0,!1)}function F(n,r,o){if(M(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function te(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function re(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Be(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ze(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function He(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function et(n){if(!n._valueTracker){var r=ze(n)?"checked":"value";n._valueTracker=He(n,r,""+n[r])}}function bt(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=ze(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function wn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var As=/[\n"\\]/g;function ns(n){return n.replace(As,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function er(n,r,o,c,f,m,x,j){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Be(r)):n.value!==""+Be(r)&&(n.value=""+Be(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Dr(n,x,Be(r)):o!=null?Dr(n,x,Be(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?n.name=""+Be(j):n.removeAttribute("name")}function Zr(n,r,o,c,f,m,x,j){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){et(n);return}o=o!=null?""+Be(o):"",r=r!=null?""+Be(r):o,j||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=j?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),et(n)}function Dr(n,r,o){r==="number"&&wn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function wr(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Be(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function Ws(n,r,o){if(r!=null&&(r=""+Be(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Be(o):""}function tr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(tt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Be(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),et(n)}function Rs(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var Pi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vi(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||Pi.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function ei(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Vi(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Vi(n,m,r[m])}function ti(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ps=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ni(n){return xr.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function nr(){}var sr=null;function z(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var de=null,ce=null;function E(n){var r=Wn(n);if(r&&(n=r.stateNode)){var o=n[cn]||null;e:switch(n=r.stateNode,r.type){case"input":if(er(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+ns(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[cn]||null;if(!f)throw Error(i(90));er(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&bt(c)}break e;case"textarea":Ws(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&wr(n,!!o.multiple,r,!1)}}}var D=!1;function K(n,r,o){if(D)return n(r,o);D=!0;try{var c=n(r);return c}finally{if(D=!1,(de!==null||ce!==null)&&(Pd(),de&&(r=de,n=ce,ce=de=null,E(r),n)))for(r=0;r<n.length;r++)E(n[r])}}function ue(n,r){var o=n.stateNode;if(o===null)return null;var c=o[cn]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Te=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Le=!1;if(Te)try{var be={};Object.defineProperty(be,"passive",{get:function(){Le=!0}}),window.addEventListener("test",be,be),window.removeEventListener("test",be,be)}catch{Le=!1}var Oe=null,Je=null,Lt=null;function Xe(){if(Lt)return Lt;var n,r=Je,o=r.length,c,f="value"in Oe?Oe.value:Oe.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return Lt=f.slice(n,1<c?1-c:void 0)}function Ot(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function an(){return!0}function ct(){return!1}function Et(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var j in n)n.hasOwnProperty(j)&&(o=n[j],this[j]=o?o(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?an:ct,this.isPropagationStopped=ct,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),r}var Ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ss=Et(Ln),Vs=k({},Ln,{view:0,detail:0}),On=Et(Vs),jn,ds,Ts,yi=k({},Vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:va,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ts&&(Ts&&n.type==="mousemove"?(jn=n.screenX-Ts.screenX,ds=n.screenY-Ts.screenY):ds=jn=0,Ts=n),jn)},movementY:function(n){return"movementY"in n?n.movementY:ds}}),Ui=Et(yi),uo=k({},yi,{dataTransfer:0}),$u=Et(uo),Wu=k({},Vs,{relatedTarget:0}),ho=Et(Wu),lc=k({},Ln,{animationName:0,elapsedTime:0,pseudoElement:0}),Gu=Et(lc),el=k({},Ln,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ku=Et(el),Yu=k({},Ln,{data:0}),vi=Et(Yu),Qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ju={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Ju[n])?!!r[n]:!1}function va(){return Zu}var rr=k({},Vs,{key:function(n){if(n.key){var r=Qu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Ot(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Xu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:va,charCode:function(n){return n.type==="keypress"?Ot(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ot(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ed=Et(rr),td=k({},yi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bi=Et(td),h=k({},Vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:va}),v=Et(h),_=k({},Ln,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=Et(_),ee=k({},yi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),he=Et(ee),Pe=k({},Ln,{newState:0,oldState:0}),At=Et(Pe),rs=[9,13,27,32],dn=Te&&"CompositionEvent"in window,zn=null;Te&&"documentMode"in document&&(zn=document.documentMode);var Lr=Te&&"TextEvent"in window&&!zn,bi=Te&&(!dn||zn&&8<zn&&11>=zn),si=" ",ri=!1;function fo(n,r){switch(n){case"keyup":return rs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var nl=!1;function XE(n,r){switch(n){case"compositionend":return tl(r);case"keypress":return r.which!==32?null:(ri=!0,si);case"textInput":return n=r.data,n===si&&ri?null:n;default:return null}}function JE(n,r){if(nl)return n==="compositionend"||!dn&&fo(n,r)?(n=Xe(),Lt=Je=Oe=null,nl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return bi&&r.locale!=="ko"?null:r.data;default:return null}}var ZE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!ZE[n.type]:r==="textarea"}function E0(n,r,o,c){de?ce?ce.push(c):ce=[c]:de=c,r=Hd(r,"onChange"),0<r.length&&(o=new ss("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var cc=null,uc=null;function eT(n){ab(n,0)}function nd(n){var r=Dn(n);if(bt(r))return n}function T0(n,r){if(n==="change")return r}var j0=!1;if(Te){var Mf;if(Te){var Df="oninput"in document;if(!Df){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),Df=typeof S0.oninput=="function"}Mf=Df}else Mf=!1;j0=Mf&&(!document.documentMode||9<document.documentMode)}function C0(){cc&&(cc.detachEvent("onpropertychange",N0),uc=cc=null)}function N0(n){if(n.propertyName==="value"&&nd(uc)){var r=[];E0(r,uc,n,z(n)),K(eT,r)}}function tT(n,r,o){n==="focusin"?(C0(),cc=r,uc=o,cc.attachEvent("onpropertychange",N0)):n==="focusout"&&C0()}function nT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nd(uc)}function sT(n,r){if(n==="click")return nd(r)}function rT(n,r){if(n==="input"||n==="change")return nd(r)}function iT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var _r=typeof Object.is=="function"?Object.is:iT;function dc(n,r){if(_r(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!le.call(r,f)||!_r(n[f],r[f]))return!1}return!0}function A0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function R0(n,r){var o=A0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=A0(o)}}function I0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?I0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function M0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=wn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=wn(n.document)}return r}function Lf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var aT=Te&&"documentMode"in document&&11>=document.documentMode,sl=null,Of=null,hc=null,Pf=!1;function D0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||sl==null||sl!==wn(c)||(c=sl,"selectionStart"in c&&Lf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),hc&&dc(hc,c)||(hc=c,c=Hd(Of,"onSelect"),0<c.length&&(r=new ss("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=sl)))}function mo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var rl={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionrun:mo("Transition","TransitionRun"),transitionstart:mo("Transition","TransitionStart"),transitioncancel:mo("Transition","TransitionCancel"),transitionend:mo("Transition","TransitionEnd")},Vf={},L0={};Te&&(L0=document.createElement("div").style,"AnimationEvent"in window||(delete rl.animationend.animation,delete rl.animationiteration.animation,delete rl.animationstart.animation),"TransitionEvent"in window||delete rl.transitionend.transition);function po(n){if(Vf[n])return Vf[n];if(!rl[n])return n;var r=rl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in L0)return Vf[n]=r[o];return n}var O0=po("animationend"),P0=po("animationiteration"),V0=po("animationstart"),oT=po("transitionrun"),lT=po("transitionstart"),cT=po("transitioncancel"),U0=po("transitionend"),B0=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function ii(n,r){B0.set(n,r),_s(r,[n])}var sd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Or=[],il=0,Bf=0;function rd(){for(var n=il,r=Bf=il=0;r<n;){var o=Or[r];Or[r++]=null;var c=Or[r];Or[r++]=null;var f=Or[r];Or[r++]=null;var m=Or[r];if(Or[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&z0(o,f,m)}}function id(n,r,o,c){Or[il++]=n,Or[il++]=r,Or[il++]=o,Or[il++]=c,Bf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function zf(n,r,o,c){return id(n,r,o,c),ad(n)}function go(n,r){return id(n,null,null,r),ad(n)}function z0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Ct(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ad(n){if(50<Dc)throw Dc=0,Qm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var al={};function uT(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(n,r,o,c){return new uT(n,r,o,c)}function Ff(n){return n=n.prototype,!(!n||!n.isReactComponent)}function zi(n,r){var o=n.alternate;return o===null?(o=kr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function F0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function od(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")Ff(n)&&(x=1);else if(typeof n=="string")x=pj(n,o,Se.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=kr(31,o,r,f),n.elementType=I,n.lanes=m,n;case $:return yo(o.children,f,m,r);case U:x=8,f|=24;break;case W:return n=kr(12,o,r,f|2),n.elementType=W,n.lanes=m,n;case ke:return n=kr(13,o,r,f),n.elementType=ke,n.lanes=m,n;case xe:return n=kr(19,o,r,f),n.elementType=xe,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Q:x=10;break e;case G:x=9;break e;case me:x=11;break e;case C:x=14;break e;case T:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=kr(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function yo(n,r,o,c){return n=kr(7,n,c,r),n.lanes=o,n}function qf(n,r,o){return n=kr(6,n,null,r),n.lanes=o,n}function q0(n){var r=kr(18,null,null,0);return r.stateNode=n,r}function Hf(n,r,o){return r=kr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var H0=new WeakMap;function Pr(n,r){if(typeof n=="object"&&n!==null){var o=H0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:Cn(r)},H0.set(n,r),r)}return{value:n,source:r,stack:Cn(r)}}var ol=[],ll=0,ld=null,fc=0,Vr=[],Ur=0,ba=null,wi=1,xi="";function Fi(n,r){ol[ll++]=fc,ol[ll++]=ld,ld=n,fc=r}function $0(n,r,o){Vr[Ur++]=wi,Vr[Ur++]=xi,Vr[Ur++]=ba,ba=n;var c=wi;n=xi;var f=32-Ct(c)-1;c&=~(1<<f),o+=1;var m=32-Ct(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,wi=1<<32-Ct(r)+f|o<<f|c,xi=m+n}else wi=1<<m|o<<f|c,xi=n}function $f(n){n.return!==null&&(Fi(n,1),$0(n,1,0))}function Wf(n){for(;n===ld;)ld=ol[--ll],ol[ll]=null,fc=ol[--ll],ol[ll]=null;for(;n===ba;)ba=Vr[--Ur],Vr[Ur]=null,xi=Vr[--Ur],Vr[Ur]=null,wi=Vr[--Ur],Vr[Ur]=null}function W0(n,r){Vr[Ur++]=wi,Vr[Ur++]=xi,Vr[Ur++]=ba,wi=r.id,xi=r.overflow,ba=n}var Us=null,Pn=null,Yt=!1,wa=null,Br=!1,Gf=Error(i(519));function xa(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mc(Pr(r,n)),Gf}function G0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[yn]=n,r[cn]=c,o){case"dialog":qt("cancel",r),qt("close",r);break;case"iframe":case"object":case"embed":qt("load",r);break;case"video":case"audio":for(o=0;o<Oc.length;o++)qt(Oc[o],r);break;case"source":qt("error",r);break;case"img":case"image":case"link":qt("error",r),qt("load",r);break;case"details":qt("toggle",r);break;case"input":qt("invalid",r),Zr(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":qt("invalid",r);break;case"textarea":qt("invalid",r),tr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ub(r.textContent,o)?(c.popover!=null&&(qt("beforetoggle",r),qt("toggle",r)),c.onScroll!=null&&qt("scroll",r),c.onScrollEnd!=null&&qt("scrollend",r),c.onClick!=null&&(r.onclick=nr),r=!0):r=!1,r||xa(n,!0)}function K0(n){for(Us=n.return;Us;)switch(Us.tag){case 5:case 31:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:Us=Us.return}}function cl(n){if(n!==Us)return!1;if(!Yt)return K0(n),Yt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||dp(n.type,n.memoizedProps)),o=!o),o&&Pn&&xa(n),K0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=bb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=bb(n)}else r===27?(r=Pn,La(n.type)?(n=gp,gp=null,Pn=n):Pn=r):Pn=Us?Fr(n.stateNode.nextSibling):null;return!0}function vo(){Pn=Us=null,Yt=!1}function Kf(){var n=wa;return n!==null&&(mr===null?mr=n:mr.push.apply(mr,n),wa=null),n}function mc(n){wa===null?wa=[n]:wa.push(n)}var Yf=O(null),bo=null,qi=null;function _a(n,r,o){Ee(Yf,r._currentValue),r._currentValue=o}function Hi(n){n._currentValue=Yf.current,se(Yf)}function Qf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Xf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var j=m;m=f;for(var B=0;B<r.length;B++)if(j.context===r[B]){m.lanes|=o,j=m.alternate,j!==null&&(j.lanes|=o),Qf(m.return,o,n),c||(x=null);break e}m=j.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Qf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function ul(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var j=f.type;_r(f.pendingProps.value,x.value)||(n!==null?n.push(j):n=[j])}}else if(f===Ve.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(zc):n=[zc])}f=f.return}n!==null&&Xf(r,n,o,c),r.flags|=262144}function cd(n){for(n=n.firstContext;n!==null;){if(!_r(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function wo(n){bo=n,qi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Bs(n){return Y0(bo,n)}function ud(n,r){return bo===null&&wo(n),Y0(n,r)}function Y0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},qi===null){if(n===null)throw Error(i(308));qi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else qi=qi.next=r;return o}var dT=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},hT=s.unstable_scheduleCallback,fT=s.unstable_NormalPriority,hs={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new dT,data:new Map,refCount:0}}function pc(n){n.refCount--,n.refCount===0&&hT(fT,function(){n.controller.abort()})}var gc=null,Zf=0,dl=0,hl=null;function mT(n,r){if(gc===null){var o=gc=[];Zf=0,dl=np(),hl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Zf++,r.then(Q0,Q0),r}function Q0(){if(--Zf===0&&gc!==null){hl!==null&&(hl.status="fulfilled");var n=gc;gc=null,dl=0,hl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function pT(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var X0=X.S;X.S=function(n,r){D1=ot(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&mT(n,r),X0!==null&&X0(n,r)};var xo=O(null);function em(){var n=xo.current;return n!==null?n:Sn.pooledCache}function dd(n,r){r===null?Ee(xo,xo.current):Ee(xo,r.pool)}function J0(){var n=em();return n===null?null:{parent:hs._currentValue,pool:n}}var fl=Error(i(460)),tm=Error(i(474)),hd=Error(i(542)),fd={then:function(){}};function Z0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function ev(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(nr,nr),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n;default:if(typeof r.status=="string")r.then(nr,nr);else{if(n=Sn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n}throw ko=r,fl}}function _o(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ko=o,fl):o}}var ko=null;function tv(){if(ko===null)throw Error(i(459));var n=ko;return ko=null,n}function nv(n){if(n===fl||n===hd)throw Error(i(483))}var ml=null,yc=0;function md(n){var r=yc;return yc+=1,ml===null&&(ml=[]),ev(ml,n,r)}function vc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function pd(n,r){throw r.$$typeof===S?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function sv(n){function r(Y,H){if(n){var ne=Y.deletions;ne===null?(Y.deletions=[H],Y.flags|=16):ne.push(H)}}function o(Y,H){if(!n)return null;for(;H!==null;)r(Y,H),H=H.sibling;return null}function c(Y){for(var H=new Map;Y!==null;)Y.key!==null?H.set(Y.key,Y):H.set(Y.index,Y),Y=Y.sibling;return H}function f(Y,H){return Y=zi(Y,H),Y.index=0,Y.sibling=null,Y}function m(Y,H,ne){return Y.index=ne,n?(ne=Y.alternate,ne!==null?(ne=ne.index,ne<H?(Y.flags|=67108866,H):ne):(Y.flags|=67108866,H)):(Y.flags|=1048576,H)}function x(Y){return n&&Y.alternate===null&&(Y.flags|=67108866),Y}function j(Y,H,ne,we){return H===null||H.tag!==6?(H=qf(ne,Y.mode,we),H.return=Y,H):(H=f(H,ne),H.return=Y,H)}function B(Y,H,ne,we){var rt=ne.type;return rt===$?pe(Y,H,ne.props.children,we,ne.key):H!==null&&(H.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===T&&_o(rt)===H.type)?(H=f(H,ne.props),vc(H,ne),H.return=Y,H):(H=od(ne.type,ne.key,ne.props,null,Y.mode,we),vc(H,ne),H.return=Y,H)}function ie(Y,H,ne,we){return H===null||H.tag!==4||H.stateNode.containerInfo!==ne.containerInfo||H.stateNode.implementation!==ne.implementation?(H=Hf(ne,Y.mode,we),H.return=Y,H):(H=f(H,ne.children||[]),H.return=Y,H)}function pe(Y,H,ne,we,rt){return H===null||H.tag!==7?(H=yo(ne,Y.mode,we,rt),H.return=Y,H):(H=f(H,ne),H.return=Y,H)}function _e(Y,H,ne){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=qf(""+H,Y.mode,ne),H.return=Y,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case R:return ne=od(H.type,H.key,H.props,null,Y.mode,ne),vc(ne,H),ne.return=Y,ne;case q:return H=Hf(H,Y.mode,ne),H.return=Y,H;case T:return H=_o(H),_e(Y,H,ne)}if(tt(H)||L(H))return H=yo(H,Y.mode,ne,null),H.return=Y,H;if(typeof H.then=="function")return _e(Y,md(H),ne);if(H.$$typeof===Q)return _e(Y,ud(Y,H),ne);pd(Y,H)}return null}function oe(Y,H,ne,we){var rt=H!==null?H.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return rt!==null?null:j(Y,H,""+ne,we);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case R:return ne.key===rt?B(Y,H,ne,we):null;case q:return ne.key===rt?ie(Y,H,ne,we):null;case T:return ne=_o(ne),oe(Y,H,ne,we)}if(tt(ne)||L(ne))return rt!==null?null:pe(Y,H,ne,we,null);if(typeof ne.then=="function")return oe(Y,H,md(ne),we);if(ne.$$typeof===Q)return oe(Y,H,ud(Y,ne),we);pd(Y,ne)}return null}function fe(Y,H,ne,we,rt){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return Y=Y.get(ne)||null,j(H,Y,""+we,rt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case R:return Y=Y.get(we.key===null?ne:we.key)||null,B(H,Y,we,rt);case q:return Y=Y.get(we.key===null?ne:we.key)||null,ie(H,Y,we,rt);case T:return we=_o(we),fe(Y,H,ne,we,rt)}if(tt(we)||L(we))return Y=Y.get(ne)||null,pe(H,Y,we,rt,null);if(typeof we.then=="function")return fe(Y,H,ne,md(we),rt);if(we.$$typeof===Q)return fe(Y,H,ne,ud(H,we),rt);pd(H,we)}return null}function Ke(Y,H,ne,we){for(var rt=null,on=null,Ze=H,Mt=H=0,$t=null;Ze!==null&&Mt<ne.length;Mt++){Ze.index>Mt?($t=Ze,Ze=null):$t=Ze.sibling;var ln=oe(Y,Ze,ne[Mt],we);if(ln===null){Ze===null&&(Ze=$t);break}n&&Ze&&ln.alternate===null&&r(Y,Ze),H=m(ln,H,Mt),on===null?rt=ln:on.sibling=ln,on=ln,Ze=$t}if(Mt===ne.length)return o(Y,Ze),Yt&&Fi(Y,Mt),rt;if(Ze===null){for(;Mt<ne.length;Mt++)Ze=_e(Y,ne[Mt],we),Ze!==null&&(H=m(Ze,H,Mt),on===null?rt=Ze:on.sibling=Ze,on=Ze);return Yt&&Fi(Y,Mt),rt}for(Ze=c(Ze);Mt<ne.length;Mt++)$t=fe(Ze,Y,Mt,ne[Mt],we),$t!==null&&(n&&$t.alternate!==null&&Ze.delete($t.key===null?Mt:$t.key),H=m($t,H,Mt),on===null?rt=$t:on.sibling=$t,on=$t);return n&&Ze.forEach(function(Ba){return r(Y,Ba)}),Yt&&Fi(Y,Mt),rt}function dt(Y,H,ne,we){if(ne==null)throw Error(i(151));for(var rt=null,on=null,Ze=H,Mt=H=0,$t=null,ln=ne.next();Ze!==null&&!ln.done;Mt++,ln=ne.next()){Ze.index>Mt?($t=Ze,Ze=null):$t=Ze.sibling;var Ba=oe(Y,Ze,ln.value,we);if(Ba===null){Ze===null&&(Ze=$t);break}n&&Ze&&Ba.alternate===null&&r(Y,Ze),H=m(Ba,H,Mt),on===null?rt=Ba:on.sibling=Ba,on=Ba,Ze=$t}if(ln.done)return o(Y,Ze),Yt&&Fi(Y,Mt),rt;if(Ze===null){for(;!ln.done;Mt++,ln=ne.next())ln=_e(Y,ln.value,we),ln!==null&&(H=m(ln,H,Mt),on===null?rt=ln:on.sibling=ln,on=ln);return Yt&&Fi(Y,Mt),rt}for(Ze=c(Ze);!ln.done;Mt++,ln=ne.next())ln=fe(Ze,Y,Mt,ln.value,we),ln!==null&&(n&&ln.alternate!==null&&Ze.delete(ln.key===null?Mt:ln.key),H=m(ln,H,Mt),on===null?rt=ln:on.sibling=ln,on=ln);return n&&Ze.forEach(function(jj){return r(Y,jj)}),Yt&&Fi(Y,Mt),rt}function kn(Y,H,ne,we){if(typeof ne=="object"&&ne!==null&&ne.type===$&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case R:e:{for(var rt=ne.key;H!==null;){if(H.key===rt){if(rt=ne.type,rt===$){if(H.tag===7){o(Y,H.sibling),we=f(H,ne.props.children),we.return=Y,Y=we;break e}}else if(H.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===T&&_o(rt)===H.type){o(Y,H.sibling),we=f(H,ne.props),vc(we,ne),we.return=Y,Y=we;break e}o(Y,H);break}else r(Y,H);H=H.sibling}ne.type===$?(we=yo(ne.props.children,Y.mode,we,ne.key),we.return=Y,Y=we):(we=od(ne.type,ne.key,ne.props,null,Y.mode,we),vc(we,ne),we.return=Y,Y=we)}return x(Y);case q:e:{for(rt=ne.key;H!==null;){if(H.key===rt)if(H.tag===4&&H.stateNode.containerInfo===ne.containerInfo&&H.stateNode.implementation===ne.implementation){o(Y,H.sibling),we=f(H,ne.children||[]),we.return=Y,Y=we;break e}else{o(Y,H);break}else r(Y,H);H=H.sibling}we=Hf(ne,Y.mode,we),we.return=Y,Y=we}return x(Y);case T:return ne=_o(ne),kn(Y,H,ne,we)}if(tt(ne))return Ke(Y,H,ne,we);if(L(ne)){if(rt=L(ne),typeof rt!="function")throw Error(i(150));return ne=rt.call(ne),dt(Y,H,ne,we)}if(typeof ne.then=="function")return kn(Y,H,md(ne),we);if(ne.$$typeof===Q)return kn(Y,H,ud(Y,ne),we);pd(Y,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,H!==null&&H.tag===6?(o(Y,H.sibling),we=f(H,ne),we.return=Y,Y=we):(o(Y,H),we=qf(ne,Y.mode,we),we.return=Y,Y=we),x(Y)):o(Y,H)}return function(Y,H,ne,we){try{yc=0;var rt=kn(Y,H,ne,we);return ml=null,rt}catch(Ze){if(Ze===fl||Ze===hd)throw Ze;var on=kr(29,Ze,null,Y.mode);return on.lanes=we,on.return=Y,on}}}var Eo=sv(!0),rv=sv(!1),ka=!1;function nm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ea(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ta(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(hn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ad(n),z0(n,null,o),r}return id(n,c,r,o),ad(n)}function bc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,at(n,o)}}function rm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var im=!1;function wc(){if(im){var n=hl;if(n!==null)throw n}}function xc(n,r,o,c){im=!1;var f=n.updateQueue;ka=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,j=f.shared.pending;if(j!==null){f.shared.pending=null;var B=j,ie=B.next;B.next=null,x===null?m=ie:x.next=ie,x=B;var pe=n.alternate;pe!==null&&(pe=pe.updateQueue,j=pe.lastBaseUpdate,j!==x&&(j===null?pe.firstBaseUpdate=ie:j.next=ie,pe.lastBaseUpdate=B))}if(m!==null){var _e=f.baseState;x=0,pe=ie=B=null,j=m;do{var oe=j.lane&-536870913,fe=oe!==j.lane;if(fe?(Ht&oe)===oe:(c&oe)===oe){oe!==0&&oe===dl&&(im=!0),pe!==null&&(pe=pe.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Ke=n,dt=j;oe=r;var kn=o;switch(dt.tag){case 1:if(Ke=dt.payload,typeof Ke=="function"){_e=Ke.call(kn,_e,oe);break e}_e=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=dt.payload,oe=typeof Ke=="function"?Ke.call(kn,_e,oe):Ke,oe==null)break e;_e=k({},_e,oe);break e;case 2:ka=!0}}oe=j.callback,oe!==null&&(n.flags|=64,fe&&(n.flags|=8192),fe=f.callbacks,fe===null?f.callbacks=[oe]:fe.push(oe))}else fe={lane:oe,tag:j.tag,payload:j.payload,callback:j.callback,next:null},pe===null?(ie=pe=fe,B=_e):pe=pe.next=fe,x|=oe;if(j=j.next,j===null){if(j=f.shared.pending,j===null)break;fe=j,j=fe.next,fe.next=null,f.lastBaseUpdate=fe,f.shared.pending=null}}while(!0);pe===null&&(B=_e),f.baseState=B,f.firstBaseUpdate=ie,f.lastBaseUpdate=pe,m===null&&(f.shared.lanes=0),Aa|=x,n.lanes=x,n.memoizedState=_e}}function iv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function av(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)iv(o[n],r)}var pl=O(null),gd=O(0);function ov(n,r){n=Zi,Ee(gd,n),Ee(pl,r),Zi=n|r.baseLanes}function am(){Ee(gd,Zi),Ee(pl,pl.current)}function om(){Zi=gd.current,se(pl),se(gd)}var Er=O(null),zr=null;function ja(n){var r=n.alternate;Ee(is,is.current&1),Ee(Er,n),zr===null&&(r===null||pl.current!==null||r.memoizedState!==null)&&(zr=n)}function lm(n){Ee(is,is.current),Ee(Er,n),zr===null&&(zr=n)}function lv(n){n.tag===22?(Ee(is,is.current),Ee(Er,n),zr===null&&(zr=n)):Sa()}function Sa(){Ee(is,is.current),Ee(Er,Er.current)}function Tr(n){se(Er),zr===n&&(zr=null),se(is)}var is=O(0);function yd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mp(o)||pp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var $i=0,Rt=null,xn=null,fs=null,vd=!1,gl=!1,To=!1,bd=0,_c=0,yl=null,gT=0;function Gn(){throw Error(i(321))}function cm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!_r(n[o],r[o]))return!1;return!0}function um(n,r,o,c,f,m){return $i=m,Rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,X.H=n===null||n.memoizedState===null?$v:Tm,To=!1,m=o(c,f),To=!1,gl&&(m=uv(r,o,c,f)),cv(n),m}function cv(n){X.H=Tc;var r=xn!==null&&xn.next!==null;if($i=0,fs=xn=Rt=null,vd=!1,_c=0,yl=null,r)throw Error(i(300));n===null||ms||(n=n.dependencies,n!==null&&cd(n)&&(ms=!0))}function uv(n,r,o,c){Rt=n;var f=0;do{if(gl&&(yl=null),_c=0,gl=!1,25<=f)throw Error(i(301));if(f+=1,fs=xn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}X.H=Wv,m=r(o,c)}while(gl);return m}function yT(){var n=X.H,r=n.useState()[0];return r=typeof r.then=="function"?kc(r):r,n=n.useState()[0],(xn!==null?xn.memoizedState:null)!==n&&(Rt.flags|=1024),r}function dm(){var n=bd!==0;return bd=0,n}function hm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fm(n){if(vd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}vd=!1}$i=0,fs=xn=Rt=null,gl=!1,_c=bd=0,yl=null}function ir(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?Rt.memoizedState=fs=n:fs=fs.next=n,fs}function as(){if(xn===null){var n=Rt.alternate;n=n!==null?n.memoizedState:null}else n=xn.next;var r=fs===null?Rt.memoizedState:fs.next;if(r!==null)fs=r,xn=n;else{if(n===null)throw Rt.alternate===null?Error(i(467)):Error(i(310));xn=n,n={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},fs===null?Rt.memoizedState=fs=n:fs=fs.next=n}return fs}function wd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kc(n){var r=_c;return _c+=1,yl===null&&(yl=[]),n=ev(yl,n,r),r=Rt,(fs===null?r.memoizedState:fs.next)===null&&(r=r.alternate,X.H=r===null||r.memoizedState===null?$v:Tm),n}function xd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return kc(n);if(n.$$typeof===Q)return Bs(n)}throw Error(i(438,String(n)))}function mm(n){var r=null,o=Rt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Rt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=wd(),Rt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=P;return r.index++,o}function Wi(n,r){return typeof r=="function"?r(n):r}function _d(n){var r=as();return pm(r,xn,n)}function pm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var j=x=null,B=null,ie=r,pe=!1;do{var _e=ie.lane&-536870913;if(_e!==ie.lane?(Ht&_e)===_e:($i&_e)===_e){var oe=ie.revertLane;if(oe===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_e===dl&&(pe=!0);else if(($i&oe)===oe){ie=ie.next,oe===dl&&(pe=!0);continue}else _e={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},B===null?(j=B=_e,x=m):B=B.next=_e,Rt.lanes|=oe,Aa|=oe;_e=ie.action,To&&o(m,_e),m=ie.hasEagerState?ie.eagerState:o(m,_e)}else oe={lane:_e,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},B===null?(j=B=oe,x=m):B=B.next=oe,Rt.lanes|=_e,Aa|=_e;ie=ie.next}while(ie!==null&&ie!==r);if(B===null?x=m:B.next=j,!_r(m,n.memoizedState)&&(ms=!0,pe&&(o=hl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function gm(n){var r=as(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);_r(m,r.memoizedState)||(ms=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function dv(n,r,o){var c=Rt,f=as(),m=Yt;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!_r((xn||f).memoizedState,o);if(x&&(f.memoizedState=o,ms=!0),f=f.queue,bm(mv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||fs!==null&&fs.memoizedState.tag&1){if(c.flags|=2048,vl(9,{destroy:void 0},fv.bind(null,c,f,o,r),null),Sn===null)throw Error(i(349));m||($i&127)!==0||hv(c,r,o)}return o}function hv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Rt.updateQueue,r===null?(r=wd(),Rt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function fv(n,r,o,c){r.value=o,r.getSnapshot=c,pv(r)&&gv(n)}function mv(n,r,o){return o(function(){pv(r)&&gv(n)})}function pv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!_r(n,o)}catch{return!0}}function gv(n){var r=go(n,2);r!==null&&pr(r,n,2)}function ym(n){var r=ir();if(typeof n=="function"){var o=n;if(n=o(),To){vt(!0);try{o()}finally{vt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:n},r}function yv(n,r,o,c){return n.baseState=o,pm(n,xn,typeof c=="function"?c:Wi)}function vT(n,r,o,c,f){if(Td(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};X.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,vv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function vv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=X.T,x={};X.T=x;try{var j=o(f,c),B=X.S;B!==null&&B(x,j),bv(n,r,j)}catch(ie){vm(n,r,ie)}finally{m!==null&&x.types!==null&&(m.types=x.types),X.T=m}}else try{m=o(f,c),bv(n,r,m)}catch(ie){vm(n,r,ie)}}function bv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){wv(n,r,c)},function(c){return vm(n,r,c)}):wv(n,r,o)}function wv(n,r,o){r.status="fulfilled",r.value=o,xv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,vv(n,o)))}function vm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,xv(r),r=r.next;while(r!==c)}n.action=null}function xv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function _v(n,r){return r}function kv(n,r){if(Yt){var o=Sn.formState;if(o!==null){e:{var c=Rt;if(Yt){if(Pn){t:{for(var f=Pn,m=Br;f.nodeType!==8;){if(!m){f=null;break t}if(f=Fr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Pn=Fr(f.nextSibling),c=f.data==="F!";break e}}xa(c)}c=!1}c&&(r=o[0])}}return o=ir(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_v,lastRenderedState:r},o.queue=c,o=Fv.bind(null,Rt,c),c.dispatch=o,c=ym(!1),m=Em.bind(null,Rt,!1,c.queue),c=ir(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=vT.bind(null,Rt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function Ev(n){var r=as();return Tv(r,xn,n)}function Tv(n,r,o){if(r=pm(n,r,_v)[0],n=_d(Wi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=kc(r)}catch(x){throw x===fl?hd:x}else c=r;r=as();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Rt.flags|=2048,vl(9,{destroy:void 0},bT.bind(null,f,o),null)),[c,m,n]}function bT(n,r){n.action=r}function jv(n){var r=as(),o=xn;if(o!==null)return Tv(r,o,n);as(),r=r.memoizedState,o=as();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function vl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Rt.updateQueue,r===null&&(r=wd(),Rt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Sv(){return as().memoizedState}function kd(n,r,o,c){var f=ir();Rt.flags|=n,f.memoizedState=vl(1|r,{destroy:void 0},o,c===void 0?null:c)}function Ed(n,r,o,c){var f=as();c=c===void 0?null:c;var m=f.memoizedState.inst;xn!==null&&c!==null&&cm(c,xn.memoizedState.deps)?f.memoizedState=vl(r,m,o,c):(Rt.flags|=n,f.memoizedState=vl(1|r,m,o,c))}function Cv(n,r){kd(8390656,8,n,r)}function bm(n,r){Ed(2048,8,n,r)}function wT(n){Rt.flags|=4;var r=Rt.updateQueue;if(r===null)r=wd(),Rt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Nv(n){var r=as().memoizedState;return wT({ref:r,nextImpl:n}),function(){if((hn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Av(n,r){return Ed(4,2,n,r)}function Rv(n,r){return Ed(4,4,n,r)}function Iv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Mv(n,r,o){o=o!=null?o.concat([n]):null,Ed(4,4,Iv.bind(null,r,n),o)}function wm(){}function Dv(n,r){var o=as();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&cm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Lv(n,r){var o=as();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&cm(r,c[1]))return c[0];if(c=n(),To){vt(!0);try{n()}finally{vt(!1)}}return o.memoizedState=[c,r],c}function xm(n,r,o){return o===void 0||($i&1073741824)!==0&&(Ht&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=O1(),Rt.lanes|=n,Aa|=n,o)}function Ov(n,r,o,c){return _r(o,r)?o:pl.current!==null?(n=xm(n,o,c),_r(n,r)||(ms=!0),n):($i&42)===0||($i&1073741824)!==0&&(Ht&261930)===0?(ms=!0,n.memoizedState=o):(n=O1(),Rt.lanes|=n,Aa|=n,r)}function Pv(n,r,o,c,f){var m=Ce.p;Ce.p=m!==0&&8>m?m:8;var x=X.T,j={};X.T=j,Em(n,!1,r,o);try{var B=f(),ie=X.S;if(ie!==null&&ie(j,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var pe=pT(B,c);Ec(n,r,pe,Cr(n))}else Ec(n,r,c,Cr(n))}catch(_e){Ec(n,r,{then:function(){},status:"rejected",reason:_e},Cr())}finally{Ce.p=m,x!==null&&j.types!==null&&(x.types=j.types),X.T=x}}function xT(){}function _m(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Vv(n).queue;Pv(n,f,r,Me,o===null?xT:function(){return Uv(n),o(c)})}function Vv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:Me},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Uv(n){var r=Vv(n);r.next===null&&(r=n.alternate.memoizedState),Ec(n,r.next.queue,{},Cr())}function km(){return Bs(zc)}function Bv(){return as().memoizedState}function zv(){return as().memoizedState}function _T(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Cr();n=Ea(o);var c=Ta(r,n,o);c!==null&&(pr(c,r,o),bc(c,r,o)),r={cache:Jf()},n.payload=r;return}r=r.return}}function kT(n,r,o){var c=Cr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Td(n)?qv(r,o):(o=zf(n,r,o,c),o!==null&&(pr(o,n,c),Hv(o,r,c)))}function Fv(n,r,o){var c=Cr();Ec(n,r,o,c)}function Ec(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Td(n))qv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,j=m(x,o);if(f.hasEagerState=!0,f.eagerState=j,_r(j,x))return id(n,r,f,0),Sn===null&&rd(),!1}catch{}if(o=zf(n,r,f,c),o!==null)return pr(o,n,c),Hv(o,r,c),!0}return!1}function Em(n,r,o,c){if(c={lane:2,revertLane:np(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Td(n)){if(r)throw Error(i(479))}else r=zf(n,o,c,2),r!==null&&pr(r,n,2)}function Td(n){var r=n.alternate;return n===Rt||r!==null&&r===Rt}function qv(n,r){gl=vd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function Hv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,at(n,o)}}var Tc={readContext:Bs,use:xd,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useLayoutEffect:Gn,useInsertionEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useSyncExternalStore:Gn,useId:Gn,useHostTransitionStatus:Gn,useFormState:Gn,useActionState:Gn,useOptimistic:Gn,useMemoCache:Gn,useCacheRefresh:Gn};Tc.useEffectEvent=Gn;var $v={readContext:Bs,use:xd,useCallback:function(n,r){return ir().memoizedState=[n,r===void 0?null:r],n},useContext:Bs,useEffect:Cv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,kd(4194308,4,Iv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return kd(4194308,4,n,r)},useInsertionEffect:function(n,r){kd(4,2,n,r)},useMemo:function(n,r){var o=ir();r=r===void 0?null:r;var c=n();if(To){vt(!0);try{n()}finally{vt(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=ir();if(o!==void 0){var f=o(r);if(To){vt(!0);try{o(r)}finally{vt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=kT.bind(null,Rt,n),[c.memoizedState,n]},useRef:function(n){var r=ir();return n={current:n},r.memoizedState=n},useState:function(n){n=ym(n);var r=n.queue,o=Fv.bind(null,Rt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:wm,useDeferredValue:function(n,r){var o=ir();return xm(o,n,r)},useTransition:function(){var n=ym(!1);return n=Pv.bind(null,Rt,n.queue,!0,!1),ir().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Rt,f=ir();if(Yt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Sn===null)throw Error(i(349));(Ht&127)!==0||hv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Cv(mv.bind(null,c,m,n),[n]),c.flags|=2048,vl(9,{destroy:void 0},fv.bind(null,c,m,o,r),null),o},useId:function(){var n=ir(),r=Sn.identifierPrefix;if(Yt){var o=xi,c=wi;o=(c&~(1<<32-Ct(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=bd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=gT++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:kv,useActionState:kv,useOptimistic:function(n){var r=ir();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Em.bind(null,Rt,!0,o),o.dispatch=r,[n,r]},useMemoCache:mm,useCacheRefresh:function(){return ir().memoizedState=_T.bind(null,Rt)},useEffectEvent:function(n){var r=ir(),o={impl:n};return r.memoizedState=o,function(){if((hn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Tm={readContext:Bs,use:xd,useCallback:Dv,useContext:Bs,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:_d,useRef:Sv,useState:function(){return _d(Wi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=as();return Ov(o,xn.memoizedState,n,r)},useTransition:function(){var n=_d(Wi)[0],r=as().memoizedState;return[typeof n=="boolean"?n:kc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:Ev,useActionState:Ev,useOptimistic:function(n,r){var o=as();return yv(o,xn,n,r)},useMemoCache:mm,useCacheRefresh:zv};Tm.useEffectEvent=Nv;var Wv={readContext:Bs,use:xd,useCallback:Dv,useContext:Bs,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:gm,useRef:Sv,useState:function(){return gm(Wi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=as();return xn===null?xm(o,n,r):Ov(o,xn.memoizedState,n,r)},useTransition:function(){var n=gm(Wi)[0],r=as().memoizedState;return[typeof n=="boolean"?n:kc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:jv,useActionState:jv,useOptimistic:function(n,r){var o=as();return xn!==null?yv(o,xn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mm,useCacheRefresh:zv};Wv.useEffectEvent=Nv;function jm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Cr(),f=Ea(c);f.payload=r,o!=null&&(f.callback=o),r=Ta(n,f,c),r!==null&&(pr(r,n,c),bc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Cr(),f=Ea(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ta(n,f,c),r!==null&&(pr(r,n,c),bc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Cr(),c=Ea(o);c.tag=2,r!=null&&(c.callback=r),r=Ta(n,c,o),r!==null&&(pr(r,n,o),bc(r,n,o))}};function Gv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!dc(o,c)||!dc(f,m):!0}function Kv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function jo(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Yv(n){sd(n)}function Qv(n){console.error(n)}function Xv(n){sd(n)}function jd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Cm(n,r,o){return o=Ea(o),o.tag=3,o.payload={element:null},o.callback=function(){jd(n,r)},o}function Zv(n){return n=Ea(n),n.tag=3,n}function e1(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Jv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Jv(r,o,c),typeof f!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function ET(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ul(r,o,f,!0),o=Er.current,o!==null){switch(o.tag){case 31:case 13:return zr===null?Vd():o.alternate===null&&Kn===0&&(Kn=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Zm(n,c,f)),!1;case 22:return o.flags|=65536,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Zm(n,c,f)),!1}throw Error(i(435,o.tag))}return Zm(n,c,f),Vd(),!1}if(Yt)return r=Er.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Gf&&(n=Error(i(422),{cause:c}),mc(Pr(n,o)))):(c!==Gf&&(r=Error(i(423),{cause:c}),mc(Pr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Pr(c,o),f=Cm(n.stateNode,c,f),rm(n,f),Kn!==4&&(Kn=2)),!1;var m=Error(i(520),{cause:c});if(m=Pr(m,o),Mc===null?Mc=[m]:Mc.push(m),Kn!==4&&(Kn=2),r===null)return!0;c=Pr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Cm(o.stateNode,c,n),rm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ra===null||!Ra.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Zv(f),e1(f,n,o,c),rm(o,f),!1}o=o.return}while(o!==null);return!1}var Nm=Error(i(461)),ms=!1;function zs(n,r,o,c){r.child=n===null?rv(r,null,o,c):Eo(r,n.child,o,c)}function t1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var j in c)j!=="ref"&&(x[j]=c[j])}else x=c;return wo(r),c=um(n,r,o,x,m,f),j=dm(),n!==null&&!ms?(hm(n,r,f),Gi(n,r,f)):(Yt&&j&&$f(r),r.flags|=1,zs(n,r,c,f),r.child)}function n1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Ff(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,s1(n,r,m,c,f)):(n=od(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Pm(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:dc,o(x,c)&&n.ref===r.ref)return Gi(n,r,f)}return r.flags|=1,n=zi(m,c),n.ref=r.ref,n.return=r,r.child=n}function s1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(dc(m,c)&&n.ref===r.ref)if(ms=!1,r.pendingProps=c=m,Pm(n,f))(n.flags&131072)!==0&&(ms=!0);else return r.lanes=n.lanes,Gi(n,r,f)}return Am(n,r,o,c,f)}function r1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return i1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&dd(r,m!==null?m.cachePool:null),m!==null?ov(r,m):am(),lv(r);else return c=r.lanes=536870912,i1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(dd(r,m.cachePool),ov(r,m),Sa(),r.memoizedState=null):(n!==null&&dd(r,null),am(),Sa());return zs(n,r,f,o),r.child}function jc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function i1(n,r,o,c,f){var m=em();return m=m===null?null:{parent:hs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&dd(r,null),am(),lv(r),n!==null&&ul(n,r,c,!0),r.childLanes=f,null}function Sd(n,r){return r=Nd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function a1(n,r,o){return Eo(r,n.child,null,o),n=Sd(r,r.pendingProps),n.flags|=2,Tr(r),r.memoizedState=null,n}function TT(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Yt){if(c.mode==="hidden")return n=Sd(r,c),r.lanes=536870912,jc(null,n);if(lm(r),(n=Pn)?(n=vb(n,Br),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ba!==null?{id:wi,overflow:xi}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Us=r,Pn=null)):n=null,n===null)throw xa(r);return r.lanes=536870912,null}return Sd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(lm(r),f)if(r.flags&256)r.flags&=-257,r=a1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ms||ul(n,r,o,!1),f=(o&n.childLanes)!==0,ms||f){if(c=Sn,c!==null&&(x=Vt(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,go(n,x),pr(c,n,x),Nm;Vd(),r=a1(n,r,o)}else n=m.treeContext,Pn=Fr(x.nextSibling),Us=r,Yt=!0,wa=null,Br=!1,n!==null&&W0(r,n),r=Sd(r,c),r.flags|=4096;return r}return n=zi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Cd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Am(n,r,o,c,f){return wo(r),o=um(n,r,o,c,void 0,f),c=dm(),n!==null&&!ms?(hm(n,r,f),Gi(n,r,f)):(Yt&&c&&$f(r),r.flags|=1,zs(n,r,o,f),r.child)}function o1(n,r,o,c,f,m){return wo(r),r.updateQueue=null,o=uv(r,c,o,f),cv(n),c=dm(),n!==null&&!ms?(hm(n,r,m),Gi(n,r,m)):(Yt&&c&&$f(r),r.flags|=1,zs(n,r,o,m),r.child)}function l1(n,r,o,c,f){if(wo(r),r.stateNode===null){var m=al,x=o.contextType;typeof x=="object"&&x!==null&&(m=Bs(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},nm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Bs(x):al,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(jm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Sm.enqueueReplaceState(m,m.state,null),xc(r,c,m,f),wc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var j=r.memoizedProps,B=jo(o,j);m.props=B;var ie=m.context,pe=o.contextType;x=al,typeof pe=="object"&&pe!==null&&(x=Bs(pe));var _e=o.getDerivedStateFromProps;pe=typeof _e=="function"||typeof m.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,pe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j||ie!==x)&&Kv(r,m,c,x),ka=!1;var oe=r.memoizedState;m.state=oe,xc(r,c,m,f),wc(),ie=r.memoizedState,j||oe!==ie||ka?(typeof _e=="function"&&(jm(r,o,_e,c),ie=r.memoizedState),(B=ka||Gv(r,o,B,c,oe,ie,x))?(pe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ie),m.props=c,m.state=ie,m.context=x,c=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,sm(n,r),x=r.memoizedProps,pe=jo(o,x),m.props=pe,_e=r.pendingProps,oe=m.context,ie=o.contextType,B=al,typeof ie=="object"&&ie!==null&&(B=Bs(ie)),j=o.getDerivedStateFromProps,(ie=typeof j=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==_e||oe!==B)&&Kv(r,m,c,B),ka=!1,oe=r.memoizedState,m.state=oe,xc(r,c,m,f),wc();var fe=r.memoizedState;x!==_e||oe!==fe||ka||n!==null&&n.dependencies!==null&&cd(n.dependencies)?(typeof j=="function"&&(jm(r,o,j,c),fe=r.memoizedState),(pe=ka||Gv(r,o,pe,c,oe,fe,B)||n!==null&&n.dependencies!==null&&cd(n.dependencies))?(ie||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,fe,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,fe,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&oe===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&oe===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=fe),m.props=c,m.state=fe,m.context=B,c=pe):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&oe===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&oe===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Cd(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=Eo(r,n.child,null,f),r.child=Eo(r,null,o,f)):zs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Gi(n,r,f),n}function c1(n,r,o,c){return vo(),r.flags|=256,zs(n,r,o,c),r.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:J0()}}function Mm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Sr),n}function u1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(is.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(Yt){if(f?ja(r):Sa(),(n=Pn)?(n=vb(n,Br),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ba!==null?{id:wi,overflow:xi}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Us=r,Pn=null)):n=null,n===null)throw xa(r);return pp(n)?r.lanes=32:r.lanes=536870912,null}var j=c.children;return c=c.fallback,f?(Sa(),f=r.mode,j=Nd({mode:"hidden",children:j},f),c=yo(c,f,o,null),j.return=r,c.return=r,j.sibling=c,r.child=j,c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,jc(null,c)):(ja(r),Dm(r,j))}var B=n.memoizedState;if(B!==null&&(j=B.dehydrated,j!==null)){if(m)r.flags&256?(ja(r),r.flags&=-257,r=Lm(n,r,o)):r.memoizedState!==null?(Sa(),r.child=n.child,r.flags|=128,r=null):(Sa(),j=c.fallback,f=r.mode,c=Nd({mode:"visible",children:c.children},f),j=yo(j,f,o,null),j.flags|=2,c.return=r,j.return=r,c.sibling=j,r.child=c,Eo(r,n.child,null,o),c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,r=jc(null,c));else if(ja(r),pp(j)){if(x=j.nextSibling&&j.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,mc({value:c,source:null,stack:null}),r=Lm(n,r,o)}else if(ms||ul(n,r,o,!1),x=(o&n.childLanes)!==0,ms||x){if(x=Sn,x!==null&&(c=Vt(x,o),c!==0&&c!==B.retryLane))throw B.retryLane=c,go(n,c),pr(x,n,c),Nm;mp(j)||Vd(),r=Lm(n,r,o)}else mp(j)?(r.flags|=192,r.child=n.child,r=null):(n=B.treeContext,Pn=Fr(j.nextSibling),Us=r,Yt=!0,wa=null,Br=!1,n!==null&&W0(r,n),r=Dm(r,c.children),r.flags|=4096);return r}return f?(Sa(),j=c.fallback,f=r.mode,B=n.child,ie=B.sibling,c=zi(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,ie!==null?j=zi(ie,j):(j=yo(j,f,o,null),j.flags|=2),j.return=r,c.return=r,c.sibling=j,r.child=c,jc(null,c),c=r.child,j=n.child.memoizedState,j===null?j=Im(o):(f=j.cachePool,f!==null?(B=hs._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=J0(),j={baseLanes:j.baseLanes|o,cachePool:f}),c.memoizedState=j,c.childLanes=Mm(n,x,o),r.memoizedState=Rm,jc(n.child,c)):(ja(r),o=n.child,n=o.sibling,o=zi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Dm(n,r){return r=Nd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Nd(n,r){return n=kr(22,n,null,r),n.lanes=0,n}function Lm(n,r,o){return Eo(r,n.child,null,o),n=Dm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function d1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qf(n.return,r,o)}function Om(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function h1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=is.current,j=(x&2)!==0;if(j?(x=x&1|2,r.flags|=128):x&=1,Ee(is,x),zs(n,r,c,o),c=Yt?fc:0,!j&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&d1(n,o,r);else if(n.tag===19)d1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&yd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Om(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&yd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Om(r,!0,o,null,m,c);break;case"together":Om(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Gi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Aa|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ul(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=zi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=zi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Pm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&cd(n)))}function jT(n,r,o){switch(r.tag){case 3:We(r,r.stateNode.containerInfo),_a(r,hs,n.memoizedState.cache),vo();break;case 27:case 5:Ut(r);break;case 4:We(r,r.stateNode.containerInfo);break;case 10:_a(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ja(r),r.flags|=128,null):(o&r.child.childLanes)!==0?u1(n,r,o):(ja(r),n=Gi(n,r,o),n!==null?n.sibling:null);ja(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ul(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return h1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Ee(is,is.current),c)break;return null;case 22:return r.lanes=0,r1(n,r,o,r.pendingProps);case 24:_a(r,hs,n.memoizedState.cache)}return Gi(n,r,o)}function f1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ms=!0;else{if(!Pm(n,o)&&(r.flags&128)===0)return ms=!1,jT(n,r,o);ms=(n.flags&131072)!==0}else ms=!1,Yt&&(r.flags&1048576)!==0&&$0(r,fc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=_o(r.elementType),r.type=n,typeof n=="function")Ff(n)?(c=jo(n,c),r.tag=1,r=l1(null,r,n,c,o)):(r.tag=0,r=Am(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===me){r.tag=11,r=t1(null,r,n,c,o);break e}else if(f===C){r.tag=14,r=n1(null,r,n,c,o);break e}}throw r=De(n)||n,Error(i(306,r,""))}}return r;case 0:return Am(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=jo(c,r.pendingProps),l1(n,r,c,f,o);case 3:e:{if(We(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,sm(n,r),xc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,_a(r,hs,c),c!==m.cache&&Xf(r,[hs],o,!0),wc(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=c1(n,r,c,o);break e}else if(c!==f){f=Pr(Error(i(424)),r),mc(f),r=c1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Pn=Fr(n.firstChild),Us=r,Yt=!0,wa=null,Br=!0,o=rv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(vo(),c===f){r=Gi(n,r,o);break e}zs(n,r,c,o)}r=r.child}return r;case 26:return Cd(n,r),n===null?(o=Eb(r.type,null,r.pendingProps,null))?r.memoizedState=o:Yt||(o=r.type,n=r.pendingProps,c=$d(Ne.current).createElement(o),c[yn]=r,c[cn]=n,Fs(c,o,n),un(c),r.stateNode=c):r.memoizedState=Eb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Ut(r),n===null&&Yt&&(c=r.stateNode=xb(r.type,r.pendingProps,Ne.current),Us=r,Br=!0,f=Pn,La(r.type)?(gp=f,Pn=Fr(c.firstChild)):Pn=f),zs(n,r,r.pendingProps.children,o),Cd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Yt&&((f=c=Pn)&&(c=nj(c,r.type,r.pendingProps,Br),c!==null?(r.stateNode=c,Us=r,Pn=Fr(c.firstChild),Br=!1,f=!0):f=!1),f||xa(r)),Ut(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,dp(f,m)?c=null:x!==null&&dp(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=um(n,r,yT,null,null,o),zc._currentValue=f),Cd(n,r),zs(n,r,c,o),r.child;case 6:return n===null&&Yt&&((n=o=Pn)&&(o=sj(o,r.pendingProps,Br),o!==null?(r.stateNode=o,Us=r,Pn=null,n=!0):n=!1),n||xa(r)),null;case 13:return u1(n,r,o);case 4:return We(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=Eo(r,null,c,o):zs(n,r,c,o),r.child;case 11:return t1(n,r,r.type,r.pendingProps,o);case 7:return zs(n,r,r.pendingProps,o),r.child;case 8:return zs(n,r,r.pendingProps.children,o),r.child;case 12:return zs(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,_a(r,r.type,c.value),zs(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,wo(r),f=Bs(f),c=c(f),r.flags|=1,zs(n,r,c,o),r.child;case 14:return n1(n,r,r.type,r.pendingProps,o);case 15:return s1(n,r,r.type,r.pendingProps,o);case 19:return h1(n,r,o);case 31:return TT(n,r,o);case 22:return r1(n,r,o,r.pendingProps);case 24:return wo(r),c=Bs(hs),n===null?(f=em(),f===null&&(f=Sn,m=Jf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},nm(r),_a(r,hs,f)):((n.lanes&o)!==0&&(sm(n,r),xc(r,null,null,o),wc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),_a(r,hs,c)):(c=m.cache,_a(r,hs,c),c!==f.cache&&Xf(r,[hs],o,!0))),zs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Ki(n){n.flags|=4}function Vm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(B1())n.flags|=8192;else throw ko=fd,tm}else n.flags&=-16777217}function m1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Nb(r))if(B1())n.flags|=8192;else throw ko=fd,tm}function Ad(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?Rn():536870912,n.lanes|=r,_l|=r)}function Sc(n,r){if(!Yt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Vn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function ST(n,r,o){var c=r.pendingProps;switch(Wf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(r),null;case 1:return Vn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Hi(hs),Ue(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(cl(r)?Ki(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Kf())),Vn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Ki(r),m!==null?(Vn(r),m1(r,m)):(Vn(r),Vm(r,f,null,c,o))):m?m!==n.memoizedState?(Ki(r),Vn(r),m1(r,m)):(Vn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Ki(r),Vn(r),Vm(r,f,n,c,o)),null;case 27:if(St(r),o=Ne.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ki(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}n=Se.current,cl(r)?G0(r):(n=xb(f,c,o),r.stateNode=n,Ki(r))}return Vn(r),null;case 5:if(St(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ki(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}if(m=Se.current,cl(r))G0(r);else{var x=$d(Ne.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[yn]=r,m[cn]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Fs(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ki(r)}}return Vn(r),Vm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Ki(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ne.current,cl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Us,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[yn]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ub(n.nodeValue,o)),n||xa(r,!0)}else n=$d(n).createTextNode(c),n[yn]=r,r.stateNode=n}return Vn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=cl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[yn]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),n=!1}else o=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Tr(r),r):(Tr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Vn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=cl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[yn]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),f=!1}else f=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Tr(r),r):(Tr(r),null)}return Tr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Ad(r,r.updateQueue),Vn(r),null);case 4:return Ue(),n===null&&ap(r.stateNode.containerInfo),Vn(r),null;case 10:return Hi(r.type),Vn(r),null;case 19:if(se(is),c=r.memoizedState,c===null)return Vn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Sc(c,!1);else{if(Kn!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=yd(n),m!==null){for(r.flags|=128,Sc(c,!1),n=m.updateQueue,r.updateQueue=n,Ad(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)F0(o,n),o=o.sibling;return Ee(is,is.current&1|2),Yt&&Fi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&ot()>Ld&&(r.flags|=128,f=!0,Sc(c,!1),r.lanes=4194304)}else{if(!f)if(n=yd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Ad(r,n),Sc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Yt)return Vn(r),null}else 2*ot()-c.renderingStartTime>Ld&&o!==536870912&&(r.flags|=128,f=!0,Sc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=ot(),n.sibling=null,o=is.current,Ee(is,f?o&1|2:o&1),Yt&&Fi(r,c.treeForkCount),n):(Vn(r),null);case 22:case 23:return Tr(r),om(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Vn(r),r.subtreeFlags&6&&(r.flags|=8192)):Vn(r),o=r.updateQueue,o!==null&&Ad(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&se(xo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Hi(hs),Vn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function CT(n,r){switch(Wf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Hi(hs),Ue(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return St(r),null;case 31:if(r.memoizedState!==null){if(Tr(r),r.alternate===null)throw Error(i(340));vo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Tr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));vo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return se(is),null;case 4:return Ue(),null;case 10:return Hi(r.type),null;case 22:case 23:return Tr(r),om(),n!==null&&se(xo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Hi(hs),null;case 25:return null;default:return null}}function p1(n,r){switch(Wf(r),r.tag){case 3:Hi(hs),Ue();break;case 26:case 27:case 5:St(r);break;case 4:Ue();break;case 31:r.memoizedState!==null&&Tr(r);break;case 13:Tr(r);break;case 19:se(is);break;case 10:Hi(r.type);break;case 22:case 23:Tr(r),om(),n!==null&&se(xo);break;case 24:Hi(hs)}}function Cc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(j){bn(r,r.return,j)}}function Ca(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,j=x.destroy;if(j!==void 0){x.destroy=void 0,f=r;var B=o,ie=j;try{ie()}catch(pe){bn(f,B,pe)}}}c=c.next}while(c!==m)}}catch(pe){bn(r,r.return,pe)}}function g1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{av(r,o)}catch(c){bn(n,n.return,c)}}}function y1(n,r,o){o.props=jo(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){bn(n,r,c)}}function Nc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){bn(n,r,f)}}function _i(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){bn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){bn(n,r,f)}else o.current=null}function v1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){bn(n,n.return,f)}}function Um(n,r,o){try{var c=n.stateNode;QT(c,n.type,o,r),c[cn]=r}catch(f){bn(n,n.return,f)}}function b1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&La(n.type)||n.tag===4}function Bm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||b1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&La(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=nr));else if(c!==4&&(c===27&&La(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(zm(n,r,o),n=n.sibling;n!==null;)zm(n,r,o),n=n.sibling}function Rd(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&La(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Rd(n,r,o),n=n.sibling;n!==null;)Rd(n,r,o),n=n.sibling}function w1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Fs(r,c,o),r[yn]=n,r[cn]=o}catch(m){bn(n,n.return,m)}}var Yi=!1,ps=!1,Fm=!1,x1=typeof WeakSet=="function"?WeakSet:Set,Is=null;function NT(n,r){if(n=n.containerInfo,cp=Jd,n=M0(n),Lf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,j=-1,B=-1,ie=0,pe=0,_e=n,oe=null;t:for(;;){for(var fe;_e!==o||f!==0&&_e.nodeType!==3||(j=x+f),_e!==m||c!==0&&_e.nodeType!==3||(B=x+c),_e.nodeType===3&&(x+=_e.nodeValue.length),(fe=_e.firstChild)!==null;)oe=_e,_e=fe;for(;;){if(_e===n)break t;if(oe===o&&++ie===f&&(j=x),oe===m&&++pe===c&&(B=x),(fe=_e.nextSibling)!==null)break;_e=oe,oe=_e.parentNode}_e=fe}o=j===-1||B===-1?null:{start:j,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(up={focusedElem:n,selectionRange:o},Jd=!1,Is=r;Is!==null;)if(r=Is,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Is=n;else for(;Is!==null;){switch(r=Is,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Ke=jo(o.type,f);n=c.getSnapshotBeforeUpdate(Ke,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(dt){bn(o,o.return,dt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Is=n;break}Is=r.return}}function _1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Xi(n,o),c&4&&Cc(5,o);break;case 1:if(Xi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){bn(o,o.return,x)}else{var f=jo(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){bn(o,o.return,x)}}c&64&&g1(o),c&512&&Nc(o,o.return);break;case 3:if(Xi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{av(n,r)}catch(x){bn(o,o.return,x)}}break;case 27:r===null&&c&4&&w1(o);case 26:case 5:Xi(n,o),r===null&&c&4&&v1(o),c&512&&Nc(o,o.return);break;case 12:Xi(n,o);break;case 31:Xi(n,o),c&4&&T1(n,o);break;case 13:Xi(n,o),c&4&&j1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=VT.bind(null,o),rj(n,o))));break;case 22:if(c=o.memoizedState!==null||Yi,!c){r=r!==null&&r.memoizedState!==null||ps,f=Yi;var m=ps;Yi=c,(ps=r)&&!m?Ji(n,o,(o.subtreeFlags&8772)!==0):Xi(n,o),Yi=f,ps=m}break;case 30:break;default:Xi(n,o)}}function k1(n){var r=n.alternate;r!==null&&(n.alternate=null,k1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&xs(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Fn=null,dr=!1;function Qi(n,r,o){for(o=o.child;o!==null;)E1(n,r,o),o=o.sibling}function E1(n,r,o){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(rn,o)}catch{}switch(o.tag){case 26:ps||_i(o,r),Qi(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ps||_i(o,r);var c=Fn,f=dr;La(o.type)&&(Fn=o.stateNode,dr=!1),Qi(n,r,o),Vc(o.stateNode),Fn=c,dr=f;break;case 5:ps||_i(o,r);case 6:if(c=Fn,f=dr,Fn=null,Qi(n,r,o),Fn=c,dr=f,Fn!==null)if(dr)try{(Fn.nodeType===9?Fn.body:Fn.nodeName==="HTML"?Fn.ownerDocument.body:Fn).removeChild(o.stateNode)}catch(m){bn(o,r,m)}else try{Fn.removeChild(o.stateNode)}catch(m){bn(o,r,m)}break;case 18:Fn!==null&&(dr?(n=Fn,gb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Al(n)):gb(Fn,o.stateNode));break;case 4:c=Fn,f=dr,Fn=o.stateNode.containerInfo,dr=!0,Qi(n,r,o),Fn=c,dr=f;break;case 0:case 11:case 14:case 15:Ca(2,o,r),ps||Ca(4,o,r),Qi(n,r,o);break;case 1:ps||(_i(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&y1(o,r,c)),Qi(n,r,o);break;case 21:Qi(n,r,o);break;case 22:ps=(c=ps)||o.memoizedState!==null,Qi(n,r,o),ps=c;break;default:Qi(n,r,o)}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Al(n)}catch(o){bn(r,r.return,o)}}}function j1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Al(n)}catch(o){bn(r,r.return,o)}}function AT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new x1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new x1),r;default:throw Error(i(435,n.tag))}}function Id(n,r){var o=AT(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=UT.bind(null,n,c);c.then(f,f)}})}function hr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,j=x;e:for(;j!==null;){switch(j.tag){case 27:if(La(j.type)){Fn=j.stateNode,dr=!1;break e}break;case 5:Fn=j.stateNode,dr=!1;break e;case 3:case 4:Fn=j.stateNode.containerInfo,dr=!0;break e}j=j.return}if(Fn===null)throw Error(i(160));E1(m,x,f),Fn=null,dr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)S1(r,n),r=r.sibling}var ai=null;function S1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:hr(r,n),fr(n),c&4&&(Ca(3,n,n.return),Cc(3,n),Ca(5,n,n.return));break;case 1:hr(r,n),fr(n),c&512&&(ps||o===null||_i(o,o.return)),c&64&&Yi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ai;if(hr(r,n),fr(n),c&512&&(ps||o===null||_i(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Ns]||m[yn]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Fs(m,c,o),m[yn]=n,un(m),c=m;break e;case"link":var x=Sb("link","href",f).get(c+(o.href||""));if(x){for(var j=0;j<x.length;j++)if(m=x[j],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(j,1);break t}}m=f.createElement(c),Fs(m,c,o),f.head.appendChild(m);break;case"meta":if(x=Sb("meta","content",f).get(c+(o.content||""))){for(j=0;j<x.length;j++)if(m=x[j],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(j,1);break t}}m=f.createElement(c),Fs(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[yn]=n,un(m),c=m}n.stateNode=c}else Cb(f,n.type,n.stateNode);else n.stateNode=jb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Cb(f,n.type,n.stateNode):jb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Um(n,n.memoizedProps,o.memoizedProps)}break;case 27:hr(r,n),fr(n),c&512&&(ps||o===null||_i(o,o.return)),o!==null&&c&4&&Um(n,n.memoizedProps,o.memoizedProps);break;case 5:if(hr(r,n),fr(n),c&512&&(ps||o===null||_i(o,o.return)),n.flags&32){f=n.stateNode;try{Rs(f,"")}catch(Ke){bn(n,n.return,Ke)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Um(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Fm=!0);break;case 6:if(hr(r,n),fr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Ke){bn(n,n.return,Ke)}}break;case 3:if(Kd=null,f=ai,ai=Wd(r.containerInfo),hr(r,n),ai=f,fr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Al(r.containerInfo)}catch(Ke){bn(n,n.return,Ke)}Fm&&(Fm=!1,C1(n));break;case 4:c=ai,ai=Wd(n.stateNode.containerInfo),hr(r,n),fr(n),ai=c;break;case 12:hr(r,n),fr(n);break;case 31:hr(r,n),fr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 13:hr(r,n),fr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Dd=ot()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 22:f=n.memoizedState!==null;var B=o!==null&&o.memoizedState!==null,ie=Yi,pe=ps;if(Yi=ie||f,ps=pe||B,hr(r,n),ps=pe,Yi=ie,fr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||B||Yi||ps||So(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){B=o=r;try{if(m=B.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{j=B.stateNode;var _e=B.memoizedProps.style,oe=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;j.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(Ke){bn(B,B.return,Ke)}}}else if(r.tag===6){if(o===null){B=r;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(Ke){bn(B,B.return,Ke)}}}else if(r.tag===18){if(o===null){B=r;try{var fe=B.stateNode;f?yb(fe,!0):yb(B.stateNode,!1)}catch(Ke){bn(B,B.return,Ke)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Id(n,o))));break;case 19:hr(r,n),fr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 30:break;case 21:break;default:hr(r,n),fr(n)}}function fr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(b1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Bm(n);Rd(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Rs(x,""),o.flags&=-33);var j=Bm(n);Rd(n,j,x);break;case 3:case 4:var B=o.stateNode.containerInfo,ie=Bm(n);zm(n,ie,B);break;default:throw Error(i(161))}}catch(pe){bn(n,n.return,pe)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function C1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;C1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Xi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)_1(n,r.alternate,r),r=r.sibling}function So(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Ca(4,r,r.return),So(r);break;case 1:_i(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&y1(r,r.return,o),So(r);break;case 27:Vc(r.stateNode);case 26:case 5:_i(r,r.return),So(r);break;case 22:r.memoizedState===null&&So(r);break;case 30:So(r);break;default:So(r)}n=n.sibling}}function Ji(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:Ji(f,m,o),Cc(4,m);break;case 1:if(Ji(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ie){bn(c,c.return,ie)}if(c=m,f=c.updateQueue,f!==null){var j=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)iv(B[f],j)}catch(ie){bn(c,c.return,ie)}}o&&x&64&&g1(m),Nc(m,m.return);break;case 27:w1(m);case 26:case 5:Ji(f,m,o),o&&c===null&&x&4&&v1(m),Nc(m,m.return);break;case 12:Ji(f,m,o);break;case 31:Ji(f,m,o),o&&x&4&&T1(f,m);break;case 13:Ji(f,m,o),o&&x&4&&j1(f,m);break;case 22:m.memoizedState===null&&Ji(f,m,o),Nc(m,m.return);break;case 30:break;default:Ji(f,m,o)}r=r.sibling}}function qm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&pc(o))}function Hm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&pc(n))}function oi(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N1(n,r,o,c),r=r.sibling}function N1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:oi(n,r,o,c),f&2048&&Cc(9,r);break;case 1:oi(n,r,o,c);break;case 3:oi(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&pc(n)));break;case 12:if(f&2048){oi(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,j=m.onPostCommit;typeof j=="function"&&j(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(B){bn(r,r.return,B)}}else oi(n,r,o,c);break;case 31:oi(n,r,o,c);break;case 13:oi(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?oi(n,r,o,c):Ac(n,r):m._visibility&2?oi(n,r,o,c):(m._visibility|=2,bl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&qm(x,r);break;case 24:oi(n,r,o,c),f&2048&&Hm(r.alternate,r);break;default:oi(n,r,o,c)}}function bl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,j=o,B=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:bl(m,x,j,B,f),Cc(8,x);break;case 23:break;case 22:var pe=x.stateNode;x.memoizedState!==null?pe._visibility&2?bl(m,x,j,B,f):Ac(m,x):(pe._visibility|=2,bl(m,x,j,B,f)),f&&ie&2048&&qm(x.alternate,x);break;case 24:bl(m,x,j,B,f),f&&ie&2048&&Hm(x.alternate,x);break;default:bl(m,x,j,B,f)}r=r.sibling}}function Ac(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Ac(o,c),f&2048&&qm(c.alternate,c);break;case 24:Ac(o,c),f&2048&&Hm(c.alternate,c);break;default:Ac(o,c)}r=r.sibling}}var Rc=8192;function wl(n,r,o){if(n.subtreeFlags&Rc)for(n=n.child;n!==null;)A1(n,r,o),n=n.sibling}function A1(n,r,o){switch(n.tag){case 26:wl(n,r,o),n.flags&Rc&&n.memoizedState!==null&&gj(o,ai,n.memoizedState,n.memoizedProps);break;case 5:wl(n,r,o);break;case 3:case 4:var c=ai;ai=Wd(n.stateNode.containerInfo),wl(n,r,o),ai=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Rc,Rc=16777216,wl(n,r,o),Rc=c):wl(n,r,o));break;default:wl(n,r,o)}}function R1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Ic(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Is=c,M1(c,n)}R1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)I1(n),n=n.sibling}function I1(n){switch(n.tag){case 0:case 11:case 15:Ic(n),n.flags&2048&&Ca(9,n,n.return);break;case 3:Ic(n);break;case 12:Ic(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Md(n)):Ic(n);break;default:Ic(n)}}function Md(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Is=c,M1(c,n)}R1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Ca(8,r,r.return),Md(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Md(r));break;default:Md(r)}n=n.sibling}}function M1(n,r){for(;Is!==null;){var o=Is;switch(o.tag){case 0:case 11:case 15:Ca(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:pc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Is=c;else e:for(o=n;Is!==null;){c=Is;var f=c.sibling,m=c.return;if(k1(c),c===o){Is=null;break e}if(f!==null){f.return=m,Is=f;break e}Is=m}}}var RT={getCacheForType:function(n){var r=Bs(hs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Bs(hs).controller.signal}},IT=typeof WeakMap=="function"?WeakMap:Map,hn=0,Sn=null,Ft=null,Ht=0,vn=0,jr=null,Na=!1,xl=!1,$m=!1,Zi=0,Kn=0,Aa=0,Co=0,Wm=0,Sr=0,_l=0,Mc=null,mr=null,Gm=!1,Dd=0,D1=0,Ld=1/0,Od=null,Ra=null,js=0,Ia=null,kl=null,ea=0,Km=0,Ym=null,L1=null,Dc=0,Qm=null;function Cr(){return(hn&2)!==0&&Ht!==0?Ht&-Ht:X.T!==null?np():mn()}function O1(){if(Sr===0)if((Ht&536870912)===0||Yt){var n=ft;ft<<=1,(ft&3932160)===0&&(ft=262144),Sr=n}else Sr=536870912;return n=Er.current,n!==null&&(n.flags|=32),Sr}function pr(n,r,o){(n===Sn&&(vn===2||vn===9)||n.cancelPendingCommit!==null)&&(El(n,0),Ma(n,Ht,Sr,!1)),Ie(n,o),((hn&2)===0||n!==Sn)&&(n===Sn&&((hn&2)===0&&(Co|=o),Kn===4&&Ma(n,Ht,Sr,!1)),ki(n))}function P1(n,r,o){if((hn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Zt(n,r),f=c?LT(n,r):Jm(n,r,!0),m=c;do{if(f===0){xl&&!c&&Ma(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!MT(o)){f=Jm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var j=n;f=Mc;var B=j.current.memoizedState.isDehydrated;if(B&&(El(j,x).flags|=256),x=Jm(j,x,!1),x!==2){if($m&&!B){j.errorRecoveryDisabledLanes|=m,Co|=m,f=4;break e}m=mr,mr=f,m!==null&&(mr===null?mr=m:mr.push.apply(mr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){El(n,0),Ma(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ma(c,r,Sr,!Na);break e;case 2:mr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Dd+300-ot(),10<f)){if(Ma(c,r,Sr,!Na),yt(c,0,!0)!==0)break e;ea=r,c.timeoutHandle=mb(V1.bind(null,c,o,mr,Od,Gm,r,Sr,Co,_l,Na,m,"Throttled",-0,0),f);break e}V1(c,o,mr,Od,Gm,r,Sr,Co,_l,Na,m,null,-0,0)}}break}while(!0);ki(n)}function V1(n,r,o,c,f,m,x,j,B,ie,pe,_e,oe,fe){if(n.timeoutHandle=-1,_e=r.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:nr},A1(r,m,_e);var Ke=(m&62914560)===m?Dd-ot():(m&4194048)===m?D1-ot():0;if(Ke=yj(_e,Ke),Ke!==null){ea=m,n.cancelPendingCommit=Ke(W1.bind(null,n,r,m,o,c,f,x,j,B,pe,_e,null,oe,fe)),Ma(n,m,x,!ie);return}}W1(n,r,m,o,c,f,x,j,B)}function MT(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!_r(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ma(n,r,o,c){r&=~Wm,r&=~Co,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Ct(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&lt(n,o,r)}function Pd(){return(hn&6)===0?(Lc(0),!1):!0}function Xm(){if(Ft!==null){if(vn===0)var n=Ft.return;else n=Ft,qi=bo=null,fm(n),ml=null,yc=0,n=Ft;for(;n!==null;)p1(n.alternate,n),n=n.return;Ft=null}}function El(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,ZT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),ea=0,Xm(),Sn=n,Ft=o=zi(n.current,null),Ht=r,vn=0,jr=null,Na=!1,xl=Zt(n,r),$m=!1,_l=Sr=Wm=Co=Aa=Kn=0,mr=Mc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Ct(c),m=1<<f;r|=n[f],c&=~m}return Zi=r,rd(),o}function U1(n,r){Rt=null,X.H=Tc,r===fl||r===hd?(r=tv(),vn=3):r===tm?(r=tv(),vn=4):vn=r===Nm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,jr=r,Ft===null&&(Kn=1,jd(n,Pr(r,n.current)))}function B1(){var n=Er.current;return n===null?!0:(Ht&4194048)===Ht?zr===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?n===zr:!1}function z1(){var n=X.H;return X.H=Tc,n===null?Tc:n}function F1(){var n=X.A;return X.A=RT,n}function Vd(){Kn=4,Na||(Ht&4194048)!==Ht&&Er.current!==null||(xl=!0),(Aa&134217727)===0&&(Co&134217727)===0||Sn===null||Ma(Sn,Ht,Sr,!1)}function Jm(n,r,o){var c=hn;hn|=2;var f=z1(),m=F1();(Sn!==n||Ht!==r)&&(Od=null,El(n,r)),r=!1;var x=Kn;e:do try{if(vn!==0&&Ft!==null){var j=Ft,B=jr;switch(vn){case 8:Xm(),x=6;break e;case 3:case 2:case 9:case 6:Er.current===null&&(r=!0);var ie=vn;if(vn=0,jr=null,Tl(n,j,B,ie),o&&xl){x=0;break e}break;default:ie=vn,vn=0,jr=null,Tl(n,j,B,ie)}}DT(),x=Kn;break}catch(pe){U1(n,pe)}while(!0);return r&&n.shellSuspendCounter++,qi=bo=null,hn=c,X.H=f,X.A=m,Ft===null&&(Sn=null,Ht=0,rd()),x}function DT(){for(;Ft!==null;)q1(Ft)}function LT(n,r){var o=hn;hn|=2;var c=z1(),f=F1();Sn!==n||Ht!==r?(Od=null,Ld=ot()+500,El(n,r)):xl=Zt(n,r);e:do try{if(vn!==0&&Ft!==null){r=Ft;var m=jr;t:switch(vn){case 1:vn=0,jr=null,Tl(n,r,m,1);break;case 2:case 9:if(Z0(m)){vn=0,jr=null,H1(r);break}r=function(){vn!==2&&vn!==9||Sn!==n||(vn=7),ki(n)},m.then(r,r);break e;case 3:vn=7;break e;case 4:vn=5;break e;case 7:Z0(m)?(vn=0,jr=null,H1(r)):(vn=0,jr=null,Tl(n,r,m,7));break;case 5:var x=null;switch(Ft.tag){case 26:x=Ft.memoizedState;case 5:case 27:var j=Ft;if(x?Nb(x):j.stateNode.complete){vn=0,jr=null;var B=j.sibling;if(B!==null)Ft=B;else{var ie=j.return;ie!==null?(Ft=ie,Ud(ie)):Ft=null}break t}}vn=0,jr=null,Tl(n,r,m,5);break;case 6:vn=0,jr=null,Tl(n,r,m,6);break;case 8:Xm(),Kn=6;break e;default:throw Error(i(462))}}OT();break}catch(pe){U1(n,pe)}while(!0);return qi=bo=null,X.H=c,X.A=f,hn=o,Ft!==null?0:(Sn=null,Ht=0,rd(),Kn)}function OT(){for(;Ft!==null&&!gt();)q1(Ft)}function q1(n){var r=f1(n.alternate,n,Zi);n.memoizedProps=n.pendingProps,r===null?Ud(n):Ft=r}function H1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=o1(o,r,r.pendingProps,r.type,void 0,Ht);break;case 11:r=o1(o,r,r.pendingProps,r.type.render,r.ref,Ht);break;case 5:fm(r);default:p1(o,r),r=Ft=F0(r,Zi),r=f1(o,r,Zi)}n.memoizedProps=n.pendingProps,r===null?Ud(n):Ft=r}function Tl(n,r,o,c){qi=bo=null,fm(r),ml=null,yc=0;var f=r.return;try{if(ET(n,f,r,o,Ht)){Kn=1,jd(n,Pr(o,n.current)),Ft=null;return}}catch(m){if(f!==null)throw Ft=f,m;Kn=1,jd(n,Pr(o,n.current)),Ft=null;return}r.flags&32768?(Yt||c===1?n=!0:xl||(Ht&536870912)!==0?n=!1:(Na=n=!0,(c===2||c===9||c===3||c===6)&&(c=Er.current,c!==null&&c.tag===13&&(c.flags|=16384))),$1(r,n)):Ud(r)}function Ud(n){var r=n;do{if((r.flags&32768)!==0){$1(r,Na);return}n=r.return;var o=ST(r.alternate,r,Zi);if(o!==null){Ft=o;return}if(r=r.sibling,r!==null){Ft=r;return}Ft=r=n}while(r!==null);Kn===0&&(Kn=5)}function $1(n,r){do{var o=CT(n.alternate,n);if(o!==null){o.flags&=32767,Ft=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Ft=n;return}Ft=n=o}while(n!==null);Kn=6,Ft=null}function W1(n,r,o,c,f,m,x,j,B){n.cancelPendingCommit=null;do Bd();while(js!==0);if((hn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Bf,Qe(n,o,m,x,j,B),n===Sn&&(Ft=Sn=null,Ht=0),kl=r,Ia=n,ea=o,Km=m,Ym=f,L1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,BT(Nn,function(){return X1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=X.T,X.T=null,f=Ce.p,Ce.p=2,x=hn,hn|=4;try{NT(n,r,o)}finally{hn=x,Ce.p=f,X.T=c}}js=1,G1(),K1(),Y1()}}function G1(){if(js===1){js=0;var n=Ia,r=kl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=X.T,X.T=null;var c=Ce.p;Ce.p=2;var f=hn;hn|=4;try{S1(r,n);var m=up,x=M0(n.containerInfo),j=m.focusedElem,B=m.selectionRange;if(x!==j&&j&&j.ownerDocument&&I0(j.ownerDocument.documentElement,j)){if(B!==null&&Lf(j)){var ie=B.start,pe=B.end;if(pe===void 0&&(pe=ie),"selectionStart"in j)j.selectionStart=ie,j.selectionEnd=Math.min(pe,j.value.length);else{var _e=j.ownerDocument||document,oe=_e&&_e.defaultView||window;if(oe.getSelection){var fe=oe.getSelection(),Ke=j.textContent.length,dt=Math.min(B.start,Ke),kn=B.end===void 0?dt:Math.min(B.end,Ke);!fe.extend&&dt>kn&&(x=kn,kn=dt,dt=x);var Y=R0(j,dt),H=R0(j,kn);if(Y&&H&&(fe.rangeCount!==1||fe.anchorNode!==Y.node||fe.anchorOffset!==Y.offset||fe.focusNode!==H.node||fe.focusOffset!==H.offset)){var ne=_e.createRange();ne.setStart(Y.node,Y.offset),fe.removeAllRanges(),dt>kn?(fe.addRange(ne),fe.extend(H.node,H.offset)):(ne.setEnd(H.node,H.offset),fe.addRange(ne))}}}}for(_e=[],fe=j;fe=fe.parentNode;)fe.nodeType===1&&_e.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<_e.length;j++){var we=_e[j];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}Jd=!!cp,up=cp=null}finally{hn=f,Ce.p=c,X.T=o}}n.current=r,js=2}}function K1(){if(js===2){js=0;var n=Ia,r=kl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=X.T,X.T=null;var c=Ce.p;Ce.p=2;var f=hn;hn|=4;try{_1(n,r.alternate,r)}finally{hn=f,Ce.p=c,X.T=o}}js=3}}function Y1(){if(js===4||js===3){js=0,Ye();var n=Ia,r=kl,o=ea,c=L1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?js=5:(js=0,kl=Ia=null,Q1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ra=null),zt(o),r=r.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(rn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=X.T,f=Ce.p,Ce.p=2,X.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var j=c[x];m(j.value,{componentStack:j.stack})}}finally{X.T=r,Ce.p=f}}(ea&3)!==0&&Bd(),ki(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Qm?Dc++:(Dc=0,Qm=n):Dc=0,Lc(0)}}function Q1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,pc(r)))}function Bd(){return G1(),K1(),Y1(),X1()}function X1(){if(js!==5)return!1;var n=Ia,r=Km;Km=0;var o=zt(ea),c=X.T,f=Ce.p;try{Ce.p=32>o?32:o,X.T=null,o=Ym,Ym=null;var m=Ia,x=ea;if(js=0,kl=Ia=null,ea=0,(hn&6)!==0)throw Error(i(331));var j=hn;if(hn|=4,I1(m.current),N1(m,m.current,x,o),hn=j,Lc(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(rn,m)}catch{}return!0}finally{Ce.p=f,X.T=c,Q1(n,r)}}function J1(n,r,o){r=Pr(o,r),r=Cm(n.stateNode,r,2),n=Ta(n,r,2),n!==null&&(Ie(n,2),ki(n))}function bn(n,r,o){if(n.tag===3)J1(n,n,o);else for(;r!==null;){if(r.tag===3){J1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ra===null||!Ra.has(c))){n=Pr(o,n),o=Zv(2),c=Ta(r,o,2),c!==null&&(e1(o,c,r,n),Ie(c,2),ki(c));break}}r=r.return}}function Zm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new IT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||($m=!0,f.add(o),n=PT.bind(null,n,r,o),r.then(n,n))}function PT(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Sn===n&&(Ht&o)===o&&(Kn===4||Kn===3&&(Ht&62914560)===Ht&&300>ot()-Dd?(hn&2)===0&&El(n,0):Wm|=o,_l===Ht&&(_l=0)),ki(n)}function Z1(n,r){r===0&&(r=Rn()),n=go(n,r),n!==null&&(Ie(n,r),ki(n))}function VT(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Z1(n,o)}function UT(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Z1(n,o)}function BT(n,r){return It(n,r)}var zd=null,jl=null,ep=!1,Fd=!1,tp=!1,Da=0;function ki(n){n!==jl&&n.next===null&&(jl===null?zd=jl=n:jl=jl.next=n),Fd=!0,ep||(ep=!0,FT())}function Lc(n,r){if(!tp&&Fd){tp=!0;do for(var o=!1,c=zd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,j=c.pingedLanes;m=(1<<31-Ct(42|n)+1)-1,m&=f&~(x&~j),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,sb(c,m))}else m=Ht,m=yt(c,c===Sn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Zt(c,m)||(o=!0,sb(c,m));c=c.next}while(o);tp=!1}}function zT(){eb()}function eb(){Fd=ep=!1;var n=0;Da!==0&&JT()&&(n=Da);for(var r=ot(),o=null,c=zd;c!==null;){var f=c.next,m=tb(c,r);m===0?(c.next=null,o===null?zd=f:o.next=f,f===null&&(jl=o)):(o=c,(n!==0||(m&3)!==0)&&(Fd=!0)),c=f}js!==0&&js!==5||Lc(n),Da!==0&&(Da=0)}function tb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-Ct(m),j=1<<x,B=f[x];B===-1?((j&o)===0||(j&c)!==0)&&(f[x]=fn(j,r)):B<=r&&(n.expiredLanes|=j),m&=~j}if(r=Sn,o=Ht,o=yt(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(vn===2||vn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Nt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Zt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Nt(c),zt(o)){case 2:case 8:o=Jn;break;case 32:o=Nn;break;case 268435456:o=Zn;break;default:o=Nn}return c=nb.bind(null,n),o=It(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Nt(c),n.callbackPriority=2,n.callbackNode=null,2}function nb(n,r){if(js!==0&&js!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Bd()&&n.callbackNode!==o)return null;var c=Ht;return c=yt(n,n===Sn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(P1(n,c,r),tb(n,ot()),n.callbackNode!=null&&n.callbackNode===o?nb.bind(null,n):null)}function sb(n,r){if(Bd())return null;P1(n,r,!0)}function FT(){ej(function(){(hn&6)!==0?It(Jt,zT):eb()})}function np(){if(Da===0){var n=dl;n===0&&(n=xt,xt<<=1,(xt&261888)===0&&(xt=256)),Da=n}return Da}function rb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ni(""+n)}function ib(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function qT(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=rb((f[cn]||null).action),x=c.submitter;x&&(r=(r=x[cn]||null)?rb(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var j=new ss("action","action",null,c,f);n.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Da!==0){var B=x?ib(f,x):new FormData(f);_m(o,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(j.preventDefault(),B=x?ib(f,x):new FormData(f),_m(o,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var sp=0;sp<Uf.length;sp++){var rp=Uf[sp],HT=rp.toLowerCase(),$T=rp[0].toUpperCase()+rp.slice(1);ii(HT,"on"+$T)}ii(O0,"onAnimationEnd"),ii(P0,"onAnimationIteration"),ii(V0,"onAnimationStart"),ii("dblclick","onDoubleClick"),ii("focusin","onFocus"),ii("focusout","onBlur"),ii(oT,"onTransitionRun"),ii(lT,"onTransitionStart"),ii(cT,"onTransitionCancel"),ii(U0,"onTransitionEnd"),ks("onMouseEnter",["mouseout","mouseover"]),ks("onMouseLeave",["mouseout","mouseover"]),ks("onPointerEnter",["pointerout","pointerover"]),ks("onPointerLeave",["pointerout","pointerover"]),_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_s("onBeforeInput",["compositionend","keypress","textInput","paste"]),_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function ab(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var j=c[x],B=j.instance,ie=j.currentTarget;if(j=j.listener,B!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ie;try{m(f)}catch(pe){sd(pe)}f.currentTarget=null,m=B}else for(x=0;x<c.length;x++){if(j=c[x],B=j.instance,ie=j.currentTarget,j=j.listener,B!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ie;try{m(f)}catch(pe){sd(pe)}f.currentTarget=null,m=B}}}}function qt(n,r){var o=r[Ls];o===void 0&&(o=r[Ls]=new Set);var c=n+"__bubble";o.has(c)||(ob(r,n,2,!1),o.add(c))}function ip(n,r,o){var c=0;r&&(c|=4),ob(o,n,c,r)}var qd="_reactListening"+Math.random().toString(36).slice(2);function ap(n){if(!n[qd]){n[qd]=!0,ts.forEach(function(o){o!=="selectionchange"&&(WT.has(o)||ip(o,!1,n),ip(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[qd]||(r[qd]=!0,ip("selectionchange",!1,r))}}function ob(n,r,o,c){switch(Ob(r)){case 2:var f=wj;break;case 8:f=xj;break;default:f=xp}o=f.bind(null,r,o,n),f=void 0,!Le||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function op(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var j=c.stateNode.containerInfo;if(j===f)break;if(x===4)for(x=c.return;x!==null;){var B=x.tag;if((B===3||B===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;j!==null;){if(x=us(j),x===null)return;if(B=x.tag,B===5||B===6||B===26||B===27){c=m=x;continue e}j=j.parentNode}}c=c.return}K(function(){var ie=m,pe=z(o),_e=[];e:{var oe=B0.get(n);if(oe!==void 0){var fe=ss,Ke=n;switch(n){case"keypress":if(Ot(o)===0)break e;case"keydown":case"keyup":fe=ed;break;case"focusin":Ke="focus",fe=ho;break;case"focusout":Ke="blur",fe=ho;break;case"beforeblur":case"afterblur":fe=ho;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Ui;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=$u;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=v;break;case O0:case P0:case V0:fe=Gu;break;case U0:fe=N;break;case"scroll":case"scrollend":fe=On;break;case"wheel":fe=he;break;case"copy":case"cut":case"paste":fe=Ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Bi;break;case"toggle":case"beforetoggle":fe=At}var dt=(r&4)!==0,kn=!dt&&(n==="scroll"||n==="scrollend"),Y=dt?oe!==null?oe+"Capture":null:oe;dt=[];for(var H=ie,ne;H!==null;){var we=H;if(ne=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||ne===null||Y===null||(we=ue(H,Y),we!=null&&dt.push(Pc(H,we,ne))),kn)break;H=H.return}0<dt.length&&(oe=new fe(oe,Ke,null,o,pe),_e.push({event:oe,listeners:dt}))}}if((r&7)===0){e:{if(oe=n==="mouseover"||n==="pointerover",fe=n==="mouseout"||n==="pointerout",oe&&o!==sr&&(Ke=o.relatedTarget||o.fromElement)&&(us(Ke)||Ke[ws]))break e;if((fe||oe)&&(oe=pe.window===pe?pe:(oe=pe.ownerDocument)?oe.defaultView||oe.parentWindow:window,fe?(Ke=o.relatedTarget||o.toElement,fe=ie,Ke=Ke?us(Ke):null,Ke!==null&&(kn=u(Ke),dt=Ke.tag,Ke!==kn||dt!==5&&dt!==27&&dt!==6)&&(Ke=null)):(fe=null,Ke=ie),fe!==Ke)){if(dt=Ui,we="onMouseLeave",Y="onMouseEnter",H="mouse",(n==="pointerout"||n==="pointerover")&&(dt=Bi,we="onPointerLeave",Y="onPointerEnter",H="pointer"),kn=fe==null?oe:Dn(fe),ne=Ke==null?oe:Dn(Ke),oe=new dt(we,H+"leave",fe,o,pe),oe.target=kn,oe.relatedTarget=ne,we=null,us(pe)===ie&&(dt=new dt(Y,H+"enter",Ke,o,pe),dt.target=ne,dt.relatedTarget=kn,we=dt),kn=we,fe&&Ke)t:{for(dt=GT,Y=fe,H=Ke,ne=0,we=Y;we;we=dt(we))ne++;we=0;for(var rt=H;rt;rt=dt(rt))we++;for(;0<ne-we;)Y=dt(Y),ne--;for(;0<we-ne;)H=dt(H),we--;for(;ne--;){if(Y===H||H!==null&&Y===H.alternate){dt=Y;break t}Y=dt(Y),H=dt(H)}dt=null}else dt=null;fe!==null&&lb(_e,oe,fe,dt,!1),Ke!==null&&kn!==null&&lb(_e,kn,Ke,dt,!0)}}e:{if(oe=ie?Dn(ie):window,fe=oe.nodeName&&oe.nodeName.toLowerCase(),fe==="select"||fe==="input"&&oe.type==="file")var on=T0;else if(k0(oe))if(j0)on=rT;else{on=nT;var Ze=tT}else fe=oe.nodeName,!fe||fe.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ie&&ti(ie.elementType)&&(on=T0):on=sT;if(on&&(on=on(n,ie))){E0(_e,on,o,pe);break e}Ze&&Ze(n,oe,ie),n==="focusout"&&ie&&oe.type==="number"&&ie.memoizedProps.value!=null&&Dr(oe,"number",oe.value)}switch(Ze=ie?Dn(ie):window,n){case"focusin":(k0(Ze)||Ze.contentEditable==="true")&&(sl=Ze,Of=ie,hc=null);break;case"focusout":hc=Of=sl=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,D0(_e,o,pe);break;case"selectionchange":if(aT)break;case"keydown":case"keyup":D0(_e,o,pe)}var Mt;if(dn)e:{switch(n){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else nl?fo(n,o)&&($t="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&($t="onCompositionStart");$t&&(bi&&o.locale!=="ko"&&(nl||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&nl&&(Mt=Xe()):(Oe=pe,Je="value"in Oe?Oe.value:Oe.textContent,nl=!0)),Ze=Hd(ie,$t),0<Ze.length&&($t=new vi($t,n,null,o,pe),_e.push({event:$t,listeners:Ze}),Mt?$t.data=Mt:(Mt=tl(o),Mt!==null&&($t.data=Mt)))),(Mt=Lr?XE(n,o):JE(n,o))&&($t=Hd(ie,"onBeforeInput"),0<$t.length&&(Ze=new vi("onBeforeInput","beforeinput",null,o,pe),_e.push({event:Ze,listeners:$t}),Ze.data=Mt)),qT(_e,n,ie,o,pe)}ab(_e,r)})}function Pc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Hd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=ue(n,o),f!=null&&c.unshift(Pc(n,f,m)),f=ue(n,r),f!=null&&c.push(Pc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function GT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function lb(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var j=o,B=j.alternate,ie=j.stateNode;if(j=j.tag,B!==null&&B===c)break;j!==5&&j!==26&&j!==27||ie===null||(B=ie,f?(ie=ue(o,m),ie!=null&&x.unshift(Pc(o,ie,B))):f||(ie=ue(o,m),ie!=null&&x.push(Pc(o,ie,B)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var KT=/\r\n?/g,YT=/\u0000|\uFFFD/g;function cb(n){return(typeof n=="string"?n:""+n).replace(KT,`
`).replace(YT,"")}function ub(n,r){return r=cb(r),cb(n)===r}function _n(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Rs(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Rs(n,""+c);break;case"className":te(n,"class",c);break;case"tabIndex":te(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":te(n,o,c);break;case"style":ei(n,c,m);break;case"data":if(r!=="object"){te(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=ni(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&_n(n,r,"name",f.name,f,null),_n(n,r,"formEncType",f.formEncType,f,null),_n(n,r,"formMethod",f.formMethod,f,null),_n(n,r,"formTarget",f.formTarget,f,null)):(_n(n,r,"encType",f.encType,f,null),_n(n,r,"method",f.method,f,null),_n(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=ni(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=nr);break;case"onScroll":c!=null&&qt("scroll",n);break;case"onScrollEnd":c!=null&&qt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=ni(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":qt("beforetoggle",n),qt("toggle",n),F(n,"popover",c);break;case"xlinkActuate":re(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":re(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":re(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":re(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":re(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":re(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":re(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":re(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":re(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":F(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ps.get(o)||o,F(n,o,c))}}function lp(n,r,o,c,f,m){switch(o){case"style":ei(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Rs(n,c):(typeof c=="number"||typeof c=="bigint")&&Rs(n,""+c);break;case"onScroll":c!=null&&qt("scroll",n);break;case"onScrollEnd":c!=null&&qt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=nr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[cn]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):F(n,o,c)}}}function Fs(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qt("error",n),qt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:_n(n,r,m,x,o,null)}}f&&_n(n,r,"srcSet",o.srcSet,o,null),c&&_n(n,r,"src",o.src,o,null);return;case"input":qt("invalid",n);var j=m=x=f=null,B=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var pe=o[c];if(pe!=null)switch(c){case"name":f=pe;break;case"type":x=pe;break;case"checked":B=pe;break;case"defaultChecked":ie=pe;break;case"value":m=pe;break;case"defaultValue":j=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,r));break;default:_n(n,r,c,pe,o,null)}}Zr(n,m,j,B,ie,x,f,!1);return;case"select":qt("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(j=o[f],j!=null))switch(f){case"value":m=j;break;case"defaultValue":x=j;break;case"multiple":c=j;default:_n(n,r,f,j,o,null)}r=m,o=x,n.multiple=!!c,r!=null?wr(n,!!c,r,!1):o!=null&&wr(n,!!c,o,!0);return;case"textarea":qt("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(j=o[x],j!=null))switch(x){case"value":c=j;break;case"defaultValue":f=j;break;case"children":m=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(91));break;default:_n(n,r,x,j,o,null)}tr(n,c,f,m);return;case"option":for(B in o)o.hasOwnProperty(B)&&(c=o[B],c!=null)&&(B==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":_n(n,r,B,c,o,null));return;case"dialog":qt("beforetoggle",n),qt("toggle",n),qt("cancel",n),qt("close",n);break;case"iframe":case"object":qt("load",n);break;case"video":case"audio":for(c=0;c<Oc.length;c++)qt(Oc[c],n);break;case"image":qt("error",n),qt("load",n);break;case"details":qt("toggle",n);break;case"embed":case"source":case"link":qt("error",n),qt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:_n(n,r,ie,c,o,null)}return;default:if(ti(r)){for(pe in o)o.hasOwnProperty(pe)&&(c=o[pe],c!==void 0&&lp(n,r,pe,c,o,void 0));return}}for(j in o)o.hasOwnProperty(j)&&(c=o[j],c!=null&&_n(n,r,j,c,o,null))}function QT(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,j=null,B=null,ie=null,pe=null;for(fe in o){var _e=o[fe];if(o.hasOwnProperty(fe)&&_e!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":B=_e;default:c.hasOwnProperty(fe)||_n(n,r,fe,null,c,_e)}}for(var oe in c){var fe=c[oe];if(_e=o[oe],c.hasOwnProperty(oe)&&(fe!=null||_e!=null))switch(oe){case"type":m=fe;break;case"name":f=fe;break;case"checked":ie=fe;break;case"defaultChecked":pe=fe;break;case"value":x=fe;break;case"defaultValue":j=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,r));break;default:fe!==_e&&_n(n,r,oe,fe,c,_e)}}er(n,x,j,B,ie,pe,m,f);return;case"select":fe=x=j=oe=null;for(m in o)if(B=o[m],o.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":fe=B;default:c.hasOwnProperty(m)||_n(n,r,m,null,c,B)}for(f in c)if(m=c[f],B=o[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":oe=m;break;case"defaultValue":j=m;break;case"multiple":x=m;default:m!==B&&_n(n,r,f,m,c,B)}r=j,o=x,c=fe,oe!=null?wr(n,!!o,oe,!1):!!c!=!!o&&(r!=null?wr(n,!!o,r,!0):wr(n,!!o,o?[]:"",!1));return;case"textarea":fe=oe=null;for(j in o)if(f=o[j],o.hasOwnProperty(j)&&f!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:_n(n,r,j,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":oe=f;break;case"defaultValue":fe=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&_n(n,r,x,f,c,m)}Ws(n,oe,fe);return;case"option":for(var Ke in o)oe=o[Ke],o.hasOwnProperty(Ke)&&oe!=null&&!c.hasOwnProperty(Ke)&&(Ke==="selected"?n.selected=!1:_n(n,r,Ke,null,c,oe));for(B in c)oe=c[B],fe=o[B],c.hasOwnProperty(B)&&oe!==fe&&(oe!=null||fe!=null)&&(B==="selected"?n.selected=oe&&typeof oe!="function"&&typeof oe!="symbol":_n(n,r,B,oe,c,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in o)oe=o[dt],o.hasOwnProperty(dt)&&oe!=null&&!c.hasOwnProperty(dt)&&_n(n,r,dt,null,c,oe);for(ie in c)if(oe=c[ie],fe=o[ie],c.hasOwnProperty(ie)&&oe!==fe&&(oe!=null||fe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,r));break;default:_n(n,r,ie,oe,c,fe)}return;default:if(ti(r)){for(var kn in o)oe=o[kn],o.hasOwnProperty(kn)&&oe!==void 0&&!c.hasOwnProperty(kn)&&lp(n,r,kn,void 0,c,oe);for(pe in c)oe=c[pe],fe=o[pe],!c.hasOwnProperty(pe)||oe===fe||oe===void 0&&fe===void 0||lp(n,r,pe,oe,c,fe);return}}for(var Y in o)oe=o[Y],o.hasOwnProperty(Y)&&oe!=null&&!c.hasOwnProperty(Y)&&_n(n,r,Y,null,c,oe);for(_e in c)oe=c[_e],fe=o[_e],!c.hasOwnProperty(_e)||oe===fe||oe==null&&fe==null||_n(n,r,_e,oe,c,fe)}function db(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,j=f.duration;if(m&&j&&db(x)){for(x=0,j=f.responseEnd,c+=1;c<o.length;c++){var B=o[c],ie=B.startTime;if(ie>j)break;var pe=B.transferSize,_e=B.initiatorType;pe&&db(_e)&&(B=B.responseEnd,x+=pe*(B<j?1:(j-ie)/(B-ie)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cp=null,up=null;function $d(n){return n.nodeType===9?n:n.ownerDocument}function hb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function dp(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hp=null;function JT(){var n=window.event;return n&&n.type==="popstate"?n===hp?!1:(hp=n,!0):(hp=null,!1)}var mb=typeof setTimeout=="function"?setTimeout:void 0,ZT=typeof clearTimeout=="function"?clearTimeout:void 0,pb=typeof Promise=="function"?Promise:void 0,ej=typeof queueMicrotask=="function"?queueMicrotask:typeof pb<"u"?function(n){return pb.resolve(null).then(n).catch(tj)}:mb;function tj(n){setTimeout(function(){throw n})}function La(n){return n==="head"}function gb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Al(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Vc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Vc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,j=m.nodeName;m[Ns]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Vc(n.ownerDocument.body);o=f}while(o);Al(r)}function yb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function fp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fp(o),xs(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function nj(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Ns])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Fr(n.nextSibling),n===null)break}return null}function sj(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Fr(n.nextSibling),n===null))return null;return n}function vb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Fr(n.nextSibling),n===null))return null;return n}function mp(n){return n.data==="$?"||n.data==="$~"}function pp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function rj(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Fr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var gp=null;function bb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Fr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function wb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function xb(n,r,o){switch(r=$d(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Vc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);xs(n)}var qr=new Map,_b=new Set;function Wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ta=Ce.d;Ce.d={f:ij,r:aj,D:oj,C:lj,L:cj,m:uj,X:hj,S:dj,M:fj};function ij(){var n=ta.f(),r=Pd();return n||r}function aj(n){var r=Wn(n);r!==null&&r.tag===5&&r.type==="form"?Uv(r):ta.r(n)}var Sl=typeof document>"u"?null:document;function kb(n,r,o){var c=Sl;if(c&&typeof r=="string"&&r){var f=ns(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),_b.has(f)||(_b.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Fs(r,"link",n),un(r),c.head.appendChild(r)))}}function oj(n){ta.D(n),kb("dns-prefetch",n,null)}function lj(n,r){ta.C(n,r),kb("preconnect",n,r)}function cj(n,r,o){ta.L(n,r,o);var c=Sl;if(c&&n&&r){var f='link[rel="preload"][as="'+ns(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+ns(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+ns(o.imageSizes)+'"]')):f+='[href="'+ns(n)+'"]';var m=f;switch(r){case"style":m=Cl(n);break;case"script":m=Nl(n)}qr.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),qr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Uc(m))||r==="script"&&c.querySelector(Bc(m))||(r=c.createElement("link"),Fs(r,"link",n),un(r),c.head.appendChild(r)))}}function uj(n,r){ta.m(n,r);var o=Sl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+ns(c)+'"][href="'+ns(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Nl(n)}if(!qr.has(m)&&(n=k({rel:"modulepreload",href:n},r),qr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Bc(m)))return}c=o.createElement("link"),Fs(c,"link",n),un(c),o.head.appendChild(c)}}}function dj(n,r,o){ta.S(n,r,o);var c=Sl;if(c&&n){var f=es(c).hoistableStyles,m=Cl(n);r=r||"default";var x=f.get(m);if(!x){var j={loading:0,preload:null};if(x=c.querySelector(Uc(m)))j.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=qr.get(m))&&yp(n,o);var B=x=c.createElement("link");un(B),Fs(B,"link",n),B._p=new Promise(function(ie,pe){B.onload=ie,B.onerror=pe}),B.addEventListener("load",function(){j.loading|=1}),B.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Gd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:j},f.set(m,x)}}}function hj(n,r){ta.X(n,r);var o=Sl;if(o&&n){var c=es(o).hoistableScripts,f=Nl(n),m=c.get(f);m||(m=o.querySelector(Bc(f)),m||(n=k({src:n,async:!0},r),(r=qr.get(f))&&vp(n,r),m=o.createElement("script"),un(m),Fs(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function fj(n,r){ta.M(n,r);var o=Sl;if(o&&n){var c=es(o).hoistableScripts,f=Nl(n),m=c.get(f);m||(m=o.querySelector(Bc(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=qr.get(f))&&vp(n,r),m=o.createElement("script"),un(m),Fs(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Eb(n,r,o,c){var f=(f=Ne.current)?Wd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Cl(o.href),o=es(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Cl(o.href);var m=es(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(Uc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),qr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},qr.set(n,o),m||mj(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Nl(o),o=es(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Cl(n){return'href="'+ns(n)+'"'}function Uc(n){return'link[rel="stylesheet"]['+n+"]"}function Tb(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function mj(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Fs(r,"link",o),un(r),n.head.appendChild(r))}function Nl(n){return'[src="'+ns(n)+'"]'}function Bc(n){return"script[async]"+n}function jb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+ns(o.href)+'"]');if(c)return r.instance=c,un(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),un(c),Fs(c,"style",f),Gd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Cl(o.href);var m=n.querySelector(Uc(f));if(m)return r.state.loading|=4,r.instance=m,un(m),m;c=Tb(o),(f=qr.get(f))&&yp(c,f),m=(n.ownerDocument||n).createElement("link"),un(m);var x=m;return x._p=new Promise(function(j,B){x.onload=j,x.onerror=B}),Fs(m,"link",c),r.state.loading|=4,Gd(m,o.precedence,n),r.instance=m;case"script":return m=Nl(o.src),(f=n.querySelector(Bc(m)))?(r.instance=f,un(f),f):(c=o,(f=qr.get(m))&&(c=k({},o),vp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),un(f),Fs(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Gd(c,o.precedence,n));return r.instance}function Gd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var j=c[x];if(j.dataset.precedence===r)m=j;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Kd=null;function Sb(n,r,o){if(Kd===null){var c=new Map,f=Kd=new Map;f.set(o,c)}else f=Kd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[Ns]||m[yn]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var j=c.get(x);j?j.push(m):c.set(x,[m])}}return c}function Cb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function pj(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Nb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function gj(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Cl(c.href),m=r.querySelector(Uc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Yd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,un(m);return}m=r.ownerDocument||r,c=Tb(c),(f=qr.get(f))&&yp(c,f),m=m.createElement("link"),un(m);var x=m;x._p=new Promise(function(j,B){x.onload=j,x.onerror=B}),Fs(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Yd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var bp=0;function yj(n,r){return n.stylesheets&&n.count===0&&Xd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&bp===0&&(bp=62500*XT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>bp?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Yd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Qd=null;function Xd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Qd=new Map,r.forEach(vj,n),Qd=null,Yd.call(n))}function vj(n,r){if(!(r.state.loading&4)){var o=Qd.get(n);if(o)var c=o.get(null);else{o=new Map,Qd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Yd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var zc={$$typeof:Q,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function bj(n,r,o,c,f,m,x,j,B){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ae(0),this.hiddenUpdates=ae(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Ab(n,r,o,c,f,m,x,j,B,ie,pe,_e){return n=new bj(n,r,o,x,B,ie,pe,_e,j),r=1,m===!0&&(r|=24),m=kr(3,null,null,r),n.current=m,m.stateNode=n,r=Jf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},nm(m),n}function Rb(n){return n?(n=al,n):al}function Ib(n,r,o,c,f,m){f=Rb(f),c.context===null?c.context=f:c.pendingContext=f,c=Ea(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ta(n,c,r),o!==null&&(pr(o,n,r),bc(o,n,r))}function Mb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function wp(n,r){Mb(n,r),(n=n.alternate)&&Mb(n,r)}function Db(n){if(n.tag===13||n.tag===31){var r=go(n,67108864);r!==null&&pr(r,n,67108864),wp(n,67108864)}}function Lb(n){if(n.tag===13||n.tag===31){var r=Cr();r=en(r);var o=go(n,r);o!==null&&pr(o,n,r),wp(n,r)}}var Jd=!0;function wj(n,r,o,c){var f=X.T;X.T=null;var m=Ce.p;try{Ce.p=2,xp(n,r,o,c)}finally{Ce.p=m,X.T=f}}function xj(n,r,o,c){var f=X.T;X.T=null;var m=Ce.p;try{Ce.p=8,xp(n,r,o,c)}finally{Ce.p=m,X.T=f}}function xp(n,r,o,c){if(Jd){var f=_p(c);if(f===null)op(n,r,c,Zd,o),Pb(n,c);else if(kj(f,n,r,o,c))c.stopPropagation();else if(Pb(n,c),r&4&&-1<_j.indexOf(n)){for(;f!==null;){var m=Wn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=nt(m.pendingLanes);if(x!==0){var j=m;for(j.pendingLanes|=2,j.entangledLanes|=2;x;){var B=1<<31-Ct(x);j.entanglements[1]|=B,x&=~B}ki(m),(hn&6)===0&&(Ld=ot()+500,Lc(0))}}break;case 31:case 13:j=go(m,2),j!==null&&pr(j,m,2),Pd(),wp(m,2)}if(m=_p(c),m===null&&op(n,r,c,Zd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else op(n,r,c,null,o)}}function _p(n){return n=z(n),kp(n)}var Zd=null;function kp(n){if(Zd=null,n=us(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Zd=n,null}function Ob(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nn()){case Jt:return 2;case Jn:return 8;case Nn:case cs:return 32;case Zn:return 268435456;default:return 32}default:return 32}}var Ep=!1,Oa=null,Pa=null,Va=null,Fc=new Map,qc=new Map,Ua=[],_j="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(n,r){switch(n){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":Va=null;break;case"pointerover":case"pointerout":Fc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(r.pointerId)}}function Hc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=Wn(r),r!==null&&Db(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function kj(n,r,o,c,f){switch(r){case"focusin":return Oa=Hc(Oa,n,r,o,c,f),!0;case"dragenter":return Pa=Hc(Pa,n,r,o,c,f),!0;case"mouseover":return Va=Hc(Va,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Fc.set(m,Hc(Fc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,qc.set(m,Hc(qc.get(m)||null,n,r,o,c,f)),!0}return!1}function Vb(n){var r=us(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,In(n.priority,function(){Lb(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,In(n.priority,function(){Lb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function eh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=_p(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);sr=c,o.target.dispatchEvent(c),sr=null}else return r=Wn(o),r!==null&&Db(r),n.blockedOn=o,!1;r.shift()}return!0}function Ub(n,r,o){eh(n)&&o.delete(r)}function Ej(){Ep=!1,Oa!==null&&eh(Oa)&&(Oa=null),Pa!==null&&eh(Pa)&&(Pa=null),Va!==null&&eh(Va)&&(Va=null),Fc.forEach(Ub),qc.forEach(Ub)}function th(n,r){n.blockedOn===r&&(n.blockedOn=null,Ep||(Ep=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ej)))}var nh=null;function Bb(n){nh!==n&&(nh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){nh===n&&(nh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kp(c||o)===null)continue;break}var m=Wn(o);m!==null&&(n.splice(r,3),r-=3,_m(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Al(n){function r(B){return th(B,n)}Oa!==null&&th(Oa,n),Pa!==null&&th(Pa,n),Va!==null&&th(Va,n),Fc.forEach(r),qc.forEach(r);for(var o=0;o<Ua.length;o++){var c=Ua[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ua.length&&(o=Ua[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&Ua.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[cn]||null;if(typeof m=="function")x||Bb(o);else if(x){var j=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[cn]||null)j=x.formAction;else if(kp(f)!==null)continue}else j=x.action;typeof j=="function"?o[c+1]=j:(o.splice(c,3),c-=3),Bb(o)}}}function zb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Tp(n){this._internalRoot=n}sh.prototype.render=Tp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Cr();Ib(o,c,n,r,null,null)},sh.prototype.unmount=Tp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Ib(n.current,2,null,n,null,null),Pd(),r[ws]=null}};function sh(n){this._internalRoot=n}sh.prototype.unstable_scheduleHydration=function(n){if(n){var r=mn();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Ua.length&&r!==0&&r<Ua[o].priority;o++);Ua.splice(o,0,n),o===0&&Vb(n)}};var Fb=e.version;if(Fb!=="19.2.4")throw Error(i(527,Fb,"19.2.4"));Ce.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=g(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var Tj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{rn=rh.inject(Tj),Bt=rh}catch{}}return Wc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Yv,m=Qv,x=Xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Ab(n,1,!1,null,null,o,c,null,f,m,x,zb),n[ws]=r.current,ap(n),new Tp(r)},Wc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Yv,x=Qv,j=Xv,B=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.formState!==void 0&&(B=o.formState)),r=Ab(n,1,!0,r,o??null,c,f,B,m,x,j,zb),r.context=Rb(null),o=r.current,c=Cr(),c=en(c),f=Ea(c),f.callback=null,Ta(o,f,c),o=c,r.current.lanes=o,Ie(r,o),ki(r),n[ws]=r.current,ap(n),new sh(r)},Wc.version="19.2.4",Wc}var Jb;function Lj(){if(Jb)return Cp.exports;Jb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cp.exports=Dj(),Cp.exports}var Oj=Lj();const Pj="modulepreload",Vj=function(s){return"/login/"+s},Zb={},Js=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=y(t.map(g=>{if(g=Vj(g),g in Zb)return;Zb[g]=!0;const b=g.endsWith(".css"),k=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${k}`))return;const S=document.createElement("link");if(S.rel=b?"stylesheet":Pj,b||(S.as="script"),S.crossOrigin="",S.href=g,p&&S.setAttribute("nonce",p),document.head.appendChild(S),b)return new Promise((R,q)=>{S.addEventListener("load",R),S.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${g}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var e2="popstate";function Uj(s={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return gg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:fu(l)}return zj(e,t,null,s)}function qn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Gr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bj(){return Math.random().toString(36).substring(2,10)}function t2(s,e){return{usr:s.state,key:s.key,idx:e}}function gg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Jl(e):e,state:t,key:e&&e.key||i||Bj()}}function fu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Jl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function zj(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",y=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function k(){p="POP";let U=b(),W=U==null?null:U-g;g=U,y&&y({action:p,location:$.location,delta:W})}function S(U,W){p="PUSH";let G=gg($.location,U,W);g=b()+1;let Q=t2(G,g),me=$.createHref(G);try{d.pushState(Q,"",me)}catch(ke){if(ke instanceof DOMException&&ke.name==="DataCloneError")throw ke;l.location.assign(me)}u&&y&&y({action:p,location:$.location,delta:1})}function R(U,W){p="REPLACE";let G=gg($.location,U,W);g=b();let Q=t2(G,g),me=$.createHref(G);d.replaceState(Q,"",me),u&&y&&y({action:p,location:$.location,delta:0})}function q(U){return Fj(U)}let $={get action(){return p},get location(){return s(l,d)},listen(U){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(e2,k),y=U,()=>{l.removeEventListener(e2,k),y=null}},createHref(U){return e(l,U)},createURL:q,encodeLocation(U){let W=q(U);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:S,replace:R,go(U){return d.go(U)}};return $}function Fj(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),qn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:fu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function px(s,e,t="/"){return qj(s,e,t,!1)}function qj(s,e,t,i){let l=typeof e=="string"?Jl(e):e,u=ca(l.pathname||"/",t);if(u==null)return null;let d=gx(s);Hj(d);let p=null;for(let y=0;p==null&&y<d.length;++y){let g=tS(u);p=Zj(d[y],g,i)}return p}function gx(s,e=[],t=[],i="",l=!1){let u=(d,p,y=l,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;qn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let k=ia([i,b.relativePath]),S=t.concat(b);d.children&&d.children.length>0&&(qn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),gx(d.children,e,S,k,y)),!(d.path==null&&!d.index)&&e.push({path:k,score:Xj(k,d.index),routesMeta:S})};return s.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let y of yx(d.path))u(d,p,!0,y)}),e}function yx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=yx(i.join("/")),p=[];return p.push(...d.map(y=>y===""?u:[u,y].join("/"))),l&&p.push(...d),p.map(y=>s.startsWith("/")&&y===""?"/":y)}function Hj(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Jj(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $j=/^:[\w-]+$/,Wj=3,Gj=2,Kj=1,Yj=10,Qj=-2,n2=s=>s==="*";function Xj(s,e){let t=s.split("/"),i=t.length;return t.some(n2)&&(i+=Qj),e&&(i+=Gj),t.filter(l=>!n2(l)).reduce((l,u)=>l+($j.test(u)?Wj:u===""?Kj:Yj),i)}function Jj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Zj(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let p=0;p<i.length;++p){let y=i[p],g=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",k=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:g},b),S=y.route;if(!k&&g&&t&&!i[i.length-1].route.index&&(k=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:ia([u,k.pathname]),pathnameBase:iS(ia([u,k.pathnameBase])),route:S}),k.pathnameBase!=="/"&&(u=ia([u,k.pathnameBase]))}return d}function Mh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=eS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((g,{paramName:b,isOptional:k},S)=>{if(b==="*"){let q=p[S]||"";d=u.slice(0,u.length-q.length).replace(/(.)\/+$/,"$1")}const R=p[S];return k&&!R?g[b]=void 0:g[b]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:d,pattern:s}}function eS(s,e=!1,t=!0){Gr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,y)=>(i.push({paramName:p,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function tS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ca(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function sS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Jl(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=s2(t.substring(1),"/"):u=s2(t,e)):u=e,{pathname:u,search:aS(i),hash:oS(l)}}function s2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ip(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jg(s){let e=rS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Zg(s,e,t,i=!1){let l;typeof s=="string"?l=Jl(s):(l={...s},qn(!l.pathname||!l.pathname.includes("?"),Ip("?","pathname","search",l)),qn(!l.pathname||!l.pathname.includes("#"),Ip("#","pathname","hash",l)),qn(!l.search||!l.search.includes("#"),Ip("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),k-=1;l.pathname=S.join("/")}p=k>=0?e[k]:"/"}let y=sS(l,p),g=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(g||b)&&(y.pathname+="/"),y}var ia=s=>s.join("/").replace(/\/\/+/g,"/"),iS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),aS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,oS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,lS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function uS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bx(s,e){let t=s;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(vx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ca(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{Gr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wx=["POST","PUT","PATCH","DELETE"];new Set(wx);var dS=["GET",...wx];new Set(dS);var Zl=w.createContext(null);Zl.displayName="DataRouter";var nf=w.createContext(null);nf.displayName="DataRouterState";var hS=w.createContext(!1),xx=w.createContext({isTransitioning:!1});xx.displayName="ViewTransition";var fS=w.createContext(new Map);fS.displayName="Fetchers";var mS=w.createContext(null);mS.displayName="Await";var Ir=w.createContext(null);Ir.displayName="Navigation";var Cu=w.createContext(null);Cu.displayName="Location";var mi=w.createContext({outlet:null,matches:[],isDataRoute:!1});mi.displayName="Route";var ey=w.createContext(null);ey.displayName="RouteError";var _x="REACT_ROUTER_ERROR",pS="REDIRECT",gS="ROUTE_ERROR_RESPONSE";function yS(s){if(s.startsWith(`${_x}:${pS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(s){if(s.startsWith(`${_x}:${gS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lS(e.status,e.statusText,e.data)}catch{}}function bS(s,{relative:e}={}){qn(ec(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Ir),{hash:l,pathname:u,search:d}=Nu(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ia([t,u])),i.createHref({pathname:p,search:d,hash:l})}function ec(){return w.useContext(Cu)!=null}function Di(){return qn(ec(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Cu).location}var kx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ex(s){w.useContext(Ir).static||w.useLayoutEffect(s)}function Zs(){let{isDataRoute:s}=w.useContext(mi);return s?MS():wS()}function wS(){qn(ec(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(Zl),{basename:e,navigator:t}=w.useContext(Ir),{matches:i}=w.useContext(mi),{pathname:l}=Di(),u=JSON.stringify(Jg(i)),d=w.useRef(!1);return Ex(()=>{d.current=!0}),w.useCallback((y,g={})=>{if(Gr(d.current,kx),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=Zg(y,JSON.parse(u),l,g.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ia([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,u,l,s])}w.createContext(null);function xS(){let{matches:s}=w.useContext(mi),e=s[s.length-1];return e?e.params:{}}function Nu(s,{relative:e}={}){let{matches:t}=w.useContext(mi),{pathname:i}=Di(),l=JSON.stringify(Jg(t));return w.useMemo(()=>Zg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function _S(s,e){return Tx(s,e)}function Tx(s,e,t,i,l){qn(ec(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Ir),{matches:d}=w.useContext(mi),p=d[d.length-1],y=p?p.params:{},g=p?p.pathname:"/",b=p?p.pathnameBase:"/",k=p&&p.route;{let G=k&&k.path||"";Sx(g,!k||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let S=Di(),R;if(e){let G=typeof e=="string"?Jl(e):e;qn(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),R=G}else R=S;let q=R.pathname||"/",$=q;if(b!=="/"){let G=b.replace(/^\//,"").split("/");$="/"+q.replace(/^\//,"").split("/").slice(G.length).join("/")}let U=px(s,{pathname:$});Gr(k||U!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Gr(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let W=SS(U&&U.map(G=>Object.assign({},G,{params:Object.assign({},y,G.params),pathname:ia([b,u.encodeLocation?u.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:ia([b,u.encodeLocation?u.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),d,t,i,l);return e&&W?w.createElement(Cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},W):W}function kS(){let s=IS(),e=cS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var ES=w.createElement(kS,null),jx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=vS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(mi.Provider,{value:this.props.routeContext},w.createElement(ey.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(TS,{error:s},e):e}};jx.contextType=hS;var Mp=new WeakMap;function TS({children:s,error:e}){let{basename:t}=w.useContext(Ir);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=yS(e.digest);if(i){let l=Mp.get(e);if(l)throw l;let u=bx(i.location,t);if(vx&&!Mp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Mp.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function jS({routeContext:s,match:e,children:t}){let i=w.useContext(Zl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(mi.Provider,{value:s},t)}function SS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);qn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,y=-1;if(t)for(let b=0;b<u.length;b++){let k=u[b];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(y=b),k.route.id){let{loaderData:S,errors:R}=t,q=k.route.loader&&!S.hasOwnProperty(k.route.id)&&(!R||R[k.route.id]===void 0);if(k.route.lazy||q){p=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}let g=t&&i?(b,k)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:uS(t.matches),errorInfo:k})}:void 0;return u.reduceRight((b,k,S)=>{let R,q=!1,$=null,U=null;t&&(R=d&&k.route.id?d[k.route.id]:void 0,$=k.route.errorElement||ES,p&&(y<0&&S===0?(Sx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,U=null):y===S&&(q=!0,U=k.route.hydrateFallbackElement||null)));let W=e.concat(u.slice(0,S+1)),G=()=>{let Q;return R?Q=$:q?Q=U:k.route.Component?Q=w.createElement(k.route.Component,null):k.route.element?Q=k.route.element:Q=b,w.createElement(jS,{match:k,routeContext:{outlet:b,matches:W,isDataRoute:t!=null},children:Q})};return t&&(k.route.ErrorBoundary||k.route.errorElement||S===0)?w.createElement(jx,{location:t.location,revalidation:t.revalidation,component:$,error:R,children:G(),routeContext:{outlet:null,matches:W,isDataRoute:!0},onError:g}):G()},null)}function ty(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(s){let e=w.useContext(Zl);return qn(e,ty(s)),e}function NS(s){let e=w.useContext(nf);return qn(e,ty(s)),e}function AS(s){let e=w.useContext(mi);return qn(e,ty(s)),e}function ny(s){let e=AS(s),t=e.matches[e.matches.length-1];return qn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function RS(){return ny("useRouteId")}function IS(){let s=w.useContext(ey),e=NS("useRouteError"),t=ny("useRouteError");return s!==void 0?s:e.errors?.[t]}function MS(){let{router:s}=CS("useNavigate"),e=ny("useNavigate"),t=w.useRef(!1);return Ex(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Gr(t.current,kx),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var r2={};function Sx(s,e,t){!e&&!r2[s]&&(r2[s]=!0,Gr(!1,t))}w.memo(DS);function DS({routes:s,future:e,state:t,onError:i}){return Tx(s,void 0,t,i,e)}function Cx({to:s,replace:e,state:t,relative:i}){qn(ec(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Ir);Gr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(mi),{pathname:d}=Di(),p=Zs(),y=Zg(s,Jg(u),d,i==="path"),g=JSON.stringify(y);return w.useEffect(()=>{p(JSON.parse(g),{replace:e,state:t,relative:i})},[p,g,i,e,t]),null}function En(s){qn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){qn(!ec(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=Jl(t));let{pathname:g="/",search:b="",hash:k="",state:S=null,key:R="default"}=t,q=w.useMemo(()=>{let $=ca(g,p);return $==null?null:{location:{pathname:$,search:b,hash:k,state:S,key:R},navigationType:i}},[p,g,b,k,S,R,i]);return Gr(q!=null,`<Router basename="${p}"> is not able to match the URL "${g}${b}${k}" because it does not start with the basename, so the <Router> won't render anything.`),q==null?null:w.createElement(Ir.Provider,{value:y},w.createElement(Cu.Provider,{children:e,value:q}))}function OS({children:s,location:e}){return _S(yg(s),e)}function yg(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,yg(i.props.children,u));return}qn(i.type===En,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=yg(i.props.children,u)),t.push(d)}),t}var wh="get",xh="application/x-www-form-urlencoded";function sf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function PS(s){return sf(s)&&s.tagName.toLowerCase()==="button"}function VS(s){return sf(s)&&s.tagName.toLowerCase()==="form"}function US(s){return sf(s)&&s.tagName.toLowerCase()==="input"}function BS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function zS(s,e){return s.button===0&&(!e||e==="_self")&&!BS(s)}function vg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function FS(s,e){let t=vg(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var ih=null;function qS(){if(ih===null)try{new FormData(document.createElement("form"),0),ih=!1}catch{ih=!0}return ih}var HS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dp(s){return s!=null&&!HS.has(s)?(Gr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xh}"`),null):s}function $S(s,e){let t,i,l,u,d;if(VS(s)){let p=s.getAttribute("action");i=p?ca(p,e):null,t=s.getAttribute("method")||wh,l=Dp(s.getAttribute("enctype"))||xh,u=new FormData(s)}else if(PS(s)||US(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||p.getAttribute("action");if(i=y?ca(y,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||wh,l=Dp(s.getAttribute("formenctype"))||Dp(p.getAttribute("enctype"))||xh,u=new FormData(p,s),!qS()){let{name:g,type:b,value:k}=s;if(b==="image"){let S=g?`${g}.`:"";u.append(`${S}x`,"0"),u.append(`${S}y`,"0")}else g&&u.append(g,k)}}else{if(sf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=wh,i=null,l=xh,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function WS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ca(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function GS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function YS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await GS(u,t);return d.links?d.links():[]}return[]}));return ZS(i.flat(1).filter(KS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function i2(s,e,t,i,l,u){let d=(y,g)=>t[g]?y.route.id!==t[g].route.id:!0,p=(y,g)=>t[g].pathname!==y.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==y.params["*"];return u==="assets"?e.filter((y,g)=>d(y,g)||p(y,g)):u==="data"?e.filter((y,g)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,g)||p(y,g))return!0;if(y.route.shouldRevalidate){let k=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function QS(s,e,{includeHydrateFallback:t}={}){return XS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function XS(s){return[...new Set(s)]}function JS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function ZS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(JS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Nx(){let s=w.useContext(Zl);return sy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function eC(){let s=w.useContext(nf);return sy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ry=w.createContext(void 0);ry.displayName="FrameworkContext";function Ax(){let s=w.useContext(ry);return sy(s,"You must render this element inside a <HydratedRouter> element"),s}function tC(s,e){let t=w.useContext(ry),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:p,onBlur:y,onMouseEnter:g,onMouseLeave:b,onTouchStart:k}=e,S=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let $=W=>{W.forEach(G=>{d(G.isIntersecting)})},U=new IntersectionObserver($,{threshold:.5});return S.current&&U.observe(S.current),()=>{U.disconnect()}}},[s]),w.useEffect(()=>{if(i){let $=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout($)}}},[i]);let R=()=>{l(!0)},q=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,S,{}]:[u,S,{onFocus:Gc(p,R),onBlur:Gc(y,q),onMouseEnter:Gc(g,R),onMouseLeave:Gc(b,q),onTouchStart:Gc(k,R)}]:[!1,S,{}]}function Gc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function nC({page:s,...e}){let{router:t}=Nx(),i=w.useMemo(()=>px(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(rC,{page:s,matches:i,...e}):null}function sC(s){let{manifest:e,routeModules:t}=Ax(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return YS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function rC({page:s,matches:e,...t}){let i=Di(),{future:l,manifest:u,routeModules:d}=Ax(),{basename:p}=Nx(),{loaderData:y,matches:g}=eC(),b=w.useMemo(()=>i2(s,e,g,u,i,"data"),[s,e,g,u,i]),k=w.useMemo(()=>i2(s,e,g,u,i,"assets"),[s,e,g,u,i]),S=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let $=new Set,U=!1;if(e.forEach(G=>{let Q=u.routes[G.route.id];!Q||!Q.hasLoader||(!b.some(me=>me.route.id===G.route.id)&&G.route.id in y&&d[G.route.id]?.shouldRevalidate||Q.hasClientLoader?U=!0:$.add(G.route.id))}),$.size===0)return[];let W=WS(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return U&&$.size>0&&W.searchParams.set("_routes",e.filter(G=>$.has(G.route.id)).map(G=>G.route.id).join(",")),[W.pathname+W.search]},[p,l.unstable_trailingSlashAwareDataRequests,y,i,u,b,e,s,d]),R=w.useMemo(()=>QS(k,u),[k,u]),q=sC(k);return w.createElement(w.Fragment,null,S.map($=>w.createElement("link",{key:$,rel:"prefetch",as:"fetch",href:$,...t})),R.map($=>w.createElement("link",{key:$,rel:"modulepreload",href:$,...t})),q.map(({key:$,link:U})=>w.createElement("link",{key:$,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function iC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var aC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{aC&&(window.__reactRouterVersion="7.13.0")}catch{}function oC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=Uj({window:i,v5Compat:!0}));let u=l.current,[d,p]=w.useState({action:u.action,location:u.location}),y=w.useCallback(g=>{t===!1?p(g):w.startTransition(()=>p(g))},[t]);return w.useLayoutEffect(()=>u.listen(y),[u,y]),w.createElement(LS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Rx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ix=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:y,to:g,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:S,...R},q){let{basename:$,unstable_useTransitions:U}=w.useContext(Ir),W=typeof g=="string"&&Rx.test(g),G=bx(g,$);g=G.to;let Q=bS(g,{relative:l}),[me,ke,xe]=tC(i,R),C=dC(g,{replace:d,state:p,target:y,preventScrollReset:b,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:S,unstable_useTransitions:U});function T(P){e&&e(P),P.defaultPrevented||C(P)}let I=w.createElement("a",{...R,...xe,href:G.absoluteURL||Q,onClick:G.isExternal||u?e:T,ref:iC(q,ke),target:y,"data-discover":!W&&t==="render"?"true":void 0});return me&&!W?w.createElement(w.Fragment,null,I,w.createElement(nC,{page:Q})):I});Ix.displayName="Link";var lC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:y,...g},b){let k=Nu(d,{relative:g.relative}),S=Di(),R=w.useContext(nf),{navigator:q,basename:$}=w.useContext(Ir),U=R!=null&&gC(k)&&p===!0,W=q.encodeLocation?q.encodeLocation(k).pathname:k.pathname,G=S.pathname,Q=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(G=G.toLowerCase(),Q=Q?Q.toLowerCase():null,W=W.toLowerCase()),Q&&$&&(Q=ca(Q,$)||Q);const me=W!=="/"&&W.endsWith("/")?W.length-1:W.length;let ke=G===W||!l&&G.startsWith(W)&&G.charAt(me)==="/",xe=Q!=null&&(Q===W||!l&&Q.startsWith(W)&&Q.charAt(W.length)==="/"),C={isActive:ke,isPending:xe,isTransitioning:U},T=ke?e:void 0,I;typeof i=="function"?I=i(C):I=[i,ke?"active":null,xe?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let P=typeof u=="function"?u(C):u;return w.createElement(Ix,{...g,"aria-current":T,className:I,ref:b,style:P,to:d,viewTransition:p},typeof y=="function"?y(C):y)});lC.displayName="NavLink";var cC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=wh,action:p,onSubmit:y,relative:g,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:S,...R},q)=>{let{unstable_useTransitions:$}=w.useContext(Ir),U=mC(),W=pC(p,{relative:g}),G=d.toLowerCase()==="get"?"get":"post",Q=typeof p=="string"&&Rx.test(p),me=ke=>{if(y&&y(ke),ke.defaultPrevented)return;ke.preventDefault();let xe=ke.nativeEvent.submitter,C=xe?.getAttribute("formmethod")||d,T=()=>U(xe||ke.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:g,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:S});$&&t!==!1?w.startTransition(()=>T()):T()};return w.createElement("form",{ref:q,method:G,action:W,onSubmit:i?y:me,...R,"data-discover":!Q&&s==="render"?"true":void 0})});cC.displayName="Form";function uC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mx(s){let e=w.useContext(Zl);return qn(e,uC(s)),e}function dC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:y}={}){let g=Zs(),b=Di(),k=Nu(s,{relative:u});return w.useCallback(S=>{if(zS(S,e)){S.preventDefault();let R=t!==void 0?t:fu(b)===fu(k),q=()=>g(s,{replace:R,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});y?w.startTransition(()=>q()):q()}},[b,g,k,t,i,e,s,l,u,d,p,y])}function AO(s){Gr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(vg(s)),t=w.useRef(!1),i=Di(),l=w.useMemo(()=>FS(i.search,t.current?null:e.current),[i.search]),u=Zs(),d=w.useCallback((p,y)=>{const g=vg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+g,y)},[u,l]);return[l,d]}var hC=0,fC=()=>`__${String(++hC)}__`;function mC(){let{router:s}=Mx("useSubmit"),{basename:e}=w.useContext(Ir),t=RS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:p,method:y,encType:g,formData:b,body:k}=$S(u,e);if(d.navigate===!1){let S=d.fetcherKey||fC();await i(S,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||g,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function pC(s,{relative:e}={}){let{basename:t}=w.useContext(Ir),i=w.useContext(mi);qn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Nu(s||".",{relative:e})},d=Di();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),y=p.getAll("index");if(y.some(b=>b==="")){p.delete("index"),y.filter(k=>k).forEach(k=>p.append("index",k));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ia([t,u.pathname])),fu(u)}function gC(s,{relative:e}={}){let t=w.useContext(xx);qn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Mx("useViewTransitionState"),l=Nu(s,{relative:e});if(!t.isTransitioning)return!1;let u=ca(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ca(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Mh(l.pathname,d)!=null||Mh(l.pathname,u)!=null}const yC=()=>{};var a2={};const Dx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},vC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],p=s[t++],y=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Lx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,p=d?s[l+1]:0,y=l+2<s.length,g=y?s[l+2]:0,b=u>>2,k=(u&3)<<4|p>>4;let S=(p&15)<<2|g>>6,R=g&63;y||(R=64,d||(S=64)),i.push(t[b],t[k],t[S],t[R])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Dx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):vC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const g=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||g==null||k==null)throw new bC;const S=u<<2|p>>4;if(i.push(S),g!==64){const R=p<<4&240|g>>2;if(i.push(R),k!==64){const q=g<<6&192|k;i.push(q)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class bC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(s){const e=Dx(s);return Lx.encodeByteArray(e,!0)},Dh=function(s){return wC(s).replace(/\./g,"")},Ox=function(s){try{return Lx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _C=()=>xC().__FIREBASE_DEFAULTS__,kC=()=>{if(typeof process>"u"||typeof a2>"u")return;const s=a2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},EC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Ox(s[1]);return e&&JSON.parse(e)},rf=()=>{try{return yC()||_C()||kC()||EC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Px=s=>rf()?.emulatorHosts?.[s],Vx=s=>{const e=Px(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ux=()=>rf()?.config,Bx=s=>rf()?.[`_${s}`];class TC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function ao(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iy(s){return(await fetch(s,{credentials:"include"})).ok}function zx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const au={};function jC(){const s={prod:[],emulator:[]};for(const e of Object.keys(au))au[e]?s.emulator.push(e):s.prod.push(e);return s}function SC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let o2=!1;function ay(s,e){if(typeof window>"u"||typeof document>"u"||!ao(window.location.host)||au[s]===e||au[s]||o2)return;au[s]=e;function t(S){return`__firebase__banner__${S}`}const i="__firebase__banner",u=jC().prod.length>0;function d(){const S=document.getElementById(i);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function y(S,R){S.setAttribute("width","24"),S.setAttribute("id",R),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function g(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{o2=!0,d()},S}function b(S,R){S.setAttribute("id",R),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function k(){const S=SC(i),R=t("text"),q=document.getElementById(R)||document.createElement("span"),$=t("learnmore"),U=document.getElementById($)||document.createElement("a"),W=t("preprendIcon"),G=document.getElementById(W)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const Q=S.element;p(Q),b(U,$);const me=g();y(G,W),Q.append(G,q,U,me),document.body.appendChild(Q)}u?(q.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,q.innerText="Preview backend running in this workspace."),q.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function NC(){const s=rf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function IC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MC(){const s=Xs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function DC(){return!NC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fx(){try{return typeof indexedDB=="object"}catch{return!1}}function qx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function LC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const OC="FirebaseError";class pi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=OC,Object.setPrototypeOf(this,pi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wo.prototype.create)}}class Wo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PC(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new pi(l,p,i)}}function PC(s,e){return s.replace(VC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const VC=/\{\$([^}]+)}/g;function UC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ua(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(l2(u)&&l2(d)){if(!ua(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function l2(s){return s!==null&&typeof s=="object"}function Au(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function eu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function tu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function BC(s,e){const t=new zC(s,e);return t.subscribe.bind(t)}class zC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Lp),l.error===void 0&&(l.error=Lp),l.complete===void 0&&(l.complete=Lp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Lp(){}function gn(s){return s&&s._delegate?s._delegate:s}class Kr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ao="[DEFAULT]";class qC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new TC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($C(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:HC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(s){return s===Ao?void 0:s}function $C(s){return s.instantiationMode==="EAGER"}class WC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Wt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Wt||(Wt={}));const GC={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},KC=Wt.INFO,YC={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},QC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=YC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oy{constructor(e){this.name=e,this._logLevel=KC,this._logHandler=QC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const XC=(s,e)=>e.some(t=>s instanceof t);let c2,u2;function JC(){return c2||(c2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZC(){return u2||(u2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hx=new WeakMap,bg=new WeakMap,$x=new WeakMap,Op=new WeakMap,ly=new WeakMap;function eN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(aa(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Hx.set(t,s)}).catch(()=>{}),ly.set(e,s),e}function tN(s){if(bg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});bg.set(s,e)}let wg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return bg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||$x.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return aa(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function nN(s){wg=s(wg)}function sN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Pp(this),e,...t);return $x.set(i,e.sort?e.sort():[e]),aa(i)}:ZC().includes(s)?function(...e){return s.apply(Pp(this),e),aa(Hx.get(this))}:function(...e){return aa(s.apply(Pp(this),e))}}function rN(s){return typeof s=="function"?sN(s):(s instanceof IDBTransaction&&tN(s),XC(s,JC())?new Proxy(s,wg):s)}function aa(s){if(s instanceof IDBRequest)return eN(s);if(Op.has(s))return Op.get(s);const e=rN(s);return e!==s&&(Op.set(s,e),ly.set(e,s)),e}const Pp=s=>ly.get(s);function af(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),p=aa(d);return i&&d.addEventListener("upgradeneeded",y=>{i(aa(d.result),y.oldVersion,y.newVersion,aa(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),p.then(y=>{u&&y.addEventListener("close",()=>u()),l&&y.addEventListener("versionchange",g=>l(g.oldVersion,g.newVersion,g))}).catch(()=>{}),p}function Vp(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),aa(t).then(()=>{})}const iN=["get","getKey","getAll","getAllKeys","count"],aN=["put","add","delete","clear"],Up=new Map;function d2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Up.get(e))return Up.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=aN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||iN.includes(t)))return;const u=async function(d,...p){const y=this.transaction(d,l?"readwrite":"readonly");let g=y.store;return i&&(g=g.index(p.shift())),(await Promise.all([g[t](...p),l&&y.done]))[0]};return Up.set(e,u),u}nN(s=>({...s,get:(e,t,i)=>d2(e,t)||s.get(e,t,i),has:(e,t)=>!!d2(e,t)||s.has(e,t)}));class oN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lN(s){return s.getComponent()?.type==="VERSION"}const xg="@firebase/app",h2="0.14.7";const da=new oy("@firebase/app"),cN="@firebase/app-compat",uN="@firebase/analytics-compat",dN="@firebase/analytics",hN="@firebase/app-check-compat",fN="@firebase/app-check",mN="@firebase/auth",pN="@firebase/auth-compat",gN="@firebase/database",yN="@firebase/data-connect",vN="@firebase/database-compat",bN="@firebase/functions",wN="@firebase/functions-compat",xN="@firebase/installations",_N="@firebase/installations-compat",kN="@firebase/messaging",EN="@firebase/messaging-compat",TN="@firebase/performance",jN="@firebase/performance-compat",SN="@firebase/remote-config",CN="@firebase/remote-config-compat",NN="@firebase/storage",AN="@firebase/storage-compat",RN="@firebase/firestore",IN="@firebase/ai",MN="@firebase/firestore-compat",DN="firebase",LN="12.8.0";const _g="[DEFAULT]",ON={[xg]:"fire-core",[cN]:"fire-core-compat",[dN]:"fire-analytics",[uN]:"fire-analytics-compat",[fN]:"fire-app-check",[hN]:"fire-app-check-compat",[mN]:"fire-auth",[pN]:"fire-auth-compat",[gN]:"fire-rtdb",[yN]:"fire-data-connect",[vN]:"fire-rtdb-compat",[bN]:"fire-fn",[wN]:"fire-fn-compat",[xN]:"fire-iid",[_N]:"fire-iid-compat",[kN]:"fire-fcm",[EN]:"fire-fcm-compat",[TN]:"fire-perf",[jN]:"fire-perf-compat",[SN]:"fire-rc",[CN]:"fire-rc-compat",[NN]:"fire-gcs",[AN]:"fire-gcs-compat",[RN]:"fire-fst",[MN]:"fire-fst-compat",[IN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Lh=new Map,PN=new Map,kg=new Map;function f2(s,e){try{s.container.addComponent(e)}catch(t){da.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function di(s){const e=s.name;if(kg.has(e))return da.debug(`There were multiple attempts to register component ${e}.`),!1;kg.set(e,s);for(const t of Lh.values())f2(t,s);for(const t of PN.values())f2(t,s);return!0}function Go(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Nr(s){return s==null?!1:s.settings!==void 0}const VN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xa=new Wo("app","Firebase",VN);class UN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Kr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xa.create("app-deleted",{appName:this._name})}}const Ko=LN;function cy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:_g,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Xa.create("bad-app-name",{appName:String(l)});if(t||(t=Ux()),!t)throw Xa.create("no-options");const u=Lh.get(l);if(u){if(ua(t,u.options)&&ua(i,u.config))return u;throw Xa.create("duplicate-app",{appName:l})}const d=new WC(l);for(const y of kg.values())d.addComponent(y);const p=new UN(t,i,d);return Lh.set(l,p),p}function Ru(s=_g){const e=Lh.get(s);if(!e&&s===_g&&Ux())return cy();if(!e)throw Xa.create("no-app",{appName:s});return e}function br(s,e,t){let i=ON[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),da.warn(d.join(" "));return}di(new Kr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const BN="firebase-heartbeat-database",zN=1,mu="firebase-heartbeat-store";let Bp=null;function Wx(){return Bp||(Bp=af(BN,zN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(mu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Xa.create("idb-open",{originalErrorMessage:s.message})})),Bp}async function FN(s){try{const t=(await Wx()).transaction(mu),i=await t.objectStore(mu).get(Gx(s));return await t.done,i}catch(e){if(e instanceof pi)da.warn(e.message);else{const t=Xa.create("idb-get",{originalErrorMessage:e?.message});da.warn(t.message)}}}async function m2(s,e){try{const i=(await Wx()).transaction(mu,"readwrite");await i.objectStore(mu).put(e,Gx(s)),await i.done}catch(t){if(t instanceof pi)da.warn(t.message);else{const i=Xa.create("idb-set",{originalErrorMessage:t?.message});da.warn(i.message)}}}function Gx(s){return`${s.name}!${s.options.appId}`}const qN=1024,HN=30;class $N{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=p2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>HN){const l=KN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){da.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=p2(),{heartbeatsToSend:t,unsentEntries:i}=WN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return da.warn(e),""}}}function p2(){return new Date().toISOString().substring(0,10)}function WN(s,e=qN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),g2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),g2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fx()?qx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function g2(s){return Dh(JSON.stringify({version:2,heartbeats:s})).length}function KN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function YN(s){di(new Kr("platform-logger",e=>new oN(e),"PRIVATE")),di(new Kr("heartbeat",e=>new $N(e),"PRIVATE")),br(xg,h2,s),br(xg,h2,"esm2020"),br("fire-js","")}YN("");function Kx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QN=Kx,Yx=new Wo("auth","Firebase",Kx());const Oh=new oy("@firebase/auth");function XN(s,...e){Oh.logLevel<=Wt.WARN&&Oh.warn(`Auth (${Ko}): ${s}`,...e)}function _h(s,...e){Oh.logLevel<=Wt.ERROR&&Oh.error(`Auth (${Ko}): ${s}`,...e)}function hi(s,...e){throw uy(s,...e)}function Si(s,...e){return uy(s,...e)}function Qx(s,e,t){const i={...QN(),[e]:t};return new Wo("auth","Firebase",i).create(e,{appName:s.name})}function oa(s){return Qx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Yx.create(s,...e)}function mt(s,e,...t){if(!s)throw uy(e,...t)}function sa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw _h(e),new Error(e)}function ha(s,e){s||sa(e)}function Eg(){return typeof self<"u"&&self.location?.href||""}function JN(){return y2()==="http:"||y2()==="https:"}function y2(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||RC()||"connection"in navigator)?navigator.onLine:!0}function eA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Iu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ha(t>e,"Short delay should be less than long delay!"),this.isMobile=CC()||IC()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dy(s,e){ha(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const nA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sA=new Iu(3e4,6e4);function pa(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ga(s,e,t,i,l={}){return Jx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Au({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const g={method:e,headers:y,...u};return AC()||(g.referrerPolicy="no-referrer"),s.emulatorConfig&&ao(s.emulatorConfig.host)&&(g.credentials="include"),Xx.fetch()(await Zx(s,s.config.apiHost,t,p),g)})}async function Jx(s,e,t){s._canInitEmulator=!1;const i={...tA,...e};try{const l=new iA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[y,g]=p.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw ah(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw ah(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Qx(s,b,g);hi(s,b)}}catch(l){if(l instanceof pi)throw l;hi(s,"network-request-failed",{message:String(l)})}}async function Mu(s,e,t,i,l={}){const u=await ga(s,e,t,i,l);return"mfaPendingCredential"in u&&hi(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Zx(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?dy(s.config,l):`${s.config.apiScheme}://${l}`;return nA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Si(this.auth,"network-request-failed")),sA.get())})}}function ah(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Si(s,e,i);return l.customData._tokenResponse=t,l}function v2(s){return s!==void 0&&s.enterprise!==void 0}class aA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oA(s,e){return ga(s,"GET","/v2/recaptchaConfig",pa(s,e))}async function lA(s,e){return ga(s,"POST","/v1/accounts:delete",e)}async function Ph(s,e){return ga(s,"POST","/v1/accounts:lookup",e)}function ou(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cA(s,e=!1){const t=gn(s),i=await t.getIdToken(e),l=hy(i);mt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:ou(zp(l.auth_time)),issuedAtTime:ou(zp(l.iat)),expirationTime:ou(zp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function zp(s){return Number(s)*1e3}function hy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const l=Ox(t);return l?JSON.parse(l):(_h("Failed to decode base64 JWT payload"),null)}catch(l){return _h("Caught error parsing JWT payload as JSON",l?.toString()),null}}function b2(s){const e=hy(s);return mt(e,"internal-error"),mt(typeof e.exp<"u","internal-error"),mt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function pu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof pi&&uA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function uA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class dA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ou(this.lastLoginAt),this.creationTime=ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(s){const e=s.auth,t=await s.getIdToken(),i=await pu(s,Ph(e,{idToken:t}));mt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?e_(l.providerUserInfo):[],d=fA(s.providerData,u),p=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,g=p?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Tg(l.createdAt,l.lastLoginAt),isAnonymous:g};Object.assign(s,b)}async function hA(s){const e=gn(s);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function e_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mA(s,e){const t=await Jx(s,{},async()=>{const i=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await Zx(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:p,body:i};return s.emulatorConfig&&ao(s.emulatorConfig.host)&&(y.credentials="include"),Xx.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pA(s,e){return ga(s,"POST","/v2/accounts:revokeToken",pa(s,e))}class Vl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){mt(e.idToken,"internal-error"),mt(typeof e.idToken<"u","internal-error"),mt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):b2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){mt(e.length!==0,"internal-error");const t=b2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(mt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Vl;return i&&(mt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(mt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(mt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vl,this.toJSON())}_performRefresh(){return sa("not implemented")}}function za(s,e){mt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class li{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Tg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await pu(this,this.stsTokenManager.getToken(this.auth,e));return mt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cA(this,e)}reload(){return hA(this)}_assign(e){this!==e&&(mt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new li({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){mt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nr(this.auth.app))return Promise.reject(oa(this.auth));const e=await this.getIdToken();return await pu(this,lA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,y=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:k,emailVerified:S,isAnonymous:R,providerData:q,stsTokenManager:$}=t;mt(k&&$,e,"internal-error");const U=Vl.fromJSON(this.name,$);mt(typeof k=="string",e,"internal-error"),za(i,e.name),za(l,e.name),mt(typeof S=="boolean",e,"internal-error"),mt(typeof R=="boolean",e,"internal-error"),za(u,e.name),za(d,e.name),za(p,e.name),za(y,e.name),za(g,e.name),za(b,e.name);const W=new li({uid:k,auth:e,email:l,emailVerified:S,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:U,createdAt:g,lastLoginAt:b});return q&&Array.isArray(q)&&(W.providerData=q.map(G=>({...G}))),y&&(W._redirectEventId=y),W}static async _fromIdTokenResponse(e,t,i=!1){const l=new Vl;l.updateFromServerResponse(t);const u=new li({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Vh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];mt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?e_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Vl;p.updateFromIdToken(i);const y=new li({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),g={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Tg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(y,g),y}}const w2=new Map;function ra(s){ha(s instanceof Function,"Expected a class definition");let e=w2.get(s);return e?(ha(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,w2.set(s,e),e)}class t_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}t_.type="NONE";const x2=t_;function kh(s,e,t){return`firebase:${s}:${e}:${t}`}class Ul{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=kh(this.userKey,l.apiKey,u),this.fullPersistenceKey=kh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?li._fromGetAccountInfoResponse(this.auth,t,e):null}return li._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ul(ra(x2),e,i);const l=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let u=l[0]||ra(x2);const d=kh(i,e.config.apiKey,e.name);let p=null;for(const g of t)try{const b=await g._get(d);if(b){let k;if(typeof b=="string"){const S=await Ph(e,{idToken:b}).catch(()=>{});if(!S)break;k=await li._fromGetAccountInfoResponse(e,S,b)}else k=li._fromJSON(e,b);g!==u&&(p=k),u=g;break}}catch{}const y=l.filter(g=>g._shouldAllowMigration);return!u._shouldAllowMigration||!y.length?new Ul(u,e,i):(u=y[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async g=>{if(g!==u)try{await g._remove(d)}catch{}})),new Ul(u,e,i))}}function _2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(o_(e))return"Blackberry";if(l_(e))return"Webos";if(s_(e))return"Safari";if((e.includes("chrome/")||r_(e))&&!e.includes("edge/"))return"Chrome";if(a_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function n_(s=Xs()){return/firefox\//i.test(s)}function s_(s=Xs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function r_(s=Xs()){return/crios\//i.test(s)}function i_(s=Xs()){return/iemobile/i.test(s)}function a_(s=Xs()){return/android/i.test(s)}function o_(s=Xs()){return/blackberry/i.test(s)}function l_(s=Xs()){return/webos/i.test(s)}function fy(s=Xs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function gA(s=Xs()){return fy(s)&&!!window.navigator?.standalone}function yA(){return MC()&&document.documentMode===10}function c_(s=Xs()){return fy(s)||a_(s)||l_(s)||o_(s)||/windows phone/i.test(s)||i_(s)}function u_(s,e=[]){let t;switch(s){case"Browser":t=_2(Xs());break;case"Worker":t=`${_2(Xs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ko}/${i}`}class vA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const y=e(u);d(y)}catch(y){p(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bA(s,e={}){return ga(s,"GET","/v2/passwordPolicy",pa(s,e))}const wA=6;class xA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??wA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _A{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new k2(this),this.idTokenSubscription=new k2(this),this.beforeStateQueue=new vA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ra(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ul.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await li._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return mt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nr(this.app))return Promise.reject(oa(this));const t=e?gn(e):null;return t&&mt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&mt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nr(this.app)?Promise.reject(oa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nr(this.app)?Promise.reject(oa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ra(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bA(this),t=new xA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await pA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ra(e)||this._popupRedirectResolver;mt(t,this,"argument-error"),this.redirectPersistenceManager=await Ul.create(this,[ra(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(mt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return mt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oo(s){return gn(s)}class k2{constructor(e){this.auth=e,this.observer=null,this.addObserver=BC(t=>this.observer=t)}get next(){return mt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kA(s){of=s}function d_(s){return of.loadJS(s)}function EA(){return of.recaptchaEnterpriseScript}function TA(){return of.gapiScript}function jA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class SA{constructor(){this.enterprise=new CA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NA="recaptcha-enterprise",h_="NO_RECAPTCHA";class AA{constructor(e){this.type=NA,this.auth=oo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{oA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const g=new aA(y);return u.tenantId==null?u._agentRecaptchaConfig=g:u._tenantRecaptchaConfigs[u.tenantId]=g,d(g.siteKey)}}).catch(y=>{p(y)})})}function l(u,d,p){const y=window.grecaptcha;v2(y)?y.enterprise.ready(()=>{y.enterprise.execute(u,{action:e}).then(g=>{d(g)}).catch(()=>{d(h_)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&v2(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=EA();y.length!==0&&(y+=p),d_(y).then(()=>{l(p,u,d)}).catch(g=>{d(g)})}}).catch(p=>{d(p)})})}}async function E2(s,e,t,i=!1,l=!1){const u=new AA(s);let d;if(l)d=h_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const y=p.phoneEnrollmentInfo.phoneNumber,g=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const y=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Uh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await E2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await E2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function RA(s,e){const t=Go(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ua(u,e??{}))return l;hi(l,"already-initialized")}return t.initialize({options:e})}function IA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ra);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function MA(s,e,t){const i=oo(s);mt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=f_(e),{host:d,port:p}=DA(e),y=p===null?"":`:${p}`,g={url:`${u}//${d}${y}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){mt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),mt(ua(g,i.config.emulator)&&ua(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,ao(d)?(iy(`${u}//${d}${y}`),ay("Auth",!0)):LA()}function f_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function DA(s){const e=f_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:T2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:T2(d)}}}function T2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function LA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class my{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return sa("not implemented")}_getIdTokenResponse(e){return sa("not implemented")}_linkToIdToken(e,t){return sa("not implemented")}_getReauthenticationResolver(e){return sa("not implemented")}}async function OA(s,e){return ga(s,"POST","/v1/accounts:signUp",e)}async function PA(s,e){return Mu(s,"POST","/v1/accounts:signInWithPassword",pa(s,e))}async function m_(s,e){return ga(s,"POST","/v1/accounts:sendOobCode",pa(s,e))}async function VA(s,e){return m_(s,e)}async function UA(s,e){return m_(s,e)}async function BA(s,e){return Mu(s,"POST","/v1/accounts:signInWithEmailLink",pa(s,e))}async function zA(s,e){return Mu(s,"POST","/v1/accounts:signInWithEmailLink",pa(s,e))}class gu extends my{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new gu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new gu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,t,"signInWithPassword",PA);case"emailLink":return BA(e,{email:this._email,oobCode:this._password});default:hi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,i,"signUpPassword",OA);case"emailLink":return zA(e,{idToken:t,email:this._email,oobCode:this._password});default:hi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Bl(s,e){return Mu(s,"POST","/v1/accounts:signInWithIdp",pa(s,e))}const FA="http://localhost";class Vo extends my{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Vo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Bl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Bl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bl(e,t)}buildRequest(){const e={requestUri:FA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Au(t)}return e}}function qA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HA(s){const e=eu(tu(s)).link,t=e?eu(tu(e)).deep_link_id:null,i=eu(tu(s)).deep_link_id;return(i?eu(tu(i)).link:null)||i||t||e||s}class py{constructor(e){const t=eu(tu(e)),i=t.apiKey??null,l=t.oobCode??null,u=qA(t.mode??null);mt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=HA(e);try{return new py(t)}catch{return null}}}class tc{constructor(){this.providerId=tc.PROVIDER_ID}static credential(e,t){return gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=py.parseLink(t);return mt(i,"argument-error"),gu._fromEmailAndCode(e,i.code,i.tenantId)}}tc.PROVIDER_ID="password";tc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class p_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends p_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qa extends Du{constructor(){super("facebook.com")}static credential(e){return Vo._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qa.credentialFromTaggedObject(e)}static credentialFromError(e){return qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qa.credential(e.oauthAccessToken)}catch{return null}}}qa.FACEBOOK_SIGN_IN_METHOD="facebook.com";qa.PROVIDER_ID="facebook.com";class Ha extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vo._fromParams({providerId:Ha.PROVIDER_ID,signInMethod:Ha.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ha.credentialFromTaggedObject(e)}static credentialFromError(e){return Ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ha.credential(t,i)}catch{return null}}}Ha.GOOGLE_SIGN_IN_METHOD="google.com";Ha.PROVIDER_ID="google.com";class $a extends Du{constructor(){super("github.com")}static credential(e){return Vo._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $a.credentialFromTaggedObject(e)}static credentialFromError(e){return $a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $a.credential(e.oauthAccessToken)}catch{return null}}}$a.GITHUB_SIGN_IN_METHOD="github.com";$a.PROVIDER_ID="github.com";class Wa extends Du{constructor(){super("twitter.com")}static credential(e,t){return Vo._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wa.credential(t,i)}catch{return null}}}Wa.TWITTER_SIGN_IN_METHOD="twitter.com";Wa.PROVIDER_ID="twitter.com";async function $A(s,e){return Mu(s,"POST","/v1/accounts:signUp",pa(s,e))}class Uo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await li._fromIdTokenResponse(e,i,l),d=j2(i);return new Uo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=j2(i);return new Uo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function j2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Bh extends pi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Bh(e,t,i,l)}}function g_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(s,u,e,i):u})}async function WA(s,e,t=!1){const i=await pu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Uo._forOperation(s,"link",i)}async function GA(s,e,t=!1){const{auth:i}=s;if(Nr(i.app))return Promise.reject(oa(i));const l="reauthenticate";try{const u=await pu(s,g_(i,l,e,s),t);mt(u.idToken,i,"internal-error");const d=hy(u.idToken);mt(d,i,"internal-error");const{sub:p}=d;return mt(s.uid===p,i,"user-mismatch"),Uo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&hi(i,"user-mismatch"),u}}async function y_(s,e,t=!1){if(Nr(s.app))return Promise.reject(oa(s));const i="signIn",l=await g_(s,i,e),u=await Uo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function KA(s,e){return y_(oo(s),e)}async function v_(s){const e=oo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YA(s,e,t){const i=oo(s);await Uh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",UA)}async function QA(s,e,t){if(Nr(s.app))return Promise.reject(oa(s));const i=oo(s),d=await Uh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$A).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&v_(s),y}),p=await Uo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function XA(s,e,t){return Nr(s.app)?Promise.reject(oa(s)):KA(gn(s),tc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&v_(s),i})}async function RO(s,e){const t=gn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await VA(t.auth,l);u!==s.email&&await s.reload()}function S2(s,e){return gn(s).setPersistence(e)}function JA(s,e,t,i){return gn(s).onIdTokenChanged(e,t,i)}function ZA(s,e,t){return gn(s).beforeAuthStateChanged(e,t)}function e4(s,e,t,i){return gn(s).onAuthStateChanged(e,t,i)}function t4(s){return gn(s).signOut()}const zh="__sak";class b_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const n4=1e3,s4=10;class w_ extends b_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=c_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},n4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}w_.type="LOCAL";const jg=w_;class x_ extends b_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}x_.type="SESSION";const gy=x_;function r4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new lf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async g=>g(t.origin,u)),y=await r4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function yy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class i4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,y)=>{const g=yy("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const S=k;if(S.data.eventId===g)switch(S.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(S.data.response);break;default:clearTimeout(b),clearTimeout(u),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ci(){return window}function a4(s){Ci().location.href=s}function __(){return typeof Ci().WorkerGlobalScope<"u"&&typeof Ci().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return __()?self:null}const k_="firebaseLocalStorageDb",u4=1,Fh="firebaseLocalStorage",E_="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(s,e){return s.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function d4(){const s=indexedDB.deleteDatabase(k_);return new Lu(s).toPromise()}function Sg(){const s=indexedDB.open(k_,u4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Fh,{keyPath:E_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Fh)?e(i):(i.close(),await d4(),e(await Sg()))})})}async function C2(s,e,t){const i=cf(s,!0).put({[E_]:e,value:t});return new Lu(i).toPromise()}async function h4(s,e){const t=cf(s,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function N2(s,e){const t=cf(s,!0).delete(e);return new Lu(t).toPromise()}const f4=800,m4=3;class T_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return __()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new i4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sg();return await C2(e,zh,"1"),await N2(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>N2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=cf(l,!1).getAll();return new Lu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}T_.type="LOCAL";const p4=T_;new Iu(3e4,6e4);function g4(s,e){return e?ra(e):(mt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class vy extends my{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function y4(s){return y_(s.auth,new vy(s),s.bypassAuthState)}function v4(s){const{auth:e,user:t}=s;return mt(t,e,"internal-error"),GA(t,new vy(s),s.bypassAuthState)}async function b4(s){const{auth:e,user:t}=s;return mt(t,e,"internal-error"),WA(t,new vy(s),s.bypassAuthState)}class j_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(y))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y4;case"linkViaPopup":case"linkViaRedirect":return b4;case"reauthViaPopup":case"reauthViaRedirect":return v4;default:hi(this.auth,"internal-error")}}resolve(e){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const w4=new Iu(2e3,1e4);class Pl extends j_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Pl.currentPopupAction&&Pl.currentPopupAction.cancel(),Pl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return mt(e,this.auth,"internal-error"),e}async onExecution(){ha(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Si(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Si(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Si(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,w4.get())};e()}}Pl.currentPopupAction=null;const x4="pendingRedirect",Eh=new Map;class _4 extends j_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Eh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Eh.set(this.auth._key(),e)}return this.bypassAuthState||Eh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(s,e){const t=j4(e),i=T4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function E4(s,e){Eh.set(s._key(),e)}function T4(s){return ra(s._redirectPersistence)}function j4(s){return kh(x4,s.config.apiKey,s.name)}async function S4(s,e,t=!1){if(Nr(s.app))return Promise.reject(oa(s));const i=oo(s),l=g4(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const C4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!S_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Si(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C4&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function S_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function A4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S_(s);default:return!1}}async function R4(s,e={}){return ga(s,"GET","/v1/projects",e)}const I4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function D4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await R4(s);for(const t of e)try{if(L4(t))return}catch{}hi(s,"unauthorized-domain")}function L4(s){const e=Eg(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(I4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const O4=new Iu(3e4,6e4);function R2(){const s=Ci().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function P4(s){return new Promise((e,t)=>{function i(){R2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{R2(),t(Si(s,"network-request-failed"))},timeout:O4.get()})}if(Ci().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ci().gapi?.load)i();else{const l=jA("iframefcb");return Ci()[l]=()=>{gapi.load?i():t(Si(s,"network-request-failed"))},d_(`${TA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function V4(s){return Th=Th||P4(s),Th}const U4=new Iu(5e3,15e3),B4="__/auth/iframe",z4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function H4(s){const e=s.config;mt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dy(e,z4):`https://${s.config.authDomain}/${B4}`,i={apiKey:e.apiKey,appName:s.name,v:Ko},l=q4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Au(i).slice(1)}`}async function $4(s){const e=await V4(s),t=Ci().gapi;return mt(t,s,"internal-error"),e.open({where:document.body,url:H4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Si(s,"network-request-failed"),p=Ci().setTimeout(()=>{u(d)},U4.get());function y(){Ci().clearTimeout(p),l(i)}i.ping(y).then(y,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class I2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(s,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const y={...W4,width:i.toString(),height:l.toString(),top:u,left:d},g=Xs().toLowerCase();t&&(p=r_(g)?Y4:t),n_(g)&&(e=e||Q4,y.scrollbars="yes");const b=Object.entries(y).reduce((S,[R,q])=>`${S}${R}=${q},`,"");if(gA(g)&&p!=="_self")return J4(e||"",p),new I2(null);const k=window.open(e||"",p,b);mt(k,s,"popup-blocked");try{k.focus()}catch{}return new I2(k)}function J4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function M2(s,e,t,i,l,u){mt(s.config.authDomain,s,"auth-domain-config-required"),mt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Ko,eventId:l};if(e instanceof p_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",UC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,k]of Object.entries({}))d[b]=k}if(e instanceof Du){const b=e.getScopes().filter(k=>k!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const y=await s._getAppCheckToken(),g=y?`#${tR}=${encodeURIComponent(y)}`:"";return`${nR(s)}?${Au(p).slice(1)}${g}`}function nR({config:s}){return s.emulator?dy(s,eR):`https://${s.authDomain}/${Z4}`}const Fp="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gy,this._completeRedirectFn=S4,this._overrideRedirectResult=E4}async _openPopup(e,t,i,l){ha(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await M2(e,t,i,Eg(),l);return X4(e,u,yy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await M2(e,t,i,Eg(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(ha(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new N4(e);return t.register("authEvent",l=>(mt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fp,{type:Fp},l=>{const u=l?.[0]?.[Fp];u!==void 0&&t(!!u),hi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return c_()||s_()||fy()}}const rR=sR;var D2="@firebase/auth",L2="1.12.0";class iR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){mt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(s){di(new Kr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;mt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u_(s)},g=new _A(i,l,u,y);return IA(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),di(new Kr("auth-internal",e=>{const t=oo(e.getProvider("auth").getImmediate());return(i=>new iR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),br(D2,L2,aR(s)),br(D2,L2,"esm2020")}const lR=300,cR=Bx("authIdTokenMaxAge")||lR;let O2=null;const uR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;O2!==l&&(O2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function C_(s=Ru()){const e=Go(s,"auth");if(e.isInitialized())return e.getImmediate();const t=RA(s,{popupRedirectResolver:rR,persistence:[p4,jg,gy]}),i=Bx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZA(t,d,()=>d(t.currentUser)),JA(t,p=>d(p))}}const l=Px("auth");return l&&MA(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Si("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var P2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ja,N_;(function(){var s;function e(C,T){function I(){}I.prototype=T.prototype,C.F=T.prototype,C.prototype=new I,C.prototype.constructor=C,C.D=function(P,V,L){for(var A=Array(arguments.length-2),De=2;De<arguments.length;De++)A[De-2]=arguments[De];return T.prototype[V].apply(P,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,T,I){I||(I=0);const P=Array(16);if(typeof T=="string")for(var V=0;V<16;++V)P[V]=T.charCodeAt(I++)|T.charCodeAt(I++)<<8|T.charCodeAt(I++)<<16|T.charCodeAt(I++)<<24;else for(V=0;V<16;++V)P[V]=T[I++]|T[I++]<<8|T[I++]<<16|T[I++]<<24;T=C.g[0],I=C.g[1],V=C.g[2];let L=C.g[3],A;A=T+(L^I&(V^L))+P[0]+3614090360&4294967295,T=I+(A<<7&4294967295|A>>>25),A=L+(V^T&(I^V))+P[1]+3905402710&4294967295,L=T+(A<<12&4294967295|A>>>20),A=V+(I^L&(T^I))+P[2]+606105819&4294967295,V=L+(A<<17&4294967295|A>>>15),A=I+(T^V&(L^T))+P[3]+3250441966&4294967295,I=V+(A<<22&4294967295|A>>>10),A=T+(L^I&(V^L))+P[4]+4118548399&4294967295,T=I+(A<<7&4294967295|A>>>25),A=L+(V^T&(I^V))+P[5]+1200080426&4294967295,L=T+(A<<12&4294967295|A>>>20),A=V+(I^L&(T^I))+P[6]+2821735955&4294967295,V=L+(A<<17&4294967295|A>>>15),A=I+(T^V&(L^T))+P[7]+4249261313&4294967295,I=V+(A<<22&4294967295|A>>>10),A=T+(L^I&(V^L))+P[8]+1770035416&4294967295,T=I+(A<<7&4294967295|A>>>25),A=L+(V^T&(I^V))+P[9]+2336552879&4294967295,L=T+(A<<12&4294967295|A>>>20),A=V+(I^L&(T^I))+P[10]+4294925233&4294967295,V=L+(A<<17&4294967295|A>>>15),A=I+(T^V&(L^T))+P[11]+2304563134&4294967295,I=V+(A<<22&4294967295|A>>>10),A=T+(L^I&(V^L))+P[12]+1804603682&4294967295,T=I+(A<<7&4294967295|A>>>25),A=L+(V^T&(I^V))+P[13]+4254626195&4294967295,L=T+(A<<12&4294967295|A>>>20),A=V+(I^L&(T^I))+P[14]+2792965006&4294967295,V=L+(A<<17&4294967295|A>>>15),A=I+(T^V&(L^T))+P[15]+1236535329&4294967295,I=V+(A<<22&4294967295|A>>>10),A=T+(V^L&(I^V))+P[1]+4129170786&4294967295,T=I+(A<<5&4294967295|A>>>27),A=L+(I^V&(T^I))+P[6]+3225465664&4294967295,L=T+(A<<9&4294967295|A>>>23),A=V+(T^I&(L^T))+P[11]+643717713&4294967295,V=L+(A<<14&4294967295|A>>>18),A=I+(L^T&(V^L))+P[0]+3921069994&4294967295,I=V+(A<<20&4294967295|A>>>12),A=T+(V^L&(I^V))+P[5]+3593408605&4294967295,T=I+(A<<5&4294967295|A>>>27),A=L+(I^V&(T^I))+P[10]+38016083&4294967295,L=T+(A<<9&4294967295|A>>>23),A=V+(T^I&(L^T))+P[15]+3634488961&4294967295,V=L+(A<<14&4294967295|A>>>18),A=I+(L^T&(V^L))+P[4]+3889429448&4294967295,I=V+(A<<20&4294967295|A>>>12),A=T+(V^L&(I^V))+P[9]+568446438&4294967295,T=I+(A<<5&4294967295|A>>>27),A=L+(I^V&(T^I))+P[14]+3275163606&4294967295,L=T+(A<<9&4294967295|A>>>23),A=V+(T^I&(L^T))+P[3]+4107603335&4294967295,V=L+(A<<14&4294967295|A>>>18),A=I+(L^T&(V^L))+P[8]+1163531501&4294967295,I=V+(A<<20&4294967295|A>>>12),A=T+(V^L&(I^V))+P[13]+2850285829&4294967295,T=I+(A<<5&4294967295|A>>>27),A=L+(I^V&(T^I))+P[2]+4243563512&4294967295,L=T+(A<<9&4294967295|A>>>23),A=V+(T^I&(L^T))+P[7]+1735328473&4294967295,V=L+(A<<14&4294967295|A>>>18),A=I+(L^T&(V^L))+P[12]+2368359562&4294967295,I=V+(A<<20&4294967295|A>>>12),A=T+(I^V^L)+P[5]+4294588738&4294967295,T=I+(A<<4&4294967295|A>>>28),A=L+(T^I^V)+P[8]+2272392833&4294967295,L=T+(A<<11&4294967295|A>>>21),A=V+(L^T^I)+P[11]+1839030562&4294967295,V=L+(A<<16&4294967295|A>>>16),A=I+(V^L^T)+P[14]+4259657740&4294967295,I=V+(A<<23&4294967295|A>>>9),A=T+(I^V^L)+P[1]+2763975236&4294967295,T=I+(A<<4&4294967295|A>>>28),A=L+(T^I^V)+P[4]+1272893353&4294967295,L=T+(A<<11&4294967295|A>>>21),A=V+(L^T^I)+P[7]+4139469664&4294967295,V=L+(A<<16&4294967295|A>>>16),A=I+(V^L^T)+P[10]+3200236656&4294967295,I=V+(A<<23&4294967295|A>>>9),A=T+(I^V^L)+P[13]+681279174&4294967295,T=I+(A<<4&4294967295|A>>>28),A=L+(T^I^V)+P[0]+3936430074&4294967295,L=T+(A<<11&4294967295|A>>>21),A=V+(L^T^I)+P[3]+3572445317&4294967295,V=L+(A<<16&4294967295|A>>>16),A=I+(V^L^T)+P[6]+76029189&4294967295,I=V+(A<<23&4294967295|A>>>9),A=T+(I^V^L)+P[9]+3654602809&4294967295,T=I+(A<<4&4294967295|A>>>28),A=L+(T^I^V)+P[12]+3873151461&4294967295,L=T+(A<<11&4294967295|A>>>21),A=V+(L^T^I)+P[15]+530742520&4294967295,V=L+(A<<16&4294967295|A>>>16),A=I+(V^L^T)+P[2]+3299628645&4294967295,I=V+(A<<23&4294967295|A>>>9),A=T+(V^(I|~L))+P[0]+4096336452&4294967295,T=I+(A<<6&4294967295|A>>>26),A=L+(I^(T|~V))+P[7]+1126891415&4294967295,L=T+(A<<10&4294967295|A>>>22),A=V+(T^(L|~I))+P[14]+2878612391&4294967295,V=L+(A<<15&4294967295|A>>>17),A=I+(L^(V|~T))+P[5]+4237533241&4294967295,I=V+(A<<21&4294967295|A>>>11),A=T+(V^(I|~L))+P[12]+1700485571&4294967295,T=I+(A<<6&4294967295|A>>>26),A=L+(I^(T|~V))+P[3]+2399980690&4294967295,L=T+(A<<10&4294967295|A>>>22),A=V+(T^(L|~I))+P[10]+4293915773&4294967295,V=L+(A<<15&4294967295|A>>>17),A=I+(L^(V|~T))+P[1]+2240044497&4294967295,I=V+(A<<21&4294967295|A>>>11),A=T+(V^(I|~L))+P[8]+1873313359&4294967295,T=I+(A<<6&4294967295|A>>>26),A=L+(I^(T|~V))+P[15]+4264355552&4294967295,L=T+(A<<10&4294967295|A>>>22),A=V+(T^(L|~I))+P[6]+2734768916&4294967295,V=L+(A<<15&4294967295|A>>>17),A=I+(L^(V|~T))+P[13]+1309151649&4294967295,I=V+(A<<21&4294967295|A>>>11),A=T+(V^(I|~L))+P[4]+4149444226&4294967295,T=I+(A<<6&4294967295|A>>>26),A=L+(I^(T|~V))+P[11]+3174756917&4294967295,L=T+(A<<10&4294967295|A>>>22),A=V+(T^(L|~I))+P[2]+718787259&4294967295,V=L+(A<<15&4294967295|A>>>17),A=I+(L^(V|~T))+P[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(V+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.v=function(C,T){T===void 0&&(T=C.length);const I=T-this.blockSize,P=this.C;let V=this.h,L=0;for(;L<T;){if(V==0)for(;L<=I;)l(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<T;)if(P[V++]=C.charCodeAt(L++),V==this.blockSize){l(this,P),V=0;break}}else for(;L<T;)if(P[V++]=C[L++],V==this.blockSize){l(this,P),V=0;break}}this.h=V,this.o+=T},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;T=this.o*8;for(var I=C.length-8;I<C.length;++I)C[I]=T&255,T/=256;for(this.v(C),C=Array(16),T=0,I=0;I<4;++I)for(let P=0;P<32;P+=8)C[T++]=this.g[I]>>>P&255;return C};function u(C,T){var I=p;return Object.prototype.hasOwnProperty.call(I,C)?I[C]:I[C]=T(C)}function d(C,T){this.h=T;const I=[];let P=!0;for(let V=C.length-1;V>=0;V--){const L=C[V]|0;P&&L==T||(I[V]=L,P=!1)}this.g=I}var p={};function y(C){return-128<=C&&C<128?u(C,function(T){return new d([T|0],T<0?-1:0)}):new d([C|0],C<0?-1:0)}function g(C){if(isNaN(C)||!isFinite(C))return k;if(C<0)return U(g(-C));const T=[];let I=1;for(let P=0;C>=I;P++)T[P]=C/I|0,I*=4294967296;return new d(T,0)}function b(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return U(b(C.substring(1),T));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=g(Math.pow(T,8));let P=k;for(let L=0;L<C.length;L+=8){var V=Math.min(8,C.length-L);const A=parseInt(C.substring(L,L+V),T);V<8?(V=g(Math.pow(T,V)),P=P.j(V).add(g(A))):(P=P.j(I),P=P.add(g(A)))}return P}var k=y(0),S=y(1),R=y(16777216);s=d.prototype,s.m=function(){if($(this))return-U(this).m();let C=0,T=1;for(let I=0;I<this.g.length;I++){const P=this.i(I);C+=(P>=0?P:4294967296+P)*T,T*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(q(this))return"0";if($(this))return"-"+U(this).toString(C);const T=g(Math.pow(C,6));var I=this;let P="";for(;;){const V=me(I,T).g;I=W(I,V.j(T));let L=((I.g.length>0?I.g[0]:I.h)>>>0).toString(C);if(I=V,q(I))return L+P;for(;L.length<6;)L="0"+L;P=L+P}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function q(C){if(C.h!=0)return!1;for(let T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function $(C){return C.h==-1}s.l=function(C){return C=W(this,C),$(C)?-1:q(C)?0:1};function U(C){const T=C.g.length,I=[];for(let P=0;P<T;P++)I[P]=~C.g[P];return new d(I,~C.h).add(S)}s.abs=function(){return $(this)?U(this):this},s.add=function(C){const T=Math.max(this.g.length,C.g.length),I=[];let P=0;for(let V=0;V<=T;V++){let L=P+(this.i(V)&65535)+(C.i(V)&65535),A=(L>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);P=A>>>16,L&=65535,A&=65535,I[V]=A<<16|L}return new d(I,I[I.length-1]&-2147483648?-1:0)};function W(C,T){return C.add(U(T))}s.j=function(C){if(q(this)||q(C))return k;if($(this))return $(C)?U(this).j(U(C)):U(U(this).j(C));if($(C))return U(this.j(U(C)));if(this.l(R)<0&&C.l(R)<0)return g(this.m()*C.m());const T=this.g.length+C.g.length,I=[];for(var P=0;P<2*T;P++)I[P]=0;for(P=0;P<this.g.length;P++)for(let V=0;V<C.g.length;V++){const L=this.i(P)>>>16,A=this.i(P)&65535,De=C.i(V)>>>16,tt=C.i(V)&65535;I[2*P+2*V]+=A*tt,G(I,2*P+2*V),I[2*P+2*V+1]+=L*tt,G(I,2*P+2*V+1),I[2*P+2*V+1]+=A*De,G(I,2*P+2*V+1),I[2*P+2*V+2]+=L*De,G(I,2*P+2*V+2)}for(C=0;C<T;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=T;C<2*T;C++)I[C]=0;return new d(I,0)};function G(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function Q(C,T){this.g=C,this.h=T}function me(C,T){if(q(T))throw Error("division by zero");if(q(C))return new Q(k,k);if($(C))return T=me(U(C),T),new Q(U(T.g),U(T.h));if($(T))return T=me(C,U(T)),new Q(U(T.g),T.h);if(C.g.length>30){if($(C)||$(T))throw Error("slowDivide_ only works with positive integers.");for(var I=S,P=T;P.l(C)<=0;)I=ke(I),P=ke(P);var V=xe(I,1),L=xe(P,1);for(P=xe(P,2),I=xe(I,2);!q(P);){var A=L.add(P);A.l(C)<=0&&(V=V.add(I),L=A),P=xe(P,1),I=xe(I,1)}return T=W(C,V.j(T)),new Q(V,T)}for(V=k;C.l(T)>=0;){for(I=Math.max(1,Math.floor(C.m()/T.m())),P=Math.ceil(Math.log(I)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),L=g(I),A=L.j(T);$(A)||A.l(C)>0;)I-=P,L=g(I),A=L.j(T);q(L)&&(L=S),V=V.add(L),C=W(C,A)}return new Q(V,C)}s.B=function(C){return me(this,C).h},s.and=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let P=0;P<T;P++)I[P]=this.i(P)&C.i(P);return new d(I,this.h&C.h)},s.or=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let P=0;P<T;P++)I[P]=this.i(P)|C.i(P);return new d(I,this.h|C.h)},s.xor=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let P=0;P<T;P++)I[P]=this.i(P)^C.i(P);return new d(I,this.h^C.h)};function ke(C){const T=C.g.length+1,I=[];for(let P=0;P<T;P++)I[P]=C.i(P)<<1|C.i(P-1)>>>31;return new d(I,C.h)}function xe(C,T){const I=T>>5;T%=32;const P=C.g.length-I,V=[];for(let L=0;L<P;L++)V[L]=T>0?C.i(L+I)>>>T|C.i(L+I+1)<<32-T:C.i(L+I);return new d(V,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,N_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,Ja=d}).apply(typeof P2<"u"?P2:typeof self<"u"?self:typeof window<"u"?window:{});var oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var A_,nu,R_,jh,Cg,I_,M_,D_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof oh=="object"&&oh];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var N=0;N<h.length-1;N++){var ee=h[N];if(!(ee in _))break e;_=_[ee]}h=h[h.length-1],N=_[h],v=v(N),v!=N&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,_){return h.call.apply(h.bind,arguments)}function g(h,v,_){return g=y,g.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function k(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(N,ee,he){for(var Pe=Array(arguments.length-2),At=2;At<arguments.length;At++)Pe[At-2]=arguments[At];return v.prototype[ee].apply(N,Pe)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const v=h.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=h[N];return _}return[]}function q(h,v){for(let N=1;N<arguments.length;N++){const ee=arguments[N];var _=typeof ee;if(_=_!="object"?_:ee?Array.isArray(ee)?"array":_:"null",_=="array"||_=="object"&&typeof ee.length=="number"){_=h.length||0;const he=ee.length||0;h.length=_+he;for(let Pe=0;Pe<he;Pe++)h[_+Pe]=ee[Pe]}else h.push(ee)}}class ${constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function U(h){d.setTimeout(()=>{throw h},0)}function W(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class G{constructor(){this.h=this.g=null}add(v,_){const N=Q.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var Q=new $(()=>new me,h=>h.reset());class me{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ke,xe=!1,C=new G,T=()=>{const h=Promise.resolve(void 0);ke=()=>{h.then(I)}};function I(){for(var h;h=W();){try{h.h.call(h.g)}catch(_){U(_)}var v=Q;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}xe=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function De(h,v){V.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}k(De,V),De.prototype.init=function(h,v){const _=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var tt="closure_listenable_"+(Math.random()*1e6|0),X=0;function Ce(h,v,_,N,ee){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=ee,this.key=++X,this.da=this.fa=!1}function Me(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Re(h,v,_){for(const N in h)v.call(_,h[N],N,h)}function Z(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function O(h){const v={};for(const _ in h)v[_]=h[_];return v}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ee(h,v){let _,N;for(let ee=1;ee<arguments.length;ee++){N=arguments[ee];for(_ in N)h[_]=N[_];for(let he=0;he<se.length;he++)_=se[he],Object.prototype.hasOwnProperty.call(N,_)&&(h[_]=N[_])}}function Se(h){this.src=h,this.g={},this.h=0}Se.prototype.add=function(h,v,_,N,ee){const he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);const Pe=Ne(h,v,N,ee);return Pe>-1?(v=h[Pe],_||(v.fa=!1)):(v=new Ce(v,this.src,he,!!N,ee),v.fa=_,h.push(v)),v};function ye(h,v){const _=v.type;if(_ in h.g){var N=h.g[_],ee=Array.prototype.indexOf.call(N,v,void 0),he;(he=ee>=0)&&Array.prototype.splice.call(N,ee,1),he&&(Me(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ne(h,v,_,N){for(let ee=0;ee<h.length;++ee){const he=h[ee];if(!he.da&&he.listener==v&&he.capture==!!_&&he.ha==N)return ee}return-1}var Ve="closure_lm_"+(Math.random()*1e6|0),We={};function Ue(h,v,_,N,ee){if(Array.isArray(v)){for(let he=0;he<v.length;he++)Ue(h,v[he],_,N,ee);return null}return _=Cn(_),h&&h[tt]?h.J(v,_,p(N)?!!N.capture:!1,ee):Ut(h,v,_,!1,N,ee)}function Ut(h,v,_,N,ee,he){if(!v)throw Error("Invalid event type");const Pe=p(ee)?!!ee.capture:!!ee;let At=Xt(h);if(At||(h[Ve]=At=new Se(h)),_=At.add(v,_,N,Pe,he),_.proxy)return _;if(N=St(),_.proxy=N,N.src=h,N.listener=_,h.addEventListener)L||(ee=Pe),ee===void 0&&(ee=!1),h.addEventListener(v.toString(),N,ee);else if(h.attachEvent)h.attachEvent(Pt(v.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function St(){function h(_){return v.call(h.src,h.listener,_)}const v=kt;return h}function Tn(h,v,_,N,ee){if(Array.isArray(v))for(var he=0;he<v.length;he++)Tn(h,v[he],_,N,ee);else N=p(N)?!!N.capture:!!N,_=Cn(_),h&&h[tt]?(h=h.i,he=String(v).toString(),he in h.g&&(v=h.g[he],_=Ne(v,_,N,ee),_>-1&&(Me(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[he],h.h--)))):h&&(h=Xt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ne(v,_,N,ee)),(_=h>-1?v[h]:null)&&Un(_))}function Un(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[tt])ye(v.i,h);else{var _=h.type,N=h.proxy;v.removeEventListener?v.removeEventListener(_,N,h.capture):v.detachEvent?v.detachEvent(Pt(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=Xt(v))?(ye(_,h),_.h==0&&(_.src=null,v[Ve]=null)):Me(h)}}}function Pt(h){return h in We?We[h]:We[h]="on"+h}function kt(h,v){if(h.da)h=!0;else{v=new De(v,this);const _=h.listener,N=h.ha||h.src;h.fa&&Un(h),h=_.call(N,v)}return h}function Xt(h){return h=h[Ve],h instanceof Se?h:null}var Ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function Cn(h){return typeof h=="function"?h:(h[Ge]||(h[Ge]=function(v){return h.handleEvent(v)}),h[Ge])}function le(){P.call(this),this.i=new Se(this),this.M=this,this.G=null}k(le,P),le.prototype[tt]=!0,le.prototype.removeEventListener=function(h,v,_,N){Tn(this,h,v,_,N)};function It(h,v){var _,N=h.G;if(N)for(_=[];N;N=N.G)_.push(N);if(h=h.M,N=v.type||v,typeof v=="string")v=new V(v,h);else if(v instanceof V)v.target=v.target||h;else{var ee=v;v=new V(N,h),Ee(v,ee)}ee=!0;let he,Pe;if(_)for(Pe=_.length-1;Pe>=0;Pe--)he=v.g=_[Pe],ee=Nt(he,N,!0,v)&&ee;if(he=v.g=h,ee=Nt(he,N,!0,v)&&ee,ee=Nt(he,N,!1,v)&&ee,_)for(Pe=0;Pe<_.length;Pe++)he=v.g=_[Pe],ee=Nt(he,N,!1,v)&&ee}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let N=0;N<_.length;N++)Me(_[N]);delete h.g[v],h.h--}}this.G=null},le.prototype.J=function(h,v,_,N){return this.i.add(String(h),v,!1,_,N)},le.prototype.K=function(h,v,_,N){return this.i.add(String(h),v,!0,_,N)};function Nt(h,v,_,N){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let ee=!0;for(let he=0;he<v.length;++he){const Pe=v[he];if(Pe&&!Pe.da&&Pe.capture==_){const At=Pe.listener,rs=Pe.ha||Pe.src;Pe.fa&&ye(h.i,Pe),ee=At.call(rs,N)!==!1&&ee}}return ee&&!N.defaultPrevented}function gt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function Ye(h){h.g=gt(()=>{h.g=null,h.i&&(h.i=!1,Ye(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class ot extends P{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Ye(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nn(h){P.call(this),this.h=h,this.g={}}k(nn,P);var Jt=[];function Jn(h){Re(h.g,function(v,_){this.g.hasOwnProperty(_)&&Un(v)},h),h.g={}}nn.prototype.N=function(){nn.Z.N.call(this),Jn(this)},nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nn=d.JSON.stringify,cs=d.JSON.parse,Zn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Hn(){}function Bn(){}var rn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Bt(){V.call(this,"d")}k(Bt,V);function vt(){V.call(this,"c")}k(vt,V);var Ct={},J=null;function Ae(){return J=J||new le}Ct.Ia="serverreachability";function ht(h){V.call(this,Ct.Ia,h)}k(ht,V);function xt(h){const v=Ae();It(v,new ht(v))}Ct.STAT_EVENT="statevent";function ft(h,v){V.call(this,Ct.STAT_EVENT,h),this.stat=v}k(ft,V);function st(h){const v=Ae();It(v,new ft(v,h))}Ct.Ja="timingevent";function nt(h,v){V.call(this,Ct.Ja,h),this.size=v}k(nt,V);function yt(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Zt(){this.g=!0}Zt.prototype.ua=function(){this.g=!1};function fn(h,v,_,N,ee,he){h.info(function(){if(h.g)if(he){var Pe="",At=he.split("&");for(let dn=0;dn<At.length;dn++){var rs=At[dn].split("=");if(rs.length>1){const zn=rs[0];rs=rs[1];const Lr=zn.split("_");Pe=Lr.length>=2&&Lr[1]=="type"?Pe+(zn+"="+rs+"&"):Pe+(zn+"=redacted&")}}}else Pe=null;else Pe=he;return"XMLHTTP REQ ("+N+") [attempt "+ee+"]: "+v+`
`+_+`
`+Pe})}function Rn(h,v,_,N,ee,he,Pe){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+ee+"]: "+v+`
`+_+`
`+he+" "+Pe})}function ae(h,v,_,N){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Qe(h,_)+(N?" "+N:"")})}function Ie(h,v){h.info(function(){return"TIMEOUT: "+v})}Zt.prototype.info=function(){};function Qe(h,v){if(!h.g)return v;if(!v)return null;try{const he=JSON.parse(v);if(he){for(h=0;h<he.length;h++)if(Array.isArray(he[h])){var _=he[h];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var ee=N[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let Pe=1;Pe<N.length;Pe++)N[Pe]=""}}}}return Nn(he)}catch{return v}}var lt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},at={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Vt;function en(){}k(en,Hn),en.prototype.g=function(){return new XMLHttpRequest},Vt=new en;function zt(h){return encodeURIComponent(String(h))}function mn(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function In(h,v,_,N){this.j=h,this.i=v,this.l=_,this.S=N||1,this.V=new nn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Mn}function Mn(){this.i=null,this.g="",this.h=!1}var yn={},cn={};function ws(h,v,_){h.M=1,h.A=bt(re(v)),h.u=_,h.R=!0,Ls(h,null)}function Ls(h,v){h.F=Date.now(),Ns(h),h.B=re(h.A);var _=h.B,N=h.S;Array.isArray(N)||(N=[String(N)]),ti(_.i,"t",N),h.C=0,_=h.j.L,h.h=new Mn,h.g=Ju(h.j,_?v:null,!h.u),h.P>0&&(h.O=new ot(g(h.Y,h,h.g),h.P)),v=h.V,_=h.g,N=h.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(Jt[0]=ee.toString()),ee=Jt);for(let he=0;he<ee.length;he++){const Pe=Ue(_,ee[he],N||v.handleEvent,!1,v.h||v);if(!Pe)break;v.g[Pe.key]=Pe}v=h.J?O(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),xt(),fn(h.i,h.v,h.B,h.l,h.S,h.u)}In.prototype.ba=function(h){h=h.target;const v=this.O;v&&ct(h)==3?v.j():this.Y(h)},In.prototype.Y=function(h){try{if(h==this.g)e:{const At=ct(this.g),rs=this.g.ya(),dn=this.g.ca();if(!(At<3)&&(At!=3||this.g&&(this.h.h||this.g.la()||Et(this.g)))){this.K||At!=4||rs==7||(rs==8||dn<=0?xt(3):xt(2)),us(this);var v=this.g.ca();this.X=v;var _=Qr(this);if(this.o=v==200,Rn(this.i,this.v,this.B,this.l,this.S,At,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,ee=this.g;if((N=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var he=N;break t}}he=null}if(h=he)ae(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,es(this,h);else{this.o=!1,this.m=3,st(12),Dn(this),Wn(this);break e}}if(this.R){h=!0;let zn;for(;!this.K&&this.C<_.length;)if(zn=gi(this,_),zn==cn){At==4&&(this.m=4,st(14),h=!1),ae(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==yn){this.m=4,st(15),ae(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else ae(this.i,this.l,zn,null),es(this,zn);if(Oi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),At!=4||_.length!=0||this.h.h||(this.m=1,st(16),h=!1),this.o=this.o&&h,!h)ae(this.i,this.l,_,"[Invalid Chunked Response]"),Dn(this),Wn(this);else if(_.length>0&&!this.W){this.W=!0;var Pe=this.j;Pe.g==this&&Pe.aa&&!Pe.P&&(Pe.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),lc(Pe),Pe.P=!0,st(11))}}else ae(this.i,this.l,_,null),es(this,_);At==4&&Dn(this),this.o&&!this.K&&(At==4?Ku(this.j,this):(this.o=!1,Ns(this)))}else Ln(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,st(12)):(this.m=0,st(13)),Dn(this),Wn(this)}}}catch{}};function Qr(h){if(!Oi(h))return h.g.la();const v=Et(h.g);if(v==="")return"";let _="";const N=v.length,ee=ct(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Dn(h),Wn(h),"";h.h.i=new d.TextDecoder}for(let he=0;he<N;he++)h.h.h=!0,_+=h.h.i.decode(v[he],{stream:!(ee&&he==N-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function Oi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function gi(h,v){var _=h.C,N=v.indexOf(`
`,_);return N==-1?cn:(_=Number(v.substring(_,N)),isNaN(_)?yn:(N+=1,N+_>v.length?cn:(v=v.slice(N,N+_),h.C=N+_,v)))}In.prototype.cancel=function(){this.K=!0,Dn(this)};function Ns(h){h.T=Date.now()+h.H,xs(h,h.H)}function xs(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=yt(g(h.aa,h),v)}function us(h){h.D&&(d.clearTimeout(h.D),h.D=null)}In.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ie(this.i,this.B),this.M!=2&&(xt(),st(17)),Dn(this),this.m=2,Wn(this)):xs(this,this.T-h)};function Wn(h){h.j.I==0||h.K||Ku(h.j,h)}function Dn(h){us(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,Jn(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function es(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||ks(_.h,h))){if(!h.L&&ks(_.h,h)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var ee=N;if(ee[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)el(_),jn(_);else break e;ho(_),st(18)}}else _.xa=ee[1],0<_.xa-_.K&&ee[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=yt(g(_.Va,_),6e3));_s(_.h)<=1&&_.ta&&(_.ta=void 0)}else vi(_,11)}else if((h.L||_.g==h)&&el(_),!A(v))for(ee=_.Ba.g.parse(v),v=0;v<ee.length;v++){let dn=ee[v];const zn=dn[0];if(!(zn<=_.K))if(_.K=zn,dn=dn[1],_.I==2)if(dn[0]=="c"){_.M=dn[1],_.ba=dn[2];const Lr=dn[3];Lr!=null&&(_.ka=Lr,_.j.info("VER="+_.ka));const bi=dn[4];bi!=null&&(_.za=bi,_.j.info("SVER="+_.za));const si=dn[5];si!=null&&typeof si=="number"&&si>0&&(N=1.5*si,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const ri=h.g;if(ri){const fo=ri.g?ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fo){var he=N.h;he.g||fo.indexOf("spdy")==-1&&fo.indexOf("quic")==-1&&fo.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Es(he,he.h),he.h=null))}if(N.G){const tl=ri.g?ri.g.getResponseHeader("X-HTTP-Session-Id"):null;tl&&(N.wa=tl,et(N.J,N.G,tl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Pe=h;if(N.na=Xu(N,N.L?N.ba:null,N.W),Pe.L){Os(N.h,Pe);var At=Pe,rs=N.O;rs&&(At.H=rs),At.D&&(us(At),Ns(At)),N.g=Pe}else Wu(N);_.i.length>0&&Ts(_)}else dn[0]!="stop"&&dn[0]!="close"||vi(_,7);else _.I==3&&(dn[0]=="stop"||dn[0]=="close"?dn[0]=="stop"?vi(_,7):On(_):dn[0]!="noop"&&_.l&&_.l.qa(dn),_.A=0)}}xt(4)}catch{}}var un=class{constructor(h,v){this.g=h,this.map=v}};function ts(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function _s(h){return h.h?1:h.g?h.g.size:0}function ks(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Es(h,v){h.g?h.g.add(v):h.h=v}function Os(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ts.prototype.cancel=function(){if(this.i=Jr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Jr(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return R(h.i)}var M=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function F(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const N=h[_].indexOf("=");let ee,he=null;N>=0?(ee=h[_].substring(0,N),he=h[_].substring(N+1)):ee=h[_],v(ee,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function te(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof te?(this.l=h.l,Be(this,h.j),this.o=h.o,this.g=h.g,ze(this,h.u),this.h=h.h,He(this,Ps(h.i)),this.m=h.m):h&&(v=String(h).match(M))?(this.l=!1,Be(this,v[1]||"",!0),this.o=wn(v[2]||""),this.g=wn(v[3]||"",!0),ze(this,v[4]),this.h=wn(v[5]||"",!0),He(this,v[6]||"",!0),this.m=wn(v[7]||"")):(this.l=!1,this.i=new tr(null,this.l))}te.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(As(v,er,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(As(v,er,!0),"@"),h.push(zt(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(As(_,_.charAt(0)=="/"?Dr:Zr,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",As(_,Ws)),h.join("")},te.prototype.resolve=function(h){const v=re(this);let _=!!h.j;_?Be(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var N=h.h;if(_)ze(v,h.u);else if(_=!!h.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var ee=v.h.lastIndexOf("/");ee!=-1&&(N=v.h.slice(0,ee+1)+N)}if(ee=N,ee==".."||ee==".")N="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){N=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const he=[];for(let Pe=0;Pe<ee.length;){const At=ee[Pe++];At=="."?N&&Pe==ee.length&&he.push(""):At==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),N&&Pe==ee.length&&he.push("")):(he.push(At),N=!0)}N=he.join("/")}else N=ee}return _?v.h=N:_=h.i.toString()!=="",_?He(v,Ps(h.i)):_=!!h.m,_&&(v.m=h.m),v};function re(h){return new te(h)}function Be(h,v,_){h.j=_?wn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function ze(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function He(h,v,_){v instanceof tr?(h.i=v,ni(h.i,h.l)):(_||(v=As(v,wr)),h.i=new tr(v,h.l))}function et(h,v,_){h.i.set(v,_)}function bt(h){return et(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function wn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function As(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,ns),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ns(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var er=/[#\/\?@]/g,Zr=/[#\?:]/g,Dr=/[#\?]/g,wr=/[#\?@]/g,Ws=/#/g;function tr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Rs(h){h.g||(h.g=new Map,h.h=0,h.i&&F(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=tr.prototype,s.add=function(h,v){Rs(this),this.i=null,h=xr(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function Pi(h,v){Rs(h),v=xr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Vi(h,v){return Rs(h),v=xr(h,v),h.g.has(v)}s.forEach=function(h,v){Rs(this),this.g.forEach(function(_,N){_.forEach(function(ee){h.call(v,ee,N,this)},this)},this)};function ei(h,v){Rs(h);let _=[];if(typeof v=="string")Vi(h,v)&&(_=_.concat(h.g.get(xr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Rs(this),this.i=null,h=xr(this,h),Vi(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=ei(this,h),h.length>0?String(h[0]):v):v};function ti(h,v,_){Pi(h,v),_.length>0&&(h.i=null,h.g.set(xr(h,v),R(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const ee=zt(_);_=ei(this,_);for(let he=0;he<_.length;he++){let Pe=ee;_[he]!==""&&(Pe+="="+zt(_[he])),h.push(Pe)}}return this.i=h.join("&")};function Ps(h){const v=new tr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function xr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function ni(h,v){v&&!h.j&&(Rs(h),h.i=null,h.g.forEach(function(_,N){const ee=N.toLowerCase();N!=ee&&(Pi(this,N),ti(this,ee,_))},h)),h.j=v}function nr(h,v){const _=new Zt;if(d.Image){const N=new Image;N.onload=b(z,_,"TestLoadImage: loaded",!0,v,N),N.onerror=b(z,_,"TestLoadImage: error",!1,v,N),N.onabort=b(z,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(z,_,"TestLoadImage: timeout",!1,v,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else v(!1)}function sr(h,v){const _=new Zt,N=new AbortController,ee=setTimeout(()=>{N.abort(),z(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:N.signal}).then(he=>{clearTimeout(ee),he.ok?z(_,"TestPingServer: ok",!0,v):z(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),z(_,"TestPingServer: error",!1,v)})}function z(h,v,_,N,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),N(_)}catch{}}function de(){this.g=new Zn}function ce(h){this.i=h.Sb||null,this.h=h.ab||!1}k(ce,Hn),ce.prototype.g=function(){return new E(this.i,this.h)};function E(h,v){le.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(E,le),s=E.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,ue(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,K(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ue(this)),this.g&&(this.readyState=3,ue(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;D(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function D(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?K(this):ue(this),this.readyState==3&&D(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,K(this))},s.Na=function(h){this.g&&(this.response=h,K(this))},s.ga=function(){this.g&&K(this)};function K(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ue(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function ue(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(E.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Te(h){let v="";return Re(h,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function Le(h,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=Te(_),typeof h=="string"?_!=null&&zt(_):et(h,v,_))}function be(h){le.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(be,le);var Oe=/^https?$/i,Je=["POST","PUT"];s=be.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Vt.g(),this.g.onreadystatechange=S(g(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(he){Lt(this,he);return}if(h=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var ee in N)_.set(ee,N[ee]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const he of N.keys())_.set(he,N.get(he));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(he=>he.toLowerCase()=="content-type"),ee=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Je,v,void 0)>=0)||N||ee||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Pe]of _)this.g.setRequestHeader(he,Pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(he){Lt(this,he)}};function Lt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,Xe(h),an(h)}function Xe(h){h.A||(h.A=!0,It(h,"complete"),It(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,It(this,"complete"),It(this,"abort"),an(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),an(this,!0)),be.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ot(this):this.Xa())},s.Xa=function(){Ot(this)};function Ot(h){if(h.h&&typeof u<"u"){if(h.v&&ct(h)==4)setTimeout(h.Ca.bind(h),0);else if(It(h,"readystatechange"),ct(h)==4){h.h=!1;try{const he=h.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=he===0){let Pe=String(h.D).match(M)[1]||null;!Pe&&d.self&&d.self.location&&(Pe=d.self.location.protocol.slice(0,-1)),N=!Oe.test(Pe?Pe.toLowerCase():"")}_=N}if(_)It(h,"complete"),It(h,"success");else{h.o=6;try{var ee=ct(h)>2?h.g.statusText:""}catch{ee=""}h.l=ee+" ["+h.ca()+"]",Xe(h)}}finally{an(h)}}}}function an(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||It(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function ct(h){return h.g?h.g.readyState:0}s.ca=function(){try{return ct(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),cs(v)}};function Et(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ln(h){const v={};h=(h.g&&ct(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(A(h[N]))continue;var _=mn(h[N]);const ee=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const he=v[ee]||[];v[ee]=he,he.push(_)}Z(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ss(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function Vs(h){this.za=0,this.i=[],this.j=new Zt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ss("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ss("baseRetryDelayMs",5e3,h),this.Za=ss("retryDelaySeedMs",1e4,h),this.Ta=ss("forwardChannelMaxRetries",2,h),this.va=ss("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ts(h&&h.concurrentRequestLimit),this.Ba=new de,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Vs.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,N){st(0),this.W=h,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Xu(this,null,this.W),Ts(this)};function On(h){if(ds(h),h.I==3){var v=h.V++,_=re(h.J);if(et(_,"SID",h.M),et(_,"RID",v),et(_,"TYPE","terminate"),uo(h,_),v=new In(h,h.j,v),v.M=2,v.A=bt(re(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=Ju(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Ns(v)}Qu(h)}function jn(h){h.g&&(lc(h),h.g.cancel(),h.g=null)}function ds(h){jn(h),h.v&&(d.clearTimeout(h.v),h.v=null),el(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Ts(h){if(!Xr(h.h)&&!h.m){h.m=!0;var v=h.Ea;ke||T(),xe||(ke(),xe=!0),C.add(v,h),h.D=0}}function yi(h,v){return _s(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=yt(g(h.Ea,h,v),Yu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ee=new In(this,this.j,h);let he=this.o;if(this.U&&(he?(he=O(he),Ee(he,this.U)):he=this.U),this.u!==null||this.R||(ee.J=he,he=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=$u(this,ee,v),_=re(this.J),et(_,"RID",h),et(_,"CVER",22),this.G&&et(_,"X-HTTP-Session-Id",this.G),uo(this,_),he&&(this.R?v="headers="+zt(Te(he))+"&"+v:this.u&&Le(_,this.u,he)),Es(this.h,ee),this.Ra&&et(_,"TYPE","init"),this.S?(et(_,"$req",v),et(_,"SID","null"),ee.U=!0,ws(ee,_,null)):ws(ee,_,v),this.I=2}}else this.I==3&&(h?Ui(this,h):this.i.length==0||Xr(this.h)||Ui(this))};function Ui(h,v){var _;v?_=v.l:_=h.V++;const N=re(h.J);et(N,"SID",h.M),et(N,"RID",_),et(N,"AID",h.K),uo(h,N),h.u&&h.o&&Le(N,h.u,h.o),_=new In(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=$u(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Es(h.h,_),ws(_,N,v)}function uo(h,v){h.H&&Re(h.H,function(_,N){et(v,N,_)}),h.l&&Re({},function(_,N){et(v,N,_)})}function $u(h,v,_){_=Math.min(h.i.length,_);const N=h.l?g(h.l.Ka,h.l,h):null;e:{var ee=h.i;let At=-1;for(;;){const rs=["count="+_];At==-1?_>0?(At=ee[0].g,rs.push("ofs="+At)):At=0:rs.push("ofs="+At);let dn=!0;for(let zn=0;zn<_;zn++){var he=ee[zn].g;const Lr=ee[zn].map;if(he-=At,he<0)At=Math.max(0,ee[zn].g-100),dn=!1;else try{he="req"+he+"_"||"";try{var Pe=Lr instanceof Map?Lr:Object.entries(Lr);for(const[bi,si]of Pe){let ri=si;p(si)&&(ri=Nn(si)),rs.push(he+bi+"="+encodeURIComponent(ri))}}catch(bi){throw rs.push(he+"type="+encodeURIComponent("_badmap")),bi}}catch{N&&N(Lr)}}if(dn){Pe=rs.join("&");break e}}Pe=void 0}return h=h.i.splice(0,_),v.G=h,Pe}function Wu(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;ke||T(),xe||(ke(),xe=!0),C.add(v,h),h.A=0}}function ho(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=yt(g(h.Da,h),Yu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Gu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=yt(g(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,st(10),jn(this),Gu(this))};function lc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Gu(h){h.g=new In(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=re(h.na);et(v,"RID","rpc"),et(v,"SID",h.M),et(v,"AID",h.K),et(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&et(v,"TO",h.ia),et(v,"TYPE","xmlhttp"),uo(h,v),h.u&&h.o&&Le(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=bt(re(v)),_.u=null,_.R=!0,Ls(_,h)}s.Va=function(){this.C!=null&&(this.C=null,jn(this),ho(this),st(19))};function el(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Ku(h,v){var _=null;if(h.g==v){el(h),lc(h),h.g=null;var N=2}else if(ks(h.h,v))_=v.G,Os(h.h,v),N=1;else return;if(h.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var ee=h.D;N=Ae(),It(N,new nt(N,_)),Ts(h)}else Wu(h);else if(ee=v.m,ee==3||ee==0&&v.X>0||!(N==1&&yi(h,v)||N==2&&ho(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),ee){case 1:vi(h,5);break;case 4:vi(h,10);break;case 3:vi(h,6);break;default:vi(h,2)}}}function Yu(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function vi(h,v){if(h.j.info("Error code "+v),v==2){var _=g(h.bb,h),N=h.Ua;const ee=!N;N=new te(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Be(N,"https"),bt(N),ee?nr(N.toString(),_):sr(N.toString(),_)}else st(2);h.I=0,h.l&&h.l.pa(v),Qu(h),ds(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function Qu(h){if(h.I=0,h.ja=[],h.l){const v=Jr(h.h);(v.length!=0||h.i.length!=0)&&(q(h.ja,v),q(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function Xu(h,v,_){var N=_ instanceof te?re(_):new te(_);if(N.g!="")v&&(N.g=v+"."+N.g),ze(N,N.u);else{var ee=d.location;N=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;const he=new te(null);N&&Be(he,N),v&&(he.g=v),ee&&ze(he,ee),_&&(he.h=_),N=he}return _=h.G,v=h.wa,_&&v&&et(N,_,v),et(N,"VER",h.ka),uo(h,N),N}function Ju(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new be(new ce({ab:_})):new be(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}s=Zu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function va(){}va.prototype.g=function(h,v){return new rr(h,v)};function rr(h,v){le.call(this),this.g=new Vs(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Bi(this)}k(rr,le),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){On(this.g)},rr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Nn(h),h=_);v.i.push(new un(v.Ya++,h)),v.I==3&&Ts(v)},rr.prototype.N=function(){this.g.l=null,delete this.j,On(this.g),delete this.g,rr.Z.N.call(this)};function ed(h){Bt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}k(ed,Bt);function td(){vt.call(this),this.status=1}k(td,vt);function Bi(h){this.g=h}k(Bi,Zu),Bi.prototype.ra=function(){It(this.g,"a")},Bi.prototype.qa=function(h){It(this.g,new ed(h))},Bi.prototype.pa=function(h){It(this.g,new td)},Bi.prototype.oa=function(){It(this.g,"b")},va.prototype.createWebChannel=va.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,D_=function(){return new va},M_=function(){return Ae()},I_=Ct,Cg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},lt.NO_ERROR=0,lt.TIMEOUT=8,lt.HTTP_ERROR=6,jh=lt,at.COMPLETE="complete",R_=at,Bn.EventType=rn,rn.OPEN="a",rn.CLOSE="b",rn.ERROR="c",rn.MESSAGE="d",le.prototype.listen=le.prototype.J,nu=Bn,be.prototype.listenOnce=be.prototype.K,be.prototype.getLastError=be.prototype.Ha,be.prototype.getLastErrorCode=be.prototype.ya,be.prototype.getStatus=be.prototype.ca,be.prototype.getResponseJson=be.prototype.La,be.prototype.getResponseText=be.prototype.la,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Fa,A_=be}).apply(typeof oh<"u"?oh:typeof self<"u"?self:typeof window<"u"?window:{});class Ys{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ys.UNAUTHENTICATED=new Ys(null),Ys.GOOGLE_CREDENTIALS=new Ys("google-credentials-uid"),Ys.FIRST_PARTY=new Ys("first-party-uid"),Ys.MOCK_USER=new Ys("mock-user");let nc="12.8.0";function hR(s){nc=s}const Bo=new oy("@firebase/firestore");function Ml(){return Bo.logLevel}function $e(s,...e){if(Bo.logLevel<=Wt.DEBUG){const t=e.map(by);Bo.debug(`Firestore (${nc}): ${s}`,...t)}}function fa(s,...e){if(Bo.logLevel<=Wt.ERROR){const t=e.map(by);Bo.error(`Firestore (${nc}): ${s}`,...t)}}function Hl(s,...e){if(Bo.logLevel<=Wt.WARN){const t=e.map(by);Bo.warn(`Firestore (${nc}): ${s}`,...t)}}function by(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function pt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,L_(s,i,t)}function L_(s,e,t){let i=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw fa(i),new Error(i)}function pn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||L_(e,l,i)}function jt(s,e){return s}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends pi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class la{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class O_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ys.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=Ys.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){pn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let u=new la;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new la,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=u;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},p=y=>{$e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>p(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?p(y):($e("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new la)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?($e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(pn(typeof i.accessToken=="string",31837,{l:i}),new O_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pn(e===null||typeof e=="string",2055,{h:e}),new Ys(e)}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ys.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new gR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ys.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){pn(this.o===void 0,3512);const i=u=>{u.error!=null&&$e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,$e("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{$e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):$e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new V2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(pn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new V2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Gt(s,e){return s<e?-1:s>e?1:0}function Ng(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return qp(l)===qp(u)?Gt(l,u):qp(l)?1:-1}return Gt(s.length,e.length)}const wR=55296,xR=57343;function qp(s){const e=s.charCodeAt(0);return e>=wR&&e<=xR}function $l(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const U2="__name__";class Ti{constructor(e,t,i){t===void 0?t=0:t>e.length&&pt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&pt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ti.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ti?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ti.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Gt(e.length,t.length)}static compareSegments(e,t){const i=Ti.isNumericId(e),l=Ti.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ti.extractNumericId(e).compare(Ti.extractNumericId(t)):Ng(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ja.fromString(e.substring(4,e.length-2))}}class An extends Ti{construct(e,t,i){return new An(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Fe(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new An(t)}static emptyPath(){return new An([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hs extends Ti{construct(e,t,i){return new Hs(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===U2}static keyField(){return new Hs([U2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new Fe(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new Fe(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new Fe(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new Fe(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hs(t)}static emptyPath(){return new Hs([])}}class it{constructor(e){this.path=e}static fromPath(e){return new it(An.fromString(e))}static fromName(e){return new it(An.fromString(e).popFirst(5))}static empty(){return new it(An.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&An.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return An.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new it(new An(e.slice()))}}function P_(s,e,t){if(!t)throw new Fe(ve.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function kR(s,e,t,i){if(e===!0&&i===!0)throw new Fe(ve.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function B2(s){if(!it.isDocumentKey(s))throw new Fe(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function z2(s){if(it.isDocumentKey(s))throw new Fe(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function V_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":pt(12329,{type:typeof s})}function lr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Fe(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(s);throw new Fe(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ER(s,e){if(e<=0)throw new Fe(ve.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function bs(s,e){const t={typeString:s};return e&&(t.value=e),t}function Ou(s,e){if(!V_(s))throw new Fe(ve.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Fe(ve.INVALID_ARGUMENT,t);return!0}const F2=-62135596800,q2=1e6;class Dt{static now(){return Dt.fromMillis(Date.now())}static fromDate(e){return Dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*q2);return new Dt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Fe(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Fe(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F2)throw new Fe(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q2}_compareTo(e){return this.seconds===e.seconds?Gt(this.nanoseconds,e.nanoseconds):Gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,Dt._jsonSchema))return new Dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-F2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Dt._jsonSchemaVersion="firestore/timestamp/1.0",Dt._jsonSchema={type:bs("string",Dt._jsonSchemaVersion),seconds:bs("number"),nanoseconds:bs("number")};class _t{static fromTimestamp(e){return new _t(e)}static min(){return new _t(new Dt(0,0))}static max(){return new _t(new Dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const yu=-1;function TR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=_t.fromTimestamp(i===1e9?new Dt(t+1,0):new Dt(t,i));return new eo(l,it.empty(),e)}function jR(s){return new eo(s.readTime,s.key,yu)}class eo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new eo(_t.min(),it.empty(),yu)}static max(){return new eo(_t.max(),it.empty(),yu)}}function SR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=it.comparator(s.documentKey,e.documentKey),t!==0?t:Gt(s.largestBatchId,e.largestBatchId))}const CR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function sc(s){if(s.code!==ve.FAILED_PRECONDITION||s.message!==CR)throw s;$e("LocalStore","Unexpectedly lost primary lease")}class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(t){return je.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):je.reject(t)}static resolve(e){return new je(((t,i)=>{t(e)}))}static reject(e){return new je(((t,i)=>{i(e)}))}static waitFor(e){return new je(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(y=>i(y)))})),d=!0,u===l&&t()}))}static or(e){let t=je.resolve(!1);for(const i of e)t=t.next((l=>l?je.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new je(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let y=0;y<u;y++){const g=y;t(e[g]).next((b=>{d[g]=b,++p,p===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new je(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function AR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rc(s){return s.name==="IndexedDbTransactionError"}class df{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const xy=-1;function hf(s){return s==null}function qh(s){return s===0&&1/s==-1/0}function RR(s){return typeof s=="number"&&Number.isInteger(s)&&!qh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const U_="";function IR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=H2(e)),e=MR(s.get(t),e);return H2(e)}function MR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case U_:t+="";break;default:t+=u}}return t}function H2(s){return s+U_+""}function $2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function lo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function B_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class $n{constructor(e,t){this.comparator=e,this.root=t||qs.EMPTY}insert(e,t){return new $n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qs.BLACK,null,null))}remove(e){return new $n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lh(this.root,e,this.comparator,!1)}getReverseIterator(){return new lh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lh(this.root,e,this.comparator,!0)}}class lh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??qs.RED,this.left=l??qs.EMPTY,this.right=u??qs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new qs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return qs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return qs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pt(27949);return e+(this.isRed()?0:1)}}qs.EMPTY=null,qs.RED=!0,qs.BLACK=!1;qs.EMPTY=new class{constructor(){this.size=0}get key(){throw pt(57766)}get value(){throw pt(16141)}get color(){throw pt(16727)}get left(){throw pt(29726)}get right(){throw pt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new qs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Cs{constructor(e){this.comparator=e,this.data=new $n(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new W2(this.data.getIterator())}getIteratorFrom(e){return new W2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Cs)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Cs(this.comparator);return t.data=e,t}}class W2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Rr{constructor(e){this.fields=e,e.sort(Hs.comparator)}static empty(){return new Rr([])}unionWith(e){let t=new Cs(Hs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Rr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $l(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class z_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class $s{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new z_("Invalid base64 string: "+u):u}})(e);return new $s(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new $s(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$s.EMPTY_BYTE_STRING=new $s("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(s){if(pn(!!s,39018),typeof s=="string"){let e=0;const t=DR.exec(s);if(pn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:os(s.seconds),nanos:os(s.nanos)}}function os(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function no(s){return typeof s=="string"?$s.fromBase64String(s):$s.fromUint8Array(s)}const F_="server_timestamp",q_="__type__",H_="__previous_value__",$_="__local_write_time__";function _y(s){return(s?.mapValue?.fields||{})[q_]?.stringValue===F_}function ff(s){const e=s.mapValue.fields[H_];return _y(e)?ff(e):e}function vu(s){const e=to(s.mapValue.fields[$_].timestampValue);return new Dt(e.seconds,e.nanos)}class LR{constructor(e,t,i,l,u,d,p,y,g,b,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=y,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=k}}const Hh="(default)";class bu{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new bu("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof bu&&e.projectId===this.projectId&&e.database===this.database}}function OR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Fe(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bu(s.options.projectId,e)}const W_="__type__",PR="__max__",ch={mapValue:{}},G_="__vector__",$h="value";function so(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?_y(s)?4:UR(s)?9007199254740991:VR(s)?10:11:pt(28295,{value:s})}function Ii(s,e){if(s===e)return!0;const t=so(s);if(t!==so(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return vu(s).isEqual(vu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=to(l.timestampValue),p=to(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return no(l.bytesValue).isEqual(no(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return os(l.geoPointValue.latitude)===os(u.geoPointValue.latitude)&&os(l.geoPointValue.longitude)===os(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return os(l.integerValue)===os(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=os(l.doubleValue),p=os(u.doubleValue);return d===p?qh(d)===qh(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return $l(s.arrayValue.values||[],e.arrayValue.values||[],Ii);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if($2(d)!==$2(p))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(p[y]===void 0||!Ii(d[y],p[y])))return!1;return!0})(s,e);default:return pt(52216,{left:s})}}function wu(s,e){return(s.values||[]).find((t=>Ii(t,e)))!==void 0}function Wl(s,e){if(s===e)return 0;const t=so(s),i=so(e);if(t!==i)return Gt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Gt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=os(u.integerValue||u.doubleValue),y=os(d.integerValue||d.doubleValue);return p<y?-1:p>y?1:p===y?0:isNaN(p)?isNaN(y)?0:-1:1})(s,e);case 3:return G2(s.timestampValue,e.timestampValue);case 4:return G2(vu(s),vu(e));case 5:return Ng(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=no(u),y=no(d);return p.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),y=d.split("/");for(let g=0;g<p.length&&g<y.length;g++){const b=Gt(p[g],y[g]);if(b!==0)return b}return Gt(p.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=Gt(os(u.latitude),os(d.latitude));return p!==0?p:Gt(os(u.longitude),os(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return K2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},y=d.fields||{},g=p[$h]?.arrayValue,b=y[$h]?.arrayValue,k=Gt(g?.values?.length||0,b?.values?.length||0);return k!==0?k:K2(g,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===ch.mapValue&&d===ch.mapValue)return 0;if(u===ch.mapValue)return 1;if(d===ch.mapValue)return-1;const p=u.fields||{},y=Object.keys(p),g=d.fields||{},b=Object.keys(g);y.sort(),b.sort();for(let k=0;k<y.length&&k<b.length;++k){const S=Ng(y[k],b[k]);if(S!==0)return S;const R=Wl(p[y[k]],g[b[k]]);if(R!==0)return R}return Gt(y.length,b.length)})(s.mapValue,e.mapValue);default:throw pt(23264,{he:t})}}function G2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Gt(s,e);const t=to(s),i=to(e),l=Gt(t.seconds,i.seconds);return l!==0?l:Gt(t.nanos,i.nanos)}function K2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Wl(t[l],i[l]);if(u)return u}return Gt(t.length,i.length)}function Gl(s){return Ag(s)}function Ag(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=to(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return no(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return it.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Ag(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Ag(t.fields[d])}`;return l+"}"})(s.mapValue):pt(61005,{value:s})}function Sh(s){switch(so(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(s);return e?16+Sh(e):16;case 5:return 2*s.stringValue.length;case 6:return no(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Sh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return lo(i.fields,((u,d)=>{l+=u.length+Sh(d)})),l})(s.mapValue);default:throw pt(13486,{value:s})}}function Y2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Rg(s){return!!s&&"integerValue"in s}function ky(s){return!!s&&"arrayValue"in s}function Q2(s){return!!s&&"nullValue"in s}function X2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ch(s){return!!s&&"mapValue"in s}function VR(s){return(s?.mapValue?.fields||{})[W_]?.stringValue===G_}function lu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return lo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=lu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=lu(s.arrayValue.values[t]);return e}return{...s}}function UR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===PR}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ch(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lu(t)}setAll(e){let t=Hs.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=lu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Ch(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ii(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Ch(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){lo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new yr(lu(this.value))}}function K_(s){const e=[];return lo(s.fields,((t,i)=>{const l=new Hs([t]);if(Ch(i)){const u=K_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Rr(e)}class Qs{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Qs(e,0,_t.min(),_t.min(),_t.min(),yr.empty(),0)}static newFoundDocument(e,t,i,l){return new Qs(e,1,t,_t.min(),i,l,0)}static newNoDocument(e,t){return new Qs(e,2,t,_t.min(),_t.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Qs(e,3,t,_t.min(),_t.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_t.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_t.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function J2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=it.comparator(it.fromName(d.referenceValue),t.key):i=Wl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Z2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ii(s.position[t],e.position[t]))return!1;return!0}class xu{constructor(e,t="asc"){this.field=e,this.dir=t}}function BR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Y_{}class ys extends Y_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FR(e,t,i):t==="array-contains"?new $R(e,i):t==="in"?new WR(e,i):t==="not-in"?new GR(e,i):t==="array-contains-any"?new KR(e,i):new ys(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qR(e,i):new HR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wl(t,this.value)):t!==null&&so(this.value)===so(t)&&this.matchesComparison(Wl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fi extends Y_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new fi(e,t)}matches(e){return Q_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Q_(s){return s.op==="and"}function X_(s){return zR(s)&&Q_(s)}function zR(s){for(const e of s.filters)if(e instanceof fi)return!1;return!0}function Ig(s){if(s instanceof ys)return s.field.canonicalString()+s.op.toString()+Gl(s.value);if(X_(s))return s.filters.map((e=>Ig(e))).join(",");{const e=s.filters.map((t=>Ig(t))).join(",");return`${s.op}(${e})`}}function J_(s,e){return s instanceof ys?(function(i,l){return l instanceof ys&&i.op===l.op&&i.field.isEqual(l.field)&&Ii(i.value,l.value)})(s,e):s instanceof fi?(function(i,l){return l instanceof fi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&J_(d,l.filters[p])),!0):!1})(s,e):void pt(19439)}function Z_(s){return s instanceof ys?(function(t){return`${t.field.canonicalString()} ${t.op} ${Gl(t.value)}`})(s):s instanceof fi?(function(t){return t.op.toString()+" {"+t.getFilters().map(Z_).join(" ,")+"}"})(s):"Filter"}class FR extends ys{constructor(e,t,i){super(e,t,i),this.key=it.fromName(i.referenceValue)}matches(e){const t=it.comparator(e.key,this.key);return this.matchesComparison(t)}}class qR extends ys{constructor(e,t){super(e,"in",t),this.keys=ek("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class HR extends ys{constructor(e,t){super(e,"not-in",t),this.keys=ek("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ek(s,e){return(e.arrayValue?.values||[]).map((t=>it.fromName(t.referenceValue)))}class $R extends ys{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ky(t)&&wu(t.arrayValue,this.value)}}class WR extends ys{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class GR extends ys{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class KR extends ys{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ky(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}class YR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function ew(s,e=null,t=[],i=[],l=null,u=null,d=null){return new YR(s,e,t,i,l,u,d)}function Ey(s){const e=jt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ig(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),hf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Gl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Gl(i))).join(",")),e.Te=t}return e.Te}function Ty(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!BR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!J_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Z2(s.startAt,e.startAt)&&Z2(s.endAt,e.endAt)}function Mg(s){return it.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class ic{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function QR(s,e,t,i,l,u,d,p){return new ic(s,e,t,i,l,u,d,p)}function mf(s){return new ic(s)}function tw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function XR(s){return it.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function tk(s){return s.collectionGroup!==null}function cu(s){const e=jt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Cs(Hs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((g=>{g.isInequality()&&(p=p.add(g.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new xu(u,i))})),t.has(Hs.keyField().canonicalString())||e.Ie.push(new xu(Hs.keyField(),i))}return e.Ie}function Ni(s){const e=jt(s);return e.Ee||(e.Ee=JR(e,cu(s))),e.Ee}function JR(s,e){if(s.limitType==="F")return ew(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new xu(l.field,u)}));const t=s.endAt?new Wh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Wh(s.startAt.position,s.startAt.inclusive):null;return ew(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Dg(s,e){const t=s.filters.concat([e]);return new ic(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ZR(s,e){const t=s.explicitOrderBy.concat([e]);return new ic(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Gh(s,e,t){return new ic(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function pf(s,e){return Ty(Ni(s),Ni(e))&&s.limitType===e.limitType}function nk(s){return`${Ey(Ni(s))}|lt:${s.limitType}`}function Dl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>Z_(l))).join(", ")}]`),hf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Gl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Gl(l))).join(",")),`Target(${i})`})(Ni(s))}; limitType=${s.limitType})`}function gf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):it.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of cu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,y){const g=J2(d,p,y);return d.inclusive?g<=0:g<0})(i.startAt,cu(i),l)||i.endAt&&!(function(d,p,y){const g=J2(d,p,y);return d.inclusive?g>=0:g>0})(i.endAt,cu(i),l))})(s,e)}function eI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function sk(s){return(e,t)=>{let i=!1;for(const l of cu(s)){const u=tI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function tI(s,e,t){const i=s.field.isKeyField()?it.comparator(e.key,t.key):(function(u,d,p){const y=d.data.field(u),g=p.data.field(u);return y!==null&&g!==null?Wl(y,g):pt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return pt(19790,{direction:s.dir})}}class Yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return B_(this.inner)}size(){return this.innerSize}}const nI=new $n(it.comparator);function ma(){return nI}const rk=new $n(it.comparator);function su(...s){let e=rk;for(const t of s)e=e.insert(t.key,t);return e}function ik(s){let e=rk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ro(){return uu()}function ak(){return uu()}function uu(){return new Yo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const sI=new $n(it.comparator),rI=new Cs(it.comparator);function Kt(...s){let e=rI;for(const t of s)e=e.add(t);return e}const iI=new Cs(Gt);function aI(){return iI}function jy(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function ok(s){return{integerValue:""+s}}function lk(s,e){return RR(e)?ok(e):jy(s,e)}class yf{constructor(){this._=void 0}}function oI(s,e,t){return s instanceof _u?(function(l,u){const d={fields:{[q_]:{stringValue:F_},[$_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&_y(u)&&(u=ff(u)),u&&(d.fields[H_]=u),{mapValue:d}})(t,e):s instanceof Kl?uk(s,e):s instanceof Yl?dk(s,e):(function(l,u){const d=ck(l,u),p=nw(d)+nw(l.Ae);return Rg(d)&&Rg(l.Ae)?ok(p):jy(l.serializer,p)})(s,e)}function lI(s,e,t){return s instanceof Kl?uk(s,e):s instanceof Yl?dk(s,e):t}function ck(s,e){return s instanceof ku?(function(i){return Rg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class _u extends yf{}class Kl extends yf{constructor(e){super(),this.elements=e}}function uk(s,e){const t=hk(e);for(const i of s.elements)t.some((l=>Ii(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Yl extends yf{constructor(e){super(),this.elements=e}}function dk(s,e){let t=hk(e);for(const i of s.elements)t=t.filter((l=>!Ii(l,i)));return{arrayValue:{values:t}}}class ku extends yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nw(s){return os(s.integerValue||s.doubleValue)}function hk(s){return ky(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class vf{constructor(e,t){this.field=e,this.transform=t}}function cI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Kl&&l instanceof Kl||i instanceof Yl&&l instanceof Yl?$l(i.elements,l.elements,Ii):i instanceof ku&&l instanceof ku?Ii(i.Ae,l.Ae):i instanceof _u&&l instanceof _u})(s.transform,e.transform)}class uI{constructor(e,t){this.version=e,this.transformResults=t}}class cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new cr}static exists(e){return new cr(void 0,e)}static updateTime(e){return new cr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class bf{}function fk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new wf(s.key,cr.none()):new Pu(s.key,s.data,cr.none());{const t=s.data,i=yr.empty();let l=new Cs(Hs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new co(s.key,i,new Rr(l.toArray()),cr.none())}}function dI(s,e,t){s instanceof Pu?(function(l,u,d){const p=l.value.clone(),y=rw(l.fieldTransforms,u,d.transformResults);p.setAll(y),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):s instanceof co?(function(l,u,d){if(!Nh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=rw(l.fieldTransforms,u,d.transformResults),y=u.data;y.setAll(mk(l)),y.setAll(p),u.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function du(s,e,t,i){return s instanceof Pu?(function(u,d,p,y){if(!Nh(u.precondition,d))return p;const g=u.value.clone(),b=iw(u.fieldTransforms,y,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(s,e,t,i):s instanceof co?(function(u,d,p,y){if(!Nh(u.precondition,d))return p;const g=iw(u.fieldTransforms,y,d),b=d.data;return b.setAll(mk(u)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,d,p){return Nh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,t)}function hI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=ck(i.transform,l||null);u!=null&&(t===null&&(t=yr.empty()),t.set(i.field,u))}return t||null}function sw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&$l(i,l,((u,d)=>cI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Pu extends bf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class co extends bf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function mk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function rw(s,e,t){const i=new Map;pn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,lI(d,p,t[l]))}return i}function iw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,oI(u,d,e))}return i}class wf extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fI extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&dI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ak();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const y=fk(d,p);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(_t.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Kt())}isEqual(e){return this.batchId===e.batchId&&$l(this.mutations,e.mutations,((t,i)=>sw(t,i)))&&$l(this.baseMutations,e.baseMutations,((t,i)=>sw(t,i)))}}class Sy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){pn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return sI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Sy(e,t,i,l)}}class pI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gI{constructor(e,t){this.count=e,this.unchangedNames=t}}var gs,tn;function yI(s){switch(s){case ve.OK:return pt(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return pt(15467,{code:s})}}function pk(s){if(s===void 0)return fa("GRPC error has no .code"),ve.UNKNOWN;switch(s){case gs.OK:return ve.OK;case gs.CANCELLED:return ve.CANCELLED;case gs.UNKNOWN:return ve.UNKNOWN;case gs.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case gs.INTERNAL:return ve.INTERNAL;case gs.UNAVAILABLE:return ve.UNAVAILABLE;case gs.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case gs.NOT_FOUND:return ve.NOT_FOUND;case gs.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case gs.ABORTED:return ve.ABORTED;case gs.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case gs.DATA_LOSS:return ve.DATA_LOSS;default:return pt(39323,{code:s})}}(tn=gs||(gs={}))[tn.OK=0]="OK",tn[tn.CANCELLED=1]="CANCELLED",tn[tn.UNKNOWN=2]="UNKNOWN",tn[tn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tn[tn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tn[tn.NOT_FOUND=5]="NOT_FOUND",tn[tn.ALREADY_EXISTS=6]="ALREADY_EXISTS",tn[tn.PERMISSION_DENIED=7]="PERMISSION_DENIED",tn[tn.UNAUTHENTICATED=16]="UNAUTHENTICATED",tn[tn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tn[tn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tn[tn.ABORTED=10]="ABORTED",tn[tn.OUT_OF_RANGE=11]="OUT_OF_RANGE",tn[tn.UNIMPLEMENTED=12]="UNIMPLEMENTED",tn[tn.INTERNAL=13]="INTERNAL",tn[tn.UNAVAILABLE=14]="UNAVAILABLE",tn[tn.DATA_LOSS=15]="DATA_LOSS";function vI(){return new TextEncoder}const bI=new Ja([4294967295,4294967295],0);function aw(s){const e=vI().encode(s),t=new N_;return t.update(e),new Uint8Array(t.digest())}function ow(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ja([t,i],0),new Ja([l,u],0)]}class Cy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ru(`Invalid padding: ${t}`);if(i<0)throw new ru(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ru(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ru(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ja.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Ja.fromNumber(i)));return l.compare(bI)===1&&(l=new Ja([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Cy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new xf(_t.min(),l,new $n(Gt),ma(),Kt())}}class Vu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Vu(i,t,Kt(),Kt(),Kt())}}class Ah{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class gk{constructor(e,t){this.targetId=e,this.Ce=t}}class yk{constructor(e,t,i=$s.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class lw{constructor(){this.ve=0,this.Fe=cw(),this.Me=$s.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Kt(),t=Kt(),i=Kt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:pt(38017,{changeType:u})}})),new Vu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=cw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,pn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class wI{constructor(e){this.Ge=e,this.ze=new Map,this.je=ma(),this.He=uh(),this.Je=uh(),this.Ze=new $n(Gt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:pt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Mg(u))if(i===0){const d=new it(u.path);this.et(t,d,Qs.newNoDocument(d,_t.min()))}else pn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),y=p?this.ct(p,e,d):1;if(y!==0){this.it(t);const g=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=no(i).toUint8Array()}catch(y){if(y instanceof z_)return Hl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{p=new Cy(d,l,u)}catch(y){return Hl(y instanceof ru?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&Mg(p.target)){const y=new it(p.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Qs.newNoDocument(y,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Kt();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((y=>{const g=this.ot(y);return!g||g.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new xf(e,t,this.Ze,this.je,i);return this.je=ma(),this.He=uh(),this.Je=uh(),this.Ze=new $n(Gt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new lw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Cs(Gt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Cs(Gt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||$e("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function uh(){return new $n(it.comparator)}function cw(){return new $n(it.comparator)}const xI={asc:"ASCENDING",desc:"DESCENDING"},_I={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kI={and:"AND",or:"OR"};class EI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lg(s,e){return s.useProto3Json||hf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function TI(s,e){return Kh(s,e.toTimestamp())}function Ai(s){return pn(!!s,49232),_t.fromTimestamp((function(t){const i=to(t);return new Dt(i.seconds,i.nanos)})(s))}function Ny(s,e){return Og(s,e).canonicalString()}function Og(s,e){const t=(function(l){return new An(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function bk(s){const e=An.fromString(s);return pn(Ek(e),10190,{key:e.toString()}),e}function Pg(s,e){return Ny(s.databaseId,e.path)}function Hp(s,e){const t=bk(e);if(t.get(1)!==s.databaseId.projectId)throw new Fe(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Fe(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new it(xk(t))}function wk(s,e){return Ny(s.databaseId,e)}function jI(s){const e=bk(s);return e.length===4?An.emptyPath():xk(e)}function Vg(s){return new An(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function xk(s){return pn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function uw(s,e,t){return{name:Pg(s,e),fields:t.value.mapValue.fields}}function SI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:pt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(g,b){return g.useProto3Json?(pn(b===void 0||typeof b=="string",58123),$s.fromBase64String(b||"")):(pn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),$s.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(g){const b=g.code===void 0?ve.UNKNOWN:pk(g.code);return new Fe(b,g.message||"")})(d);t=new yk(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Hp(s,i.document.name),u=Ai(i.document.updateTime),d=i.document.createTime?Ai(i.document.createTime):_t.min(),p=new yr({mapValue:{fields:i.document.fields}}),y=Qs.newFoundDocument(l,u,d,p),g=i.targetIds||[],b=i.removedTargetIds||[];t=new Ah(g,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Hp(s,i.document),u=i.readTime?Ai(i.readTime):_t.min(),d=Qs.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Ah([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Hp(s,i.document),u=i.removedTargetIds||[];t=new Ah([],u,l,null)}else{if(!("filter"in e))return pt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new gI(l,u),p=i.targetId;t=new gk(p,d)}}return t}function CI(s,e){let t;if(e instanceof Pu)t={update:uw(s,e.key,e.value)};else if(e instanceof wf)t={delete:Pg(s,e.key)};else if(e instanceof co)t={update:uw(s,e.key,e.data),updateMask:PI(e.fieldMask)};else{if(!(e instanceof fI))return pt(16599,{dt:e.type});t={verify:Pg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof _u)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Kl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Yl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof ku)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw pt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:TI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:pt(27497)})(s,e.precondition)),t}function NI(s,e){return s&&s.length>0?(pn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Ai(l.updateTime):Ai(u);return d.isEqual(_t.min())&&(d=Ai(u)),new uI(d,l.transformResults||[])})(t,e)))):[]}function AI(s,e){return{documents:[wk(s,e.path)]}}function RI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=wk(s,l);const u=(function(g){if(g.length!==0)return kk(fi.create(g,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(g){if(g.length!==0)return g.map((b=>(function(S){return{field:Ll(S.field),direction:DI(S.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Lg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:l}}function II(s){let e=jI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){pn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(k){const S=_k(k);return S instanceof fi&&X_(S)?S.getFilters():[S]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((S=>(function(q){return new xu(Ol(q.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(q.direction))})(S)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let S;return S=typeof k=="object"?k.value:k,hf(S)?null:S})(t.limit));let y=null;t.startAt&&(y=(function(k){const S=!!k.before,R=k.values||[];return new Wh(R,S)})(t.startAt));let g=null;return t.endAt&&(g=(function(k){const S=!k.before,R=k.values||[];return new Wh(R,S)})(t.endAt)),QR(e,l,d,u,p,"F",y,g)}function MI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _k(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ol(t.unaryFilter.field);return ys.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ol(t.unaryFilter.field);return ys.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ol(t.unaryFilter.field);return ys.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ol(t.unaryFilter.field);return ys.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pt(61313);default:return pt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ys.create(Ol(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pt(58110);default:return pt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return fi.create(t.compositeFilter.filters.map((i=>_k(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return pt(1026)}})(t.compositeFilter.op))})(s):pt(30097,{filter:s})}function DI(s){return xI[s]}function LI(s){return _I[s]}function OI(s){return kI[s]}function Ll(s){return{fieldPath:s.canonicalString()}}function Ol(s){return Hs.fromServerFormat(s.fieldPath)}function kk(s){return s instanceof ys?(function(t){if(t.op==="=="){if(X2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(X2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ll(t.field),op:LI(t.op),value:t.value}}})(s):s instanceof fi?(function(t){const i=t.getFilters().map((l=>kk(l)));return i.length===1?i[0]:{compositeFilter:{op:OI(t.op),filters:i}}})(s):pt(54877,{filter:s})}function PI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ek(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Tk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Ka{constructor(e,t,i,l,u=_t.min(),d=_t.min(),p=$s.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=y}withSequenceNumber(e){return new Ka(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class VI{constructor(e){this.yt=e}}function UI(s){const e=II({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Gh(e,e.limit,"L"):e}class BI{constructor(){this.Sn=new zI}addToCollectionParentIndex(e,t){return this.Sn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(eo.min())}updateCollectionGroup(e,t,i){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class zI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Cs(An.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Cs(An.comparator)).toArray()}}const dw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jk=41943040;class gr{static withCacheSize(e){return new gr(e,gr.DEFAULT_COLLECTION_PERCENTILE,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}gr.DEFAULT_COLLECTION_PERCENTILE=10,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gr.DEFAULT=new gr(jk,gr.DEFAULT_COLLECTION_PERCENTILE,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gr.DISABLED=new gr(-1,0,0);class Ql{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ql(0)}static ar(){return new Ql(-1)}}const hw="LruGarbageCollector",FI=1048576;function fw([s,e],[t,i]){const l=Gt(s,t);return l===0?Gt(e,i):l}class qI{constructor(e){this.Pr=e,this.buffer=new Cs(fw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();fw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){$e(hw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rc(t)?$e(hw,"Ignoring IndexedDB error during garbage collection: ",t):await sc(t)}await this.Ar(3e5)}))}}class $I{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return je.resolve(df.ce);const i=new qI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?($e("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(dw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?($e("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,y,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?($e("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(g=Date.now(),Ml()<=Wt.DEBUG&&$e("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(y-p)+`ms
	Removed ${k} documents in `+(g-y)+`ms
Total Duration: ${g-b}ms`),je.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function WI(s,e){return new $I(s,e)}class GI{constructor(){this.changes=new Yo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?je.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&du(i.mutation,l,Rr.empty(),Dt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Kt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Kt()){const l=Ro();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=su();return u.forEach(((p,y)=>{d=d.insert(p,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ro();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Kt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=ma();const d=uu(),p=(function(){return uu()})();return t.forEach(((y,g)=>{const b=i.get(g.key);l.has(g.key)&&(b===void 0||b.mutation instanceof co)?u=u.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),du(b.mutation,g,b.mutation.getFieldMask(),Dt.now())):d.set(g.key,Rr.empty())})),this.recalculateAndSaveOverlays(e,u).next((y=>(y.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>p.set(g,new KI(b,d.get(g)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=uu();let l=new $n(((d,p)=>d-p)),u=Kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((y=>{const g=t.get(y);if(g===null)return;let b=i.get(y)||Rr.empty();b=p.applyToLocalView(g,b),i.set(y,b);const k=(l.get(p.batchId)||Kt()).add(y);l=l.insert(p.batchId,k)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const y=p.getNext(),g=y.key,b=y.value,k=ak();b.forEach((S=>{if(!u.has(S)){const R=fk(t.get(S),i.get(S));R!==null&&k.set(S,R),u=u.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,k))}return je.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return XR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):je.resolve(Ro());let p=yu,y=u;return d.next((g=>je.forEach(g,((b,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(b)?je.resolve():this.remoteDocumentCache.getEntry(e,b).next((S=>{y=y.insert(b,S)}))))).next((()=>this.populateOverlays(e,g,u))).next((()=>this.computeViews(e,y,g,Kt()))).next((b=>({batchId:p,changes:ik(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new it(t)).next((i=>{let l=su();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=su();return this.indexManager.getCollectionParents(e,u).next((p=>je.forEach(p,(y=>{const g=(function(k,S){return new ic(S,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,y.child(u));return this.getDocumentsMatchingCollectionQuery(e,g,i,l).next((b=>{b.forEach(((k,S)=>{d=d.insert(k,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((y,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,Qs.newInvalidDocument(b)))}));let p=su();return d.forEach(((y,g)=>{const b=u.get(y);b!==void 0&&du(b.mutation,g,Rr.empty(),Dt.now()),gf(t,g)&&(p=p.insert(y,g))})),p}))}}class QI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return je.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ai(l.createTime)}})(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:UI(l.bundledQuery),readTime:Ai(l.readTime)}})(t)),je.resolve()}}class XI{constructor(){this.overlays=new $n(it.comparator),this.Lr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ro();return je.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),je.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),je.resolve()}getOverlaysForCollection(e,t,i){const l=Ro(),u=t.length+1,d=new it(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const y=p.getNext().value,g=y.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===u&&y.largestBatchId>i&&l.set(y.getKey(),y)}return je.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new $n(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let b=u.get(g.largestBatchId);b===null&&(b=Ro(),u=u.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const p=Ro(),y=u.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((g,b)=>p.set(g,b))),!(p.size()>=l)););return je.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new pI(t,i));let u=this.Lr.get(t);u===void 0&&(u=Kt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class JI{constructor(){this.sessionToken=$s.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}class Ay{constructor(){this.kr=new Cs(Ms.Kr),this.qr=new Cs(Ms.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ms(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ms(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new it(new An([])),i=new Ms(t,e),l=new Ms(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new it(new An([])),i=new Ms(t,e),l=new Ms(t,e+1);let u=Kt();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Ms(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ms{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return it.comparator(e.key,t.key)||Gt(e.Hr,t.Hr)}static Ur(e,t){return Gt(e.Hr,t.Hr)||it.comparator(e.key,t.key)}}class ZI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Cs(Ms.Kr)}checkEmpty(e){return je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mI(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Ms(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return je.resolve(d)}lookupMutationBatch(e,t){return je.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return je.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(this.mutationQueue.length===0?xy:this.Yn-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ms(t,0),l=new Ms(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),je.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Cs(Gt);return t.forEach((l=>{const u=new Ms(l,0),d=new Ms(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),je.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;it.isDocumentKey(u)||(u=u.child(""));const d=new Ms(new it(u),0);let p=new Cs(Gt);return this.Jr.forEachWhile((y=>{const g=y.key.path;return!!i.isPrefixOf(g)&&(g.length===l&&(p=p.add(y.Hr)),!0)}),d),je.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){pn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return je.forEach(t.mutations,(l=>{const u=new Ms(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ms(t,0),l=this.Jr.firstAfterOrEqual(i);return je.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eM{constructor(e){this.ti=e,this.docs=(function(){return new $n(it.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return je.resolve(i?i.document.mutableCopy():Qs.newInvalidDocument(t))}getEntries(e,t){let i=ma();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Qs.newInvalidDocument(l))})),je.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ma();const d=t.path,p=new it(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(p);for(;y.hasNext();){const{key:g,value:{document:b}}=y.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||SR(jR(b),i)<=0||(l.has(b.key)||gf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return je.resolve(u)}getAllFromCollectionGroup(e,t,i,l){pt(9500)}ni(e,t){return je.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new tM(this)}getSize(e){return je.resolve(this.size)}}class tM extends GI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),je.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class nM{constructor(e){this.persistence=e,this.ri=new Yo((t=>Ey(t)),Ty),this.lastRemoteSnapshotVersion=_t.min(),this.highestTargetId=0,this.ii=0,this.si=new Ay,this.targetCount=0,this.oi=Ql._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),je.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Ql(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.lr(t),je.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),je.waitFor(u).next((()=>l))}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return je.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),je.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),je.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return je.resolve(i)}containsKey(e,t){return je.resolve(this.si.containsKey(t))}}class Sk{constructor(e,t){this._i={},this.overlays={},this.ai=new df(0),this.ui=!1,this.ui=!0,this.ci=new JI,this.referenceDelegate=e(this),this.li=new nM(this),this.indexManager=new BI,this.remoteDocumentCache=(function(l){return new eM(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new VI(t),this.Pi=new QI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new ZI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){$e("MemoryPersistence","Starting transaction:",e);const l=new sM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return je.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sM extends NR{constructor(e){super(),this.currentSequenceNumber=e}}class Ry{constructor(e){this.persistence=e,this.Ri=new Ay,this.Ai=null}static Vi(e){return new Ry(e)}get di(){if(this.Ai)return this.Ai;throw pt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),je.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.di,(i=>{const l=it.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,_t.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new Yo((i=>IR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=WI(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return je.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?je.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,_t.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),je.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),je.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sh(e.data.value)),t}wr(e,t,i){return je.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return je.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Iy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Kt(),l=Kt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Iy(e,t.fromCache,i,l)}}class rM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class iM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DC()?8:AR(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new rM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ml()<=Wt.DEBUG&&$e("QueryEngine","SDK will not create cache indexes for query:",Dl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),je.resolve()):(Ml()<=Wt.DEBUG&&$e("QueryEngine","Query:",Dl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ml()<=Wt.DEBUG&&$e("QueryEngine","The SDK decides to create cache indexes for query:",Dl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ni(t))):je.resolve())}gs(e,t){if(tw(t))return je.resolve(null);let i=Ni(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=Ni(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Kt(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((y=>{const g=this.bs(t,p);return this.Ss(t,g,d,y.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,g,t,y)}))))})))))}ps(e,t,i,l){return tw(t)||l.isEqual(_t.min())?je.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?je.resolve(null):(Ml()<=Wt.DEBUG&&$e("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Dl(t)),this.Ds(e,d,t,TR(l,yu)).next((p=>p)))}))}bs(e,t){let i=new Cs(sk(e));return t.forEach(((l,u)=>{gf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ml()<=Wt.DEBUG&&$e("QueryEngine","Using full collection scan to execute query:",Dl(t)),this.fs.getDocumentsMatchingQuery(e,t,eo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const My="LocalStore",aM=3e8;class oM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new $n(Gt),this.Fs=new Yo((u=>Ey(u)),Ty),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function lM(s,e,t,i){return new oM(s,e,t,i)}async function Ck(s,e){const t=jt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let y=Kt();for(const g of l){d.push(g.batchId);for(const b of g.mutations)y=y.add(b.key)}for(const g of u){p.push(g.batchId);for(const b of g.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((g=>({Ns:g,removedBatchIds:d,addedBatchIds:p})))}))}))}function cM(s,e){const t=jt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,y,g,b){const k=g.batch,S=k.keys();let R=je.resolve();return S.forEach((q=>{R=R.next((()=>b.getEntry(y,q))).next(($=>{const U=g.docVersions.get(q);pn(U!==null,48541),$.version.compareTo(U)<0&&(k.applyToRemoteDocument($,g),$.isValidDocument()&&($.setReadTime(g.commitVersion),b.addEntry($)))}))})),R.next((()=>p.mutationQueue.removeMutationBatch(y,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let y=Kt();for(let g=0;g<p.mutationResults.length;++g)p.mutationResults[g].transformResults.length>0&&(y=y.add(p.batch.mutations[g].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Nk(s){const e=jt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function uM(s,e){const t=jt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,k)=>{const S=l.get(k);if(!S)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,k))));let R=S.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?R=R.withResumeToken($s.EMPTY_BYTE_STRING,_t.min()).withLastLimboFreeSnapshotVersion(_t.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),l=l.insert(k,R),(function($,U,W){return $.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=aM?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0})(S,R,b)&&p.push(t.li.updateTargetData(u,R))}));let y=ma(),g=Kt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(dM(u,d,e.documentUpdates).next((b=>{y=b.Bs,g=b.Ls}))),!i.isEqual(_t.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return je.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,y,g))).next((()=>y))})).then((u=>(t.vs=l,u)))}function dM(s,e,t){let i=Kt(),l=Kt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=ma();return t.forEach(((p,y)=>{const g=u.get(p);y.isFoundDocument()!==g.isFoundDocument()&&(l=l.add(p)),y.isNoDocument()&&y.version.isEqual(_t.min())?(e.removeEntry(p,y.readTime),d=d.insert(p,y)):!g.isValidDocument()||y.version.compareTo(g.version)>0||y.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(y),d=d.insert(p,y)):$e(My,"Ignoring outdated watch update for ",p,". Current version:",g.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function hM(s,e){const t=jt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=xy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function fM(s,e){const t=jt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,je.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Ka(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Ug(s,e,t){const i=jt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!rc(d))throw d;$e(My,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function mw(s,e,t){const i=jt(s);let l=_t.min(),u=Kt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,g,b){const k=jt(y),S=k.Fs.get(b);return S!==void 0?je.resolve(k.vs.get(S)):k.li.getTargetData(g,b)})(i,d,Ni(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((y=>{u=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:_t.min(),t?u:Kt()))).next((p=>(mM(i,eI(e),p),{documents:p,ks:u})))))}function mM(s,e,t){let i=s.Ms.get(e)||_t.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class pw{constructor(){this.activeTargetIds=aI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pM{constructor(){this.vo=new pw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new pw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gM{Mo(e){}shutdown(){}}const gw="ConnectivityMonitor";class yw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){$e(gw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){$e(gw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let dh=null;function Bg(){return dh===null?dh=(function(){return 268435456+Math.round(2147483648*Math.random())})():dh++,"0x"+dh.toString(16)}const $p="RestConnection",yM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class vM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Hh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Bg(),p=this.Qo(e,t.toUriEncodedString());$e($p,`Sending RPC '${e}' ${d}:`,p,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,u);const{host:g}=new URL(p),b=ao(g);return this.zo(e,p,y,i,b).then((k=>($e($p,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Hl($p,`RPC '${e}' ${d} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=yM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class bM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ks="WebChannelConnection",Kc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class zl extends vM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!zl.c_){const e=M_();Kc(e,I_.STAT_EVENT,(t=>{t.stat===Cg.PROXY?$e(Ks,"STAT_EVENT: detected buffering proxy"):t.stat===Cg.NOPROXY&&$e(Ks,"STAT_EVENT: detected no buffering proxy")})),zl.c_=!0}}zo(e,t,i,l,u){const d=Bg();return new Promise(((p,y)=>{const g=new A_;g.setWithCredentials(!0),g.listenOnce(R_.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case jh.NO_ERROR:const k=g.getResponseJson();$e(Ks,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),p(k);break;case jh.TIMEOUT:$e(Ks,`RPC '${e}' ${d} timed out`),y(new Fe(ve.DEADLINE_EXCEEDED,"Request time out"));break;case jh.HTTP_ERROR:const S=g.getStatus();if($e(Ks,`RPC '${e}' ${d} failed with status:`,S,"response text:",g.getResponseText()),S>0){let R=g.getResponseJson();Array.isArray(R)&&(R=R[0]);const q=R?.error;if(q&&q.status&&q.message){const $=(function(W){const G=W.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(G)>=0?G:ve.UNKNOWN})(q.status);y(new Fe($,q.message))}else y(new Fe(ve.UNKNOWN,"Server responded with status "+g.getStatus()))}else y(new Fe(ve.UNAVAILABLE,"Connection failed."));break;default:pt(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{$e(Ks,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);$e(Ks,`RPC '${e}' ${d} sending request:`,l),g.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Bg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const g=u.join("");$e(Ks,`Creating RPC '${e}' stream ${l}: ${g}`,p);const b=d.createWebChannel(g,p);this.I_(b);let k=!1,S=!1;const R=new bM({Ho:q=>{S?$e(Ks,`Not sending because RPC '${e}' stream ${l} is closed:`,q):(k||($e(Ks,`Opening RPC '${e}' stream ${l} transport.`),b.open(),k=!0),$e(Ks,`RPC '${e}' stream ${l} sending:`,q),b.send(q))},Jo:()=>b.close()});return Kc(b,nu.EventType.OPEN,(()=>{S||($e(Ks,`RPC '${e}' stream ${l} transport opened.`),R.i_())})),Kc(b,nu.EventType.CLOSE,(()=>{S||(S=!0,$e(Ks,`RPC '${e}' stream ${l} transport closed`),R.o_(),this.E_(b))})),Kc(b,nu.EventType.ERROR,(q=>{S||(S=!0,Hl(Ks,`RPC '${e}' stream ${l} transport errored. Name:`,q.name,"Message:",q.message),R.o_(new Fe(ve.UNAVAILABLE,"The operation could not be completed")))})),Kc(b,nu.EventType.MESSAGE,(q=>{if(!S){const $=q.data[0];pn(!!$,16349);const U=$,W=U?.error||U[0]?.error;if(W){$e(Ks,`RPC '${e}' stream ${l} received error:`,W);const G=W.status;let Q=(function(xe){const C=gs[xe];if(C!==void 0)return pk(C)})(G),me=W.message;Q===void 0&&(Q=ve.INTERNAL,me="Unknown error status: "+G+" with message "+W.message),S=!0,R.o_(new Fe(Q,me)),b.close()}else $e(Ks,`RPC '${e}' stream ${l} received:`,$),R.__($)}})),zl.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return D_()}}function wM(s){return new zl(s)}function Wp(){return typeof document<"u"?document:null}function _f(s){return new EI(s,!0)}zl.c_=!1;class Ak{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&$e("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const vw="PersistentStream";class Rk{constructor(e,t,i,l,u,d,p,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ak(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(fa(t.toString()),fa("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new Fe(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return $e(vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():($e(vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xM extends Rk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return _t.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?_t.min():d.readTime?Ai(d.readTime):_t.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Vg(this.serializer),t.addTarget=(function(u,d){let p;const y=d.target;if(p=Mg(y)?{documents:AI(u,y)}:{query:RI(u,y).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=vk(u,d.resumeToken);const g=Lg(u,d.expectedCount);g!==null&&(p.expectedCount=g)}else if(d.snapshotVersion.compareTo(_t.min())>0){p.readTime=Kh(u,d.snapshotVersion.toTimestamp());const g=Lg(u,d.expectedCount);g!==null&&(p.expectedCount=g)}return p})(this.serializer,e);const i=MI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Vg(this.serializer),t.removeTarget=e,this.K_(t)}}class _M extends Rk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return pn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=NI(e.writeResults,e.commitTime),i=Ai(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>CI(this.serializer,i)))};this.K_(t)}}class kM{}class EM extends kM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new Fe(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Og(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Fe(ve.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Og(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Fe(ve.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function TM(s,e,t,i){return new EM(s,e,t,i)}class jM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fa(t),this.aa=!1):$e("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const zo="RemoteStore";class SM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Qo(this)&&($e(zo,"Restarting streams for network reachability change."),await(async function(y){const g=jt(y);g.Ea.add(4),await Uu(g),g.Va.set("Unknown"),g.Ea.delete(4),await kf(g)})(this))}))})),this.Va=new jM(i,l)}}async function kf(s){if(Qo(s))for(const e of s.Ra)await e(!0)}async function Uu(s){for(const e of s.Ra)await e(!1)}function Ik(s,e){const t=jt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Py(t)?Oy(t):ac(t).O_()&&Ly(t,e))}function Dy(s,e){const t=jt(s),i=ac(t);t.Ia.delete(e),i.O_()&&Mk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Qo(t)&&t.Va.set("Unknown"))}function Ly(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_t.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ac(s).Z_(e)}function Mk(s,e){s.da.$e(e),ac(s).X_(e)}function Oy(s){s.da=new wI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ac(s).start(),s.Va.ua()}function Py(s){return Qo(s)&&!ac(s).x_()&&s.Ia.size>0}function Qo(s){return jt(s).Ea.size===0}function Dk(s){s.da=void 0}async function CM(s){s.Va.set("Online")}async function NM(s){s.Ia.forEach(((e,t)=>{Ly(s,e)}))}async function AM(s,e){Dk(s),Py(s)?(s.Va.ha(e),Oy(s)):s.Va.set("Unknown")}async function RM(s,e,t){if(s.Va.set("Online"),e instanceof yk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){$e(zo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(s,i)}else if(e instanceof Ah?s.da.Xe(e):e instanceof gk?s.da.st(e):s.da.tt(e),!t.isEqual(_t.min()))try{const i=await Nk(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((y,g)=>{if(y.resumeToken.approximateByteSize()>0){const b=u.Ia.get(g);b&&u.Ia.set(g,b.withResumeToken(y.resumeToken,d))}})),p.targetMismatches.forEach(((y,g)=>{const b=u.Ia.get(y);if(!b)return;u.Ia.set(y,b.withResumeToken($s.EMPTY_BYTE_STRING,b.snapshotVersion)),Mk(u,y);const k=new Ka(b.target,y,g,b.sequenceNumber);Ly(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){$e(zo,"Failed to raise snapshot:",i),await Qh(s,i)}}async function Qh(s,e,t){if(!rc(e))throw e;s.Ea.add(1),await Uu(s),s.Va.set("Offline"),t||(t=()=>Nk(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{$e(zo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await kf(s)}))}function Lk(s,e){return e().catch((t=>Qh(s,t,e)))}async function Ef(s){const e=jt(s),t=ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xy;for(;IM(e);)try{const l=await hM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MM(e,l)}catch(l){await Qh(e,l)}Ok(e)&&Pk(e)}function IM(s){return Qo(s)&&s.Ta.length<10}function MM(s,e){s.Ta.push(e);const t=ro(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Ok(s){return Qo(s)&&!ro(s).x_()&&s.Ta.length>0}function Pk(s){ro(s).start()}async function DM(s){ro(s).ra()}async function LM(s){const e=ro(s);for(const t of s.Ta)e.ea(t.mutations)}async function OM(s,e,t){const i=s.Ta.shift(),l=Sy.from(i,e,t);await Lk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await Ef(s)}async function PM(s,e){e&&ro(s).Y_&&await(async function(i,l){if((function(d){return yI(d)&&d!==ve.ABORTED})(l.code)){const u=i.Ta.shift();ro(i).B_(),await Lk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await Ef(i)}})(s,e),Ok(s)&&Pk(s)}async function bw(s,e){const t=jt(s);t.asyncQueue.verifyOperationInProgress(),$e(zo,"RemoteStore received new credentials");const i=Qo(t);t.Ea.add(3),await Uu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kf(t)}async function VM(s,e){const t=jt(s);e?(t.Ea.delete(2),await kf(t)):e||(t.Ea.add(2),await Uu(t),t.Va.set("Unknown"))}function ac(s){return s.ma||(s.ma=(function(t,i,l){const u=jt(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:CM.bind(null,s),Yo:NM.bind(null,s),t_:AM.bind(null,s),J_:RM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Py(s)?Oy(s):s.Va.set("Unknown")):(await s.ma.stop(),Dk(s))}))),s.ma}function ro(s){return s.fa||(s.fa=(function(t,i,l){const u=jt(t);return u.sa(),new _M(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DM.bind(null,s),t_:PM.bind(null,s),ta:LM.bind(null,s),na:OM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Ef(s)):(await s.fa.stop(),s.Ta.length>0&&($e(zo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Vy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new la,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Vy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uy(s,e){if(fa("AsyncQueue",`${e}: ${s}`),rc(s))return new Fe(ve.UNAVAILABLE,`${e}: ${s}`);throw s}class Fl{static emptySet(e){return new Fl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||it.comparator(t.key,i.key):(t,i)=>it.comparator(t.key,i.key),this.keyedMap=su(),this.sortedSet=new $n(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Fl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Fl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class ww{constructor(){this.ga=new $n(it.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):pt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Xl{constructor(e,t,i,l,u,d,p,y,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=y,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Xl(e,t,Fl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class UM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class BM{constructor(){this.queries=xw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=jt(t),u=l.queries;l.queries=xw(),u.forEach(((d,p)=>{for(const y of p.ba)y.onError(i)}))})(this,new Fe(ve.ABORTED,"Firestore shutting down"))}}function xw(){return new Yo((s=>nk(s)),pf)}async function By(s,e){const t=jt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new UM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Uy(d,`Initialization of query '${Dl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Fy(t)}async function zy(s,e){const t=jt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function zM(s,e){const t=jt(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Fy(t)}function FM(s,e,t){const i=jt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Fy(s){s.Ca.forEach((e=>{e.next()}))}var zg,_w;(_w=zg||(zg={})).Ma="default",_w.Cache="cache";class qy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Xl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zg.Cache}}class Vk{constructor(e){this.key=e}}class Uk{constructor(e){this.key=e}}class qM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Kt(),this.mutatedKeys=Kt(),this.eu=sk(e),this.tu=new Fl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new ww,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,g=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,k)=>{const S=l.get(b),R=gf(this.query,k)?k:null,q=!!S&&this.mutatedKeys.has(S.key),$=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let U=!1;S&&R?S.data.isEqual(R.data)?q!==$&&(i.track({type:3,doc:R}),U=!0):this.su(S,R)||(i.track({type:2,doc:R}),U=!0,(y&&this.eu(R,y)>0||g&&this.eu(R,g)<0)&&(p=!0)):!S&&R?(i.track({type:0,doc:R}),U=!0):S&&!R&&(i.track({type:1,doc:S}),U=!0,(y||g)&&(p=!0)),U&&(R?(d=d.add(R),u=$?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,k)=>(function(R,q){const $=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pt(20277,{Vt:U})}};return $(R)-$(q)})(b.type,k.type)||this.eu(b.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,g=y!==this.Xa;return this.Xa=y,d.length!==0||g?{snapshot:new Xl(this.query,e.tu,u,d,e.mutatedKeys,y===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ww,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Kt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Uk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Vk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Hy="SyncEngine";class HM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $M{constructor(e){this.key=e,this.hu=!1}}class WM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Yo((p=>nk(p)),pf),this.Iu=new Map,this.Eu=new Set,this.Ru=new $n(it.comparator),this.Au=new Map,this.Vu=new Ay,this.du={},this.mu=new Map,this.fu=Ql.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GM(s,e,t=!0){const i=$k(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Bk(i,e,t,!0),l}async function KM(s,e){const t=$k(s);await Bk(t,e,!0,!1)}async function Bk(s,e,t,i){const l=await fM(s.localStore,Ni(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await YM(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Ik(s.remoteStore,l),p}async function YM(s,e,t,i,l){s.pu=(k,S,R)=>(async function($,U,W,G){let Q=U.view.ru(W);Q.Ss&&(Q=await mw($.localStore,U.query,!1).then((({documents:C})=>U.view.ru(C,Q))));const me=G&&G.targetChanges.get(U.targetId),ke=G&&G.targetMismatches.get(U.targetId)!=null,xe=U.view.applyChanges(Q,$.isPrimaryClient,me,ke);return Ew($,U.targetId,xe.au),xe.snapshot})(s,k,S,R);const u=await mw(s.localStore,e,!0),d=new qM(e,u.ks),p=d.ru(u.documents),y=Vu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),g=d.applyChanges(p,s.isPrimaryClient,y);Ew(s,t,g.au);const b=new HM(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),g.snapshot}async function QM(s,e,t){const i=jt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!pf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Ug(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Dy(i.remoteStore,l.targetId),Fg(i,l.targetId)})).catch(sc)):(Fg(i,l.targetId),await Ug(i.localStore,l.targetId,!0))}async function XM(s,e){const t=jt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Dy(t.remoteStore,i.targetId))}async function JM(s,e,t){const i=i6(s);try{const l=await(function(d,p){const y=jt(d),g=Dt.now(),b=p.reduce(((R,q)=>R.add(q.key)),Kt());let k,S;return y.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let q=ma(),$=Kt();return y.xs.getEntries(R,b).next((U=>{q=U,q.forEach(((W,G)=>{G.isValidDocument()||($=$.add(W))}))})).next((()=>y.localDocuments.getOverlayedDocuments(R,q))).next((U=>{k=U;const W=[];for(const G of p){const Q=hI(G,k.get(G.key).overlayedDocument);Q!=null&&W.push(new co(G.key,Q,K_(Q.value.mapValue),cr.exists(!0)))}return y.mutationQueue.addMutationBatch(R,g,W,p)})).next((U=>{S=U;const W=U.applyToLocalDocumentSet(k,$);return y.documentOverlayCache.saveOverlays(R,U.batchId,W)}))})).then((()=>({batchId:S.batchId,changes:ik(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,y){let g=d.du[d.currentUser.toKey()];g||(g=new $n(Gt)),g=g.insert(p,y),d.du[d.currentUser.toKey()]=g})(i,l.batchId,t),await Bu(i,l.changes),await Ef(i.remoteStore)}catch(l){const u=Uy(l,"Failed to persist write");t.reject(u)}}async function zk(s,e){const t=jt(s);try{const i=await uM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(pn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?pn(d.hu,14607):l.removedDocuments.size>0&&(pn(d.hu,42227),d.hu=!1))})),await Bu(t,i,e)}catch(i){await sc(i)}}function kw(s,e,t){const i=jt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const y=jt(d);y.onlineState=p;let g=!1;y.queries.forEach(((b,k)=>{for(const S of k.ba)S.va(p)&&(g=!0)})),g&&Fy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ZM(s,e,t){const i=jt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new $n(it.comparator);d=d.insert(u,Qs.newNoDocument(u,_t.min()));const p=Kt().add(u),y=new xf(_t.min(),new Map,new $n(Gt),d,p);await zk(i,y),i.Ru=i.Ru.remove(u),i.Au.delete(e),$y(i)}else await Ug(i.localStore,e,!1).then((()=>Fg(i,e,t))).catch(sc)}async function e6(s,e){const t=jt(s),i=e.batch.batchId;try{const l=await cM(t.localStore,e);qk(t,i,null),Fk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bu(t,l)}catch(l){await sc(l)}}async function t6(s,e,t){const i=jt(s);try{const l=await(function(d,p){const y=jt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return y.mutationQueue.lookupMutationBatch(g,p).next((k=>(pn(k!==null,37113),b=k.keys(),y.mutationQueue.removeMutationBatch(g,k)))).next((()=>y.mutationQueue.performConsistencyCheck(g))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(g,b,p))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>y.localDocuments.getDocuments(g,b)))}))})(i.localStore,e);qk(i,e,t),Fk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bu(i,l)}catch(l){await sc(l)}}function Fk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function qk(s,e,t){const i=jt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Fg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Hk(s,i)}))}function Hk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Dy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),$y(s))}function Ew(s,e,t){for(const i of t)i instanceof Vk?(s.Vu.addReference(i.key,e),n6(s,i)):i instanceof Uk?($e(Hy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Hk(s,i.key)):pt(19791,{wu:i})}function n6(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||($e(Hy,"New document in limbo: "+t),s.Eu.add(i),$y(s))}function $y(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new it(An.fromString(e)),i=s.fu.next();s.Au.set(i,new $M(t)),s.Ru=s.Ru.insert(t,i),Ik(s.remoteStore,new Ka(Ni(mf(t.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function Bu(s,e,t){const i=jt(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,y)=>{d.push(i.pu(y,e,t).then((g=>{if((g||t)&&i.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(g){l.push(g);const b=Iy.Es(y.targetId,g);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,g){const b=jt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>je.forEach(g,(S=>je.forEach(S.Ts,(R=>b.persistence.referenceDelegate.addReference(k,S.targetId,R))).next((()=>je.forEach(S.Is,(R=>b.persistence.referenceDelegate.removeReference(k,S.targetId,R)))))))))}catch(k){if(!rc(k))throw k;$e(My,"Failed to update sequence numbers: "+k)}for(const k of g){const S=k.targetId;if(!k.fromCache){const R=b.vs.get(S),q=R.snapshotVersion,$=R.withLastLimboFreeSnapshotVersion(q);b.vs=b.vs.insert(S,$)}}})(i.localStore,u))}async function s6(s,e){const t=jt(s);if(!t.currentUser.isEqual(e)){$e(Hy,"User change. New user:",e.toKey());const i=await Ck(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((y=>{y.reject(new Fe(ve.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bu(t,i.Ns)}}function r6(s,e){const t=jt(s),i=t.Au.get(e);if(i&&i.hu)return Kt().add(i.key);{let l=Kt();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function $k(s){const e=jt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=zk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZM.bind(null,e),e.Pu.J_=zM.bind(null,e.eventManager),e.Pu.yu=FM.bind(null,e.eventManager),e}function i6(s){const e=jt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t6.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return lM(this.persistence,new iM,e.initialUser,this.serializer)}Cu(e){return new Sk(Ry.Vi,this.serializer)}Du(e){return new pM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class a6 extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){pn(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new HI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?gr.withCacheSize(this.cacheSizeBytes):gr.DEFAULT;return new Sk((i=>Yh.Vi(i,t)),this.serializer)}}class qg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=s6.bind(null,this.syncEngine),await VM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BM})()}createDatastore(e){const t=_f(e.databaseInfo.databaseId),i=wM(e.databaseInfo);return TM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new SM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>kw(this.syncEngine,t,0)),(function(){return yw.v()?new yw:new gM})())}createSyncEngine(e,t){return(function(l,u,d,p,y,g,b){const k=new WM(l,u,d,p,y,g);return b&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=jt(t);$e(zo,"RemoteStore shutting down."),i.Ea.add(5),await Uu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}qg.provider={build:()=>new qg};class Wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):fa("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const io="FirestoreClient";class o6{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Ys.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{$e(io,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>($e(io,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new la;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Uy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gp(s,e){s.asyncQueue.verifyOperationInProgress(),$e(io,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Ck(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Tw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await l6(s);$e(io,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>bw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>bw(e.remoteStore,l))),s._onlineComponents=e}async function l6(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){$e(io,"Using user provided OfflineComponentProvider");try{await Gp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===ve.FAILED_PRECONDITION||l.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Hl("Error using user provided cache. Falling back to memory cache: "+t),await Gp(s,new Xh)}}else $e(io,"Using default OfflineComponentProvider"),await Gp(s,new a6(void 0));return s._offlineComponents}async function Wk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?($e(io,"Using user provided OnlineComponentProvider"),await Tw(s,s._uninitializedComponentsProvider._online)):($e(io,"Using default OnlineComponentProvider"),await Tw(s,new qg))),s._onlineComponents}function c6(s){return Wk(s).then((e=>e.syncEngine))}async function Jh(s){const e=await Wk(s),t=e.eventManager;return t.onListen=GM.bind(null,e.syncEngine),t.onUnlisten=QM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XM.bind(null,e.syncEngine),t}function u6(s,e,t,i){const l=new Wy(i),u=new qy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>By(await Jh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>zy(await Jh(s),u)))}}function d6(s,e,t={}){const i=new la;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,y,g){const b=new Wy({next:S=>{b.Nu(),d.enqueueAndForget((()=>zy(u,k)));const R=S.docs.has(p);!R&&S.fromCache?g.reject(new Fe(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&S.fromCache&&y&&y.source==="server"?g.reject(new Fe(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(S)},error:S=>g.reject(S)}),k=new qy(mf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return By(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function h6(s,e,t={}){const i=new la;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,y,g){const b=new Wy({next:S=>{b.Nu(),d.enqueueAndForget((()=>zy(u,k))),S.fromCache&&y.source==="server"?g.reject(new Fe(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(S)},error:S=>g.reject(S)}),k=new qy(p,b,{includeMetadataChanges:!0,Ka:!0});return By(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function f6(s,e){const t=new la;return s.asyncQueue.enqueueAndForget((async()=>JM(await c6(s),e,t))),t.promise}function Gk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const m6="ComponentProvider",jw=new Map;function p6(s,e,t,i,l){return new LR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Gk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Kk="firestore.googleapis.com",Sw=!0;class Cw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Kk,this.ssl=Sw}else this.host=e.host,this.ssl=e.ssl??Sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FI)throw new Fe(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Gk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Fe(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Fe(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Fe(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new fR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Fe(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=jw.get(t);i&&($e(m6,"Removing Datastore"),jw.delete(t),i.terminate())})(this),Promise.resolve()}}function g6(s,e,t,i={}){s=lr(s,Tf);const l=ao(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(iy(`https://${p}`),ay("Firestore",!0)),u.host!==Kk&&u.host!==p&&Hl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...u,host:p,ssl:l,emulatorOptions:i};if(!ua(y,d)&&(s._setSettings(y),i.mockUserToken)){let g,b;if(typeof i.mockUserToken=="string")g=i.mockUserToken,b=Ys.MOCK_USER;else{g=zx(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new Fe(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ys(k)}s._authCredentials=new mR(new O_(g,b))}}class ya{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ya(this.firestore,e,this._query)}}class Yn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Za(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yn(this.firestore,e,this._key)}toJSON(){return{type:Yn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ou(t,Yn._jsonSchema))return new Yn(e,i||null,new it(An.fromString(t.referencePath)))}}Yn._jsonSchemaVersion="firestore/documentReference/1.0",Yn._jsonSchema={type:bs("string",Yn._jsonSchemaVersion),referencePath:bs("string")};class Za extends ya{constructor(e,t,i){super(e,t,mf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yn(this.firestore,null,new it(e))}withConverter(e){return new Za(this.firestore,e,this._path)}}function ut(s,e,...t){if(s=gn(s),P_("collection","path",e),s instanceof Tf){const i=An.fromString(e,...t);return z2(i),new Za(s,null,i)}{if(!(s instanceof Yn||s instanceof Za))throw new Fe(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(An.fromString(e,...t));return z2(i),new Za(s.firestore,null,i)}}function qe(s,e,...t){if(s=gn(s),arguments.length===1&&(e=wy.newId()),P_("doc","path",e),s instanceof Tf){const i=An.fromString(e,...t);return B2(i),new Yn(s,null,new it(i))}{if(!(s instanceof Yn||s instanceof Za))throw new Fe(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(An.fromString(e,...t));return B2(i),new Yn(s.firestore,s instanceof Za?s.converter:null,new it(i))}}const Nw="AsyncQueue";class Aw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ak(this,"async_queue_retry"),this._c=()=>{const i=Wp();i&&$e(Nw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new la;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!rc(e))throw e;$e(Nw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,fa("INTERNAL UNHANDLED ERROR: ",Rw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Vy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&pt(47125,{Pc:Rw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Rw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Mi extends Tf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Aw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Aw(e),this._firestoreClient=void 0,await e}}}function y6(s,e){const t=typeof s=="object"?s:Ru(),i=typeof s=="string"?s:Hh,l=Go(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Vx("firestore");u&&g6(l,...u)}return l}function zu(s){if(s._terminated)throw new Fe(ve.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||v6(s),s._firestoreClient}function v6(s){const e=s._freezeSettings(),t=p6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new o6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr($s.fromBase64String(e))}catch(t){throw new Fe(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wr($s.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:bs("string",Wr._jsonSchemaVersion),bytes:bs("string")};class jf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Fe(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xo{constructor(e){this._methodName=e}}class Ri{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Fe(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Fe(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Gt(this._lat,e._lat)||Gt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ri._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,Ri._jsonSchema))return new Ri(e.latitude,e.longitude)}}Ri._jsonSchemaVersion="firestore/geoPoint/1.0",Ri._jsonSchema={type:bs("string",Ri._jsonSchemaVersion),latitude:bs("number"),longitude:bs("number")};class ci{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ci._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,ci._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ci(e.vectorValues);throw new Fe(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ci._jsonSchemaVersion="firestore/vectorValue/1.0",ci._jsonSchema={type:bs("string",ci._jsonSchemaVersion),vectorValues:bs("object")};const b6=/^__.*__$/;class w6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pu(e,this.data,t,this.fieldTransforms)}}class Yk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new co(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pt(40011,{dataSource:s})}}class Sf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Qk(this.dataSource)&&b6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class x6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_f(e)}createContext(e,t,i,l=!1){return new Sf({dataSource:e,methodName:t,targetDoc:i,path:Hs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fu(s){const e=s._freezeSettings(),t=_f(s._databaseId);return new x6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Gy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Jy("Data must be an object, but it was:",d,i);const p=eE(i,d);let y,g;if(u.merge)y=new Rr(d.fieldMask),g=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const k of u.mergeFields){const S=Fo(e,k,t);if(!d.contains(S))throw new Fe(ve.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);sE(b,S)||b.push(S)}y=new Rr(b),g=d.fieldTransforms.filter((k=>y.covers(k.field)))}else y=null,g=d.fieldTransforms;return new w6(new yr(p),y,g)}class Cf extends Xo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}function Xk(s,e,t){return new Sf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ky extends Xo{_toFieldTransform(e){return new vf(e.path,new _u)}isEqual(e){return e instanceof Ky}}class Yy extends Xo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>Jo(u,t))),l=new Kl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Yy&&ua(this.Ac,e.Ac)}}class Qy extends Xo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>Jo(u,t))),l=new Yl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Qy&&ua(this.Ac,e.Ac)}}class Xy extends Xo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new ku(e.serializer,lk(e.serializer,this.Vc));return new vf(e.path,t)}isEqual(e){return e instanceof Xy&&this.Vc===e.Vc}}function Jk(s,e,t,i){const l=s.createContext(1,e,t);Jy("Data must be an object, but it was:",l,i);const u=[],d=yr.empty();lo(i,((y,g)=>{const b=nE(e,y,t);g=gn(g);const k=l.childContextForFieldPath(b);if(g instanceof Cf)u.push(b);else{const S=Jo(g,k);S!=null&&(u.push(b),d.set(b,S))}}));const p=new Rr(u);return new Yk(d,p,l.fieldTransforms)}function Zk(s,e,t,i,l,u){const d=s.createContext(1,e,t),p=[Fo(e,i,t)],y=[l];if(u.length%2!=0)throw new Fe(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<u.length;S+=2)p.push(Fo(e,u[S])),y.push(u[S+1]);const g=[],b=yr.empty();for(let S=p.length-1;S>=0;--S)if(!sE(g,p[S])){const R=p[S];let q=y[S];q=gn(q);const $=d.childContextForFieldPath(R);if(q instanceof Cf)g.push(R);else{const U=Jo(q,$);U!=null&&(g.push(R),b.set(R,U))}}const k=new Rr(g);return new Yk(b,k,d.fieldTransforms)}function _6(s,e,t,i=!1){return Jo(t,s.createContext(i?4:3,e))}function Jo(s,e){if(tE(s=gn(s)))return Jy("Unsupported field value:",e,s),eE(s,e);if(s instanceof Xo)return(function(i,l){if(!Qk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let y=Jo(p,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),u.push(y),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=gn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return lk(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Dt.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Dt){const u=new Dt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ri)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Wr)return{bytesValue:vk(l.serializer,i._byteString)};if(i instanceof Yn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ny(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ci)return(function(d,p){const y=d instanceof ci?d.toArray():d;return{mapValue:{fields:{[W_]:{stringValue:G_},[$h]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return jy(p.serializer,b)}))}}}}}})(i,l);if(Tk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${uf(i)}`)})(s,e)}function eE(s,e){const t={};return B_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(s,((i,l)=>{const u=Jo(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function tE(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Dt||s instanceof Ri||s instanceof Wr||s instanceof Yn||s instanceof Xo||s instanceof ci||Tk(s))}function Jy(s,e,t){if(!tE(t)||!V_(t)){const i=uf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Fo(s,e,t){if((e=gn(e))instanceof jf)return e._internalPath;if(typeof e=="string")return nE(s,e);throw Zh("Field path arguments must be of type string or ",s,!1,void 0,t)}const k6=new RegExp("[~\\*/\\[\\]]");function nE(s,e,t){if(e.search(k6)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new jf(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Zh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let y="";return(u||d)&&(y+=" (found",u&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new Fe(ve.INVALID_ARGUMENT,p+s+y)}function sE(s,e){return s.some((t=>t.isEqual(e)))}class E6{convertValue(e,t="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return os(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return lo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>os(i.doubleValue)));return new ci(t)}convertGeoPoint(e){return new Ri(os(e.latitude),os(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const t=to(e);return new Dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=An.fromString(e);pn(Ek(i),9688,{name:e});const l=new bu(i.get(1),i.get(3)),u=new it(i.popFirst(5));return l.isEqual(t)||fa(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Zy extends E6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yn(this.firestore,null,t)}}function Ds(){return new Ky("serverTimestamp")}function T6(...s){return new Yy("arrayUnion",s)}function j6(...s){return new Qy("arrayRemove",s)}function Io(s){return new Xy("increment",s)}const Iw="@firebase/firestore",Mw="4.10.0";function Dw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class rE{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Fo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class S6 extends rE{data(){return super.data()}}function iE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Fe(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e0{}class t0 extends e0{}function sn(s,e,...t){let i=[];e instanceof e0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((y=>y instanceof n0)).length,p=u.filter((y=>y instanceof Nf)).length;if(d>1||d>0&&p>0)throw new Fe(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Nf extends t0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return aE(e._query,t),new ya(e.firestore,e.converter,Dg(e._query,t))}_parse(e){const t=Fu(e.firestore);return(function(u,d,p,y,g,b,k){let S;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Fe(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Ow(k,b);const q=[];for(const $ of k)q.push(Lw(y,u,$));S={arrayValue:{values:q}}}else S=Lw(y,u,k)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Ow(k,b),S=_6(p,d,k,b==="in"||b==="not-in");return ys.create(g,b,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wt(s,e,t){const i=e,l=Fo("where",s);return Nf._create(l,i,t)}class n0 extends e0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:fi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const y of p)aE(d,y),d=Dg(d,y)})(e._query,t),new ya(e.firestore,e.converter,Dg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class s0 extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new s0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new Fe(ve.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new Fe(ve.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xu(u,d)})(e._query,this._field,this._direction);return new ya(e.firestore,e.converter,ZR(e._query,t))}}function Eu(s,e="asc"){const t=e,i=Fo("orderBy",s);return s0._create(i,t)}class r0 extends t0{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new r0(e,t,i)}_apply(e){return new ya(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function Tu(s){return ER("limit",s),r0._create("limit",s,"F")}function Lw(s,e,t){if(typeof(t=gn(t))=="string"){if(t==="")throw new Fe(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tk(e)&&t.indexOf("/")!==-1)throw new Fe(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(An.fromString(t));if(!it.isDocumentKey(i))throw new Fe(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Y2(s,new it(i))}if(t instanceof Yn)return Y2(s,t._key);throw new Fe(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Ow(s,e){if(!Array.isArray(s)||s.length===0)throw new Fe(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aE(s,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Fe(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function i0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class iu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends rE{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Fo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Do._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:bs("string",Do._jsonSchemaVersion),bundleSource:bs("string","DocumentSnapshot"),bundleName:bs("string"),bundle:bs("string")};class Rh extends Do{data(e={}){return super.data(e)}}class Lo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new iu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Rh(this._firestore,this._userDataWriter,i.key,i,new iu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Fe(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const y=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const y=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let g=-1,b=-1;return p.type!==0&&(g=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:C6(p.type),doc:y,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function C6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pt(61501,{type:s})}}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:bs("string",Lo._jsonSchemaVersion),bundleSource:bs("string","QuerySnapshot"),bundleName:bs("string"),bundle:bs("string")};class N6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fu(e)}set(e,t,i){this._verifyNotCommitted();const l=Kp(e,this._firestore),u=i0(l.converter,t,i),d=Gy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,cr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Kp(e,this._firestore);let d;return d=typeof(t=gn(t))=="string"||t instanceof jf?Zk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Jk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,cr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kp(e,this._firestore);return this._mutations=this._mutations.concat(new wf(t._key,cr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Fe(ve.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kp(s,e){if((s=gn(s)).firestore!==e)throw new Fe(ve.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function vs(s){s=lr(s,Yn);const e=lr(s.firestore,Mi),t=zu(e);return d6(t,s._key).then((i=>lE(e,s,i)))}function Qt(s){s=lr(s,ya);const e=lr(s.firestore,Mi),t=zu(e),i=new Zy(e);return iE(s._query),h6(t,s._query).then((l=>new Lo(e,i,s,l)))}function Ss(s,e,t){s=lr(s,Yn);const i=lr(s.firestore,Mi),l=i0(s.converter,e,t),u=Fu(i);return qu(i,[Gy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,cr.none())])}function ls(s,e,t,...i){s=lr(s,Yn);const l=lr(s.firestore,Mi),u=Fu(l);let d;return d=typeof(e=gn(e))=="string"||e instanceof jf?Zk(u,"updateDoc",s._key,e,t,i):Jk(u,"updateDoc",s._key,e),qu(l,[d.toMutation(s._key,cr.exists(!0))])}function Ar(s){return qu(lr(s.firestore,Mi),[new wf(s._key,cr.none())])}function vr(s,e){const t=lr(s.firestore,Mi),i=qe(s),l=i0(s.converter,e),u=Fu(s.firestore);return qu(t,[Gy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,cr.exists(!1))]).then((()=>i))}function oE(s,...e){s=gn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Dw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dw(e[i])){const g=e[i];e[i]=g.next?.bind(g),e[i+1]=g.error?.bind(g),e[i+2]=g.complete?.bind(g)}let u,d,p;if(s instanceof Yn)d=lr(s.firestore,Mi),p=mf(s._key.path),u={next:g=>{e[i]&&e[i](lE(d,s,g))},error:e[i+1],complete:e[i+2]};else{const g=lr(s,ya);d=lr(g.firestore,Mi),p=g._query;const b=new Zy(d);u={next:k=>{e[i]&&e[i](new Lo(d,b,g,k))},error:e[i+1],complete:e[i+2]},iE(s._query)}const y=zu(d);return u6(y,p,l,u)}function qu(s,e){const t=zu(s);return f6(t,e)}function lE(s,e,t){const i=t.docs.get(e._key),l=new Zy(s);return new Do(s,l,e._key,i,new iu(t.hasPendingWrites,t.fromCache),e.converter)}function Pw(s){return s=lr(s,Mi),zu(s),new N6(s,(e=>qu(s,e)))}(function(e,t=!0){hR(Ko),di(new Kr("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Mi(new pR(i.getProvider("auth-internal")),new vR(d,i.getProvider("app-check-internal")),OR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),br(Iw,Mw,e),br(Iw,Mw,"esm2020")})();var A6="firebase",R6="12.8.0";br(A6,R6,"app");const cE="firebasestorage.googleapis.com",uE="storageBucket",I6=120*1e3,M6=600*1e3;class Xn extends pi{constructor(e,t,i=0){super(Yp(e),`Firebase Storage: ${t} (${Yp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Xn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Qn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Qn||(Qn={}));function Yp(s){return"storage/"+s}function a0(){const s="An unknown error occurred, please check the error payload for server response.";return new Xn(Qn.UNKNOWN,s)}function D6(s){return new Xn(Qn.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function L6(s){return new Xn(Qn.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function O6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Xn(Qn.UNAUTHENTICATED,s)}function P6(){return new Xn(Qn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function V6(s){return new Xn(Qn.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function U6(){return new Xn(Qn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function B6(){return new Xn(Qn.CANCELED,"User canceled the upload/download.")}function z6(s){return new Xn(Qn.INVALID_URL,"Invalid URL '"+s+"'.")}function F6(s){return new Xn(Qn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function q6(){return new Xn(Qn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uE+"' property when initializing the app?")}function H6(){return new Xn(Qn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $6(){return new Xn(Qn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function W6(s){return new Xn(Qn.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Hg(s){return new Xn(Qn.INVALID_ARGUMENT,s)}function dE(){return new Xn(Qn.APP_DELETED,"The Firebase app was deleted.")}function G6(s){return new Xn(Qn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hu(s,e){return new Xn(Qn.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Yc(s){throw new Xn(Qn.INTERNAL_ERROR,"Internal error: "+s)}class or{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=or.makeFromUrl(e,t)}catch{return new or(e,"")}if(i.path==="")return i;throw F6(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(me){me.path.charAt(me.path.length-1)==="/"&&(me.path_=me.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function g(me){me.path_=decodeURIComponent(me.path)}const b="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",R=new RegExp(`^https?://${k}/${b}/b/${l}/o${S}`,"i"),q={bucket:1,path:3},$=t===cE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",W=new RegExp(`^https?://${$}/${l}/${U}`,"i"),Q=[{regex:p,indices:y,postModify:u},{regex:R,indices:q,postModify:g},{regex:W,indices:{bucket:1,path:2},postModify:g}];for(let me=0;me<Q.length;me++){const ke=Q[me],xe=ke.regex.exec(e);if(xe){const C=xe[ke.indices.bucket];let T=xe[ke.indices.path];T||(T=""),i=new or(C,T),ke.postModify(i);break}}if(i==null)throw z6(e);return i}}class K6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Y6(s,e,t){let i=1,l=null,u=null,d=!1,p=0;function y(){return p===2}let g=!1;function b(...U){g||(g=!0,e.apply(null,U))}function k(U){l=setTimeout(()=>{l=null,s(R,y())},U)}function S(){u&&clearTimeout(u)}function R(U,...W){if(g){S();return}if(U){S(),b.call(null,U,...W);return}if(y()||d){S(),b.call(null,U,...W);return}i<64&&(i*=2);let Q;p===1?(p=2,Q=0):Q=(i+Math.random())*1e3,k(Q)}let q=!1;function $(U){q||(q=!0,S(),!g&&(l!==null?(U||(p=2),clearTimeout(l),k(0)):U||(p=1)))}return k(0),u=setTimeout(()=>{d=!0,$(!0)},t),$}function Q6(s){s(!1)}function X6(s){return s!==void 0}function J6(s){return typeof s=="object"&&!Array.isArray(s)}function o0(s){return typeof s=="string"||s instanceof String}function Vw(s){return l0()&&s instanceof Blob}function l0(){return typeof Blob<"u"}function $g(s,e,t,i){if(i<e)throw Hg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Hg(`Invalid value for '${s}'. Expected ${t} or less.`)}function Af(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function hE(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Oo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Oo||(Oo={}));function Z6(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class eD{constructor(e,t,i,l,u,d,p,y,g,b,k,S=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=y,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=k,this.retry=S,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((q,$)=>{this.resolve_=q,this.reject_=$,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new hh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const y=p.loaded,g=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,g)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Oo.NO_ERROR,y=u.getStatus();if(!p||Z6(y,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Oo.ABORT;i(!1,new hh(!1,null,b));return}const g=this.successCodes_.indexOf(y)!==-1;i(!0,new hh(g,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(p,p.getResponse());X6(y)?u(y):u()}catch(y){d(y)}else if(p!==null){const y=a0();y.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,y)):d(y)}else if(l.canceled){const y=this.appDelete_?dE():B6();d(y)}else{const y=U6();d(y)}};this.canceled_?t(!1,new hh(!1,null,!0)):this.backoffId_=Y6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Q6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function tD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function nD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function rD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function iD(s,e,t,i,l,u,d=!0,p=!1){const y=hE(s.urlParams),g=s.url+y,b=Object.assign({},s.headers);return sD(b,e),tD(b,t),nD(b,u),rD(b,i),new eD(g,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,p)}function aD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oD(...s){const e=aD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(l0())return new Blob(s);throw new Xn(Qn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function cD(s){if(typeof atob>"u")throw W6("base-64");return atob(s)}const ji={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Qp{constructor(e,t){this.data=e,this.contentType=t||null}}function uD(s,e){switch(s){case ji.RAW:return new Qp(fE(e));case ji.BASE64:case ji.BASE64URL:return new Qp(mE(s,e));case ji.DATA_URL:return new Qp(hD(e),fD(e))}throw a0()}function fE(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function dD(s){let e;try{e=decodeURIComponent(s)}catch{throw hu(ji.DATA_URL,"Malformed data URL.")}return fE(e)}function mE(s,e){switch(s){case ji.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw hu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case ji.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw hu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=cD(e)}catch(l){throw l.message.includes("polyfill")?l:hu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class pE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw hu(ji.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=mD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function hD(s){const e=new pE(s);return e.base64?mE(ji.BASE64,e.rest):dD(e.rest)}function fD(s){return new pE(s).contentType}function mD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Ga{constructor(e,t){let i=0,l="";Vw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Vw(this.data_)){const i=this.data_,l=lD(i,e,t);return l===null?null:new Ga(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ga(i,!0)}}static getBlob(...e){if(l0()){const t=e.map(i=>i instanceof Ga?i.data_:i);return new Ga(oD.apply(null,t))}else{const t=e.map(d=>o0(d)?uD(ji.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ga(l,!0)}}uploadData(){return this.data_}}function c0(s){let e;try{e=JSON.parse(s)}catch{return null}return J6(e)?e:null}function pD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function gD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function gE(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function yD(s,e){return e}class ar{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||yD}}let fh=null;function vD(s){return!o0(s)||s.length<2?s:gE(s)}function yE(){if(fh)return fh;const s=[];s.push(new ar("bucket")),s.push(new ar("generation")),s.push(new ar("metageneration")),s.push(new ar("name","fullPath",!0));function e(u,d){return vD(d)}const t=new ar("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new ar("size");return l.xform=i,s.push(l),s.push(new ar("timeCreated")),s.push(new ar("updated")),s.push(new ar("md5Hash",null,!0)),s.push(new ar("cacheControl",null,!0)),s.push(new ar("contentDisposition",null,!0)),s.push(new ar("contentEncoding",null,!0)),s.push(new ar("contentLanguage",null,!0)),s.push(new ar("contentType",null,!0)),s.push(new ar("metadata","customMetadata",!0)),fh=s,fh}function bD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new or(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function wD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return bD(i,s),i}function vE(s,e,t){const i=c0(e);return i===null?null:wD(s,i,t)}function xD(s,e,t,i){const l=c0(e);if(l===null||!o0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(g=>{const b=s.bucket,k=s.fullPath,S="/b/"+d(b)+"/o/"+d(k),R=Af(S,t,i),q=hE({alt:"media",token:g});return R+q})[0]}function _D(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Uw="prefixes",Bw="items";function kD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Uw])for(const l of t[Uw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new or(e,u));i.prefixes.push(d)}if(t[Bw])for(const l of t[Bw]){const u=s._makeStorageReference(new or(e,l.name));i.items.push(u)}return i}function ED(s,e,t){const i=c0(t);return i===null?null:kD(s,e,i)}class u0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function d0(s){if(!s)throw a0()}function TD(s,e){function t(i,l){const u=vE(s,l,e);return d0(u!==null),u}return t}function jD(s,e){function t(i,l){const u=ED(s,e,l);return d0(u!==null),u}return t}function SD(s,e){function t(i,l){const u=vE(s,l,e);return d0(u!==null),xD(u,l,s.host,s._protocol)}return t}function h0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=P6():l=O6():t.getStatus()===402?l=L6(s.bucket):t.getStatus()===403?l=V6(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function CD(s){const e=h0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=D6(s.path)),u.serverResponse=l.serverResponse,u}return t}function ND(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Af(d,s.host,s._protocol),y="GET",g=s.maxOperationRetryTime,b=new u0(p,y,jD(s,e.bucket),g);return b.urlParams=u,b.errorHandler=h0(e),b}function AD(s,e,t){const i=e.fullServerUrl(),l=Af(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new u0(l,u,SD(s,t),d);return p.errorHandler=CD(e),p}function RD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function ID(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=RD(null,e)),i}function MD(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let Q="";for(let me=0;me<2;me++)Q=Q+Math.random().toString().slice(2);return Q}const y=p();d["Content-Type"]="multipart/related; boundary="+y;const g=ID(e,i,l),b=_D(g,t),k="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+g.contentType+`\r
\r
`,S=`\r
--`+y+"--",R=Ga.getBlob(k,i,S);if(R===null)throw H6();const q={name:g.fullPath},$=Af(u,s.host,s._protocol),U="POST",W=s.maxUploadRetryTime,G=new u0($,U,TD(s,t),W);return G.urlParams=q,G.headers=d,G.body=R.uploadData(),G.errorHandler=h0(e),G}class DD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Oo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Oo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Oo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Yc("cannot .send() more than once");if(ao(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class LD extends DD{initXhr(){this.xhr_.responseType="text"}}function f0(){return new LD}class qo{constructor(e,t){this._service=e,t instanceof or?this._location=t:this._location=or.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new qo(e,t)}get root(){const e=new or(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gE(this._location.path)}get storage(){return this._service}get parent(){const e=pD(this._location.path);if(e===null)return null;const t=new or(this._location.bucket,e);return new qo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw G6(e)}}function OD(s,e,t){s._throwIfRoot("uploadBytes");const i=MD(s.storage,s._location,yE(),new Ga(e,!0),t);return s.storage.makeRequestWithTokens(i,f0).then(l=>({metadata:l,ref:s}))}function PD(s){const e={prefixes:[],items:[]};return bE(s,e).then(()=>e)}async function bE(s,e,t){const l=await VD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await bE(s,e,l.nextPageToken)}function VD(s,e){e!=null&&typeof e.maxResults=="number"&&$g("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=ND(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,f0)}function UD(s){s._throwIfRoot("getDownloadURL");const e=AD(s.storage,s._location,yE());return s.storage.makeRequestWithTokens(e,f0).then(t=>{if(t===null)throw $6();return t})}function BD(s,e){const t=gD(s._location.path,e),i=new or(s._location.bucket,t);return new qo(s.storage,i)}function zD(s){return/^[A-Za-z]+:\/\//.test(s)}function FD(s,e){return new qo(s,e)}function wE(s,e){if(s instanceof m0){const t=s;if(t._bucket==null)throw q6();const i=new qo(t,t._bucket);return e!=null?wE(i,e):i}else return e!==void 0?BD(s,e):s}function qD(s,e){if(e&&zD(e)){if(s instanceof m0)return FD(s,e);throw Hg("To use ref(service, url), the first argument must be a Storage instance.")}else return wE(s,e)}function zw(s,e){const t=e?.[uE];return t==null?null:or.makeFromBucketSpec(t,s)}function HD(s,e,t,i={}){s.host=`${e}:${t}`;const l=ao(e);l&&(iy(`https://${s.host}/b`),ay("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:zx(u,s.app.options.projectId))}class m0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=cE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=I6,this._maxUploadRetryTime=M6,this._requests=new Set,l!=null?this._bucket=or.makeFromBucketSpec(l,this._host):this._bucket=zw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=or.makeFromBucketSpec(this._url,e):this._bucket=zw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$g("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$g("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new K6(dE());{const d=iD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Fw="@firebase/storage",qw="0.14.0";const xE="storage";function Ih(s,e,t){return s=gn(s),OD(s,e,t)}function Hw(s){return s=gn(s),PD(s)}function Po(s){return s=gn(s),UD(s)}function Ya(s,e){return s=gn(s),qD(s,e)}function $D(s=Ru(),e){s=gn(s);const i=Go(s,xE).getImmediate({identifier:e}),l=Vx("storage");return l&&WD(i,...l),i}function WD(s,e,t,i={}){HD(s,e,t,i)}function GD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new m0(t,i,l,e,Ko)}function KD(){di(new Kr(xE,GD,"PUBLIC").setMultipleInstances(!0)),br(Fw,qw,""),br(Fw,qw,"esm2020")}KD();const _E={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},p0=cy(_E),No=C_(p0),ge=y6(p0),Qa=$D(p0),YD=cy(_E,"secondary"),MO=C_(YD),QD="EYdciKDOi3UYBLk1u8hHams5tmO2",kE=w.createContext();function Mr(){return w.useContext(kE)}function XD({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[p,y]=w.useState(null),[g,b]=w.useState(!0);w.useEffect(()=>{let G=null;const Q=e4(No,me=>{if(t(me),G&&(G(),G=null),me)if(me.uid===QD)l(!0),d(!1),y(null),b(!1);else{l(!1);const ke=sn(ut(ge,"clients"),wt("uid","==",me.uid)),xe=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const T=await vs(qe(ge,"clients",C));T.exists()&&(d(!0),y({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};G=oE(ke,async C=>{if(C.empty)await xe();else{const T=C.docs[0];d(!0),y({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}b(!1)},async C=>{console.error("Error listening to client data:",C),await xe(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{Q(),G&&G()}},[]);const W={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:G=>{y(Q=>Q?{...Q,...G}:G)},resolveClient:async()=>{if(p)return p;const G=localStorage.getItem("mcf_clientId");if(G)try{const Q=await vs(qe(ge,"clients",G));if(Q.exists()){const me={id:Q.id,...Q.data()};return d(!0),y(me),me}}catch(Q){console.error("resolveClient direct read failed:",Q)}if(e){const Q=sn(ut(ge,"clients"),wt("uid","==",e.uid)),me=await Qt(Q);if(!me.empty){const ke={id:me.docs[0].id,...me.docs[0].data()};return d(!0),y(ke),ke}}return null},login:async(G,Q,me=!0)=>(await S2(No,me?jg:gy),await XA(No,G,Q)),signup:async(G,Q,me)=>{await S2(No,jg);const ke=await QA(No,Q.trim().toLowerCase(),me),xe=ke.user,C=qe(ut(ge,"clients")),T={uid:xe.uid,name:G.trim(),email:Q.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Dt.now()};await Ss(C,T),d(!0),y({id:C.id,...T});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return ke},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(No)},resetPassword:G=>YA(No,G),loading:g};return a.jsx(kE.Provider,{value:W,children:s})}const EE=w.createContext();function Li(){return w.useContext(EE)}function JD({children:s}){const[e,t]=w.useState(()=>{const y=localStorage.getItem("theme");return y?y==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:y=>l(y)};return a.jsx(EE.Provider,{value:p,children:s})}const TE=w.createContext();function oc(){return w.useContext(TE)}const ZD=["nutrition","buddies"],e3=[5,10],t3=2,n3=1;function s3({children:s}){const{clientData:e,loading:t}=Mr(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function y(g){return p?!0:!ZD.includes(g)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:y,loading:t,FREE_RANDOMISER_DURATIONS:e3,FREE_RANDOMISER_WEEKLY_LIMIT:t3,FREE_HABIT_LIMIT:n3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(TE.Provider,{value:i,children:s})}function r3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function i3({className:s=""}){const{isDark:e,toggleTheme:t}=Li();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function a3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,p]=w.useState(""),[y,g]=w.useState(!1),[b,k]=w.useState(!1),[S,R]=w.useState(!1),{login:q,resetPassword:$,currentUser:U,isAdmin:W,isClient:G,clientData:Q,loading:me}=Mr(),ke=Zs();if(w.useEffect(()=>{if(!me&&U){if(!U.emailVerified&&Q?.signupSource==="self_signup"){ke("/signup");return}W?ke("/dashboard"):G?ke(r3(Q)):(g(!1),p("No account found. Please sign up or contact your trainer."))}},[me,U,W,G,Q,ke]),me||U)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const xe=async T=>{T.preventDefault(),p(""),g(!0);try{await q(s,t,l)}catch(I){p(I.message||"Failed to log in"),g(!1)}},C=async T=>{if(T.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}g(!0);try{await $(s.trim()),R(!0)}catch(I){I.code==="auth/user-not-found"?p("No account found with this email"):p(I.message||"Failed to send reset email")}g(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(i3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),S?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),R(!1),p("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:xe,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>ke("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function mh({feature:s,children:e}){const{canAccess:t,loading:i}=oc();return i||t(s)?e:a.jsx(Cx,{to:"/upgrade",replace:!0})}function Yr({active:s}){const e=Zs(),{clientData:t}=Mr(),{isPremium:i}=oc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Zo({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),p=w.useRef(0),y=w.useRef(!1),g=w.useCallback(S=>{window.scrollY<=0&&(p.current=S.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(S=>{if(!y.current||l)return;const R=S.touches[0].clientY-p.current;R>20&&window.scrollY<=0&&(S.preventDefault(),i(Math.min((R-20)*.35,80)))},[l]),k=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:g,onTouchMove:b,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Hu(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const p=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const jE=Hu(60,100,100,85,96),o3=Hu(60,100,100,78,94),l3=Hu(60,100,100,82,94);Hu(60,50,50,38,46);const DO=Hu(60,40,40,30,37);function c3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[p,y]=w.useState("below"),[g,b]=w.useState(!1),k=w.useRef(null),S=w.useRef(t);S.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const ke=xe=>xe.preventDefault();return document.addEventListener("touchmove",ke,{passive:!1}),document.addEventListener("wheel",ke,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ke),document.removeEventListener("wheel",ke),document.body.style.overflow=""}},[t]);const R=w.useMemo(()=>t?s.filter(ke=>document.querySelector(ke.selector)):[],[t]),q=R[i],$=i===R.length-1,U=q?.selector,W=w.useCallback(()=>{if(!U)return;const ke=document.querySelector(U);if(!ke){d(null);return}const xe=ke.getBoundingClientRect(),C=8;d({top:xe.top-C,left:xe.left-C,width:xe.width+C*2,height:xe.height+C*2});const T=window.innerHeight-xe.bottom;y(T<260?"above":"below")},[U]);if(w.useEffect(()=>{if(!t||!U)return;b(!0);const ke=document.querySelector(U);if(ke){document.body.style.overflow="",ke.scrollIntoView({behavior:"smooth",block:"center"});let xe=null,C=0,T=0;const I=60,P=()=>{T++;const A=ke.getBoundingClientRect(),De=Math.round(A.top);if(xe!==null&&De===xe?C++:C=0,xe=De,C>=3||T>=I){S.current&&(document.body.style.overflow="hidden"),W(),b(!1);return}V=requestAnimationFrame(P)};let V;const L=setTimeout(()=>{V=requestAnimationFrame(P)},120);return()=>{clearTimeout(L),V&&cancelAnimationFrame(V),S.current&&(document.body.style.overflow="hidden")}}},[t,i,U,W]),w.useEffect(()=>{if(!t)return;const ke=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(W)};return window.addEventListener("scroll",ke,!0),window.addEventListener("resize",ke),()=>{window.removeEventListener("scroll",ke,!0),window.removeEventListener("resize",ke),k.current&&cancelAnimationFrame(k.current)}},[t,W]),!t||!q||R.length===0)return null;const G=()=>{$?e():l(i+1)},Q=()=>{i>0&&l(i-1)},me=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:ke=>{ke.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:G}),u&&a.jsx("div",{className:`st-spotlight${g?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${g?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:R.map((ke,xe)=>a.jsx("span",{className:`st-dot${xe===i?" active":""}${xe<i?" done":""}`},xe))}),a.jsx("h3",{className:"st-title",children:q.title}),a.jsx("p",{className:"st-body",children:q.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:Q,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:G,children:q.cta||($?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:me,children:"Skip tour"})]})]})}const u3="/login/assets/first_workout-B8SFkzJX.PNG",d3="/login/assets/workouts_10-Z5R3u0xH.PNG",h3="/login/assets/workouts_25-CzxSlcAj.PNG",f3="/login/assets/workouts_50-BpzWup3V.PNG",m3="/login/assets/workouts_100-D7_r6tn1.PNG",p3="/login/assets/streak_2-CsRr-XA9.PNG",g3="/login/assets/streak_4-BHO09tbw.PNG",y3="/login/assets/streak_8-DX2UWMko.PNG",v3="/login/assets/nutrition_7-CHVV11fj.PNG",b3="/login/assets/leaderboard_join-BLoId4Hz.PNG",w3="/login/assets/habits_7-Dvki70KO.PNG",x3="/login/assets/starter_streak-CCltAfrC.PNG",_3="/login/assets/consistency_king-Cho2jxBt.PNG",k3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",E3="/login/assets/minute_master-hA2RLkIL.PNG",T3="/login/assets/habit_machine--nFXaIUW.PNG",j3="/login/assets/iron_will-Dh2dTaie.PNG",ui=[{id:"first_workout",img:u3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:d3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:h3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:f3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:m3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:p3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:g3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:y3,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:v3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:b3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:w3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:x3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:_3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:k3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:E3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:T3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:j3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],$w=3,Ww=5,S3=["trained","protein","steps","sleep","water"];function Xp(s){return s.toISOString().split("T")[0]}const Jp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],Qc={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Zp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Xc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function C3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function N3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Mr(),{isDark:d,toggleTheme:p,accent:y,setAccent:g}=Li(),{isPremium:b,FREE_HABIT_LIMIT:k}=oc(),S=Zs(),[R,q]=w.useState(b?Ww:k),$=R,[U,W]=w.useState({hours:0,minutes:0,seconds:0}),[G,Q]=w.useState(0),[me,ke]=w.useState(0),[xe,C]=w.useState(0),[T,I]=w.useState(!1),[P,V]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[L,A]=w.useState(null),[De,tt]=w.useState(0),[X,Ce]=w.useState(0),[Me,Re]=w.useState($w),[Z,O]=w.useState(!1),[se,Ee]=w.useState(!1),[Se,ye]=w.useState([]),[Ne,Ve]=w.useState(null),[We,Ue]=w.useState(!1),Ut=w.useRef(null),[St,Tn]=w.useState(0),[Un,Pt]=w.useState(0),[kt,Xt]=w.useState(null),Ge=w.useCallback((E,D="info")=>{Xt({message:E,type:D}),setTimeout(()=>Xt(null),4e3)},[]),[Cn,le]=w.useState([]),[It,Nt]=w.useState(!1),[gt,Ye]=w.useState(""),[ot,nn]=w.useState(null),[Jt,Jn]=w.useState(null),[Nn,cs]=w.useState(!1),[Zn,Hn]=w.useState(new Set),[Bn,rn]=w.useState(new Set),[Bt,vt]=w.useState({}),[Ct,J]=w.useState({}),[Ae,ht]=w.useState({}),[xt,ft]=w.useState({}),[st,nt]=w.useState({}),[yt,Zt]=w.useState({}),fn=w.useRef(null),Rn=w.useRef(null),ae=w.useRef({}),[Ie,Qe]=w.useState([]),[lt,at]=w.useState(!1),Vt=w.useRef(null),[en,zt]=w.useState([]),[mn,In]=w.useState(""),[Mn,yn]=w.useState(!1),[cn,ws]=w.useState(null),[Ls,Qr]=w.useState([]),[Oi,gi]=w.useState(null),[Ns,xs]=w.useState(!1),us=w.useRef(!1),[Wn,Dn]=w.useState(null),[es,un]=w.useState(!1),ts=w.useRef(!1),Xr=(()=>{const E=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return b&&E.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),E.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),E})();w.useEffect(()=>{!u&&!s&&S("/")},[u,s,S]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&S("/onboarding")},[u,t,S]),w.useEffect(()=>{let E=t?.tourComplete||ts.current;if(!E&&t?.id)try{E=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!E){const D=setTimeout(()=>un(!0),600);return()=>clearTimeout(D)}},[T,t]),w.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const E=setTimeout(()=>Ee(!0),1500);return()=>clearTimeout(E)}}},[T,t]),w.useEffect(()=>{if(t)try{const E=sessionStorage.getItem(`cbDash_${t.id}`);if(E){const D=JSON.parse(E);ke(D.totalWorkouts??0),C(D.habitWeekPct??0),V(D.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),A(D.nutritionTargetData??null),tt(D.todayHabitsCount??0),D.realHabitCount&&q(D.realHabitCount),Ce(D.weeklyWorkouts??0),Re(D.weeklyWorkoutTarget??$w),ye(D.leaderboardTop3??[]),Tn(D.streakWeeks??0),I(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&Ve(t.photoURL),t?.weeklyWorkoutTarget&&Re(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const E=sn(ut(ge,"notifications"),wt("toId","==",t.id)),D=oE(E,K=>{const ue=K.docs.map(Te=>({id:Te.id,...Te.data()}));ue.sort((Te,Le)=>{const be=Te.createdAt?.toMillis?.()||0;return(Le.createdAt?.toMillis?.()||0)-be}),Qe(ue.slice(0,50))},K=>{console.error("Notification listener error:",K),K.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>D()},[t]),w.useEffect(()=>{const E=D=>{Vt.current&&!Vt.current.contains(D.target)&&at(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]),w.useEffect(()=>{if(!t)return;const E=t.id;(async()=>{try{const[D,K,ue]=await Promise.all([Qt(sn(ut(ge,"buddies"),wt("user1","==",E))),Qt(sn(ut(ge,"buddies"),wt("user2","==",E))),Qt(ut(ge,"clients"))]),Te=new Set;[...D.docs,...K.docs].forEach(be=>{const Oe=be.data();Te.add(Oe.user1===E?Oe.user2:Oe.user1)});const Le={};ue.docs.forEach(be=>{Le[be.id]=be.data()}),zt(Array.from(Te).filter(be=>Le[be]).map(be=>({id:be,name:Le[be].name,photoURL:Le[be].photoURL||null})))}catch(D){console.error("Error loading buddies for mentions:",D)}})()},[t]);const _s=Ie.filter(E=>!E.read).length,ks=async()=>{const E=Ie.filter(K=>!K.read);if(!E.length)return;const D=Pw(ge);E.forEach(K=>D.update(qe(ge,"notifications",K.id),{read:!0})),await D.commit()},Es=async()=>{if(!Ie.length)return;const E=Pw(ge);Ie.forEach(D=>E.delete(qe(ge,"notifications",D.id))),await E.commit()},Os=async(E,D,K={})=>{if(!(!t||E===t.id))try{await vr(ut(ge,"notifications"),{toId:E,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:D,read:!1,createdAt:Ds(),...K})}catch(ue){console.error("Notification create error:",ue),ue.code==="permission-denied"&&Ge("Notifications blocked  check Firestore rules","error")}},Jr=(E,D)=>{const K=D==="compose"?fn.current?.selectionStart:null,Te=(K!=null?E.slice(0,K):E).match(/@(\w*)$/);if(Te){yn(!0),ws(D),In(Te[1].toLowerCase());const Le=en.filter(be=>be.name&&be.name.toLowerCase().includes(Te[1].toLowerCase())).slice(0,5);Qr(Le)}else yn(!1),Qr([])},M=(E,D)=>{if(D==="compose"){const K=fn.current,ue=gt,Te=K?.selectionStart??ue.length,Le=ue.slice(0,Te),be=ue.slice(Te),Oe=Le.replace(/@\w*$/,`@${E.name} `);Ye(Oe+be),setTimeout(()=>{K?.focus(),K.selectionStart=K.selectionEnd=Oe.length},0)}else{const ue=(Ct[D]||"").replace(/@\w*$/,`@${E.name} `);J(Te=>({...Te,[D]:ue}))}yn(!1),Qr([])},F=E=>E&&E.split(/(@\w[\w\s]*?\s)/g).map((K,ue)=>K.startsWith("@")&&en.some(Te=>K.trim()===`@${Te.name}`)?a.jsx("span",{className:"mention-highlight",children:K.trim()},ue):K),te=async E=>{const D=E.target.files?.[0];if(!(!D||!t)){if(!D.type.startsWith("image/")){Ge("Please select an image file","error");return}if(D.size>5*1024*1024){Ge("Image must be under 5MB","error");return}Ue(!0);try{const K=await new Promise(Le=>{const be=new Image;be.onload=()=>{const Oe=document.createElement("canvas"),Je=400;let Lt=be.width,Xe=be.height;Lt>Xe?(Xe=Xe/Lt*Je,Lt=Je):(Lt=Lt/Xe*Je,Xe=Je),Oe.width=Lt,Oe.height=Xe,Oe.getContext("2d").drawImage(be,0,0,Lt,Xe),Oe.toBlob(Ot=>Le(Ot),"image/jpeg",.75)},be.src=URL.createObjectURL(D)}),ue=Ya(Qa,`profilePhotos/${t.id}`);await Ih(ue,K);const Te=await Po(ue);await ls(qe(ge,"clients",t.id),{photoURL:Te}),Ve(Te),l({photoURL:Te}),Ge("Profile photo updated!","success")}catch(K){console.error("Photo upload error:",K),Ge("Failed to upload photo","error")}Ue(!1),Ut.current&&(Ut.current.value="")}};w.useEffect(()=>{const E=()=>{const K=new Date,ue=new Date(K);ue.setHours(23,59,59,999);const Te=ue-K,Le=Math.floor(Te/(1e3*60*60)),be=Math.floor(Te%(1e3*60*60)/(1e3*60)),Oe=Math.floor(Te%(1e3*60)/1e3);W({hours:Le,minutes:be,seconds:Oe}),Q(60-Oe)};E();const D=setInterval(E,1e3);return()=>clearInterval(D)},[]),w.useEffect(()=>{const E=setInterval(()=>{Pt(D=>(D+1)%Jp.length)},8e3);return()=>clearInterval(E)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let D=null,K=null;try{const ue=Xp(new Date),Te=ut(ge,"workoutLogs"),Le=sn(Te,wt("clientId","==",t.id));D=await Qt(Le),ke(D.docs.length);const be=new Date,Oe=be.getDay(),Je=Oe===0?6:Oe-1,Lt=new Date(be);Lt.setDate(be.getDate()-Je),Lt.setHours(0,0,0,0);const Xe=Lt.getTime(),Ot=D.docs.filter(On=>{const jn=On.data().completedAt;return jn?(jn.toDate?jn.toDate().getTime():new Date(jn).getTime())>=Xe:!1}).length;Ce(Ot);const[an,ct]=await Promise.all([Qt(sn(ut(ge,"habitLogs"),wt("clientId","==",t.id),wt("date","==",ue))),vs(qe(ge,"customHabits",t.id))]);let Et=Ww;if(ct.exists()){const On=ct.data(),jn=On.habits||[],ds=On.hiddenDefaults||[];Et=S3.filter(yi=>!ds.includes(yi)).length+jn.length}b||(Et=Math.min(Et,k)),q(Et);let Ln=0;if(!an.empty){const On=an.docs[0].data().habits||{};Ln=Object.values(On).filter(Boolean).length}C(Math.round(Ln/Et*100)),tt(Ln);const ss=await vs(qe(ge,"nutritionTargets",t.id));ss.exists()&&(A(ss.data()),K=ss.data());const Vs=await vs(qe(ge,"nutritionLogs",`${t.id}_${ue}`));if(Vs.exists()){const jn=(Vs.data().entries||[]).reduce((ds,Ts)=>({protein:ds.protein+(Ts.protein||0),carbs:ds.carbs+(Ts.carbs||0),fats:ds.fats+(Ts.fats||0),calories:ds.calories+(Ts.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});V(jn)}}catch(ue){console.error("Error loading dashboard stats:",ue)}try{const ue=ut(ge,"clients"),Te=sn(ue,wt("leaderboardOptIn","==",!0)),be=(await Qt(Te)).docs.map(Oe=>({id:Oe.id,name:Oe.data().name,photoURL:Oe.data().photoURL||null}));if(ye(be.slice(0,3)),t?.id){const Oe=be.findIndex(Lt=>Lt.id===t.id),Je=Oe>=0?Oe+1:null;try{const Lt=`lbRank_${t.id}`,Xe=sessionStorage.getItem(Lt);Xe&&Dn(parseInt(Xe,10)),Je&&sessionStorage.setItem(Lt,String(Je))}catch{}}}catch(ue){console.error("Leaderboard preview error:",ue)}try{let ue=0;if(D){const Te=D.docs.map(Le=>Le.data().date).filter(Boolean).sort().reverse();if(Te.length>0){const Le=new Date;let be=new Date(Le);e:for(let Oe=0;Oe<52;Oe++){const Je=new Date(be),Lt=Je.getDay(),Xe=Lt===0?6:Lt-1;Je.setDate(Je.getDate()-Xe),Je.setHours(0,0,0,0);const Ot=new Date(Je);Ot.setDate(Ot.getDate()+7);const an=Xp(Je),ct=Xp(Ot);if(Te.some(Ln=>Ln>=an&&Ln<ct))ue++;else{if(Oe>0)break e;break}be.setDate(be.getDate()-7)}}}Tn(ue)}catch(ue){console.error("Streak computation error:",ue)}I(!0)})()},[s,t,$]),w.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:me,habitWeekPct:xe,nutritionTotals:P,nutritionTargetData:L,todayHabitsCount:De,realHabitCount:R,weeklyWorkouts:X,weeklyWorkoutTarget:Me,leaderboardTop3:Se,streakWeeks:St}))}catch{}},[T,me,xe,P,L,De,X,Me,Se,St,t]),w.useEffect(()=>{if(!(!T||us.current)&&X>=Me&&Me>0){const E=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(E))return;sessionStorage.setItem(E,"1")}catch{}us.current=!0,xs(!0),setTimeout(()=>xs(!1),3500)}},[T,X,Me,t]);const re=w.useCallback(async()=>{if(ts.current=!0,un(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await ls(qe(ge,"clients",t.id),{tourComplete:!0})}catch(E){console.error("Failed to save tour completion:",E)}}},[t,l]),Be=w.useCallback(async E=>{if(Re(E),O(!1),Ee(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await ls(qe(ge,"clients",t.id),{weeklyWorkoutTarget:E})}catch(D){console.error("Failed to save weekly target:",D)}}},[t]),ze=E=>{const D=E.currentTarget,K=D.querySelector(".ripple");K&&K.remove();const ue=D.getBoundingClientRect(),Te=Math.max(ue.width,ue.height),Le=E.clientX-ue.left-Te/2,be=E.clientY-ue.top-Te/2,Oe=document.createElement("span");Oe.className="ripple",Oe.style.cssText=`width:${Te}px;height:${Te}px;left:${Le}px;top:${be}px;`,D.appendChild(Oe),setTimeout(()=>Oe.remove(),600)},He=t?.name?.split(" ")[0]||"there",et=Math.min(Math.round(X/Me*100),100),bt=St>0?Math.min(Math.round(St/12*100),100):0,wn=[{label:"Wk Streak",value:`${St}`,pct:bt,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${X}/${Me}`,pct:et,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${xe}%`,pct:xe,color:"var(--color-primary)",size:"normal"}],As=P.calories>0&&L?.calories&&P.calories>=L.calories*.8,ns=X>=Me&&Me>0,er=De>=$,Zr=(()=>{if(!T)return null;const E=Me-X;return E===1?"1 more workout to hit your weekly goal":E===2?"2 more workouts to hit your weekly goal":$-De===1?"1 habit left to complete today":null})(),Dr=E=>!L||!L[E]?0:Math.min(Math.round(P[E]/L[E]*100),100),wr=(()=>{const E=new Date().getHours(),D=T&&De>=$&&P.calories>0,K=ue=>ue[Math.floor(Date.now()/6e4%ue.length)];return D?K(Qc.allDone):E>=5&&E<12?K(Qc.morning):E>=12&&E<17?K(Qc.afternoon):E>=17&&E<21?K(Qc.evening):K(Qc.night)})(),Ws=T?X===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>S("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:De<$?{label:"DAILY HABITS",message:`${De}/${$} completed`,cta:"Open Habits",action:()=>S("/client/core-buddy/consistency"),pct:xe,ringLabel:`${De}/${$}`}:b&&P.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>S("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,tr=w.useCallback(async()=>{if(t){Nt(!0);try{const E=await Qt(sn(ut(ge,"posts"),wt("authorId","==",t.id),Eu("createdAt","desc"),Tu(30)));le(E.docs.map(K=>({id:K.id,...K.data()})));const D=await Qt(sn(ut(ge,"postLikes"),wt("userId","==",t.id)));Hn(new Set(D.docs.map(K=>K.data().postId)))}catch(E){console.error("Error loading journey:",E)}finally{Nt(!1)}}},[t]);w.useEffect(()=>{T&&t&&tr()},[T,t,tr]);const Rs=E=>{const D=E.target.files?.[0];if(D){if(!D.type.startsWith("image/")){Ge("Please select an image file","error");return}if(D.size>10*1024*1024){Ge("Image must be under 10MB","error");return}nn(D),Jn(URL.createObjectURL(D))}},Pi=()=>{nn(null),Jt&&URL.revokeObjectURL(Jt),Jn(null),Rn.current&&(Rn.current.value="")},Vi=async()=>{if(!(!gt.trim()&&!ot||Nn||!t)){cs(!0);try{let E=null;if(ot){const Te=await C3(ot),Le=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,be=Ya(Qa,`postImages/${t.id}/${Le}`);await Ih(be,Te),E=await Po(be)}await vr(ut(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:gt.trim(),type:E?"image":"text",imageURL:E||null,createdAt:Ds(),likeCount:0,commentCount:0});const K=gt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(K){const Te=new Set;K.forEach(Le=>{const be=Le.slice(1).trim(),Oe=en.find(Je=>Je.name&&Je.name.toLowerCase()===be.toLowerCase());Oe&&!Te.has(Oe.id)&&(Te.add(Oe.id),Os(Oe.id,"mention",{}))})}Ye(""),Pi(),fn.current&&(fn.current.style.height="auto"),await tr();const ue=en.length;Ge(ue>0?`Shared with ${ue} ${ue===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(E){console.error("Error posting:",E),Ge(E?.message||"Failed to post","error")}finally{cs(!1)}}},ei=async E=>{if(window.confirm("Delete this post?"))try{await Ar(qe(ge,"posts",E)),le(D=>D.filter(K=>K.id!==E)),Ge("Post deleted","info")}catch(D){console.error("Delete error:",D),Ge("Failed to delete","error")}},ti=async E=>{if(!t)return;const D=t.id,K=`${E}_${D}`,ue=Zn.has(E),Te=new Set(Zn);ue?Te.delete(E):Te.add(E),Hn(Te),le(Le=>Le.map(be=>be.id===E?{...be,likeCount:Math.max(0,(be.likeCount||0)+(ue?-1:1))}:be));try{if(ue)await Ar(qe(ge,"postLikes",K)),await ls(qe(ge,"posts",E),{likeCount:Io(-1)});else{await Ss(qe(ge,"postLikes",K),{postId:E,userId:D,createdAt:Ds()}),await ls(qe(ge,"posts",E),{likeCount:Io(1)});const Le=Cn.find(be=>be.id===E);Le&&Os(Le.authorId,"like",{postId:E})}}catch(Le){console.error("Like error:",Le),tr()}},Ps=async E=>{try{const D=await Qt(sn(ut(ge,"postComments"),wt("postId","==",E),Eu("createdAt","asc"),Tu(50)));vt(K=>({...K,[E]:D.docs.map(ue=>({id:ue.id,...ue.data()}))}))}catch(D){console.error("Error loading comments:",D)}},xr=E=>{const D=new Set(Bn);D.has(E)?D.delete(E):(D.add(E),Bt[E]||Ps(E)),rn(D)},ni=async E=>{const D=(Ct[E]||"").trim(),K=st[E];if(!(!D&&!K||!t)){ht(ue=>({...ue,[E]:!0}));try{let ue=null;if(K){const Je=Ya(Qa,`comment-images/${Date.now()}_${K.name}`);await Ih(Je,K),ue=await Po(Je)}const Te={postId:E,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:D||"",createdAt:Ds()};ue&&(Te.imageURL=ue);const Le=xt[E];Le&&(Te.replyToId=Le.id,Te.replyToName=Le.authorName),await vr(ut(ge,"postComments"),Te),await ls(qe(ge,"posts",E),{commentCount:Io(1)});const be=Cn.find(Je=>Je.id===E);be&&Os(be.authorId,"comment",{postId:E});const Oe=D.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Oe){const Je=new Set;Oe.forEach(Lt=>{const Xe=Lt.slice(1).trim(),Ot=en.find(an=>an.name&&an.name.toLowerCase()===Xe.toLowerCase());Ot&&!Je.has(Ot.id)&&(Je.add(Ot.id),Os(Ot.id,"mention",{postId:E}))})}J(Je=>({...Je,[E]:""})),nt(Je=>({...Je,[E]:null})),Zt(Je=>({...Je,[E]:null})),ft(Je=>({...Je,[E]:null})),ae.current[E]&&(ae.current[E].value=""),le(Je=>Je.map(Lt=>Lt.id===E?{...Lt,commentCount:(Lt.commentCount||0)+1}:Lt)),await Ps(E)}catch(ue){console.error("Comment error:",ue),Ge("Failed to comment","error")}finally{ht(ue=>({...ue,[E]:!1}))}}},nr=async(E,D)=>{try{await Ar(qe(ge,"postComments",D)),await ls(qe(ge,"posts",E),{commentCount:Io(-1)}),vt(K=>({...K,[E]:(K[E]||[]).filter(ue=>ue.id!==D)})),le(K=>K.map(ue=>ue.id===E?{...ue,commentCount:Math.max((ue.commentCount||1)-1,0)}:ue))}catch(K){console.error("Delete comment error:",K),Ge("Failed to delete comment","error")}},sr=(E,D)=>{const K=D.target.files?.[0];if(!K)return;if(K.size>5*1024*1024){Ge("Image must be under 5MB","error");return}nt(Te=>({...Te,[E]:K}));const ue=new FileReader;ue.onload=Te=>Zt(Le=>({...Le,[E]:Te.target.result})),ue.readAsDataURL(K)},z=E=>{nt(D=>({...D,[E]:null})),Zt(D=>({...D,[E]:null})),ae.current[E]&&(ae.current[E].value="")},de=E=>{Ye(E.target.value),E.target.style.height="auto",E.target.style.height=Math.min(E.target.scrollHeight,120)+"px",Jr(E.target.value,"compose")},ce=(E,D)=>{J(K=>({...K,[E]:D})),Jr(D,E)};return a.jsx(Zo,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:Vt,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{at(!lt),lt||ks()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),_s>0&&a.jsx("span",{className:"header-notif-badge",children:_s>9?"9+":_s})]}),lt&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),Ie.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Es,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:Ie.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):Ie.map(E=>a.jsxs("div",{className:`notif-item${E.read?"":" unread"}`,onClick:()=>{if(at(!1),E.type==="buddy_request"||E.type==="buddy_accept")S(b?"/client/core-buddy/buddies":"/upgrade");else if((E.type==="like"||E.type==="comment")&&E.postId){if(!Bn.has(E.postId)){const D=new Set(Bn);D.add(E.postId),rn(D),Bt[E.postId]||Ps(E.postId)}setTimeout(()=>{const D=document.getElementById(`post-${E.postId}`);D&&D.scrollIntoView({behavior:"smooth",block:"center"})},150)}else E.type==="like"||E.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):E.type==="mention"&&S(`/client/core-buddy/profile/${E.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:E.fromPhotoURL?a.jsx("img",{src:E.fromPhotoURL,alt:""}):a.jsx("span",{children:(E.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:E.fromName})," ",E.type==="buddy_request"&&"sent you a buddy request",E.type==="buddy_accept"&&"accepted your buddy request",E.type==="like"&&"liked your post",E.type==="comment"&&"commented on your post",E.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Zp(E.createdAt)})]})]},E.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>S("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:p,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:jE.map((E,D)=>{const K=D<G;return a.jsx("line",{x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,className:`ring-tick ${K?"elapsed":"remaining"}`,strokeWidth:E.thick?"3":"2"},D)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ut.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Ne||"/Logo.webp",alt:Ne?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${We?" uploading":""}`,children:We?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ut,type:"file",accept:"image/*",onChange:te,style:{display:"none"}})]}),!Ne&&!We&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ut.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(U.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(U.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(U.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Jp[Un].text," ",a.jsx("strong",{children:Jp[Un].bold})]},Un)]}),a.jsx("div",{className:"cb-accent-picker",children:[{key:"red",color:"#A12F3A"},{key:"orange",color:"#FF914D"},{key:"blue",color:"#38B6FF"}].map(E=>a.jsx("button",{className:`cb-accent-dot${y===E.key?" active":""}`,style:{"--dot-color":E.color},onClick:()=>g(E.key),"aria-label":`${E.key} accent`},E.key))}),a.jsx("div",{className:"cb-stats-row",children:wn.map(E=>{const D=(E.size==="large",38),K=2*Math.PI*D,ue=K-E.pct/100*K,Te=E.editable,Le=E.pct>=75&&E.pct<100,be=E.pct>=100;return a.jsxs("div",{className:`cb-stat-item${E.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${Te?" cb-stat-tappable":""}${Te&&se?" cb-stat-hint":""}${Le?" cb-stat-near":""}${be?" cb-stat-complete":""}`,onClick:Te?()=>{O(!0),Ee(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:D}),a.jsx("circle",{className:`cb-stat-fill${Le?" cb-fill-near":""}${be?" cb-fill-complete":""}`,cx:"50",cy:"50",r:D,strokeDasharray:K,strokeDashoffset:ue})]}),a.jsx("span",{className:`cb-stat-value${be?" cb-val-complete":""}`,children:E.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[E.label==="Wk Streak"&&St>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),E.label]})]},E.label)})}),Z&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>O(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:E=>E.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(E=>a.jsx("button",{className:`cb-target-option${E===Me?" active":""}`,onClick:()=>Be(E),children:E},E))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[wr.main," ",a.jsx("strong",{children:He}),"  ",wr.sub]}),Zr&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Zr})]}),Ws&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ws.action||void 0,style:Ws.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ws.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ws.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ws.label}),a.jsx("span",{className:"cb-nudge-title",children:Ws.message}),Ws.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ws.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[b&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${As?" cb-card-done":""}`,onClick:E=>{ze(E),S("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Dr("protein"),color:"var(--color-primary)"},{label:"C",pct:Dr("carbs"),color:"var(--color-primary)"},{label:"F",pct:Dr("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Dr("calories"),color:"var(--color-primary)"}].map(E=>{const K=2*Math.PI*38,ue=K-E.pct/100*K;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:E.color},strokeDasharray:K,strokeDashoffset:ue})]}),a.jsx("span",{style:{color:E.color},children:E.label})]},E.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${ns?" cb-card-done":""}`,onClick:E=>{ze(E),S("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[X," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[me," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${er?" cb-card-done":""}`,onClick:E=>{ze(E),S("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${De>=$?" cb-habits-all-done":""}`,children:Array.from({length:$},(E,D)=>a.jsx("span",{className:`cb-habit-dot${D<De?" done":""}${!D&&De>0&&D>=De?" cb-dot-warming":""}`,style:D>=De&&De>0?{"--glow-intensity":Math.min(De/$,.9)}:void 0},D))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[De,"/",$," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:E=>{ze(E),S("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),Se.length>0?a.jsx("div",{className:"cb-lb-preview",children:Se.map((E,D)=>{const K=["#FFD700","#A8B4C0","#CD7F32"][D],ue=E.name?E.name.split(" ").map(Oe=>Oe[0]).join("").slice(0,2).toUpperCase():"?",Te=E.id===t?.id,Le=D+1,be=Te&&Wn?Wn-Le:0;return a.jsxs("div",{className:`cb-lb-entry${Te?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:K},children:E.photoURL?a.jsx("img",{src:E.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:ue})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:K},children:["#",Le,Te&&be>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",be]}),Te&&be<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:be})]})]},E.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),b&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:E=>{ze(E),S("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:ui.find(E=>E.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:E=>{ze(E),S("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:ui.find(E=>E.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),b&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:E=>{ze(E),S("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),b&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Ne?a.jsx("img",{src:Ne,alt:""}):a.jsx("span",{children:Xc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:fn,placeholder:"Share your progress... (use @ to mention)",value:gt,onChange:de,rows:1,maxLength:500}),Mn&&cn==="compose"&&Ls.length>0&&a.jsx("div",{className:"mention-dropdown",children:Ls.map(E=>a.jsxs("button",{className:"mention-option",onClick:()=>M(E,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:E.photoURL?a.jsx("img",{src:E.photoURL,alt:""}):a.jsx("span",{children:Xc(E.name)})}),a.jsx("span",{children:E.name})]},E.id))}),Jt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:Jt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Pi,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Rn.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Rn,type:"file",accept:"image/*",onChange:Rs,hidden:!0}),(gt.trim()||ot)&&a.jsx("button",{className:"journey-post-btn",onClick:Vi,disabled:Nn,children:Nn?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),It?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):Cn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:Cn.map(E=>a.jsxs("div",{id:`post-${E.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:E.authorPhotoURL?a.jsx("img",{src:E.authorPhotoURL,alt:""}):a.jsx("span",{children:Xc(E.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:E.authorName}),a.jsx("span",{className:"journey-post-time",children:Zp(E.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>ei(E.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),E.type==="workout_summary"&&E.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),E.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:E.metadata.stats.map(D=>`${D.value} ${D.label}`).join("    ")}),!E.metadata.stats?.length&&E.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:E.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):E.type==="badge_earned"&&E.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const D=ui.find(K=>K.id===E.metadata.badgeId);return D?.img?a.jsx("img",{src:D.img,alt:E.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:E.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),E.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:E.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):E.type==="habits_summary"&&E.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),E.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:E.metadata.stats.map(D=>`${D.value} ${D.label}`).join("    ")}),E.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:E.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[E.content&&a.jsx("p",{className:"journey-post-content",children:F(E.content)}),E.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:E.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Zn.has(E.id)?" liked":""}`,onClick:()=>ti(E.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Zn.has(E.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:E.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Bn.has(E.id)?" active":""}`,onClick:()=>xr(E.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:E.commentCount||0})]})]}),Bn.has(E.id)&&a.jsxs("div",{className:"journey-comments",children:[Bt[E.id]?.length>0?Bt[E.id].map(D=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:D.authorPhotoURL?a.jsx("img",{src:D.authorPhotoURL,alt:""}):a.jsx("span",{children:Xc(D.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:D.authorName}),D.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),D.replyToName]}),D.content&&a.jsx("span",{className:"journey-comment-text",children:F(D.content)}),D.imageURL&&a.jsx("img",{className:"journey-comment-image",src:D.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Zp(D.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>ft(K=>({...K,[E.id]:{id:D.id,authorName:D.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>nr(E.id,D.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},D.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),xt[E.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:xt[E.id].authorName})]}),a.jsx("button",{onClick:()=>ft(D=>({...D,[E.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),yt[E.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:yt[E.id],alt:"Preview"}),a.jsx("button",{onClick:()=>z(E.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ae.current[E.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:D=>{ae.current[E.id]=D},type:"file",accept:"image/*",onChange:D=>sr(E.id,D),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Ct[E.id]||"",onChange:D=>ce(E.id,D.target.value),onKeyDown:D=>{D.key==="Enter"&&ni(E.id)},maxLength:300}),Mn&&cn===E.id&&Ls.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ls.map(D=>a.jsxs("button",{className:"mention-option",onClick:()=>M(D,E.id),children:[a.jsx("div",{className:"mention-option-avatar",children:D.photoURL?a.jsx("img",{src:D.photoURL,alt:""}):a.jsx("span",{children:Xc(D.name)})}),a.jsx("span",{children:D.name})]},D.id))}),a.jsx("button",{onClick:()=>ni(E.id),disabled:!(Ct[E.id]||"").trim()&&!st[E.id]||Ae[E.id],children:Ae[E.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},E.id))})]})]}),!b&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>S("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(Yr,{active:"home"}),Ns&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[X,"/",Me," sessions complete"]})]})}),kt&&a.jsxs("div",{className:`toast-notification ${kt.type}`,children:[kt.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),kt.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),kt.message]}),a.jsx(c3,{steps:Xr,active:es,onFinish:re})]})})}async function ef(s,e){const t=ui.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=qe(ge,"coreBuddyBadges",e.id),l=await vs(i),u=l.exists()?l.data().earned||[]:[];if(u.some(p=>p.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await ls(i,{earned:[...u,d]}):await Ss(i,{earned:[d]}),await vr(ut(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:Ds(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function ql({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const eg=new Map;function Hr(){return new Date().toISOString().split("T")[0]}const Gw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],A3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function R3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function I3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Li(),d=Zs(),[p,y]=w.useState("loading"),[g,b]=w.useState(null),[k,S]=w.useState(null),[R,q]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,U]=w.useState(null),[W,G]=w.useState(Hr()),[Q,me]=w.useState({entries:[]}),[ke,xe]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[C,T]=w.useState(!1),[I,P]=w.useState(()=>{const M=new Date;return{year:M.getFullYear(),month:M.getMonth()}}),[V,L]=w.useState(!1),[A,De]=w.useState(()=>{const M=new Date;return{year:M.getFullYear(),month:M.getMonth()}}),[tt,X]=w.useState(!1),[Ce,Me]=w.useState(R3),[Re,Z]=w.useState(null),[O,se]=w.useState(null),[Ee,Se]=w.useState(!1),[ye,Ne]=w.useState(null),[Ve,We]=w.useState(""),[Ue,Ut]=w.useState(!1),[St,Tn]=w.useState(""),[Un,Pt]=w.useState([]),[kt,Xt]=w.useState(!1),[Ge,Cn]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,It]=w.useState(null),[Nt,gt]=w.useState("100"),[Ye,ot]=w.useState(0),[nn,Jt]=w.useState("weight"),[Jn,Nn]=w.useState(0),[cs,Zn]=w.useState(null);w.useRef(null);const Hn=w.useRef(!1),Bn=w.useRef(null),rn=w.useRef(null),Bt=w.useRef(null),vt=w.useCallback((M,F="info")=>{Zn({message:M,type:F}),setTimeout(()=>Zn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const F=await vs(qe(ge,"nutritionTargets",t.id));F.exists()?(b(F.data()),y("dashboard")):y("setup")}catch(F){console.error("Error loading nutrition data:",F),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const F=await vs(qe(ge,"nutritionLogs",`${t.id}_${W}`));if(F.exists()){const te=F.data();me({entries:te.entries||[]})}else me({entries:[]})}catch(F){console.error("Error loading log:",F),me({entries:[]})}})()},[t?.id,W]),w.useEffect(()=>{const M=Q.entries.reduce((F,te)=>({protein:F.protein+(te.protein||0),carbs:F.carbs+(te.carbs||0),fats:F.fats+(te.fats||0),calories:F.calories+(te.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});xe(M)},[Q.entries]);const Ct=async M=>{try{if(await Ss(qe(ge,"nutritionLogs",`${t.id}_${W}`),{clientId:t.id,date:W,entries:M.entries,updatedAt:Dt.now()}),g?.protein&&W===Hr()&&M.entries.reduce((te,re)=>te+(re.protein||0),0)>=g.protein){let te=1;for(let re=1;re<7;re++){const Be=new Date;Be.setDate(Be.getDate()-re);const ze=Be.toISOString().split("T")[0];try{const He=await vs(qe(ge,"nutritionLogs",`${t.id}_${ze}`));if(He.exists())if((He.data().entries||[]).reduce((bt,wn)=>bt+(wn.protein||0),0)>=g.protein)te++;else break;else break}catch{break}}if(te>=7){const re=await ef("nutrition_7",t);re&&S(re)}}}catch(F){console.error("Error saving nutrition log:",F)}},J=W===Hr(),Ae=(M,F)=>new Date(M,F+1,0).getDate(),ht=(M,F)=>new Date(M,F,1).getDay(),xt=M=>{if(M===Hr())return"Today";const F=new Date(M+"T12:00:00"),te=new Date;return te.setDate(te.getDate()-1),M===te.toISOString().split("T")[0]?"Yesterday":F.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},ft=["January","February","March","April","May","June","July","August","September","October","November","December"],st=["Su","Mo","Tu","We","Th","Fr","Sa"],nt=()=>{let M=parseFloat(R.weight);R.weightUnit==="lbs"&&(M*=.453592);let F;R.heightUnit==="cm"?F=parseFloat(R.height):F=(parseFloat(R.heightFeet)||0)*30.48+(parseFloat(R.heightInches)||0)*2.54;const te=parseInt(R.age);let re=R.gender==="male"?10*M+6.25*F-5*te+5:10*M+6.25*F-5*te-161;const ze=re*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[R.dailyActivity],He={low:100,moderate:200,high:300,daily:400},et=Math.round(ze+He[R.trainingFrequency]);let bt=et,wn,As;switch(R.goal){case"lose":bt=et*(1-{light:.15,moderate:.2,harsh:.25}[R.deficitLevel]),wn=2.2,As=.3;break;case"build":bt=et*1.1,wn=2,As=.22;break;default:wn=1.8,As=.25}bt=Math.max(bt,R.gender==="male"?1400:1100);const ns=Math.round(M*wn),er=Math.round(bt*As/9),Zr=Math.max(0,Math.round((bt-ns*4-er*9)/4));U({calories:Math.round(bt),protein:ns,carbs:Zr,fats:er,bmr:Math.round(re),neat:Math.round(ze),exerciseAdd:He[R.trainingFrequency],tdee:Math.round(et)})},yt=async()=>{if($)try{const M={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,goal:R.goal,updatedAt:Dt.now()};await Ss(qe(ge,"nutritionTargets",t.id),M),b(M),y("dashboard"),vt("Macro targets saved!","success")}catch(M){console.error("Error saving targets:",M),vt("Failed to save targets. Please try again.","error")}},Zt=()=>{const M=R.weight&&parseFloat(R.weight)>0,F=R.age&&parseInt(R.age)>0,te=R.heightUnit==="cm"?R.height&&parseFloat(R.height)>0:R.heightFeet&&parseFloat(R.heightFeet)>0||R.heightInches&&parseFloat(R.heightInches)>0;return M&&F&&te},fn="nut_favourite_foods",Rn=()=>{try{return JSON.parse(localStorage.getItem(fn)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const F=await vs(qe(ge,"favouriteFoods",t.id));if(F.exists()){const te=F.data().items||[];localStorage.setItem(fn,JSON.stringify(te)),Nn(re=>re+1)}else{const te=Rn();te.length>0&&await Ss(qe(ge,"favouriteFoods",t.id),{items:te,updatedAt:Dt.now()})}}catch(F){console.error("Error loading favourites:",F)}})()},[t?.id]);const ae=M=>Rn().some(F=>F.name.toLowerCase()===(M||"").toLowerCase()),Ie=M=>{const F=Rn(),te=F.findIndex(re=>re.name.toLowerCase()===M.name.toLowerCase());te>=0?F.splice(te,1):F.unshift({name:M.name,protein:M.protein,carbs:M.carbs,fats:M.fats,calories:M.calories,serving:M.serving,per100g:M.per100g||null,servingUnit:M.servingUnit||"g",portion:M.portion||null}),localStorage.setItem(fn,JSON.stringify(F)),t?.id&&Ss(qe(ge,"favouriteFoods",t.id),{items:F,updatedAt:Dt.now()}).catch(re=>console.error("Error saving favourites:",re)),Nn(re=>re+1)},Qe=M=>{const F=[...Q.entries,{...M,meal:Ce,id:Date.now(),addedAt:new Date().toISOString()}],te={...Q,entries:F};me(te),Ct(te),se(null),It(null),gt("100"),ot(0),Jt("weight"),Cn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),vt("Food added!","success")},lt=M=>{const F=Q.entries.filter(re=>re.id!==M),te={...Q,entries:F};me(te),Ct(te)},at=async M=>{if(!(!t?.id||M===W)){X(!0);try{const F=await vs(qe(ge,"nutritionLogs",`${t.id}_${M}`));if(!F.exists()||!F.data().entries?.length){vt("No food logged on that day","error");return}const te=F.data().entries.map(ze=>({...ze,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),re=[...Q.entries,...te],Be={...Q,entries:re};me(Be),Ct(Be),L(!1),vt(`Copied ${te.length} items from ${xt(M)}`,"success")}catch(F){console.error("Error copying day:",F),vt("Failed to copy day","error")}finally{X(!1)}}},Vt=w.useRef(null),en=w.useRef([]),zt=3,mn=5,In=async()=>{Se(!0);const M=document.querySelector("#barcode-reader");if(!M){Se(!1),vt("Scanner container not found.","error");return}if(!Vt.current)try{const te=await Js(()=>import("./quagga.min-BbicSfvA.js").then(re=>re.q),[]);Vt.current=te.default}catch(te){console.error("Failed to load barcode scanner:",te),Se(!1),vt("Could not load scanner.","error");return}const F=Vt.current;F.init({inputStream:{type:"LiveStream",target:M,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},te=>{if(te){console.error("Quagga init error:",te),Se(!1),vt("Could not access camera. Check permissions.","error");return}F.start(),Hn.current=!0}),en.current=[],F.onDetected(te=>{const re=te.codeResult.decodedCodes?.filter(ze=>ze.error!==void 0)?.map(ze=>ze.error)||[];if((re.length>0?re.reduce((ze,He)=>ze+He,0)/re.length:1)<.15){const ze=te.codeResult.code,He=en.current;He.push(ze),He.length>mn&&He.shift(),He.filter(bt=>bt===ze).length>=zt&&(F.offDetected(),en.current=[],Ne(ze))}})},Mn=()=>{const M=Vt.current;Hn.current&&M&&(M.stop(),M.offDetected(),Hn.current=!1),Se(!1)},yn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,cn=M=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((M||"").replace(/\s/g,"")),ws=M=>{if(!M)return{value:100,unit:"g"};const F=M.toLowerCase().replace(/\s/g,""),te=F.match(/([\d.]+)/),re=te?parseFloat(te[1]):100;return cn(M)?/cl/.test(F)?{value:re*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(F)&&!/ml/.test(F)?{value:re*1e3,unit:"ml"}:{value:re,unit:"ml"}:{value:re,unit:"g"}},Ls=M=>{if(cn(M.serving_size)||cn(M.quantity))return"ml";const F=M.product_name||M.product_name_en||"";return yn.test(F)?"ml":"g"},Qr=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Oi=(M,F)=>{const te=M||"",re=te.match(/\((\d+\.?\d*)\s*g\)/i),Be=te.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(re&&Be){const et=parseFloat(re[1]);let bt=Be[1].replace(/^\d+\s*/,"").trim();if(bt&&et>0)return{label:bt,weight:et}}const ze=te.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(ze){const et=parseFloat(ze[1]);let bt=ze[2].replace(/^\d+\s*/,"").trim();if(bt&&et>0)return{label:bt,weight:et}}const He=F||"";for(const{pattern:et,label:bt,weight:wn}of Qr)if(et.test(He))return{label:bt,weight:wn};return null},gi=M=>{const F=M.nutriments||{},te=Ls(M),re=ws(M.serving_size),Be=te==="ml"?re.unit==="ml"?re.value:100:re.value,ze=M.product_name||M.product_name_en||"Unknown Product",He=Oi(M.serving_size,ze);return{name:ze,brand:M.brands||"",image:M.image_small_url||M.image_url||null,servingSize:M.serving_size||"100g",servingValue:Be,servingUnit:te,portion:He,protein:Math.round(F.proteins_100g||F.proteins||0),carbs:Math.round(F.carbohydrates_100g||F.carbohydrates||0),fats:Math.round(F.fat_100g||F.fat||0),calories:Math.round(F["energy-kcal_100g"]||F["energy-kcal"]||(F.energy_100g?F.energy_100g/4.184:0)),per100g:!0}},Ns=async M=>{Ut(!0);try{const F=`https://world.openfoodfacts.org/api/v2/product/${M}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,te=await fetch(F);if(!te.ok)throw new Error(`HTTP ${te.status}`);const re=await te.json();if(re.status==="success"||re.status===1||re.product){const Be=gi(re.product);Be.calories===0&&Be.protein===0&&Be.carbs===0?vt("Product found but no nutrition data available.","error"):(It(Be),Be.portion?(ot(1),gt(String(Be.portion.weight)),Jt("portion")):(ot(0),gt(String(Be.servingValue||100)),Jt("weight")),We(""))}else vt("Product not found. Try search or manual entry.","error")}catch(F){console.error("Barcode lookup error:",F),vt("Failed to look up product. Check your connection.","error")}Ut(!1)},xs=(M,F,te)=>{const re=M.toLowerCase().trim(),Be=F.toLowerCase().trim(),ze=te.toLowerCase().trim();let He=0;return(re===ze||re===ze+"s"||re+"s"===ze)&&(He+=100),(re.endsWith(" "+ze)||re.endsWith(" "+ze+"s"))&&(He+=40),(re.startsWith(ze+" ")||re.startsWith(ze+"s "))&&(He+=15),ze.split(/\s+/).some(bt=>Be===bt||Be.startsWith(bt))&&(He+=30),He+=Math.max(0,30-re.length),He},us=async()=>{if(!St.trim())return;Bn.current&&Bn.current.abort();const M=new AbortController;Bn.current=M;const F=St.trim().toLowerCase(),te=F.split(/\s+/).filter(Boolean);if(eg.has(F)){Pt(eg.get(F));return}Xt(!0);try{const Be=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(St.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ze=await fetch(Be,{signal:M.signal});if(!ze.ok)throw new Error(`HTTP ${ze.status}`);const et=((await ze.json()).products||[]).map(bt=>gi(bt)).filter(bt=>bt.name!=="Unknown Product"&&(bt.calories>0||bt.protein>0)).filter(bt=>{const wn=(bt.name+" "+bt.brand).toLowerCase();return te.every(As=>wn.includes(As))}).sort((bt,wn)=>xs(wn.name,wn.brand,F)-xs(bt.name,bt.brand,F)).slice(0,10);eg.set(F,et),Pt(et),et.length===0&&vt("No results found. Try a different search.","info")}catch(re){if(re.name==="AbortError")return;console.error("Search error:",re),vt("Search failed. Check your connection.","error")}Xt(!1)};w.useEffect(()=>{if(rn.current&&clearTimeout(rn.current),!(!St.trim()||O!=="search"||le))return rn.current=setTimeout(()=>{us()},700),()=>clearTimeout(rn.current)},[St]);const Wn=l,Dn={"ring-protein":Wn?"#2dd4bf":"#14b8a6","ring-carbs":Wn?"#fbbf24":"#f59e0b","ring-fats":Wn?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},es=80,un=2*Math.PI*es,ts=(M,F,te,re,Be)=>{const ze=re>0?Math.min(100,Math.round(te/re*100)):0,He=un-ze/100*un,et=Dn[Be]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:es}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:es,style:{stroke:et},strokeDasharray:un,strokeDashoffset:He})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:et},children:Math.round(te)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",re,M==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:et},children:F})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:et},children:[ze,"%"]})]})};if(w.useEffect(()=>{if(!ye)return;const M=setTimeout(()=>{const F=ye;Mn(),Ne(null),Ns(F)},1500);return()=>clearTimeout(M)},[ye]),w.useEffect(()=>()=>{const M=Vt.current;if(Hn.current&&M){try{M.stop(),M.offDetected()}catch{}Hn.current=!1}},[]),i||p==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(p==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:R.gender==="male"?"active":"",onClick:()=>{q(M=>({...M,gender:"male"})),U(null)},children:"Male"}),a.jsx("button",{className:R.gender==="female"?"active":"",onClick:()=>{q(M=>({...M,gender:"female"})),U(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:R.age,onChange:M=>{q(F=>({...F,age:M.target.value})),U(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:R.weight,onChange:M=>{q(F=>({...F,weight:M.target.value})),U(null)},placeholder:R.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.weightUnit==="kg"?"active":"",onClick:()=>{q(M=>({...M,weightUnit:"kg"})),U(null)},children:"kg"}),a.jsx("button",{className:R.weightUnit==="lbs"?"active":"",onClick:()=>{q(M=>({...M,weightUnit:"lbs"})),U(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[R.heightUnit==="cm"?a.jsx("input",{type:"number",value:R.height,onChange:M=>{q(F=>({...F,height:M.target.value})),U(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:R.heightFeet,onChange:M=>{q(F=>({...F,heightFeet:M.target.value})),U(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:R.heightInches,onChange:M=>{q(F=>({...F,heightInches:M.target.value})),U(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.heightUnit==="cm"?"active":"",onClick:()=>{q(M=>({...M,heightUnit:"cm"})),U(null)},children:"cm"}),a.jsx("button",{className:R.heightUnit==="ft"?"active":"",onClick:()=>{q(M=>({...M,heightUnit:"ft"})),U(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:R.dailyActivity,onChange:M=>{q(F=>({...F,dailyActivity:M.target.value})),U(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:R.trainingFrequency,onChange:M=>{q(F=>({...F,trainingFrequency:M.target.value})),U(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:R.goal==="lose"?"active":"",onClick:()=>{q(M=>({...M,goal:"lose"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:R.goal==="maintain"?"active":"",onClick:()=>{q(M=>({...M,goal:"maintain"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:R.goal==="build"?"active":"",onClick:()=>{q(M=>({...M,goal:"build"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),R.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:R.deficitLevel==="light"?"active":"",onClick:()=>{q(M=>({...M,deficitLevel:"light"})),U(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="moderate"?"active":"",onClick:()=>{q(M=>({...M,deficitLevel:"moderate"})),U(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="harsh"?"active":"",onClick:()=>{q(M=>({...M,deficitLevel:"harsh"})),U(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:nt,disabled:!Zt(),children:"Calculate Macros"})]}),$&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[ts("Protein","Protein",$.protein,$.protein,"ring-protein"),ts("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),ts("Fats","Fats",$.fats,$.fats,"ring-fats"),ts("Calories","Calories",$.calories,$.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[$.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[$.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[$.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:yt,children:"Set as My Daily Targets"})]})]}),cs&&a.jsx("div",{className:`toast-notification ${cs.type}`,children:cs.message})]});const Xr=M=>{const F=new Date(M+"T12:00:00"),te=F.getDay(),re=new Date(F);re.setDate(F.getDate()-(te+6)%7);const Be=[];for(let ze=0;ze<7;ze++){const He=new Date(re);He.setDate(re.getDate()+ze),Be.push(He.toISOString().split("T")[0])}return Be},_s=["M","T","W","T","F","S","S"],ks=(M,F="search")=>{Me(M),F==="scan"?(se("scan"),It(null)):F==="manual"?(se("manual"),Cn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):F==="favourites"?se("favourites"):(se("search"),Pt([]),Tn(""))},Es=Xr(W),Os=new Date(W+"T12:00:00"),Jr=`${ft[Os.getMonth()]} ${Os.getFullYear()}`;return a.jsx(Zo,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),U(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const M=new Date(W+"T12:00:00");M.setDate(M.getDate()-7);const F=M.toISOString().split("T")[0];G(F)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{T(!C),P({year:Os.getFullYear(),month:Os.getMonth()})},children:Jr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const M=new Date(W+"T12:00:00");M.setDate(M.getDate()+7);const F=M.toISOString().split("T")[0];F<=Hr()&&G(F)},"aria-label":"Next week",disabled:Es[6]>=Hr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Es.map((M,F)=>{const te=new Date(M+"T12:00:00").getDate(),re=M===W,Be=M>Hr(),ze=M===Hr();return a.jsxs("button",{className:`nut-week-day${re?" selected":""}${ze?" today":""}${Be?" future":""}`,disabled:Be,onClick:()=>G(M),children:[a.jsx("span",{className:"nut-week-day-letter",children:_s[F]}),a.jsx("span",{className:"nut-week-day-num",children:te})]},M)})})]}),C&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>P(M=>{let F=M.month-1,te=M.year;return F<0&&(F=11,te--),{year:te,month:F}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[ft[I.month]," ",I.year]}),a.jsx("button",{onClick:()=>P(M=>{let F=M.month+1,te=M.year;return F>11&&(F=0,te++),{year:te,month:F}}),disabled:I.year===new Date().getFullYear()&&I.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:st.map(M=>a.jsx("span",{children:M},M))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ht(I.year,I.month))].map((M,F)=>a.jsx("span",{},`e${F}`)),[...Array(Ae(I.year,I.month))].map((M,F)=>{const te=F+1,re=`${I.year}-${String(I.month+1).padStart(2,"0")}-${String(te).padStart(2,"0")}`,Be=re>Hr(),ze=re===W,He=re===Hr();return a.jsx("button",{className:`nut-cal-day${ze?" selected":""}${He?" today":""}${Be?" future":""}`,disabled:Be,onClick:()=>{G(re),T(!1)},children:te},te)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[ts("Protein","Protein",ke.protein,g.protein,"ring-protein"),ts("Carbs","Carbs",ke.carbs,g.carbs,"ring-carbs"),ts("Fats","Fats",ke.fats,g.fats,"ring-fats"),ts("Calories","kCal",ke.calories,g.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[J&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{L(!0),De({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Gw.map(M=>{const F=Q.entries.filter(re=>(re.meal||"snacks")===M.key),te=F.reduce((re,Be)=>({protein:re.protein+(Be.protein||0),carbs:re.carbs+(Be.carbs||0),fats:re.fats+(Be.fats||0),calories:re.calories+(Be.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${M.key}`,children:A3[M.key]}),a.jsx("span",{className:"nut-meal-card-title",children:M.label}),F.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[te.calories," cal"]}),J&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Z(Re===M.key?null:M.key),"aria-label":`Add to ${M.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),F.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,g.protein>0?te.protein/g.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[te.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,g.carbs>0?te.carbs/g.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[te.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,g.fats>0?te.fats/g.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[te.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,g.calories>0?te.calories/g.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:te.calories})]})]}),F.length>0&&a.jsx("div",{className:"nut-log-list",children:F.map(re=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${ae(re.name)?" active":""}`,onClick:()=>Ie(re),"aria-label":ae(re.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:ae(re.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:re.name}),re.serving&&a.jsx("span",{className:"nut-log-item-serving",children:re.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[re.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[re.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[re.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:re.calories})]}),J&&a.jsx("button",{className:"nut-log-delete",onClick:()=>lt(re.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},re.id))}),F.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:J?"Tap + to add food":"No entries"})})]},M.key)})})})]})}),Re&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Z(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Gw.find(M=>M.key===Re)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const M=Re;Z(null),ks(M,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const M=Re;Z(null),ks(M,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const M=Re;Z(null),ks(M,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const M=Re;Z(null),ks(M,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>L(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:M=>M.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>L(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>De(M=>{let F=M.month-1,te=M.year;return F<0&&(F=11,te--),{year:te,month:F}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[ft[A.month]," ",A.year]}),a.jsx("button",{onClick:()=>De(M=>{let F=M.month+1,te=M.year;return F>11&&(F=0,te++),{year:te,month:F}}),disabled:A.year===new Date().getFullYear()&&A.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:st.map(M=>a.jsx("span",{children:M},M))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ht(A.year,A.month))].map((M,F)=>a.jsx("span",{},`e${F}`)),[...Array(Ae(A.year,A.month))].map((M,F)=>{const te=F+1,re=`${A.year}-${String(A.month+1).padStart(2,"0")}-${String(te).padStart(2,"0")}`,Be=re>Hr(),ze=re===W,He=re===Hr(),et=Be||ze;return a.jsx("button",{className:`nut-cal-day${ze?" selected":""}${He?" today":""}${Be?" future":""}`,disabled:et,onClick:()=>at(re),children:te},te)})]}),tt&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),O&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Mn(),Ne(null),se(null),It(null)},children:a.jsxs("div",{className:"nut-modal",onClick:M=>M.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:O==="scan"?"Scan Barcode":O==="search"?"Search Food":O==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{Mn(),Ne(null),se(null),It(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),O==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ee&&!ye&&a.jsx("div",{className:"nut-scan-line"}),ye&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ye})]})]}),!Ee&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:In,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ee&&!ye&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Ve,onChange:M=>We(M.target.value),onKeyDown:M=>M.key==="Enter"&&Ve.trim()&&Ns(Ve.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Ve.trim()&&Ns(Ve.trim()),disabled:!Ve.trim()||Ue,children:Ue?"...":"Look Up"})]})]}),O==="scan"&&le&&(()=>{const M=le.servingUnit||"g",F=le.portion,te=nn==="portion"&&F?Ye*F.weight:parseFloat(Nt)||0,re=te/100,Be=M==="ml"?[100,200,250,500]:[50,100,150,200],ze=nn==="portion"&&F?`${Ye} ${F.label}${Ye!==1?"s":""} (${Math.round(te)}${M})`:`${Math.round(te)}${M}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${ae(le.name)?" active":""}`,onClick:()=>Ie({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ae(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",M,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),F&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:nn==="portion"?"active":"",onClick:()=>{Jt("portion"),Ye<1&&ot(1)},children:"Portions"}),a.jsxs("button",{className:nn==="weight"?"active":"",onClick:()=>{Jt("weight"),gt(String(Math.round(te)||100))},children:["Custom (",M,")"]})]}),nn==="portion"&&F?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Math.max(1,Ye-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Ye}),a.jsxs("span",{className:"nut-stepper-label",children:[F.label,Ye!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(te),M]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Ye+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",M,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:He=>gt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Be.map(He=>a.jsxs("button",{className:`nut-quick-btn${Nt===String(He)?" active":""}`,onClick:()=>gt(String(He)),children:[He,M]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*re),"p / ",Math.round(le.carbs*re),"c / ",Math.round(le.fats*re),"f / ",Math.round(le.calories*re)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{It(null),se("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Qe({name:le.name,protein:Math.round(le.protein*re),carbs:Math.round(le.carbs*re),fats:Math.round(le.fats*re),calories:Math.round(le.calories*re),serving:ze}),children:"Add"})]})]})})(),O==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Bt,value:St,onChange:M=>Tn(M.target.value),onKeyDown:M=>{M.key==="Enter"&&(clearTimeout(rn.current),us())},onFocus:()=>setTimeout(()=>Bt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:us,disabled:kt,children:kt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Un.map((M,F)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{It(M),M.portion?(ot(1),gt(String(M.portion.weight)),Jt("portion")):(ot(0),gt(String(M.servingValue||100)),Jt("weight"))},children:[M.image&&a.jsx("img",{src:M.image,alt:M.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:M.name}),M.brand&&a.jsx("span",{className:"nut-search-item-brand",children:M.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[M.calories," cal  ",M.protein,"p  ",M.carbs,"c  ",M.fats,"f per 100",M.servingUnit||"g"]})]})]},F)),Un.length===0&&St&&!kt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),O==="search"&&le&&(()=>{const M=le.servingUnit||"g",F=le.portion,te=nn==="portion"&&F?Ye*F.weight:parseFloat(Nt)||0,re=te/100,Be=M==="ml"?[100,200,250,500]:[50,100,150,200],ze=nn==="portion"&&F?`${Ye} ${F.label}${Ye!==1?"s":""} (${Math.round(te)}${M})`:`${Math.round(te)}${M}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${ae(le.name)?" active":""}`,onClick:()=>Ie({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ae(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",M,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),F&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:nn==="portion"?"active":"",onClick:()=>{Jt("portion"),Ye<1&&ot(1)},children:"Portions"}),a.jsxs("button",{className:nn==="weight"?"active":"",onClick:()=>{Jt("weight"),gt(String(Math.round(te)||100))},children:["Custom (",M,")"]})]}),nn==="portion"&&F?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Math.max(1,Ye-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Ye}),a.jsxs("span",{className:"nut-stepper-label",children:[F.label,Ye!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(te),M]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Ye+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",M,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:He=>gt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Be.map(He=>a.jsxs("button",{className:`nut-quick-btn${Nt===String(He)?" active":""}`,onClick:()=>gt(String(He)),children:[He,M]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*re),"p / ",Math.round(le.carbs*re),"c / ",Math.round(le.fats*re),"f / ",Math.round(le.calories*re)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>It(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Qe({name:le.name,protein:Math.round(le.protein*re),carbs:Math.round(le.carbs*re),fats:Math.round(le.fats*re),calories:Math.round(le.calories*re),serving:ze}),children:"Add"})]})]})})(),O==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Ge.name,onChange:M=>Cn(F=>({...F,name:M.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Ge.serving,onChange:M=>Cn(F=>({...F,serving:M.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Ge.protein,onChange:M=>Cn(F=>({...F,protein:M.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Ge.carbs,onChange:M=>Cn(F=>({...F,carbs:M.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Ge.fats,onChange:M=>Cn(F=>({...F,fats:M.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Ge.calories,onChange:M=>Cn(F=>({...F,calories:M.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Ge.name.trim(),onClick:()=>Qe({name:Ge.name,protein:parseFloat(Ge.protein)||0,carbs:parseFloat(Ge.carbs)||0,fats:parseFloat(Ge.fats)||0,calories:parseFloat(Ge.calories)||0,serving:Ge.serving||""}),children:"Add Food"})]}),O==="favourites"&&!le&&(()=>{const M=Rn(),F=te=>{if(te.per100g){const re=te.per100g;It({name:te.name,brand:"",image:null,servingSize:te.serving||"100g",servingValue:100,servingUnit:te.servingUnit||"g",portion:te.portion||null,protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories,per100g:!0}),te.portion?(ot(1),gt(String(te.portion.weight)),Jt("portion")):(ot(0),gt("100"),Jt("weight"))}else Qe({name:te.name,protein:te.protein,carbs:te.carbs,fats:te.fats,calories:te.calories,serving:te.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:M.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:M.map((te,re)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Be=>{Be.stopPropagation(),Ie(te)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>F(te),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:te.name}),a.jsx("span",{className:"nut-recent-item-serving",children:te.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[te.calories," cal"]})]})]},re))})})})(),O==="favourites"&&le&&(()=>{const M=le.servingUnit||"g",F=le.portion,te=nn==="portion"&&F?Ye*F.weight:parseFloat(Nt)||0,re=te/100,Be=M==="ml"?[100,200,250,500]:[50,100,150,200],ze=nn==="portion"&&F?`${Ye} ${F.label}${Ye!==1?"s":""} (${Math.round(te)}${M})`:`${Math.round(te)}${M}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${ae(le.name)?" active":""}`,onClick:()=>Ie({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ae(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",M,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),F&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:nn==="portion"?"active":"",onClick:()=>{Jt("portion"),Ye<1&&ot(1)},children:"Portions"}),a.jsxs("button",{className:nn==="weight"?"active":"",onClick:()=>{Jt("weight"),gt(String(Math.round(te)||100))},children:["Custom (",M,")"]})]}),nn==="portion"&&F?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Math.max(1,Ye-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Ye}),a.jsxs("span",{className:"nut-stepper-label",children:[F.label,Ye!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(te),M]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ot(Ye+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",M,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:He=>gt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Be.map(He=>a.jsxs("button",{className:`nut-quick-btn${Nt===String(He)?" active":""}`,onClick:()=>gt(String(He)),children:[He,M]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*re),"p / ",Math.round(le.carbs*re),"c / ",Math.round(le.fats*re),"f / ",Math.round(le.calories*re)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>It(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Qe({name:le.name,protein:Math.round(le.protein*re),carbs:Math.round(le.carbs*re),fats:Math.round(le.fats*re),calories:Math.round(le.calories*re),serving:ze}),children:"Add"})]})]})})()]})}),a.jsx(Yr,{active:"nutrition"}),cs&&a.jsx("div",{className:`toast-notification ${cs.type}`,children:cs.message}),a.jsx(ql,{badge:k,onDismiss:()=>S(null)})]})})}async function M3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,p=1080,y=1920,g=document.createElement("canvas");g.width=p,g.height=y;const b=g.getContext("2d"),k="#2a2a28",S="#ffffff",R="#A12F3A",q="#1a1a1a",$="#555555";b.fillStyle=k,b.fillRect(0,0,p,y);const U=Math.round(p*.82),W=Math.round(y*.75),G=Math.round((p-U)/2),Q=Math.round((y-W)/2),me=28,ke=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Kw(b,G,Q,U,W,me),b.fillStyle=S,b.fill(),b.restore(),b.save(),Kw(b,G,Q,U,W,me),b.strokeStyle=R,b.lineWidth=ke,b.stroke(),b.restore();const xe=220,C=50,T=52,I=68,P=10,V=36,L=48,A=30,De=34,tt=46,X=30,Ce=28;b.font=`bold ${T}px 'Orbitron', sans-serif`;const Me=Jc(b,t.toUpperCase(),U-100);b.font=`500 ${V}px 'Montserrat', sans-serif`;let Re=[];e==="badge"&&d?Re=Jc(b,d,U-120):e==="badge"&&l.length>0?Re=Jc(b,l.join("    "),U-120):i.length>0&&(Re=Jc(b,i.map(kt=>`${kt.value} ${kt.label}`).join("    "),U-120));const Z=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${De}px 'Montserrat', sans-serif`;const O=Jc(b,Z,U-80);let se=Me.length*I;Re.length>0&&(se+=P+Re.length*L),se+=A+O.length*tt,se+=X+Ce;const Se=Q+W-60-se,Ne=Q+40,Ve=Se-C,We=p/2,Ue=(Ne+Ve)/2,Ut=e==="badge"&&u?u:"/Logo.webp";b.save();const St=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Tn=b.createRadialGradient(We,Ue,xe*.6,We,Ue,xe*1.5);Tn.addColorStop(0,St),Tn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Tn,b.fillRect(We-xe*1.5,Ue-xe*1.5,xe*3,xe*3),b.restore(),b.beginPath(),b.arc(We,Ue,xe+6,0,Math.PI*2),b.fillStyle=S,b.fill();const Un=e==="badge"?"#ffc107":R;b.beginPath(),b.arc(We,Ue,xe,0,Math.PI*2),b.strokeStyle=Un,b.lineWidth=5,b.stroke();try{const kt=await D3(Ut);b.save(),b.beginPath(),b.arc(We,Ue,xe-6,0,Math.PI*2),b.clip();const Xt=(xe-6)*2;b.drawImage(kt,We-xe+6,Ue-xe+6,Xt,Xt),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=R,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",We,Ue)}let Pt=Se;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=q,b.font=`bold ${T}px 'Orbitron', sans-serif`;for(const kt of Me)b.fillText(kt,p/2,Pt),Pt+=I;if(Re.length>0){Pt+=P,b.fillStyle=$,b.font=`500 ${V}px 'Montserrat', sans-serif`;for(const kt of Re)b.fillText(kt,p/2,Pt),Pt+=L}Pt+=A,b.fillStyle=q,b.font=`bold ${De}px 'Montserrat', sans-serif`;for(const kt of O)b.fillText(kt,p/2,Pt),Pt+=tt;return Pt+=X,b.fillStyle=R,b.font=`600 ${Ce}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,Pt),new Promise(kt=>{g.toBlob(Xt=>kt(Xt),"image/png")})}function Kw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function D3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Jc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;s.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function L3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const y=u.createOscillator(),g=u.createGain();y.type="sine",y.frequency.value=50,g.gain.value=.3,g.gain.setTargetAtTime(0,d+.08,.04),y.connect(g).connect(p),y.start(d),y.stop(d+.2);const b=u.createOscillator(),k=u.createGain();b.type="sine",b.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),b.connect(k).connect(p),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const y=u.createOscillator(),g=u.createGain();y.type="sine",y.frequency.value=55,g.gain.value=.35,g.gain.setTargetAtTime(0,d+.08,.04),y.connect(g).connect(p),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const y=u.createOscillator(),g=u.createGain();y.type="sine",y.frequency.value=p===0?523:784,g.gain.value=.12,g.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),y.connect(g).connect(u.destination),y.start(u.currentTime+d),y.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const O3=2e3,Wg=42,Rl=2*Math.PI*Wg,P3=1200,Yw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Gg({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:y="Hold To Complete Session",shareType:g="workout",hideShare:b=!1}){const[k,S]=w.useState("hold"),[R,q]=w.useState(!1),[$,U]=w.useState(0),[W,G]=w.useState(!1),[Q,me]=w.useState(!1),[ke,xe]=w.useState(null),C=L3(),T=w.useRef(null),I=w.useRef(null),P=w.useRef(null),V=w.useRef(null),L=w.useRef(!1),A=w.useRef(!1),De=w.useRef(0),tt=w.useRef(Yw[Math.floor(Math.random()*Yw.length)]),X=w.useRef([...Array(80)].map((ye,Ne)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ne%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ne%3}))),Ce=w.useCallback(()=>{if(L.current)return;L.current=!0,A.current=!1,De.current=0,q(!0),U(0),V.current=performance.now(),C.tap(),T.current&&(T.current.style.strokeDashoffset=Rl);const ye=Ne=>{const Ve=Ne-V.current,We=Math.min(Ve/O3,1);if(T.current&&(T.current.style.strokeDashoffset=Rl-We*Rl),I.current){const Ue=8*(1-We),Ut=1-We,St=1+We*.15;I.current.style.filter=`blur(${Ue}px) grayscale(${Ut})`,I.current.style.transform=`scale(${St})`}U(We),Ve-De.current>=P3&&(De.current=Ve,C.tick()),We<1?P.current=requestAnimationFrame(ye):(L.current=!1,A.current=!0,P.current=null,q(!1),U(1),C.complete(),S("celebrate"))};P.current=requestAnimationFrame(ye)},[C]),Me=w.useCallback(()=>{L.current&&(L.current=!1,P.current&&(cancelAnimationFrame(P.current),P.current=null),T.current&&(T.current.style.strokeDashoffset=Rl),I.current&&(I.current.style.filter="",I.current.style.transform=""),q(!1),U(0))},[]),Re=w.useCallback(()=>{G(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Z=w.useCallback(()=>{const ye=[s||"Workout Complete!"];return e&&ye.push(e),t?.length&&ye.push(t.map(Ne=>`${Ne.value} ${Ne.label}`).join(" | ")),ye.push("#MindCoreFitness"),ye.join(`
`)},[s,e,t]),O=w.useCallback(async()=>{if(!(Q||!u))try{await u({type:g==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:tt.current}),me(!0),xe("Posted to Journey!"),setTimeout(()=>xe(null),2500)}catch(ye){console.error("Journey post failed:",ye),xe(ye?.message||"Failed to post"),setTimeout(()=>xe(null),3500)}},[Q,u,s,e,t]),[se,Ee]=w.useState(!1),Se=w.useCallback(async()=>{Ee(!0);try{const ye=await M3({type:g||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:tt.current,userName:d}),Ne=Z();if(navigator.share&&navigator.canShare?.({files:[new File([ye],"workout.png",{type:"image/png"})]})){const Ve=new File([ye],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ne,files:[Ve]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ne}):(await navigator.clipboard.writeText(Ne),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500))}catch{try{await navigator.clipboard.writeText(Z()),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500)}catch{}}finally{Ee(!1)}},[s,e,t,d,Z]);return k==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${R?"wc-holding":""}`,onPointerDown:ye=>{ye.preventDefault(),Ce()},onPointerUp:Me,onPointerLeave:Me,onPointerCancel:Me,onClick:ye=>{ye.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ye=>{(ye.key==="Enter"||ye.key===" ")&&(ye.preventDefault(),C.complete(),S("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Wg}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Wg,style:{strokeDasharray:Rl,strokeDashoffset:Rl}})]}),a.jsx("img",{ref:I,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${W?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:X.current.map((ye,Ne)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ye.shape}`,style:{"--x":`${ye.x}%`,"--delay":`${ye.delay}s`,"--color":ye.color,"--drift":`${ye.drift}px`,"--spin":`${ye.spin}deg`,"--duration":`${ye.duration}s`,width:`${ye.width}px`,height:`${ye.height}px`}},Ne))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:tt.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ye,Ne)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:ye.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:ye.label})]},Ne))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${Q?"wc-share-done":""}`,onClick:O,disabled:Q,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Q?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Se,disabled:se,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),se?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Re,children:p}),ke&&a.jsx("div",{className:"wc-share-toast",children:ke})]})]})}const Qw="/login/assets/randomiser-glq9YJkL.jpg",Xw="/login/assets/programme-card-workout-CnNzTYkz.webp",V3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",U3="/login/assets/muscle-group-arms-C9AdZL4-.png",B3="/login/assets/arms-bicep-BUrmT1o-.png",z3="/login/assets/arms-tricep-D9tAnFnS.png",F3="/login/assets/arms-full-arms-BY3TvpJm.png",q3="/login/assets/muscle-group-chest-Cxfuc7XI.png",H3="/login/assets/chest-strength-BR4BAFTH.png",$3="/login/assets/chest-hypertrophy-B8yNrvjB.png",W3="/login/assets/chest-endurance-e-OSWtWO.png",G3="/login/assets/muscle-group-shoulders-DibNtCLF.png",K3="/login/assets/shoulders-strength-CKlZBF5A.png",Y3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",Q3="/login/assets/shoulders-endurance-HuqNG5rD.png",X3="/login/assets/muscle-group-core-CPR-bdRg.png",J3="/login/assets/core-lower-abs-TVcqGMFJ.png",Z3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e5="/login/assets/core-weighted-core-4Kwh9mTv.png",t5="/login/assets/muscle-group-back-8JPV-YUo.png",n5="/login/assets/back-strength-BmSRxnwo.png",s5="/login/assets/back-hypertrophy-CXHmsnCz.png",r5="/login/assets/back-endurance-C8qJ8l5I.png",i5="/login/assets/muscle-group-legs-B8jcbdov.png",a5="/login/assets/legs-quads-DbnfsebI.png",o5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l5="/login/assets/legs-power-plyo-D2qBXeUR.png",c5=60,tg=5,u5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},d5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ng={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},sg=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:V3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Zc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:U3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:q3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:G3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:i5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:X3}],Jw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:H3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:W3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:n5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:s5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:K3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:Y3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:Q3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:B3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:z3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:F3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:a5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:J3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:Z3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},rg=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],$r=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ei=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],ig=[5,10,15,20,30],ph={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Zw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function h5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function f5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function m5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Li(),{isPremium:d,FREE_RANDOMISER_DURATIONS:p,FREE_RANDOMISER_WEEKLY_LIMIT:y}=oc(),g=Zs(),[b,k]=w.useState("randomiser_hub"),[S,R]=w.useState(["bodyweight"]),[q,$]=w.useState("core"),[U,W]=w.useState("intermediate"),[G,Q]=w.useState(d?15:5),[me,ke]=w.useState([]),[xe,C]=w.useState(!1),T=w.useRef(!1),I=w.useRef([]),[P,V]=w.useState([]),[L,A]=w.useState(2),[De,tt]=w.useState(Ei[1]),[X,Ce]=w.useState(1),[Me,Re]=w.useState(0),[Z,O]=w.useState("work"),[se,Ee]=w.useState(0),[Se,ye]=w.useState(!1),[Ne,Ve]=w.useState(0),[We,Ue]=w.useState(!1),[Ut,St]=w.useState(!1),[Tn,Un]=w.useState(null),Pt=w.useRef(null);w.useRef(null),w.useRef(null);const[kt,Xt]=w.useState(null),Ge=w.useCallback((z,de="info")=>{Xt({message:z,type:de}),setTimeout(()=>Xt(null),3e3)},[]),Cn=w.useCallback(async z=>{if(!t)throw new Error("Not signed in");const de=z&&typeof z=="object"&&z.type;await vr(ut(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:de?"":z,type:de?z.type:"text",imageURL:null,createdAt:Ds(),likeCount:0,commentCount:0,...de?{metadata:{title:z.title||"",subtitle:z.subtitle||"",stats:z.stats||[],quote:z.quote||"",badges:z.badges||[]}}:{}})},[t]),[le,It]=w.useState(null),[Nt,gt]=w.useState(null),[Ye,ot]=w.useState(0),[nn,Jt]=w.useState(0),[Jn,Nn]=w.useState([]),[cs,Zn]=w.useState(""),[Hn,Bn]=w.useState(""),[rn,Bt]=w.useState(!1),[vt,Ct]=w.useState(0),[J,Ae]=w.useState(!1),[ht,xt]=w.useState({}),ft=w.useRef(null),st=w.useRef(null),[nt,yt]=w.useState(0),[Zt,fn]=w.useState(0),[Rn,ae]=w.useState(0),[Ie,Qe]=w.useState(0),[lt,at]=w.useState(0),[Vt,en]=w.useState(0),[zt,mn]=w.useState(null),[In,Mn]=w.useState({beginner:0,intermediate:0,advanced:0}),yn=d?ig:ig.filter(z=>p.includes(z)),cn=!d&&nt>=y,[ws,Ls]=w.useState([]),[Qr,Oi]=w.useState(!1),[gi,Ns]=w.useState({}),[xs,us]=w.useState(!1),[Wn,Dn]=w.useState(!1),[es,un]=w.useState(""),[ts,Xr]=w.useState(null),[_s,ks]=w.useState([]),[Es,Os]=w.useState({total:0,favouriteFocus:null,streak:0}),[Jr,M]=w.useState(null),[F,te]=w.useState(""),[re,Be]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&g("/")},[s,e,i,g]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const de=ut(ge,"workoutLogs"),ce=sn(de,wt("clientId","==",t.id)),D=(await Qt(ce)).docs.map(ct=>ct.data()),K=D.filter(ct=>ct.type!=="programme");Qe(K.length);const ue=K.reduce((ct,Et)=>ct+(Et.duration||0),0);at(ue);const Te={beginner:0,intermediate:0,advanced:0};K.forEach(ct=>{ct.level&&Te[ct.level]!==void 0&&Te[ct.level]++}),Mn(Te);const Le=new Date,be=Le.getDay(),Oe=be===0?-6:1-be,Je=new Date(Le);Je.setDate(Le.getDate()+Oe),Je.setHours(0,0,0,0);const Lt=Je.getTime(),Xe=D.filter(ct=>{const Et=ct.completedAt;return Et?(Et.toDate?Et.toDate().getTime():new Date(Et).getTime())>=Lt:!1});yt(Xe.filter(ct=>ct.type!=="programme").length);let Ot=0;if(t)try{const ct=await vs(qe(ge,"clientProgrammes",t.id));if(ct.exists()){const Et=ct.data(),Ln=Et.templateId;Ot=Xe.filter(On=>On.type==="programme"&&On.programmeId===Ln).length,M(Ln);const ss=sg.find(On=>On.id===Ln);ss&&te(ss.name);const Vs=u5[Ln];if(Vs){const On=Object.keys(Et.completedSessions||{}).length,jn=Vs.duration*Vs.daysPerWeek;ae(jn>0?Math.round(On/jn*100):0)}}else M(null),te(""),ae(0)}catch{}fn(Ot);const an=K.map(ct=>ct.completedAt).filter(Boolean).map(ct=>ct.toDate?ct.toDate().getTime():new Date(ct).getTime()).sort((ct,Et)=>Et-ct);if(an.length===0)en(0);else{const ct=new Set;an.forEach(jn=>{const ds=new Date(jn),Ts=ds.getDay(),yi=Ts===0?-6:1-Ts,Ui=new Date(ds);Ui.setDate(ds.getDate()+yi),Ui.setHours(0,0,0,0),ct.add(Ui.getTime())});const Et=[...ct].sort((jn,ds)=>ds-jn);let Ln=0;const ss=new Date(Le),Vs=Le.getDay()===0?-6:1-Le.getDay();ss.setDate(Le.getDate()+Vs),ss.setHours(0,0,0,0);let On=ss.getTime();Et.includes(On)||(On-=10080*60*1e3);for(let jn=0;jn<200&&Et.includes(On);jn++)Ln++,On-=10080*60*1e3;en(Ln)}}catch(de){console.error("Error loading workout stats:",de)}finally{Be(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const de=sn(ut(ge,"savedWorkouts"),wt("clientId","==",t.id)),E=(await Qt(de)).docs.map(D=>({id:D.id,...D.data()}));E.sort((D,K)=>{const ue=D.savedAt?.toMillis?.()||D.savedAt?.seconds*1e3||0;return(K.savedAt?.toMillis?.()||K.savedAt?.seconds*1e3||0)-ue}),Ls(E)}catch(de){console.error("Error loading saved workouts:",de)}finally{Oi(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const de=sn(ut(ge,"workoutLogs"),wt("clientId","==",t.id),Eu("completedAt","desc"),Tu(20)),D=(await Qt(de)).docs.map(Xe=>Xe.data()).filter(Xe=>Xe.type!=="programme"&&Xe.type!=="muscle_group");ks(D.slice(0,3));const K=D.length,ue={};D.forEach(Xe=>{Xe.focus&&(ue[Xe.focus]=(ue[Xe.focus]||0)+1)});const Te=Object.keys(ue).sort((Xe,Ot)=>ue[Ot]-ue[Xe])[0]||null;let Le=0;if(D.length>0){const Xe=new Set;D.forEach(ct=>{const Et=ct.completedAt?.toDate?ct.completedAt.toDate():ct.completedAt?new Date(ct.completedAt):null;Et&&Xe.add(new Date(Et.getFullYear(),Et.getMonth(),Et.getDate()).toDateString())});const Ot=new Date;Ot.setHours(0,0,0,0);let an=new Date(Ot);for(Xe.has(an.toDateString())||an.setDate(an.getDate()-1);Xe.has(an.toDateString());)Le++,an.setDate(an.getDate()-1)}Os({total:K,favouriteFocus:Te,streak:Le});const be={core:null,upper:null,lower:null,fullbody:null};D.forEach(Xe=>{if(Xe.focus&&be[Xe.focus]===null&&Xe.completedAt){const Ot=Xe.completedAt.toDate?Xe.completedAt.toDate():new Date(Xe.completedAt);be[Xe.focus]=Ot}});let Oe=null,Je=new Date;const Lt=["core","upper","lower","fullbody"];for(const Xe of Lt){if(be[Xe]===null){const Ot=$r.find(an=>an.key===Xe)?.label||Xe;Oe={focus:Xe,label:Ot,daysAgo:null,message:`You haven't tried ${Ot} yet`};break}if(be[Xe]<Je){Je=be[Xe];const Ot=Math.floor((Date.now()-be[Xe].getTime())/864e5);if(Ot>=5){const an=$r.find(ct=>ct.key===Xe)?.label||Xe;Oe={focus:Xe,label:an,daysAgo:Ot,message:`${an}  ${Ot} days ago`}}}}Xr(Oe)}catch(de){console.error("Error loading recent workouts:",de)}})()},[s,t,b]);const ze=async z=>{if(!(!s||!t||P.length===0)){us(!0);try{const de=$r.find(D=>D.key===q)?.label||q,ce=z||`${de} ${G}min`,E=await vr(ut(ge,"savedWorkouts"),{clientId:t.id,name:ce,equipment:S,focus:q,level:U,duration:G,exercises:P.map(D=>({name:D.name,videoUrl:D.videoUrl,isGif:D.isGif||!1})),rounds:L,savedAt:Dt.now()});Ls(D=>[{id:E.id,clientId:t.id,name:ce,equipment:S,focus:q,level:U,duration:G,exercises:P.map(K=>({name:K.name,videoUrl:K.videoUrl,isGif:K.isGif||!1})),rounds:L,savedAt:Dt.now()},...D]),Ge("Workout saved!","success")}catch(de){console.error("Error saving workout:",de),Ge("Failed to save workout","error")}finally{us(!1),Dn(!1),un("")}}},He=async z=>{try{await Ar(qe(ge,"savedWorkouts",z)),Ls(de=>de.filter(ce=>ce.id!==z)),Ge("Workout removed","info")}catch(de){console.error("Error deleting saved workout:",de),Ge("Failed to remove workout","error")}},et=z=>{R(z.equipment||["bodyweight"]),$(z.focus||"core"),W(z.level||"intermediate"),Q(z.duration||15);const de=Ei.find(ce=>ce.key===(z.level||"intermediate"));tt(de),V(z.exercises||[]),A(z.rounds||2),k("preview")},bt=async()=>{const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");R(z?.equipment||["bodyweight"]),$(z?.focus||"core"),W(z?.level||"intermediate"),Q(z?.duration||15),setTimeout(()=>er(),50)},wn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:S,focus:q,level:U,duration:G}))};localStorage.getItem("mcf_last_randomiser");const As=()=>{const z=[];let de;q==="mix"?de=["core","upper","lower"]:q==="fullbody"?de=["upper","lower"]:de=[q];for(const ce of S)for(const E of de)z.push(`exercises/${ce}/${E}`);return z},ns=async()=>{if(T.current){for(;T.current;)await new Promise(z=>setTimeout(z,200));return I.current}T.current=!0,C(!0);try{const z=As(),de=[];for(const K of z)try{const ue=Ya(Qa,K),Te=await Hw(ue);de.push(...Te.items)}catch{console.warn(`Folder ${K} not found, skipping.`)}if(de.length===0&&S.includes("bodyweight")&&q==="core")try{const K=Ya(Qa,"core"),ue=await Hw(K);de.push(...ue.items)}catch{console.warn("Legacy core/ folder not found either.")}if(de.length===0){const K=S.map(Te=>rg.find(Le=>Le.key===Te)?.label).join(" + "),ue=$r.find(Te=>Te.key===q)?.label;return Ge(`No exercises found for ${K} / ${ue}. Upload videos to Firebase Storage.`,"error"),T.current=!1,C(!1),[]}const ce=new Set,E=de.filter(K=>{const ue=K.name.replace(/\.(mp4|gif)$/i,"");return ce.has(ue)?!1:(ce.add(ue),!0)}),D=await Promise.all(E.map(async K=>{const ue=await Po(K),Te=h5(K.name.replace(/\.(mp4|gif)$/i,"")),Le=/\.gif$/i.test(K.name);return{name:Te,videoUrl:ue,isGif:Le}}));return I.current=D,ke(D),T.current=!1,C(!1),D}catch(z){console.error("Error loading exercises:",z);const de=z.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${z.message||z.code||"Unknown error"}`;return Ge(de,"error"),T.current=!1,C(!1),[]}},er=async()=>{if(cn)return;wn(),k("spinning"),I.current=[];const z=await ns();if(z.length===0){k("setup");return}const de=Ei.find(be=>be.key===U);tt(de);const ce=de.work+de.rest,E=G*60,D=Math.floor(E/ce);let K,ue;D<=6?(K=Math.max(3,Math.floor(D/2)),ue=Math.floor(D/K)):D<=12?(K=Math.min(6,Math.floor(D/2)),ue=Math.floor(D/K)):(K=Math.min(10,Math.floor(D/2)),ue=Math.floor(D/K)),ue=Math.max(2,ue);const Te=f5(z),Le=Te.slice(0,Math.min(K,Te.length));V(Le),A(ue),setTimeout(()=>k("preview"),2e3)},Zr=()=>{k("countdown"),Ve(3)};w.useEffect(()=>{if(b!=="countdown")return;if(Ne<=0){k("workout"),Ce(1),Re(0),O("work"),Ee(De.work),ye(!1),xr();return}Ps();const z=setTimeout(()=>Ve(de=>de-1),1e3);return()=>clearTimeout(z)},[Ne,b]),w.useEffect(()=>{if(b!=="workout"||Se)return;if(se<=0){Dr();return}se<=3&&Ps();const z=setTimeout(()=>Ee(de=>de-1),1e3);return()=>clearTimeout(z)},[se,b,Se]);const Dr=()=>{if(Z==="work")O("rest"),Ee(De.rest);else{const z=Me+1;if(z>=P.length){const de=X+1;if(de>L){Ue(!0),wr();return}Ce(de),Re(0)}else Re(z);O("work"),Ee(De.work),xr()}},wr=async()=>{if(s)try{await vr(ut(ge,"workoutLogs"),{clientId:t.id,level:U,duration:G,equipment:S,focus:q,exerciseCount:P.length,rounds:L,exercises:P.map(D=>D.name),completedAt:Dt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:G,level:U,focus_area:q,exercise_count:P.length}),yt(D=>D+1);const z=Ie+1;Qe(z),at(D=>D+G),Mn(D=>({...D,[U]:(D[U]||0)+1}));const de=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const D of de)if(z>=D.count){const K=await ef(D.id,t);if(K){mn(K);break}}const ce=Vt+(nt===0?1:0),E=[{weeks:2,id:"streak_2"},{weeks:4,id:"streak_4"},{weeks:8,id:"streak_8"}];for(const D of E)if(ce>=D.weeks){const K=await ef(D.id,t);K&&!zt&&mn(K)}}catch(z){console.error("Error saving workout log:",z)}},Ws=async(z,de,ce)=>{if(!(!t||!de))try{const E=t.id,D=await vs(qe(ge,"coreBuddyPBs",E)),ue=(D.exists()?D.data():null)?.exercises||{},Te=ue[z];let Le=!1;if(Te?(de>(Te.weight||0)||de===(Te.weight||0)&&ce>(Te.reps||0))&&(Le=!0):Le=!0,Le){const be={...ue,[z]:{weight:de,reps:ce,achievedAt:Dt.now()}};await Ss(qe(ge,"coreBuddyPBs",E),{clientId:t.id,exercises:be,updatedAt:Dt.now()}),Ge(`New PB! ${de}kg  ${ce} reps`,"success"),Ps()}}catch(E){console.error("Error checking PB:",E)}},tr=async z=>{if(gt(z),z.interval){const E=[];for(const D of z.exercises){let K=null,ue=!1;if(D.storagePath)try{const Te=Ya(Qa,D.storagePath);K=await Po(Te),ue=/\.gif$/i.test(D.storagePath)}catch{}E.push({name:D.name,videoUrl:K,isGif:ue})}V(E),A(z.rounds),tt({work:z.work,rest:z.rest}),k("preview");return}const de={};for(const E of z.exercises)if(E.storagePath)try{const D=Ya(Qa,E.storagePath);de[E.name]={url:await Po(D),isGif:/\.gif$/i.test(E.storagePath)}}catch{}xt(de);const ce=z.exercises.map(E=>({name:E.name,type:E.type,targetSets:E.sets,targetReps:E.reps||0,targetTime:E.time||0,sets:[]}));Nn(ce),ot(0),Jt(0),Zn(""),Bn(""),Ae(!1),Bt(!1),Ct(0),setMgSessionBadges([]),setMgBadgeCelebration(null),k("muscle_workout")},Rs=()=>{const z=ft.current;z&&(z.paused?(z.play(),Ae(!0)):(z.pause(),Ae(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!rn||vt<=0){b==="muscle_workout"&&rn&&vt<=0&&(Bt(!1),Ps());return}return st.current=setTimeout(()=>Ct(z=>z-1),1e3),()=>clearTimeout(st.current)},[b,rn,vt]);const Pi=async()=>{const z=Jn[Ye];let de={};if(z.type==="weighted"){const D=parseFloat(cs)||0,K=parseInt(Hn)||0;if(K===0){Ge("Enter your reps","error");return}de={weight:D,reps:K}}else if(z.type==="reps"){const D=parseInt(Hn)||0;if(D===0){Ge("Enter your reps","error");return}de={reps:D}}else if(z.type==="timed"){const D=z.targetTime-vt;de={time:Math.max(D,1)}}const ce=[...Jn];ce[Ye]={...z,sets:[...z.sets,de]},Nn(ce),z.type==="weighted"&&de.weight>0&&await Ws(z.name,de.weight,de.reps);const E=z.sets.length+1;if(E<z.targetSets)Jt(E),Bn(""),Bt(!1),Ct(0);else if(Ye+1<Jn.length){const D=Ye+1;ot(D),Jt(0),Zn(""),Bn(""),Ae(!1),Bt(!1),Ct(0)}else await Vi(ce),St(!0)},Vi=async z=>{if(!(!s||!t))try{const de=z.reduce((ce,E)=>ce+E.sets.length,0);await vr(ut(ge,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:le,sessionId:Nt?.id,sessionName:Nt?.name,exerciseCount:z.length,totalSets:de,duration:Math.round(de*1.5),exercises:z.map(ce=>({name:ce.name,type:ce.type,sets:ce.sets})),completedAt:Dt.now()})}catch(de){console.error("Error saving muscle group workout log:",de)}},ei=w.useRef(null),ti=()=>(ei.current||(ei.current=new(window.AudioContext||window.webkitAudioContext)),ei.current),Ps=()=>{try{const z=ti(),de=z.createOscillator(),ce=z.createGain();de.connect(ce),ce.connect(z.destination),de.frequency.value=880,ce.gain.value=.3,de.start(z.currentTime),de.stop(z.currentTime+.15)}catch{}},xr=()=>{try{const z=ti(),de=z.createOscillator(),ce=z.createGain();de.connect(ce),ce.connect(z.destination),de.frequency.value=1200,ce.gain.value=.4,de.start(z.currentTime),de.stop(z.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||Z!=="work"||!P[Me]?.isGif)return;const de=setInterval(()=>{const ce=Pt.current;if(!ce)return;const E=ce.getAttribute("src");ce.removeAttribute("src"),setTimeout(()=>{Pt.current&&Pt.current.setAttribute("src",E)},0)},4e3);return()=>clearInterval(de)},[b,Z,Me,X,P]);const ni=(z,de,ce)=>{const E=Math.round(z/de*c5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:l3.map((D,K)=>a.jsx("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,className:K<E?`wk-tick-filled ${ce}`:"wk-tick-empty",strokeWidth:D.thick?"3":"2"},K))})},nr=()=>{const z=P.length*L;return((X-1)*P.length+Me+(Z==="rest"?.5:0))/z},sr=kt&&a.jsx("div",{className:`toast-notification ${kt.type}`,children:kt.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(Zo,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>k("randomiser_hub"),children:a.jsx("img",{src:Qw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>g("/upgrade"),children:[a.jsx("img",{src:Xw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[sg.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:sg.map((z,de)=>z.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>g("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${de*.06}s`},children:[a.jsx("img",{src:z.image,alt:z.name,className:"wk-prog-img"}),de===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>g("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${de*.06}s`},children:[a.jsx("img",{src:Xw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:d5[z.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[z.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:z.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:z.name.toUpperCase()}),a.jsxs("p",{children:[z.daysPerWeek,"x per week  ",z.focus==="fullbody"?"Full Body":z.focus.charAt(0).toUpperCase()+z.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),de===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Zc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Zc.map((z,de)=>a.jsx("button",{className:`wk-muscle-hero-card${z.image?" wk-muscle-thumb":""}`,onClick:()=>{It(z.key),k("muscle_sessions")},style:{animationDelay:`${de*.05}s`},children:z.image?a.jsx("img",{src:z.image,alt:z.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Qw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ng[z.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:z.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:z.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Jw[z.key]?.length||0," sessions"]})]})]})]})},z.key))})]})]}),a.jsx(Yr,{active:"workouts"}),sr,a.jsx(ql,{badge:zt,onDismiss:()=>mn(null)})]})});if(b==="randomiser_hub"){const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},de=$r.find(E=>E.key===z.focus)?.label||z.focus,ce=Ei.find(E=>E.key===z.level)?.label||z.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[Es.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:Es.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),Es.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[Es.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),Es.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:ph[Es.favouriteFocus]||"var(--color-primary)"},children:$r.find(E=>E.key===Es.favouriteFocus)?.label||Es.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>k("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:bt,disabled:cn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[de,"  ",ce,"  ",z.duration,"min"]})]})]}),ts&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{$(ts.focus),k("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:ts.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Zw[Math.floor(Date.now()/864e5)%Zw.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",ws.length>0&&a.jsx("span",{className:"wk-hub-count",children:ws.length})]}),Qr?ws.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:$r.map(E=>{const D=ws.filter(ue=>ue.focus===E.key);if(D.length===0)return null;const K=gi[E.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${K?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":ph[E.key]||"var(--color-primary)"},onClick:()=>Ns(ue=>({...ue,[E.key]:!ue[E.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":ph[E.key]||"var(--color-primary)"},children:E.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:D.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${K?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),K&&a.jsx("div",{className:"wk-hub-saved-list",children:D.map((ue,Te)=>{const Le=(ue.equipment||[]).map(Oe=>rg.find(Je=>Je.key===Oe)?.label||Oe).join(", "),be=Ei.find(Oe=>Oe.key===ue.level)?.label||ue.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${Te*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>et(ue),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:ue.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[be,"  ",ue.duration,"min  ",(ue.exercises||[]).length," ex"]})}),Le&&a.jsx("span",{className:"wk-hub-saved-equip",children:Le})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>He(ue.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},ue.id)})})]},E.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),_s.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:_s.map((E,D)=>{const K=$r.find(be=>be.key===E.focus)?.label||E.focus||"",ue=Ei.find(be=>be.key===E.level)?.label||E.level||"",Te=E.completedAt?.toDate?E.completedAt.toDate():E.completedAt?new Date(E.completedAt):null,Le=Te?(()=>{const be=Math.floor((Date.now()-Te.getTime())/1e3);return be<3600?`${Math.floor(be/60)}m ago`:be<86400?`${Math.floor(be/3600)}h ago`:`${Math.floor(be/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${D*.05}s`},onClick:()=>{$(E.focus||"core"),W(E.level||"intermediate"),Q(E.duration||15),E.equipment&&R(E.equipment),k("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":ph[E.focus]||"var(--color-primary)"},children:K}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[ue,"  ",E.duration||"?","min  ",E.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Le}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},D)})})]})]}),a.jsx(Yr,{active:"workouts"}),sr,a.jsx(ql,{badge:zt,onDismiss:()=>mn(null)})]})}if(b==="setup"){const z=$r.find(ce=>ce.key===q)?.label||q,de=Ei.find(ce=>ce.key===U)?.label||U;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ie}`,pct:Ie>0?Math.min(Math.round(Ie/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${nt}/${tg}`,pct:Math.round(Math.min(nt,tg)/tg*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Vt}`,pct:Vt>0?Math.min(Math.round(Vt/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ce=>{const D=2*Math.PI*38,K=D-ce.pct/100*D;return a.jsxs("div",{className:`wk-stat-item${ce.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ce.color},strokeDasharray:D,strokeDashoffset:K})]}),a.jsx("span",{className:"wk-stat-value",style:{color:ce.color},children:ce.value})]}),a.jsx("span",{className:"wk-stat-label",children:ce.label})]},ce.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:$r.map(ce=>a.jsxs("button",{className:`wk-equip-btn${q===ce.key?" active":""}${ce.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Ps(),$(ce.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ce.icon})}),a.jsx("span",{children:ce.label})]},ce.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ei.map(ce=>a.jsxs("button",{className:`wk-level-card wk-level-${ce.key}${U===ce.key?" active":""}`,onClick:()=>{Ps(),W(ce.key)},children:[a.jsx("span",{className:"wk-level-name",children:ce.label}),a.jsx("span",{className:"wk-level-desc",children:ce.desc})]},ce.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:ig.map(ce=>{const E=!yn.includes(ce);return a.jsxs("button",{className:`wk-time-btn${G===ce?" active":""}${E?" locked":""}`,onClick:()=>{E||(Ps(),Q(ce))},disabled:E,children:[a.jsx("span",{className:"wk-time-num",children:ce}),a.jsx("span",{className:"wk-time-unit",children:E?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},ce)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:rg.map(ce=>{const E=S.includes(ce.key);return a.jsxs("button",{className:`wk-equip-btn${E?" active":""}`,onClick:()=>{E&&S.length===1||(Ps(),R(D=>E&&D.length===1?D:E?D.filter(K=>K!==ce.key):[...D,ce.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ce.icon})}),a.jsx("span",{children:ce.label})]},ce.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[z,"  ",de,"  ",G," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[cn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:er,disabled:xe||cn,children:xe?"Loading exercises...":cn?"Limit Reached":"Randomise Workout"})]}),sr]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:o3.map((z,de)=>a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:"wk-spin-tick",strokeWidth:z.thick?"3.5":"2",style:{animationDelay:`${de*.03}s`}},de))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),sr]});if(b==="preview"){const z=Nt?.interval?{work:Nt.work,rest:Nt.rest}:Ei.find(ce=>ce.key===U),de=P.length*L*(z.work+z.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k(Nt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[Nt?.interval&&a.jsx("h2",{className:"mg-preview-title",children:Nt.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:P.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(de/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[z.work,"/",z.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:P.map((ce,E)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${E*.06}s`},onClick:()=>Un(ce),children:[a.jsx("span",{className:"wk-preview-num",children:E+1}),a.jsx("div",{className:"wk-preview-thumb",children:ce.isGif?a.jsx("img",{src:ce.videoUrl,alt:ce.name,loading:"lazy"}):a.jsx("video",{src:`${ce.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:ce.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},E))}),Tn&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Un(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:ce=>ce.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Un(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Tn.isGif?a.jsx("img",{src:Tn.videoUrl,alt:Tn.name}):a.jsx("video",{src:Tn.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Tn.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!Nt?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>er(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Dn(!0),disabled:xs,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:Zr,children:"Start Workout"})]}),Wn&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Dn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:ce=>ce.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:es,onChange:ce=>un(ce.target.value),placeholder:`${$r.find(ce=>ce.key===q)?.label||q} ${G}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Dn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>ze(es),disabled:xs,children:xs?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Ne}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const z=P[Me],de=Z==="work"?De.work:De.rest,ce=Z==="rest"?Me+1<P.length?P[Me+1]:X<L?P[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:Z==="work"?z.isGif?a.jsx("img",{ref:Pt,className:"wk-video",src:z.videoUrl,alt:z.name},z.videoUrl):a.jsx("video",{className:"wk-video",src:z.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},z.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),ce&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",ce.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&k("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Me+1," / ",P.length]}),a.jsx("h2",{className:"wk-exercise-name",children:z.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",X," of ",L]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[ni(se,de,Z==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:se}),a.jsx("span",{className:`wk-timer-phase ${Z}`,children:Z==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&k("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>ye(!Se),children:Se?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ee(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${nr()*100}%`}})}),We&&(()=>{const E=Ei.find(K=>K.key===U),D=P.length*L*(E.work+E.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Gg,{title:"Workout Complete!",stats:[{value:Math.ceil(D/60),label:"Minutes"},{value:P.length*L,label:"Intervals"},{value:L,label:"Rounds"}],hideShare:!d,onShareJourney:t?Cn:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Ue(!1),gt(null),It(null)}}),!Nt?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Dn(!0),disabled:xs,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),Wn&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Dn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:K=>K.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:es,onChange:K=>un(K.target.value),placeholder:`${$r.find(K=>K.key===q)?.label||q} ${G}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Dn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>ze(es),disabled:xs,children:xs?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const z=Zc.find(ce=>ce.key===le),de=Jw[le]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ng[le]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:z?.icon})})}),a.jsxs("h2",{children:[z?.label," Workouts"]}),a.jsxs("p",{children:[de.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:de.map((ce,E)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{gt(ce),k("muscle_overview")},style:{animationDelay:`${E*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:ce.name}),a.jsx("p",{children:ce.desc}),a.jsx("div",{className:"mg-session-meta",children:ce.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[ce.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[ce.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[ce.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const D=ce.exercises.map(Te=>Te.sets||0),K=Math.min(...D),ue=Math.max(...D);return K===ue?`${K} sets each`:`${K}-${ue} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ce.id))})]}),sr]})}if(b==="muscle_overview"){const z=Nt;if(!z)return null;const de=Zc.find(ce=>ce.key===le);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:z.image?void 0:{background:ng[le]},children:z.image?a.jsx("img",{src:z.image,alt:z.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:de?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:z.name}),z.level&&a.jsx("span",{className:"mg-overview-level",children:z.level})]}),a.jsx("p",{className:"mg-overview-desc",children:z.desc})]}),z.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:z.overview})]}),z.tips&&z.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:z.tips.map((ce,E)=>a.jsx("li",{children:ce},E))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",z.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:z.exercises.map((ce,E)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:E+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:ce.name}),z.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[z.work,"s work / ",z.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[ce.sets," sets  ",ce.reps?`${ce.reps} reps`:`${ce.time}s`,ce.type==="weighted"&&"  weighted"]})]})]},E))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>tr(z),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),sr]})}if(b==="muscle_workout"){const z=Nt;if(!z)return null;const de=z.exercises[Ye],ce=Jn[Ye];if(!de||!ce)return null;const E=ce.sets.length,D=z.exercises.length,K=z.exercises.reduce((Oe,Je)=>Oe+(Je.sets||0),0),Te=Jn.reduce((Oe,Je)=>Oe+Je.sets.length,0)/K*100,Le=ht[de.name];de.type==="timed"&&vt===0&&!rn&&E===nn&&setTimeout(()=>Ct(de.time),0);const be=E+1<de.sets?"Log Set":Ye+1<D?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Te}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&k("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ye+1,"/",D]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Le?a.jsxs("div",{className:"mg-video-container",onClick:Rs,children:[Le.isGif?a.jsx("img",{className:"mg-video",src:Le.url,alt:de.name}):a.jsx("video",{ref:ft,className:"mg-video",src:Le.url,loop:!0,muted:!0,playsInline:!0},de.name),!J&&!Le.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:de.name}),a.jsx("span",{className:`mg-ex-type-badge ${de.type}`,children:de.type==="weighted"?"Weight + Reps":de.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",E+1," of ",de.sets]}),de.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",de.reps," reps"]}),de.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",de.time,"s"]})]}),de.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:cs,onChange:Oe=>Zn(Oe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Hn,onChange:Oe=>Bn(Oe.target.value),placeholder:"0"})]})]}),de.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Hn,onChange:Oe=>Bn(Oe.target.value),placeholder:"0"})]})}),de.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[vt,"s"]})}),rn?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Bt(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{vt===0&&Ct(de.time),Bt(!0)},children:vt<de.time&&vt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:Pi,children:be}),ce.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:ce.sets.map((Oe,Je)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Je+1,": ",Oe.weight!=null?`${Oe.weight}kg  ${Oe.reps}`:Oe.reps!=null?`${Oe.reps} reps`:`${Oe.time}s`]})]},Je))})]})]}),sr,Ut&&(()=>{const Oe=Jn.reduce((Xe,Ot)=>Xe+Ot.sets.length,0),Je=Zc.find(Xe=>Xe.key===le)?.label||"",Lt=[{value:Jn.length,label:"Exercises"},{value:Oe,label:"Sets"}];return a.jsx(Gg,{title:`${Je} Complete!`,subtitle:Nt?.name,stats:Lt,hideShare:!d,onShareJourney:t?Cn:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{St(!1),gt(null),It(null)}})})()]})}return a.jsx(ql,{badge:zt,onDismiss:()=>mn(null)})}const p5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],g5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",y5="#e91e63",v5="#FF4D88",b5=700,Kg=42,Il=2*Math.PI*Kg,gh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function w5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Fa(s){return s.toISOString().split("T")[0]}function x5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Li(),{isPremium:d,FREE_HABIT_LIMIT:p}=oc(),y=Zs(),[g,b]=w.useState({}),[k,S]=w.useState([]),[R,q]=w.useState(!0),[$,U]=w.useState(!1),[W,G]=w.useState(0),[Q,me]=w.useState(null),[ke,xe]=w.useState(null),[C,T]=w.useState(!1),[I,P]=w.useState(null),[V,L]=w.useState(!1),[A,De]=w.useState(!1),[tt,X]=w.useState(!1),[Ce,Me]=w.useState(""),[Re,Z]=w.useState(null),[O,se]=w.useState([]),[Ee,Se]=w.useState(null),ye=w.useRef(null),Ne=w.useRef(null),Ve=w.useRef(null),We=w.useRef(null),Ue=w.useRef(!1),Ut=w.useRef({}),St=w.useRef([]),Tn=w.useRef([]),Un=w.useRef(null),Pt=w.useRef(gh[Math.floor(Math.random()*gh.length)]),kt=w.useCallback((ae,Ie="info")=>{me({message:ae,type:Ie}),setTimeout(()=>me(null),3e3)},[]),Xt=new Date,Ge=Fa(Xt),Cn=w5(Xt),le=x5(Cn),It=["M","T","W","T","F","S","S"],Nt=(ae,Ie)=>l&&Ie?Ie:ae,gt=[...p5.filter(ae=>!O.includes(ae.key)).map(ae=>({...ae,color:Nt(ae.color,ae.darkColor)})),...k.map(ae=>({key:`custom_${ae.id}`,label:ae.label,icon:g5,color:Nt(y5,v5),isCustom:!0,id:ae.id}))],Ye=d?gt:gt.slice(0,p);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Ie=ut(ge,"habitLogs"),Qe=sn(Ie,wt("clientId","==",t.id)),lt=await Qt(Qe),at={};lt.docs.forEach(mn=>{const In=mn.data();at[In.date]={...In,_id:mn.id}}),b(at);const Vt=await vs(qe(ge,"customHabits",t.id));if(Vt.exists()){const mn=Vt.data();S(mn.habits||[]),se(mn.hiddenDefaults||[])}let en=0;const zt=new Date(Xt);for(;;){const mn=Fa(zt),In=at[mn];if(In)if(Object.values(In.habits||{}).filter(Boolean).length>=3)en++,zt.setDate(zt.getDate()-1);else break;else if(mn===Ge)zt.setDate(zt.getDate()-1);else break}G(en)}catch(Ie){console.error("Error loading habit logs:",Ie)}finally{q(!1)}})()},[s,t]);const ot=g[Ge]||{habits:{}};w.useEffect(()=>{Object.values(ot.habits||{}).filter(Boolean).length<Ye.length&&A&&De(!1)},[Ye.length,ot.habits]);const nn=async ae=>{if(!(!s||$||ot.habits?.[ae])){St.current=[...Array(10)].map((Qe,lt)=>{const at=lt/10*2*Math.PI,Vt=18+Math.random()*20;return{tx:Math.cos(at)*Vt,ty:Math.sin(at)*Vt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),xe(ae),setTimeout(()=>xe(null),700),navigator.vibrate&&navigator.vibrate(50),U(!0);try{const lt={...ot.habits||{},[ae]:!0},at=ot._id||`${t.id}_${Ge}`;if(b(en=>({...en,[Ge]:{clientId:t.id,date:Ge,habits:lt,_id:at}})),await Ss(qe(ge,"habitLogs",at),{clientId:t.id,date:Ge,habits:lt}),Object.values(lt).filter(Boolean).length===Ye.length&&!A){Pt.current=gh[Math.floor(Math.random()*gh.length)],Tn.current=[...Array(80)].map((zt,mn)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][mn%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:mn%3})),setTimeout(()=>{T(!0),De(!0),setTimeout(()=>Un.current?.focus(),1100)},400);let en=1;for(let zt=1;zt<7;zt++){const mn=new Date;mn.setDate(mn.getDate()-zt);const In=Fa(mn),Mn=g[In];if(Mn)if(Object.values(Mn.habits||{}).filter(Boolean).length>=Ye.length)en++;else break;else break}en>=7&&ef("habits_7",t).then(zt=>{zt&&P(zt)})}}catch(Qe){console.error("Error saving habit:",Qe),kt("Failed to save. Try again.","error"),b(lt=>({...lt,[Ge]:{...lt[Ge],habits:{...lt[Ge]?.habits||{},[ae]:!1}}}))}finally{U(!1)}}},Jt=async ae=>{if(!(!s||$)){U(!0);try{const Qe={...ot.habits||{},[ae]:!1},lt=ot._id||`${t.id}_${Ge}`;await Ss(qe(ge,"habitLogs",lt),{clientId:t.id,date:Ge,habits:Qe}),b(at=>({...at,[Ge]:{clientId:t.id,date:Ge,habits:Qe,_id:lt}}))}catch(Ie){console.error("Error undoing habit:",Ie),kt("Failed to undo. Try again.","error")}finally{U(!1)}}},Jn=ae=>{if(ot.habits?.[ae]||!1||$||We.current)return;We.current=ae,Se(ae),Ne.current=performance.now();const Qe=Ut.current[ae];Qe&&(Qe.style.strokeDashoffset=Il);const lt=at=>{const Vt=at-Ne.current,en=Math.min(Vt/b5,1),zt=Ut.current[ae];zt&&(zt.style.strokeDashoffset=Il-en*Il),en<1?Ve.current=requestAnimationFrame(lt):(We.current=null,Ue.current=!0,Ve.current=null,Se(null),nn(ae))};Ve.current=requestAnimationFrame(lt)},Nn=()=>{if(!We.current)return;const ae=We.current;We.current=null,Ve.current&&(cancelAnimationFrame(Ve.current),Ve.current=null),ye.current&&(clearTimeout(ye.current),ye.current=null),Ut.current[ae]&&(Ut.current[ae].style.strokeDashoffset=Il),Se(null),Ne.current=null};w.useEffect(()=>()=>{Ve.current&&cancelAnimationFrame(Ve.current),ye.current&&clearTimeout(ye.current)},[]);const cs=w.useCallback(async ae=>{if(!t)throw new Error("Not signed in");const Ie=ae&&typeof ae=="object"&&ae.type;await vr(ut(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ie?"":ae,type:Ie?ae.type:"text",imageURL:null,createdAt:Ds(),likeCount:0,commentCount:0,...Ie?{metadata:{title:ae.title||"",subtitle:ae.subtitle||"",stats:ae.stats||[],quote:ae.quote||"",badges:ae.badges||[]}}:{}})},[t]),Zn=async()=>{const ae=Ce.trim();if(!ae)return;if(!t?.id){kt("Still loading, try again","error");return}const Ie=Date.now().toString(36),Qe=[...k,{id:Ie,label:ae}];try{await Ss(qe(ge,"customHabits",t.id),{clientId:t.id,habits:Qe,hiddenDefaults:O},{merge:!0}),S(Qe),Me(""),X(!1),kt(`Added "${ae}"`,"success")}catch(lt){console.error("Error adding custom habit:",lt),kt(lt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${lt?.message||"Unknown error"}`,"error")}},Hn=async ae=>{if(!t?.id)return;const Ie=k.filter(Qe=>Qe.id!==ae);try{await Ss(qe(ge,"customHabits",t.id),{clientId:t.id,habits:Ie,hiddenDefaults:O},{merge:!0}),S(Ie),Z(null),kt("Habit removed","success")}catch(Qe){console.error("Error deleting habit:",Qe),kt("Failed to remove","error")}},Bn=async ae=>{if(!t?.id)return;const Ie=[...O,ae];try{await Ss(qe(ge,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:Ie},{merge:!0}),se(Ie),Z(null),kt("Habit removed","success")}catch(Qe){console.error("Error hiding default habit:",Qe),kt("Failed to remove","error")}},rn=le.map(ae=>{const Ie=Fa(ae),Qe=g[Ie],lt=Qe?Object.values(Qe.habits||{}).filter(Boolean).length:0;return{date:ae,dateStr:Ie,completed:lt,total:Ye.length}}),Bt=rn.reduce((ae,Ie)=>ae+Ie.completed,0),vt=rn.reduce((ae,Ie)=>ae+Ie.total,0),Ct=vt>0?Math.round(Bt/vt*100):0,J=Object.values(ot.habits||{}).filter(Boolean).length,Ae=Ye.length>0?Math.round(J/Ye.length*100):0,ht=J===Ye.length&&Ye.length>0,xt=(()=>{const ae=Object.keys(g).sort();let Ie=0,Qe=0,lt=null;for(const at of ae){const Vt=g[at];if(Object.values(Vt.habits||{}).filter(Boolean).length>=3){if(lt){const zt=new Date(lt);Qe=(new Date(at)-zt)/(1e3*60*60*24)===1?Qe+1:1}else Qe=1;Qe>Ie&&(Ie=Qe),lt=at}else Qe=0,lt=null}return Math.max(Ie,W)})(),ft=new Date(Xt.getFullYear(),Xt.getMonth(),1),st=ft.toLocaleString("default",{month:"long"}),nt=new Date(Xt.getFullYear(),Xt.getMonth()+1,0).getDate(),yt=(ft.getDay()+6)%7,Zt=Array.from({length:nt},(ae,Ie)=>{const Qe=new Date(Xt.getFullYear(),Xt.getMonth(),Ie+1),lt=Fa(Qe),at=g[lt],Vt=at?Object.values(at.habits||{}).filter(Boolean).length:0,en=Qe>Xt;return{day:Ie+1,dateStr:lt,completed:Vt,total:Ye.length,isFuture:en,isToday:lt===Ge}}),fn=Ye.map(ae=>({...ae,days:le.map(Ie=>{const Qe=Fa(Ie);return g[Qe]?.habits?.[ae.key]||!1})})),Rn=rn.filter(ae=>ae.completed===ae.total&&ae.total>0).length;return a.jsx(Zo,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||R?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${ht?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ae/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[J,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),Ye.length]}),a.jsx("span",{className:"cbc-ring-label",children:ht?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:ht?"You showed up for yourself today.":J===0?"Start your day strong.":`${Ye.length-J} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:W}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:xt}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[Ye.map(ae=>{const Ie=ot.habits?.[ae.key]||!1,Qe=ke===ae.key,lt=Ee===ae.key;return a.jsxs("div",{className:`cbc-habit-tile ${Ie?"cbc-habit-done":""} ${Qe?"cbc-habit-just-checked":""}`,style:{"--habit-color":ae.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:at=>{at.stopPropagation(),Z(ae.isCustom?{type:"custom",id:ae.id,label:ae.label}:{type:"default",key:ae.key,label:ae.label})},"aria-label":`Remove ${ae.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${lt?"cbc-holding":""} ${Ie?"cbc-ring-completed":""}`,onPointerDown:at=>{Ie||(at.preventDefault(),Jn(ae.key))},onPointerUp:Nn,onPointerLeave:Nn,onPointerCancel:Nn,onClick:at=>{if(at.stopPropagation(),Ue.current){Ue.current=!1;return}Ie&&Jt(ae.key)},role:"button",tabIndex:0,"aria-label":Ie?`Undo ${ae.label}`:`Press and hold to complete ${ae.label}`,onKeyDown:at=>{(at.key==="Enter"||at.key===" ")&&(at.preventDefault(),Ie?Jt(ae.key):nn(ae.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Kg}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:at=>{at&&(Ut.current[ae.key]=at)},cx:"50",cy:"50",r:Kg,style:{stroke:ae.color,strokeDasharray:Il,strokeDashoffset:Ie?0:Il}})]}),Ie&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":ae.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:ae.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:ae.icon})})}),Qe&&a.jsx("div",{className:"cbc-particles",children:St.current.map((at,Vt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${at.tx}px`,"--ty":`${at.ty}px`,"--size":`${at.size}px`,"--particle-color":ae.color,animationDuration:`${at.duration}s`}},Vt))})]}),a.jsx("span",{className:"cbc-habit-label",children:ae.label}),Ie?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ae.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>X(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[Rn,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),It.map((ae,Ie)=>a.jsx("span",{className:`cbc-weekly-day-label${le[Ie]&&Fa(le[Ie])===Ge?" cbc-today-label":""}`,children:ae},Ie))]}),fn.map(ae=>(ae.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:ae.color},children:ae.label}),ae.days.map((Ie,Qe)=>a.jsx("span",{className:`cbc-weekly-dot${Ie?" cbc-dot-done":""}${le[Qe]&&Fa(le[Qe])===Ge?" cbc-dot-today":""}`,style:Ie?{background:ae.color,borderColor:ae.color,boxShadow:`0 0 6px ${ae.color}40`}:void 0},Qe))]},ae.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Ct}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[Bt,"/",vt," completed (",Ct,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:st}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((ae,Ie)=>a.jsx("span",{className:"cbc-cal-day-label",children:ae},Ie))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:yt},(ae,Ie)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ie}`)),Zt.map(ae=>{const Ie=ae.total>0?ae.completed/ae.total:0,Qe=ae.isFuture?-1:Ie===0?0:Ie<.4?1:Ie<.75?2:Ie<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${ae.isToday?" cbc-cal-today":""}${Qe===4?" cbc-cal-perfect":""} cbc-cal-heat-${Qe<0?"future":Qe}`,children:ae.day},ae.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(Yr,{active:"home"}),tt&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>X(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:ae=>ae.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Ce,onChange:ae=>Me(ae.target.value),maxLength:30,autoFocus:!0,onKeyDown:ae=>ae.key==="Enter"&&Zn()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{X(!1),Me("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:Zn,disabled:!Ce.trim(),children:"Add"})]})]})}),Re&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Z(null),children:a.jsxs("div",{className:"cbc-modal",onClick:ae=>ae.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Re.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Z(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Re.type==="custom"?Hn(Re.id):Bn(Re.key),children:"Remove"})]})]})}),C&&a.jsx(Gg,{title:"All Habits Complete!",subtitle:Pt.current,stats:[{value:`${J}/${Ye.length}`,label:"Habits"},{value:W||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?cs:null,userName:t?.name,onDone:()=>{T(!1),L(!1)}}),Q&&a.jsx("div",{className:`toast-notification ${Q.type}`,children:Q.message}),a.jsx(ql,{badge:I,onDismiss:()=>P(null)})]})})}function yh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ex(s,e){return[s,e].sort().join("_")}function k5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Li(),d=Zs(),[p,y]=w.useState("buddies"),[g,b]=w.useState([]),[k,S]=w.useState([]),[R,q]=w.useState([]),[$,U]=w.useState(""),[W,G]=w.useState([]),[Q,me]=w.useState([]),[ke,xe]=w.useState(!0),[C,T]=w.useState(null),[I,P]=w.useState(null),V=w.useCallback((Z,O="info")=>{P({message:Z,type:O}),setTimeout(()=>P(null),3500)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const L=w.useCallback(async()=>{if(t){xe(!0);try{const Z=t.id,se=(await Qt(ut(ge,"clients"))).docs.map(Ue=>({id:Ue.id,...Ue.data()}));me(se);const Ee=Object.fromEntries(se.map(Ue=>[Ue.id,Ue])),Se=await Qt(sn(ut(ge,"buddies"),wt("user1","==",Z))),ye=await Qt(sn(ut(ge,"buddies"),wt("user2","==",Z))),Ne=new Set;[...Se.docs,...ye.docs].forEach(Ue=>{const Ut=Ue.data(),St=Ut.user1===Z?Ut.user2:Ut.user1;Ne.add(St)}),b(Array.from(Ne).map(Ue=>Ee[Ue]).filter(Boolean));const Ve=await Qt(sn(ut(ge,"buddyRequests"),wt("toId","==",Z),wt("status","==","pending")));S(Ve.docs.map(Ue=>({reqId:Ue.id,...Ue.data(),fromClient:Ee[Ue.data().fromId]})).filter(Ue=>Ue.fromClient));const We=await Qt(sn(ut(ge,"buddyRequests"),wt("fromId","==",Z),wt("status","==","pending")));q(We.docs.map(Ue=>({reqId:Ue.id,...Ue.data(),toClient:Ee[Ue.data().toId]})).filter(Ue=>Ue.toClient))}catch(Z){console.error("Error fetching buddy data:",Z),V("Failed to load buddies","error")}finally{xe(!1)}}},[t,V]);w.useEffect(()=>{L()},[L]),w.useEffect(()=>{if(!$.trim()||!t){G([]);return}const Z=$.toLowerCase(),O=t.id,se=new Set(g.map(Ne=>Ne.id)),Ee=new Set(R.map(Ne=>Ne.toId)),Se=new Set(k.map(Ne=>Ne.fromId)),ye=Q.filter(Ne=>Ne.id===O||!Ne.name||!Ne.coreBuddyAccess&&Ne.clientType!=="core_buddy"?!1:Ne.name.toLowerCase().includes(Z)).map(Ne=>({...Ne,isBuddy:se.has(Ne.id),isPendingOut:Ee.has(Ne.id),isPendingIn:Se.has(Ne.id)})).slice(0,20);G(ye)},[$,Q,g,R,k,t]);const A=async(Z,O)=>{if(!(!t||Z===t.id))try{await vr(ut(ge,"notifications"),{toId:Z,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:O,read:!1,createdAt:Ds()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&V("Notifications blocked  check Firestore rules","error")}},De=async Z=>{T(Z);try{const O=`${t.id}_${Z}`;await Ss(qe(ge,"buddyRequests",O),{fromId:t.id,toId:Z,status:"pending",createdAt:Ds()}),await A(Z,"buddy_request"),V("Buddy request sent!","success"),await L()}catch(O){console.error("Error sending request:",O),V("Failed to send request","error")}finally{T(null)}},tt=async Z=>{T(Z.reqId);try{const O=ex(Z.fromId,t.id);await Ss(qe(ge,"buddies",O),{user1:[Z.fromId,t.id].sort()[0],user2:[Z.fromId,t.id].sort()[1],connectedAt:Ds()}),await Ar(qe(ge,"buddyRequests",Z.reqId)),await A(Z.fromId,"buddy_accept"),V("Buddy added!","success"),await L()}catch(O){console.error("Error accepting request:",O),V("Failed to accept","error")}finally{T(null)}},X=async Z=>{T(Z.reqId);try{await Ar(qe(ge,"buddyRequests",Z.reqId)),V("Request declined","info"),await L()}catch(O){console.error("Error declining:",O),V("Failed to decline","error")}finally{T(null)}},Ce=async Z=>{T(Z.reqId);try{await Ar(qe(ge,"buddyRequests",Z.reqId)),V("Request cancelled","info"),await L()}catch(O){console.error("Error cancelling:",O),V("Failed to cancel","error")}finally{T(null)}},Me=async Z=>{T(Z);try{const O=ex(t.id,Z);await Ar(qe(ge,"buddies",O)),V("Buddy removed","info"),await L()}catch(O){console.error("Error removing buddy:",O),V("Failed to remove buddy","error")}finally{T(null)}},Re=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(Zo,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Re>0&&a.jsx("span",{className:"bdy-tab-badge",children:Re})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),ke?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:g.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:g.map(Z=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Z.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:Z.photoURL?a.jsx("img",{src:Z.photoURL,alt:Z.name}):a.jsx("span",{children:yh(Z.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:Z.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:O=>{O.stopPropagation(),Me(Z.id)},disabled:C===Z.id,"aria-label":"Remove buddy",children:C===Z.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Z.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(Z=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:Z.fromClient.photoURL?a.jsx("img",{src:Z.fromClient.photoURL,alt:Z.fromClient.name}):a.jsx("span",{children:yh(Z.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:Z.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>tt(Z),disabled:C===Z.reqId,children:C===Z.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>X(Z),disabled:C===Z.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},Z.reqId))})]}),R.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:R.map(Z=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:Z.toClient?.photoURL?a.jsx("img",{src:Z.toClient.photoURL,alt:Z.toClient.name}):a.jsx("span",{children:yh(Z.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:Z.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>Ce(Z),disabled:C===Z.reqId,children:C===Z.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},Z.reqId))})]}),k.length===0&&R.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:$,onChange:Z=>U(Z.target.value),autoFocus:!0}),$&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>U(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$.trim()&&W.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',$,'"']})}),W.length>0&&a.jsx("div",{className:"bdy-list",children:W.map(Z=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Z.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:Z.photoURL?a.jsx("img",{src:Z.photoURL,alt:Z.name}):a.jsx("span",{children:yh(Z.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:Z.name}),Z.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),Z.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):Z.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):Z.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:O=>{O.stopPropagation();const se=k.find(Ee=>Ee.fromId===Z.id);se&&tt(se)},disabled:!!C,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:O=>{O.stopPropagation(),De(Z.id)},disabled:C===Z.id,children:C===Z.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},Z.id))})]})]})]}),a.jsx(Yr,{active:"buddies"}),I&&a.jsxs("div",{className:`toast-notification ${I.type}`,children:[a.jsx("span",{className:"toast-icon",children:I.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):I.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:I.message})]})]})})}function vh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ag(s,e){return[s,e].sort().join("_")}const E5=5;function og(s){return s.toISOString().split("T")[0]}function tx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function T5(){const{userId:s}=xS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=Li(),p=Zs(),[y,g]=w.useState(null),[b,k]=w.useState("none"),[S,R]=w.useState(null),[q,$]=w.useState(!0),[U,W]=w.useState(!1),[G,Q]=w.useState(null),[me,ke]=w.useState([]),[xe,C]=w.useState(!1),[T,I]=w.useState(new Set),[P,V]=w.useState(new Set),[L,A]=w.useState({}),[De,tt]=w.useState({}),[X,Ce]=w.useState({}),[Me,Re]=w.useState(!0),[Z,O]=w.useState(0),[se,Ee]=w.useState(0),[Se,ye]=w.useState(0),[Ne,Ve]=w.useState(new Set),[We,Ue]=w.useState(null),[Ut,St]=w.useState(!1),[Tn,Un]=w.useState(!1),[Pt,kt]=w.useState([]),[Xt,Ge]=w.useState(!1),[Cn,le]=w.useState(null),[It,Nt]=w.useState([]),gt=w.useCallback((J,Ae="info")=>{Q({message:J,type:Ae}),setTimeout(()=>Q(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),w.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let J=!1;return(async()=>{$(!0);try{const xt=(await Qt(ut(ge,"clients"))).docs.map(yt=>({id:yt.id,...yt.data()})).find(yt=>yt.id===s);if(!xt){J||$(!1);return}J||g(xt);const ft=i.id,st=ag(ft,s);if((await vs(qe(ge,"buddies",st))).exists())J||k("buddy");else{const yt=`${ft}_${s}`,Zt=await vs(qe(ge,"buddyRequests",yt));if(Zt.exists()&&Zt.data().status==="pending")J||(k("pending_out"),R(yt));else{const fn=`${s}_${ft}`,Rn=await vs(qe(ge,"buddyRequests",fn));Rn.exists()&&Rn.data().status==="pending"?J||(k("pending_in"),R(fn)):J||k("none")}}}catch(Ae){console.error("Error loading profile:",Ae)}finally{J||$(!1)}})(),()=>{J=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let J=!1;return(async()=>{Re(!0);try{const Ae=await Qt(sn(ut(ge,"workoutLogs"),wt("clientId","==",s)));if(J)return;const ht=Ae.docs.length;O(ht);let xt=0;const ft=Ae.docs.map(nt=>nt.data().date).filter(Boolean).sort().reverse();if(ft.length>0){const nt=new Date;let yt=new Date(nt);for(let Zt=0;Zt<52;Zt++){const fn=new Date(yt),Rn=fn.getDay(),ae=Rn===0?6:Rn-1;fn.setDate(fn.getDate()-ae),fn.setHours(0,0,0,0);const Ie=new Date(fn);Ie.setDate(Ie.getDate()+7);const Qe=og(fn),lt=og(Ie);if(ft.some(Vt=>Vt>=Qe&&Vt<lt))xt++;else{if(Zt>0)break;break}yt.setDate(yt.getDate()-7)}}J||Ee(xt);let st=0;for(let nt=0;nt<30;nt++){const yt=new Date;yt.setDate(yt.getDate()-nt);const Zt=og(yt);try{const fn=await Qt(sn(ut(ge,"habitLogs"),wt("clientId","==",s),wt("date","==",Zt)));if(fn.empty)break;{const Rn=fn.docs[0].data().habits||{};if(Object.values(Rn).filter(Boolean).length>=E5)st++;else break}}catch{break}}J||ye(st);try{const nt=await vs(qe(ge,"coreBuddyBadges",s));if(!J&&nt.exists()){const yt=nt.data().earned||[];Ve(new Set(yt.map(Zt=>Zt.id)))}}catch(nt){console.error("Error loading buddy badges:",nt)}}catch(Ae){console.error("Error loading buddy stats:",Ae)}finally{J||Re(!1)}})(),()=>{J=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const J=i.id;(async()=>{try{const[Ae,ht,xt]=await Promise.all([Qt(sn(ut(ge,"buddies"),wt("user1","==",J))),Qt(sn(ut(ge,"buddies"),wt("user2","==",J))),Qt(ut(ge,"clients"))]),ft=new Set;[...Ae.docs,...ht.docs].forEach(nt=>{const yt=nt.data();ft.add(yt.user1===J?yt.user2:yt.user1)});const st={};xt.docs.forEach(nt=>{st[nt.id]=nt.data()}),kt(Array.from(ft).filter(nt=>st[nt]).map(nt=>({id:nt,name:st[nt].name,photoURL:st[nt].photoURL||null})))}catch(Ae){console.error("Error loading buddies for mentions:",Ae)}})()},[i]);const Ye=async(J,Ae,ht={})=>{if(!(!i||J===i.id))try{await vr(ut(ge,"notifications"),{toId:J,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ae,read:!1,createdAt:Ds(),...ht})}catch(xt){console.error("Notification error:",xt),xt.code==="permission-denied"&&gt("Notifications blocked  check Firestore rules","error")}},ot=async()=>{W(!0);try{const J=`${i.id}_${s}`;await Ss(qe(ge,"buddyRequests",J),{fromId:i.id,toId:s,status:"pending",createdAt:Ds()}),await Ye(s,"buddy_request"),k("pending_out"),R(J),gt("Buddy request sent!","success")}catch(J){console.error(J),gt("Failed to send request","error")}finally{W(!1)}},nn=async()=>{if(S){W(!0);try{const J=ag(i.id,s);await Ss(qe(ge,"buddies",J),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Ds()}),await Ar(qe(ge,"buddyRequests",S)),await Ye(s,"buddy_accept"),k("buddy"),gt("Buddy added!","success")}catch(J){console.error(J),gt("Failed to accept","error")}finally{W(!1)}}},Jt=async()=>{if(S){W(!0);try{await Ar(qe(ge,"buddyRequests",S)),k("none"),gt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(J){console.error(J),gt("Failed","error")}finally{W(!1)}}},Jn=async()=>{W(!0);try{const J=ag(i.id,s);await Ar(qe(ge,"buddies",J)),k("none"),St(!1),gt("Buddy removed","info")}catch(J){console.error(J),gt("Failed to remove","error")}finally{W(!1)}},Nn=w.useCallback(async()=>{if(s){C(!0);try{const J=await Qt(sn(ut(ge,"posts"),wt("authorId","==",s),Eu("createdAt","desc"),Tu(30)));if(ke(J.docs.map(Ae=>({id:Ae.id,...Ae.data()}))),i){const Ae=await Qt(sn(ut(ge,"postLikes"),wt("userId","==",i.id)));I(new Set(Ae.docs.map(ht=>ht.data().postId)))}}catch(J){console.error("Error loading journey:",J)}finally{C(!1)}}},[s,i]);w.useEffect(()=>{!q&&y&&Nn()},[q,y,Nn]);const cs=async J=>{if(window.confirm("Delete this post?"))try{await Ar(qe(ge,"posts",J)),ke(Ae=>Ae.filter(ht=>ht.id!==J)),gt("Post deleted","info")}catch(Ae){console.error("Delete error:",Ae),gt("Failed to delete","error")}},Zn=async J=>{if(!i)return;const Ae=i.id,ht=`${J}_${Ae}`,xt=T.has(J),ft=new Set(T);xt?ft.delete(J):ft.add(J),I(ft),ke(st=>st.map(nt=>nt.id===J?{...nt,likeCount:Math.max(0,(nt.likeCount||0)+(xt?-1:1))}:nt));try{if(xt)await Ar(qe(ge,"postLikes",ht)),await ls(qe(ge,"posts",J),{likeCount:Io(-1)});else{await Ss(qe(ge,"postLikes",ht),{postId:J,userId:Ae,createdAt:Ds()}),await ls(qe(ge,"posts",J),{likeCount:Io(1)});const st=me.find(nt=>nt.id===J);st&&Ye(st.authorId,"like",{postId:J})}}catch(st){console.error("Like error:",st),Nn()}},Hn=async J=>{try{const Ae=await Qt(sn(ut(ge,"postComments"),wt("postId","==",J),Eu("createdAt","asc"),Tu(50)));A(ht=>({...ht,[J]:Ae.docs.map(xt=>({id:xt.id,...xt.data()}))}))}catch(Ae){console.error("Error loading comments:",Ae)}},Bn=J=>{const Ae=new Set(P);Ae.has(J)?Ae.delete(J):(Ae.add(J),L[J]||Hn(J)),V(Ae)},rn=(J,Ae)=>{const ht=J.match(/@(\w*)$/);if(ht){Ge(!0),le(Ae);const xt=Pt.filter(ft=>ft.name&&ft.name.toLowerCase().includes(ht[1].toLowerCase())).slice(0,5);Nt(xt)}else Ge(!1),Nt([])},Bt=(J,Ae)=>{const xt=(De[Ae]||"").replace(/@\w*$/,`@${J.name} `);tt(ft=>({...ft,[Ae]:xt})),Ge(!1),Nt([])},vt=(J,Ae)=>{tt(ht=>({...ht,[J]:Ae})),rn(Ae,J)},Ct=async J=>{const Ae=(De[J]||"").trim();if(!(!Ae||!i)){Ce(ht=>({...ht,[J]:!0}));try{await vr(ut(ge,"postComments"),{postId:J,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ae,createdAt:Ds()}),await ls(qe(ge,"posts",J),{commentCount:Io(1)});const ht=me.find(ft=>ft.id===J);ht&&Ye(ht.authorId,"comment",{postId:J});const xt=Ae.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(xt){const ft=new Set;xt.forEach(st=>{const nt=st.slice(1).trim(),yt=Pt.find(Zt=>Zt.name&&Zt.name.toLowerCase()===nt.toLowerCase());yt&&!ft.has(yt.id)&&(ft.add(yt.id),Ye(yt.id,"mention",{postId:J}))})}tt(ft=>({...ft,[J]:""})),ke(ft=>ft.map(st=>st.id===J?{...st,commentCount:(st.commentCount||0)+1}:st)),await Hn(J)}catch(ht){console.error("Comment error:",ht),gt("Failed to comment","error")}finally{Ce(ht=>({...ht,[J]:!1}))}}};return l||q||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(Zo,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>St(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&Un(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:vh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ot,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Jt,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:nn,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Jt,disabled:U,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),Me?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:Z}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[se,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Se>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Se," day",Se!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const J=ui.filter(Ae=>Ne.has(Ae.id));return J.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[J.length,"/",ui.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:J.map(Ae=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Ue(Ae),children:[a.jsx("img",{src:Ae.img,alt:Ae.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:Ae.name})]},Ae.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),xe?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):me.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:me.map(J=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:J.authorPhotoURL?a.jsx("img",{src:J.authorPhotoURL,alt:""}):a.jsx("span",{children:vh(J.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:J.authorName}),a.jsx("span",{className:"journey-post-time",children:tx(J.createdAt)})]}),J.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>cs(J.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),J.type==="workout_summary"&&J.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:J.metadata.title}),J.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:J.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),!J.metadata.stats?.length&&J.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:J.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):J.type==="badge_earned"&&J.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const Ae=ui.find(ht=>ht.id===J.metadata.badgeId);return Ae?.img?a.jsx("img",{src:Ae.img,alt:J.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:J.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:J.metadata.title}),J.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:J.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):J.type==="habits_summary"&&J.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:J.metadata.title}),J.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:J.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),J.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:J.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[J.content&&a.jsx("p",{className:"journey-post-content",children:J.content}),J.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:J.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${T.has(J.id)?" liked":""}`,onClick:()=>Zn(J.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(J.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:J.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${P.has(J.id)?" active":""}`,onClick:()=>Bn(J.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:J.commentCount||0})]})]}),P.has(J.id)&&a.jsxs("div",{className:"journey-comments",children:[L[J.id]?.length>0?L[J.id].map(Ae=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ae.authorId}`),children:Ae.authorPhotoURL?a.jsx("img",{src:Ae.authorPhotoURL,alt:""}):a.jsx("span",{children:vh(Ae.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ae.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ae.content})]}),a.jsx("span",{className:"journey-comment-time",children:tx(Ae.createdAt)})]})]},Ae.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:De[J.id]||"",onChange:Ae=>vt(J.id,Ae.target.value),onKeyDown:Ae=>{Ae.key==="Enter"&&Ct(J.id)},maxLength:300}),Xt&&Cn===J.id&&It.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:It.map(Ae=>a.jsxs("button",{className:"mention-option",onClick:()=>Bt(Ae,J.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ae.photoURL?a.jsx("img",{src:Ae.photoURL,alt:""}):a.jsx("span",{children:vh(Ae.name)})}),a.jsx("span",{children:Ae.name})]},Ae.id))}),a.jsx("button",{onClick:()=>Ct(J.id),disabled:!(De[J.id]||"").trim()||X[J.id],children:X[J.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},J.id))})]})]}),a.jsx(Yr,{active:"buddies"}),Tn&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>Un(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),We&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Ue(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:J=>J.stopPropagation(),children:[a.jsx("img",{src:We.img,alt:We.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:We.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:We.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Ue(null),children:"Close"})]})}),Ut&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>St(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:J=>J.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>St(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:Jn,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),G&&a.jsxs("div",{className:`toast-notification ${G.type}`,children:[a.jsx("span",{className:"toast-icon",children:G.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):G.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:G.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Yr,{active:"buddies"})]})}const lg=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],nx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function j5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function S5(){const s=Zs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Mr(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[p,y]=w.useState(0),[g,b]=w.useState(0),[k,S]=w.useState(null),[R,q]=w.useState(!1),$=w.useRef(null),[U,W]=w.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:nx.filter(A=>A.defaultOn).map(A=>A.id)}),[G,Q]=w.useState(!1),[me,ke]=w.useState(!1),[xe,C]=w.useState(null);w.useEffect(()=>{e?.photoURL&&S(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const L=()=>{const De=new Date,tt=new Date(De);tt.setHours(23,59,59,999);const X=tt-De;d({hours:Math.floor(X/36e5),minutes:Math.floor(X%36e5/6e4),seconds:Math.floor(X%6e4/1e3)}),y(60-Math.floor(X%6e4/1e3))};L();const A=setInterval(L,1e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{const L=setInterval(()=>b(A=>(A+1)%lg.length),8e3);return()=>clearInterval(L)},[]);const T=async L=>{const A=L.target.files?.[0];if(!(!A||!e?.id)){q(!0);try{const De=Ya(Qa,`profilePhotos/${e.id}`);await Ih(De,A);const tt=await Po(De);await ls(qe(ge,"clients",e.id),{photoURL:tt}),S(tt),i({photoURL:tt})}catch(De){console.error("Photo upload error:",De)}finally{q(!1)}}},I=L=>{ke(!1),W(A=>A.includes(L)?A.filter(De=>De!==L):[...A,L])},P=(L,A)=>{ke(!1),W(De=>{const tt=De.indexOf(L);if(tt<0)return De;const X=tt+A;if(X<0||X>=De.length)return De;const Ce=[...De];return[Ce[tt],Ce[X]]=[Ce[X],Ce[tt]],Ce})},V=async()=>{Q(!0),C(null);try{const L=e||await l();if(!L?.id){C("Could not find your profile. Try refreshing."),Q(!1);return}await ls(qe(ge,"clients",L.id),{dashboardWidgets:U}),i({dashboardWidgets:U}),ke(!0)}catch(L){console.error("Save config error:",L),C("Save failed  please try again.")}finally{Q(!1)}};return a.jsx(Zo,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:jE.map((L,A)=>a.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>$.current?.click(),children:[a.jsx("img",{src:k||"/Logo.webp",alt:k?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${R?" uploading":""}`,children:R?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!k&&!R&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>$.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[lg[g].text," ",a.jsx("strong",{children:lg[g].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:nx.map(L=>{const A=U.includes(L.id),De=U.indexOf(L.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:j5(L.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:L.label}),a.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>P(L.id,-1),disabled:De===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:De+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>P(L.id,1),disabled:De===U.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>I(L.id),"aria-label":A?`Remove ${L.label}`:`Add ${L.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${me?" saved":""}`,onClick:V,disabled:G||me,children:G?"Saving...":me?"Saved":"Save Dashboard"}),xe&&a.jsx("p",{className:"bldr-save-error",children:xe}),me&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(Yr,{active:"home"})]})})}const SE="@firebase/installations",g0="0.6.19";const CE=1e4,NE=`w:${g0}`,AE="FIS_v2",C5="https://firebaseinstallations.googleapis.com/v1",N5=3600*1e3,A5="installations",R5="Installations";const I5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ho=new Wo(A5,R5,I5);function RE(s){return s instanceof pi&&s.code.includes("request-failed")}function IE({projectId:s}){return`${C5}/projects/${s}/installations`}function ME(s){return{token:s.token,requestStatus:2,expiresIn:D5(s.expiresIn),creationTime:Date.now()}}async function DE(s,e){const i=(await e.json()).error;return Ho.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function LE({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function M5(s,{refreshToken:e}){const t=LE(s);return t.append("Authorization",L5(e)),t}async function OE(s){const e=await s();return e.status>=500&&e.status<600?s():e}function D5(s){return Number(s.replace("s","000"))}function L5(s){return`${AE} ${s}`}async function O5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=IE(s),l=LE(s),u=e.getImmediate({optional:!0});if(u){const g=await u.getHeartbeatsHeader();g&&l.append("x-firebase-client",g)}const d={fid:t,authVersion:AE,appId:s.appId,sdkVersion:NE},p={method:"POST",headers:l,body:JSON.stringify(d)},y=await OE(()=>fetch(i,p));if(y.ok){const g=await y.json();return{fid:g.fid||t,registrationStatus:2,refreshToken:g.refreshToken,authToken:ME(g.authToken)}}else throw await DE("Create Installation",y)}function PE(s){return new Promise(e=>{setTimeout(e,s)})}function P5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const V5=/^[cdef][\w-]{21}$/,Yg="";function U5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=B5(s);return V5.test(t)?t:Yg}catch{return Yg}}function B5(s){return P5(s).substr(0,22)}function Rf(s){return`${s.appName}!${s.appId}`}const VE=new Map;function UE(s,e){const t=Rf(s);BE(t,e),z5(t,e)}function BE(s,e){const t=VE.get(s);if(t)for(const i of t)i(e)}function z5(s,e){const t=F5();t&&t.postMessage({key:s,fid:e}),q5()}let Mo=null;function F5(){return!Mo&&"BroadcastChannel"in self&&(Mo=new BroadcastChannel("[Firebase] FID Change"),Mo.onmessage=s=>{BE(s.data.key,s.data.fid)}),Mo}function q5(){VE.size===0&&Mo&&(Mo.close(),Mo=null)}const H5="firebase-installations-database",$5=1,$o="firebase-installations-store";let cg=null;function y0(){return cg||(cg=af(H5,$5,{upgrade:(s,e)=>{e===0&&s.createObjectStore($o)}})),cg}async function tf(s,e){const t=Rf(s),l=(await y0()).transaction($o,"readwrite"),u=l.objectStore($o),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&UE(s,e.fid),e}async function zE(s){const e=Rf(s),i=(await y0()).transaction($o,"readwrite");await i.objectStore($o).delete(e),await i.done}async function If(s,e){const t=Rf(s),l=(await y0()).transaction($o,"readwrite"),u=l.objectStore($o),d=await u.get(t),p=e(d);return p===void 0?await u.delete(t):await u.put(p,t),await l.done,p&&(!d||d.fid!==p.fid)&&UE(s,p.fid),p}async function v0(s){let e;const t=await If(s.appConfig,i=>{const l=W5(i),u=G5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Yg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function W5(s){const e=s||{fid:U5(),registrationStatus:0};return FE(e)}function G5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Ho.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=K5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Y5(s)}:{installationEntry:e}}async function K5(s,e){try{const t=await O5(s,e);return tf(s.appConfig,t)}catch(t){throw RE(t)&&t.customData.serverCode===409?await zE(s.appConfig):await tf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Y5(s){let e=await sx(s.appConfig);for(;e.registrationStatus===1;)await PE(100),e=await sx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await v0(s);return i||t}return e}function sx(s){return If(s,e=>{if(!e)throw Ho.create("installation-not-found");return FE(e)})}function FE(s){return Q5(s)?{fid:s.fid,registrationStatus:0}:s}function Q5(s){return s.registrationStatus===1&&s.registrationTime+CE<Date.now()}async function X5({appConfig:s,heartbeatServiceProvider:e},t){const i=J5(s,t),l=M5(s,t),u=e.getImmediate({optional:!0});if(u){const g=await u.getHeartbeatsHeader();g&&l.append("x-firebase-client",g)}const d={installation:{sdkVersion:NE,appId:s.appId}},p={method:"POST",headers:l,body:JSON.stringify(d)},y=await OE(()=>fetch(i,p));if(y.ok){const g=await y.json();return ME(g)}else throw await DE("Generate Auth Token",y)}function J5(s,{fid:e}){return`${IE(s)}/${e}/authTokens:generate`}async function b0(s,e=!1){let t;const i=await If(s.appConfig,u=>{if(!qE(u))throw Ho.create("not-registered");const d=u.authToken;if(!e&&tL(d))return u;if(d.requestStatus===1)return t=Z5(s,e),u;{if(!navigator.onLine)throw Ho.create("app-offline");const p=sL(u);return t=eL(s,p),p}});return t?await t:i.authToken}async function Z5(s,e){let t=await rx(s.appConfig);for(;t.authToken.requestStatus===1;)await PE(100),t=await rx(s.appConfig);const i=t.authToken;return i.requestStatus===0?b0(s,e):i}function rx(s){return If(s,e=>{if(!qE(e))throw Ho.create("not-registered");const t=e.authToken;return rL(t)?{...e,authToken:{requestStatus:0}}:e})}async function eL(s,e){try{const t=await X5(s,e),i={...e,authToken:t};return await tf(s.appConfig,i),t}catch(t){if(RE(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await zE(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await tf(s.appConfig,i)}throw t}}function qE(s){return s!==void 0&&s.registrationStatus===2}function tL(s){return s.requestStatus===2&&!nL(s)}function nL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+N5}function sL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function rL(s){return s.requestStatus===1&&s.requestTime+CE<Date.now()}async function iL(s){const e=s,{installationEntry:t,registrationPromise:i}=await v0(e);return i?i.catch(console.error):b0(e).catch(console.error),t.fid}async function aL(s,e=!1){const t=s;return await oL(t),(await b0(t,e)).token}async function oL(s){const{registrationPromise:e}=await v0(s);e&&await e}function lL(s){if(!s||!s.options)throw ug("App Configuration");if(!s.name)throw ug("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw ug(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function ug(s){return Ho.create("missing-app-config-values",{valueName:s})}const HE="installations",cL="installations-internal",uL=s=>{const e=s.getProvider("app").getImmediate(),t=lL(e),i=Go(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},dL=s=>{const e=s.getProvider("app").getImmediate(),t=Go(e,HE).getImmediate();return{getId:()=>iL(t),getToken:l=>aL(t,l)}};function hL(){di(new Kr(HE,uL,"PUBLIC")),di(new Kr(cL,dL,"PRIVATE"))}hL();br(SE,g0);br(SE,g0,"esm2020");const fL="/firebase-messaging-sw.js",mL="/firebase-cloud-messaging-push-scope",$E="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",pL="https://fcmregistrations.googleapis.com/v1",WE="google.c.a.c_id",gL="google.c.a.c_l",yL="google.c.a.ts",vL="google.c.a.e",ix=1e4;var ax;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ax||(ax={}));var ju;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(ju||(ju={}));function na(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const dg="fcm_token_details_db",wL=5,ox="fcm_token_object_Store";async function xL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(dg))return null;let e=null;return(await af(dg,wL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(ox))return;const p=d.objectStore(ox),y=await p.index("fcmSenderId").get(s);if(await p.clear(),!!y){if(l===2){const g=y;if(!g.auth||!g.p256dh||!g.endpoint)return;e={token:g.fcmToken,createTime:g.createTime??Date.now(),subscriptionOptions:{auth:g.auth,p256dh:g.p256dh,endpoint:g.endpoint,swScope:g.swScope,vapidKey:typeof g.vapidKey=="string"?g.vapidKey:na(g.vapidKey)}}}else if(l===3){const g=y;e={token:g.fcmToken,createTime:g.createTime,subscriptionOptions:{auth:na(g.auth),p256dh:na(g.p256dh),endpoint:g.endpoint,swScope:g.swScope,vapidKey:na(g.vapidKey)}}}else if(l===4){const g=y;e={token:g.fcmToken,createTime:g.createTime,subscriptionOptions:{auth:na(g.auth),p256dh:na(g.p256dh),endpoint:g.endpoint,swScope:g.swScope,vapidKey:na(g.vapidKey)}}}}}})).close(),await Vp(dg),await Vp("fcm_vapid_details_db"),await Vp("undefined"),_L(e)?e:null}function _L(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const kL="firebase-messaging-database",EL=1,Su="firebase-messaging-store";let hg=null;function GE(){return hg||(hg=af(kL,EL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Su)}})),hg}async function TL(s){const e=KE(s),i=await(await GE()).transaction(Su).objectStore(Su).get(e);if(i)return i;{const l=await xL(s.appConfig.senderId);if(l)return await w0(s,l),l}}async function w0(s,e){const t=KE(s),l=(await GE()).transaction(Su,"readwrite");return await l.objectStore(Su).put(e,t),await l.done,e}function KE({appConfig:s}){return s.appId}const jL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ur=new Wo("messaging","Messaging",jL);async function SL(s,e){const t=await _0(s),i=YE(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(x0(s.appConfig),l)).json()}catch(d){throw ur.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw ur.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw ur.create("token-subscribe-no-token");return u.token}async function CL(s,e){const t=await _0(s),i=YE(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${x0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw ur.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw ur.create("token-update-failed",{errorInfo:d})}if(!u.token)throw ur.create("token-update-no-token");return u.token}async function NL(s,e){const i={method:"DELETE",headers:await _0(s)};try{const u=await(await fetch(`${x0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw ur.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw ur.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function x0({projectId:s}){return`${pL}/projects/${s}/registrations`}async function _0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function YE({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==$E&&(l.web.applicationPubKey=i),l}const AL=10080*60*1e3;async function RL(s){const e=await ML(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:na(e.getKey("auth")),p256dh:na(e.getKey("p256dh"))},i=await TL(s.firebaseDependencies);if(i){if(DL(i.subscriptionOptions,t))return Date.now()>=i.createTime+AL?IL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await NL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return lx(s.firebaseDependencies,t)}else return lx(s.firebaseDependencies,t)}async function IL(s,e){try{const t=await CL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await w0(s.firebaseDependencies,i),t}catch(t){throw t}}async function lx(s,e){const i={token:await SL(s,e),createTime:Date.now(),subscriptionOptions:e};return await w0(s,i),i.token}async function ML(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:bL(e)})}function DL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function cx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return LL(e,s),OL(e,s),PL(e,s),e}function LL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function OL(s,e){e.data&&(s.data=e.data)}function PL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function VL(s){return typeof s=="object"&&!!s&&WE in s}function UL(s){if(!s||!s.options)throw fg("App Configuration Object");if(!s.name)throw fg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw fg(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fg(s){return ur.create("missing-app-config-values",{valueName:s})}class BL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=UL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function zL(s){try{s.swRegistration=await navigator.serviceWorker.register(fL,{scope:mL}),s.swRegistration.update().catch(()=>{}),await FL(s.swRegistration)}catch(e){throw ur.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function FL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${ix} ms`)),ix),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function qL(s,e){if(!e&&!s.swRegistration&&await zL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw ur.create("invalid-sw-registration");s.swRegistration=e}}async function HL(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=$E)}async function QE(s,e){if(!navigator)throw ur.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw ur.create("permission-blocked");return await HL(s,e?.vapidKey),await qL(s,e?.serviceWorkerRegistration),RL(s)}async function $L(s,e,t){const i=WL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[WE],message_name:t[gL],message_time:t[yL],message_device_time:Math.floor(Date.now()/1e3)})}function WL(s){switch(s){case ju.NOTIFICATION_CLICKED:return"notification_open";case ju.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function GL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===ju.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(cx(t)):s.onMessageHandler.next(cx(t)));const i=t.data;VL(i)&&i[vL]==="1"&&await $L(s,t.messageType,i)}const ux="@firebase/messaging",dx="0.12.23";const KL=s=>{const e=new BL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>GL(e,t)),e},YL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>QE(e,i)}};function QL(){di(new Kr("messaging",KL,"PUBLIC")),di(new Kr("messaging-internal",YL,"PRIVATE")),br(ux,dx),br(ux,dx,"esm2020")}async function XL(){try{await qx()}catch{return!1}return typeof window<"u"&&Fx()&&LC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function JL(s=Ru()){return XL().then(e=>{if(!e)throw ur.create("unsupported-browser")},e=>{throw ur.create("indexed-db-unsupported")}),Go(gn(s),"messaging").getImmediate()}async function ZL(s,e){return s=gn(s),QE(s,e)}QL();const eO="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let mg=null;function tO(){if(!mg)try{mg=JL(Ru())}catch{return null}return mg}function Qg(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function hx(){return"Notification"in window?Notification.permission:"denied"}function nO(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function sO(s){if(!Qg())return null;try{const e=await Notification.requestPermission(),t=tO();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let p=1;p<=d;p++){try{const y=()=>ZL(t,{vapidKey:eO,serviceWorkerRegistration:i});if(u=l?await nO(y):await y(),u)break}catch(y){console.warn(`Push getToken attempt ${p}/${d} failed:`,y)}p<d&&await new Promise(y=>setTimeout(y,1500*p))}return u&&s&&await ls(qe(ge,"clients",s),{fcmTokens:T6(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function rO(s,e){if(!(!e||!s))try{await ls(qe(ge,"clients",s),{fcmTokens:j6(e)})}catch(t){console.error("Token revoke failed:",t)}}const iO=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function aO(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=Li(),p=Zs(),[y,g]=w.useState(!1),[b,k]=w.useState(null),[S,R]=w.useState(!1),[q,$]=w.useState("default"),[U,W]=w.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[G,Q]=w.useState(null),me=w.useCallback((C,T="info")=>{Q({message:C,type:T}),setTimeout(()=>Q(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&p("/")},[l,s,p]),w.useEffect(()=>{if(!e)return;const C=e.notificationPrefs;C&&W(I=>({...I,...C}));const T=e.fcmTokens||[];T.length>0&&(g(!0),k(T[T.length-1])),$(hx())},[e]);const ke=async()=>{if(e){R(!0);try{if(y)b&&await rO(e.id,b),g(!1),k(null),t({fcmTokens:[]}),me("Push notifications disabled","info");else{if(!Qg()){me("Push notifications are not supported on this device","error");return}const C=await sO(e.id),T=hx();$(T),C?(g(!0),k(C),t({fcmTokens:[...e.fcmTokens||[],C]}),me("Push notifications enabled!","success")):me(T==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":T==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(C){console.error("Push toggle failed:",C),me("Something went wrong  please try again","error")}finally{R(!1)}}},xe=async C=>{if(!e)return;const T={...U,[C]:!U[C]};W(T);try{await ls(qe(ge,"clients",e.id),{notificationPrefs:T}),t({notificationPrefs:T})}catch(I){console.error("Failed to save pref:",I),W(P=>({...P,[C]:!P[C]})),me("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Qg()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${y?" on":""}${S?" loading":""}`,onClick:ke,disabled:S,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),iO.map(C=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:C.label}),a.jsx("span",{className:"settings-row-desc",children:C.desc})]}),a.jsx("button",{className:`settings-toggle${U[C.key]?" on":""}`,onClick:()=>xe(C.key),"aria-label":`Toggle ${C.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},C.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),G&&a.jsx("div",{className:`settings-toast ${G.type}`,children:G.message}),a.jsx(Yr,{active:"home"})]})}const bh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function pg({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function fx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,p=2*Math.PI*d,y=p*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:p,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const mx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function oO(s,e,t){const i=t instanceof Dt?t:Dt.fromDate(new Date(t)),l=Dt.now();switch(s.type){case"workouts":{const u=sn(ut(ge,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l));return(await Qt(u)).size}case"minutes":{const u=sn(ut(ge,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l));return(await Qt(u)).docs.reduce((p,y)=>p+(y.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),d=new Date().toISOString().slice(0,10),p=sn(ut(ge,"habitLogs"),wt("clientId","==",e));return(await Qt(p)).docs.filter(g=>{const b=g.data().date;if(b<u||b>d)return!1;const k=g.data().habits||{};return Object.values(k).length>0&&Object.values(k).every(S=>S===!0)}).length}case"streak":{const u=sn(ut(ge,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l)),d=await Qt(u),p=new Set(d.docs.map(k=>k.data().completedAt.toDate().toISOString().slice(0,10)));let y=0;const g=new Date(i.toDate()),b=new Date;for(;p.has(g.toISOString().slice(0,10))&&g<=b;)y++,g.setDate(g.getDate()+1);return y}default:return 0}}function lO(){const{currentUser:s,clientData:e,loading:t}=Mr(),{isDark:i,toggleTheme:l}=Li(),{isPremium:u}=oc(),d=Zs(),[p,y]=w.useState(null),[g,b]=w.useState(null),[k,S]=w.useState(0),[R,q]=w.useState(0),[$,U]=w.useState(!0),[W,G]=w.useState(!1),[Q,me]=w.useState(null),[ke,xe]=w.useState(null),[C,T]=w.useState(!1),[I,P]=w.useState(null),V=w.useCallback((Re,Z="info")=>{xe({message:Re,type:Z}),setTimeout(()=>xe(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const L=w.useCallback(async()=>{if(e){U(!0);try{const Re=sn(ut(ge,"userChallenges"),wt("clientId","==",e.id),wt("status","==","active")),Z=await Qt(Re);if(Z.empty)y(null),b(null);else{const Ee=Z.docs[0],Se={id:Ee.id,...Ee.data()},ye=bh.find(Ne=>Ne.id===Se.challengeId);if(Se.endDate.toDate()<new Date)await ls(qe(ge,"userChallenges",Ee.id),{status:"failed"}),y(null),b(null),V("Challenge expired  time ran out","error");else if(y(Se),b(ye),ye){const Ne=await oO(ye,e.id,Se.startDate);if(S(Ne),Ne>=ye.goal&&Se.status==="active"){if(await ls(qe(ge,"userChallenges",Ee.id),{status:"completed",completedAt:Ds()}),T(!0),y(Ve=>Ve?{...Ve,status:"completed"}:null),!Se.badgeAwarded){const Ve=ui.find(We=>We.id===ye.id);if(Ve)try{const We=qe(ge,"coreBuddyBadges",e.id),Ue=await vs(We),Ut=Ue.exists()?Ue.data().earned||[]:[];if(!Ut.some(St=>St.id===Ve.id)){const St={id:Ve.id,earnedAt:new Date().toISOString()};Ue.exists()?await ls(We,{earned:[...Ut,St]}):await Ss(We,{earned:[St]})}await ls(qe(ge,"userChallenges",Ee.id),{badgeAwarded:!0}),await vr(ut(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:Ve.name,badgeDesc:Ve.desc,badgeId:Ve.id},createdAt:Ds(),likeCount:0,commentCount:0}),P(Ve)}catch(We){console.error("Badge award failed:",We)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:ye.name,challenge_type:ye.type,duration_days:ye.duration})}}}const O=sn(ut(ge,"userChallenges"),wt("clientId","==",e.id),wt("status","==","completed")),se=await Qt(O);q(se.size)}catch(Re){console.error("Failed to load challenges:",Re)}finally{U(!1)}}},[e,V]);w.useEffect(()=>{L()},[L]);const A=async Re=>{if(!(!e||W)){G(!0);try{const Z=bh.find(ye=>ye.id===Re);if(!Z)return;const O=sn(ut(ge,"userChallenges"),wt("clientId","==",e.id),wt("status","==","active"));if(!(await Qt(O)).empty){me(null),V("You already have an active challenge","info"),await L();return}const Ee=Dt.now(),Se=Dt.fromDate(new Date(Date.now()+Z.duration*864e5));await vr(ut(ge,"userChallenges"),{clientId:e.id,challengeId:Re,startDate:Ee,endDate:Se,status:"active",completedAt:null,badgeAwarded:!1,createdAt:Ds()}),me(null),V(`${Z.name} started  let's go!`,"success"),await L()}catch(Z){console.error("Start challenge failed:",Z),Z?.code==="permission-denied"?V("Permission denied  please re-login and try again","error"):V("Something went wrong  try again","error")}finally{G(!1)}}},De=async()=>{if(!(!p||W)){G(!0);try{await ls(qe(ge,"userChallenges",p.id),{status:"failed"}),y(null),b(null),S(0),me(null),V("Challenge abandoned","info"),await L()}catch(Re){console.error("Give up failed:",Re),V("Something went wrong","error")}finally{G(!1)}}},tt=p?.endDate?Math.max(0,Math.ceil((p.endDate.toDate()-new Date)/864e5)):0,X=()=>{if(!g||!p)return"";const Re=Math.max(1,Math.ceil((Date.now()-p.startDate.toDate())/864e5)),Z=g.goal/g.duration*Re;return k>=Z*1.15?"Ahead":k>=Z*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Ce=p&&p.status==="active"&&g,Me=C||p&&p.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),$?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):Me?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(fx,{progress:g?.goal||1,goal:g?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:g?.name}),a.jsxs("p",{className:"ch-completed-count",children:[R+(C?1:0)," challenge",R!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{T(!1),y(null),b(null),L()},children:"Choose Next Challenge"})]}):Ce?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(fx,{progress:k,goal:g.goal,label:g.type==="minutes"?"minutes":g.type==="streak"?"day streak":g.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:tt}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${X().toLowerCase().replace(" ","")}`,children:X()})]}),a.jsx("h2",{className:"ch-active-name",children:g.name}),a.jsx("p",{className:"ch-active-desc",children:g.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>me("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:bh.filter(Re=>Re.id!==g.id).map(Re=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(pg,{icon:Re.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Re.name}),a.jsx("p",{children:Re.description})]})]},Re.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:bh.map(Re=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?me(Re):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(pg,{icon:Re.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Re.name}),a.jsx("p",{children:Re.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Re.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:mx[Re.difficulty]},children:Re.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Re.id))})]})]}),Q&&Q!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!W&&me(null),children:a.jsxs("div",{className:"ch-modal",onClick:Re=>Re.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(pg,{icon:Q.icon,size:36})}),a.jsx("h2",{children:Q.name}),a.jsx("p",{children:Q.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[Q.duration," days"]}),a.jsx("span",{style:{color:mx[Q.difficulty]},children:Q.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>A(Q.id),disabled:W,children:W?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>me(null),disabled:W,children:"Cancel"})]})}),Q==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!W&&me(null),children:a.jsxs("div",{className:"ch-modal",onClick:Re=>Re.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:De,disabled:W,children:W?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>me(null),disabled:W,children:"Keep Going"})]})}),a.jsx(ql,{badge:I,onDismiss:()=>P(null)}),ke&&a.jsx("div",{className:`ch-toast ch-toast-${ke.type}`,children:ke.message}),a.jsx(Yr,{})]})}const cO={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},uO=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function dO(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Li(),d=Zs(),[p,y]=w.useState(new Set),[g,b]=w.useState({}),[k,S]=w.useState(!0),[R,q]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{S(!0);try{const W=await vs(qe(ge,"coreBuddyBadges",t.id));if(W.exists()){const G=W.data().earned||[];y(new Set(G.map(me=>me.id)));const Q={};G.forEach(me=>{Q[me.id]=me}),b(Q)}}catch(W){console.error("Failed to load badges:",W)}finally{S(!1)}})()},[t]);const $=uO.map(W=>({key:W,label:cO[W],badges:ui.filter(G=>G.category===W)})).filter(W=>W.badges.length>0),U=ui.filter(W=>p.has(W.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[U," / ",ui.length," earned"]}),k?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):$.map(W=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:W.label}),a.jsx("div",{className:"bdg-grid",children:W.badges.map(G=>{const Q=p.has(G.id);return a.jsxs("button",{className:`bdg-item${Q?" earned":" locked"}`,onClick:()=>q(G),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[G.img?a.jsx("img",{src:G.img,alt:G.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!Q&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:G.name})]},G.id)})})]},W.key))]}),R&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>q(null),children:a.jsxs("div",{className:"bdg-modal",onClick:W=>W.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${p.has(R.id)?" earned":" locked"}`,children:R.img?a.jsx("img",{src:R.img,alt:R.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:R.name}),a.jsx("p",{className:"bdg-modal-desc",children:R.desc}),p.has(R.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",g[R.id]?.earnedAt?`  ${new Date(g[R.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>q(null),children:"Close"})]})}),a.jsx(Yr,{active:"badges"})]})}const hO=w.lazy(()=>Js(()=>import("./Dashboard-C4kNE1i_.js"),__vite__mapDeps([0,1,2]))),fO=w.lazy(()=>Js(()=>import("./AddClient-kPI2o4xJ.js"),__vite__mapDeps([3,4]))),mO=w.lazy(()=>Js(()=>import("./ClientDashboard-XSHX89hS.js"),__vite__mapDeps([5,1,6]))),pO=w.lazy(()=>Js(()=>import("./ClientForms-CMyQaite.js"),__vite__mapDeps([7,8,6]))),gO=w.lazy(()=>Js(()=>import("./ClientTools-CMrFWjiU.js"),__vite__mapDeps([9,10,6]))),yO=w.lazy(()=>Js(()=>import("./MacroCalculator-BBzs14tx.js"),__vite__mapDeps([11,10,6]))),vO=w.lazy(()=>Js(()=>import("./ProteinSnacks-By9MieVQ.js"),__vite__mapDeps([12,10,6]))),bO=w.lazy(()=>Js(()=>import("./DailyMotivation-BqwN8IIl.js"),__vite__mapDeps([13,10,6]))),wO=w.lazy(()=>Js(()=>import("./CircuitDashboard-DcFyQqQH.js"),__vite__mapDeps([14,15]))),xO=w.lazy(()=>Js(()=>import("./CircuitBooking-Dj59WD9o.js"),__vite__mapDeps([16,17,15]))),_O=w.lazy(()=>Js(()=>import("./PersonalBests-BLX9ctUC.js"),__vite__mapDeps([18,19,6]))),kO=w.lazy(()=>Js(()=>import("./Leaderboard-Bs_IgDkb.js"),__vite__mapDeps([20,21]))),EO=w.lazy(()=>Js(()=>import("./UpgradePage-CtnYn_Qi.js"),__vite__mapDeps([22,23,24]))),TO=w.lazy(()=>Js(()=>import("./SignUp-CieIJHDL.js"),[])),jO=w.lazy(()=>Js(()=>import("./Onboarding-C-oHrvV-.js"),__vite__mapDeps([25,23,26])));function SO({children:s}){const{pathname:e}=Di();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function CO(){const s=Zs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function NO(){return a.jsx(JD,{children:a.jsx(XD,{children:a.jsx(s3,{children:a.jsxs(oC,{basename:"/login",children:[a.jsx(CO,{}),a.jsx(SO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(OS,{children:[a.jsx(En,{path:"/",element:a.jsx(a3,{})}),a.jsx(En,{path:"/dashboard",element:a.jsx(hO,{})}),a.jsx(En,{path:"/add-client",element:a.jsx(fO,{})}),a.jsx(En,{path:"/client",element:a.jsx(mO,{})}),a.jsx(En,{path:"/client/forms",element:a.jsx(pO,{})}),a.jsx(En,{path:"/client/tools",element:a.jsx(gO,{})}),a.jsx(En,{path:"/client/tools/macros",element:a.jsx(yO,{})}),a.jsx(En,{path:"/client/tools/snacks",element:a.jsx(vO,{})}),a.jsx(En,{path:"/client/tools/motivation",element:a.jsx(bO,{})}),a.jsx(En,{path:"/client/personal-bests",element:a.jsx(_O,{})}),a.jsx(En,{path:"/client/circuit",element:a.jsx(wO,{})}),a.jsx(En,{path:"/client/circuit/booking",element:a.jsx(xO,{})}),a.jsx(En,{path:"/client/core-buddy",element:a.jsx(N3,{})}),a.jsx(En,{path:"/client/core-buddy/nutrition",element:a.jsx(mh,{feature:"nutrition",children:a.jsx(I3,{})})}),a.jsx(En,{path:"/client/core-buddy/workouts",element:a.jsx(m5,{})}),a.jsx(En,{path:"/client/core-buddy/consistency",element:a.jsx(mh,{feature:"consistency",children:a.jsx(_5,{})})}),a.jsx(En,{path:"/client/core-buddy/buddies",element:a.jsx(mh,{feature:"buddies",children:a.jsx(k5,{})})}),a.jsx(En,{path:"/client/core-buddy/builder",element:a.jsx(S5,{})}),a.jsx(En,{path:"/client/core-buddy/profile/:userId",element:a.jsx(T5,{})}),a.jsx(En,{path:"/client/core-buddy/settings",element:a.jsx(aO,{})}),a.jsx(En,{path:"/client/core-buddy/challenges",element:a.jsx(lO,{})}),a.jsx(En,{path:"/client/core-buddy/badges",element:a.jsx(dO,{})}),a.jsx(En,{path:"/client/leaderboard",element:a.jsx(mh,{feature:"leaderboard",children:a.jsx(kO,{})})}),a.jsx(En,{path:"/signup",element:a.jsx(TO,{})}),a.jsx(En,{path:"/onboarding",element:a.jsx(jO,{})}),a.jsx(En,{path:"/upgrade",element:a.jsx(EO,{})}),a.jsx(En,{path:"*",element:a.jsx(Cx,{to:"/",replace:!0})})]})})})]})})})})}Oj.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(NO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{r3 as A,ql as B,Yr as C,RO as D,Ds as E,Zo as P,Dt as T,vr as a,Ar as b,ut as c,ge as d,qe as e,QA as f,Qt as g,t4 as h,Ss as i,a as j,vs as k,Mr as l,Li as m,Zs as n,Eu as o,jE as p,sn as q,w as r,MO as s,AO as t,ls as u,DO as v,wt as w,ef as x,oc as y,i3 as z};
