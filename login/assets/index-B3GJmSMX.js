const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DzW0p7q1.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-DorY_zjf.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-BkzWmzsx.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-DfeEbLk8.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-e-okHNY2.js","assets/ProteinSnacks-BWA5ftvg.js","assets/DailyMotivation-CMWMSNfE.js","assets/CircuitDashboard-UEMl62iF.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-DdvLj3N_.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-UplGlmvd.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-D0wfExQz.js","assets/stripe-DEqyGTPW.js","assets/UpgradePage-BB1WAf13.css","assets/Onboarding-CPQXn9V6.js","assets/Onboarding--fcHmo9q.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var jy={exports:{}},gh={};var uw;function UA(){if(uw)return gh;uw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,o,c){var u=null;if(c!==void 0&&(u=""+c),o.key!==void 0&&(u=""+o.key),"key"in o){c={};for(var d in o)d!=="key"&&(c[d]=o[d])}else c=o;return o=c.ref,{$$typeof:n,type:s,key:u,ref:o!==void 0?o:null,props:c}}return gh.Fragment=e,gh.jsx=t,gh.jsxs=t,gh}var hw;function FA(){return hw||(hw=1,jy.exports=UA()),jy.exports}var a=FA(),Ny={exports:{}},Yt={};var dw;function zA(){if(dw)return Yt;dw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),T=Symbol.iterator;function N(O){return O===null||typeof O!="object"?null:(O=T&&O[T]||O["@@iterator"],typeof O=="function"?O:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,D={};function X(O,K,we){this.props=O,this.context=K,this.refs=D,this.updater=we||B}X.prototype.isReactComponent={},X.prototype.setState=function(O,K){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,K,"setState")},X.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function H(){}H.prototype=X.prototype;function J(O,K,we){this.props=O,this.context=K,this.refs=D,this.updater=we||B}var he=J.prototype=new H;he.constructor=J,M(he,X.prototype),he.isPureReactComponent=!0;var Ne=Array.isArray;function Te(){}var C={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function P(O,K,we){var Ae=we.ref;return{$$typeof:n,type:O,key:K,ref:Ae!==void 0?Ae:null,props:we}}function U(O,K){return P(O.type,K,O.props)}function V(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function q(O){var K={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(we){return K[we]})}var L=/\/+/g;function We(O,K){return typeof O=="object"&&O!==null&&O.key!=null?q(""+O.key):K.toString(36)}function wt(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(Te,Te):(O.status="pending",O.then(function(K){O.status==="pending"&&(O.status="fulfilled",O.value=K)},function(K){O.status==="pending"&&(O.status="rejected",O.reason=K)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function $(O,K,we,Ae,Ge){var Pe=typeof O;(Pe==="undefined"||Pe==="boolean")&&(O=null);var ct=!1;if(O===null)ct=!0;else switch(Pe){case"bigint":case"string":case"number":ct=!0;break;case"object":switch(O.$$typeof){case n:case e:ct=!0;break;case b:return ct=O._init,$(ct(O._payload),K,we,Ae,Ge)}}if(ct)return Ge=Ge(O),ct=Ae===""?"."+We(O,0):Ae,Ne(Ge)?(we="",ct!=null&&(we=ct.replace(L,"$&/")+"/"),$(Ge,K,we,"",function(Ft){return Ft})):Ge!=null&&(V(Ge)&&(Ge=U(Ge,we+(Ge.key==null||O&&O.key===Ge.key?"":(""+Ge.key).replace(L,"$&/")+"/")+ct)),K.push(Ge)),1;ct=0;var gt=Ae===""?".":Ae+":";if(Ne(O))for(var nt=0;nt<O.length;nt++)Ae=O[nt],Pe=gt+We(Ae,nt),ct+=$(Ae,K,we,Pe,Ge);else if(nt=N(O),typeof nt=="function")for(O=nt.call(O),nt=0;!(Ae=O.next()).done;)Ae=Ae.value,Pe=gt+We(Ae,nt++),ct+=$(Ae,K,we,Pe,Ge);else if(Pe==="object"){if(typeof O.then=="function")return $(wt(O),K,we,Ae,Ge);throw K=String(O),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return ct}function ye(O,K,we){if(O==null)return O;var Ae=[],Ge=0;return $(O,Ae,"","",function(Pe){return K.call(we,Pe,Ge++)}),Ae}function Le(O){if(O._status===-1){var K=O._result;K=K(),K.then(function(we){(O._status===0||O._status===-1)&&(O._status=1,O._result=we)},function(we){(O._status===0||O._status===-1)&&(O._status=2,O._result=we)}),O._status===-1&&(O._status=0,O._result=K)}if(O._status===1)return O._result.default;throw O._result}var Ke=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},te={map:ye,forEach:function(O,K,we){ye(O,function(){K.apply(this,arguments)},we)},count:function(O){var K=0;return ye(O,function(){K++}),K},toArray:function(O){return ye(O,function(K){return K})||[]},only:function(O){if(!V(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Yt.Activity=x,Yt.Children=te,Yt.Component=X,Yt.Fragment=t,Yt.Profiler=o,Yt.PureComponent=J,Yt.StrictMode=s,Yt.Suspense=p,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},Yt.cache=function(O){return function(){return O.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(O,K,we){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Ae=M({},O.props),Ge=O.key;if(K!=null)for(Pe in K.key!==void 0&&(Ge=""+K.key),K)!S.call(K,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&K.ref===void 0||(Ae[Pe]=K[Pe]);var Pe=arguments.length-2;if(Pe===1)Ae.children=we;else if(1<Pe){for(var ct=Array(Pe),gt=0;gt<Pe;gt++)ct[gt]=arguments[gt+2];Ae.children=ct}return P(O.type,Ge,Ae)},Yt.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:c,_context:O},O},Yt.createElement=function(O,K,we){var Ae,Ge={},Pe=null;if(K!=null)for(Ae in K.key!==void 0&&(Pe=""+K.key),K)S.call(K,Ae)&&Ae!=="key"&&Ae!=="__self"&&Ae!=="__source"&&(Ge[Ae]=K[Ae]);var ct=arguments.length-2;if(ct===1)Ge.children=we;else if(1<ct){for(var gt=Array(ct),nt=0;nt<ct;nt++)gt[nt]=arguments[nt+2];Ge.children=gt}if(O&&O.defaultProps)for(Ae in ct=O.defaultProps,ct)Ge[Ae]===void 0&&(Ge[Ae]=ct[Ae]);return P(O,Pe,Ge)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(O){return{$$typeof:d,render:O}},Yt.isValidElement=V,Yt.lazy=function(O){return{$$typeof:b,_payload:{_status:-1,_result:O},_init:Le}},Yt.memo=function(O,K){return{$$typeof:g,type:O,compare:K===void 0?null:K}},Yt.startTransition=function(O){var K=C.T,we={};C.T=we;try{var Ae=O(),Ge=C.S;Ge!==null&&Ge(we,Ae),typeof Ae=="object"&&Ae!==null&&typeof Ae.then=="function"&&Ae.then(Te,Ke)}catch(Pe){Ke(Pe)}finally{K!==null&&we.types!==null&&(K.types=we.types),C.T=K}},Yt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Yt.use=function(O){return C.H.use(O)},Yt.useActionState=function(O,K,we){return C.H.useActionState(O,K,we)},Yt.useCallback=function(O,K){return C.H.useCallback(O,K)},Yt.useContext=function(O){return C.H.useContext(O)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(O,K){return C.H.useDeferredValue(O,K)},Yt.useEffect=function(O,K){return C.H.useEffect(O,K)},Yt.useEffectEvent=function(O){return C.H.useEffectEvent(O)},Yt.useId=function(){return C.H.useId()},Yt.useImperativeHandle=function(O,K,we){return C.H.useImperativeHandle(O,K,we)},Yt.useInsertionEffect=function(O,K){return C.H.useInsertionEffect(O,K)},Yt.useLayoutEffect=function(O,K){return C.H.useLayoutEffect(O,K)},Yt.useMemo=function(O,K){return C.H.useMemo(O,K)},Yt.useOptimistic=function(O,K){return C.H.useOptimistic(O,K)},Yt.useReducer=function(O,K,we){return C.H.useReducer(O,K,we)},Yt.useRef=function(O){return C.H.useRef(O)},Yt.useState=function(O){return C.H.useState(O)},Yt.useSyncExternalStore=function(O,K,we){return C.H.useSyncExternalStore(O,K,we)},Yt.useTransition=function(){return C.H.useTransition()},Yt.version="19.2.4",Yt}var fw;function sv(){return fw||(fw=1,Ny.exports=zA()),Ny.exports}var _=sv(),Ay={exports:{}},yh={},Ry={exports:{}},Cy={};var mw;function qA(){return mw||(mw=1,(function(n){function e($,ye){var Le=$.length;$.push(ye);e:for(;0<Le;){var Ke=Le-1>>>1,te=$[Ke];if(0<o(te,ye))$[Ke]=ye,$[Le]=te,Le=Ke;else break e}}function t($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var ye=$[0],Le=$.pop();if(Le!==ye){$[0]=Le;e:for(var Ke=0,te=$.length,O=te>>>1;Ke<O;){var K=2*(Ke+1)-1,we=$[K],Ae=K+1,Ge=$[Ae];if(0>o(we,Le))Ae<te&&0>o(Ge,we)?($[Ke]=Ge,$[Ae]=Le,Ke=Ae):($[Ke]=we,$[K]=Le,Ke=K);else if(Ae<te&&0>o(Ge,Le))$[Ke]=Ge,$[Ae]=Le,Ke=Ae;else break e}}return ye}function o($,ye){var Le=$.sortIndex-ye.sortIndex;return Le!==0?Le:$.id-ye.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var p=[],g=[],b=1,x=null,T=3,N=!1,B=!1,M=!1,D=!1,X=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;function he($){for(var ye=t(g);ye!==null;){if(ye.callback===null)s(g);else if(ye.startTime<=$)s(g),ye.sortIndex=ye.expirationTime,e(p,ye);else break;ye=t(g)}}function Ne($){if(M=!1,he($),!B)if(t(p)!==null)B=!0,Te||(Te=!0,q());else{var ye=t(g);ye!==null&&wt(Ne,ye.startTime-$)}}var Te=!1,C=-1,S=5,P=-1;function U(){return D?!0:!(n.unstable_now()-P<S)}function V(){if(D=!1,Te){var $=n.unstable_now();P=$;var ye=!0;try{e:{B=!1,M&&(M=!1,H(C),C=-1),N=!0;var Le=T;try{t:{for(he($),x=t(p);x!==null&&!(x.expirationTime>$&&U());){var Ke=x.callback;if(typeof Ke=="function"){x.callback=null,T=x.priorityLevel;var te=Ke(x.expirationTime<=$);if($=n.unstable_now(),typeof te=="function"){x.callback=te,he($),ye=!0;break t}x===t(p)&&s(p),he($)}else s(p);x=t(p)}if(x!==null)ye=!0;else{var O=t(g);O!==null&&wt(Ne,O.startTime-$),ye=!1}}break e}finally{x=null,T=Le,N=!1}ye=void 0}}finally{ye?q():Te=!1}}}var q;if(typeof J=="function")q=function(){J(V)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,We=L.port2;L.port1.onmessage=V,q=function(){We.postMessage(null)}}else q=function(){X(V,0)};function wt($,ye){C=X(function(){$(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function($){switch(T){case 1:case 2:case 3:var ye=3;break;default:ye=T}var Le=T;T=ye;try{return $()}finally{T=Le}},n.unstable_requestPaint=function(){D=!0},n.unstable_runWithPriority=function($,ye){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Le=T;T=$;try{return ye()}finally{T=Le}},n.unstable_scheduleCallback=function($,ye,Le){var Ke=n.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?Ke+Le:Ke):Le=Ke,$){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=Le+te,$={id:b++,callback:ye,priorityLevel:$,startTime:Le,expirationTime:te,sortIndex:-1},Le>Ke?($.sortIndex=Le,e(g,$),t(p)===null&&$===t(g)&&(M?(H(C),C=-1):M=!0,wt(Ne,Le-Ke))):($.sortIndex=te,e(p,$),B||N||(B=!0,Te||(Te=!0,q()))),$},n.unstable_shouldYield=U,n.unstable_wrapCallback=function($){var ye=T;return function(){var Le=T;T=ye;try{return $.apply(this,arguments)}finally{T=Le}}}})(Cy)),Cy}var pw;function HA(){return pw||(pw=1,Ry.exports=qA()),Ry.exports}var Iy={exports:{}},br={};var gw;function $A(){if(gw)return br;gw=1;var n=sv();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:p,containerInfo:g,implementation:b}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return br.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,br.createPortal=function(p,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,b)},br.flushSync=function(p){var g=u.T,b=s.p;try{if(u.T=null,s.p=2,p)return p()}finally{u.T=g,s.p=b,s.d.f()}},br.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,s.d.C(p,g))},br.prefetchDNS=function(p){typeof p=="string"&&s.d.D(p)},br.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var b=g.as,x=d(b,g.crossOrigin),T=typeof g.integrity=="string"?g.integrity:void 0,N=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?s.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:T,fetchPriority:N}):b==="script"&&s.d.X(p,{crossOrigin:x,integrity:T,fetchPriority:N,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},br.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=d(g.as,g.crossOrigin);s.d.M(p,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&s.d.M(p)},br.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,x=d(b,g.crossOrigin);s.d.L(p,b,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},br.preloadModule=function(p,g){if(typeof p=="string")if(g){var b=d(g.as,g.crossOrigin);s.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else s.d.m(p)},br.requestFormReset=function(p){s.d.r(p)},br.unstable_batchedUpdates=function(p,g){return p(g)},br.useFormState=function(p,g,b){return u.H.useFormState(p,g,b)},br.useFormStatus=function(){return u.H.useHostTransitionStatus()},br.version="19.2.4",br}var yw;function WA(){if(yw)return Iy.exports;yw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Iy.exports=$A(),Iy.exports}var bw;function GA(){if(bw)return yh;bw=1;var n=HA(),e=sv(),t=WA();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var i=r,l=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(l=i.return),r=i.return;while(r)}return i.tag===3?l:null}function u(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function p(r){if(c(r)!==r)throw Error(s(188))}function g(r){var i=r.alternate;if(!i){if(i=c(r),i===null)throw Error(s(188));return i!==r?null:r}for(var l=r,h=i;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){l=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return p(m),r;if(y===h)return p(m),i;y=y.sibling}throw Error(s(188))}if(l.return!==h.return)l=m,h=y;else{for(var w=!1,j=m.child;j;){if(j===l){w=!0,l=m,h=y;break}if(j===h){w=!0,h=m,l=y;break}j=j.sibling}if(!w){for(j=y.child;j;){if(j===l){w=!0,l=y,h=m;break}if(j===h){w=!0,h=y,l=m;break}j=j.sibling}if(!w)throw Error(s(189))}}if(l.alternate!==h)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?r:i}function b(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=b(r),i!==null)return i;r=r.sibling}return null}var x=Object.assign,T=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),J=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function q(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var L=Symbol.for("react.client.reference");function We(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===L?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case M:return"Fragment";case X:return"Profiler";case D:return"StrictMode";case Ne:return"Suspense";case Te:return"SuspenseList";case P:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case B:return"Portal";case J:return r.displayName||"Context";case H:return(r._context.displayName||"Context")+".Consumer";case he:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case C:return i=r.displayName||null,i!==null?i:We(r.type)||"Memo";case S:i=r._payload,r=r._init;try{return We(r(i))}catch{}}return null}var wt=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},Ke=[],te=-1;function O(r){return{current:r}}function K(r){0>te||(r.current=Ke[te],Ke[te]=null,te--)}function we(r,i){te++,Ke[te]=r.current,r.current=i}var Ae=O(null),Ge=O(null),Pe=O(null),ct=O(null);function gt(r,i){switch(we(Pe,i),we(Ge,r),we(Ae,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?D_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=D_(i),r=P_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}K(Ae),we(Ae,r)}function nt(){K(Ae),K(Ge),K(Pe)}function Ft(r){r.memoizedState!==null&&we(ct,r);var i=Ae.current,l=P_(i,r.type);i!==l&&(we(Ge,r),we(Ae,l))}function Pn(r){Ge.current===r&&(K(Ae),K(Ge)),ct.current===r&&(K(ct),dh._currentValue=Le)}var Lt,Et;function me(r){if(Lt===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Lt=i&&i[1]||"",Et=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Lt+r+Et}var sn=!1;function rn(r,i){if(!r||sn)return"";sn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(ge){var ue=ge}Reflect.construct(r,[],Ie)}else{try{Ie.call()}catch(ge){ue=ge}r.call(Ie.prototype)}}else{try{throw Error()}catch(ge){ue=ge}(Ie=r())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(ge){if(ge&&ue&&typeof ge.stack=="string")return[ge.stack,ue.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),w=y[0],j=y[1];if(w&&j){var F=w.split(`
`),le=j.split(`
`);for(m=h=0;h<F.length&&!F[h].includes("DetermineComponentFrameRoot");)h++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(h===F.length||m===le.length)for(h=F.length-1,m=le.length-1;1<=h&&0<=m&&F[h]!==le[m];)m--;for(;1<=h&&0<=m;h--,m--)if(F[h]!==le[m]){if(h!==1||m!==1)do if(h--,m--,0>m||F[h]!==le[m]){var je=`
`+F[h].replace(" at new "," at ");return r.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",r.displayName)),je}while(1<=h&&0<=m);break}}}finally{sn=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?me(l):""}function yt(r,i){switch(r.tag){case 26:case 27:case 5:return me(r.type);case 16:return me("Lazy");case 13:return r.child!==i&&i!==null?me("Suspense Fallback"):me("Suspense");case 19:return me("SuspenseList");case 0:case 15:return rn(r.type,!1);case 11:return rn(r.type.render,!1);case 1:return rn(r.type,!0);case 31:return me("Activity");default:return""}}function At(r){try{var i="",l=null;do i+=yt(r,l),l=r,r=r.return;while(r);return i}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var dt=Object.prototype.hasOwnProperty,it=n.unstable_scheduleCallback,an=n.unstable_cancelCallback,Ts=n.unstable_shouldYield,Rt=n.unstable_requestPaint,ln=n.unstable_now,ns=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,Wt=n.unstable_UserBlockingPriority,cn=n.unstable_NormalPriority,vn=n.unstable_LowPriority,be=n.unstable_IdlePriority,De=n.log,Be=n.unstable_setDisableYieldValue,et=null,Ue=null;function Me(r){if(typeof De=="function"&&Be(r),Ue&&typeof Ue.setStrictMode=="function")try{Ue.setStrictMode(et,r)}catch{}}var ze=Math.clz32?Math.clz32:Vt,St=Math.log,bt=Math.LN2;function Vt(r){return r>>>=0,r===0?32:31-(St(r)/bt|0)|0}var Ht=256,ee=262144,ve=4194304;function lt(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ct(r,i,l){var h=r.pendingLanes;if(h===0)return 0;var m=0,y=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var j=h&134217727;return j!==0?(h=j&~y,h!==0?m=lt(h):(w&=j,w!==0?m=lt(w):l||(l=j&~r,l!==0&&(m=lt(l))))):(j=h&~y,j!==0?m=lt(j):w!==0?m=lt(w):l||(l=h&~r,l!==0&&(m=lt(l)))),m===0?0:i!==0&&i!==m&&(i&y)===0&&(y=m&-m,l=i&-i,y>=l||y===32&&(l&4194048)!==0)?i:m}function It(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function Xt(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jt(){var r=ve;return ve<<=1,(ve&62914560)===0&&(ve=4194304),r}function zt(r){for(var i=[],l=0;31>l;l++)i.push(r);return i}function Fn(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function os(r,i,l,h,m,y){var w=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var j=r.entanglements,F=r.expirationTimes,le=r.hiddenUpdates;for(l=w&~l;0<l;){var je=31-ze(l),Ie=1<<je;j[je]=0,F[je]=-1;var ue=le[je];if(ue!==null)for(le[je]=null,je=0;je<ue.length;je++){var ge=ue[je];ge!==null&&(ge.lane&=-536870913)}l&=~Ie}h!==0&&pn(r,h,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(w&~i))}function pn(r,i,l){r.pendingLanes|=i,r.suspendedLanes&=~i;var h=31-ze(i);r.entangledLanes|=i,r.entanglements[h]=r.entanglements[h]|1073741824|l&261930}function In(r,i){var l=r.entangledLanes|=i;for(r=r.entanglements;l;){var h=31-ze(l),m=1<<h;m&i|r[h]&i&&(r[h]|=i),l&=~m}}function On(r,i){var l=i&-i;return l=(l&42)!==0?1:z(l),(l&(r.suspendedLanes|i))!==0?0:l}function z(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function xe(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ke(){var r=ye.p;return r!==0?r:(r=window.event,r===void 0?32:sw(r.type))}function Se(r,i){var l=ye.p;try{return ye.p=r,i()}finally{ye.p=l}}var pe=Math.random().toString(36).slice(2),rt="__reactFiber$"+pe,Dt="__reactProps$"+pe,ut="__reactContainer$"+pe,jt="__reactEvents$"+pe,kt="__reactListeners$"+pe,un="__reactHandles$"+pe,yr="__reactResources$"+pe,Gs="__reactMarker$"+pe;function Zs(r){delete r[rt],delete r[Dt],delete r[jt],delete r[kt],delete r[un]}function Xn(r){var i=r[rt];if(i)return i;for(var l=r.parentNode;l;){if(i=l[ut]||l[rt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(r=F_(r);r!==null;){if(l=r[rt])return l;r=F_(r)}return i}r=l,l=r.parentNode}return null}function W(r){if(r=r[rt]||r[ut]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function de(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function k(r){var i=r[yr];return i||(i=r[yr]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function A(r){r[Gs]=!0}var Q=new Set,ae={};function Ye(r,i){$e(r,i),$e(r+"Capture",i)}function $e(r,i){for(ae[r]=i,r=0;r<i.length;r++)Q.add(i[r])}var qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ut={},Mt={};function Hn(r){return dt.call(Mt,r)?!0:dt.call(Ut,r)?!1:qe.test(r)?Mt[r]=!0:(Ut[r]=!0,!1)}function er(r,i,l){if(Hn(i))if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+l)}}function Vs(r,i,l){if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+l)}}function zn(r,i,l,h){if(h===null)r.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(i,l,""+h)}}function qn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Y(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ee(r,i,l){var h=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var m=h.get,y=h.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return m.call(this)},set:function(w){l=""+w,y.call(this,w)}}),Object.defineProperty(r,i,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function re(r){if(!r._valueTracker){var i=Y(r)?"checked":"value";r._valueTracker=Ee(r,i,""+r[i])}}function Fe(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var l=i.getValue(),h="";return r&&(h=Y(r)?r.checked?"true":"false":r.value),r=h,r!==l?(i.setValue(r),!0):!1}function He(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ht=/[\n"\\]/g;function vt(r){return r.replace(ht,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Gt(r,i,l,h,m,y,w,j){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),i!=null?w==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+qn(i)):r.value!==""+qn(i)&&(r.value=""+qn(i)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),i!=null?Cs(r,w,qn(i)):l!=null?Cs(r,w,qn(l)):h!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?r.name=""+qn(j):r.removeAttribute("name")}function Sn(r,i,l,h,m,y,w,j){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){re(r);return}l=l!=null?""+qn(l):"",i=i!=null?""+qn(i):l,j||i===r.value||(r.value=i),r.defaultValue=i}h=h??m,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=j?r.checked:!!h,r.defaultChecked=!!h,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w),re(r)}function Cs(r,i,l){i==="number"&&He(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function hn(r,i,l,h){if(r=r.options,i){i={};for(var m=0;m<l.length;m++)i["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=i.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&h&&(r[l].defaultSelected=!0)}else{for(l=""+qn(l),i=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,h&&(r[m].defaultSelected=!0);return}i!==null||r[m].disabled||(i=r[m])}i!==null&&(i.selected=!0)}}function tr(r,i,l){if(i!=null&&(i=""+qn(i),i!==r.value&&(r.value=i),l==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=l!=null?""+qn(l):""}function Os(r,i,l,h){if(i==null){if(h!=null){if(l!=null)throw Error(s(92));if(wt(h)){if(1<h.length)throw Error(s(93));h=h[0]}l=h}l==null&&(l=""),i=l}l=qn(i),r.defaultValue=l,h=r.textContent,h===l&&h!==""&&h!==null&&(r.value=h),re(r)}function Es(r,i){if(i){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=i;return}}r.textContent=i}var aa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _i(r,i,l){var h=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":h?r.setProperty(i,l):typeof l!="number"||l===0||aa.has(i)?i==="float"?r.cssFloat=l:r[i]=(""+l).trim():r[i]=l+"px"}function xn(r,i,l){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var m in i)h=i[m],i.hasOwnProperty(m)&&l[m]!==h&&_i(r,m,h)}else for(var y in i)i.hasOwnProperty(y)&&_i(r,y,i[y])}function _s(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ks=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ir(r){return Ks.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ls(){}var lr=null;function Bs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var qr=null,Dr=null;function Hr(r){var i=W(r);if(i&&(r=i.stateNode)){var l=r[Dt]||null;e:switch(r=i.stateNode,i.type){case"input":if(Gt(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+vt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var h=l[i];if(h!==r&&h.form===r.form){var m=h[Dt]||null;if(!m)throw Error(s(90));Gt(h,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<l.length;i++)h=l[i],h.form===r.form&&Fe(h)}break e;case"textarea":tr(r,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&hn(r,!!l.multiple,i,!1)}}}var I=!1;function ne(r,i,l){if(I)return r(i,l);I=!0;try{var h=r(i);return h}finally{if(I=!1,(qr!==null||Dr!==null)&&(xf(),qr&&(i=qr,r=Dr,Dr=qr=null,Hr(i),r)))for(i=0;i<r.length;i++)Hr(r[i])}}function Ve(r,i){var l=r.stateNode;if(l===null)return null;var h=l[Dt]||null;if(h===null)return null;l=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(s(231,i,typeof l));return l}var tt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_t=!1;if(tt)try{var at={};Object.defineProperty(at,"passive",{get:function(){_t=!0}}),window.addEventListener("test",at,at),window.removeEventListener("test",at,at)}catch{_t=!1}var st=null,Kt=null,$t=null;function _n(){if($t)return $t;var r,i=Kt,l=i.length,h,m="value"in st?st.value:st.textContent,y=m.length;for(r=0;r<l&&i[r]===m[r];r++);var w=l-r;for(h=1;h<=w&&i[l-h]===m[y-h];h++);return $t=m.slice(r,1<h?1-h:void 0)}function jn(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function en(){return!0}function ms(){return!1}function dn(r){function i(l,h,m,y,w){this._reactName=l,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(l=r[j],this[j]=l?l(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?en:ms,this.isPropagationStopped=ms,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=en)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=en)},persist:function(){},isPersistent:en}),i}var $n={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ss=dn($n),rs=x({},$n,{view:0,detail:0}),Qs=dn(rs),cr,Er,ks,ai=x({},rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wa,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ks&&(ks&&r.type==="mousemove"?(cr=r.screenX-ks.screenX,Er=r.screenY-ks.screenY):Er=cr=0,ks=r),cr)},movementY:function(r){return"movementY"in r?r.movementY:Er}}),Oi=dn(ai),Us=x({},ai,{dataTransfer:0}),kr=dn(Us),oi=x({},rs,{relatedTarget:0}),Pr=dn(oi),Ha=x({},$n,{animationName:0,elapsedTime:0,pseudoElement:0}),ec=dn(Ha),$a=x({},$n,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),oa=dn($a),wi=x({},$n,{data:0}),ur=dn(wi),Id={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Md(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Pd[r])?!!i[r]:!1}function Wa(){return Md}var Sr=x({},rs,{key:function(r){if(r.key){var i=Id[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=jn(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Dd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wa,charCode:function(r){return r.type==="keypress"?jn(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?jn(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ld=dn(Sr),Vd=x({},ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),la=dn(Vd),f=x({},rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wa}),v=dn(f),E=x({},$n,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=dn(E),ie=x({},ai,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=dn(ie),Xe=x({},$n,{newState:0,oldState:0}),tn=dn(Xe),Is=[9,13,27,32],Bn=tt&&"CompositionEvent"in window,ps=null;tt&&"documentMode"in document&&(ps=document.documentMode);var li=tt&&"TextEvent"in window&&!ps,Bi=tt&&(!Bn||ps&&8<ps&&11>=ps),Ti=" ",Ei=!1;function Zo(r,i){switch(r){case"keyup":return Is.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var nc=!1;function uN(r,i){switch(r){case"compositionend":return tc(i);case"keypress":return i.which!==32?null:(Ei=!0,Ti);case"textInput":return r=i.data,r===Ti&&Ei?null:r;default:return null}}function hN(r,i){if(nc)return r==="compositionend"||!Bn&&Zo(r,i)?(r=_n(),$t=Kt=st=null,nc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Bi&&i.locale!=="ko"?null:i.data;default:return null}}var dN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H0(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!dN[r.type]:i==="textarea"}function $0(r,i,l,h){qr?Dr?Dr.push(h):Dr=[h]:qr=h,i=jf(i,"onChange"),0<i.length&&(l=new ss("onChange","change",null,l,h),r.push({event:l,listeners:i}))}var Pu=null,Mu=null;function fN(r){j_(r,0)}function Od(r){var i=de(r);if(Fe(i))return r}function W0(r,i){if(r==="change")return i}var G0=!1;if(tt){var Pp;if(tt){var Mp="oninput"in document;if(!Mp){var K0=document.createElement("div");K0.setAttribute("oninput","return;"),Mp=typeof K0.oninput=="function"}Pp=Mp}else Pp=!1;G0=Pp&&(!document.documentMode||9<document.documentMode)}function Q0(){Pu&&(Pu.detachEvent("onpropertychange",Y0),Mu=Pu=null)}function Y0(r){if(r.propertyName==="value"&&Od(Mu)){var i=[];$0(i,Mu,r,Bs(r)),ne(fN,i)}}function mN(r,i,l){r==="focusin"?(Q0(),Pu=i,Mu=l,Pu.attachEvent("onpropertychange",Y0)):r==="focusout"&&Q0()}function pN(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Od(Mu)}function gN(r,i){if(r==="click")return Od(i)}function yN(r,i){if(r==="input"||r==="change")return Od(i)}function bN(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var $r=typeof Object.is=="function"?Object.is:bN;function Lu(r,i){if($r(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var l=Object.keys(r),h=Object.keys(i);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var m=l[h];if(!dt.call(i,m)||!$r(r[m],i[m]))return!1}return!0}function X0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function J0(r,i){var l=X0(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=i&&h>=i)return{node:l,offset:i-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=X0(l)}}function Z0(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Z0(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function e1(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=He(r.document);i instanceof r.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)r=i.contentWindow;else break;i=He(r.document)}return i}function Lp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var vN=tt&&"documentMode"in document&&11>=document.documentMode,sc=null,Vp=null,Vu=null,Op=!1;function t1(r,i,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Op||sc==null||sc!==He(h)||(h=sc,"selectionStart"in h&&Lp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Vu&&Lu(Vu,h)||(Vu=h,h=jf(Vp,"onSelect"),0<h.length&&(i=new ss("onSelect","select",null,i,l),r.push({event:i,listeners:h}),i.target=sc)))}function el(r,i){var l={};return l[r.toLowerCase()]=i.toLowerCase(),l["Webkit"+r]="webkit"+i,l["Moz"+r]="moz"+i,l}var rc={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionrun:el("Transition","TransitionRun"),transitionstart:el("Transition","TransitionStart"),transitioncancel:el("Transition","TransitionCancel"),transitionend:el("Transition","TransitionEnd")},Bp={},n1={};tt&&(n1=document.createElement("div").style,"AnimationEvent"in window||(delete rc.animationend.animation,delete rc.animationiteration.animation,delete rc.animationstart.animation),"TransitionEvent"in window||delete rc.transitionend.transition);function tl(r){if(Bp[r])return Bp[r];if(!rc[r])return r;var i=rc[r],l;for(l in i)if(i.hasOwnProperty(l)&&l in n1)return Bp[r]=i[l];return r}var s1=tl("animationend"),r1=tl("animationiteration"),i1=tl("animationstart"),xN=tl("transitionrun"),_N=tl("transitionstart"),wN=tl("transitioncancel"),a1=tl("transitionend"),o1=new Map,Up="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Up.push("scrollEnd");function ki(r,i){o1.set(r,i),Ye(i,[r])}var Bd=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ci=[],ic=0,Fp=0;function Ud(){for(var r=ic,i=Fp=ic=0;i<r;){var l=ci[i];ci[i++]=null;var h=ci[i];ci[i++]=null;var m=ci[i];ci[i++]=null;var y=ci[i];if(ci[i++]=null,h!==null&&m!==null){var w=h.pending;w===null?m.next=m:(m.next=w.next,w.next=m),h.pending=m}y!==0&&l1(l,m,y)}}function Fd(r,i,l,h){ci[ic++]=r,ci[ic++]=i,ci[ic++]=l,ci[ic++]=h,Fp|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function zp(r,i,l,h){return Fd(r,i,l,h),zd(r)}function nl(r,i){return Fd(r,null,null,i),zd(r)}function l1(r,i,l){r.lanes|=l;var h=r.alternate;h!==null&&(h.lanes|=l);for(var m=!1,y=r.return;y!==null;)y.childLanes|=l,h=y.alternate,h!==null&&(h.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&i!==null&&(m=31-ze(l),r=y.hiddenUpdates,h=r[m],h===null?r[m]=[i]:h.push(i),i.lane=l|536870912),y):null}function zd(r){if(50<ih)throw ih=0,Xg=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var ac={};function TN(r,i,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(r,i,l,h){return new TN(r,i,l,h)}function qp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ca(r,i){var l=r.alternate;return l===null?(l=Wr(r.tag,i,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=i,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,i=r.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function c1(r,i){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,i=l.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function qd(r,i,l,h,m,y){var w=0;if(h=r,typeof r=="function")qp(r)&&(w=1);else if(typeof r=="string")w=NA(r,l,Ae.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case P:return r=Wr(31,l,i,m),r.elementType=P,r.lanes=y,r;case M:return sl(l.children,m,y,i);case D:w=8,m|=24;break;case X:return r=Wr(12,l,i,m|2),r.elementType=X,r.lanes=y,r;case Ne:return r=Wr(13,l,i,m),r.elementType=Ne,r.lanes=y,r;case Te:return r=Wr(19,l,i,m),r.elementType=Te,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case J:w=10;break e;case H:w=9;break e;case he:w=11;break e;case C:w=14;break e;case S:w=16,h=null;break e}w=29,l=Error(s(130,r===null?"null":typeof r,"")),h=null}return i=Wr(w,l,i,m),i.elementType=r,i.type=h,i.lanes=y,i}function sl(r,i,l,h){return r=Wr(7,r,h,i),r.lanes=l,r}function Hp(r,i,l){return r=Wr(6,r,null,i),r.lanes=l,r}function u1(r){var i=Wr(18,null,null,0);return i.stateNode=r,i}function $p(r,i,l){return i=Wr(4,r.children!==null?r.children:[],r.key,i),i.lanes=l,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var h1=new WeakMap;function ui(r,i){if(typeof r=="object"&&r!==null){var l=h1.get(r);return l!==void 0?l:(i={value:r,source:i,stack:At(i)},h1.set(r,i),i)}return{value:r,source:i,stack:At(i)}}var oc=[],lc=0,Hd=null,Ou=0,hi=[],di=0,Ga=null,Ui=1,Fi="";function ua(r,i){oc[lc++]=Ou,oc[lc++]=Hd,Hd=r,Ou=i}function d1(r,i,l){hi[di++]=Ui,hi[di++]=Fi,hi[di++]=Ga,Ga=r;var h=Ui;r=Fi;var m=32-ze(h)-1;h&=~(1<<m),l+=1;var y=32-ze(i)+m;if(30<y){var w=m-m%5;y=(h&(1<<w)-1).toString(32),h>>=w,m-=w,Ui=1<<32-ze(i)+m|l<<m|h,Fi=y+r}else Ui=1<<y|l<<m|h,Fi=r}function Wp(r){r.return!==null&&(ua(r,1),d1(r,1,0))}function Gp(r){for(;r===Hd;)Hd=oc[--lc],oc[lc]=null,Ou=oc[--lc],oc[lc]=null;for(;r===Ga;)Ga=hi[--di],hi[di]=null,Fi=hi[--di],hi[di]=null,Ui=hi[--di],hi[di]=null}function f1(r,i){hi[di++]=Ui,hi[di++]=Fi,hi[di++]=Ga,Ui=i.id,Fi=i.overflow,Ga=r}var hr=null,hs=null,Nn=!1,Ka=null,fi=!1,Kp=Error(s(519));function Qa(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bu(ui(i,r)),Kp}function m1(r){var i=r.stateNode,l=r.type,h=r.memoizedProps;switch(i[rt]=r,i[Dt]=h,l){case"dialog":yn("cancel",i),yn("close",i);break;case"iframe":case"object":case"embed":yn("load",i);break;case"video":case"audio":for(l=0;l<oh.length;l++)yn(oh[l],i);break;case"source":yn("error",i);break;case"img":case"image":case"link":yn("error",i),yn("load",i);break;case"details":yn("toggle",i);break;case"input":yn("invalid",i),Sn(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":yn("invalid",i);break;case"textarea":yn("invalid",i),Os(i,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||h.suppressHydrationWarning===!0||C_(i.textContent,l)?(h.popover!=null&&(yn("beforetoggle",i),yn("toggle",i)),h.onScroll!=null&&yn("scroll",i),h.onScrollEnd!=null&&yn("scrollend",i),h.onClick!=null&&(i.onclick=ls),i=!0):i=!1,i||Qa(r,!0)}function p1(r){for(hr=r.return;hr;)switch(hr.tag){case 5:case 31:case 13:fi=!1;return;case 27:case 3:fi=!0;return;default:hr=hr.return}}function cc(r){if(r!==hr)return!1;if(!Nn)return p1(r),Nn=!0,!1;var i=r.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||dy(r.type,r.memoizedProps)),l=!l),l&&hs&&Qa(r),p1(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));hs=U_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));hs=U_(r)}else i===27?(i=hs,co(r.type)?(r=yy,yy=null,hs=r):hs=i):hs=hr?pi(r.stateNode.nextSibling):null;return!0}function rl(){hs=hr=null,Nn=!1}function Qp(){var r=Ka;return r!==null&&(Or===null?Or=r:Or.push.apply(Or,r),Ka=null),r}function Bu(r){Ka===null?Ka=[r]:Ka.push(r)}var Yp=O(null),il=null,ha=null;function Ya(r,i,l){we(Yp,i._currentValue),i._currentValue=l}function da(r){r._currentValue=Yp.current,K(Yp)}function Xp(r,i,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===l)break;r=r.return}}function Jp(r,i,l,h){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var w=m.child;y=y.firstContext;e:for(;y!==null;){var j=y;y=m;for(var F=0;F<i.length;F++)if(j.context===i[F]){y.lanes|=l,j=y.alternate,j!==null&&(j.lanes|=l),Xp(y.return,l,r),h||(w=null);break e}y=j.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(s(341));w.lanes|=l,y=w.alternate,y!==null&&(y.lanes|=l),Xp(w,l,r),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===r){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function uc(r,i,l,h){r=null;for(var m=i,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(s(387));if(w=w.memoizedProps,w!==null){var j=m.type;$r(m.pendingProps.value,w.value)||(r!==null?r.push(j):r=[j])}}else if(m===ct.current){if(w=m.alternate,w===null)throw Error(s(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(dh):r=[dh])}m=m.return}r!==null&&Jp(i,r,l,h),i.flags|=262144}function $d(r){for(r=r.firstContext;r!==null;){if(!$r(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function al(r){il=r,ha=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function dr(r){return g1(il,r)}function Wd(r,i){return il===null&&al(r),g1(r,i)}function g1(r,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},ha===null){if(r===null)throw Error(s(308));ha=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else ha=ha.next=i;return l}var EN=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(l,h){r.push(h)}};this.abort=function(){i.aborted=!0,r.forEach(function(l){return l()})}},kN=n.unstable_scheduleCallback,SN=n.unstable_NormalPriority,Fs={$$typeof:J,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new EN,data:new Map,refCount:0}}function Uu(r){r.refCount--,r.refCount===0&&kN(SN,function(){r.controller.abort()})}var Fu=null,eg=0,hc=0,dc=null;function jN(r,i){if(Fu===null){var l=Fu=[];eg=0,hc=sy(),dc={status:"pending",value:void 0,then:function(h){l.push(h)}}}return eg++,i.then(y1,y1),i}function y1(){if(--eg===0&&Fu!==null){dc!==null&&(dc.status="fulfilled");var r=Fu;Fu=null,hc=0,dc=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function NN(r,i){var l=[],h={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){h.status="fulfilled",h.value=i;for(var m=0;m<l.length;m++)(0,l[m])(i)},function(m){for(h.status="rejected",h.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),h}var b1=$.S;$.S=function(r,i){t_=ln(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&jN(r,i),b1!==null&&b1(r,i)};var ol=O(null);function tg(){var r=ol.current;return r!==null?r:is.pooledCache}function Gd(r,i){i===null?we(ol,ol.current):we(ol,i.pool)}function v1(){var r=tg();return r===null?null:{parent:Fs._currentValue,pool:r}}var fc=Error(s(460)),ng=Error(s(474)),Kd=Error(s(542)),Qd={then:function(){}};function x1(r){return r=r.status,r==="fulfilled"||r==="rejected"}function _1(r,i,l){switch(l=r[l],l===void 0?r.push(i):l!==i&&(i.then(ls,ls),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r;default:if(typeof i.status=="string")i.then(ls,ls);else{if(r=is,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(h){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=h}},function(h){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r}throw cl=i,fc}}function ll(r){try{var i=r._init;return i(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(cl=l,fc):l}}var cl=null;function w1(){if(cl===null)throw Error(s(459));var r=cl;return cl=null,r}function T1(r){if(r===fc||r===Kd)throw Error(s(483))}var mc=null,zu=0;function Yd(r){var i=zu;return zu+=1,mc===null&&(mc=[]),_1(mc,r,i)}function qu(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Xd(r,i){throw i.$$typeof===T?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function E1(r){function i(Z,G){if(r){var oe=Z.deletions;oe===null?(Z.deletions=[G],Z.flags|=16):oe.push(G)}}function l(Z,G){if(!r)return null;for(;G!==null;)i(Z,G),G=G.sibling;return null}function h(Z){for(var G=new Map;Z!==null;)Z.key!==null?G.set(Z.key,Z):G.set(Z.index,Z),Z=Z.sibling;return G}function m(Z,G){return Z=ca(Z,G),Z.index=0,Z.sibling=null,Z}function y(Z,G,oe){return Z.index=oe,r?(oe=Z.alternate,oe!==null?(oe=oe.index,oe<G?(Z.flags|=67108866,G):oe):(Z.flags|=67108866,G)):(Z.flags|=1048576,G)}function w(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function j(Z,G,oe,Re){return G===null||G.tag!==6?(G=Hp(oe,Z.mode,Re),G.return=Z,G):(G=m(G,oe),G.return=Z,G)}function F(Z,G,oe,Re){var Nt=oe.type;return Nt===M?je(Z,G,oe.props.children,Re,oe.key):G!==null&&(G.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===S&&ll(Nt)===G.type)?(G=m(G,oe.props),qu(G,oe),G.return=Z,G):(G=qd(oe.type,oe.key,oe.props,null,Z.mode,Re),qu(G,oe),G.return=Z,G)}function le(Z,G,oe,Re){return G===null||G.tag!==4||G.stateNode.containerInfo!==oe.containerInfo||G.stateNode.implementation!==oe.implementation?(G=$p(oe,Z.mode,Re),G.return=Z,G):(G=m(G,oe.children||[]),G.return=Z,G)}function je(Z,G,oe,Re,Nt){return G===null||G.tag!==7?(G=sl(oe,Z.mode,Re,Nt),G.return=Z,G):(G=m(G,oe),G.return=Z,G)}function Ie(Z,G,oe){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Hp(""+G,Z.mode,oe),G.return=Z,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case N:return oe=qd(G.type,G.key,G.props,null,Z.mode,oe),qu(oe,G),oe.return=Z,oe;case B:return G=$p(G,Z.mode,oe),G.return=Z,G;case S:return G=ll(G),Ie(Z,G,oe)}if(wt(G)||q(G))return G=sl(G,Z.mode,oe,null),G.return=Z,G;if(typeof G.then=="function")return Ie(Z,Yd(G),oe);if(G.$$typeof===J)return Ie(Z,Wd(Z,G),oe);Xd(Z,G)}return null}function ue(Z,G,oe,Re){var Nt=G!==null?G.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Nt!==null?null:j(Z,G,""+oe,Re);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:return oe.key===Nt?F(Z,G,oe,Re):null;case B:return oe.key===Nt?le(Z,G,oe,Re):null;case S:return oe=ll(oe),ue(Z,G,oe,Re)}if(wt(oe)||q(oe))return Nt!==null?null:je(Z,G,oe,Re,null);if(typeof oe.then=="function")return ue(Z,G,Yd(oe),Re);if(oe.$$typeof===J)return ue(Z,G,Wd(Z,oe),Re);Xd(Z,oe)}return null}function ge(Z,G,oe,Re,Nt){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Z=Z.get(oe)||null,j(G,Z,""+Re,Nt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case N:return Z=Z.get(Re.key===null?oe:Re.key)||null,F(G,Z,Re,Nt);case B:return Z=Z.get(Re.key===null?oe:Re.key)||null,le(G,Z,Re,Nt);case S:return Re=ll(Re),ge(Z,G,oe,Re,Nt)}if(wt(Re)||q(Re))return Z=Z.get(oe)||null,je(G,Z,Re,Nt,null);if(typeof Re.then=="function")return ge(Z,G,oe,Yd(Re),Nt);if(Re.$$typeof===J)return ge(Z,G,oe,Wd(G,Re),Nt);Xd(G,Re)}return null}function ft(Z,G,oe,Re){for(var Nt=null,Mn=null,xt=G,on=G=0,Tn=null;xt!==null&&on<oe.length;on++){xt.index>on?(Tn=xt,xt=null):Tn=xt.sibling;var Ln=ue(Z,xt,oe[on],Re);if(Ln===null){xt===null&&(xt=Tn);break}r&&xt&&Ln.alternate===null&&i(Z,xt),G=y(Ln,G,on),Mn===null?Nt=Ln:Mn.sibling=Ln,Mn=Ln,xt=Tn}if(on===oe.length)return l(Z,xt),Nn&&ua(Z,on),Nt;if(xt===null){for(;on<oe.length;on++)xt=Ie(Z,oe[on],Re),xt!==null&&(G=y(xt,G,on),Mn===null?Nt=xt:Mn.sibling=xt,Mn=xt);return Nn&&ua(Z,on),Nt}for(xt=h(xt);on<oe.length;on++)Tn=ge(xt,Z,on,oe[on],Re),Tn!==null&&(r&&Tn.alternate!==null&&xt.delete(Tn.key===null?on:Tn.key),G=y(Tn,G,on),Mn===null?Nt=Tn:Mn.sibling=Tn,Mn=Tn);return r&&xt.forEach(function(po){return i(Z,po)}),Nn&&ua(Z,on),Nt}function Pt(Z,G,oe,Re){if(oe==null)throw Error(s(151));for(var Nt=null,Mn=null,xt=G,on=G=0,Tn=null,Ln=oe.next();xt!==null&&!Ln.done;on++,Ln=oe.next()){xt.index>on?(Tn=xt,xt=null):Tn=xt.sibling;var po=ue(Z,xt,Ln.value,Re);if(po===null){xt===null&&(xt=Tn);break}r&&xt&&po.alternate===null&&i(Z,xt),G=y(po,G,on),Mn===null?Nt=po:Mn.sibling=po,Mn=po,xt=Tn}if(Ln.done)return l(Z,xt),Nn&&ua(Z,on),Nt;if(xt===null){for(;!Ln.done;on++,Ln=oe.next())Ln=Ie(Z,Ln.value,Re),Ln!==null&&(G=y(Ln,G,on),Mn===null?Nt=Ln:Mn.sibling=Ln,Mn=Ln);return Nn&&ua(Z,on),Nt}for(xt=h(xt);!Ln.done;on++,Ln=oe.next())Ln=ge(xt,Z,on,Ln.value,Re),Ln!==null&&(r&&Ln.alternate!==null&&xt.delete(Ln.key===null?on:Ln.key),G=y(Ln,G,on),Mn===null?Nt=Ln:Mn.sibling=Ln,Mn=Ln);return r&&xt.forEach(function(BA){return i(Z,BA)}),Nn&&ua(Z,on),Nt}function es(Z,G,oe,Re){if(typeof oe=="object"&&oe!==null&&oe.type===M&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:e:{for(var Nt=oe.key;G!==null;){if(G.key===Nt){if(Nt=oe.type,Nt===M){if(G.tag===7){l(Z,G.sibling),Re=m(G,oe.props.children),Re.return=Z,Z=Re;break e}}else if(G.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===S&&ll(Nt)===G.type){l(Z,G.sibling),Re=m(G,oe.props),qu(Re,oe),Re.return=Z,Z=Re;break e}l(Z,G);break}else i(Z,G);G=G.sibling}oe.type===M?(Re=sl(oe.props.children,Z.mode,Re,oe.key),Re.return=Z,Z=Re):(Re=qd(oe.type,oe.key,oe.props,null,Z.mode,Re),qu(Re,oe),Re.return=Z,Z=Re)}return w(Z);case B:e:{for(Nt=oe.key;G!==null;){if(G.key===Nt)if(G.tag===4&&G.stateNode.containerInfo===oe.containerInfo&&G.stateNode.implementation===oe.implementation){l(Z,G.sibling),Re=m(G,oe.children||[]),Re.return=Z,Z=Re;break e}else{l(Z,G);break}else i(Z,G);G=G.sibling}Re=$p(oe,Z.mode,Re),Re.return=Z,Z=Re}return w(Z);case S:return oe=ll(oe),es(Z,G,oe,Re)}if(wt(oe))return ft(Z,G,oe,Re);if(q(oe)){if(Nt=q(oe),typeof Nt!="function")throw Error(s(150));return oe=Nt.call(oe),Pt(Z,G,oe,Re)}if(typeof oe.then=="function")return es(Z,G,Yd(oe),Re);if(oe.$$typeof===J)return es(Z,G,Wd(Z,oe),Re);Xd(Z,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,G!==null&&G.tag===6?(l(Z,G.sibling),Re=m(G,oe),Re.return=Z,Z=Re):(l(Z,G),Re=Hp(oe,Z.mode,Re),Re.return=Z,Z=Re),w(Z)):l(Z,G)}return function(Z,G,oe,Re){try{zu=0;var Nt=es(Z,G,oe,Re);return mc=null,Nt}catch(xt){if(xt===fc||xt===Kd)throw xt;var Mn=Wr(29,xt,null,Z.mode);return Mn.lanes=Re,Mn.return=Z,Mn}}}var ul=E1(!0),k1=E1(!1),Xa=!1;function sg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ja(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Za(r,i,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Un&2)!==0){var m=h.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),h.pending=i,i=zd(r),l1(r,null,l),i}return Fd(r,h,i,l),zd(r)}function Hu(r,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,In(r,l)}}function ig(r,i){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?m=y=w:y=y.next=w,l=l.next}while(l!==null);y===null?m=y=i:y=y.next=i}else m=y=i;l={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=i:r.next=i,l.lastBaseUpdate=i}var ag=!1;function $u(){if(ag){var r=dc;if(r!==null)throw r}}function Wu(r,i,l,h){ag=!1;var m=r.updateQueue;Xa=!1;var y=m.firstBaseUpdate,w=m.lastBaseUpdate,j=m.shared.pending;if(j!==null){m.shared.pending=null;var F=j,le=F.next;F.next=null,w===null?y=le:w.next=le,w=F;var je=r.alternate;je!==null&&(je=je.updateQueue,j=je.lastBaseUpdate,j!==w&&(j===null?je.firstBaseUpdate=le:j.next=le,je.lastBaseUpdate=F))}if(y!==null){var Ie=m.baseState;w=0,je=le=F=null,j=y;do{var ue=j.lane&-536870913,ge=ue!==j.lane;if(ge?(wn&ue)===ue:(h&ue)===ue){ue!==0&&ue===hc&&(ag=!0),je!==null&&(je=je.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var ft=r,Pt=j;ue=i;var es=l;switch(Pt.tag){case 1:if(ft=Pt.payload,typeof ft=="function"){Ie=ft.call(es,Ie,ue);break e}Ie=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=Pt.payload,ue=typeof ft=="function"?ft.call(es,Ie,ue):ft,ue==null)break e;Ie=x({},Ie,ue);break e;case 2:Xa=!0}}ue=j.callback,ue!==null&&(r.flags|=64,ge&&(r.flags|=8192),ge=m.callbacks,ge===null?m.callbacks=[ue]:ge.push(ue))}else ge={lane:ue,tag:j.tag,payload:j.payload,callback:j.callback,next:null},je===null?(le=je=ge,F=Ie):je=je.next=ge,w|=ue;if(j=j.next,j===null){if(j=m.shared.pending,j===null)break;ge=j,j=ge.next,ge.next=null,m.lastBaseUpdate=ge,m.shared.pending=null}}while(!0);je===null&&(F=Ie),m.baseState=F,m.firstBaseUpdate=le,m.lastBaseUpdate=je,y===null&&(m.shared.lanes=0),ro|=w,r.lanes=w,r.memoizedState=Ie}}function S1(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function j1(r,i){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)S1(l[r],i)}var pc=O(null),Jd=O(0);function N1(r,i){r=_a,we(Jd,r),we(pc,i),_a=r|i.baseLanes}function og(){we(Jd,_a),we(pc,pc.current)}function lg(){_a=Jd.current,K(pc),K(Jd)}var Gr=O(null),mi=null;function eo(r){var i=r.alternate;we(Ds,Ds.current&1),we(Gr,r),mi===null&&(i===null||pc.current!==null||i.memoizedState!==null)&&(mi=r)}function cg(r){we(Ds,Ds.current),we(Gr,r),mi===null&&(mi=r)}function A1(r){r.tag===22?(we(Ds,Ds.current),we(Gr,r),mi===null&&(mi=r)):to()}function to(){we(Ds,Ds.current),we(Gr,Gr.current)}function Kr(r){K(Gr),mi===r&&(mi=null),K(Ds)}var Ds=O(0);function Zd(r){for(var i=r;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||py(l)||gy(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var fa=0,nn=null,Jn=null,zs=null,ef=!1,gc=!1,hl=!1,tf=0,Gu=0,yc=null,AN=0;function Ss(){throw Error(s(321))}function ug(r,i){if(i===null)return!1;for(var l=0;l<i.length&&l<r.length;l++)if(!$r(r[l],i[l]))return!1;return!0}function hg(r,i,l,h,m,y){return fa=y,nn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$.H=r===null||r.memoizedState===null?dx:Sg,hl=!1,y=l(h,m),hl=!1,gc&&(y=C1(i,l,h,m)),R1(r),y}function R1(r){$.H=Yu;var i=Jn!==null&&Jn.next!==null;if(fa=0,zs=Jn=nn=null,ef=!1,Gu=0,yc=null,i)throw Error(s(300));r===null||qs||(r=r.dependencies,r!==null&&$d(r)&&(qs=!0))}function C1(r,i,l,h){nn=r;var m=0;do{if(gc&&(yc=null),Gu=0,gc=!1,25<=m)throw Error(s(301));if(m+=1,zs=Jn=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}$.H=fx,y=i(l,h)}while(gc);return y}function RN(){var r=$.H,i=r.useState()[0];return i=typeof i.then=="function"?Ku(i):i,r=r.useState()[0],(Jn!==null?Jn.memoizedState:null)!==r&&(nn.flags|=1024),i}function dg(){var r=tf!==0;return tf=0,r}function fg(r,i,l){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~l}function mg(r){if(ef){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ef=!1}fa=0,zs=Jn=nn=null,gc=!1,Gu=tf=0,yc=null}function jr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zs===null?nn.memoizedState=zs=r:zs=zs.next=r,zs}function Ps(){if(Jn===null){var r=nn.alternate;r=r!==null?r.memoizedState:null}else r=Jn.next;var i=zs===null?nn.memoizedState:zs.next;if(i!==null)zs=i,Jn=r;else{if(r===null)throw nn.alternate===null?Error(s(467)):Error(s(310));Jn=r,r={memoizedState:Jn.memoizedState,baseState:Jn.baseState,baseQueue:Jn.baseQueue,queue:Jn.queue,next:null},zs===null?nn.memoizedState=zs=r:zs=zs.next=r}return zs}function nf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ku(r){var i=Gu;return Gu+=1,yc===null&&(yc=[]),r=_1(yc,r,i),i=nn,(zs===null?i.memoizedState:zs.next)===null&&(i=i.alternate,$.H=i===null||i.memoizedState===null?dx:Sg),r}function sf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Ku(r);if(r.$$typeof===J)return dr(r)}throw Error(s(438,String(r)))}function pg(r){var i=null,l=nn.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var h=nn.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=nf(),nn.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(r),h=0;h<r;h++)l[h]=U;return i.index++,l}function ma(r,i){return typeof i=="function"?i(r):i}function rf(r){var i=Ps();return gg(i,Jn,r)}function gg(r,i,l){var h=r.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var m=r.baseQueue,y=h.pending;if(y!==null){if(m!==null){var w=m.next;m.next=y.next,y.next=w}i.baseQueue=m=y,h.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{i=m.next;var j=w=null,F=null,le=i,je=!1;do{var Ie=le.lane&-536870913;if(Ie!==le.lane?(wn&Ie)===Ie:(fa&Ie)===Ie){var ue=le.revertLane;if(ue===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Ie===hc&&(je=!0);else if((fa&ue)===ue){le=le.next,ue===hc&&(je=!0);continue}else Ie={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},F===null?(j=F=Ie,w=y):F=F.next=Ie,nn.lanes|=ue,ro|=ue;Ie=le.action,hl&&l(y,Ie),y=le.hasEagerState?le.eagerState:l(y,Ie)}else ue={lane:Ie,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},F===null?(j=F=ue,w=y):F=F.next=ue,nn.lanes|=Ie,ro|=Ie;le=le.next}while(le!==null&&le!==i);if(F===null?w=y:F.next=j,!$r(y,r.memoizedState)&&(qs=!0,je&&(l=dc,l!==null)))throw l;r.memoizedState=y,r.baseState=w,r.baseQueue=F,h.lastRenderedState=y}return m===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function yg(r){var i=Ps(),l=i.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=r;var h=l.dispatch,m=l.pending,y=i.memoizedState;if(m!==null){l.pending=null;var w=m=m.next;do y=r(y,w.action),w=w.next;while(w!==m);$r(y,i.memoizedState)||(qs=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),l.lastRenderedState=y}return[y,h]}function I1(r,i,l){var h=nn,m=Ps(),y=Nn;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=i();var w=!$r((Jn||m).memoizedState,l);if(w&&(m.memoizedState=l,qs=!0),m=m.queue,xg(M1.bind(null,h,m,r),[r]),m.getSnapshot!==i||w||zs!==null&&zs.memoizedState.tag&1){if(h.flags|=2048,bc(9,{destroy:void 0},P1.bind(null,h,m,l,i),null),is===null)throw Error(s(349));y||(fa&127)!==0||D1(h,i,l)}return l}function D1(r,i,l){r.flags|=16384,r={getSnapshot:i,value:l},i=nn.updateQueue,i===null?(i=nf(),nn.updateQueue=i,i.stores=[r]):(l=i.stores,l===null?i.stores=[r]:l.push(r))}function P1(r,i,l,h){i.value=l,i.getSnapshot=h,L1(i)&&V1(r)}function M1(r,i,l){return l(function(){L1(i)&&V1(r)})}function L1(r){var i=r.getSnapshot;r=r.value;try{var l=i();return!$r(r,l)}catch{return!0}}function V1(r){var i=nl(r,2);i!==null&&Br(i,r,2)}function bg(r){var i=jr();if(typeof r=="function"){var l=r;if(r=l(),hl){Me(!0);try{l()}finally{Me(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:r},i}function O1(r,i,l,h){return r.baseState=l,gg(r,Jn,typeof h=="function"?h:ma)}function CN(r,i,l,h,m){if(lf(r))throw Error(s(485));if(r=i.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};$.T!==null?l(!0):y.isTransition=!1,h(y),l=i.pending,l===null?(y.next=i.pending=y,B1(i,y)):(y.next=l.next,i.pending=l.next=y)}}function B1(r,i){var l=i.action,h=i.payload,m=r.state;if(i.isTransition){var y=$.T,w={};$.T=w;try{var j=l(m,h),F=$.S;F!==null&&F(w,j),U1(r,i,j)}catch(le){vg(r,i,le)}finally{y!==null&&w.types!==null&&(y.types=w.types),$.T=y}}else try{y=l(m,h),U1(r,i,y)}catch(le){vg(r,i,le)}}function U1(r,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){F1(r,i,h)},function(h){return vg(r,i,h)}):F1(r,i,l)}function F1(r,i,l){i.status="fulfilled",i.value=l,z1(i),r.state=l,i=r.pending,i!==null&&(l=i.next,l===i?r.pending=null:(l=l.next,i.next=l,B1(r,l)))}function vg(r,i,l){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=l,z1(i),i=i.next;while(i!==h)}r.action=null}function z1(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function q1(r,i){return i}function H1(r,i){if(Nn){var l=is.formState;if(l!==null){e:{var h=nn;if(Nn){if(hs){t:{for(var m=hs,y=fi;m.nodeType!==8;){if(!y){m=null;break t}if(m=pi(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){hs=pi(m.nextSibling),h=m.data==="F!";break e}}Qa(h)}h=!1}h&&(i=l[0])}}return l=jr(),l.memoizedState=l.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q1,lastRenderedState:i},l.queue=h,l=cx.bind(null,nn,h),h.dispatch=l,h=bg(!1),y=kg.bind(null,nn,!1,h.queue),h=jr(),m={state:i,dispatch:null,action:r,pending:null},h.queue=m,l=CN.bind(null,nn,m,y,l),m.dispatch=l,h.memoizedState=r,[i,l,!1]}function $1(r){var i=Ps();return W1(i,Jn,r)}function W1(r,i,l){if(i=gg(r,i,q1)[0],r=rf(ma)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=Ku(i)}catch(w){throw w===fc?Kd:w}else h=i;i=Ps();var m=i.queue,y=m.dispatch;return l!==i.memoizedState&&(nn.flags|=2048,bc(9,{destroy:void 0},IN.bind(null,m,l),null)),[h,y,r]}function IN(r,i){r.action=i}function G1(r){var i=Ps(),l=Jn;if(l!==null)return W1(i,l,r);Ps(),i=i.memoizedState,l=Ps();var h=l.queue.dispatch;return l.memoizedState=r,[i,h,!1]}function bc(r,i,l,h){return r={tag:r,create:l,deps:h,inst:i,next:null},i=nn.updateQueue,i===null&&(i=nf(),nn.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,i.lastEffect=r),r}function K1(){return Ps().memoizedState}function af(r,i,l,h){var m=jr();nn.flags|=r,m.memoizedState=bc(1|i,{destroy:void 0},l,h===void 0?null:h)}function of(r,i,l,h){var m=Ps();h=h===void 0?null:h;var y=m.memoizedState.inst;Jn!==null&&h!==null&&ug(h,Jn.memoizedState.deps)?m.memoizedState=bc(i,y,l,h):(nn.flags|=r,m.memoizedState=bc(1|i,y,l,h))}function Q1(r,i){af(8390656,8,r,i)}function xg(r,i){of(2048,8,r,i)}function DN(r){nn.flags|=4;var i=nn.updateQueue;if(i===null)i=nf(),nn.updateQueue=i,i.events=[r];else{var l=i.events;l===null?i.events=[r]:l.push(r)}}function Y1(r){var i=Ps().memoizedState;return DN({ref:i,nextImpl:r}),function(){if((Un&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function X1(r,i){return of(4,2,r,i)}function J1(r,i){return of(4,4,r,i)}function Z1(r,i){if(typeof i=="function"){r=r();var l=i(r);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function ex(r,i,l){l=l!=null?l.concat([r]):null,of(4,4,Z1.bind(null,i,r),l)}function _g(){}function tx(r,i){var l=Ps();i=i===void 0?null:i;var h=l.memoizedState;return i!==null&&ug(i,h[1])?h[0]:(l.memoizedState=[r,i],r)}function nx(r,i){var l=Ps();i=i===void 0?null:i;var h=l.memoizedState;if(i!==null&&ug(i,h[1]))return h[0];if(h=r(),hl){Me(!0);try{r()}finally{Me(!1)}}return l.memoizedState=[h,i],h}function wg(r,i,l){return l===void 0||(fa&1073741824)!==0&&(wn&261930)===0?r.memoizedState=i:(r.memoizedState=l,r=s_(),nn.lanes|=r,ro|=r,l)}function sx(r,i,l,h){return $r(l,i)?l:pc.current!==null?(r=wg(r,l,h),$r(r,i)||(qs=!0),r):(fa&42)===0||(fa&1073741824)!==0&&(wn&261930)===0?(qs=!0,r.memoizedState=l):(r=s_(),nn.lanes|=r,ro|=r,i)}function rx(r,i,l,h,m){var y=ye.p;ye.p=y!==0&&8>y?y:8;var w=$.T,j={};$.T=j,kg(r,!1,i,l);try{var F=m(),le=$.S;if(le!==null&&le(j,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var je=NN(F,h);Qu(r,i,je,Xr(r))}else Qu(r,i,h,Xr(r))}catch(Ie){Qu(r,i,{then:function(){},status:"rejected",reason:Ie},Xr())}finally{ye.p=y,w!==null&&j.types!==null&&(w.types=j.types),$.T=w}}function PN(){}function Tg(r,i,l,h){if(r.tag!==5)throw Error(s(476));var m=ix(r).queue;rx(r,m,i,Le,l===null?PN:function(){return ax(r),l(h)})}function ix(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:Le},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:l},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function ax(r){var i=ix(r);i.next===null&&(i=r.alternate.memoizedState),Qu(r,i.next.queue,{},Xr())}function Eg(){return dr(dh)}function ox(){return Ps().memoizedState}function lx(){return Ps().memoizedState}function MN(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var l=Xr();r=Ja(l);var h=Za(i,r,l);h!==null&&(Br(h,i,l),Hu(h,i,l)),i={cache:Zp()},r.payload=i;return}i=i.return}}function LN(r,i,l){var h=Xr();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},lf(r)?ux(i,l):(l=zp(r,i,l,h),l!==null&&(Br(l,r,h),hx(l,i,h)))}function cx(r,i,l){var h=Xr();Qu(r,i,l,h)}function Qu(r,i,l,h){var m={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(lf(r))ux(i,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var w=i.lastRenderedState,j=y(w,l);if(m.hasEagerState=!0,m.eagerState=j,$r(j,w))return Fd(r,i,m,0),is===null&&Ud(),!1}catch{}if(l=zp(r,i,m,h),l!==null)return Br(l,r,h),hx(l,i,h),!0}return!1}function kg(r,i,l,h){if(h={lane:2,revertLane:sy(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},lf(r)){if(i)throw Error(s(479))}else i=zp(r,l,h,2),i!==null&&Br(i,r,2)}function lf(r){var i=r.alternate;return r===nn||i!==null&&i===nn}function ux(r,i){gc=ef=!0;var l=r.pending;l===null?i.next=i:(i.next=l.next,l.next=i),r.pending=i}function hx(r,i,l){if((l&4194048)!==0){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,In(r,l)}}var Yu={readContext:dr,use:sf,useCallback:Ss,useContext:Ss,useEffect:Ss,useImperativeHandle:Ss,useLayoutEffect:Ss,useInsertionEffect:Ss,useMemo:Ss,useReducer:Ss,useRef:Ss,useState:Ss,useDebugValue:Ss,useDeferredValue:Ss,useTransition:Ss,useSyncExternalStore:Ss,useId:Ss,useHostTransitionStatus:Ss,useFormState:Ss,useActionState:Ss,useOptimistic:Ss,useMemoCache:Ss,useCacheRefresh:Ss};Yu.useEffectEvent=Ss;var dx={readContext:dr,use:sf,useCallback:function(r,i){return jr().memoizedState=[r,i===void 0?null:i],r},useContext:dr,useEffect:Q1,useImperativeHandle:function(r,i,l){l=l!=null?l.concat([r]):null,af(4194308,4,Z1.bind(null,i,r),l)},useLayoutEffect:function(r,i){return af(4194308,4,r,i)},useInsertionEffect:function(r,i){af(4,2,r,i)},useMemo:function(r,i){var l=jr();i=i===void 0?null:i;var h=r();if(hl){Me(!0);try{r()}finally{Me(!1)}}return l.memoizedState=[h,i],h},useReducer:function(r,i,l){var h=jr();if(l!==void 0){var m=l(i);if(hl){Me(!0);try{l(i)}finally{Me(!1)}}}else m=i;return h.memoizedState=h.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},h.queue=r,r=r.dispatch=LN.bind(null,nn,r),[h.memoizedState,r]},useRef:function(r){var i=jr();return r={current:r},i.memoizedState=r},useState:function(r){r=bg(r);var i=r.queue,l=cx.bind(null,nn,i);return i.dispatch=l,[r.memoizedState,l]},useDebugValue:_g,useDeferredValue:function(r,i){var l=jr();return wg(l,r,i)},useTransition:function(){var r=bg(!1);return r=rx.bind(null,nn,r.queue,!0,!1),jr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,l){var h=nn,m=jr();if(Nn){if(l===void 0)throw Error(s(407));l=l()}else{if(l=i(),is===null)throw Error(s(349));(wn&127)!==0||D1(h,i,l)}m.memoizedState=l;var y={value:l,getSnapshot:i};return m.queue=y,Q1(M1.bind(null,h,y,r),[r]),h.flags|=2048,bc(9,{destroy:void 0},P1.bind(null,h,y,l,i),null),l},useId:function(){var r=jr(),i=is.identifierPrefix;if(Nn){var l=Fi,h=Ui;l=(h&~(1<<32-ze(h)-1)).toString(32)+l,i="_"+i+"R_"+l,l=tf++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=AN++,i="_"+i+"r_"+l.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Eg,useFormState:H1,useActionState:H1,useOptimistic:function(r){var i=jr();i.memoizedState=i.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=kg.bind(null,nn,!0,l),l.dispatch=i,[r,i]},useMemoCache:pg,useCacheRefresh:function(){return jr().memoizedState=MN.bind(null,nn)},useEffectEvent:function(r){var i=jr(),l={impl:r};return i.memoizedState=l,function(){if((Un&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Sg={readContext:dr,use:sf,useCallback:tx,useContext:dr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:rf,useRef:K1,useState:function(){return rf(ma)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ps();return sx(l,Jn.memoizedState,r,i)},useTransition:function(){var r=rf(ma)[0],i=Ps().memoizedState;return[typeof r=="boolean"?r:Ku(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:Eg,useFormState:$1,useActionState:$1,useOptimistic:function(r,i){var l=Ps();return O1(l,Jn,r,i)},useMemoCache:pg,useCacheRefresh:lx};Sg.useEffectEvent=Y1;var fx={readContext:dr,use:sf,useCallback:tx,useContext:dr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:yg,useRef:K1,useState:function(){return yg(ma)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ps();return Jn===null?wg(l,r,i):sx(l,Jn.memoizedState,r,i)},useTransition:function(){var r=yg(ma)[0],i=Ps().memoizedState;return[typeof r=="boolean"?r:Ku(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:Eg,useFormState:G1,useActionState:G1,useOptimistic:function(r,i){var l=Ps();return Jn!==null?O1(l,Jn,r,i):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:pg,useCacheRefresh:lx};fx.useEffectEvent=Y1;function jg(r,i,l,h){i=r.memoizedState,l=l(h,i),l=l==null?i:x({},i,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Ng={enqueueSetState:function(r,i,l){r=r._reactInternals;var h=Xr(),m=Ja(h);m.payload=i,l!=null&&(m.callback=l),i=Za(r,m,h),i!==null&&(Br(i,r,h),Hu(i,r,h))},enqueueReplaceState:function(r,i,l){r=r._reactInternals;var h=Xr(),m=Ja(h);m.tag=1,m.payload=i,l!=null&&(m.callback=l),i=Za(r,m,h),i!==null&&(Br(i,r,h),Hu(i,r,h))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var l=Xr(),h=Ja(l);h.tag=2,i!=null&&(h.callback=i),i=Za(r,h,l),i!==null&&(Br(i,r,l),Hu(i,r,l))}};function mx(r,i,l,h,m,y,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,w):i.prototype&&i.prototype.isPureReactComponent?!Lu(l,h)||!Lu(m,y):!0}function px(r,i,l,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,h),i.state!==r&&Ng.enqueueReplaceState(i,i.state,null)}function dl(r,i){var l=i;if("ref"in i){l={};for(var h in i)h!=="ref"&&(l[h]=i[h])}if(r=r.defaultProps){l===i&&(l=x({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}function gx(r){Bd(r)}function yx(r){console.error(r)}function bx(r){Bd(r)}function cf(r,i){try{var l=r.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function vx(r,i,l){try{var h=r.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Ag(r,i,l){return l=Ja(l),l.tag=3,l.payload={element:null},l.callback=function(){cf(r,i)},l}function xx(r){return r=Ja(r),r.tag=3,r}function _x(r,i,l,h){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=h.value;r.payload=function(){return m(y)},r.callback=function(){vx(i,l,h)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){vx(i,l,h),typeof m!="function"&&(io===null?io=new Set([this]):io.add(this));var j=h.stack;this.componentDidCatch(h.value,{componentStack:j!==null?j:""})})}function VN(r,i,l,h,m){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=l.alternate,i!==null&&uc(i,l,m,!0),l=Gr.current,l!==null){switch(l.tag){case 31:case 13:return mi===null?_f():l.alternate===null&&js===0&&(js=3),l.flags&=-257,l.flags|=65536,l.lanes=m,h===Qd?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([h]):i.add(h),ey(r,h,m)),!1;case 22:return l.flags|=65536,h===Qd?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([h]):l.add(h)),ey(r,h,m)),!1}throw Error(s(435,l.tag))}return ey(r,h,m),_f(),!1}if(Nn)return i=Gr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,h!==Kp&&(r=Error(s(422),{cause:h}),Bu(ui(r,l)))):(h!==Kp&&(i=Error(s(423),{cause:h}),Bu(ui(i,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,h=ui(h,l),m=Ag(r.stateNode,h,m),ig(r,m),js!==4&&(js=2)),!1;var y=Error(s(520),{cause:h});if(y=ui(y,l),rh===null?rh=[y]:rh.push(y),js!==4&&(js=2),i===null)return!0;h=ui(h,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=Ag(l.stateNode,h,r),ig(l,r),!1;case 1:if(i=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(io===null||!io.has(y))))return l.flags|=65536,m&=-m,l.lanes|=m,m=xx(m),_x(m,r,l,h),ig(l,m),!1}l=l.return}while(l!==null);return!1}var Rg=Error(s(461)),qs=!1;function fr(r,i,l,h){i.child=r===null?k1(i,null,l,h):ul(i,r.child,l,h)}function wx(r,i,l,h,m){l=l.render;var y=i.ref;if("ref"in h){var w={};for(var j in h)j!=="ref"&&(w[j]=h[j])}else w=h;return al(i),h=hg(r,i,l,w,y,m),j=dg(),r!==null&&!qs?(fg(r,i,m),pa(r,i,m)):(Nn&&j&&Wp(i),i.flags|=1,fr(r,i,h,m),i.child)}function Tx(r,i,l,h,m){if(r===null){var y=l.type;return typeof y=="function"&&!qp(y)&&y.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=y,Ex(r,i,y,h,m)):(r=qd(l.type,null,h,i,i.mode,m),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!Og(r,m)){var w=y.memoizedProps;if(l=l.compare,l=l!==null?l:Lu,l(w,h)&&r.ref===i.ref)return pa(r,i,m)}return i.flags|=1,r=ca(y,h),r.ref=i.ref,r.return=i,i.child=r}function Ex(r,i,l,h,m){if(r!==null){var y=r.memoizedProps;if(Lu(y,h)&&r.ref===i.ref)if(qs=!1,i.pendingProps=h=y,Og(r,m))(r.flags&131072)!==0&&(qs=!0);else return i.lanes=r.lanes,pa(r,i,m)}return Cg(r,i,l,h,m)}function kx(r,i,l,h){var m=h.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,r!==null){for(h=i.child=r.child,m=0;h!==null;)m=m|h.lanes|h.childLanes,h=h.sibling;h=m&~y}else h=0,i.child=null;return Sx(r,i,y,l,h)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Gd(i,y!==null?y.cachePool:null),y!==null?N1(i,y):og(),A1(i);else return h=i.lanes=536870912,Sx(r,i,y!==null?y.baseLanes|l:l,l,h)}else y!==null?(Gd(i,y.cachePool),N1(i,y),to(),i.memoizedState=null):(r!==null&&Gd(i,null),og(),to());return fr(r,i,m,l),i.child}function Xu(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Sx(r,i,l,h,m){var y=tg();return y=y===null?null:{parent:Fs._currentValue,pool:y},i.memoizedState={baseLanes:l,cachePool:y},r!==null&&Gd(i,null),og(),A1(i),r!==null&&uc(r,i,h,!0),i.childLanes=m,null}function uf(r,i){return i=df({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function jx(r,i,l){return ul(i,r.child,null,l),r=uf(i,i.pendingProps),r.flags|=2,Kr(i),i.memoizedState=null,r}function ON(r,i,l){var h=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(Nn){if(h.mode==="hidden")return r=uf(i,h),i.lanes=536870912,Xu(null,r);if(cg(i),(r=hs)?(r=B_(r,fi),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ga!==null?{id:Ui,overflow:Fi}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,hs=null)):r=null,r===null)throw Qa(i);return i.lanes=536870912,null}return uf(i,h)}var y=r.memoizedState;if(y!==null){var w=y.dehydrated;if(cg(i),m)if(i.flags&256)i.flags&=-257,i=jx(r,i,l);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(qs||uc(r,i,l,!1),m=(l&r.childLanes)!==0,qs||m){if(h=is,h!==null&&(w=On(h,l),w!==0&&w!==y.retryLane))throw y.retryLane=w,nl(r,w),Br(h,r,w),Rg;_f(),i=jx(r,i,l)}else r=y.treeContext,hs=pi(w.nextSibling),hr=i,Nn=!0,Ka=null,fi=!1,r!==null&&f1(i,r),i=uf(i,h),i.flags|=4096;return i}return r=ca(r.child,{mode:h.mode,children:h.children}),r.ref=i.ref,i.child=r,r.return=i,r}function hf(r,i){var l=i.ref;if(l===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(r===null||r.ref!==l)&&(i.flags|=4194816)}}function Cg(r,i,l,h,m){return al(i),l=hg(r,i,l,h,void 0,m),h=dg(),r!==null&&!qs?(fg(r,i,m),pa(r,i,m)):(Nn&&h&&Wp(i),i.flags|=1,fr(r,i,l,m),i.child)}function Nx(r,i,l,h,m,y){return al(i),i.updateQueue=null,l=C1(i,h,l,m),R1(r),h=dg(),r!==null&&!qs?(fg(r,i,y),pa(r,i,y)):(Nn&&h&&Wp(i),i.flags|=1,fr(r,i,l,y),i.child)}function Ax(r,i,l,h,m){if(al(i),i.stateNode===null){var y=ac,w=l.contextType;typeof w=="object"&&w!==null&&(y=dr(w)),y=new l(h,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ng,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=h,y.state=i.memoizedState,y.refs={},sg(i),w=l.contextType,y.context=typeof w=="object"&&w!==null?dr(w):ac,y.state=i.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(jg(i,l,w,h),y.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Ng.enqueueReplaceState(y,y.state,null),Wu(i,h,y,m),$u(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(r===null){y=i.stateNode;var j=i.memoizedProps,F=dl(l,j);y.props=F;var le=y.context,je=l.contextType;w=ac,typeof je=="object"&&je!==null&&(w=dr(je));var Ie=l.getDerivedStateFromProps;je=typeof Ie=="function"||typeof y.getSnapshotBeforeUpdate=="function",j=i.pendingProps!==j,je||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(j||le!==w)&&px(i,y,h,w),Xa=!1;var ue=i.memoizedState;y.state=ue,Wu(i,h,y,m),$u(),le=i.memoizedState,j||ue!==le||Xa?(typeof Ie=="function"&&(jg(i,l,Ie,h),le=i.memoizedState),(F=Xa||mx(i,l,F,h,ue,le,w))?(je||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=le),y.props=h,y.state=le,y.context=w,h=F):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{y=i.stateNode,rg(r,i),w=i.memoizedProps,je=dl(l,w),y.props=je,Ie=i.pendingProps,ue=y.context,le=l.contextType,F=ac,typeof le=="object"&&le!==null&&(F=dr(le)),j=l.getDerivedStateFromProps,(le=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==Ie||ue!==F)&&px(i,y,h,F),Xa=!1,ue=i.memoizedState,y.state=ue,Wu(i,h,y,m),$u();var ge=i.memoizedState;w!==Ie||ue!==ge||Xa||r!==null&&r.dependencies!==null&&$d(r.dependencies)?(typeof j=="function"&&(jg(i,l,j,h),ge=i.memoizedState),(je=Xa||mx(i,l,je,h,ue,ge,F)||r!==null&&r.dependencies!==null&&$d(r.dependencies))?(le||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,ge,F),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,ge,F)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=ge),y.props=h,y.state=ge,y.context=F,h=je):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),h=!1)}return y=h,hf(r,i),h=(i.flags&128)!==0,y||h?(y=i.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&h?(i.child=ul(i,r.child,null,m),i.child=ul(i,null,l,m)):fr(r,i,l,m),i.memoizedState=y.state,r=i.child):r=pa(r,i,m),r}function Rx(r,i,l,h){return rl(),i.flags|=256,fr(r,i,l,h),i.child}var Ig={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dg(r){return{baseLanes:r,cachePool:v1()}}function Pg(r,i,l){return r=r!==null?r.childLanes&~l:0,i&&(r|=Yr),r}function Cx(r,i,l){var h=i.pendingProps,m=!1,y=(i.flags&128)!==0,w;if((w=y)||(w=r!==null&&r.memoizedState===null?!1:(Ds.current&2)!==0),w&&(m=!0,i.flags&=-129),w=(i.flags&32)!==0,i.flags&=-33,r===null){if(Nn){if(m?eo(i):to(),(r=hs)?(r=B_(r,fi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ga!==null?{id:Ui,overflow:Fi}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,hs=null)):r=null,r===null)throw Qa(i);return gy(r)?i.lanes=32:i.lanes=536870912,null}var j=h.children;return h=h.fallback,m?(to(),m=i.mode,j=df({mode:"hidden",children:j},m),h=sl(h,m,l,null),j.return=i,h.return=i,j.sibling=h,i.child=j,h=i.child,h.memoizedState=Dg(l),h.childLanes=Pg(r,w,l),i.memoizedState=Ig,Xu(null,h)):(eo(i),Mg(i,j))}var F=r.memoizedState;if(F!==null&&(j=F.dehydrated,j!==null)){if(y)i.flags&256?(eo(i),i.flags&=-257,i=Lg(r,i,l)):i.memoizedState!==null?(to(),i.child=r.child,i.flags|=128,i=null):(to(),j=h.fallback,m=i.mode,h=df({mode:"visible",children:h.children},m),j=sl(j,m,l,null),j.flags|=2,h.return=i,j.return=i,h.sibling=j,i.child=h,ul(i,r.child,null,l),h=i.child,h.memoizedState=Dg(l),h.childLanes=Pg(r,w,l),i.memoizedState=Ig,i=Xu(null,h));else if(eo(i),gy(j)){if(w=j.nextSibling&&j.nextSibling.dataset,w)var le=w.dgst;w=le,h=Error(s(419)),h.stack="",h.digest=w,Bu({value:h,source:null,stack:null}),i=Lg(r,i,l)}else if(qs||uc(r,i,l,!1),w=(l&r.childLanes)!==0,qs||w){if(w=is,w!==null&&(h=On(w,l),h!==0&&h!==F.retryLane))throw F.retryLane=h,nl(r,h),Br(w,r,h),Rg;py(j)||_f(),i=Lg(r,i,l)}else py(j)?(i.flags|=192,i.child=r.child,i=null):(r=F.treeContext,hs=pi(j.nextSibling),hr=i,Nn=!0,Ka=null,fi=!1,r!==null&&f1(i,r),i=Mg(i,h.children),i.flags|=4096);return i}return m?(to(),j=h.fallback,m=i.mode,F=r.child,le=F.sibling,h=ca(F,{mode:"hidden",children:h.children}),h.subtreeFlags=F.subtreeFlags&65011712,le!==null?j=ca(le,j):(j=sl(j,m,l,null),j.flags|=2),j.return=i,h.return=i,h.sibling=j,i.child=h,Xu(null,h),h=i.child,j=r.child.memoizedState,j===null?j=Dg(l):(m=j.cachePool,m!==null?(F=Fs._currentValue,m=m.parent!==F?{parent:F,pool:F}:m):m=v1(),j={baseLanes:j.baseLanes|l,cachePool:m}),h.memoizedState=j,h.childLanes=Pg(r,w,l),i.memoizedState=Ig,Xu(r.child,h)):(eo(i),l=r.child,r=l.sibling,l=ca(l,{mode:"visible",children:h.children}),l.return=i,l.sibling=null,r!==null&&(w=i.deletions,w===null?(i.deletions=[r],i.flags|=16):w.push(r)),i.child=l,i.memoizedState=null,l)}function Mg(r,i){return i=df({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function df(r,i){return r=Wr(22,r,null,i),r.lanes=0,r}function Lg(r,i,l){return ul(i,r.child,null,l),r=Mg(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Ix(r,i,l){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),Xp(r.return,i,l)}function Vg(r,i,l,h,m,y){var w=r.memoizedState;w===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:m,treeForkCount:y}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=l,w.tailMode=m,w.treeForkCount=y)}function Dx(r,i,l){var h=i.pendingProps,m=h.revealOrder,y=h.tail;h=h.children;var w=Ds.current,j=(w&2)!==0;if(j?(w=w&1|2,i.flags|=128):w&=1,we(Ds,w),fr(r,i,h,l),h=Nn?Ou:0,!j&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Ix(r,l,i);else if(r.tag===19)Ix(r,l,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(l=i.child,m=null;l!==null;)r=l.alternate,r!==null&&Zd(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=i.child,i.child=null):(m=l.sibling,l.sibling=null),Vg(i,!1,m,l,y,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=i.child,i.child=null;m!==null;){if(r=m.alternate,r!==null&&Zd(r)===null){i.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}Vg(i,!0,l,null,y,h);break;case"together":Vg(i,!1,null,null,void 0,h);break;default:i.memoizedState=null}return i.child}function pa(r,i,l){if(r!==null&&(i.dependencies=r.dependencies),ro|=i.lanes,(l&i.childLanes)===0)if(r!==null){if(uc(r,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,l=ca(r,r.pendingProps),i.child=l,l.return=i;r.sibling!==null;)r=r.sibling,l=l.sibling=ca(r,r.pendingProps),l.return=i;l.sibling=null}return i.child}function Og(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&$d(r)))}function BN(r,i,l){switch(i.tag){case 3:gt(i,i.stateNode.containerInfo),Ya(i,Fs,r.memoizedState.cache),rl();break;case 27:case 5:Ft(i);break;case 4:gt(i,i.stateNode.containerInfo);break;case 10:Ya(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,cg(i),null;break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(eo(i),i.flags|=128,null):(l&i.child.childLanes)!==0?Cx(r,i,l):(eo(i),r=pa(r,i,l),r!==null?r.sibling:null);eo(i);break;case 19:var m=(r.flags&128)!==0;if(h=(l&i.childLanes)!==0,h||(uc(r,i,l,!1),h=(l&i.childLanes)!==0),m){if(h)return Dx(r,i,l);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),we(Ds,Ds.current),h)break;return null;case 22:return i.lanes=0,kx(r,i,l,i.pendingProps);case 24:Ya(i,Fs,r.memoizedState.cache)}return pa(r,i,l)}function Px(r,i,l){if(r!==null)if(r.memoizedProps!==i.pendingProps)qs=!0;else{if(!Og(r,l)&&(i.flags&128)===0)return qs=!1,BN(r,i,l);qs=(r.flags&131072)!==0}else qs=!1,Nn&&(i.flags&1048576)!==0&&d1(i,Ou,i.index);switch(i.lanes=0,i.tag){case 16:e:{var h=i.pendingProps;if(r=ll(i.elementType),i.type=r,typeof r=="function")qp(r)?(h=dl(r,h),i.tag=1,i=Ax(null,i,r,h,l)):(i.tag=0,i=Cg(null,i,r,h,l));else{if(r!=null){var m=r.$$typeof;if(m===he){i.tag=11,i=wx(null,i,r,h,l);break e}else if(m===C){i.tag=14,i=Tx(null,i,r,h,l);break e}}throw i=We(r)||r,Error(s(306,i,""))}}return i;case 0:return Cg(r,i,i.type,i.pendingProps,l);case 1:return h=i.type,m=dl(h,i.pendingProps),Ax(r,i,h,m,l);case 3:e:{if(gt(i,i.stateNode.containerInfo),r===null)throw Error(s(387));h=i.pendingProps;var y=i.memoizedState;m=y.element,rg(r,i),Wu(i,h,null,l);var w=i.memoizedState;if(h=w.cache,Ya(i,Fs,h),h!==y.cache&&Jp(i,[Fs],l,!0),$u(),h=w.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:w.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=Rx(r,i,h,l);break e}else if(h!==m){m=ui(Error(s(424)),i),Bu(m),i=Rx(r,i,h,l);break e}else for(r=i.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,hs=pi(r.firstChild),hr=i,Nn=!0,Ka=null,fi=!0,l=k1(i,null,h,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(rl(),h===m){i=pa(r,i,l);break e}fr(r,i,h,l)}i=i.child}return i;case 26:return hf(r,i),r===null?(l=$_(i.type,null,i.pendingProps,null))?i.memoizedState=l:Nn||(l=i.type,r=i.pendingProps,h=Nf(Pe.current).createElement(l),h[rt]=i,h[Dt]=r,mr(h,l,r),A(h),i.stateNode=h):i.memoizedState=$_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return Ft(i),r===null&&Nn&&(h=i.stateNode=z_(i.type,i.pendingProps,Pe.current),hr=i,fi=!0,m=hs,co(i.type)?(yy=m,hs=pi(h.firstChild)):hs=m),fr(r,i,i.pendingProps.children,l),hf(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&Nn&&((m=h=hs)&&(h=pA(h,i.type,i.pendingProps,fi),h!==null?(i.stateNode=h,hr=i,hs=pi(h.firstChild),fi=!1,m=!0):m=!1),m||Qa(i)),Ft(i),m=i.type,y=i.pendingProps,w=r!==null?r.memoizedProps:null,h=y.children,dy(m,y)?h=null:w!==null&&dy(m,w)&&(i.flags|=32),i.memoizedState!==null&&(m=hg(r,i,RN,null,null,l),dh._currentValue=m),hf(r,i),fr(r,i,h,l),i.child;case 6:return r===null&&Nn&&((r=l=hs)&&(l=gA(l,i.pendingProps,fi),l!==null?(i.stateNode=l,hr=i,hs=null,r=!0):r=!1),r||Qa(i)),null;case 13:return Cx(r,i,l);case 4:return gt(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=ul(i,null,h,l):fr(r,i,h,l),i.child;case 11:return wx(r,i,i.type,i.pendingProps,l);case 7:return fr(r,i,i.pendingProps,l),i.child;case 8:return fr(r,i,i.pendingProps.children,l),i.child;case 12:return fr(r,i,i.pendingProps.children,l),i.child;case 10:return h=i.pendingProps,Ya(i,i.type,h.value),fr(r,i,h.children,l),i.child;case 9:return m=i.type._context,h=i.pendingProps.children,al(i),m=dr(m),h=h(m),i.flags|=1,fr(r,i,h,l),i.child;case 14:return Tx(r,i,i.type,i.pendingProps,l);case 15:return Ex(r,i,i.type,i.pendingProps,l);case 19:return Dx(r,i,l);case 31:return ON(r,i,l);case 22:return kx(r,i,l,i.pendingProps);case 24:return al(i),h=dr(Fs),r===null?(m=tg(),m===null&&(m=is,y=Zp(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=l),m=y),i.memoizedState={parent:h,cache:m},sg(i),Ya(i,Fs,m)):((r.lanes&l)!==0&&(rg(r,i),Wu(i,null,null,l),$u()),m=r.memoizedState,y=i.memoizedState,m.parent!==h?(m={parent:h,cache:h},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Ya(i,Fs,h)):(h=y.cache,Ya(i,Fs,h),h!==m.cache&&Jp(i,[Fs],l,!0))),fr(r,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function ga(r){r.flags|=4}function Bg(r,i,l,h,m){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(o_())r.flags|=8192;else throw cl=Qd,ng}else r.flags&=-16777217}function Mx(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Y_(i))if(o_())r.flags|=8192;else throw cl=Qd,ng}function ff(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Jt():536870912,r.lanes|=i,wc|=i)}function Ju(r,i){if(!Nn)switch(r.tailMode){case"hidden":i=r.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function ds(r){var i=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(i)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags&65011712,h|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=h,r.childLanes=l,i}function UN(r,i,l){var h=i.pendingProps;switch(Gp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(i),null;case 1:return ds(i),null;case 3:return l=i.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),da(Fs),nt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(cc(i)?ga(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Qp())),ds(i),null;case 26:var m=i.type,y=i.memoizedState;return r===null?(ga(i),y!==null?(ds(i),Mx(i,y)):(ds(i),Bg(i,m,null,h,l))):y?y!==r.memoizedState?(ga(i),ds(i),Mx(i,y)):(ds(i),i.flags&=-16777217):(r=r.memoizedProps,r!==h&&ga(i),ds(i),Bg(i,m,r,h,l)),null;case 27:if(Pn(i),l=Pe.current,m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==h&&ga(i);else{if(!h){if(i.stateNode===null)throw Error(s(166));return ds(i),null}r=Ae.current,cc(i)?m1(i):(r=z_(m,h,l),i.stateNode=r,ga(i))}return ds(i),null;case 5:if(Pn(i),m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==h&&ga(i);else{if(!h){if(i.stateNode===null)throw Error(s(166));return ds(i),null}if(y=Ae.current,cc(i))m1(i);else{var w=Nf(Pe.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof h.is=="string"?w.createElement("select",{is:h.is}):w.createElement("select"),h.multiple?y.multiple=!0:h.size&&(y.size=h.size);break;default:y=typeof h.is=="string"?w.createElement(m,{is:h.is}):w.createElement(m)}}y[rt]=i,y[Dt]=h;e:for(w=i.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===i)break e;for(;w.sibling===null;){if(w.return===null||w.return===i)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}i.stateNode=y;e:switch(mr(y,m,h),m){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ga(i)}}return ds(i),Bg(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,l),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==h&&ga(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(s(166));if(r=Pe.current,cc(i)){if(r=i.stateNode,l=i.memoizedProps,h=null,m=hr,m!==null)switch(m.tag){case 27:case 5:h=m.memoizedProps}r[rt]=i,r=!!(r.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||C_(r.nodeValue,l)),r||Qa(i,!0)}else r=Nf(r).createTextNode(h),r[rt]=i,i.stateNode=r}return ds(i),null;case 31:if(l=i.memoizedState,r===null||r.memoizedState!==null){if(h=cc(i),l!==null){if(r===null){if(!h)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[rt]=i}else rl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ds(i),r=!1}else l=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return i.flags&256?(Kr(i),i):(Kr(i),null);if((i.flags&128)!==0)throw Error(s(558))}return ds(i),null;case 13:if(h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=cc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!m)throw Error(s(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[rt]=i}else rl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ds(i),m=!1}else m=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Kr(i),i):(Kr(i),null)}return Kr(i),(i.flags&128)!==0?(i.lanes=l,i):(l=h!==null,r=r!==null&&r.memoizedState!==null,l&&(h=i.child,m=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(m=h.alternate.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==m&&(h.flags|=2048)),l!==r&&l&&(i.child.flags|=8192),ff(i,i.updateQueue),ds(i),null);case 4:return nt(),r===null&&oy(i.stateNode.containerInfo),ds(i),null;case 10:return da(i.type),ds(i),null;case 19:if(K(Ds),h=i.memoizedState,h===null)return ds(i),null;if(m=(i.flags&128)!==0,y=h.rendering,y===null)if(m)Ju(h,!1);else{if(js!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=Zd(r),y!==null){for(i.flags|=128,Ju(h,!1),r=y.updateQueue,i.updateQueue=r,ff(i,r),i.subtreeFlags=0,r=l,l=i.child;l!==null;)c1(l,r),l=l.sibling;return we(Ds,Ds.current&1|2),Nn&&ua(i,h.treeForkCount),i.child}r=r.sibling}h.tail!==null&&ln()>bf&&(i.flags|=128,m=!0,Ju(h,!1),i.lanes=4194304)}else{if(!m)if(r=Zd(y),r!==null){if(i.flags|=128,m=!0,r=r.updateQueue,i.updateQueue=r,ff(i,r),Ju(h,!0),h.tail===null&&h.tailMode==="hidden"&&!y.alternate&&!Nn)return ds(i),null}else 2*ln()-h.renderingStartTime>bf&&l!==536870912&&(i.flags|=128,m=!0,Ju(h,!1),i.lanes=4194304);h.isBackwards?(y.sibling=i.child,i.child=y):(r=h.last,r!==null?r.sibling=y:i.child=y,h.last=y)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=ln(),r.sibling=null,l=Ds.current,we(Ds,m?l&1|2:l&1),Nn&&ua(i,h.treeForkCount),r):(ds(i),null);case 22:case 23:return Kr(i),lg(),h=i.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(l&536870912)!==0&&(i.flags&128)===0&&(ds(i),i.subtreeFlags&6&&(i.flags|=8192)):ds(i),l=i.updateQueue,l!==null&&ff(i,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==l&&(i.flags|=2048),r!==null&&K(ol),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),da(Fs),ds(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function FN(r,i){switch(Gp(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return da(Fs),nt(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return Pn(i),null;case 31:if(i.memoizedState!==null){if(Kr(i),i.alternate===null)throw Error(s(340));rl()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(Kr(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));rl()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return K(Ds),null;case 4:return nt(),null;case 10:return da(i.type),null;case 22:case 23:return Kr(i),lg(),r!==null&&K(ol),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return da(Fs),null;case 25:return null;default:return null}}function Lx(r,i){switch(Gp(i),i.tag){case 3:da(Fs),nt();break;case 26:case 27:case 5:Pn(i);break;case 4:nt();break;case 31:i.memoizedState!==null&&Kr(i);break;case 13:Kr(i);break;case 19:K(Ds);break;case 10:da(i.type);break;case 22:case 23:Kr(i),lg(),r!==null&&K(ol);break;case 24:da(Fs)}}function Zu(r,i){try{var l=i.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var m=h.next;l=m;do{if((l.tag&r)===r){h=void 0;var y=l.create,w=l.inst;h=y(),w.destroy=h}l=l.next}while(l!==m)}}catch(j){Gn(i,i.return,j)}}function no(r,i,l){try{var h=i.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var y=m.next;h=y;do{if((h.tag&r)===r){var w=h.inst,j=w.destroy;if(j!==void 0){w.destroy=void 0,m=i;var F=l,le=j;try{le()}catch(je){Gn(m,F,je)}}}h=h.next}while(h!==y)}}catch(je){Gn(i,i.return,je)}}function Vx(r){var i=r.updateQueue;if(i!==null){var l=r.stateNode;try{j1(i,l)}catch(h){Gn(r,r.return,h)}}}function Ox(r,i,l){l.props=dl(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(h){Gn(r,i,h)}}function eh(r,i){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof l=="function"?r.refCleanup=l(h):l.current=h}}catch(m){Gn(r,i,m)}}function zi(r,i){var l=r.ref,h=r.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(m){Gn(r,i,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Gn(r,i,m)}else l.current=null}function Bx(r){var i=r.type,l=r.memoizedProps,h=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break e;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(m){Gn(r,r.return,m)}}function Ug(r,i,l){try{var h=r.stateNode;cA(h,r.type,l,i),h[Dt]=i}catch(m){Gn(r,r.return,m)}}function Ux(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&co(r.type)||r.tag===4}function Fg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ux(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&co(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function zg(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(r),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=ls));else if(h!==4&&(h===27&&co(r.type)&&(l=r.stateNode,i=null),r=r.child,r!==null))for(zg(r,i,l),r=r.sibling;r!==null;)zg(r,i,l),r=r.sibling}function mf(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?l.insertBefore(r,i):l.appendChild(r);else if(h!==4&&(h===27&&co(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(mf(r,i,l),r=r.sibling;r!==null;)mf(r,i,l),r=r.sibling}function Fx(r){var i=r.stateNode,l=r.memoizedProps;try{for(var h=r.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);mr(i,h,l),i[rt]=r,i[Dt]=l}catch(y){Gn(r,r.return,y)}}var ya=!1,Hs=!1,qg=!1,zx=typeof WeakSet=="function"?WeakSet:Set,nr=null;function zN(r,i){if(r=r.containerInfo,uy=Mf,r=e1(r),Lp(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var w=0,j=-1,F=-1,le=0,je=0,Ie=r,ue=null;t:for(;;){for(var ge;Ie!==l||m!==0&&Ie.nodeType!==3||(j=w+m),Ie!==y||h!==0&&Ie.nodeType!==3||(F=w+h),Ie.nodeType===3&&(w+=Ie.nodeValue.length),(ge=Ie.firstChild)!==null;)ue=Ie,Ie=ge;for(;;){if(Ie===r)break t;if(ue===l&&++le===m&&(j=w),ue===y&&++je===h&&(F=w),(ge=Ie.nextSibling)!==null)break;Ie=ue,ue=Ie.parentNode}Ie=ge}l=j===-1||F===-1?null:{start:j,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(hy={focusedElem:r,selectionRange:l},Mf=!1,nr=i;nr!==null;)if(i=nr,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,nr=r;else for(;nr!==null;){switch(i=nr,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)m=r[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=i,m=y.memoizedProps,y=y.memoizedState,h=l.stateNode;try{var ft=dl(l.type,m);r=h.getSnapshotBeforeUpdate(ft,y),h.__reactInternalSnapshotBeforeUpdate=r}catch(Pt){Gn(l,l.return,Pt)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,l=r.nodeType,l===9)my(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":my(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,nr=r;break}nr=i.return}}function qx(r,i,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:va(r,l),h&4&&Zu(5,l);break;case 1:if(va(r,l),h&4)if(r=l.stateNode,i===null)try{r.componentDidMount()}catch(w){Gn(l,l.return,w)}else{var m=dl(l.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(m,i,r.__reactInternalSnapshotBeforeUpdate)}catch(w){Gn(l,l.return,w)}}h&64&&Vx(l),h&512&&eh(l,l.return);break;case 3:if(va(r,l),h&64&&(r=l.updateQueue,r!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{j1(r,i)}catch(w){Gn(l,l.return,w)}}break;case 27:i===null&&h&4&&Fx(l);case 26:case 5:va(r,l),i===null&&h&4&&Bx(l),h&512&&eh(l,l.return);break;case 12:va(r,l);break;case 31:va(r,l),h&4&&Wx(r,l);break;case 13:va(r,l),h&4&&Gx(r,l),h&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=XN.bind(null,l),yA(r,l))));break;case 22:if(h=l.memoizedState!==null||ya,!h){i=i!==null&&i.memoizedState!==null||Hs,m=ya;var y=Hs;ya=h,(Hs=i)&&!y?xa(r,l,(l.subtreeFlags&8772)!==0):va(r,l),ya=m,Hs=y}break;case 30:break;default:va(r,l)}}function Hx(r){var i=r.alternate;i!==null&&(r.alternate=null,Hx(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&Zs(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var gs=null,Mr=!1;function ba(r,i,l){for(l=l.child;l!==null;)$x(r,i,l),l=l.sibling}function $x(r,i,l){if(Ue&&typeof Ue.onCommitFiberUnmount=="function")try{Ue.onCommitFiberUnmount(et,l)}catch{}switch(l.tag){case 26:Hs||zi(l,i),ba(r,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Hs||zi(l,i);var h=gs,m=Mr;co(l.type)&&(gs=l.stateNode,Mr=!1),ba(r,i,l),ch(l.stateNode),gs=h,Mr=m;break;case 5:Hs||zi(l,i);case 6:if(h=gs,m=Mr,gs=null,ba(r,i,l),gs=h,Mr=m,gs!==null)if(Mr)try{(gs.nodeType===9?gs.body:gs.nodeName==="HTML"?gs.ownerDocument.body:gs).removeChild(l.stateNode)}catch(y){Gn(l,i,y)}else try{gs.removeChild(l.stateNode)}catch(y){Gn(l,i,y)}break;case 18:gs!==null&&(Mr?(r=gs,V_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Rc(r)):V_(gs,l.stateNode));break;case 4:h=gs,m=Mr,gs=l.stateNode.containerInfo,Mr=!0,ba(r,i,l),gs=h,Mr=m;break;case 0:case 11:case 14:case 15:no(2,l,i),Hs||no(4,l,i),ba(r,i,l);break;case 1:Hs||(zi(l,i),h=l.stateNode,typeof h.componentWillUnmount=="function"&&Ox(l,i,h)),ba(r,i,l);break;case 21:ba(r,i,l);break;case 22:Hs=(h=Hs)||l.memoizedState!==null,ba(r,i,l),Hs=h;break;default:ba(r,i,l)}}function Wx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Rc(r)}catch(l){Gn(i,i.return,l)}}}function Gx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Rc(r)}catch(l){Gn(i,i.return,l)}}function qN(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new zx),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new zx),i;default:throw Error(s(435,r.tag))}}function pf(r,i){var l=qN(r);i.forEach(function(h){if(!l.has(h)){l.add(h);var m=JN.bind(null,r,h);h.then(m,m)}})}function Lr(r,i){var l=i.deletions;if(l!==null)for(var h=0;h<l.length;h++){var m=l[h],y=r,w=i,j=w;e:for(;j!==null;){switch(j.tag){case 27:if(co(j.type)){gs=j.stateNode,Mr=!1;break e}break;case 5:gs=j.stateNode,Mr=!1;break e;case 3:case 4:gs=j.stateNode.containerInfo,Mr=!0;break e}j=j.return}if(gs===null)throw Error(s(160));$x(y,w,m),gs=null,Mr=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Kx(i,r),i=i.sibling}var Si=null;function Kx(r,i){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Lr(i,r),Vr(r),h&4&&(no(3,r,r.return),Zu(3,r),no(5,r,r.return));break;case 1:Lr(i,r),Vr(r),h&512&&(Hs||l===null||zi(l,l.return)),h&64&&ya&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var m=Si;if(Lr(i,r),Vr(r),h&512&&(Hs||l===null||zi(l,l.return)),h&4){var y=l!==null?l.memoizedState:null;if(h=r.memoizedState,l===null)if(h===null)if(r.stateNode===null){e:{h=r.type,l=r.memoizedProps,m=m.ownerDocument||m;t:switch(h){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Gs]||y[rt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(h),m.head.insertBefore(y,m.querySelector("head > title"))),mr(y,h,l),y[rt]=r,A(y),h=y;break e;case"link":var w=K_("link","href",m).get(h+(l.href||""));if(w){for(var j=0;j<w.length;j++)if(y=w[j],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(j,1);break t}}y=m.createElement(h),mr(y,h,l),m.head.appendChild(y);break;case"meta":if(w=K_("meta","content",m).get(h+(l.content||""))){for(j=0;j<w.length;j++)if(y=w[j],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(j,1);break t}}y=m.createElement(h),mr(y,h,l),m.head.appendChild(y);break;default:throw Error(s(468,h))}y[rt]=r,A(y),h=y}r.stateNode=h}else Q_(m,r.type,r.stateNode);else r.stateNode=G_(m,h,r.memoizedProps);else y!==h?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,h===null?Q_(m,r.type,r.stateNode):G_(m,h,r.memoizedProps)):h===null&&r.stateNode!==null&&Ug(r,r.memoizedProps,l.memoizedProps)}break;case 27:Lr(i,r),Vr(r),h&512&&(Hs||l===null||zi(l,l.return)),l!==null&&h&4&&Ug(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Lr(i,r),Vr(r),h&512&&(Hs||l===null||zi(l,l.return)),r.flags&32){m=r.stateNode;try{Es(m,"")}catch(ft){Gn(r,r.return,ft)}}h&4&&r.stateNode!=null&&(m=r.memoizedProps,Ug(r,m,l!==null?l.memoizedProps:m)),h&1024&&(qg=!0);break;case 6:if(Lr(i,r),Vr(r),h&4){if(r.stateNode===null)throw Error(s(162));h=r.memoizedProps,l=r.stateNode;try{l.nodeValue=h}catch(ft){Gn(r,r.return,ft)}}break;case 3:if(Cf=null,m=Si,Si=Af(i.containerInfo),Lr(i,r),Si=m,Vr(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Rc(i.containerInfo)}catch(ft){Gn(r,r.return,ft)}qg&&(qg=!1,Qx(r));break;case 4:h=Si,Si=Af(r.stateNode.containerInfo),Lr(i,r),Vr(r),Si=h;break;case 12:Lr(i,r),Vr(r);break;case 31:Lr(i,r),Vr(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,pf(r,h)));break;case 13:Lr(i,r),Vr(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(yf=ln()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,pf(r,h)));break;case 22:m=r.memoizedState!==null;var F=l!==null&&l.memoizedState!==null,le=ya,je=Hs;if(ya=le||m,Hs=je||F,Lr(i,r),Hs=je,ya=le,Vr(r),h&8192)e:for(i=r.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(l===null||F||ya||Hs||fl(r)),l=null,i=r;;){if(i.tag===5||i.tag===26){if(l===null){F=l=i;try{if(y=F.stateNode,m)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{j=F.stateNode;var Ie=F.memoizedProps.style,ue=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;j.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(ft){Gn(F,F.return,ft)}}}else if(i.tag===6){if(l===null){F=i;try{F.stateNode.nodeValue=m?"":F.memoizedProps}catch(ft){Gn(F,F.return,ft)}}}else if(i.tag===18){if(l===null){F=i;try{var ge=F.stateNode;m?O_(ge,!0):O_(F.stateNode,!1)}catch(ft){Gn(F,F.return,ft)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=r.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,pf(r,l))));break;case 19:Lr(i,r),Vr(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,pf(r,h)));break;case 30:break;case 21:break;default:Lr(i,r),Vr(r)}}function Vr(r){var i=r.flags;if(i&2){try{for(var l,h=r.return;h!==null;){if(Ux(h)){l=h;break}h=h.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var m=l.stateNode,y=Fg(r);mf(r,y,m);break;case 5:var w=l.stateNode;l.flags&32&&(Es(w,""),l.flags&=-33);var j=Fg(r);mf(r,j,w);break;case 3:case 4:var F=l.stateNode.containerInfo,le=Fg(r);zg(r,le,F);break;default:throw Error(s(161))}}catch(je){Gn(r,r.return,je)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Qx(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Qx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function va(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)qx(r,i.alternate,i),i=i.sibling}function fl(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:no(4,i,i.return),fl(i);break;case 1:zi(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&Ox(i,i.return,l),fl(i);break;case 27:ch(i.stateNode);case 26:case 5:zi(i,i.return),fl(i);break;case 22:i.memoizedState===null&&fl(i);break;case 30:fl(i);break;default:fl(i)}r=r.sibling}}function xa(r,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,m=r,y=i,w=y.flags;switch(y.tag){case 0:case 11:case 15:xa(m,y,l),Zu(4,y);break;case 1:if(xa(m,y,l),h=y,m=h.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){Gn(h,h.return,le)}if(h=y,m=h.updateQueue,m!==null){var j=h.stateNode;try{var F=m.shared.hiddenCallbacks;if(F!==null)for(m.shared.hiddenCallbacks=null,m=0;m<F.length;m++)S1(F[m],j)}catch(le){Gn(h,h.return,le)}}l&&w&64&&Vx(y),eh(y,y.return);break;case 27:Fx(y);case 26:case 5:xa(m,y,l),l&&h===null&&w&4&&Bx(y),eh(y,y.return);break;case 12:xa(m,y,l);break;case 31:xa(m,y,l),l&&w&4&&Wx(m,y);break;case 13:xa(m,y,l),l&&w&4&&Gx(m,y);break;case 22:y.memoizedState===null&&xa(m,y,l),eh(y,y.return);break;case 30:break;default:xa(m,y,l)}i=i.sibling}}function Hg(r,i){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Uu(l))}function $g(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Uu(r))}function ji(r,i,l,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Yx(r,i,l,h),i=i.sibling}function Yx(r,i,l,h){var m=i.flags;switch(i.tag){case 0:case 11:case 15:ji(r,i,l,h),m&2048&&Zu(9,i);break;case 1:ji(r,i,l,h);break;case 3:ji(r,i,l,h),m&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Uu(r)));break;case 12:if(m&2048){ji(r,i,l,h),r=i.stateNode;try{var y=i.memoizedProps,w=y.id,j=y.onPostCommit;typeof j=="function"&&j(w,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){Gn(i,i.return,F)}}else ji(r,i,l,h);break;case 31:ji(r,i,l,h);break;case 13:ji(r,i,l,h);break;case 23:break;case 22:y=i.stateNode,w=i.alternate,i.memoizedState!==null?y._visibility&2?ji(r,i,l,h):th(r,i):y._visibility&2?ji(r,i,l,h):(y._visibility|=2,vc(r,i,l,h,(i.subtreeFlags&10256)!==0||!1)),m&2048&&Hg(w,i);break;case 24:ji(r,i,l,h),m&2048&&$g(i.alternate,i);break;default:ji(r,i,l,h)}}function vc(r,i,l,h,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,w=i,j=l,F=h,le=w.flags;switch(w.tag){case 0:case 11:case 15:vc(y,w,j,F,m),Zu(8,w);break;case 23:break;case 22:var je=w.stateNode;w.memoizedState!==null?je._visibility&2?vc(y,w,j,F,m):th(y,w):(je._visibility|=2,vc(y,w,j,F,m)),m&&le&2048&&Hg(w.alternate,w);break;case 24:vc(y,w,j,F,m),m&&le&2048&&$g(w.alternate,w);break;default:vc(y,w,j,F,m)}i=i.sibling}}function th(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=r,h=i,m=h.flags;switch(h.tag){case 22:th(l,h),m&2048&&Hg(h.alternate,h);break;case 24:th(l,h),m&2048&&$g(h.alternate,h);break;default:th(l,h)}i=i.sibling}}var nh=8192;function xc(r,i,l){if(r.subtreeFlags&nh)for(r=r.child;r!==null;)Xx(r,i,l),r=r.sibling}function Xx(r,i,l){switch(r.tag){case 26:xc(r,i,l),r.flags&nh&&r.memoizedState!==null&&AA(l,Si,r.memoizedState,r.memoizedProps);break;case 5:xc(r,i,l);break;case 3:case 4:var h=Si;Si=Af(r.stateNode.containerInfo),xc(r,i,l),Si=h;break;case 22:r.memoizedState===null&&(h=r.alternate,h!==null&&h.memoizedState!==null?(h=nh,nh=16777216,xc(r,i,l),nh=h):xc(r,i,l));break;default:xc(r,i,l)}}function Jx(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function sh(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var h=i[l];nr=h,e_(h,r)}Jx(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Zx(r),r=r.sibling}function Zx(r){switch(r.tag){case 0:case 11:case 15:sh(r),r.flags&2048&&no(9,r,r.return);break;case 3:sh(r);break;case 12:sh(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,gf(r)):sh(r);break;default:sh(r)}}function gf(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var h=i[l];nr=h,e_(h,r)}Jx(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:no(8,i,i.return),gf(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,gf(i));break;default:gf(i)}r=r.sibling}}function e_(r,i){for(;nr!==null;){var l=nr;switch(l.tag){case 0:case 11:case 15:no(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Uu(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,nr=h;else e:for(l=r;nr!==null;){h=nr;var m=h.sibling,y=h.return;if(Hx(h),h===l){nr=null;break e}if(m!==null){m.return=y,nr=m;break e}nr=y}}}var HN={getCacheForType:function(r){var i=dr(Fs),l=i.data.get(r);return l===void 0&&(l=r(),i.data.set(r,l)),l},cacheSignal:function(){return dr(Fs).controller.signal}},$N=typeof WeakMap=="function"?WeakMap:Map,Un=0,is=null,gn=null,wn=0,Wn=0,Qr=null,so=!1,_c=!1,Wg=!1,_a=0,js=0,ro=0,ml=0,Gg=0,Yr=0,wc=0,rh=null,Or=null,Kg=!1,yf=0,t_=0,bf=1/0,vf=null,io=null,Ys=0,ao=null,Tc=null,wa=0,Qg=0,Yg=null,n_=null,ih=0,Xg=null;function Xr(){return(Un&2)!==0&&wn!==0?wn&-wn:$.T!==null?sy():ke()}function s_(){if(Yr===0)if((wn&536870912)===0||Nn){var r=ee;ee<<=1,(ee&3932160)===0&&(ee=262144),Yr=r}else Yr=536870912;return r=Gr.current,r!==null&&(r.flags|=32),Yr}function Br(r,i,l){(r===is&&(Wn===2||Wn===9)||r.cancelPendingCommit!==null)&&(Ec(r,0),oo(r,wn,Yr,!1)),Fn(r,l),((Un&2)===0||r!==is)&&(r===is&&((Un&2)===0&&(ml|=l),js===4&&oo(r,wn,Yr,!1)),qi(r))}function r_(r,i,l){if((Un&6)!==0)throw Error(s(327));var h=!l&&(i&127)===0&&(i&r.expiredLanes)===0||It(r,i),m=h?KN(r,i):Zg(r,i,!0),y=h;do{if(m===0){_c&&!h&&oo(r,i,0,!1);break}else{if(l=r.current.alternate,y&&!WN(l)){m=Zg(r,i,!1),y=!1;continue}if(m===2){if(y=i,r.errorRecoveryDisabledLanes&y)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){i=w;e:{var j=r;m=rh;var F=j.current.memoizedState.isDehydrated;if(F&&(Ec(j,w).flags|=256),w=Zg(j,w,!1),w!==2){if(Wg&&!F){j.errorRecoveryDisabledLanes|=y,ml|=y,m=4;break e}y=Or,Or=m,y!==null&&(Or===null?Or=y:Or.push.apply(Or,y))}m=w}if(y=!1,m!==2)continue}}if(m===1){Ec(r,0),oo(r,i,0,!0);break}e:{switch(h=r,y=m,y){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:oo(h,i,Yr,!so);break e;case 2:Or=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(m=yf+300-ln(),10<m)){if(oo(h,i,Yr,!so),Ct(h,0,!0)!==0)break e;wa=i,h.timeoutHandle=M_(i_.bind(null,h,l,Or,vf,Kg,i,Yr,ml,wc,so,y,"Throttled",-0,0),m);break e}i_(h,l,Or,vf,Kg,i,Yr,ml,wc,so,y,null,-0,0)}}break}while(!0);qi(r)}function i_(r,i,l,h,m,y,w,j,F,le,je,Ie,ue,ge){if(r.timeoutHandle=-1,Ie=i.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},Xx(i,y,Ie);var ft=(y&62914560)===y?yf-ln():(y&4194048)===y?t_-ln():0;if(ft=RA(Ie,ft),ft!==null){wa=y,r.cancelPendingCommit=ft(f_.bind(null,r,i,y,l,h,m,w,j,F,je,Ie,null,ue,ge)),oo(r,y,w,!le);return}}f_(r,i,y,l,h,m,w,j,F)}function WN(r){for(var i=r;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var m=l[h],y=m.getSnapshot;m=m.value;try{if(!$r(y(),m))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function oo(r,i,l,h){i&=~Gg,i&=~ml,r.suspendedLanes|=i,r.pingedLanes&=~i,h&&(r.warmLanes|=i),h=r.expirationTimes;for(var m=i;0<m;){var y=31-ze(m),w=1<<y;h[y]=-1,m&=~w}l!==0&&pn(r,l,i)}function xf(){return(Un&6)===0?(ah(0),!1):!0}function Jg(){if(gn!==null){if(Wn===0)var r=gn.return;else r=gn,ha=il=null,mg(r),mc=null,zu=0,r=gn;for(;r!==null;)Lx(r.alternate,r),r=r.return;gn=null}}function Ec(r,i){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,dA(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),wa=0,Jg(),is=r,gn=l=ca(r.current,null),wn=i,Wn=0,Qr=null,so=!1,_c=It(r,i),Wg=!1,wc=Yr=Gg=ml=ro=js=0,Or=rh=null,Kg=!1,(i&8)!==0&&(i|=i&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=i;0<h;){var m=31-ze(h),y=1<<m;i|=r[m],h&=~y}return _a=i,Ud(),l}function a_(r,i){nn=null,$.H=Yu,i===fc||i===Kd?(i=w1(),Wn=3):i===ng?(i=w1(),Wn=4):Wn=i===Rg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Qr=i,gn===null&&(js=1,cf(r,ui(i,r.current)))}function o_(){var r=Gr.current;return r===null?!0:(wn&4194048)===wn?mi===null:(wn&62914560)===wn||(wn&536870912)!==0?r===mi:!1}function l_(){var r=$.H;return $.H=Yu,r===null?Yu:r}function c_(){var r=$.A;return $.A=HN,r}function _f(){js=4,so||(wn&4194048)!==wn&&Gr.current!==null||(_c=!0),(ro&134217727)===0&&(ml&134217727)===0||is===null||oo(is,wn,Yr,!1)}function Zg(r,i,l){var h=Un;Un|=2;var m=l_(),y=c_();(is!==r||wn!==i)&&(vf=null,Ec(r,i)),i=!1;var w=js;e:do try{if(Wn!==0&&gn!==null){var j=gn,F=Qr;switch(Wn){case 8:Jg(),w=6;break e;case 3:case 2:case 9:case 6:Gr.current===null&&(i=!0);var le=Wn;if(Wn=0,Qr=null,kc(r,j,F,le),l&&_c){w=0;break e}break;default:le=Wn,Wn=0,Qr=null,kc(r,j,F,le)}}GN(),w=js;break}catch(je){a_(r,je)}while(!0);return i&&r.shellSuspendCounter++,ha=il=null,Un=h,$.H=m,$.A=y,gn===null&&(is=null,wn=0,Ud()),w}function GN(){for(;gn!==null;)u_(gn)}function KN(r,i){var l=Un;Un|=2;var h=l_(),m=c_();is!==r||wn!==i?(vf=null,bf=ln()+500,Ec(r,i)):_c=It(r,i);e:do try{if(Wn!==0&&gn!==null){i=gn;var y=Qr;t:switch(Wn){case 1:Wn=0,Qr=null,kc(r,i,y,1);break;case 2:case 9:if(x1(y)){Wn=0,Qr=null,h_(i);break}i=function(){Wn!==2&&Wn!==9||is!==r||(Wn=7),qi(r)},y.then(i,i);break e;case 3:Wn=7;break e;case 4:Wn=5;break e;case 7:x1(y)?(Wn=0,Qr=null,h_(i)):(Wn=0,Qr=null,kc(r,i,y,7));break;case 5:var w=null;switch(gn.tag){case 26:w=gn.memoizedState;case 5:case 27:var j=gn;if(w?Y_(w):j.stateNode.complete){Wn=0,Qr=null;var F=j.sibling;if(F!==null)gn=F;else{var le=j.return;le!==null?(gn=le,wf(le)):gn=null}break t}}Wn=0,Qr=null,kc(r,i,y,5);break;case 6:Wn=0,Qr=null,kc(r,i,y,6);break;case 8:Jg(),js=6;break e;default:throw Error(s(462))}}QN();break}catch(je){a_(r,je)}while(!0);return ha=il=null,$.H=h,$.A=m,Un=l,gn!==null?0:(is=null,wn=0,Ud(),js)}function QN(){for(;gn!==null&&!Ts();)u_(gn)}function u_(r){var i=Px(r.alternate,r,_a);r.memoizedProps=r.pendingProps,i===null?wf(r):gn=i}function h_(r){var i=r,l=i.alternate;switch(i.tag){case 15:case 0:i=Nx(l,i,i.pendingProps,i.type,void 0,wn);break;case 11:i=Nx(l,i,i.pendingProps,i.type.render,i.ref,wn);break;case 5:mg(i);default:Lx(l,i),i=gn=c1(i,_a),i=Px(l,i,_a)}r.memoizedProps=r.pendingProps,i===null?wf(r):gn=i}function kc(r,i,l,h){ha=il=null,mg(i),mc=null,zu=0;var m=i.return;try{if(VN(r,m,i,l,wn)){js=1,cf(r,ui(l,r.current)),gn=null;return}}catch(y){if(m!==null)throw gn=m,y;js=1,cf(r,ui(l,r.current)),gn=null;return}i.flags&32768?(Nn||h===1?r=!0:_c||(wn&536870912)!==0?r=!1:(so=r=!0,(h===2||h===9||h===3||h===6)&&(h=Gr.current,h!==null&&h.tag===13&&(h.flags|=16384))),d_(i,r)):wf(i)}function wf(r){var i=r;do{if((i.flags&32768)!==0){d_(i,so);return}r=i.return;var l=UN(i.alternate,i,_a);if(l!==null){gn=l;return}if(i=i.sibling,i!==null){gn=i;return}gn=i=r}while(i!==null);js===0&&(js=5)}function d_(r,i){do{var l=FN(r.alternate,r);if(l!==null){l.flags&=32767,gn=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(r=r.sibling,r!==null)){gn=r;return}gn=r=l}while(r!==null);js=6,gn=null}function f_(r,i,l,h,m,y,w,j,F){r.cancelPendingCommit=null;do Tf();while(Ys!==0);if((Un&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(y=i.lanes|i.childLanes,y|=Fp,os(r,l,y,w,j,F),r===is&&(gn=is=null,wn=0),Tc=i,ao=r,wa=l,Qg=y,Yg=m,n_=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,ZN(cn,function(){return b_(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=$.T,$.T=null,m=ye.p,ye.p=2,w=Un,Un|=4;try{zN(r,i,l)}finally{Un=w,ye.p=m,$.T=h}}Ys=1,m_(),p_(),g_()}}function m_(){if(Ys===1){Ys=0;var r=ao,i=Tc,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=$.T,$.T=null;var h=ye.p;ye.p=2;var m=Un;Un|=4;try{Kx(i,r);var y=hy,w=e1(r.containerInfo),j=y.focusedElem,F=y.selectionRange;if(w!==j&&j&&j.ownerDocument&&Z0(j.ownerDocument.documentElement,j)){if(F!==null&&Lp(j)){var le=F.start,je=F.end;if(je===void 0&&(je=le),"selectionStart"in j)j.selectionStart=le,j.selectionEnd=Math.min(je,j.value.length);else{var Ie=j.ownerDocument||document,ue=Ie&&Ie.defaultView||window;if(ue.getSelection){var ge=ue.getSelection(),ft=j.textContent.length,Pt=Math.min(F.start,ft),es=F.end===void 0?Pt:Math.min(F.end,ft);!ge.extend&&Pt>es&&(w=es,es=Pt,Pt=w);var Z=J0(j,Pt),G=J0(j,es);if(Z&&G&&(ge.rangeCount!==1||ge.anchorNode!==Z.node||ge.anchorOffset!==Z.offset||ge.focusNode!==G.node||ge.focusOffset!==G.offset)){var oe=Ie.createRange();oe.setStart(Z.node,Z.offset),ge.removeAllRanges(),Pt>es?(ge.addRange(oe),ge.extend(G.node,G.offset)):(oe.setEnd(G.node,G.offset),ge.addRange(oe))}}}}for(Ie=[],ge=j;ge=ge.parentNode;)ge.nodeType===1&&Ie.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Ie.length;j++){var Re=Ie[j];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Mf=!!uy,hy=uy=null}finally{Un=m,ye.p=h,$.T=l}}r.current=i,Ys=2}}function p_(){if(Ys===2){Ys=0;var r=ao,i=Tc,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=$.T,$.T=null;var h=ye.p;ye.p=2;var m=Un;Un|=4;try{qx(r,i.alternate,i)}finally{Un=m,ye.p=h,$.T=l}}Ys=3}}function g_(){if(Ys===4||Ys===3){Ys=0,Rt();var r=ao,i=Tc,l=wa,h=n_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Ys=5:(Ys=0,Tc=ao=null,y_(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(io=null),xe(l),i=i.stateNode,Ue&&typeof Ue.onCommitFiberRoot=="function")try{Ue.onCommitFiberRoot(et,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=$.T,m=ye.p,ye.p=2,$.T=null;try{for(var y=r.onRecoverableError,w=0;w<h.length;w++){var j=h[w];y(j.value,{componentStack:j.stack})}}finally{$.T=i,ye.p=m}}(wa&3)!==0&&Tf(),qi(r),m=r.pendingLanes,(l&261930)!==0&&(m&42)!==0?r===Xg?ih++:(ih=0,Xg=r):ih=0,ah(0)}}function y_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,Uu(i)))}function Tf(){return m_(),p_(),g_(),b_()}function b_(){if(Ys!==5)return!1;var r=ao,i=Qg;Qg=0;var l=xe(wa),h=$.T,m=ye.p;try{ye.p=32>l?32:l,$.T=null,l=Yg,Yg=null;var y=ao,w=wa;if(Ys=0,Tc=ao=null,wa=0,(Un&6)!==0)throw Error(s(331));var j=Un;if(Un|=4,Zx(y.current),Yx(y,y.current,w,l),Un=j,ah(0,!1),Ue&&typeof Ue.onPostCommitFiberRoot=="function")try{Ue.onPostCommitFiberRoot(et,y)}catch{}return!0}finally{ye.p=m,$.T=h,y_(r,i)}}function v_(r,i,l){i=ui(l,i),i=Ag(r.stateNode,i,2),r=Za(r,i,2),r!==null&&(Fn(r,2),qi(r))}function Gn(r,i,l){if(r.tag===3)v_(r,r,l);else for(;i!==null;){if(i.tag===3){v_(i,r,l);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(io===null||!io.has(h))){r=ui(l,r),l=xx(2),h=Za(i,l,2),h!==null&&(_x(l,h,i,r),Fn(h,2),qi(h));break}}i=i.return}}function ey(r,i,l){var h=r.pingCache;if(h===null){h=r.pingCache=new $N;var m=new Set;h.set(i,m)}else m=h.get(i),m===void 0&&(m=new Set,h.set(i,m));m.has(l)||(Wg=!0,m.add(l),r=YN.bind(null,r,i,l),i.then(r,r))}function YN(r,i,l){var h=r.pingCache;h!==null&&h.delete(i),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,is===r&&(wn&l)===l&&(js===4||js===3&&(wn&62914560)===wn&&300>ln()-yf?(Un&2)===0&&Ec(r,0):Gg|=l,wc===wn&&(wc=0)),qi(r)}function x_(r,i){i===0&&(i=Jt()),r=nl(r,i),r!==null&&(Fn(r,i),qi(r))}function XN(r){var i=r.memoizedState,l=0;i!==null&&(l=i.retryLane),x_(r,l)}function JN(r,i){var l=0;switch(r.tag){case 31:case 13:var h=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(s(314))}h!==null&&h.delete(i),x_(r,l)}function ZN(r,i){return it(r,i)}var Ef=null,Sc=null,ty=!1,kf=!1,ny=!1,lo=0;function qi(r){r!==Sc&&r.next===null&&(Sc===null?Ef=Sc=r:Sc=Sc.next=r),kf=!0,ty||(ty=!0,tA())}function ah(r,i){if(!ny&&kf){ny=!0;do for(var l=!1,h=Ef;h!==null;){if(r!==0){var m=h.pendingLanes;if(m===0)var y=0;else{var w=h.suspendedLanes,j=h.pingedLanes;y=(1<<31-ze(42|r)+1)-1,y&=m&~(w&~j),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,E_(h,y))}else y=wn,y=Ct(h,h===is?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||It(h,y)||(l=!0,E_(h,y));h=h.next}while(l);ny=!1}}function eA(){__()}function __(){kf=ty=!1;var r=0;lo!==0&&hA()&&(r=lo);for(var i=ln(),l=null,h=Ef;h!==null;){var m=h.next,y=w_(h,i);y===0?(h.next=null,l===null?Ef=m:l.next=m,m===null&&(Sc=l)):(l=h,(r!==0||(y&3)!==0)&&(kf=!0)),h=m}Ys!==0&&Ys!==5||ah(r),lo!==0&&(lo=0)}function w_(r,i){for(var l=r.suspendedLanes,h=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var w=31-ze(y),j=1<<w,F=m[w];F===-1?((j&l)===0||(j&h)!==0)&&(m[w]=Xt(j,i)):F<=i&&(r.expiredLanes|=j),y&=~j}if(i=is,l=wn,l=Ct(r,r===i?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,l===0||r===i&&(Wn===2||Wn===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&an(h),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||It(r,l)){if(i=l&-l,i===r.callbackPriority)return i;switch(h!==null&&an(h),xe(l)){case 2:case 8:l=Wt;break;case 32:l=cn;break;case 268435456:l=be;break;default:l=cn}return h=T_.bind(null,r),l=it(l,h),r.callbackPriority=i,r.callbackNode=l,i}return h!==null&&h!==null&&an(h),r.callbackPriority=2,r.callbackNode=null,2}function T_(r,i){if(Ys!==0&&Ys!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Tf()&&r.callbackNode!==l)return null;var h=wn;return h=Ct(r,r===is?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(r_(r,h,i),w_(r,ln()),r.callbackNode!=null&&r.callbackNode===l?T_.bind(null,r):null)}function E_(r,i){if(Tf())return null;r_(r,i,!0)}function tA(){fA(function(){(Un&6)!==0?it(Qt,eA):__()})}function sy(){if(lo===0){var r=hc;r===0&&(r=Ht,Ht<<=1,(Ht&261888)===0&&(Ht=256)),lo=r}return lo}function k_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ir(""+r)}function S_(r,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,r.id&&l.setAttribute("form",r.id),i.parentNode.insertBefore(l,i),r=new FormData(r),l.parentNode.removeChild(l),r}function nA(r,i,l,h,m){if(i==="submit"&&l&&l.stateNode===m){var y=k_((m[Dt]||null).action),w=h.submitter;w&&(i=(i=w[Dt]||null)?k_(i.formAction):w.getAttribute("formAction"),i!==null&&(y=i,w=null));var j=new ss("action","action",null,h,m);r.push({event:j,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(lo!==0){var F=w?S_(m,w):new FormData(m);Tg(l,{pending:!0,data:F,method:m.method,action:y},null,F)}}else typeof y=="function"&&(j.preventDefault(),F=w?S_(m,w):new FormData(m),Tg(l,{pending:!0,data:F,method:m.method,action:y},y,F))},currentTarget:m}]})}}for(var ry=0;ry<Up.length;ry++){var iy=Up[ry],sA=iy.toLowerCase(),rA=iy[0].toUpperCase()+iy.slice(1);ki(sA,"on"+rA)}ki(s1,"onAnimationEnd"),ki(r1,"onAnimationIteration"),ki(i1,"onAnimationStart"),ki("dblclick","onDoubleClick"),ki("focusin","onFocus"),ki("focusout","onBlur"),ki(xN,"onTransitionRun"),ki(_N,"onTransitionStart"),ki(wN,"onTransitionCancel"),ki(a1,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oh));function j_(r,i){i=(i&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],m=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var w=h.length-1;0<=w;w--){var j=h[w],F=j.instance,le=j.currentTarget;if(j=j.listener,F!==y&&m.isPropagationStopped())break e;y=j,m.currentTarget=le;try{y(m)}catch(je){Bd(je)}m.currentTarget=null,y=F}else for(w=0;w<h.length;w++){if(j=h[w],F=j.instance,le=j.currentTarget,j=j.listener,F!==y&&m.isPropagationStopped())break e;y=j,m.currentTarget=le;try{y(m)}catch(je){Bd(je)}m.currentTarget=null,y=F}}}}function yn(r,i){var l=i[jt];l===void 0&&(l=i[jt]=new Set);var h=r+"__bubble";l.has(h)||(N_(i,r,2,!1),l.add(h))}function ay(r,i,l){var h=0;i&&(h|=4),N_(l,r,h,i)}var Sf="_reactListening"+Math.random().toString(36).slice(2);function oy(r){if(!r[Sf]){r[Sf]=!0,Q.forEach(function(l){l!=="selectionchange"&&(iA.has(l)||ay(l,!1,r),ay(l,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Sf]||(i[Sf]=!0,ay("selectionchange",!1,i))}}function N_(r,i,l,h){switch(sw(i)){case 2:var m=DA;break;case 8:m=PA;break;default:m=wy}l=m.bind(null,i,l,r),m=void 0,!_t||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),h?m!==void 0?r.addEventListener(i,l,{capture:!0,passive:m}):r.addEventListener(i,l,!0):m!==void 0?r.addEventListener(i,l,{passive:m}):r.addEventListener(i,l,!1)}function ly(r,i,l,h,m){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var j=h.stateNode.containerInfo;if(j===m)break;if(w===4)for(w=h.return;w!==null;){var F=w.tag;if((F===3||F===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;j!==null;){if(w=Xn(j),w===null)return;if(F=w.tag,F===5||F===6||F===26||F===27){h=y=w;continue e}j=j.parentNode}}h=h.return}ne(function(){var le=y,je=Bs(l),Ie=[];e:{var ue=o1.get(r);if(ue!==void 0){var ge=ss,ft=r;switch(r){case"keypress":if(jn(l)===0)break e;case"keydown":case"keyup":ge=Ld;break;case"focusin":ft="focus",ge=Pr;break;case"focusout":ft="blur",ge=Pr;break;case"beforeblur":case"afterblur":ge=Pr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Oi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=kr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=v;break;case s1:case r1:case i1:ge=ec;break;case a1:ge=R;break;case"scroll":case"scrollend":ge=Qs;break;case"wheel":ge=fe;break;case"copy":case"cut":case"paste":ge=oa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=la;break;case"toggle":case"beforetoggle":ge=tn}var Pt=(i&4)!==0,es=!Pt&&(r==="scroll"||r==="scrollend"),Z=Pt?ue!==null?ue+"Capture":null:ue;Pt=[];for(var G=le,oe;G!==null;){var Re=G;if(oe=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||oe===null||Z===null||(Re=Ve(G,Z),Re!=null&&Pt.push(lh(G,Re,oe))),es)break;G=G.return}0<Pt.length&&(ue=new ge(ue,ft,null,l,je),Ie.push({event:ue,listeners:Pt}))}}if((i&7)===0){e:{if(ue=r==="mouseover"||r==="pointerover",ge=r==="mouseout"||r==="pointerout",ue&&l!==lr&&(ft=l.relatedTarget||l.fromElement)&&(Xn(ft)||ft[ut]))break e;if((ge||ue)&&(ue=je.window===je?je:(ue=je.ownerDocument)?ue.defaultView||ue.parentWindow:window,ge?(ft=l.relatedTarget||l.toElement,ge=le,ft=ft?Xn(ft):null,ft!==null&&(es=c(ft),Pt=ft.tag,ft!==es||Pt!==5&&Pt!==27&&Pt!==6)&&(ft=null)):(ge=null,ft=le),ge!==ft)){if(Pt=Oi,Re="onMouseLeave",Z="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(Pt=la,Re="onPointerLeave",Z="onPointerEnter",G="pointer"),es=ge==null?ue:de(ge),oe=ft==null?ue:de(ft),ue=new Pt(Re,G+"leave",ge,l,je),ue.target=es,ue.relatedTarget=oe,Re=null,Xn(je)===le&&(Pt=new Pt(Z,G+"enter",ft,l,je),Pt.target=oe,Pt.relatedTarget=es,Re=Pt),es=Re,ge&&ft)t:{for(Pt=aA,Z=ge,G=ft,oe=0,Re=Z;Re;Re=Pt(Re))oe++;Re=0;for(var Nt=G;Nt;Nt=Pt(Nt))Re++;for(;0<oe-Re;)Z=Pt(Z),oe--;for(;0<Re-oe;)G=Pt(G),Re--;for(;oe--;){if(Z===G||G!==null&&Z===G.alternate){Pt=Z;break t}Z=Pt(Z),G=Pt(G)}Pt=null}else Pt=null;ge!==null&&A_(Ie,ue,ge,Pt,!1),ft!==null&&es!==null&&A_(Ie,es,ft,Pt,!0)}}e:{if(ue=le?de(le):window,ge=ue.nodeName&&ue.nodeName.toLowerCase(),ge==="select"||ge==="input"&&ue.type==="file")var Mn=W0;else if(H0(ue))if(G0)Mn=yN;else{Mn=pN;var xt=mN}else ge=ue.nodeName,!ge||ge.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?le&&_s(le.elementType)&&(Mn=W0):Mn=gN;if(Mn&&(Mn=Mn(r,le))){$0(Ie,Mn,l,je);break e}xt&&xt(r,ue,le),r==="focusout"&&le&&ue.type==="number"&&le.memoizedProps.value!=null&&Cs(ue,"number",ue.value)}switch(xt=le?de(le):window,r){case"focusin":(H0(xt)||xt.contentEditable==="true")&&(sc=xt,Vp=le,Vu=null);break;case"focusout":Vu=Vp=sc=null;break;case"mousedown":Op=!0;break;case"contextmenu":case"mouseup":case"dragend":Op=!1,t1(Ie,l,je);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":t1(Ie,l,je)}var on;if(Bn)e:{switch(r){case"compositionstart":var Tn="onCompositionStart";break e;case"compositionend":Tn="onCompositionEnd";break e;case"compositionupdate":Tn="onCompositionUpdate";break e}Tn=void 0}else nc?Zo(r,l)&&(Tn="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Tn="onCompositionStart");Tn&&(Bi&&l.locale!=="ko"&&(nc||Tn!=="onCompositionStart"?Tn==="onCompositionEnd"&&nc&&(on=_n()):(st=je,Kt="value"in st?st.value:st.textContent,nc=!0)),xt=jf(le,Tn),0<xt.length&&(Tn=new ur(Tn,r,null,l,je),Ie.push({event:Tn,listeners:xt}),on?Tn.data=on:(on=tc(l),on!==null&&(Tn.data=on)))),(on=li?uN(r,l):hN(r,l))&&(Tn=jf(le,"onBeforeInput"),0<Tn.length&&(xt=new ur("onBeforeInput","beforeinput",null,l,je),Ie.push({event:xt,listeners:Tn}),xt.data=on)),nA(Ie,r,le,l,je)}j_(Ie,i)})}function lh(r,i,l){return{instance:r,listener:i,currentTarget:l}}function jf(r,i){for(var l=i+"Capture",h=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Ve(r,l),m!=null&&h.unshift(lh(r,m,y)),m=Ve(r,i),m!=null&&h.push(lh(r,m,y))),r.tag===3)return h;r=r.return}return[]}function aA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function A_(r,i,l,h,m){for(var y=i._reactName,w=[];l!==null&&l!==h;){var j=l,F=j.alternate,le=j.stateNode;if(j=j.tag,F!==null&&F===h)break;j!==5&&j!==26&&j!==27||le===null||(F=le,m?(le=Ve(l,y),le!=null&&w.unshift(lh(l,le,F))):m||(le=Ve(l,y),le!=null&&w.push(lh(l,le,F)))),l=l.return}w.length!==0&&r.push({event:i,listeners:w})}var oA=/\r\n?/g,lA=/\u0000|\uFFFD/g;function R_(r){return(typeof r=="string"?r:""+r).replace(oA,`
`).replace(lA,"")}function C_(r,i){return i=R_(i),R_(r)===i}function Zn(r,i,l,h,m,y){switch(l){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Es(r,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Es(r,""+h);break;case"className":Vs(r,"class",h);break;case"tabIndex":Vs(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Vs(r,l,h);break;case"style":xn(r,h,y);break;case"data":if(i!=="object"){Vs(r,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||l!=="href")){r.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=Ir(""+h),r.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(i!=="input"&&Zn(r,i,"name",m.name,m,null),Zn(r,i,"formEncType",m.formEncType,m,null),Zn(r,i,"formMethod",m.formMethod,m,null),Zn(r,i,"formTarget",m.formTarget,m,null)):(Zn(r,i,"encType",m.encType,m,null),Zn(r,i,"method",m.method,m,null),Zn(r,i,"target",m.target,m,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(l);break}h=Ir(""+h),r.setAttribute(l,h);break;case"onClick":h!=null&&(r.onclick=ls);break;case"onScroll":h!=null&&yn("scroll",r);break;case"onScrollEnd":h!=null&&yn("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}l=Ir(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""+h):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":h===!0?r.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(l,h):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(l,h):r.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(l):r.setAttribute(l,h);break;case"popover":yn("beforetoggle",r),yn("toggle",r),er(r,"popover",h);break;case"xlinkActuate":zn(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":zn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":zn(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":zn(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":zn(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":zn(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":zn(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":zn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":zn(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":er(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Tr.get(l)||l,er(r,l,h))}}function cy(r,i,l,h,m,y){switch(l){case"style":xn(r,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(m.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"children":typeof h=="string"?Es(r,h):(typeof h=="number"||typeof h=="bigint")&&Es(r,""+h);break;case"onScroll":h!=null&&yn("scroll",r);break;case"onScrollEnd":h!=null&&yn("scrollend",r);break;case"onClick":h!=null&&(r.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ae.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),i=l.slice(2,m?l.length-7:void 0),y=r[Dt]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(i,y,m),typeof h=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(i,h,m);break e}l in r?r[l]=h:h===!0?r.setAttribute(l,""):er(r,l,h)}}}function mr(r,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yn("error",r),yn("load",r);var h=!1,m=!1,y;for(y in l)if(l.hasOwnProperty(y)){var w=l[y];if(w!=null)switch(y){case"src":h=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Zn(r,i,y,w,l,null)}}m&&Zn(r,i,"srcSet",l.srcSet,l,null),h&&Zn(r,i,"src",l.src,l,null);return;case"input":yn("invalid",r);var j=y=w=m=null,F=null,le=null;for(h in l)if(l.hasOwnProperty(h)){var je=l[h];if(je!=null)switch(h){case"name":m=je;break;case"type":w=je;break;case"checked":F=je;break;case"defaultChecked":le=je;break;case"value":y=je;break;case"defaultValue":j=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(s(137,i));break;default:Zn(r,i,h,je,l,null)}}Sn(r,y,j,F,le,w,m,!1);return;case"select":yn("invalid",r),h=w=y=null;for(m in l)if(l.hasOwnProperty(m)&&(j=l[m],j!=null))switch(m){case"value":y=j;break;case"defaultValue":w=j;break;case"multiple":h=j;default:Zn(r,i,m,j,l,null)}i=y,l=w,r.multiple=!!h,i!=null?hn(r,!!h,i,!1):l!=null&&hn(r,!!h,l,!0);return;case"textarea":yn("invalid",r),y=m=h=null;for(w in l)if(l.hasOwnProperty(w)&&(j=l[w],j!=null))switch(w){case"value":h=j;break;case"defaultValue":m=j;break;case"children":y=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:Zn(r,i,w,j,l,null)}Os(r,h,m,y);return;case"option":for(F in l)l.hasOwnProperty(F)&&(h=l[F],h!=null)&&(F==="selected"?r.selected=h&&typeof h!="function"&&typeof h!="symbol":Zn(r,i,F,h,l,null));return;case"dialog":yn("beforetoggle",r),yn("toggle",r),yn("cancel",r),yn("close",r);break;case"iframe":case"object":yn("load",r);break;case"video":case"audio":for(h=0;h<oh.length;h++)yn(oh[h],r);break;case"image":yn("error",r),yn("load",r);break;case"details":yn("toggle",r);break;case"embed":case"source":case"link":yn("error",r),yn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in l)if(l.hasOwnProperty(le)&&(h=l[le],h!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Zn(r,i,le,h,l,null)}return;default:if(_s(i)){for(je in l)l.hasOwnProperty(je)&&(h=l[je],h!==void 0&&cy(r,i,je,h,l,void 0));return}}for(j in l)l.hasOwnProperty(j)&&(h=l[j],h!=null&&Zn(r,i,j,h,l,null))}function cA(r,i,l,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,w=null,j=null,F=null,le=null,je=null;for(ge in l){var Ie=l[ge];if(l.hasOwnProperty(ge)&&Ie!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":F=Ie;default:h.hasOwnProperty(ge)||Zn(r,i,ge,null,h,Ie)}}for(var ue in h){var ge=h[ue];if(Ie=l[ue],h.hasOwnProperty(ue)&&(ge!=null||Ie!=null))switch(ue){case"type":y=ge;break;case"name":m=ge;break;case"checked":le=ge;break;case"defaultChecked":je=ge;break;case"value":w=ge;break;case"defaultValue":j=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(137,i));break;default:ge!==Ie&&Zn(r,i,ue,ge,h,Ie)}}Gt(r,w,j,F,le,je,y,m);return;case"select":ge=w=j=ue=null;for(y in l)if(F=l[y],l.hasOwnProperty(y)&&F!=null)switch(y){case"value":break;case"multiple":ge=F;default:h.hasOwnProperty(y)||Zn(r,i,y,null,h,F)}for(m in h)if(y=h[m],F=l[m],h.hasOwnProperty(m)&&(y!=null||F!=null))switch(m){case"value":ue=y;break;case"defaultValue":j=y;break;case"multiple":w=y;default:y!==F&&Zn(r,i,m,y,h,F)}i=j,l=w,h=ge,ue!=null?hn(r,!!l,ue,!1):!!h!=!!l&&(i!=null?hn(r,!!l,i,!0):hn(r,!!l,l?[]:"",!1));return;case"textarea":ge=ue=null;for(j in l)if(m=l[j],l.hasOwnProperty(j)&&m!=null&&!h.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Zn(r,i,j,null,h,m)}for(w in h)if(m=h[w],y=l[w],h.hasOwnProperty(w)&&(m!=null||y!=null))switch(w){case"value":ue=m;break;case"defaultValue":ge=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==y&&Zn(r,i,w,m,h,y)}tr(r,ue,ge);return;case"option":for(var ft in l)ue=l[ft],l.hasOwnProperty(ft)&&ue!=null&&!h.hasOwnProperty(ft)&&(ft==="selected"?r.selected=!1:Zn(r,i,ft,null,h,ue));for(F in h)ue=h[F],ge=l[F],h.hasOwnProperty(F)&&ue!==ge&&(ue!=null||ge!=null)&&(F==="selected"?r.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":Zn(r,i,F,ue,h,ge));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in l)ue=l[Pt],l.hasOwnProperty(Pt)&&ue!=null&&!h.hasOwnProperty(Pt)&&Zn(r,i,Pt,null,h,ue);for(le in h)if(ue=h[le],ge=l[le],h.hasOwnProperty(le)&&ue!==ge&&(ue!=null||ge!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,i));break;default:Zn(r,i,le,ue,h,ge)}return;default:if(_s(i)){for(var es in l)ue=l[es],l.hasOwnProperty(es)&&ue!==void 0&&!h.hasOwnProperty(es)&&cy(r,i,es,void 0,h,ue);for(je in h)ue=h[je],ge=l[je],!h.hasOwnProperty(je)||ue===ge||ue===void 0&&ge===void 0||cy(r,i,je,ue,h,ge);return}}for(var Z in l)ue=l[Z],l.hasOwnProperty(Z)&&ue!=null&&!h.hasOwnProperty(Z)&&Zn(r,i,Z,null,h,ue);for(Ie in h)ue=h[Ie],ge=l[Ie],!h.hasOwnProperty(Ie)||ue===ge||ue==null&&ge==null||Zn(r,i,Ie,ue,h,ge)}function I_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var m=l[h],y=m.transferSize,w=m.initiatorType,j=m.duration;if(y&&j&&I_(w)){for(w=0,j=m.responseEnd,h+=1;h<l.length;h++){var F=l[h],le=F.startTime;if(le>j)break;var je=F.transferSize,Ie=F.initiatorType;je&&I_(Ie)&&(F=F.responseEnd,w+=je*(F<j?1:(j-le)/(F-le)))}if(--h,i+=8*(y+w)/(m.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var uy=null,hy=null;function Nf(r){return r.nodeType===9?r:r.ownerDocument}function D_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function P_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function dy(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fy=null;function hA(){var r=window.event;return r&&r.type==="popstate"?r===fy?!1:(fy=r,!0):(fy=null,!1)}var M_=typeof setTimeout=="function"?setTimeout:void 0,dA=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,fA=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(r){return L_.resolve(null).then(r).catch(mA)}:M_;function mA(r){setTimeout(function(){throw r})}function co(r){return r==="head"}function V_(r,i){var l=i,h=0;do{var m=l.nextSibling;if(r.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(h===0){r.removeChild(m),Rc(i);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")ch(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,ch(l);for(var y=l.firstChild;y;){var w=y.nextSibling,j=y.nodeName;y[Gs]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=w}}else l==="body"&&ch(r.ownerDocument.body);l=m}while(l);Rc(i)}function O_(r,i){var l=r;r=0;do{var h=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=h}while(l)}function my(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":my(l),Zs(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function pA(r,i,l,h){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[Gs])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=pi(r.nextSibling),r===null)break}return null}function gA(r,i,l){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=pi(r.nextSibling),r===null))return null;return r}function B_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=pi(r.nextSibling),r===null))return null;return r}function py(r){return r.data==="$?"||r.data==="$~"}function gy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function yA(r,i){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||l.readyState!=="loading")i();else{var h=function(){i(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function pi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var yy=null;function U_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(i===0)return pi(r.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}r=r.nextSibling}return null}function F_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return r;i--}else l!=="/$"&&l!=="/&"||i++}r=r.previousSibling}return null}function z_(r,i,l){switch(i=Nf(l),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function ch(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);Zs(r)}var gi=new Map,q_=new Set;function Af(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ta=ye.d;ye.d={f:bA,r:vA,D:xA,C:_A,L:wA,m:TA,X:kA,S:EA,M:SA};function bA(){var r=Ta.f(),i=xf();return r||i}function vA(r){var i=W(r);i!==null&&i.tag===5&&i.type==="form"?ax(i):Ta.r(r)}var jc=typeof document>"u"?null:document;function H_(r,i,l){var h=jc;if(h&&typeof i=="string"&&i){var m=vt(i);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),q_.has(m)||(q_.add(m),r={rel:r,crossOrigin:l,href:i},h.querySelector(m)===null&&(i=h.createElement("link"),mr(i,"link",r),A(i),h.head.appendChild(i)))}}function xA(r){Ta.D(r),H_("dns-prefetch",r,null)}function _A(r,i){Ta.C(r,i),H_("preconnect",r,i)}function wA(r,i,l){Ta.L(r,i,l);var h=jc;if(h&&r&&i){var m='link[rel="preload"][as="'+vt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+vt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+vt(l.imageSizes)+'"]')):m+='[href="'+vt(r)+'"]';var y=m;switch(i){case"style":y=Nc(r);break;case"script":y=Ac(r)}gi.has(y)||(r=x({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:r,as:i},l),gi.set(y,r),h.querySelector(m)!==null||i==="style"&&h.querySelector(uh(y))||i==="script"&&h.querySelector(hh(y))||(i=h.createElement("link"),mr(i,"link",r),A(i),h.head.appendChild(i)))}}function TA(r,i){Ta.m(r,i);var l=jc;if(l&&r){var h=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+vt(h)+'"][href="'+vt(r)+'"]',y=m;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Ac(r)}if(!gi.has(y)&&(r=x({rel:"modulepreload",href:r},i),gi.set(y,r),l.querySelector(m)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(hh(y)))return}h=l.createElement("link"),mr(h,"link",r),A(h),l.head.appendChild(h)}}}function EA(r,i,l){Ta.S(r,i,l);var h=jc;if(h&&r){var m=k(h).hoistableStyles,y=Nc(r);i=i||"default";var w=m.get(y);if(!w){var j={loading:0,preload:null};if(w=h.querySelector(uh(y)))j.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":i},l),(l=gi.get(y))&&by(r,l);var F=w=h.createElement("link");A(F),mr(F,"link",r),F._p=new Promise(function(le,je){F.onload=le,F.onerror=je}),F.addEventListener("load",function(){j.loading|=1}),F.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Rf(w,i,h)}w={type:"stylesheet",instance:w,count:1,state:j},m.set(y,w)}}}function kA(r,i){Ta.X(r,i);var l=jc;if(l&&r){var h=k(l).hoistableScripts,m=Ac(r),y=h.get(m);y||(y=l.querySelector(hh(m)),y||(r=x({src:r,async:!0},i),(i=gi.get(m))&&vy(r,i),y=l.createElement("script"),A(y),mr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function SA(r,i){Ta.M(r,i);var l=jc;if(l&&r){var h=k(l).hoistableScripts,m=Ac(r),y=h.get(m);y||(y=l.querySelector(hh(m)),y||(r=x({src:r,async:!0,type:"module"},i),(i=gi.get(m))&&vy(r,i),y=l.createElement("script"),A(y),mr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function $_(r,i,l,h){var m=(m=Pe.current)?Af(m):null;if(!m)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Nc(l.href),l=k(m).hoistableStyles,h=l.get(i),h||(h={type:"style",instance:null,count:0,state:null},l.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=Nc(l.href);var y=k(m).hoistableStyles,w=y.get(r);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,w),(y=m.querySelector(uh(r)))&&!y._p&&(w.instance=y,w.state.loading=5),gi.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},gi.set(r,l),y||jA(m,r,l,w.state))),i&&h===null)throw Error(s(528,""));return w}if(i&&h!==null)throw Error(s(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ac(l),l=k(m).hoistableScripts,h=l.get(i),h||(h={type:"script",instance:null,count:0,state:null},l.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function Nc(r){return'href="'+vt(r)+'"'}function uh(r){return'link[rel="stylesheet"]['+r+"]"}function W_(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function jA(r,i,l,h){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=r.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),mr(i,"link",l),A(i),r.head.appendChild(i))}function Ac(r){return'[src="'+vt(r)+'"]'}function hh(r){return"script[async]"+r}function G_(r,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var h=r.querySelector('style[data-href~="'+vt(l.href)+'"]');if(h)return i.instance=h,A(h),h;var m=x({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),A(h),mr(h,"style",m),Rf(h,l.precedence,r),i.instance=h;case"stylesheet":m=Nc(l.href);var y=r.querySelector(uh(m));if(y)return i.state.loading|=4,i.instance=y,A(y),y;h=W_(l),(m=gi.get(m))&&by(h,m),y=(r.ownerDocument||r).createElement("link"),A(y);var w=y;return w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),mr(y,"link",h),i.state.loading|=4,Rf(y,l.precedence,r),i.instance=y;case"script":return y=Ac(l.src),(m=r.querySelector(hh(y)))?(i.instance=m,A(m),m):(h=l,(m=gi.get(y))&&(h=x({},l),vy(h,m)),r=r.ownerDocument||r,m=r.createElement("script"),A(m),mr(m,"link",h),r.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,Rf(h,l.precedence,r));return i.instance}function Rf(r,i,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=h.length?h[h.length-1]:null,y=m,w=0;w<h.length;w++){var j=h[w];if(j.dataset.precedence===i)y=j;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(r,i.firstChild))}function by(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function vy(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var Cf=null;function K_(r,i,l){if(Cf===null){var h=new Map,m=Cf=new Map;m.set(l,h)}else m=Cf,h=m.get(l),h||(h=new Map,m.set(l,h));if(h.has(r))return h;for(h.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var y=l[m];if(!(y[Gs]||y[rt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(i)||"";w=r+w;var j=h.get(w);j?j.push(y):h.set(w,[y])}}return h}function Q_(r,i,l){r=r.ownerDocument||r,r.head.insertBefore(l,i==="title"?r.querySelector("head > title"):null)}function NA(r,i,l){if(l===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(r=i.disabled,typeof i.precedence=="string"&&r==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Y_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function AA(r,i,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=Nc(h.href),y=i.querySelector(uh(m));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=If.bind(r),i.then(r,r)),l.state.loading|=4,l.instance=y,A(y);return}y=i.ownerDocument||i,h=W_(h),(m=gi.get(m))&&by(h,m),y=y.createElement("link"),A(y);var w=y;w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),mr(y,"link",h),l.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=If.bind(r),i.addEventListener("load",l),i.addEventListener("error",l))}}var xy=0;function RA(r,i){return r.stylesheets&&r.count===0&&Pf(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var h=setTimeout(function(){if(r.stylesheets&&Pf(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&xy===0&&(xy=62500*uA());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Pf(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>xy?50:800)+i);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(h),clearTimeout(m)}}:null}function If(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Df=null;function Pf(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Df=new Map,i.forEach(CA,r),Df=null,If.call(r))}function CA(r,i){if(!(i.state.loading&4)){var l=Df.get(r);if(l)var h=l.get(null);else{l=new Map,Df.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var w=m[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),h=w)}h&&l.set(null,h)}m=i.instance,w=m.getAttribute("data-precedence"),y=l.get(w)||h,y===h&&l.set(null,m),l.set(w,m),this.count++,h=If.bind(this),m.addEventListener("load",h),m.addEventListener("error",h),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),i.state.loading|=4}}var dh={$$typeof:J,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function IA(r,i,l,h,m,y,w,j,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zt(0),this.hiddenUpdates=zt(null),this.identifierPrefix=h,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function X_(r,i,l,h,m,y,w,j,F,le,je,Ie){return r=new IA(r,i,l,w,F,le,je,Ie,j),i=1,y===!0&&(i|=24),y=Wr(3,null,null,i),r.current=y,y.stateNode=r,i=Zp(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:h,isDehydrated:l,cache:i},sg(y),r}function J_(r){return r?(r=ac,r):ac}function Z_(r,i,l,h,m,y){m=J_(m),h.context===null?h.context=m:h.pendingContext=m,h=Ja(i),h.payload={element:l},y=y===void 0?null:y,y!==null&&(h.callback=y),l=Za(r,h,i),l!==null&&(Br(l,r,i),Hu(l,r,i))}function ew(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<i?l:i}}function _y(r,i){ew(r,i),(r=r.alternate)&&ew(r,i)}function tw(r){if(r.tag===13||r.tag===31){var i=nl(r,67108864);i!==null&&Br(i,r,67108864),_y(r,67108864)}}function nw(r){if(r.tag===13||r.tag===31){var i=Xr();i=z(i);var l=nl(r,i);l!==null&&Br(l,r,i),_y(r,i)}}var Mf=!0;function DA(r,i,l,h){var m=$.T;$.T=null;var y=ye.p;try{ye.p=2,wy(r,i,l,h)}finally{ye.p=y,$.T=m}}function PA(r,i,l,h){var m=$.T;$.T=null;var y=ye.p;try{ye.p=8,wy(r,i,l,h)}finally{ye.p=y,$.T=m}}function wy(r,i,l,h){if(Mf){var m=Ty(h);if(m===null)ly(r,i,h,Lf,l),rw(r,h);else if(LA(m,r,i,l,h))h.stopPropagation();else if(rw(r,h),i&4&&-1<MA.indexOf(r)){for(;m!==null;){var y=W(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=lt(y.pendingLanes);if(w!==0){var j=y;for(j.pendingLanes|=2,j.entangledLanes|=2;w;){var F=1<<31-ze(w);j.entanglements[1]|=F,w&=~F}qi(y),(Un&6)===0&&(bf=ln()+500,ah(0))}}break;case 31:case 13:j=nl(y,2),j!==null&&Br(j,y,2),xf(),_y(y,2)}if(y=Ty(h),y===null&&ly(r,i,h,Lf,l),y===m)break;m=y}m!==null&&h.stopPropagation()}else ly(r,i,h,null,l)}}function Ty(r){return r=Bs(r),Ey(r)}var Lf=null;function Ey(r){if(Lf=null,r=Xn(r),r!==null){var i=c(r);if(i===null)r=null;else{var l=i.tag;if(l===13){if(r=u(i),r!==null)return r;r=null}else if(l===31){if(r=d(i),r!==null)return r;r=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Lf=r,null}function sw(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ns()){case Qt:return 2;case Wt:return 8;case cn:case vn:return 32;case be:return 268435456;default:return 32}default:return 32}}var ky=!1,uo=null,ho=null,fo=null,fh=new Map,mh=new Map,mo=[],MA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rw(r,i){switch(r){case"focusin":case"focusout":uo=null;break;case"dragenter":case"dragleave":ho=null;break;case"mouseover":case"mouseout":fo=null;break;case"pointerover":case"pointerout":fh.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(i.pointerId)}}function ph(r,i,l,h,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:l,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},i!==null&&(i=W(i),i!==null&&tw(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),r)}function LA(r,i,l,h,m){switch(i){case"focusin":return uo=ph(uo,r,i,l,h,m),!0;case"dragenter":return ho=ph(ho,r,i,l,h,m),!0;case"mouseover":return fo=ph(fo,r,i,l,h,m),!0;case"pointerover":var y=m.pointerId;return fh.set(y,ph(fh.get(y)||null,r,i,l,h,m)),!0;case"gotpointercapture":return y=m.pointerId,mh.set(y,ph(mh.get(y)||null,r,i,l,h,m)),!0}return!1}function iw(r){var i=Xn(r.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){r.blockedOn=i,Se(r.priority,function(){nw(l)});return}}else if(i===31){if(i=d(l),i!==null){r.blockedOn=i,Se(r.priority,function(){nw(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Vf(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var l=Ty(r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);lr=h,l.target.dispatchEvent(h),lr=null}else return i=W(l),i!==null&&tw(i),r.blockedOn=l,!1;i.shift()}return!0}function aw(r,i,l){Vf(r)&&l.delete(i)}function VA(){ky=!1,uo!==null&&Vf(uo)&&(uo=null),ho!==null&&Vf(ho)&&(ho=null),fo!==null&&Vf(fo)&&(fo=null),fh.forEach(aw),mh.forEach(aw)}function Of(r,i){r.blockedOn===i&&(r.blockedOn=null,ky||(ky=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,VA)))}var Bf=null;function ow(r){Bf!==r&&(Bf=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Bf===r&&(Bf=null);for(var i=0;i<r.length;i+=3){var l=r[i],h=r[i+1],m=r[i+2];if(typeof h!="function"){if(Ey(h||l)===null)continue;break}var y=W(l);y!==null&&(r.splice(i,3),i-=3,Tg(y,{pending:!0,data:m,method:l.method,action:h},h,m))}}))}function Rc(r){function i(F){return Of(F,r)}uo!==null&&Of(uo,r),ho!==null&&Of(ho,r),fo!==null&&Of(fo,r),fh.forEach(i),mh.forEach(i);for(var l=0;l<mo.length;l++){var h=mo[l];h.blockedOn===r&&(h.blockedOn=null)}for(;0<mo.length&&(l=mo[0],l.blockedOn===null);)iw(l),l.blockedOn===null&&mo.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var m=l[h],y=l[h+1],w=m[Dt]||null;if(typeof y=="function")w||ow(l);else if(w){var j=null;if(y&&y.hasAttribute("formAction")){if(m=y,w=y[Dt]||null)j=w.formAction;else if(Ey(m)!==null)continue}else j=w.action;typeof j=="function"?l[h+1]=j:(l.splice(h,3),h-=3),ow(l)}}}function lw(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function Sy(r){this._internalRoot=r}Uf.prototype.render=Sy.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var l=i.current,h=Xr();Z_(l,h,r,i,null,null)},Uf.prototype.unmount=Sy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Z_(r.current,2,null,r,null,null),xf(),i[ut]=null}};function Uf(r){this._internalRoot=r}Uf.prototype.unstable_scheduleHydration=function(r){if(r){var i=ke();r={blockedOn:null,target:r,priority:i};for(var l=0;l<mo.length&&i!==0&&i<mo[l].priority;l++);mo.splice(l,0,r),l===0&&iw(r)}};var cw=e.version;if(cw!=="19.2.4")throw Error(s(527,cw,"19.2.4"));ye.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=g(i),r=r!==null?b(r):null,r=r===null?null:r.stateNode,r};var OA={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{et=Ff.inject(OA),Ue=Ff}catch{}}return yh.createRoot=function(r,i){if(!o(r))throw Error(s(299));var l=!1,h="",m=gx,y=yx,w=bx;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(w=i.onRecoverableError)),i=X_(r,1,!1,null,null,l,h,null,m,y,w,lw),r[ut]=i.current,oy(r),new Sy(i)},yh.hydrateRoot=function(r,i,l){if(!o(r))throw Error(s(299));var h=!1,m="",y=gx,w=yx,j=bx,F=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.formState!==void 0&&(F=l.formState)),i=X_(r,1,!0,i,l??null,h,m,F,y,w,j,lw),i.context=J_(null),l=i.current,h=Xr(),h=z(h),m=Ja(h),m.callback=null,Za(l,m,h),l=h,i.current.lanes=l,Fn(i,l),qi(i),r[ut]=i.current,oy(r),new Uf(i)},yh.version="19.2.4",yh}var vw;function KA(){if(vw)return Ay.exports;vw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ay.exports=GA(),Ay.exports}var QA=KA();const YA="modulepreload",XA=function(n){return"/login/"+n},xw={},Cr=function(e,t,s){let o=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");o=p(t.map(g=>{if(g=XA(g),g in xw)return;xw[g]=!0;const b=g.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${x}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":YA,b||(T.as="script"),T.crossOrigin="",T.href=g,d&&T.setAttribute("nonce",d),document.head.appendChild(T),b)return new Promise((N,B)=>{T.addEventListener("load",N),T.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&c(d.reason);return e().catch(c)})};var _w="popstate";function JA(n={}){function e(s,o){let{pathname:c,search:u,hash:d}=s.location;return gb("",{pathname:c,search:u,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(s,o){return typeof o=="string"?o:Wh(o)}return eR(e,t,null,n)}function xs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function vi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZA(){return Math.random().toString(36).substring(2,10)}function ww(n,e){return{usr:n.state,key:n.key,idx:e}}function gb(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?bu(e):e,state:t,key:e&&e.key||s||ZA()}}function Wh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function bu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function eR(n,e,t,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,u=o.history,d="POP",p=null,g=b();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function b(){return(u.state||{idx:null}).idx}function x(){d="POP";let D=b(),X=D==null?null:D-g;g=D,p&&p({action:d,location:M.location,delta:X})}function T(D,X){d="PUSH";let H=gb(M.location,D,X);g=b()+1;let J=ww(H,g),he=M.createHref(H);try{u.pushState(J,"",he)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;o.location.assign(he)}c&&p&&p({action:d,location:M.location,delta:1})}function N(D,X){d="REPLACE";let H=gb(M.location,D,X);g=b();let J=ww(H,g),he=M.createHref(H);u.replaceState(J,"",he),c&&p&&p({action:d,location:M.location,delta:0})}function B(D){return tR(D)}let M={get action(){return d},get location(){return n(o,u)},listen(D){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(_w,x),p=D,()=>{o.removeEventListener(_w,x),p=null}},createHref(D){return e(o,D)},createURL:B,encodeLocation(D){let X=B(D);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:T,replace:N,go(D){return u.go(D)}};return M}function tR(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xs(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:Wh(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function $T(n,e,t="/"){return nR(n,e,t,!1)}function nR(n,e,t,s){let o=typeof e=="string"?bu(e):e,c=Ca(o.pathname||"/",t);if(c==null)return null;let u=WT(n);sR(u);let d=null;for(let p=0;d==null&&p<u.length;++p){let g=mR(c);d=dR(u[p],g,s)}return d}function WT(n,e=[],t=[],s="",o=!1){let c=(u,d,p=o,g)=>{let b={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(s)&&p)return;xs(b.relativePath.startsWith(s),`Absolute route path "${b.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(s.length)}let x=Na([s,b.relativePath]),T=t.concat(b);u.children&&u.children.length>0&&(xs(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),WT(u.children,e,T,x,p)),!(u.path==null&&!u.index)&&e.push({path:x,score:uR(x,u.index),routesMeta:T})};return n.forEach((u,d)=>{if(u.path===""||!u.path?.includes("?"))c(u,d);else for(let p of GT(u.path))c(u,d,!0,p)}),e}function GT(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let u=GT(s.join("/")),d=[];return d.push(...u.map(p=>p===""?c:[c,p].join("/"))),o&&d.push(...u),d.map(p=>n.startsWith("/")&&p===""?"/":p)}function sR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:hR(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var rR=/^:[\w-]+$/,iR=3,aR=2,oR=1,lR=10,cR=-2,Tw=n=>n==="*";function uR(n,e){let t=n.split("/"),s=t.length;return t.some(Tw)&&(s+=cR),e&&(s+=aR),t.filter(o=>!Tw(o)).reduce((o,c)=>o+(rR.test(c)?iR:c===""?oR:lR),s)}function hR(n,e){return n.length===e.length&&n.slice(0,-1).every((s,o)=>s===e[o])?n[n.length-1]-e[e.length-1]:0}function dR(n,e,t=!1){let{routesMeta:s}=n,o={},c="/",u=[];for(let d=0;d<s.length;++d){let p=s[d],g=d===s.length-1,b=c==="/"?e:e.slice(c.length)||"/",x=Tm({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},b),T=p.route;if(!x&&g&&t&&!s[s.length-1].route.index&&(x=Tm({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},b)),!x)return null;Object.assign(o,x.params),u.push({params:o,pathname:Na([c,x.pathname]),pathnameBase:bR(Na([c,x.pathnameBase])),route:T}),x.pathnameBase!=="/"&&(c=Na([c,x.pathnameBase]))}return u}function Tm(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=fR(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],u=c.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((g,{paramName:b,isOptional:x},T)=>{if(b==="*"){let B=d[T]||"";u=c.slice(0,c.length-B.length).replace(/(.)\/+$/,"$1")}const N=d[T];return x&&!N?g[b]=void 0:g[b]=(N||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:u,pattern:n}}function fR(n,e=!1,t=!0){vi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,p)=>(s.push({paramName:d,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function mR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return vi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ca(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var pR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function gR(n,e="/"){let{pathname:t,search:s="",hash:o=""}=typeof n=="string"?bu(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=Ew(t.substring(1),"/"):c=Ew(t,e)):c=e,{pathname:c,search:vR(s),hash:xR(o)}}function Ew(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Dy(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function rv(n){let e=yR(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function iv(n,e,t,s=!1){let o;typeof n=="string"?o=bu(n):(o={...n},xs(!o.pathname||!o.pathname.includes("?"),Dy("?","pathname","search",o)),xs(!o.pathname||!o.pathname.includes("#"),Dy("#","pathname","hash",o)),xs(!o.search||!o.search.includes("#"),Dy("#","search","hash",o)));let c=n===""||o.pathname==="",u=c?"/":o.pathname,d;if(u==null)d=t;else{let x=e.length-1;if(!s&&u.startsWith("..")){let T=u.split("/");for(;T[0]==="..";)T.shift(),x-=1;o.pathname=T.join("/")}d=x>=0?e[x]:"/"}let p=gR(o,d),g=u&&u!=="/"&&u.endsWith("/"),b=(c||u===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(g||b)&&(p.pathname+="/"),p}var Na=n=>n.join("/").replace(/\/\/+/g,"/"),bR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),vR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,xR=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,_R=class{constructor(n,e,t,s=!1){this.status=n,this.statusText=e||"",this.internal=s,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function wR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function TR(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var KT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function QT(n,e){let t=n;if(typeof t!="string"||!pR.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let s=t,o=!1;if(KT)try{let c=new URL(window.location.href),u=t.startsWith("//")?new URL(c.protocol+t):new URL(t),d=Ca(u.pathname,e);u.origin===c.origin&&d!=null?t=d+u.search+u.hash:o=!0}catch{vi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YT=["POST","PUT","PATCH","DELETE"];new Set(YT);var ER=["GET",...YT];new Set(ER);var vu=_.createContext(null);vu.displayName="DataRouter";var Zm=_.createContext(null);Zm.displayName="DataRouterState";var kR=_.createContext(!1),XT=_.createContext({isTransitioning:!1});XT.displayName="ViewTransition";var SR=_.createContext(new Map);SR.displayName="Fetchers";var jR=_.createContext(null);jR.displayName="Await";var ri=_.createContext(null);ri.displayName="Navigation";var cd=_.createContext(null);cd.displayName="Location";var Mi=_.createContext({outlet:null,matches:[],isDataRoute:!1});Mi.displayName="Route";var av=_.createContext(null);av.displayName="RouteError";var JT="REACT_ROUTER_ERROR",NR="REDIRECT",AR="ROUTE_ERROR_RESPONSE";function RR(n){if(n.startsWith(`${JT}:${NR}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function CR(n){if(n.startsWith(`${JT}:${AR}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new _R(e.status,e.statusText,e.data)}catch{}}function IR(n,{relative:e}={}){xs(xu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=_.useContext(ri),{hash:o,pathname:c,search:u}=ud(n,{relative:e}),d=c;return t!=="/"&&(d=c==="/"?t:Na([t,c])),s.createHref({pathname:d,search:u,hash:o})}function xu(){return _.useContext(cd)!=null}function Li(){return xs(xu(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(cd).location}var ZT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eE(n){_.useContext(ri).static||_.useLayoutEffect(n)}function gr(){let{isDataRoute:n}=_.useContext(Mi);return n?WR():DR()}function DR(){xs(xu(),"useNavigate() may be used only in the context of a <Router> component.");let n=_.useContext(vu),{basename:e,navigator:t}=_.useContext(ri),{matches:s}=_.useContext(Mi),{pathname:o}=Li(),c=JSON.stringify(rv(s)),u=_.useRef(!1);return eE(()=>{u.current=!0}),_.useCallback((p,g={})=>{if(vi(u.current,ZT),!u.current)return;if(typeof p=="number"){t.go(p);return}let b=iv(p,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Na([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}_.createContext(null);function PR(){let{matches:n}=_.useContext(Mi),e=n[n.length-1];return e?e.params:{}}function ud(n,{relative:e}={}){let{matches:t}=_.useContext(Mi),{pathname:s}=Li(),o=JSON.stringify(rv(t));return _.useMemo(()=>iv(n,JSON.parse(o),s,e==="path"),[n,o,s,e])}function MR(n,e){return tE(n,e)}function tE(n,e,t,s,o){xs(xu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=_.useContext(ri),{matches:u}=_.useContext(Mi),d=u[u.length-1],p=d?d.params:{},g=d?d.pathname:"/",b=d?d.pathnameBase:"/",x=d&&d.route;{let H=x&&x.path||"";sE(g,!x||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let T=Li(),N;if(e){let H=typeof e=="string"?bu(e):e;xs(b==="/"||H.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${H.pathname}" was given in the \`location\` prop.`),N=H}else N=T;let B=N.pathname||"/",M=B;if(b!=="/"){let H=b.replace(/^\//,"").split("/");M="/"+B.replace(/^\//,"").split("/").slice(H.length).join("/")}let D=$T(n,{pathname:M});vi(x||D!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),vi(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let X=UR(D&&D.map(H=>Object.assign({},H,{params:Object.assign({},p,H.params),pathname:Na([b,c.encodeLocation?c.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?b:Na([b,c.encodeLocation?c.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),u,t,s,o);return e&&X?_.createElement(cd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},X):X}function LR(){let n=$R(),e=wR(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:c},"ErrorBoundary")," or"," ",_.createElement("code",{style:c},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:o},t):null,u)}var VR=_.createElement(LR,null),nE=class extends _.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=CR(n.digest);t&&(n=t)}let e=n!==void 0?_.createElement(Mi.Provider,{value:this.props.routeContext},_.createElement(av.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?_.createElement(OR,{error:n},e):e}};nE.contextType=kR;var Py=new WeakMap;function OR({children:n,error:e}){let{basename:t}=_.useContext(ri);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=RR(e.digest);if(s){let o=Py.get(e);if(o)throw o;let c=QT(s.location,t);if(KT&&!Py.get(e))if(c.isExternal||s.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:s.replace}));throw Py.set(e,u),u}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function BR({routeContext:n,match:e,children:t}){let s=_.useContext(vu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(Mi.Provider,{value:n},t)}function UR(n,e=[],t=null,s=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,u=t?.errors;if(u!=null){let b=c.findIndex(x=>x.route.id&&u?.[x.route.id]!==void 0);xs(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let d=!1,p=-1;if(t)for(let b=0;b<c.length;b++){let x=c[b];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=b),x.route.id){let{loaderData:T,errors:N}=t,B=x.route.loader&&!T.hasOwnProperty(x.route.id)&&(!N||N[x.route.id]===void 0);if(x.route.lazy||B){d=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}let g=t&&s?(b,x)=>{s(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:TR(t.matches),errorInfo:x})}:void 0;return c.reduceRight((b,x,T)=>{let N,B=!1,M=null,D=null;t&&(N=u&&x.route.id?u[x.route.id]:void 0,M=x.route.errorElement||VR,d&&(p<0&&T===0?(sE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,D=null):p===T&&(B=!0,D=x.route.hydrateFallbackElement||null)));let X=e.concat(c.slice(0,T+1)),H=()=>{let J;return N?J=M:B?J=D:x.route.Component?J=_.createElement(x.route.Component,null):x.route.element?J=x.route.element:J=b,_.createElement(BR,{match:x,routeContext:{outlet:b,matches:X,isDataRoute:t!=null},children:J})};return t&&(x.route.ErrorBoundary||x.route.errorElement||T===0)?_.createElement(nE,{location:t.location,revalidation:t.revalidation,component:M,error:N,children:H(),routeContext:{outlet:null,matches:X,isDataRoute:!0},onError:g}):H()},null)}function ov(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FR(n){let e=_.useContext(vu);return xs(e,ov(n)),e}function zR(n){let e=_.useContext(Zm);return xs(e,ov(n)),e}function qR(n){let e=_.useContext(Mi);return xs(e,ov(n)),e}function lv(n){let e=qR(n),t=e.matches[e.matches.length-1];return xs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function HR(){return lv("useRouteId")}function $R(){let n=_.useContext(av),e=zR("useRouteError"),t=lv("useRouteError");return n!==void 0?n:e.errors?.[t]}function WR(){let{router:n}=FR("useNavigate"),e=lv("useNavigate"),t=_.useRef(!1);return eE(()=>{t.current=!0}),_.useCallback(async(o,c={})=>{vi(t.current,ZT),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var kw={};function sE(n,e,t){!e&&!kw[n]&&(kw[n]=!0,vi(!1,t))}_.memo(GR);function GR({routes:n,future:e,state:t,onError:s}){return tE(n,void 0,t,s,e)}function KR({to:n,replace:e,state:t,relative:s}){xs(xu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=_.useContext(ri);vi(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=_.useContext(Mi),{pathname:u}=Li(),d=gr(),p=iv(n,rv(c),u,s==="path"),g=JSON.stringify(p);return _.useEffect(()=>{d(JSON.parse(g),{replace:e,state:t,relative:s})},[d,g,s,e,t]),null}function cs(n){xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function QR({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:o,static:c=!1,unstable_useTransitions:u}){xs(!xu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),p=_.useMemo(()=>({basename:d,navigator:o,static:c,unstable_useTransitions:u,future:{}}),[d,o,c,u]);typeof t=="string"&&(t=bu(t));let{pathname:g="/",search:b="",hash:x="",state:T=null,key:N="default"}=t,B=_.useMemo(()=>{let M=Ca(g,d);return M==null?null:{location:{pathname:M,search:b,hash:x,state:T,key:N},navigationType:s}},[d,g,b,x,T,N,s]);return vi(B!=null,`<Router basename="${d}"> is not able to match the URL "${g}${b}${x}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:_.createElement(ri.Provider,{value:p},_.createElement(cd.Provider,{children:e,value:B}))}function YR({children:n,location:e}){return MR(yb(n),e)}function yb(n,e=[]){let t=[];return _.Children.forEach(n,(s,o)=>{if(!_.isValidElement(s))return;let c=[...e,o];if(s.type===_.Fragment){t.push.apply(t,yb(s.props.children,c));return}xs(s.type===cs,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xs(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=yb(s.props.children,c)),t.push(u)}),t}var am="get",om="application/x-www-form-urlencoded";function ep(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function XR(n){return ep(n)&&n.tagName.toLowerCase()==="button"}function JR(n){return ep(n)&&n.tagName.toLowerCase()==="form"}function ZR(n){return ep(n)&&n.tagName.toLowerCase()==="input"}function eC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function tC(n,e){return n.button===0&&(!e||e==="_self")&&!eC(n)}function bb(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(o=>[t,o]):[[t,s]])},[]))}function nC(n,e){let t=bb(n);return e&&e.forEach((s,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var zf=null;function sC(){if(zf===null)try{new FormData(document.createElement("form"),0),zf=!1}catch{zf=!0}return zf}var rC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function My(n){return n!=null&&!rC.has(n)?(vi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${om}"`),null):n}function iC(n,e){let t,s,o,c,u;if(JR(n)){let d=n.getAttribute("action");s=d?Ca(d,e):null,t=n.getAttribute("method")||am,o=My(n.getAttribute("enctype"))||om,c=new FormData(n)}else if(XR(n)||ZR(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=n.getAttribute("formaction")||d.getAttribute("action");if(s=p?Ca(p,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||am,o=My(n.getAttribute("formenctype"))||My(d.getAttribute("enctype"))||om,c=new FormData(d,n),!sC()){let{name:g,type:b,value:x}=n;if(b==="image"){let T=g?`${g}.`:"";c.append(`${T}x`,"0"),c.append(`${T}y`,"0")}else g&&c.append(g,x)}}else{if(ep(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=am,s=null,o=om,u=n}return c&&o==="text/plain"&&(u=c,c=void 0),{action:s,method:t.toLowerCase(),encType:o,formData:c,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cv(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function aC(n,e,t,s){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:e&&Ca(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function oC(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function lC(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function cC(n,e,t){let s=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let u=await oC(c,t);return u.links?u.links():[]}return[]}));return fC(s.flat(1).filter(lC).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Sw(n,e,t,s,o,c){let u=(p,g)=>t[g]?p.route.id!==t[g].route.id:!0,d=(p,g)=>t[g].pathname!==p.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==p.params["*"];return c==="assets"?e.filter((p,g)=>u(p,g)||d(p,g)):c==="data"?e.filter((p,g)=>{let b=s.routes[p.route.id];if(!b||!b.hasLoader)return!1;if(u(p,g)||d(p,g))return!0;if(p.route.shouldRevalidate){let x=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function uC(n,e,{includeHydrateFallback:t}={}){return hC(n.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function hC(n){return[...new Set(n)]}function dC(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function fC(n,e){let t=new Set;return new Set(e),n.reduce((s,o)=>{let c=JSON.stringify(dC(o));return t.has(c)||(t.add(c),s.push({key:c,link:o})),s},[])}function rE(){let n=_.useContext(vu);return cv(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function mC(){let n=_.useContext(Zm);return cv(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var uv=_.createContext(void 0);uv.displayName="FrameworkContext";function iE(){let n=_.useContext(uv);return cv(n,"You must render this element inside a <HydratedRouter> element"),n}function pC(n,e){let t=_.useContext(uv),[s,o]=_.useState(!1),[c,u]=_.useState(!1),{onFocus:d,onBlur:p,onMouseEnter:g,onMouseLeave:b,onTouchStart:x}=e,T=_.useRef(null);_.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let M=X=>{X.forEach(H=>{u(H.isIntersecting)})},D=new IntersectionObserver(M,{threshold:.5});return T.current&&D.observe(T.current),()=>{D.disconnect()}}},[n]),_.useEffect(()=>{if(s){let M=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(M)}}},[s]);let N=()=>{o(!0)},B=()=>{o(!1),u(!1)};return t?n!=="intent"?[c,T,{}]:[c,T,{onFocus:bh(d,N),onBlur:bh(p,B),onMouseEnter:bh(g,N),onMouseLeave:bh(b,B),onTouchStart:bh(x,N)}]:[!1,T,{}]}function bh(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function gC({page:n,...e}){let{router:t}=rE(),s=_.useMemo(()=>$T(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?_.createElement(bC,{page:n,matches:s,...e}):null}function yC(n){let{manifest:e,routeModules:t}=iE(),[s,o]=_.useState([]);return _.useEffect(()=>{let c=!1;return cC(n,e,t).then(u=>{c||o(u)}),()=>{c=!0}},[n,e,t]),s}function bC({page:n,matches:e,...t}){let s=Li(),{future:o,manifest:c,routeModules:u}=iE(),{basename:d}=rE(),{loaderData:p,matches:g}=mC(),b=_.useMemo(()=>Sw(n,e,g,c,s,"data"),[n,e,g,c,s]),x=_.useMemo(()=>Sw(n,e,g,c,s,"assets"),[n,e,g,c,s]),T=_.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let M=new Set,D=!1;if(e.forEach(H=>{let J=c.routes[H.route.id];!J||!J.hasLoader||(!b.some(he=>he.route.id===H.route.id)&&H.route.id in p&&u[H.route.id]?.shouldRevalidate||J.hasClientLoader?D=!0:M.add(H.route.id))}),M.size===0)return[];let X=aC(n,d,o.unstable_trailingSlashAwareDataRequests,"data");return D&&M.size>0&&X.searchParams.set("_routes",e.filter(H=>M.has(H.route.id)).map(H=>H.route.id).join(",")),[X.pathname+X.search]},[d,o.unstable_trailingSlashAwareDataRequests,p,s,c,b,e,n,u]),N=_.useMemo(()=>uC(x,c),[x,c]),B=yC(x);return _.createElement(_.Fragment,null,T.map(M=>_.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...t})),N.map(M=>_.createElement("link",{key:M,rel:"modulepreload",href:M,...t})),B.map(({key:M,link:D})=>_.createElement("link",{key:M,nonce:t.nonce,...D,crossOrigin:D.crossOrigin??t.crossOrigin})))}function vC(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var xC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xC&&(window.__reactRouterVersion="7.13.0")}catch{}function _C({basename:n,children:e,unstable_useTransitions:t,window:s}){let o=_.useRef();o.current==null&&(o.current=JA({window:s,v5Compat:!0}));let c=o.current,[u,d]=_.useState({action:c.action,location:c.location}),p=_.useCallback(g=>{t===!1?d(g):_.startTransition(()=>d(g))},[t]);return _.useLayoutEffect(()=>c.listen(p),[c,p]),_.createElement(QR,{basename:n,children:e,location:u.location,navigationType:u.action,navigator:c,unstable_useTransitions:t})}var aE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oE=_.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:o,reloadDocument:c,replace:u,state:d,target:p,to:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B){let{basename:M,unstable_useTransitions:D}=_.useContext(ri),X=typeof g=="string"&&aE.test(g),H=QT(g,M);g=H.to;let J=IR(g,{relative:o}),[he,Ne,Te]=pC(s,N),C=kC(g,{replace:u,state:d,target:p,preventScrollReset:b,relative:o,viewTransition:x,unstable_defaultShouldRevalidate:T,unstable_useTransitions:D});function S(U){e&&e(U),U.defaultPrevented||C(U)}let P=_.createElement("a",{...N,...Te,href:H.absoluteURL||J,onClick:H.isExternal||c?e:S,ref:vC(B,Ne),target:p,"data-discover":!X&&t==="render"?"true":void 0});return he&&!X?_.createElement(_.Fragment,null,P,_.createElement(gC,{page:J})):P});oE.displayName="Link";var wC=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:o=!1,style:c,to:u,viewTransition:d,children:p,...g},b){let x=ud(u,{relative:g.relative}),T=Li(),N=_.useContext(Zm),{navigator:B,basename:M}=_.useContext(ri),D=N!=null&&CC(x)&&d===!0,X=B.encodeLocation?B.encodeLocation(x).pathname:x.pathname,H=T.pathname,J=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;t||(H=H.toLowerCase(),J=J?J.toLowerCase():null,X=X.toLowerCase()),J&&M&&(J=Ca(J,M)||J);const he=X!=="/"&&X.endsWith("/")?X.length-1:X.length;let Ne=H===X||!o&&H.startsWith(X)&&H.charAt(he)==="/",Te=J!=null&&(J===X||!o&&J.startsWith(X)&&J.charAt(X.length)==="/"),C={isActive:Ne,isPending:Te,isTransitioning:D},S=Ne?e:void 0,P;typeof s=="function"?P=s(C):P=[s,Ne?"active":null,Te?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let U=typeof c=="function"?c(C):c;return _.createElement(oE,{...g,"aria-current":S,className:P,ref:b,style:U,to:u,viewTransition:d},typeof p=="function"?p(C):p)});wC.displayName="NavLink";var TC=_.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:o,state:c,method:u=am,action:d,onSubmit:p,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B)=>{let{unstable_useTransitions:M}=_.useContext(ri),D=AC(),X=RC(d,{relative:g}),H=u.toLowerCase()==="get"?"get":"post",J=typeof d=="string"&&aE.test(d),he=Ne=>{if(p&&p(Ne),Ne.defaultPrevented)return;Ne.preventDefault();let Te=Ne.nativeEvent.submitter,C=Te?.getAttribute("formmethod")||u,S=()=>D(Te||Ne.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T});M&&t!==!1?_.startTransition(()=>S()):S()};return _.createElement("form",{ref:B,method:H,action:X,onSubmit:s?p:he,...N,"data-discover":!J&&n==="render"?"true":void 0})});TC.displayName="Form";function EC(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lE(n){let e=_.useContext(vu);return xs(e,EC(n)),e}function kC(n,{target:e,replace:t,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d,unstable_useTransitions:p}={}){let g=gr(),b=Li(),x=ud(n,{relative:c});return _.useCallback(T=>{if(tC(T,e)){T.preventDefault();let N=t!==void 0?t:Wh(b)===Wh(x),B=()=>g(n,{replace:N,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d});p?_.startTransition(()=>B()):B()}},[b,g,x,t,s,e,n,o,c,u,d,p])}function SC(n){vi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(bb(n)),t=_.useRef(!1),s=Li(),o=_.useMemo(()=>nC(s.search,t.current?null:e.current),[s.search]),c=gr(),u=_.useCallback((d,p)=>{const g=bb(typeof d=="function"?d(new URLSearchParams(o)):d);t.current=!0,c("?"+g,p)},[c,o]);return[o,u]}var jC=0,NC=()=>`__${String(++jC)}__`;function AC(){let{router:n}=lE("useSubmit"),{basename:e}=_.useContext(ri),t=HR(),s=n.fetch,o=n.navigate;return _.useCallback(async(c,u={})=>{let{action:d,method:p,encType:g,formData:b,body:x}=iC(c,e);if(u.navigate===!1){let T=u.fetcherKey||NC();await s(T,t,u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||p,formEncType:u.encType||g,flushSync:u.flushSync})}else await o(u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||p,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:t,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,o,e,t])}function RC(n,{relative:e}={}){let{basename:t}=_.useContext(ri),s=_.useContext(Mi);xs(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...ud(n||".",{relative:e})},u=Li();if(n==null){c.search=u.search;let d=new URLSearchParams(c.search),p=d.getAll("index");if(p.some(b=>b==="")){d.delete("index"),p.filter(x=>x).forEach(x=>d.append("index",x));let b=d.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Na([t,c.pathname])),Wh(c)}function CC(n,{relative:e}={}){let t=_.useContext(XT);xs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=lE("useViewTransitionState"),o=ud(n,{relative:e});if(!t.isTransitioning)return!1;let c=Ca(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=Ca(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Tm(o.pathname,u)!=null||Tm(o.pathname,c)!=null}const IC=()=>{};var jw={};const cE=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},DC=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const o=n[t++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[s++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],u=n[t++],d=n[t++],p=((o&7)<<18|(c&63)<<12|(u&63)<<6|d&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],u=n[t++];e[s++]=String.fromCharCode((o&15)<<12|(c&63)<<6|u&63)}}return e.join("")},uE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<n.length;o+=3){const c=n[o],u=o+1<n.length,d=u?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,b=c>>2,x=(c&3)<<4|d>>4;let T=(d&15)<<2|g>>6,N=g&63;p||(N=64,u||(T=64)),s.push(t[b],t[x],t[T],t[N])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):DC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||d==null||g==null||x==null)throw new PC;const T=c<<2|d>>4;if(s.push(T),g!==64){const N=d<<4&240|g>>2;if(s.push(N),x!==64){const B=g<<6&192|x;s.push(B)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MC=function(n){const e=cE(n);return uE.encodeByteArray(e,!0)},Em=function(n){return MC(n).replace(/\./g,"")},hE=function(n){try{return uE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function dE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const LC=()=>dE().__FIREBASE_DEFAULTS__,VC=()=>{if(typeof process>"u"||typeof jw>"u")return;const n=jw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&hE(n[1]);return e&&JSON.parse(e)},tp=()=>{try{return IC()||LC()||VC()||OC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fE=n=>tp()?.emulatorHosts?.[n],mE=n=>{const e=fE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},pE=()=>tp()?.config,gE=n=>tp()?.[`_${n}`];class BC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function Va(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function np(n){return(await fetch(n,{credentials:"include"})).ok}function yE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Em(JSON.stringify(t)),Em(JSON.stringify(u)),""].join(".")}const Ph={};function UC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ph))Ph[e]?n.emulator.push(e):n.prod.push(e);return n}function FC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Nw=!1;function hv(n,e){if(typeof window>"u"||typeof document>"u"||!Va(window.location.host)||Ph[n]===e||Ph[n]||Nw)return;Ph[n]=e;function t(T){return`__firebase__banner__${T}`}const s="__firebase__banner",c=UC().prod.length>0;function u(){const T=document.getElementById(s);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function p(T,N){T.setAttribute("width","24"),T.setAttribute("id",N),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function g(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{Nw=!0,u()},T}function b(T,N){T.setAttribute("id",N),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function x(){const T=FC(s),N=t("text"),B=document.getElementById(N)||document.createElement("span"),M=t("learnmore"),D=document.getElementById(M)||document.createElement("a"),X=t("preprendIcon"),H=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const J=T.element;d(J),b(D,M);const he=g();p(H,X),J.append(H,B,D,he),document.body.appendChild(J)}c?(B.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function bE(){const n=tp()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function $C(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WC(){const n=Xs();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vE(){return!bE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xE(){return!bE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function _E(){try{return typeof indexedDB=="object"}catch{return!1}}function GC(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const KC="FirebaseError";class ia extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=KC,Object.setPrototypeOf(this,ia.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hd.prototype.create)}}class hd{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],u=c?QC(c,s):"Error",d=`${this.serviceName}: ${u} (${o}).`;return new ia(o,d,s)}}function QC(n,e){return n.replace(YC,(t,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const YC=/\{\$([^}]+)}/g;function XC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Di(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const o of t){if(!s.includes(o))return!1;const c=n[o],u=e[o];if(Aw(c)&&Aw(u)){if(!Di(c,u))return!1}else if(c!==u)return!1}for(const o of s)if(!t.includes(o))return!1;return!0}function Aw(n){return n!==null&&typeof n=="object"}function dd(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Nh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,c]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ah(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function JC(n,e){const t=new ZC(n,e);return t.subscribe.bind(t)}class ZC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let o;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");eI(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:s},o.next===void 0&&(o.next=Ly),o.error===void 0&&(o.error=Ly),o.complete===void 0&&(o.complete=Ly);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eI(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ly(){}function Cn(n){return n&&n._delegate?n._delegate:n}class Oo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xl="[DEFAULT]";class tI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new BC;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sI(e))try{this.getOrInitializeService({instanceIdentifier:xl})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});s.resolve(c)}catch{}}}}clearInstance(e=xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xl){return this.instances.has(e)}getOptions(e=xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[c,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(c);s===d&&u.resolve(o)}return o}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const o of s)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:nI(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=xl){return this.component?this.component.multipleInstances?e:xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nI(n){return n===xl?void 0:n}function sI(n){return n.instantiationMode==="EAGER"}class rI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new tI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var En;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(En||(En={}));const iI={debug:En.DEBUG,verbose:En.VERBOSE,info:En.INFO,warn:En.WARN,error:En.ERROR,silent:En.SILENT},aI=En.INFO,oI={[En.DEBUG]:"log",[En.VERBOSE]:"log",[En.INFO]:"info",[En.WARN]:"warn",[En.ERROR]:"error"},lI=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),o=oI[e];if(o)console[o](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=aI,this._logHandler=lI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in En))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,En.DEBUG,...e),this._logHandler(this,En.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,En.VERBOSE,...e),this._logHandler(this,En.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,En.INFO,...e),this._logHandler(this,En.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,En.WARN,...e),this._logHandler(this,En.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,En.ERROR,...e),this._logHandler(this,En.ERROR,...e)}}const cI=(n,e)=>e.some(t=>n instanceof t);let Rw,Cw;function uI(){return Rw||(Rw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hI(){return Cw||(Cw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wE=new WeakMap,vb=new WeakMap,TE=new WeakMap,Vy=new WeakMap,fv=new WeakMap;function dI(n){const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",u)},c=()=>{t(Po(n.result)),o()},u=()=>{s(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&wE.set(t,n)}).catch(()=>{}),fv.set(e,n),e}function fI(n){if(vb.has(n))return;const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",u),n.removeEventListener("abort",u)},c=()=>{t(),o()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",u),n.addEventListener("abort",u)});vb.set(n,e)}let xb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||TE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Po(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function mI(n){xb=n(xb)}function pI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Oy(this),e,...t);return TE.set(s,e.sort?e.sort():[e]),Po(s)}:hI().includes(n)?function(...e){return n.apply(Oy(this),e),Po(wE.get(this))}:function(...e){return Po(n.apply(Oy(this),e))}}function gI(n){return typeof n=="function"?pI(n):(n instanceof IDBTransaction&&fI(n),cI(n,uI())?new Proxy(n,xb):n)}function Po(n){if(n instanceof IDBRequest)return dI(n);if(Vy.has(n))return Vy.get(n);const e=gI(n);return e!==n&&(Vy.set(n,e),fv.set(e,n)),e}const Oy=n=>fv.get(n);function yI(n,e,{blocked:t,upgrade:s,blocking:o,terminated:c}={}){const u=indexedDB.open(n,e),d=Po(u);return s&&u.addEventListener("upgradeneeded",p=>{s(Po(u.result),p.oldVersion,p.newVersion,Po(u.transaction),p)}),t&&u.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const bI=["get","getKey","getAll","getAllKeys","count"],vI=["put","add","delete","clear"],By=new Map;function Iw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(By.get(e))return By.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,o=vI.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(o||bI.includes(t)))return;const c=async function(u,...d){const p=this.transaction(u,o?"readwrite":"readonly");let g=p.store;return s&&(g=g.index(d.shift())),(await Promise.all([g[t](...d),o&&p.done]))[0]};return By.set(e,c),c}mI(n=>({...n,get:(e,t,s)=>Iw(e,t)||n.get(e,t,s),has:(e,t)=>!!Iw(e,t)||n.has(e,t)}));class xI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_I(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function _I(n){return n.getComponent()?.type==="VERSION"}const _b="@firebase/app",Dw="0.14.7";const Ia=new dv("@firebase/app"),wI="@firebase/app-compat",TI="@firebase/analytics-compat",EI="@firebase/analytics",kI="@firebase/app-check-compat",SI="@firebase/app-check",jI="@firebase/auth",NI="@firebase/auth-compat",AI="@firebase/database",RI="@firebase/data-connect",CI="@firebase/database-compat",II="@firebase/functions",DI="@firebase/functions-compat",PI="@firebase/installations",MI="@firebase/installations-compat",LI="@firebase/messaging",VI="@firebase/messaging-compat",OI="@firebase/performance",BI="@firebase/performance-compat",UI="@firebase/remote-config",FI="@firebase/remote-config-compat",zI="@firebase/storage",qI="@firebase/storage-compat",HI="@firebase/firestore",$I="@firebase/ai",WI="@firebase/firestore-compat",GI="firebase",KI="12.8.0";const km="[DEFAULT]",QI={[_b]:"fire-core",[wI]:"fire-core-compat",[EI]:"fire-analytics",[TI]:"fire-analytics-compat",[SI]:"fire-app-check",[kI]:"fire-app-check-compat",[jI]:"fire-auth",[NI]:"fire-auth-compat",[AI]:"fire-rtdb",[RI]:"fire-data-connect",[CI]:"fire-rtdb-compat",[II]:"fire-fn",[DI]:"fire-fn-compat",[PI]:"fire-iid",[MI]:"fire-iid-compat",[LI]:"fire-fcm",[VI]:"fire-fcm-compat",[OI]:"fire-perf",[BI]:"fire-perf-compat",[UI]:"fire-rc",[FI]:"fire-rc-compat",[zI]:"fire-gcs",[qI]:"fire-gcs-compat",[HI]:"fire-fst",[WI]:"fire-fst-compat",[$I]:"fire-vertex","fire-js":"fire-js",[GI]:"fire-js-all"};const Sm=new Map,YI=new Map,wb=new Map;function Pw(n,e){try{n.container.addComponent(e)}catch(t){Ia.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pl(n){const e=n.name;if(wb.has(e))return Ia.debug(`There were multiple attempts to register component ${e}.`),!1;wb.set(e,n);for(const t of Sm.values())Pw(t,n);for(const t of YI.values())Pw(t,n);return!0}function _u(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function XI(n,e,t=km){_u(n,e).clearInstance(t)}function Zr(n){return n==null?!1:n.settings!==void 0}const JI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mo=new hd("app","Firebase",JI);class ZI{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mo.create("app-deleted",{appName:this._name})}}const Kl=KI;function mv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:km,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw Mo.create("bad-app-name",{appName:String(o)});if(t||(t=pE()),!t)throw Mo.create("no-options");const c=Sm.get(o);if(c){if(Di(t,c.options)&&Di(s,c.config))return c;throw Mo.create("duplicate-app",{appName:o})}const u=new rI(o);for(const p of wb.values())u.addComponent(p);const d=new ZI(t,s,u);return Sm.set(o,d),d}function pv(n=km){const e=Sm.get(n);if(!e&&n===km&&pE())return mv();if(!e)throw Mo.create("no-app",{appName:n});return e}function Yi(n,e,t){let s=QI[n]??n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${s}" with version "${e}":`];o&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ia.warn(u.join(" "));return}Pl(new Oo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const e4="firebase-heartbeat-database",t4=1,Gh="firebase-heartbeat-store";let Uy=null;function EE(){return Uy||(Uy=yI(e4,t4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Mo.create("idb-open",{originalErrorMessage:n.message})})),Uy}async function n4(n){try{const t=(await EE()).transaction(Gh),s=await t.objectStore(Gh).get(kE(n));return await t.done,s}catch(e){if(e instanceof ia)Ia.warn(e.message);else{const t=Mo.create("idb-get",{originalErrorMessage:e?.message});Ia.warn(t.message)}}}async function Mw(n,e){try{const s=(await EE()).transaction(Gh,"readwrite");await s.objectStore(Gh).put(e,kE(n)),await s.done}catch(t){if(t instanceof ia)Ia.warn(t.message);else{const s=Mo.create("idb-set",{originalErrorMessage:t?.message});Ia.warn(s.message)}}}function kE(n){return`${n.name}!${n.options.appId}`}const s4=1024,r4=30;class i4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new o4(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Lw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>r4){const o=l4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ia.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Lw(),{heartbeatsToSend:t,unsentEntries:s}=a4(this._heartbeatsCache.heartbeats),o=Em(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Ia.warn(e),""}}}function Lw(){return new Date().toISOString().substring(0,10)}function a4(n,e=s4){const t=[];let s=n.slice();for(const o of n){const c=t.find(u=>u.agent===o.agent);if(c){if(c.dates.push(o.date),Vw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Vw(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class o4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _E()?GC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await n4(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vw(n){return Em(JSON.stringify({version:2,heartbeats:n})).length}function l4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function c4(n){Pl(new Oo("platform-logger",e=>new xI(e),"PRIVATE")),Pl(new Oo("heartbeat",e=>new i4(e),"PRIVATE")),Yi(_b,Dw,n),Yi(_b,Dw,"esm2020"),Yi("fire-js","")}c4("");function SE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const u4=SE,jE=new hd("auth","Firebase",SE());const jm=new dv("@firebase/auth");function h4(n,...e){jm.logLevel<=En.WARN&&jm.warn(`Auth (${Kl}): ${n}`,...e)}function lm(n,...e){jm.logLevel<=En.ERROR&&jm.error(`Auth (${Kl}): ${n}`,...e)}function Pi(n,...e){throw gv(n,...e)}function Xi(n,...e){return gv(n,...e)}function NE(n,e,t){const s={...u4(),[e]:t};return new hd("auth","Firebase",s).create(e,{appName:n.name})}function Aa(n){return NE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gv(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return jE.create(n,...e)}function Ot(n,e,...t){if(!n)throw gv(e,...t)}function ka(n){const e="INTERNAL ASSERTION FAILED: "+n;throw lm(e),new Error(e)}function Da(n,e){n||ka(e)}function Tb(){return typeof self<"u"&&self.location?.href||""}function d4(){return Ow()==="http:"||Ow()==="https:"}function Ow(){return typeof self<"u"&&self.location?.protocol||null}function f4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(d4()||HC()||"connection"in navigator)?navigator.onLine:!0}function m4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class fd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Da(t>e,"Short delay should be less than long delay!"),this.isMobile=zC()||$C()}get(){return f4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yv(n,e){Da(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class AE{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ka("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ka("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ka("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const p4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const g4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],y4=new fd(3e4,6e4);function Oa(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ba(n,e,t,s,o={}){return RE(n,o,async()=>{let c={},u={};s&&(e==="GET"?u=s:c={body:JSON.stringify(s)});const d=dd({key:n.config.apiKey,...u}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:p,...c};return qC()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Va(n.emulatorConfig.host)&&(g.credentials="include"),AE.fetch()(await CE(n,n.config.apiHost,t,d),g)})}async function RE(n,e,t){n._canInitEmulator=!1;const s={...p4,...e};try{const o=new v4(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await c.json();if("needConfirmation"in u)throw qf(n,"account-exists-with-different-credential",u);if(c.ok&&!("errorMessage"in u))return u;{const d=c.ok?u.errorMessage:u.error.message,[p,g]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw qf(n,"credential-already-in-use",u);if(p==="EMAIL_EXISTS")throw qf(n,"email-already-in-use",u);if(p==="USER_DISABLED")throw qf(n,"user-disabled",u);const b=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw NE(n,b,g);Pi(n,b)}}catch(o){if(o instanceof ia)throw o;Pi(n,"network-request-failed",{message:String(o)})}}async function md(n,e,t,s,o={}){const c=await Ba(n,e,t,s,o);return"mfaPendingCredential"in c&&Pi(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function CE(n,e,t,s){const o=`${e}${t}?${s}`,c=n,u=c.config.emulator?yv(n.config,o):`${n.config.apiScheme}://${o}`;return g4.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(u).toString():u}function b4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class v4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Xi(this.auth,"network-request-failed")),y4.get())})}}function qf(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const o=Xi(n,e,s);return o.customData._tokenResponse=t,o}function Bw(n){return n!==void 0&&n.enterprise!==void 0}class x4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return b4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _4(n,e){return Ba(n,"GET","/v2/recaptchaConfig",Oa(n,e))}async function w4(n,e){return Ba(n,"POST","/v1/accounts:delete",e)}async function Nm(n,e){return Ba(n,"POST","/v1/accounts:lookup",e)}function Mh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function T4(n,e=!1){const t=Cn(n),s=await t.getIdToken(e),o=bv(s);Ot(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,u=c?.sign_in_provider;return{claims:o,token:s,authTime:Mh(Fy(o.auth_time)),issuedAtTime:Mh(Fy(o.iat)),expirationTime:Mh(Fy(o.exp)),signInProvider:u||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Fy(n){return Number(n)*1e3}function bv(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return lm("JWT malformed, contained fewer than 3 sections"),null;try{const o=hE(t);return o?JSON.parse(o):(lm("Failed to decode base64 JWT payload"),null)}catch(o){return lm("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Uw(n){const e=bv(n);return Ot(e,"internal-error"),Ot(typeof e.exp<"u","internal-error"),Ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Kh(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ia&&E4(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function E4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class k4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mh(this.lastLoginAt),this.creationTime=Mh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Am(n){const e=n.auth,t=await n.getIdToken(),s=await Kh(n,Nm(e,{idToken:t}));Ot(s?.users.length,e,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?IE(o.providerUserInfo):[],u=j4(n.providerData,c),d=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!u?.length,g=d?p:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Eb(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function S4(n){const e=Cn(n);await Am(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function j4(n,e){return[...n.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function IE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function N4(n,e){const t=await RE(n,{},async()=>{const s=dd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,u=await CE(n,o,"/v1/token",`key=${c}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:s};return n.emulatorConfig&&Va(n.emulatorConfig.host)&&(p.credentials="include"),AE.fetch()(u,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function A4(n,e){return Ba(n,"POST","/v2/accounts:revokeToken",Oa(n,e))}class Wc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ot(e.idToken,"internal-error"),Ot(typeof e.idToken<"u","internal-error"),Ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ot(e.length!==0,"internal-error");const t=Uw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:o,expiresIn:c}=await N4(e,t);this.updateTokensAndExpiration(s,o,Number(c))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:o,expirationTime:c}=t,u=new Wc;return s&&(Ot(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),o&&(Ot(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),c&&(Ot(typeof c=="number","internal-error",{appName:e}),u.expirationTime=c),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wc,this.toJSON())}_performRefresh(){return ka("not implemented")}}function go(n,e){Ot(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ii{constructor({uid:e,auth:t,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new k4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Eb(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Kh(this,this.stsTokenManager.getToken(this.auth,e));return Ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return T4(this,e)}reload(){return S4(this)}_assign(e){this!==e&&(Ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ii({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Am(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zr(this.auth.app))return Promise.reject(Aa(this.auth));const e=await this.getIdToken();return await Kh(this,w4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:x,emailVerified:T,isAnonymous:N,providerData:B,stsTokenManager:M}=t;Ot(x&&M,e,"internal-error");const D=Wc.fromJSON(this.name,M);Ot(typeof x=="string",e,"internal-error"),go(s,e.name),go(o,e.name),Ot(typeof T=="boolean",e,"internal-error"),Ot(typeof N=="boolean",e,"internal-error"),go(c,e.name),go(u,e.name),go(d,e.name),go(p,e.name),go(g,e.name),go(b,e.name);const X=new Ii({uid:x,auth:e,email:o,emailVerified:T,displayName:s,isAnonymous:N,photoURL:u,phoneNumber:c,tenantId:d,stsTokenManager:D,createdAt:g,lastLoginAt:b});return B&&Array.isArray(B)&&(X.providerData=B.map(H=>({...H}))),p&&(X._redirectEventId=p),X}static async _fromIdTokenResponse(e,t,s=!1){const o=new Wc;o.updateFromServerResponse(t);const c=new Ii({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await Am(c),c}static async _fromGetAccountInfoResponse(e,t,s){const o=t.users[0];Ot(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?IE(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!c?.length,d=new Wc;d.updateFromIdToken(s);const p=new Ii({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:u}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Eb(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}const Fw=new Map;function Sa(n){Da(n instanceof Function,"Expected a class definition");let e=Fw.get(n);return e?(Da(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Fw.set(n,e),e)}class DE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}DE.type="NONE";const zw=DE;function cm(n,e,t){return`firebase:${n}:${e}:${t}`}class Gc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:o,name:c}=this.auth;this.fullUserKey=cm(this.userKey,o.apiKey,c),this.fullPersistenceKey=cm("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Nm(this.auth,{idToken:e}).catch(()=>{});return t?Ii._fromGetAccountInfoResponse(this.auth,t,e):null}return Ii._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Gc(Sa(zw),e,s);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Sa(zw);const u=cm(s,e.config.apiKey,e.name);let d=null;for(const g of t)try{const b=await g._get(u);if(b){let x;if(typeof b=="string"){const T=await Nm(e,{idToken:b}).catch(()=>{});if(!T)break;x=await Ii._fromGetAccountInfoResponse(e,T,b)}else x=Ii._fromJSON(e,b);g!==c&&(d=x),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Gc(c,e,s):(c=p[0],d&&await c._set(u,d.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(u)}catch{}})),new Gc(c,e,s))}}function qw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BE(e))return"Blackberry";if(UE(e))return"Webos";if(ME(e))return"Safari";if((e.includes("chrome/")||LE(e))&&!e.includes("edge/"))return"Chrome";if(OE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function PE(n=Xs()){return/firefox\//i.test(n)}function ME(n=Xs()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LE(n=Xs()){return/crios\//i.test(n)}function VE(n=Xs()){return/iemobile/i.test(n)}function OE(n=Xs()){return/android/i.test(n)}function BE(n=Xs()){return/blackberry/i.test(n)}function UE(n=Xs()){return/webos/i.test(n)}function vv(n=Xs()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function R4(n=Xs()){return vv(n)&&!!window.navigator?.standalone}function C4(){return WC()&&document.documentMode===10}function FE(n=Xs()){return vv(n)||OE(n)||UE(n)||BE(n)||/windows phone/i.test(n)||VE(n)}function zE(n,e=[]){let t;switch(n){case"Browser":t=qw(Xs());break;case"Worker":t=`${qw(Xs())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Kl}/${s}`}class I4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=c=>new Promise((u,d)=>{try{const p=e(c);u(p)}catch(p){d(p)}});s.onAbort=t,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function D4(n,e={}){return Ba(n,"GET","/v2/passwordPolicy",Oa(n,e))}const P4=6;class M4{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??P4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class L4{constructor(e,t,s,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Hw(this),this.idTokenSubscription=new Hw(this),this.beforeStateQueue=new I4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Gc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Nm(this,{idToken:e}),s=await Ii._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Zr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,u=s?._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===u)&&d?.user&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Am(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=m4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zr(this.app))return Promise.reject(Aa(this));const t=e?Cn(e):null;return t&&Ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zr(this.app)?Promise.reject(Aa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zr(this.app)?Promise.reject(Aa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await D4(this),t=new M4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hd("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await A4(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;Ot(t,this,"argument-error"),this.redirectPersistenceManager=await Gc.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ot(d,this,"internal-error"),d.then(()=>{u||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,s,o);return()=>{u=!0,p()}}else{const p=e.addObserver(t);return()=>{u=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&h4(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Wo(n){return Cn(n)}class Hw{constructor(e){this.auth=e,this.observer=null,this.addObserver=JC(t=>this.observer=t)}get next(){return Ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V4(n){sp=n}function qE(n){return sp.loadJS(n)}function O4(){return sp.recaptchaEnterpriseScript}function B4(){return sp.gapiScript}function U4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class F4{constructor(){this.enterprise=new z4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class z4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const q4="recaptcha-enterprise",HE="NO_RECAPTCHA";class H4{constructor(e){this.type=q4,this.auth=Wo(e)}async verify(e="verify",t=!1){async function s(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(u,d)=>{_4(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const g=new x4(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,u(g.siteKey)}}).catch(p=>{d(p)})})}function o(c,u,d){const p=window.grecaptcha;Bw(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{u(g)}).catch(()=>{u(HE)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new F4().execute("siteKey",{action:"verify"}):new Promise((c,u)=>{s(this.auth).then(d=>{if(!t&&Bw(window.grecaptcha))o(d,c,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let p=O4();p.length!==0&&(p+=d),qE(p).then(()=>{o(d,c,u)}).catch(g=>{u(g)})}}).catch(d=>{u(d)})})}}async function $w(n,e,t,s=!1,o=!1){const c=new H4(n);let u;if(o)u=HE;else try{u=await c.verify(t)}catch{u=await c.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,g=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return s?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Rm(n,e,t,s,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await $w(n,e,t,t==="getOobCode");return s(n,c)}else return s(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await $w(n,e,t,t==="getOobCode");return s(n,u)}else return Promise.reject(c)})}function $4(n,e){const t=_u(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Di(c,e??{}))return o;Pi(o,"already-initialized")}return t.initialize({options:e})}function W4(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function G4(n,e,t){const s=Wo(n);Ot(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,c=$E(e),{host:u,port:d}=K4(e),p=d===null?"":`:${d}`,g={url:`${c}//${u}${p}/`},b=Object.freeze({host:u,port:d,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){Ot(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ot(Di(g,s.config.emulator)&&Di(b,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=g,s.emulatorConfig=b,s.settings.appVerificationDisabledForTesting=!0,Va(u)?(np(`${c}//${u}${p}`),hv("Auth",!0)):Q4()}function $E(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function K4(n){const e=$E(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const c=o[1];return{host:c,port:Ww(s.substr(c.length+1))}}else{const[c,u]=s.split(":");return{host:c,port:Ww(u)}}}function Ww(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Q4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ka("not implemented")}_getIdTokenResponse(e){return ka("not implemented")}_linkToIdToken(e,t){return ka("not implemented")}_getReauthenticationResolver(e){return ka("not implemented")}}async function Y4(n,e){return Ba(n,"POST","/v1/accounts:signUp",e)}async function X4(n,e){return md(n,"POST","/v1/accounts:signInWithPassword",Oa(n,e))}async function J4(n,e){return Ba(n,"POST","/v1/accounts:sendOobCode",Oa(n,e))}async function Z4(n,e){return J4(n,e)}async function eD(n,e){return md(n,"POST","/v1/accounts:signInWithEmailLink",Oa(n,e))}async function tD(n,e){return md(n,"POST","/v1/accounts:signInWithEmailLink",Oa(n,e))}class Qh extends xv{constructor(e,t,s,o=null){super("password",s),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Qh(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Qh(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rm(e,t,"signInWithPassword",X4);case"emailLink":return eD(e,{email:this._email,oobCode:this._password});default:Pi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rm(e,s,"signUpPassword",Y4);case"emailLink":return tD(e,{idToken:t,email:this._email,oobCode:this._password});default:Pi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Kc(n,e){return md(n,"POST","/v1/accounts:signInWithIdp",Oa(n,e))}const nD="http://localhost";class Ml extends xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ml(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...c}=t;if(!s||!o)return null;const u=new Ml(s,o);return u.idToken=c.idToken||void 0,u.accessToken=c.accessToken||void 0,u.secret=c.secret,u.nonce=c.nonce,u.pendingToken=c.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Kc(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Kc(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kc(e,t)}buildRequest(){const e={requestUri:nD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=dd(t)}return e}}function sD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rD(n){const e=Nh(Ah(n)).link,t=e?Nh(Ah(e)).deep_link_id:null,s=Nh(Ah(n)).deep_link_id;return(s?Nh(Ah(s)).link:null)||s||t||e||n}class _v{constructor(e){const t=Nh(Ah(e)),s=t.apiKey??null,o=t.oobCode??null,c=sD(t.mode??null);Ot(s&&o&&c,"argument-error"),this.apiKey=s,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=rD(e);try{return new _v(t)}catch{return null}}}class wu{constructor(){this.providerId=wu.PROVIDER_ID}static credential(e,t){return Qh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_v.parseLink(t);return Ot(s,"argument-error"),Qh._fromEmailAndCode(e,s.code,s.tenantId)}}wu.PROVIDER_ID="password";wu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class WE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class pd extends WE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class wo extends pd{constructor(){super("facebook.com")}static credential(e){return Ml._fromParams({providerId:wo.PROVIDER_ID,signInMethod:wo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wo.credentialFromTaggedObject(e)}static credentialFromError(e){return wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wo.credential(e.oauthAccessToken)}catch{return null}}}wo.FACEBOOK_SIGN_IN_METHOD="facebook.com";wo.PROVIDER_ID="facebook.com";class To extends pd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ml._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return To.credential(t,s)}catch{return null}}}To.GOOGLE_SIGN_IN_METHOD="google.com";To.PROVIDER_ID="google.com";class Eo extends pd{constructor(){super("github.com")}static credential(e){return Ml._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Eo.credential(e.oauthAccessToken)}catch{return null}}}Eo.GITHUB_SIGN_IN_METHOD="github.com";Eo.PROVIDER_ID="github.com";class ko extends pd{constructor(){super("twitter.com")}static credential(e,t){return Ml._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return ko.credential(t,s)}catch{return null}}}ko.TWITTER_SIGN_IN_METHOD="twitter.com";ko.PROVIDER_ID="twitter.com";async function iD(n,e){return md(n,"POST","/v1/accounts:signUp",Oa(n,e))}class Ll{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,o=!1){const c=await Ii._fromIdTokenResponse(e,s,o),u=Gw(s);return new Ll({user:c,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const o=Gw(s);return new Ll({user:e,providerId:o,_tokenResponse:s,operationType:t})}}function Gw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Cm extends ia{constructor(e,t,s,o){super(t.code,t.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,Cm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,o){return new Cm(e,t,s,o)}}function GE(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Cm._fromErrorAndOperation(n,c,e,s):c})}async function aD(n,e,t=!1){const s=await Kh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ll._forOperation(n,"link",s)}async function oD(n,e,t=!1){const{auth:s}=n;if(Zr(s.app))return Promise.reject(Aa(s));const o="reauthenticate";try{const c=await Kh(n,GE(s,o,e,n),t);Ot(c.idToken,s,"internal-error");const u=bv(c.idToken);Ot(u,s,"internal-error");const{sub:d}=u;return Ot(n.uid===d,s,"user-mismatch"),Ll._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&Pi(s,"user-mismatch"),c}}async function KE(n,e,t=!1){if(Zr(n.app))return Promise.reject(Aa(n));const s="signIn",o=await GE(n,s,e),c=await Ll._fromIdTokenResponse(n,s,o);return t||await n._updateCurrentUser(c.user),c}async function lD(n,e){return KE(Wo(n),e)}async function QE(n){const e=Wo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function cD(n,e,t){const s=Wo(n);await Rm(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Z4)}async function uD(n,e,t){if(Zr(n.app))return Promise.reject(Aa(n));const s=Wo(n),u=await Rm(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iD).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&QE(n),p}),d=await Ll._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(d.user),d}function hD(n,e,t){return Zr(n.app)?Promise.reject(Aa(n)):lD(Cn(n),wu.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&QE(n),s})}function Kw(n,e){return Cn(n).setPersistence(e)}function dD(n,e,t,s){return Cn(n).onIdTokenChanged(e,t,s)}function fD(n,e,t){return Cn(n).beforeAuthStateChanged(e,t)}function mD(n,e,t,s){return Cn(n).onAuthStateChanged(e,t,s)}function pD(n){return Cn(n).signOut()}const Im="__sak";class YE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Im,"1"),this.storage.removeItem(Im),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gD=1e3,yD=10;class XE extends YE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=FE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),o=this.localCache[t];s!==o&&e(t,o,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,p)=>{this.notifyListeners(u,p)});return}const s=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},c=this.storage.getItem(s);C4()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,yD):o()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},gD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}XE.type="LOCAL";const kb=XE;class JE extends YE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}JE.type="SESSION";const wv=JE;function bD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const s=new rp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:o,data:c}=t.data,u=this.handlersMap[o];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const d=Array.from(u).map(async g=>g(t.origin,c)),p=await bD(d);t.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rp.receivers=[];function Tv(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class vD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,u;return new Promise((d,p)=>{const g=Tv("",20);o.port1.start();const b=setTimeout(()=>{p(new Error("unsupported_event"))},s);u={messageChannel:o,onMessage(x){const T=x;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),d(T.data.response);break;default:clearTimeout(b),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function Ji(){return window}function xD(n){Ji().location.href=n}function ZE(){return typeof Ji().WorkerGlobalScope<"u"&&typeof Ji().importScripts=="function"}async function _D(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wD(){return navigator?.serviceWorker?.controller||null}function TD(){return ZE()?self:null}const ek="firebaseLocalStorageDb",ED=1,Dm="firebaseLocalStorage",tk="fbase_key";class gd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ip(n,e){return n.transaction([Dm],e?"readwrite":"readonly").objectStore(Dm)}function kD(){const n=indexedDB.deleteDatabase(ek);return new gd(n).toPromise()}function Sb(){const n=indexedDB.open(ek,ED);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Dm,{keyPath:tk})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Dm)?e(s):(s.close(),await kD(),e(await Sb()))})})}async function Qw(n,e,t){const s=ip(n,!0).put({[tk]:e,value:t});return new gd(s).toPromise()}async function SD(n,e){const t=ip(n,!1).get(e),s=await new gd(t).toPromise();return s===void 0?null:s.value}function Yw(n,e){const t=ip(n,!0).delete(e);return new gd(t).toPromise()}const jD=800,ND=3;class nk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>ND)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ZE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rp._getInstance(TD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _D(),!this.activeServiceWorker)return;this.sender=new vD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sb();return await Qw(e,Im,"1"),await Yw(e,Im),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Qw(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>SD(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Yw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=ip(o,!1).getAll();return new gd(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nk.type="LOCAL";const AD=nk;new fd(3e4,6e4);function RD(n,e){return e?Sa(e):(Ot(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Ev extends xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function CD(n){return KE(n.auth,new Ev(n),n.bypassAuthState)}function ID(n){const{auth:e,user:t}=n;return Ot(t,e,"internal-error"),oD(t,new Ev(n),n.bypassAuthState)}async function DD(n){const{auth:e,user:t}=n;return Ot(t,e,"internal-error"),aD(t,new Ev(n),n.bypassAuthState)}class sk{constructor(e,t,s,o,c=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:o,tenantId:c,error:u,type:d}=e;if(u){this.reject(u);return}const p={auth:this.auth,requestUri:t,sessionId:s,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CD;case"linkViaPopup":case"linkViaRedirect":return DD;case"reauthViaPopup":case"reauthViaRedirect":return ID;default:Pi(this.auth,"internal-error")}}resolve(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PD=new fd(2e3,1e4);class $c extends sk{constructor(e,t,s,o,c){super(e,t,o,c),this.provider=s,this.authWindow=null,this.pollId=null,$c.currentPopupAction&&$c.currentPopupAction.cancel(),$c.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ot(e,this.auth,"internal-error"),e}async onExecution(){Da(this.filter.length===1,"Popup operations only handle one event");const e=Tv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$c.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PD.get())};e()}}$c.currentPopupAction=null;const MD="pendingRedirect",um=new Map;class LD extends sk{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=um.get(this.auth._key());if(!e){try{const s=await VD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}um.set(this.auth._key(),e)}return this.bypassAuthState||um.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VD(n,e){const t=UD(e),s=BD(n);if(!await s._isAvailable())return!1;const o=await s._get(t)==="true";return await s._remove(t),o}function OD(n,e){um.set(n._key(),e)}function BD(n){return Sa(n._redirectPersistence)}function UD(n){return cm(MD,n.config.apiKey,n.name)}async function FD(n,e,t=!1){if(Zr(n.app))return Promise.reject(Aa(n));const s=Wo(n),o=RD(s,e),u=await new LD(s,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const zD=600*1e3;class qD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!rk(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Xi(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zD&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xw(e))}saveEventToCache(e){this.cachedEventUids.add(Xw(e)),this.lastProcessedEventTime=Date.now()}}function Xw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function rk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function HD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rk(n);default:return!1}}async function $D(n,e={}){return Ba(n,"GET","/v1/projects",e)}const WD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GD=/^https?/;async function KD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await $D(n);for(const t of e)try{if(QD(t))return}catch{}Pi(n,"unauthorized-domain")}function QD(n){const e=Tb(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!GD.test(t))return!1;if(WD.test(n))return s===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const YD=new fd(3e4,6e4);function Jw(){const n=Ji().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XD(n){return new Promise((e,t)=>{function s(){Jw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jw(),t(Xi(n,"network-request-failed"))},timeout:YD.get()})}if(Ji().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ji().gapi?.load)s();else{const o=U4("iframefcb");return Ji()[o]=()=>{gapi.load?s():t(Xi(n,"network-request-failed"))},qE(`${B4()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw hm=null,e})}let hm=null;function JD(n){return hm=hm||XD(n),hm}const ZD=new fd(5e3,15e3),eP="__/auth/iframe",tP="emulator/auth/iframe",nP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rP(n){const e=n.config;Ot(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yv(e,tP):`https://${n.config.authDomain}/${eP}`,s={apiKey:e.apiKey,appName:n.name,v:Kl},o=sP.get(n.config.apiHost);o&&(s.eid=o);const c=n._getFrameworks();return c.length&&(s.fw=c.join(",")),`${t}?${dd(s).slice(1)}`}async function iP(n){const e=await JD(n),t=Ji().gapi;return Ot(t,n,"internal-error"),e.open({where:document.body,url:rP(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nP,dontclear:!0},s=>new Promise(async(o,c)=>{await s.restyle({setHideOnLeave:!1});const u=Xi(n,"network-request-failed"),d=Ji().setTimeout(()=>{c(u)},ZD.get());function p(){Ji().clearTimeout(d),o(s)}s.ping(p).then(p,()=>{c(u)})}))}const aP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oP=500,lP=600,cP="_blank",uP="http://localhost";class Zw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hP(n,e,t,s=oP,o=lP){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let d="";const p={...aP,width:s.toString(),height:o.toString(),top:c,left:u},g=Xs().toLowerCase();t&&(d=LE(g)?cP:t),PE(g)&&(e=e||uP,p.scrollbars="yes");const b=Object.entries(p).reduce((T,[N,B])=>`${T}${N}=${B},`,"");if(R4(g)&&d!=="_self")return dP(e||"",d),new Zw(null);const x=window.open(e||"",d,b);Ot(x,n,"popup-blocked");try{x.focus()}catch{}return new Zw(x)}function dP(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const fP="__/auth/handler",mP="emulator/auth/handler",pP=encodeURIComponent("fac");async function e2(n,e,t,s,o,c){Ot(n.config.authDomain,n,"auth-domain-config-required"),Ot(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Kl,eventId:o};if(e instanceof WE){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",XC(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,x]of Object.entries({}))u[b]=x}if(e instanceof pd){const b=e.getScopes().filter(x=>x!=="");b.length>0&&(u.scopes=b.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const b of Object.keys(d))d[b]===void 0&&delete d[b];const p=await n._getAppCheckToken(),g=p?`#${pP}=${encodeURIComponent(p)}`:"";return`${gP(n)}?${dd(d).slice(1)}${g}`}function gP({config:n}){return n.emulator?yv(n,mP):`https://${n.authDomain}/${fP}`}const zy="webStorageSupport";class yP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wv,this._completeRedirectFn=FD,this._overrideRedirectResult=OD}async _openPopup(e,t,s,o){Da(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await e2(e,t,s,Tb(),o);return hP(e,c,Tv())}async _openRedirect(e,t,s,o){await this._originValidation(e);const c=await e2(e,t,s,Tb(),o);return xD(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Da(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await iP(e),s=new qD(e);return t.register("authEvent",o=>(Ot(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zy,{type:zy},o=>{const c=o?.[0]?.[zy];c!==void 0&&t(!!c),Pi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=KD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return FE()||ME()||vv()}}const bP=yP;var t2="@firebase/auth",n2="1.12.0";class vP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function xP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _P(n){Pl(new Oo("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=s.options;Ot(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zE(n)},g=new L4(s,o,c,p);return W4(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Pl(new Oo("auth-internal",e=>{const t=Wo(e.getProvider("auth").getImmediate());return(s=>new vP(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yi(t2,n2,xP(n)),Yi(t2,n2,"esm2020")}const wP=300,TP=gE("authIdTokenMaxAge")||wP;let s2=null;const EP=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>TP)return;const o=t?.token;s2!==o&&(s2=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function ik(n=pv()){const e=_u(n,"auth");if(e.isInitialized())return e.getImmediate();const t=$4(n,{popupRedirectResolver:bP,persistence:[AD,kb,wv]}),s=gE("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(s,location.origin);if(location.origin===c.origin){const u=EP(c.toString());fD(t,u,()=>u(t.currentUser)),dD(t,d=>u(d))}}const o=fE("auth");return o&&G4(t,`http://${o}`),t}function kP(){return document.getElementsByTagName("head")?.[0]??document}V4({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=o=>{const c=Xi("internal-error");c.customData=o,t(c)},s.type="text/javascript",s.charset="UTF-8",kP().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_P("Browser");var r2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Lo,ak;(function(){var n;function e(C,S){function P(){}P.prototype=S.prototype,C.F=S.prototype,C.prototype=new P,C.prototype.constructor=C,C.D=function(U,V,q){for(var L=Array(arguments.length-2),We=2;We<arguments.length;We++)L[We-2]=arguments[We];return S.prototype[V].apply(U,L)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(C,S,P){P||(P=0);const U=Array(16);if(typeof S=="string")for(var V=0;V<16;++V)U[V]=S.charCodeAt(P++)|S.charCodeAt(P++)<<8|S.charCodeAt(P++)<<16|S.charCodeAt(P++)<<24;else for(V=0;V<16;++V)U[V]=S[P++]|S[P++]<<8|S[P++]<<16|S[P++]<<24;S=C.g[0],P=C.g[1],V=C.g[2];let q=C.g[3],L;L=S+(q^P&(V^q))+U[0]+3614090360&4294967295,S=P+(L<<7&4294967295|L>>>25),L=q+(V^S&(P^V))+U[1]+3905402710&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(P^q&(S^P))+U[2]+606105819&4294967295,V=q+(L<<17&4294967295|L>>>15),L=P+(S^V&(q^S))+U[3]+3250441966&4294967295,P=V+(L<<22&4294967295|L>>>10),L=S+(q^P&(V^q))+U[4]+4118548399&4294967295,S=P+(L<<7&4294967295|L>>>25),L=q+(V^S&(P^V))+U[5]+1200080426&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(P^q&(S^P))+U[6]+2821735955&4294967295,V=q+(L<<17&4294967295|L>>>15),L=P+(S^V&(q^S))+U[7]+4249261313&4294967295,P=V+(L<<22&4294967295|L>>>10),L=S+(q^P&(V^q))+U[8]+1770035416&4294967295,S=P+(L<<7&4294967295|L>>>25),L=q+(V^S&(P^V))+U[9]+2336552879&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(P^q&(S^P))+U[10]+4294925233&4294967295,V=q+(L<<17&4294967295|L>>>15),L=P+(S^V&(q^S))+U[11]+2304563134&4294967295,P=V+(L<<22&4294967295|L>>>10),L=S+(q^P&(V^q))+U[12]+1804603682&4294967295,S=P+(L<<7&4294967295|L>>>25),L=q+(V^S&(P^V))+U[13]+4254626195&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(P^q&(S^P))+U[14]+2792965006&4294967295,V=q+(L<<17&4294967295|L>>>15),L=P+(S^V&(q^S))+U[15]+1236535329&4294967295,P=V+(L<<22&4294967295|L>>>10),L=S+(V^q&(P^V))+U[1]+4129170786&4294967295,S=P+(L<<5&4294967295|L>>>27),L=q+(P^V&(S^P))+U[6]+3225465664&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^P&(q^S))+U[11]+643717713&4294967295,V=q+(L<<14&4294967295|L>>>18),L=P+(q^S&(V^q))+U[0]+3921069994&4294967295,P=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(P^V))+U[5]+3593408605&4294967295,S=P+(L<<5&4294967295|L>>>27),L=q+(P^V&(S^P))+U[10]+38016083&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^P&(q^S))+U[15]+3634488961&4294967295,V=q+(L<<14&4294967295|L>>>18),L=P+(q^S&(V^q))+U[4]+3889429448&4294967295,P=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(P^V))+U[9]+568446438&4294967295,S=P+(L<<5&4294967295|L>>>27),L=q+(P^V&(S^P))+U[14]+3275163606&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^P&(q^S))+U[3]+4107603335&4294967295,V=q+(L<<14&4294967295|L>>>18),L=P+(q^S&(V^q))+U[8]+1163531501&4294967295,P=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(P^V))+U[13]+2850285829&4294967295,S=P+(L<<5&4294967295|L>>>27),L=q+(P^V&(S^P))+U[2]+4243563512&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^P&(q^S))+U[7]+1735328473&4294967295,V=q+(L<<14&4294967295|L>>>18),L=P+(q^S&(V^q))+U[12]+2368359562&4294967295,P=V+(L<<20&4294967295|L>>>12),L=S+(P^V^q)+U[5]+4294588738&4294967295,S=P+(L<<4&4294967295|L>>>28),L=q+(S^P^V)+U[8]+2272392833&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^P)+U[11]+1839030562&4294967295,V=q+(L<<16&4294967295|L>>>16),L=P+(V^q^S)+U[14]+4259657740&4294967295,P=V+(L<<23&4294967295|L>>>9),L=S+(P^V^q)+U[1]+2763975236&4294967295,S=P+(L<<4&4294967295|L>>>28),L=q+(S^P^V)+U[4]+1272893353&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^P)+U[7]+4139469664&4294967295,V=q+(L<<16&4294967295|L>>>16),L=P+(V^q^S)+U[10]+3200236656&4294967295,P=V+(L<<23&4294967295|L>>>9),L=S+(P^V^q)+U[13]+681279174&4294967295,S=P+(L<<4&4294967295|L>>>28),L=q+(S^P^V)+U[0]+3936430074&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^P)+U[3]+3572445317&4294967295,V=q+(L<<16&4294967295|L>>>16),L=P+(V^q^S)+U[6]+76029189&4294967295,P=V+(L<<23&4294967295|L>>>9),L=S+(P^V^q)+U[9]+3654602809&4294967295,S=P+(L<<4&4294967295|L>>>28),L=q+(S^P^V)+U[12]+3873151461&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^P)+U[15]+530742520&4294967295,V=q+(L<<16&4294967295|L>>>16),L=P+(V^q^S)+U[2]+3299628645&4294967295,P=V+(L<<23&4294967295|L>>>9),L=S+(V^(P|~q))+U[0]+4096336452&4294967295,S=P+(L<<6&4294967295|L>>>26),L=q+(P^(S|~V))+U[7]+1126891415&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~P))+U[14]+2878612391&4294967295,V=q+(L<<15&4294967295|L>>>17),L=P+(q^(V|~S))+U[5]+4237533241&4294967295,P=V+(L<<21&4294967295|L>>>11),L=S+(V^(P|~q))+U[12]+1700485571&4294967295,S=P+(L<<6&4294967295|L>>>26),L=q+(P^(S|~V))+U[3]+2399980690&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~P))+U[10]+4293915773&4294967295,V=q+(L<<15&4294967295|L>>>17),L=P+(q^(V|~S))+U[1]+2240044497&4294967295,P=V+(L<<21&4294967295|L>>>11),L=S+(V^(P|~q))+U[8]+1873313359&4294967295,S=P+(L<<6&4294967295|L>>>26),L=q+(P^(S|~V))+U[15]+4264355552&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~P))+U[6]+2734768916&4294967295,V=q+(L<<15&4294967295|L>>>17),L=P+(q^(V|~S))+U[13]+1309151649&4294967295,P=V+(L<<21&4294967295|L>>>11),L=S+(V^(P|~q))+U[4]+4149444226&4294967295,S=P+(L<<6&4294967295|L>>>26),L=q+(P^(S|~V))+U[11]+3174756917&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~P))+U[2]+718787259&4294967295,V=q+(L<<15&4294967295|L>>>17),L=P+(q^(V|~S))+U[9]+3951481745&4294967295,C.g[0]=C.g[0]+S&4294967295,C.g[1]=C.g[1]+(V+(L<<21&4294967295|L>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+q&4294967295}s.prototype.v=function(C,S){S===void 0&&(S=C.length);const P=S-this.blockSize,U=this.C;let V=this.h,q=0;for(;q<S;){if(V==0)for(;q<=P;)o(this,C,q),q+=this.blockSize;if(typeof C=="string"){for(;q<S;)if(U[V++]=C.charCodeAt(q++),V==this.blockSize){o(this,U),V=0;break}}else for(;q<S;)if(U[V++]=C[q++],V==this.blockSize){o(this,U),V=0;break}}this.h=V,this.o+=S},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var S=1;S<C.length-8;++S)C[S]=0;S=this.o*8;for(var P=C.length-8;P<C.length;++P)C[P]=S&255,S/=256;for(this.v(C),C=Array(16),S=0,P=0;P<4;++P)for(let U=0;U<32;U+=8)C[S++]=this.g[P]>>>U&255;return C};function c(C,S){var P=d;return Object.prototype.hasOwnProperty.call(P,C)?P[C]:P[C]=S(C)}function u(C,S){this.h=S;const P=[];let U=!0;for(let V=C.length-1;V>=0;V--){const q=C[V]|0;U&&q==S||(P[V]=q,U=!1)}this.g=P}var d={};function p(C){return-128<=C&&C<128?c(C,function(S){return new u([S|0],S<0?-1:0)}):new u([C|0],C<0?-1:0)}function g(C){if(isNaN(C)||!isFinite(C))return x;if(C<0)return D(g(-C));const S=[];let P=1;for(let U=0;C>=P;U++)S[U]=C/P|0,P*=4294967296;return new u(S,0)}function b(C,S){if(C.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(C.charAt(0)=="-")return D(b(C.substring(1),S));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=g(Math.pow(S,8));let U=x;for(let q=0;q<C.length;q+=8){var V=Math.min(8,C.length-q);const L=parseInt(C.substring(q,q+V),S);V<8?(V=g(Math.pow(S,V)),U=U.j(V).add(g(L))):(U=U.j(P),U=U.add(g(L)))}return U}var x=p(0),T=p(1),N=p(16777216);n=u.prototype,n.m=function(){if(M(this))return-D(this).m();let C=0,S=1;for(let P=0;P<this.g.length;P++){const U=this.i(P);C+=(U>=0?U:4294967296+U)*S,S*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(B(this))return"0";if(M(this))return"-"+D(this).toString(C);const S=g(Math.pow(C,6));var P=this;let U="";for(;;){const V=he(P,S).g;P=X(P,V.j(S));let q=((P.g.length>0?P.g[0]:P.h)>>>0).toString(C);if(P=V,B(P))return q+U;for(;q.length<6;)q="0"+q;U=q+U}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function B(C){if(C.h!=0)return!1;for(let S=0;S<C.g.length;S++)if(C.g[S]!=0)return!1;return!0}function M(C){return C.h==-1}n.l=function(C){return C=X(this,C),M(C)?-1:B(C)?0:1};function D(C){const S=C.g.length,P=[];for(let U=0;U<S;U++)P[U]=~C.g[U];return new u(P,~C.h).add(T)}n.abs=function(){return M(this)?D(this):this},n.add=function(C){const S=Math.max(this.g.length,C.g.length),P=[];let U=0;for(let V=0;V<=S;V++){let q=U+(this.i(V)&65535)+(C.i(V)&65535),L=(q>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);U=L>>>16,q&=65535,L&=65535,P[V]=L<<16|q}return new u(P,P[P.length-1]&-2147483648?-1:0)};function X(C,S){return C.add(D(S))}n.j=function(C){if(B(this)||B(C))return x;if(M(this))return M(C)?D(this).j(D(C)):D(D(this).j(C));if(M(C))return D(this.j(D(C)));if(this.l(N)<0&&C.l(N)<0)return g(this.m()*C.m());const S=this.g.length+C.g.length,P=[];for(var U=0;U<2*S;U++)P[U]=0;for(U=0;U<this.g.length;U++)for(let V=0;V<C.g.length;V++){const q=this.i(U)>>>16,L=this.i(U)&65535,We=C.i(V)>>>16,wt=C.i(V)&65535;P[2*U+2*V]+=L*wt,H(P,2*U+2*V),P[2*U+2*V+1]+=q*wt,H(P,2*U+2*V+1),P[2*U+2*V+1]+=L*We,H(P,2*U+2*V+1),P[2*U+2*V+2]+=q*We,H(P,2*U+2*V+2)}for(C=0;C<S;C++)P[C]=P[2*C+1]<<16|P[2*C];for(C=S;C<2*S;C++)P[C]=0;return new u(P,0)};function H(C,S){for(;(C[S]&65535)!=C[S];)C[S+1]+=C[S]>>>16,C[S]&=65535,S++}function J(C,S){this.g=C,this.h=S}function he(C,S){if(B(S))throw Error("division by zero");if(B(C))return new J(x,x);if(M(C))return S=he(D(C),S),new J(D(S.g),D(S.h));if(M(S))return S=he(C,D(S)),new J(D(S.g),S.h);if(C.g.length>30){if(M(C)||M(S))throw Error("slowDivide_ only works with positive integers.");for(var P=T,U=S;U.l(C)<=0;)P=Ne(P),U=Ne(U);var V=Te(P,1),q=Te(U,1);for(U=Te(U,2),P=Te(P,2);!B(U);){var L=q.add(U);L.l(C)<=0&&(V=V.add(P),q=L),U=Te(U,1),P=Te(P,1)}return S=X(C,V.j(S)),new J(V,S)}for(V=x;C.l(S)>=0;){for(P=Math.max(1,Math.floor(C.m()/S.m())),U=Math.ceil(Math.log(P)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),q=g(P),L=q.j(S);M(L)||L.l(C)>0;)P-=U,q=g(P),L=q.j(S);B(q)&&(q=T),V=V.add(q),C=X(C,L)}return new J(V,C)}n.B=function(C){return he(this,C).h},n.and=function(C){const S=Math.max(this.g.length,C.g.length),P=[];for(let U=0;U<S;U++)P[U]=this.i(U)&C.i(U);return new u(P,this.h&C.h)},n.or=function(C){const S=Math.max(this.g.length,C.g.length),P=[];for(let U=0;U<S;U++)P[U]=this.i(U)|C.i(U);return new u(P,this.h|C.h)},n.xor=function(C){const S=Math.max(this.g.length,C.g.length),P=[];for(let U=0;U<S;U++)P[U]=this.i(U)^C.i(U);return new u(P,this.h^C.h)};function Ne(C){const S=C.g.length+1,P=[];for(let U=0;U<S;U++)P[U]=C.i(U)<<1|C.i(U-1)>>>31;return new u(P,C.h)}function Te(C,S){const P=S>>5;S%=32;const U=C.g.length-P,V=[];for(let q=0;q<U;q++)V[q]=S>0?C.i(q+P)>>>S|C.i(q+P+1)<<32-S:C.i(q+P);return new u(V,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,ak=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=b,Lo=u}).apply(typeof r2<"u"?r2:typeof self<"u"?self:typeof window<"u"?window:{});var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ok,Rh,lk,dm,jb,ck,uk,hk;(function(){var n,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hf=="object"&&Hf];for(var v=0;v<f.length;++v){var E=f[v];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var s=t(this);function o(f,v){if(v)e:{var E=s;f=f.split(".");for(var R=0;R<f.length-1;R++){var ie=f[R];if(!(ie in E))break e;E=E[ie]}f=f[f.length-1],R=E[f],v=v(R),v!=R&&v!=null&&e(E,f,{configurable:!0,writable:!0,value:v})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(v){var E=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&E.push([R,v[R]]);return E}});var c=c||{},u=this||self;function d(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function p(f,v,E){return f.call.apply(f.bind,arguments)}function g(f,v,E){return g=p,g.apply(null,arguments)}function b(f,v){var E=Array.prototype.slice.call(arguments,1);return function(){var R=E.slice();return R.push.apply(R,arguments),f.apply(this,R)}}function x(f,v){function E(){}E.prototype=v.prototype,f.Z=v.prototype,f.prototype=new E,f.prototype.constructor=f,f.Ob=function(R,ie,fe){for(var Xe=Array(arguments.length-2),tn=2;tn<arguments.length;tn++)Xe[tn-2]=arguments[tn];return v.prototype[ie].apply(R,Xe)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function N(f){const v=f.length;if(v>0){const E=Array(v);for(let R=0;R<v;R++)E[R]=f[R];return E}return[]}function B(f,v){for(let R=1;R<arguments.length;R++){const ie=arguments[R];var E=typeof ie;if(E=E!="object"?E:ie?Array.isArray(ie)?"array":E:"null",E=="array"||E=="object"&&typeof ie.length=="number"){E=f.length||0;const fe=ie.length||0;f.length=E+fe;for(let Xe=0;Xe<fe;Xe++)f[E+Xe]=ie[Xe]}else f.push(ie)}}class M{constructor(v,E){this.i=v,this.j=E,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function D(f){u.setTimeout(()=>{throw f},0)}function X(){var f=C;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class H{constructor(){this.h=this.g=null}add(v,E){const R=J.get();R.set(v,E),this.h?this.h.next=R:this.g=R,this.h=R}}var J=new M(()=>new he,f=>f.reset());class he{constructor(){this.next=this.g=this.h=null}set(v,E){this.h=v,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,Te=!1,C=new H,S=()=>{const f=Promise.resolve(void 0);Ne=()=>{f.then(P)}};function P(){for(var f;f=X();){try{f.h.call(f.g)}catch(E){D(E)}var v=J;v.j(f),v.h<100&&(v.h++,f.next=v.g,v.g=f)}Te=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const E=()=>{};u.addEventListener("test",E,v),u.removeEventListener("test",E,v)}catch{}return f})();function L(f){return/^[\s\xa0]*$/.test(f)}function We(f,v){V.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,v)}x(We,V),We.prototype.init=function(f,v){const E=this.type=f.type,R=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget,v||(E=="mouseover"?v=f.fromElement:E=="mouseout"&&(v=f.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&We.Z.h.call(this)},We.prototype.h=function(){We.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var wt="closure_listenable_"+(Math.random()*1e6|0),$=0;function ye(f,v,E,R,ie){this.listener=f,this.proxy=null,this.src=v,this.type=E,this.capture=!!R,this.ha=ie,this.key=++$,this.da=this.fa=!1}function Le(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ke(f,v,E){for(const R in f)v.call(E,f[R],R,f)}function te(f,v){for(const E in f)v.call(void 0,f[E],E,f)}function O(f){const v={};for(const E in f)v[E]=f[E];return v}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function we(f,v){let E,R;for(let ie=1;ie<arguments.length;ie++){R=arguments[ie];for(E in R)f[E]=R[E];for(let fe=0;fe<K.length;fe++)E=K[fe],Object.prototype.hasOwnProperty.call(R,E)&&(f[E]=R[E])}}function Ae(f){this.src=f,this.g={},this.h=0}Ae.prototype.add=function(f,v,E,R,ie){const fe=f.toString();f=this.g[fe],f||(f=this.g[fe]=[],this.h++);const Xe=Pe(f,v,R,ie);return Xe>-1?(v=f[Xe],E||(v.fa=!1)):(v=new ye(v,this.src,fe,!!R,ie),v.fa=E,f.push(v)),v};function Ge(f,v){const E=v.type;if(E in f.g){var R=f.g[E],ie=Array.prototype.indexOf.call(R,v,void 0),fe;(fe=ie>=0)&&Array.prototype.splice.call(R,ie,1),fe&&(Le(v),f.g[E].length==0&&(delete f.g[E],f.h--))}}function Pe(f,v,E,R){for(let ie=0;ie<f.length;++ie){const fe=f[ie];if(!fe.da&&fe.listener==v&&fe.capture==!!E&&fe.ha==R)return ie}return-1}var ct="closure_lm_"+(Math.random()*1e6|0),gt={};function nt(f,v,E,R,ie){if(Array.isArray(v)){for(let fe=0;fe<v.length;fe++)nt(f,v[fe],E,R,ie);return null}return E=At(E),f&&f[wt]?f.J(v,E,d(R)?!!R.capture:!1,ie):Ft(f,v,E,!1,R,ie)}function Ft(f,v,E,R,ie,fe){if(!v)throw Error("Invalid event type");const Xe=d(ie)?!!ie.capture:!!ie;let tn=rn(f);if(tn||(f[ct]=tn=new Ae(f)),E=tn.add(v,E,R,Xe,fe),E.proxy)return E;if(R=Pn(),E.proxy=R,R.src=f,R.listener=E,f.addEventListener)q||(ie=Xe),ie===void 0&&(ie=!1),f.addEventListener(v.toString(),R,ie);else if(f.attachEvent)f.attachEvent(me(v.toString()),R);else if(f.addListener&&f.removeListener)f.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Pn(){function f(E){return v.call(f.src,f.listener,E)}const v=sn;return f}function Lt(f,v,E,R,ie){if(Array.isArray(v))for(var fe=0;fe<v.length;fe++)Lt(f,v[fe],E,R,ie);else R=d(R)?!!R.capture:!!R,E=At(E),f&&f[wt]?(f=f.i,fe=String(v).toString(),fe in f.g&&(v=f.g[fe],E=Pe(v,E,R,ie),E>-1&&(Le(v[E]),Array.prototype.splice.call(v,E,1),v.length==0&&(delete f.g[fe],f.h--)))):f&&(f=rn(f))&&(v=f.g[v.toString()],f=-1,v&&(f=Pe(v,E,R,ie)),(E=f>-1?v[f]:null)&&Et(E))}function Et(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[wt])Ge(v.i,f);else{var E=f.type,R=f.proxy;v.removeEventListener?v.removeEventListener(E,R,f.capture):v.detachEvent?v.detachEvent(me(E),R):v.addListener&&v.removeListener&&v.removeListener(R),(E=rn(v))?(Ge(E,f),E.h==0&&(E.src=null,v[ct]=null)):Le(f)}}}function me(f){return f in gt?gt[f]:gt[f]="on"+f}function sn(f,v){if(f.da)f=!0;else{v=new We(v,this);const E=f.listener,R=f.ha||f.src;f.fa&&Et(f),f=E.call(R,v)}return f}function rn(f){return f=f[ct],f instanceof Ae?f:null}var yt="__closure_events_fn_"+(Math.random()*1e9>>>0);function At(f){return typeof f=="function"?f:(f[yt]||(f[yt]=function(v){return f.handleEvent(v)}),f[yt])}function dt(){U.call(this),this.i=new Ae(this),this.M=this,this.G=null}x(dt,U),dt.prototype[wt]=!0,dt.prototype.removeEventListener=function(f,v,E,R){Lt(this,f,v,E,R)};function it(f,v){var E,R=f.G;if(R)for(E=[];R;R=R.G)E.push(R);if(f=f.M,R=v.type||v,typeof v=="string")v=new V(v,f);else if(v instanceof V)v.target=v.target||f;else{var ie=v;v=new V(R,f),we(v,ie)}ie=!0;let fe,Xe;if(E)for(Xe=E.length-1;Xe>=0;Xe--)fe=v.g=E[Xe],ie=an(fe,R,!0,v)&&ie;if(fe=v.g=f,ie=an(fe,R,!0,v)&&ie,ie=an(fe,R,!1,v)&&ie,E)for(Xe=0;Xe<E.length;Xe++)fe=v.g=E[Xe],ie=an(fe,R,!1,v)&&ie}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var f=this.i;for(const v in f.g){const E=f.g[v];for(let R=0;R<E.length;R++)Le(E[R]);delete f.g[v],f.h--}}this.G=null},dt.prototype.J=function(f,v,E,R){return this.i.add(String(f),v,!1,E,R)},dt.prototype.K=function(f,v,E,R){return this.i.add(String(f),v,!0,E,R)};function an(f,v,E,R){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();let ie=!0;for(let fe=0;fe<v.length;++fe){const Xe=v[fe];if(Xe&&!Xe.da&&Xe.capture==E){const tn=Xe.listener,Is=Xe.ha||Xe.src;Xe.fa&&Ge(f.i,Xe),ie=tn.call(Is,R)!==!1&&ie}}return ie&&!R.defaultPrevented}function Ts(f,v){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:u.setTimeout(f,v||0)}function Rt(f){f.g=Ts(()=>{f.g=null,f.i&&(f.i=!1,Rt(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class ln extends U{constructor(v,E){super(),this.m=v,this.l=E,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Rt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ns(f){U.call(this),this.h=f,this.g={}}x(ns,U);var Qt=[];function Wt(f){Ke(f.g,function(v,E){this.g.hasOwnProperty(E)&&Et(v)},f),f.g={}}ns.prototype.N=function(){ns.Z.N.call(this),Wt(this)},ns.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cn=u.JSON.stringify,vn=u.JSON.parse,be=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function De(){}function Be(){}var et={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ue(){V.call(this,"d")}x(Ue,V);function Me(){V.call(this,"c")}x(Me,V);var ze={},St=null;function bt(){return St=St||new dt}ze.Ia="serverreachability";function Vt(f){V.call(this,ze.Ia,f)}x(Vt,V);function Ht(f){const v=bt();it(v,new Vt(v))}ze.STAT_EVENT="statevent";function ee(f,v){V.call(this,ze.STAT_EVENT,f),this.stat=v}x(ee,V);function ve(f){const v=bt();it(v,new ee(v,f))}ze.Ja="timingevent";function lt(f,v){V.call(this,ze.Ja,f),this.size=v}x(lt,V);function Ct(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},v)}function It(){this.g=!0}It.prototype.ua=function(){this.g=!1};function Xt(f,v,E,R,ie,fe){f.info(function(){if(f.g)if(fe){var Xe="",tn=fe.split("&");for(let Bn=0;Bn<tn.length;Bn++){var Is=tn[Bn].split("=");if(Is.length>1){const ps=Is[0];Is=Is[1];const li=ps.split("_");Xe=li.length>=2&&li[1]=="type"?Xe+(ps+"="+Is+"&"):Xe+(ps+"=redacted&")}}}else Xe=null;else Xe=fe;return"XMLHTTP REQ ("+R+") [attempt "+ie+"]: "+v+`
`+E+`
`+Xe})}function Jt(f,v,E,R,ie,fe,Xe){f.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+ie+"]: "+v+`
`+E+`
`+fe+" "+Xe})}function zt(f,v,E,R){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+os(f,E)+(R?" "+R:"")})}function Fn(f,v){f.info(function(){return"TIMEOUT: "+v})}It.prototype.info=function(){};function os(f,v){if(!f.g)return v;if(!v)return null;try{const fe=JSON.parse(v);if(fe){for(f=0;f<fe.length;f++)if(Array.isArray(fe[f])){var E=fe[f];if(!(E.length<2)){var R=E[1];if(Array.isArray(R)&&!(R.length<1)){var ie=R[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Xe=1;Xe<R.length;Xe++)R[Xe]=""}}}}return cn(fe)}catch{return v}}var pn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},In={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},On;function z(){}x(z,De),z.prototype.g=function(){return new XMLHttpRequest},On=new z;function xe(f){return encodeURIComponent(String(f))}function ke(f){var v=1;f=f.split(":");const E=[];for(;v>0&&f.length;)E.push(f.shift()),v--;return f.length&&E.push(f.join(":")),E}function Se(f,v,E,R){this.j=f,this.i=v,this.l=E,this.S=R||1,this.V=new ns(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pe}function pe(){this.i=null,this.g="",this.h=!1}var rt={},Dt={};function ut(f,v,E){f.M=1,f.A=Fe(zn(v)),f.u=E,f.R=!0,jt(f,null)}function jt(f,v){f.F=Date.now(),Gs(f),f.B=zn(f.A);var E=f.B,R=f.S;Array.isArray(R)||(R=[String(R)]),_s(E.i,"t",R),f.C=0,E=f.j.L,f.h=new pe,f.g=Pd(f.j,E?v:null,!f.u),f.P>0&&(f.O=new ln(g(f.Y,f,f.g),f.P)),v=f.V,E=f.g,R=f.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(Qt[0]=ie.toString()),ie=Qt);for(let fe=0;fe<ie.length;fe++){const Xe=nt(E,ie[fe],R||v.handleEvent,!1,v.h||v);if(!Xe)break;v.g[Xe.key]=Xe}v=f.J?O(f.J):{},f.u?(f.v||(f.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,v)):(f.v="GET",f.g.ea(f.B,f.v,null,v)),Ht(),Xt(f.i,f.v,f.B,f.l,f.S,f.u)}Se.prototype.ba=function(f){f=f.target;const v=this.O;v&&ms(f)==3?v.j():this.Y(f)},Se.prototype.Y=function(f){try{if(f==this.g)e:{const tn=ms(this.g),Is=this.g.ya(),Bn=this.g.ca();if(!(tn<3)&&(tn!=3||this.g&&(this.h.h||this.g.la()||dn(this.g)))){this.K||tn!=4||Is==7||(Is==8||Bn<=0?Ht(3):Ht(2)),Xn(this);var v=this.g.ca();this.X=v;var E=kt(this);if(this.o=v==200,Jt(this.i,this.v,this.B,this.l,this.S,tn,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,ie=this.g;if((R=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(R)){var fe=R;break t}}fe=null}if(f=fe)zt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,f);else{this.o=!1,this.m=3,ve(12),de(this),W(this);break e}}if(this.R){f=!0;let ps;for(;!this.K&&this.C<E.length;)if(ps=yr(this,E),ps==Dt){tn==4&&(this.m=4,ve(14),f=!1),zt(this.i,this.l,null,"[Incomplete Response]");break}else if(ps==rt){this.m=4,ve(15),zt(this.i,this.l,E,"[Invalid Chunk]"),f=!1;break}else zt(this.i,this.l,ps,null),k(this,ps);if(un(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||E.length!=0||this.h.h||(this.m=1,ve(16),f=!1),this.o=this.o&&f,!f)zt(this.i,this.l,E,"[Invalid Chunked Response]"),de(this),W(this);else if(E.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Ha(Xe),Xe.P=!0,ve(11))}}else zt(this.i,this.l,E,null),k(this,E);tn==4&&de(this),this.o&&!this.K&&(tn==4?oa(this.j,this):(this.o=!1,Gs(this)))}else $n(this.g),v==400&&E.indexOf("Unknown SID")>0?(this.m=3,ve(12)):(this.m=0,ve(13)),de(this),W(this)}}}catch{}};function kt(f){if(!un(f))return f.g.la();const v=dn(f.g);if(v==="")return"";let E="";const R=v.length,ie=ms(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return de(f),W(f),"";f.h.i=new u.TextDecoder}for(let fe=0;fe<R;fe++)f.h.h=!0,E+=f.h.i.decode(v[fe],{stream:!(ie&&fe==R-1)});return v.length=0,f.h.g+=E,f.C=0,f.h.g}function un(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function yr(f,v){var E=f.C,R=v.indexOf(`
`,E);return R==-1?Dt:(E=Number(v.substring(E,R)),isNaN(E)?rt:(R+=1,R+E>v.length?Dt:(v=v.slice(R,R+E),f.C=R+E,v)))}Se.prototype.cancel=function(){this.K=!0,de(this)};function Gs(f){f.T=Date.now()+f.H,Zs(f,f.H)}function Zs(f,v){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Ct(g(f.aa,f),v)}function Xn(f){f.D&&(u.clearTimeout(f.D),f.D=null)}Se.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Fn(this.i,this.B),this.M!=2&&(Ht(),ve(17)),de(this),this.m=2,W(this)):Zs(this,this.T-f)};function W(f){f.j.I==0||f.K||oa(f.j,f)}function de(f){Xn(f);var v=f.O;v&&typeof v.dispose=="function"&&v.dispose(),f.O=null,Wt(f.V),f.g&&(v=f.g,f.g=null,v.abort(),v.dispose())}function k(f,v){try{var E=f.j;if(E.I!=0&&(E.g==f||$e(E.h,f))){if(!f.L&&$e(E.h,f)&&E.I==3){try{var R=E.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var ie=R;if(ie[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<f.F)$a(E),cr(E);else break e;Pr(E),ve(18)}}else E.xa=ie[1],0<E.xa-E.K&&ie[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Ct(g(E.Va,E),6e3));Ye(E.h)<=1&&E.ta&&(E.ta=void 0)}else ur(E,11)}else if((f.L||E.g==f)&&$a(E),!L(v))for(ie=E.Ba.g.parse(v),v=0;v<ie.length;v++){let Bn=ie[v];const ps=Bn[0];if(!(ps<=E.K))if(E.K=ps,Bn=Bn[1],E.I==2)if(Bn[0]=="c"){E.M=Bn[1],E.ba=Bn[2];const li=Bn[3];li!=null&&(E.ka=li,E.j.info("VER="+E.ka));const Bi=Bn[4];Bi!=null&&(E.za=Bi,E.j.info("SVER="+E.za));const Ti=Bn[5];Ti!=null&&typeof Ti=="number"&&Ti>0&&(R=1.5*Ti,E.O=R,E.j.info("backChannelRequestTimeoutMs_="+R)),R=E;const Ei=f.g;if(Ei){const Zo=Ei.g?Ei.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zo){var fe=R.h;fe.g||Zo.indexOf("spdy")==-1&&Zo.indexOf("quic")==-1&&Zo.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(qe(fe,fe.h),fe.h=null))}if(R.G){const tc=Ei.g?Ei.g.getResponseHeader("X-HTTP-Session-Id"):null;tc&&(R.wa=tc,re(R.J,R.G,tc))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-f.F,E.j.info("Handshake RTT: "+E.T+"ms")),R=E;var Xe=f;if(R.na=Dd(R,R.L?R.ba:null,R.W),Xe.L){Ut(R.h,Xe);var tn=Xe,Is=R.O;Is&&(tn.H=Is),tn.D&&(Xn(tn),Gs(tn)),R.g=Xe}else oi(R);E.i.length>0&&ks(E)}else Bn[0]!="stop"&&Bn[0]!="close"||ur(E,7);else E.I==3&&(Bn[0]=="stop"||Bn[0]=="close"?Bn[0]=="stop"?ur(E,7):Qs(E):Bn[0]!="noop"&&E.l&&E.l.qa(Bn),E.A=0)}}Ht(4)}catch{}}var A=class{constructor(f,v){this.g=f,this.map=v}};function Q(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ae(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ye(f){return f.h?1:f.g?f.g.size:0}function $e(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function qe(f,v){f.g?f.g.add(v):f.h=v}function Ut(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Q.prototype.cancel=function(){if(this.i=Mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Mt(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const E of f.g.values())v=v.concat(E.G);return v}return N(f.i)}var Hn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function er(f,v){if(f){f=f.split("&");for(let E=0;E<f.length;E++){const R=f[E].indexOf("=");let ie,fe=null;R>=0?(ie=f[E].substring(0,R),fe=f[E].substring(R+1)):ie=f[E],v(ie,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function Vs(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;f instanceof Vs?(this.l=f.l,qn(this,f.j),this.o=f.o,this.g=f.g,Y(this,f.u),this.h=f.h,Ee(this,Tr(f.i)),this.m=f.m):f&&(v=String(f).match(Hn))?(this.l=!1,qn(this,v[1]||"",!0),this.o=He(v[2]||""),this.g=He(v[3]||"",!0),Y(this,v[4]),this.h=He(v[5]||"",!0),Ee(this,v[6]||"",!0),this.m=He(v[7]||"")):(this.l=!1,this.i=new Os(null,this.l))}Vs.prototype.toString=function(){const f=[];var v=this.j;v&&f.push(ht(v,Gt,!0),":");var E=this.g;return(E||v=="file")&&(f.push("//"),(v=this.o)&&f.push(ht(v,Gt,!0),"@"),f.push(xe(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&f.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&f.push("/"),f.push(ht(E,E.charAt(0)=="/"?Cs:Sn,!0))),(E=this.i.toString())&&f.push("?",E),(E=this.m)&&f.push("#",ht(E,tr)),f.join("")},Vs.prototype.resolve=function(f){const v=zn(this);let E=!!f.j;E?qn(v,f.j):E=!!f.o,E?v.o=f.o:E=!!f.g,E?v.g=f.g:E=f.u!=null;var R=f.h;if(E)Y(v,f.u);else if(E=!!f.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var ie=v.h.lastIndexOf("/");ie!=-1&&(R=v.h.slice(0,ie+1)+R)}if(ie=R,ie==".."||ie==".")R="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){R=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const fe=[];for(let Xe=0;Xe<ie.length;){const tn=ie[Xe++];tn=="."?R&&Xe==ie.length&&fe.push(""):tn==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),R&&Xe==ie.length&&fe.push("")):(fe.push(tn),R=!0)}R=fe.join("/")}else R=ie}return E?v.h=R:E=f.i.toString()!=="",E?Ee(v,Tr(f.i)):E=!!f.m,E&&(v.m=f.m),v};function zn(f){return new Vs(f)}function qn(f,v,E){f.j=E?He(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Y(f,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);f.u=v}else f.u=null}function Ee(f,v,E){v instanceof Os?(f.i=v,Ir(f.i,f.l)):(E||(v=ht(v,hn)),f.i=new Os(v,f.l))}function re(f,v,E){f.i.set(v,E)}function Fe(f){return re(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function He(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ht(f,v,E){return typeof f=="string"?(f=encodeURI(f).replace(v,vt),E&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function vt(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Gt=/[#\/\?@]/g,Sn=/[#\?:]/g,Cs=/[#\?]/g,hn=/[#\?@]/g,tr=/#/g;function Os(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Es(f){f.g||(f.g=new Map,f.h=0,f.i&&er(f.i,function(v,E){f.add(decodeURIComponent(v.replace(/\+/g," ")),E)}))}n=Os.prototype,n.add=function(f,v){Es(this),this.i=null,f=Ks(this,f);let E=this.g.get(f);return E||this.g.set(f,E=[]),E.push(v),this.h+=1,this};function aa(f,v){Es(f),v=Ks(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function _i(f,v){return Es(f),v=Ks(f,v),f.g.has(v)}n.forEach=function(f,v){Es(this),this.g.forEach(function(E,R){E.forEach(function(ie){f.call(v,ie,R,this)},this)},this)};function xn(f,v){Es(f);let E=[];if(typeof v=="string")_i(f,v)&&(E=E.concat(f.g.get(Ks(f,v))));else for(f=Array.from(f.g.values()),v=0;v<f.length;v++)E=E.concat(f[v]);return E}n.set=function(f,v){return Es(this),this.i=null,f=Ks(this,f),_i(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},n.get=function(f,v){return f?(f=xn(this,f),f.length>0?String(f[0]):v):v};function _s(f,v,E){aa(f,v),E.length>0&&(f.i=null,f.g.set(Ks(f,v),N(E)),f.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var E=v[R];const ie=xe(E);E=xn(this,E);for(let fe=0;fe<E.length;fe++){let Xe=ie;E[fe]!==""&&(Xe+="="+xe(E[fe])),f.push(Xe)}}return this.i=f.join("&")};function Tr(f){const v=new Os;return v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),v}function Ks(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function Ir(f,v){v&&!f.j&&(Es(f),f.i=null,f.g.forEach(function(E,R){const ie=R.toLowerCase();R!=ie&&(aa(this,R),_s(this,ie,E))},f)),f.j=v}function ls(f,v){const E=new It;if(u.Image){const R=new Image;R.onload=b(Bs,E,"TestLoadImage: loaded",!0,v,R),R.onerror=b(Bs,E,"TestLoadImage: error",!1,v,R),R.onabort=b(Bs,E,"TestLoadImage: abort",!1,v,R),R.ontimeout=b(Bs,E,"TestLoadImage: timeout",!1,v,R),u.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=f}else v(!1)}function lr(f,v){const E=new It,R=new AbortController,ie=setTimeout(()=>{R.abort(),Bs(E,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:R.signal}).then(fe=>{clearTimeout(ie),fe.ok?Bs(E,"TestPingServer: ok",!0,v):Bs(E,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ie),Bs(E,"TestPingServer: error",!1,v)})}function Bs(f,v,E,R,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),R(E)}catch{}}function qr(){this.g=new be}function Dr(f){this.i=f.Sb||null,this.h=f.ab||!1}x(Dr,De),Dr.prototype.g=function(){return new Hr(this.i,this.h)};function Hr(f,v){dt.call(this),this.H=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Hr,dt),n=Hr.prototype,n.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=v,this.readyState=1,Ve(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(v.body=f),(this.H||u).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ne(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ve(this)),this.g&&(this.readyState=3,Ve(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;I(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function I(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?ne(this):Ve(this),this.readyState==3&&I(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,ne(this))},n.Na=function(f){this.g&&(this.response=f,ne(this))},n.ga=function(){this.g&&ne(this)};function ne(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Ve(f)}n.setRequestHeader=function(f,v){this.A.append(f,v)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var E=v.next();!E.done;)E=E.value,f.push(E[0]+": "+E[1]),E=v.next();return f.join(`\r
`)};function Ve(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Hr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function tt(f){let v="";return Ke(f,function(E,R){v+=R,v+=":",v+=E,v+=`\r
`}),v}function _t(f,v,E){e:{for(R in E){var R=!1;break e}R=!0}R||(E=tt(E),typeof f=="string"?E!=null&&xe(E):re(f,v,E))}function at(f){dt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(at,dt);var st=/^https?$/i,Kt=["POST","PUT"];n=at.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,v,E,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():On.g(),this.g.onreadystatechange=T(g(this.Ca,this));try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(fe){$t(this,fe);return}if(f=E||"",E=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var ie in R)E.set(ie,R[ie]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const fe of R.keys())E.set(fe,R.get(fe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(E.keys()).find(fe=>fe.toLowerCase()=="content-type"),ie=u.FormData&&f instanceof u.FormData,!(Array.prototype.indexOf.call(Kt,v,void 0)>=0)||R||ie||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Xe]of E)this.g.setRequestHeader(fe,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(fe){$t(this,fe)}};function $t(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.o=5,_n(f),en(f)}function _n(f){f.A||(f.A=!0,it(f,"complete"),it(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,it(this,"complete"),it(this,"abort"),en(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),at.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?jn(this):this.Xa())},n.Xa=function(){jn(this)};function jn(f){if(f.h&&typeof c<"u"){if(f.v&&ms(f)==4)setTimeout(f.Ca.bind(f),0);else if(it(f,"readystatechange"),ms(f)==4){f.h=!1;try{const fe=f.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var E;if(!(E=v)){var R;if(R=fe===0){let Xe=String(f.D).match(Hn)[1]||null;!Xe&&u.self&&u.self.location&&(Xe=u.self.location.protocol.slice(0,-1)),R=!st.test(Xe?Xe.toLowerCase():"")}E=R}if(E)it(f,"complete"),it(f,"success");else{f.o=6;try{var ie=ms(f)>2?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.ca()+"]",_n(f)}}finally{en(f)}}}}function en(f,v){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const E=f.g;f.g=null,v||it(f,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ms(f){return f.g?f.g.readyState:0}n.ca=function(){try{return ms(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),vn(v)}};function dn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function $n(f){const v={};f=(f.g&&ms(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<f.length;R++){if(L(f[R]))continue;var E=ke(f[R]);const ie=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const fe=v[ie]||[];v[ie]=fe,fe.push(E)}te(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ss(f,v,E){return E&&E.internalChannelParams&&E.internalChannelParams[f]||v}function rs(f){this.za=0,this.i=[],this.j=new It,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ss("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ss("baseRetryDelayMs",5e3,f),this.Za=ss("retryDelaySeedMs",1e4,f),this.Ta=ss("forwardChannelMaxRetries",2,f),this.va=ss("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Q(f&&f.concurrentRequestLimit),this.Ba=new qr,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=rs.prototype,n.ka=8,n.I=1,n.connect=function(f,v,E,R){ve(0),this.W=f,this.H=v||{},E&&R!==void 0&&(this.H.OSID=E,this.H.OAID=R),this.F=this.X,this.J=Dd(this,null,this.W),ks(this)};function Qs(f){if(Er(f),f.I==3){var v=f.V++,E=zn(f.J);if(re(E,"SID",f.M),re(E,"RID",v),re(E,"TYPE","terminate"),Us(f,E),v=new Se(f,f.j,v),v.M=2,v.A=Fe(zn(E)),E=!1,u.navigator&&u.navigator.sendBeacon)try{E=u.navigator.sendBeacon(v.A.toString(),"")}catch{}!E&&u.Image&&(new Image().src=v.A,E=!0),E||(v.g=Pd(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Gs(v)}Id(f)}function cr(f){f.g&&(Ha(f),f.g.cancel(),f.g=null)}function Er(f){cr(f),f.v&&(u.clearTimeout(f.v),f.v=null),$a(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&u.clearTimeout(f.m),f.m=null)}function ks(f){if(!ae(f.h)&&!f.m){f.m=!0;var v=f.Ea;Ne||S(),Te||(Ne(),Te=!0),C.add(v,f),f.D=0}}function ai(f,v){return Ye(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=v.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Ct(g(f.Ea,f,v),wi(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ie=new Se(this,this.j,f);let fe=this.o;if(this.U&&(fe?(fe=O(fe),we(fe,this.U)):fe=this.U),this.u!==null||this.R||(ie.J=fe,fe=null),this.S)e:{for(var v=0,E=0;E<this.i.length;E++){t:{var R=this.i[E];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=E;break e}if(v===4096||E===this.i.length-1){v=E+1;break e}}v=1e3}else v=1e3;v=kr(this,ie,v),E=zn(this.J),re(E,"RID",f),re(E,"CVER",22),this.G&&re(E,"X-HTTP-Session-Id",this.G),Us(this,E),fe&&(this.R?v="headers="+xe(tt(fe))+"&"+v:this.u&&_t(E,this.u,fe)),qe(this.h,ie),this.Ra&&re(E,"TYPE","init"),this.S?(re(E,"$req",v),re(E,"SID","null"),ie.U=!0,ut(ie,E,null)):ut(ie,E,v),this.I=2}}else this.I==3&&(f?Oi(this,f):this.i.length==0||ae(this.h)||Oi(this))};function Oi(f,v){var E;v?E=v.l:E=f.V++;const R=zn(f.J);re(R,"SID",f.M),re(R,"RID",E),re(R,"AID",f.K),Us(f,R),f.u&&f.o&&_t(R,f.u,f.o),E=new Se(f,f.j,E,f.D+1),f.u===null&&(E.J=f.o),v&&(f.i=v.G.concat(f.i)),v=kr(f,E,1e3),E.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),qe(f.h,E),ut(E,R,v)}function Us(f,v){f.H&&Ke(f.H,function(E,R){re(v,R,E)}),f.l&&Ke({},function(E,R){re(v,R,E)})}function kr(f,v,E){E=Math.min(f.i.length,E);const R=f.l?g(f.l.Ka,f.l,f):null;e:{var ie=f.i;let tn=-1;for(;;){const Is=["count="+E];tn==-1?E>0?(tn=ie[0].g,Is.push("ofs="+tn)):tn=0:Is.push("ofs="+tn);let Bn=!0;for(let ps=0;ps<E;ps++){var fe=ie[ps].g;const li=ie[ps].map;if(fe-=tn,fe<0)tn=Math.max(0,ie[ps].g-100),Bn=!1;else try{fe="req"+fe+"_"||"";try{var Xe=li instanceof Map?li:Object.entries(li);for(const[Bi,Ti]of Xe){let Ei=Ti;d(Ti)&&(Ei=cn(Ti)),Is.push(fe+Bi+"="+encodeURIComponent(Ei))}}catch(Bi){throw Is.push(fe+"type="+encodeURIComponent("_badmap")),Bi}}catch{R&&R(li)}}if(Bn){Xe=Is.join("&");break e}}Xe=void 0}return f=f.i.splice(0,E),v.G=f,Xe}function oi(f){if(!f.g&&!f.v){f.Y=1;var v=f.Da;Ne||S(),Te||(Ne(),Te=!0),C.add(v,f),f.A=0}}function Pr(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Ct(g(f.Da,f),wi(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,ec(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Ct(g(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ve(10),cr(this),ec(this))};function Ha(f){f.B!=null&&(u.clearTimeout(f.B),f.B=null)}function ec(f){f.g=new Se(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var v=zn(f.na);re(v,"RID","rpc"),re(v,"SID",f.M),re(v,"AID",f.K),re(v,"CI",f.F?"0":"1"),!f.F&&f.ia&&re(v,"TO",f.ia),re(v,"TYPE","xmlhttp"),Us(f,v),f.u&&f.o&&_t(v,f.u,f.o),f.O&&(f.g.H=f.O);var E=f.g;f=f.ba,E.M=1,E.A=Fe(zn(v)),E.u=null,E.R=!0,jt(E,f)}n.Va=function(){this.C!=null&&(this.C=null,cr(this),Pr(this),ve(19))};function $a(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function oa(f,v){var E=null;if(f.g==v){$a(f),Ha(f),f.g=null;var R=2}else if($e(f.h,v))E=v.G,Ut(f.h,v),R=1;else return;if(f.I!=0){if(v.o)if(R==1){E=v.u?v.u.length:0,v=Date.now()-v.F;var ie=f.D;R=bt(),it(R,new lt(R,E)),ks(f)}else oi(f);else if(ie=v.m,ie==3||ie==0&&v.X>0||!(R==1&&ai(f,v)||R==2&&Pr(f)))switch(E&&E.length>0&&(v=f.h,v.i=v.i.concat(E)),ie){case 1:ur(f,5);break;case 4:ur(f,10);break;case 3:ur(f,6);break;default:ur(f,2)}}}function wi(f,v){let E=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(E*=2),E*v}function ur(f,v){if(f.j.info("Error code "+v),v==2){var E=g(f.bb,f),R=f.Ua;const ie=!R;R=new Vs(R||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||qn(R,"https"),Fe(R),ie?ls(R.toString(),E):lr(R.toString(),E)}else ve(2);f.I=0,f.l&&f.l.pa(v),Id(f),Er(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),ve(2)):(this.j.info("Failed to ping google.com"),ve(1))};function Id(f){if(f.I=0,f.ja=[],f.l){const v=Mt(f.h);(v.length!=0||f.i.length!=0)&&(B(f.ja,v),B(f.ja,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.oa()}}function Dd(f,v,E){var R=E instanceof Vs?zn(E):new Vs(E);if(R.g!="")v&&(R.g=v+"."+R.g),Y(R,R.u);else{var ie=u.location;R=ie.protocol,v=v?v+"."+ie.hostname:ie.hostname,ie=+ie.port;const fe=new Vs(null);R&&qn(fe,R),v&&(fe.g=v),ie&&Y(fe,ie),E&&(fe.h=E),R=fe}return E=f.G,v=f.wa,E&&v&&re(R,E,v),re(R,"VER",f.ka),Us(f,R),R}function Pd(f,v,E){if(v&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Aa&&!f.ma?new at(new Dr({ab:E})):new at(f.ma),v.Fa(f.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Md(){}n=Md.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Wa(){}Wa.prototype.g=function(f,v){return new Sr(f,v)};function Sr(f,v){dt.call(this),this.g=new rs(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(f?f["X-WebChannel-Client-Profile"]=v.sa:f={"X-WebChannel-Client-Profile":v.sa}),this.g.U=f,(f=v&&v.Qb)&&!L(f)&&(this.g.u=f),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!L(v)&&(this.g.G=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new la(this)}x(Sr,dt),Sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sr.prototype.close=function(){Qs(this.g)},Sr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var E={};E.__data__=f,f=E}else this.v&&(E={},E.__data__=cn(f),f=E);v.i.push(new A(v.Ya++,f)),v.I==3&&ks(v)},Sr.prototype.N=function(){this.g.l=null,delete this.j,Qs(this.g),delete this.g,Sr.Z.N.call(this)};function Ld(f){Ue.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const E in v){f=E;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}x(Ld,Ue);function Vd(){Me.call(this),this.status=1}x(Vd,Me);function la(f){this.g=f}x(la,Md),la.prototype.ra=function(){it(this.g,"a")},la.prototype.qa=function(f){it(this.g,new Ld(f))},la.prototype.pa=function(f){it(this.g,new Vd)},la.prototype.oa=function(){it(this.g,"b")},Wa.prototype.createWebChannel=Wa.prototype.g,Sr.prototype.send=Sr.prototype.o,Sr.prototype.open=Sr.prototype.m,Sr.prototype.close=Sr.prototype.close,hk=function(){return new Wa},uk=function(){return bt()},ck=ze,jb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pn.NO_ERROR=0,pn.TIMEOUT=8,pn.HTTP_ERROR=6,dm=pn,In.COMPLETE="complete",lk=In,Be.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",dt.prototype.listen=dt.prototype.J,Rh=Be,at.prototype.listenOnce=at.prototype.K,at.prototype.getLastError=at.prototype.Ha,at.prototype.getLastErrorCode=at.prototype.ya,at.prototype.getStatus=at.prototype.ca,at.prototype.getResponseJson=at.prototype.La,at.prototype.getResponseText=at.prototype.la,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Fa,ok=at}).apply(typeof Hf<"u"?Hf:typeof self<"u"?self:typeof window<"u"?window:{});class rr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rr.UNAUTHENTICATED=new rr(null),rr.GOOGLE_CREDENTIALS=new rr("google-credentials-uid"),rr.FIRST_PARTY=new rr("first-party-uid"),rr.MOCK_USER=new rr("mock-user");let Tu="12.8.0";function SP(n){Tu=n}const Bo=new dv("@firebase/firestore");function Fc(){return Bo.logLevel}function CO(n){Bo.setLogLevel(n)}function Oe(n,...e){if(Bo.logLevel<=En.DEBUG){const t=e.map(kv);Bo.debug(`Firestore (${Tu}): ${n}`,...t)}}function Ms(n,...e){if(Bo.logLevel<=En.ERROR){const t=e.map(kv);Bo.error(`Firestore (${Tu}): ${n}`,...t)}}function xi(n,...e){if(Bo.logLevel<=En.WARN){const t=e.map(kv);Bo.warn(`Firestore (${Tu}): ${n}`,...t)}}function kv(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ot(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,dk(n,s,t)}function dk(n,e,t){let s=`FIRESTORE (${Tu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Ms(s),new Error(s)}function pt(n,e,t,s){let o="Unexpected state";typeof t=="string"?o=t:s=t,n||dk(e,o,s)}function IO(n,e){n||ot(57014,e)}function Ze(n,e){return n}const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends ia{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ar{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class fk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(rr.UNAUTHENTICATED)))}shutdown(){}}class NP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class AP{constructor(e){this.t=e,this.currentUser=rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){pt(this.o===void 0,42304);let s=this.i;const o=p=>this.i!==s?(s=this.i,t(p)):Promise.resolve();let c=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ar,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const p=c;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},d=p=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ar)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(pt(typeof s.accessToken=="string",31837,{l:s}),new fk(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pt(e===null||typeof e=="string",2055,{h:e}),new rr(e)}}class RP{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=rr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class CP{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new RP(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(rr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IP{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){pt(this.o===void 0,3512);const s=c=>{c.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const u=c.token!==this.m;return this.m=c.token,Oe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>s(c)))};const o=c=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Nb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(pt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Nb(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class DO{getToken(){return Promise.resolve(new Nb(""))}invalidateToken(){}start(e,t){}shutdown(){}}function DP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class Sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=DP(40);for(let c=0;c<o.length;++c)s.length<20&&o[c]<t&&(s+=e.charAt(o[c]%62))}return s}}function Bt(n,e){return n<e?-1:n>e?1:0}function Ab(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const o=n.charAt(s),c=e.charAt(s);if(o!==c)return qy(o)===qy(c)?Bt(o,c):qy(o)?1:-1}return Bt(n.length,e.length)}const PP=55296,MP=57343;function qy(n){const e=n.charCodeAt(0);return e>=PP&&e<=MP}function Jc(n,e,t){return n.length===e.length&&n.every(((s,o)=>t(s,e[o])))}function mk(n){return n+"\0"}const Rb="__name__";class $i{constructor(e,t,s){t===void 0?t=0:t>e.length&&ot(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&ot(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return $i.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $i?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let o=0;o<s;o++){const c=$i.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Bt(e.length,t.length)}static compareSegments(e,t){const s=$i.isNumericId(e),o=$i.isNumericId(t);return s&&!o?-1:!s&&o?1:s&&o?$i.extractNumericId(e).compare($i.extractNumericId(t)):Ab(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Lo.fromString(e.substring(4,e.length-2))}}class mn extends $i{construct(e,t,s){return new mn(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ce(ce.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((o=>o.length>0)))}return new mn(t)}static emptyPath(){return new mn([])}}const LP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends $i{construct(e,t,s){return new bs(e,t,s)}static isValidIdentifier(e){return LP.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Rb}static keyField(){return new bs([Rb])}static fromServerFormat(e){const t=[];let s="",o=0;const c=()=>{if(s.length===0)throw new Ce(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ce(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Ce(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,o+=2}else d==="`"?(u=!u,o++):d!=="."||u?(s+=d,o++):(c(),o++)}if(c(),u)throw new Ce(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bs(t)}static emptyPath(){return new bs([])}}class Je{constructor(e){this.path=e}static fromPath(e){return new Je(mn.fromString(e))}static fromName(e){return new Je(mn.fromString(e).popFirst(5))}static empty(){return new Je(mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new mn(e.slice()))}}function jv(n,e,t){if(!t)throw new Ce(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VP(n,e,t,s){if(e===!0&&s===!0)throw new Ce(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function i2(n){if(!Je.isDocumentKey(n))throw new Ce(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function a2(n){if(Je.isDocumentKey(n))throw new Ce(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function pk(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ap(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ot(12329,{type:typeof n})}function bn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ap(n);throw new Ce(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function gk(n,e){if(e<=0)throw new Ce(ce.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ws(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ql(n,e){if(!pk(n))throw new Ce(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const o=e[s].typeString,c="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(o&&typeof u!==o){t=`JSON field '${s}' must be a ${o}.`;break}if(c!==void 0&&u!==c.value){t=`Expected '${s}' field to equal '${c.value}'`;break}}if(t)throw new Ce(ce.INVALID_ARGUMENT,t);return!0}const o2=-62135596800,l2=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*l2);return new mt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<o2)throw new Ce(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l2}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ql(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-o2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:Ws("string",mt._jsonSchemaVersion),seconds:Ws("number"),nanoseconds:Ws("number")};class Tt{static fromTimestamp(e){return new Tt(e)}static min(){return new Tt(new mt(0,0))}static max(){return new Tt(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Zc=-1;class eu{constructor(e,t,s,o){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=o}}function Cb(n){return n.fields.find((e=>e.kind===2))}function _l(n){return n.fields.filter((e=>e.kind!==2))}function OP(n,e){let t=Bt(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let s=0;s<Math.min(n.fields.length,e.fields.length);++s)if(t=BP(n.fields[s],e.fields[s]),t!==0)return t;return Bt(n.fields.length,e.fields.length)}eu.UNKNOWN_ID=-1;class Al{constructor(e,t){this.fieldPath=e,this.kind=t}}function BP(n,e){const t=bs.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Bt(n.kind,e.kind)}class tu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new tu(0,si.min())}}function yk(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,o=Tt.fromTimestamp(s===1e9?new mt(t+1,0):new mt(t,s));return new si(o,Je.empty(),e)}function bk(n){return new si(n.readTime,n.key,Zc)}class si{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new si(Tt.min(),Je.empty(),Zc)}static max(){return new si(Tt.max(),Je.empty(),Zc)}}function Nv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Je.comparator(n.documentKey,e.documentKey),t!==0?t:Bt(n.largestBatchId,e.largestBatchId))}const vk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Go(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==vk)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se(((s,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(s,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(s,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(t){return se.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):se.reject(t)}static resolve(e){return new se(((t,s)=>{t(e)}))}static reject(e){return new se(((t,s)=>{s(e)}))}static waitFor(e){return new se(((t,s)=>{let o=0,c=0,u=!1;e.forEach((d=>{++o,d.next((()=>{++c,u&&c===o&&t()}),(p=>s(p)))})),u=!0,c===o&&t()}))}static or(e){let t=se.resolve(!1);for(const s of e)t=t.next((o=>o?se.resolve(o):s()));return t}static forEach(e,t){const s=[];return e.forEach(((o,c)=>{s.push(t.call(this,o,c))})),this.waitFor(s)}static mapArray(e,t){return new se(((s,o)=>{const c=e.length,u=new Array(c);let d=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next((b=>{u[g]=b,++d,d===c&&s(u)}),(b=>o(b)))}}))}static doWhile(e,t){return new se(((s,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):s()};c()}))}}const Jr="SimpleDb";class op{static open(e,t,s,o){try{return new op(t,e.transaction(o,s))}catch(c){throw new Lh(t,c)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Lh(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const o=Av(s.target.error);this.S.reject(new Lh(e,o))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Oe(Jr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new FP(t)}}class Zi{static delete(e){return Oe(Jr,"Removing database:",e),Tl(dE().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!_E())return!1;if(Zi.F())return!0;const e=Xs(),t=Zi.M(e),s=0<t&&t<10,o=_k(e),c=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||c)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,Zi.M(Xs())===12.2&&Ms("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Oe(Jr,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=c=>{const u=c.target.result;t(u)},o.onblocked=()=>{s(new Lh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=c=>{const u=c.target.error;u.name==="VersionError"?s(new Ce(ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?s(new Ce(ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):s(new Lh(e,u))},o.onupgradeneeded=c=>{Oe(Jr,'Database "'+this.name+'" requires upgrade from version:',c.oldVersion);const u=c.target.result;this.N.k(u,o.transaction,c.oldVersion,this.version).next((()=>{Oe(Jr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,o){const c=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const d=op.open(this.db,e,c?"readonly":"readwrite",s),p=o(d).next((g=>(d.C(),g))).catch((g=>(d.abort(g),se.reject(g)))).toPromise();return p.catch((()=>{})),await d.D,p}catch(d){const p=d,g=p.name!=="FirebaseError"&&u<3;if(Oe(Jr,"Transaction failed with error:",p.message,"Retrying:",g),this.close(),!g)return Promise.reject(p)}}}close(){this.db&&this.db.close(),this.db=void 0}}function _k(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class UP{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Tl(this.U.delete())}}class Lh extends Ce{constructor(e,t){super(ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ko(n){return n.name==="IndexedDbTransactionError"}class FP{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(Oe(Jr,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(Oe(Jr,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Tl(s)}add(e){return Oe(Jr,"ADD",this.store.name,e,e),Tl(this.store.add(e))}get(e){return Tl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Oe(Jr,"GET",this.store.name,e,t),t)))}delete(e){return Oe(Jr,"DELETE",this.store.name,e),Tl(this.store.delete(e))}count(){return Oe(Jr,"COUNT",this.store.name),Tl(this.store.count())}H(e,t){const s=this.options(e,t),o=s.index?this.store.index(s.index):this.store;if(typeof o.getAll=="function"){const c=o.getAll(s.range);return new se(((u,d)=>{c.onerror=p=>{d(p.target.error)},c.onsuccess=p=>{u(p.target.result)}}))}{const c=this.cursor(s),u=[];return this.J(c,((d,p)=>{u.push(p)})).next((()=>u))}}Z(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new se(((o,c)=>{s.onerror=u=>{c(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}X(e,t){Oe(Jr,"DELETE ALL",this.store.name);const s=this.options(e,t);s.Y=!1;const o=this.cursor(s);return this.J(o,((c,u,d)=>d.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const o=this.cursor(s);return this.J(o,t)}te(e){const t=this.cursor({});return new se(((s,o)=>{t.onerror=c=>{const u=Av(c.target.error);o(u)},t.onsuccess=c=>{const u=c.target.result;u?e(u.primaryKey,u.value).next((d=>{d?u.continue():s()})):s()}}))}J(e,t){const s=[];return new se(((o,c)=>{e.onerror=u=>{c(u.target.error)},e.onsuccess=u=>{const d=u.target.result;if(!d)return void o();const p=new UP(d),g=t(d.primaryKey,d.value,p);if(g instanceof se){const b=g.catch((x=>(p.done(),se.reject(x))));s.push(b)}p.isDone?o():p.G===null?d.continue():d.continue(p.G)}})).next((()=>se.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.Y?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Tl(n){return new se(((e,t)=>{n.onsuccess=s=>{const o=s.target.result;e(o)},n.onerror=s=>{const o=Av(s.target.error);t(o)}}))}let c2=!1;function Av(n){const e=Zi.M(Xs());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return c2||(c2=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Vh="IndexBackfiller";class zP{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Oe(Vh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Oe(Vh,`Documents written: ${t}`)}catch(t){Ko(t)?Oe(Vh,"Ignoring IndexedDB error during index backfill: ",t):await Go(t)}await this.re(6e4)}))}}class qP{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let o=t,c=!0;return se.doWhile((()=>c===!0&&o>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!s.has(u))return Oe(Vh,`Processing collection: ${u}`),this.oe(e,u,o).next((d=>{o-=d,s.add(u)}));c=!1})))).next((()=>t-o))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((o=>this.localStore.localDocuments.getNextDocuments(e,t,o,s).next((c=>{const u=c.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(o,c))).next((d=>(Oe(Vh,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>u.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((o,c)=>{const u=bk(c);Nv(u,s)>0&&(s=u)})),new si(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ur{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ur.ce=-1;const Vo=-1;function yd(n){return n==null}function Yh(n){return n===0&&1/n==-1/0}function wk(n){return typeof n=="number"&&Number.isInteger(n)&&!Yh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Pm="";function _r(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=u2(e)),e=HP(n.get(t),e);return u2(e)}function HP(n,e){let t=e;const s=n.length;for(let o=0;o<s;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Pm:t+="";break;default:t+=c}}return t}function u2(n){return n+Pm+""}function Gi(n){const e=n.length;if(pt(e>=2,64408,{path:n}),e===2)return pt(n.charAt(0)===Pm&&n.charAt(1)==="",56145,{path:n}),mn.emptyPath();const t=e-2,s=[];let o="";for(let c=0;c<e;){const u=n.indexOf(Pm,c);switch((u<0||u>t)&&ot(50515,{path:n}),n.charAt(u+1)){case"":const d=n.substring(c,u);let p;o.length===0?p=d:(o+=d,p=o,o=""),s.push(p);break;case"":o+=n.substring(c,u),o+="\0";break;case"":o+=n.substring(c,u+1);break;default:ot(61167,{path:n})}c=u+2}return new mn(s)}const wl="remoteDocuments",bd="owner",Cc="owner",Xh="mutationQueues",$P="userId",Ci="mutations",h2="batchId",jl="userMutationsIndex",d2=["userId","batchId"];function fm(n,e){return[n,_r(e)]}function Tk(n,e,t){return[n,_r(e),t]}const WP={},nu="documentMutations",Mm="remoteDocumentsV14",GP=["prefixPath","collectionGroup","readTime","documentId"],mm="documentKeyIndex",KP=["prefixPath","collectionGroup","documentId"],Ek="collectionGroupIndex",QP=["collectionGroup","readTime","prefixPath","documentId"],Jh="remoteDocumentGlobal",Ib="remoteDocumentGlobalKey",su="targets",kk="queryTargetsIndex",YP=["canonicalId","targetId"],ru="targetDocuments",XP=["targetId","path"],Rv="documentTargetsIndex",JP=["path","targetId"],Lm="targetGlobalKey",Rl="targetGlobal",Zh="collectionParents",ZP=["collectionId","parent"],iu="clientMetadata",eM="clientId",lp="bundles",tM="bundleId",cp="namedQueries",nM="name",Cv="indexConfiguration",sM="indexId",Db="collectionGroupIndex",rM="collectionGroup",Oh="indexState",iM=["indexId","uid"],Sk="sequenceNumberIndex",aM=["uid","sequenceNumber"],Bh="indexEntries",oM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jk="documentKeyIndex",lM=["indexId","uid","orderedDocumentKey"],up="documentOverlays",cM=["userId","collectionPath","documentId"],Pb="collectionPathOverlayIndex",uM=["userId","collectionPath","largestBatchId"],Nk="collectionGroupOverlayIndex",hM=["userId","collectionGroup","largestBatchId"],Iv="globals",dM="name",Ak=[Xh,Ci,nu,wl,su,bd,Rl,ru,iu,Jh,Zh,lp,cp],fM=[...Ak,up],Rk=[Xh,Ci,nu,Mm,su,bd,Rl,ru,iu,Jh,Zh,lp,cp,up],Ck=Rk,Dv=[...Ck,Cv,Oh,Bh],mM=Dv,Ik=[...Dv,Iv],pM=Ik;class Mb extends xk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Js(n,e){const t=Ze(n);return Zi.O(t.le,e)}function f2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Dk(n,e){const t=[];for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.push(e(n[s],s,n));return t}function Pk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class us{constructor(e,t){this.comparator=e,this.root=t||pr.EMPTY}insert(e,t){return new us(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pr.BLACK,null,null))}remove(e){return new us(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return t+s.left.size;o<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $f(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $f(this.root,e,this.comparator,!1)}getReverseIterator(){return new $f(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $f(this.root,e,this.comparator,!0)}}class $f{constructor(e,t,s,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?s(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pr{constructor(e,t,s,o,c){this.key=e,this.value=t,this.color=s??pr.RED,this.left=o??pr.EMPTY,this.right=c??pr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,o,c){return new pr(e??this.key,t??this.value,s??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let o=this;const c=s(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,s),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return pr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return pr.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ot(27949);return e+(this.isRed()?0:1)}}pr.EMPTY=null,pr.RED=!0,pr.BLACK=!1;pr.EMPTY=new class{constructor(){this.size=0}get key(){throw ot(57766)}get value(){throw ot(16141)}get color(){throw ot(16727)}get left(){throw ot(29726)}get right(){throw ot(36894)}copy(e,t,s,o,c){return this}insert(e,t,s){return new pr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Yn{constructor(e){this.comparator=e,this.data=new us(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new m2(this.data.getIterator())}getIteratorFrom(e){return new m2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Yn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Yn(this.comparator);return t.data=e,t}}class m2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ic(n){return n.hasNext()?n.getNext():void 0}class Fr{constructor(e){this.fields=e,e.sort(bs.comparator)}static empty(){return new Fr([])}unionWith(e){let t=new Yn(bs.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Fr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jc(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class Mk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function MO(){return typeof atob<"u"}class Ns{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new Mk("Invalid base64 string: "+c):c}})(e);return new Ns(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let u=0;u<o.length;++u)c+=String.fromCharCode(o[u]);return c})(e);return new Ns(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ns.EMPTY_BYTE_STRING=new Ns("");const gM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pa(n){if(pt(!!n,39018),typeof n=="string"){let e=0;const t=gM.exec(n);if(pt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ys(n.seconds),nanos:ys(n.nanos)}}function ys(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ma(n){return typeof n=="string"?Ns.fromBase64String(n):Ns.fromUint8Array(n)}const Lk="server_timestamp",Vk="__type__",Ok="__previous_value__",Bk="__local_write_time__";function hp(n){return(n?.mapValue?.fields||{})[Vk]?.stringValue===Lk}function dp(n){const e=n.mapValue.fields[Ok];return hp(e)?dp(e):e}function ed(n){const e=Pa(n.mapValue.fields[Bk].timestampValue);return new mt(e.seconds,e.nanos)}class yM{constructor(e,t,s,o,c,u,d,p,g,b,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=o,this.ssl=c,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=x}}const td="(default)";class Vl{constructor(e,t){this.projectId=e,this.database=t||td}static empty(){return new Vl("","")}get isDefaultDatabase(){return this.database===td}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}function bM(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Ce(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(n.options.projectId,e)}const Pv="__type__",Uk="__max__",Ao={mapValue:{fields:{__type__:{stringValue:Uk}}}},Mv="__vector__",au="value",pm={nullValue:"NULL_VALUE"};function Uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hp(n)?4:Fk(n)?9007199254740991:fp(n)?10:11:ot(28295,{value:n})}function sa(n,e){if(n===e)return!0;const t=Uo(n);if(t!==Uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ed(n).isEqual(ed(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const u=Pa(o.timestampValue),d=Pa(c.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Ma(o.bytesValue).isEqual(Ma(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return ys(o.geoPointValue.latitude)===ys(c.geoPointValue.latitude)&&ys(o.geoPointValue.longitude)===ys(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return ys(o.integerValue)===ys(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const u=ys(o.doubleValue),d=ys(c.doubleValue);return u===d?Yh(u)===Yh(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return Jc(n.arrayValue.values||[],e.arrayValue.values||[],sa);case 10:case 11:return(function(o,c){const u=o.mapValue.fields||{},d=c.mapValue.fields||{};if(f2(u)!==f2(d))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(d[p]===void 0||!sa(u[p],d[p])))return!1;return!0})(n,e);default:return ot(52216,{left:n})}}function nd(n,e){return(n.values||[]).find((t=>sa(t,e)))!==void 0}function Fo(n,e){if(n===e)return 0;const t=Uo(n),s=Uo(e);if(t!==s)return Bt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Bt(n.booleanValue,e.booleanValue);case 2:return(function(c,u){const d=ys(c.integerValue||c.doubleValue),p=ys(u.integerValue||u.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(n,e);case 3:return p2(n.timestampValue,e.timestampValue);case 4:return p2(ed(n),ed(e));case 5:return Ab(n.stringValue,e.stringValue);case 6:return(function(c,u){const d=Ma(c),p=Ma(u);return d.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(c,u){const d=c.split("/"),p=u.split("/");for(let g=0;g<d.length&&g<p.length;g++){const b=Bt(d[g],p[g]);if(b!==0)return b}return Bt(d.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,u){const d=Bt(ys(c.latitude),ys(u.latitude));return d!==0?d:Bt(ys(c.longitude),ys(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return g2(n.arrayValue,e.arrayValue);case 10:return(function(c,u){const d=c.fields||{},p=u.fields||{},g=d[au]?.arrayValue,b=p[au]?.arrayValue,x=Bt(g?.values?.length||0,b?.values?.length||0);return x!==0?x:g2(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,u){if(c===Ao.mapValue&&u===Ao.mapValue)return 0;if(c===Ao.mapValue)return 1;if(u===Ao.mapValue)return-1;const d=c.fields||{},p=Object.keys(d),g=u.fields||{},b=Object.keys(g);p.sort(),b.sort();for(let x=0;x<p.length&&x<b.length;++x){const T=Ab(p[x],b[x]);if(T!==0)return T;const N=Fo(d[p[x]],g[b[x]]);if(N!==0)return N}return Bt(p.length,b.length)})(n.mapValue,e.mapValue);default:throw ot(23264,{he:t})}}function p2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Bt(n,e);const t=Pa(n),s=Pa(e),o=Bt(t.seconds,s.seconds);return o!==0?o:Bt(t.nanos,s.nanos)}function g2(n,e){const t=n.values||[],s=e.values||[];for(let o=0;o<t.length&&o<s.length;++o){const c=Fo(t[o],s[o]);if(c)return c}return Bt(t.length,s.length)}function ou(n){return Lb(n)}function Lb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Pa(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ma(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Je.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",o=!0;for(const c of t.values||[])o?o=!1:s+=",",s+=Lb(c);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const u of s)c?c=!1:o+=",",o+=`${u}:${Lb(t.fields[u])}`;return o+"}"})(n.mapValue):ot(61005,{value:n})}function gm(n){switch(Uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dp(n);return e?16+gm(e):16;case 5:return 2*n.stringValue.length;case 6:return Ma(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,c)=>o+gm(c)),0)})(n.arrayValue);case 10:case 11:return(function(s){let o=0;return Qo(s.fields,((c,u)=>{o+=c.length+gm(u)})),o})(n.mapValue);default:throw ot(13486,{value:n})}}function Ol(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Vb(n){return!!n&&"integerValue"in n}function sd(n){return!!n&&"arrayValue"in n}function y2(n){return!!n&&"nullValue"in n}function b2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ym(n){return!!n&&"mapValue"in n}function fp(n){return(n?.mapValue?.fields||{})[Pv]?.stringValue===Mv}function Uh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Qo(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Uh(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Uh(n.arrayValue.values[t]);return e}return{...n}}function Fk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Uk}const zk={mapValue:{fields:{[Pv]:{stringValue:Mv},[au]:{arrayValue:{}}}}};function vM(n){return"nullValue"in n?pm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ol(Vl.empty(),Je.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fp(n)?zk:{mapValue:{}}:ot(35942,{value:n})}function xM(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ol(Vl.empty(),Je.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?zk:"mapValue"in n?fp(n)?{mapValue:{}}:Ao:ot(61959,{value:n})}function v2(n,e){const t=Fo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function x2(n,e){const t=Fo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ir{constructor(e){this.value=e}static empty(){return new ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ym(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uh(t)}setAll(e){let t=bs.emptyPath(),s={},o=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,s,o),s={},o=[],t=d.popLast()}u?s[d.lastSegment()]=Uh(u):o.push(d.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,s,o)}delete(e){const t=this.field(e.popLast());ym(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return sa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=t.mapValue.fields[e.get(s)];ym(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,s){Qo(t,((o,c)=>e[o]=c));for(const o of s)delete e[o]}clone(){return new ir(Uh(this.value))}}function qk(n){const e=[];return Qo(n.fields,((t,s)=>{const o=new bs([t]);if(ym(s)){const c=qk(s.mapValue).fields;if(c.length===0)e.push(o);else for(const u of c)e.push(o.child(u))}else e.push(o)})),new Fr(e)}class fs{constructor(e,t,s,o,c,u,d){this.key=e,this.documentType=t,this.version=s,this.readTime=o,this.createTime=c,this.data=u,this.documentState=d}static newInvalidDocument(e){return new fs(e,0,Tt.min(),Tt.min(),Tt.min(),ir.empty(),0)}static newFoundDocument(e,t,s,o){return new fs(e,1,t,Tt.min(),s,o,0)}static newNoDocument(e,t){return new fs(e,2,t,Tt.min(),Tt.min(),ir.empty(),0)}static newUnknownDocument(e,t){return new fs(e,3,t,Tt.min(),Tt.min(),ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof fs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new fs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zo{constructor(e,t){this.position=e,this.inclusive=t}}function _2(n,e,t){let s=0;for(let o=0;o<n.position.length;o++){const c=e[o],u=n.position[o];if(c.field.isKeyField()?s=Je.comparator(Je.fromName(u.referenceValue),t.key):s=Fo(u,t.data.field(c.field)),c.dir==="desc"&&(s*=-1),s!==0)break}return s}function w2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!sa(n.position[t],e.position[t]))return!1;return!0}class rd{constructor(e,t="asc"){this.field=e,this.dir=t}}function _M(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Hk{}class kn extends Hk{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new wM(e,t,s):t==="array-contains"?new kM(e,s):t==="in"?new Yk(e,s):t==="not-in"?new SM(e,s):t==="array-contains-any"?new jM(e,s):new kn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new TM(e,s):new EM(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fo(t,this.value)):t!==null&&Uo(this.value)===Uo(t)&&this.matchesComparison(Fo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qn extends Hk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qn(e,t)}matches(e){return lu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function lu(n){return n.op==="and"}function Ob(n){return n.op==="or"}function Lv(n){return $k(n)&&lu(n)}function $k(n){for(const e of n.filters)if(e instanceof Qn)return!1;return!0}function Bb(n){if(n instanceof kn)return n.field.canonicalString()+n.op.toString()+ou(n.value);if(Lv(n))return n.filters.map((e=>Bb(e))).join(",");{const e=n.filters.map((t=>Bb(t))).join(",");return`${n.op}(${e})`}}function Wk(n,e){return n instanceof kn?(function(s,o){return o instanceof kn&&s.op===o.op&&s.field.isEqual(o.field)&&sa(s.value,o.value)})(n,e):n instanceof Qn?(function(s,o){return o instanceof Qn&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((c,u,d)=>c&&Wk(u,o.filters[d])),!0):!1})(n,e):void ot(19439)}function Gk(n,e){const t=n.filters.concat(e);return Qn.create(t,n.op)}function Kk(n){return n instanceof kn?(function(t){return`${t.field.canonicalString()} ${t.op} ${ou(t.value)}`})(n):n instanceof Qn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Kk).join(" ,")+"}"})(n):"Filter"}class wM extends kn{constructor(e,t,s){super(e,t,s),this.key=Je.fromName(s.referenceValue)}matches(e){const t=Je.comparator(e.key,this.key);return this.matchesComparison(t)}}class TM extends kn{constructor(e,t){super(e,"in",t),this.keys=Qk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class EM extends kn{constructor(e,t){super(e,"not-in",t),this.keys=Qk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Qk(n,e){return(e.arrayValue?.values||[]).map((t=>Je.fromName(t.referenceValue)))}class kM extends kn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sd(t)&&nd(t.arrayValue,this.value)}}class Yk extends kn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&nd(this.value.arrayValue,t)}}class SM extends kn{constructor(e,t){super(e,"not-in",t)}matches(e){if(nd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!nd(this.value.arrayValue,t)}}class jM extends kn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>nd(this.value.arrayValue,s)))}}class NM{constructor(e,t=null,s=[],o=[],c=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=o,this.limit=c,this.startAt=u,this.endAt=d,this.Te=null}}function Ub(n,e=null,t=[],s=[],o=null,c=null,u=null){return new NM(n,e,t,s,o,c,u)}function Bl(n){const e=Ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Bb(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(c){return c.field.canonicalString()+c.dir})(s))).join(","),yd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>ou(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>ou(s))).join(",")),e.Te=t}return e.Te}function vd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!_M(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Wk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!w2(n.startAt,e.startAt)&&w2(n.endAt,e.endAt)}function Vm(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Om(n,e){return n.filters.filter((t=>t instanceof kn&&t.field.isEqual(e)))}function T2(n,e,t){let s=pm,o=!0;for(const c of Om(n,e)){let u=pm,d=!0;switch(c.op){case"<":case"<=":u=vM(c.value);break;case"==":case"in":case">=":u=c.value;break;case">":u=c.value,d=!1;break;case"!=":case"not-in":u=pm}v2({value:s,inclusive:o},{value:u,inclusive:d})<0&&(s=u,o=d)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];v2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})<0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}function E2(n,e,t){let s=Ao,o=!0;for(const c of Om(n,e)){let u=Ao,d=!0;switch(c.op){case">=":case">":u=xM(c.value),d=!1;break;case"==":case"in":case"<=":u=c.value;break;case"<":u=c.value,d=!1;break;case"!=":case"not-in":u=Ao}x2({value:s,inclusive:o},{value:u,inclusive:d})>0&&(s=u,o=d)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];x2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})>0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}class Ua{constructor(e,t=null,s=[],o=[],c=null,u="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=o,this.limit=c,this.limitType=u,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Xk(n,e,t,s,o,c,u,d){return new Ua(n,e,t,s,o,c,u,d)}function Eu(n){return new Ua(n)}function k2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function AM(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Vv(n){return n.collectionGroup!==null}function Qc(n){const e=Ze(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Yn(bs.comparator);return u.filters.forEach((p=>{p.getFlattenedFilters().forEach((g=>{g.isInequality()&&(d=d.add(g.field))}))})),d})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new rd(c,s))})),t.has(bs.keyField().canonicalString())||e.Ie.push(new rd(bs.keyField(),s))}return e.Ie}function wr(n){const e=Ze(n);return e.Ee||(e.Ee=Zk(e,Qc(n))),e.Ee}function Jk(n){const e=Ze(n);return e.Re||(e.Re=Zk(e,n.explicitOrderBy)),e.Re}function Zk(n,e){if(n.limitType==="F")return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new rd(o.field,c)}));const t=n.endAt?new zo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new zo(n.startAt.position,n.startAt.inclusive):null;return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Fb(n,e){const t=n.filters.concat([e]);return new Ua(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function RM(n,e){const t=n.explicitOrderBy.concat([e]);return new Ua(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Bm(n,e,t){return new Ua(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function CM(n,e){return new Ua(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function IM(n,e){return new Ua(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function xd(n,e){return vd(wr(n),wr(e))&&n.limitType===e.limitType}function eS(n){return`${Bl(wr(n))}|lt:${n.limitType}`}function zc(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((o=>Kk(o))).join(", ")}]`),yd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((o=>ou(o))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((o=>ou(o))).join(",")),`Target(${s})`})(wr(n))}; limitType=${n.limitType})`}function _d(n,e){return e.isFoundDocument()&&(function(s,o){const c=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(c):Je.isDocumentKey(s.path)?s.path.isEqual(c):s.path.isImmediateParentOf(c)})(n,e)&&(function(s,o){for(const c of Qc(s))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(s,o){for(const c of s.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(s,o){return!(s.startAt&&!(function(u,d,p){const g=_2(u,d,p);return u.inclusive?g<=0:g<0})(s.startAt,Qc(s),o)||s.endAt&&!(function(u,d,p){const g=_2(u,d,p);return u.inclusive?g>=0:g>0})(s.endAt,Qc(s),o))})(n,e)}function tS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nS(n){return(e,t)=>{let s=!1;for(const o of Qc(n)){const c=DM(o,e,t);if(c!==0)return c;s=s||o.field.isKeyField()}return 0}}function DM(n,e,t){const s=n.field.isKeyField()?Je.comparator(e.key,t.key):(function(c,u,d){const p=u.data.field(c),g=d.data.field(c);return p!==null&&g!==null?Fo(p,g):ot(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ot(19790,{direction:n.dir})}}class Fa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[o,c]of s)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[t]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Qo(this.inner,((t,s)=>{for(const[o,c]of s)e(o,c)}))}isEmpty(){return Pk(this.inner)}size(){return this.innerSize}}const PM=new us(Je.comparator);function zr(){return PM}const sS=new us(Je.comparator);function Ch(...n){let e=sS;for(const t of n)e=e.insert(t.key,t);return e}function rS(n){let e=sS;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Ki(){return Fh()}function iS(){return Fh()}function Fh(){return new Fa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const MM=new us(Je.comparator),LM=new Yn(Je.comparator);function Zt(...n){let e=LM;for(const t of n)e=e.add(t);return e}const VM=new Yn(Bt);function Ov(){return VM}function Bv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yh(e)?"-0":e}}function aS(n){return{integerValue:""+n}}function oS(n,e){return wk(e)?aS(e):Bv(n,e)}class mp{constructor(){this._=void 0}}function OM(n,e,t){return n instanceof cu?(function(o,c){const u={fields:{[Vk]:{stringValue:Lk},[Bk]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&hp(c)&&(c=dp(c)),c&&(u.fields[Ok]=c),{mapValue:u}})(t,e):n instanceof Ul?cS(n,e):n instanceof Fl?uS(n,e):(function(o,c){const u=lS(o,c),d=S2(u)+S2(o.Ae);return Vb(u)&&Vb(o.Ae)?aS(d):Bv(o.serializer,d)})(n,e)}function BM(n,e,t){return n instanceof Ul?cS(n,e):n instanceof Fl?uS(n,e):t}function lS(n,e){return n instanceof uu?(function(s){return Vb(s)||(function(c){return!!c&&"doubleValue"in c})(s)})(e)?e:{integerValue:0}:null}class cu extends mp{}class Ul extends mp{constructor(e){super(),this.elements=e}}function cS(n,e){const t=hS(e);for(const s of n.elements)t.some((o=>sa(o,s)))||t.push(s);return{arrayValue:{values:t}}}class Fl extends mp{constructor(e){super(),this.elements=e}}function uS(n,e){let t=hS(e);for(const s of n.elements)t=t.filter((o=>!sa(o,s)));return{arrayValue:{values:t}}}class uu extends mp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function S2(n){return ys(n.integerValue||n.doubleValue)}function hS(n){return sd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class wd{constructor(e,t){this.field=e,this.transform=t}}function UM(n,e){return n.field.isEqual(e.field)&&(function(s,o){return s instanceof Ul&&o instanceof Ul||s instanceof Fl&&o instanceof Fl?Jc(s.elements,o.elements,sa):s instanceof uu&&o instanceof uu?sa(s.Ae,o.Ae):s instanceof cu&&o instanceof cu})(n.transform,e.transform)}class FM{constructor(e,t){this.version=e,this.transformResults=t}}class vs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vs}static exists(e){return new vs(void 0,e)}static updateTime(e){return new vs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pp{}function dS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Su(n.key,vs.none()):new ku(n.key,n.data,vs.none());{const t=n.data,s=ir.empty();let o=new Yn(bs.comparator);for(let c of e.fields)if(!o.has(c)){let u=t.field(c);u===null&&c.length>1&&(c=c.popLast(),u=t.field(c)),u===null?s.delete(c):s.set(c,u),o=o.add(c)}return new za(n.key,s,new Fr(o.toArray()),vs.none())}}function zM(n,e,t){n instanceof ku?(function(o,c,u){const d=o.value.clone(),p=N2(o.fieldTransforms,c,u.transformResults);d.setAll(p),c.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof za?(function(o,c,u){if(!bm(o.precondition,c))return void c.convertToUnknownDocument(u.version);const d=N2(o.fieldTransforms,c,u.transformResults),p=c.data;p.setAll(fS(o)),p.setAll(d),c.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(n,e,t):(function(o,c,u){c.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function zh(n,e,t,s){return n instanceof ku?(function(c,u,d,p){if(!bm(c.precondition,u))return d;const g=c.value.clone(),b=A2(c.fieldTransforms,p,u);return g.setAll(b),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(n,e,t,s):n instanceof za?(function(c,u,d,p){if(!bm(c.precondition,u))return d;const g=A2(c.fieldTransforms,p,u),b=u.data;return b.setAll(fS(c)),b.setAll(g),u.convertToFoundDocument(u.version,b).setHasLocalMutations(),d===null?null:d.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((x=>x.field)))})(n,e,t,s):(function(c,u,d){return bm(c.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function qM(n,e){let t=null;for(const s of n.fieldTransforms){const o=e.data.field(s.field),c=lS(s.transform,o||null);c!=null&&(t===null&&(t=ir.empty()),t.set(s.field,c))}return t||null}function j2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&Jc(s,o,((c,u)=>UM(c,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ku extends pp{constructor(e,t,s,o=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class za extends pp{constructor(e,t,s,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function fS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function N2(n,e,t){const s=new Map;pt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],u=c.transform,d=e.data.field(c.field);s.set(c.field,BM(u,d,t[o]))}return s}function A2(n,e,t){const s=new Map;for(const o of n){const c=o.transform,u=t.data.field(o.field);s.set(o.field,OM(c,u,e))}return s}class Su extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Uv extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fv{constructor(e,t,s,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&zM(c,e,s[o])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=zh(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=zh(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=iS();return this.mutations.forEach((o=>{const c=e.get(o.key),u=c.overlayedDocument;let d=this.applyToLocalView(u,c.mutatedFields);d=t.has(o.key)?null:d;const p=dS(u,d);p!==null&&s.set(o.key,p),u.isValidDocument()||u.convertToNoDocument(Tt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Zt())}isEqual(e){return this.batchId===e.batchId&&Jc(this.mutations,e.mutations,((t,s)=>j2(t,s)))&&Jc(this.baseMutations,e.baseMutations,((t,s)=>j2(t,s)))}}class zv{constructor(e,t,s,o){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=o}static from(e,t,s){pt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return MM})();const c=e.mutations;for(let u=0;u<c.length;u++)o=o.insert(c[u].key,s[u].version);return new zv(e,t,s,o)}}class qv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class mS{constructor(e,t,s){this.alias=e,this.aggregateType=t,this.fieldPath=s}}class HM{constructor(e,t){this.count=e,this.unchangedNames=t}}var $s,Rn;function pS(n){switch(n){case ce.OK:return ot(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return ot(15467,{code:n})}}function gS(n){if(n===void 0)return Ms("GRPC error has no .code"),ce.UNKNOWN;switch(n){case $s.OK:return ce.OK;case $s.CANCELLED:return ce.CANCELLED;case $s.UNKNOWN:return ce.UNKNOWN;case $s.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case $s.INTERNAL:return ce.INTERNAL;case $s.UNAVAILABLE:return ce.UNAVAILABLE;case $s.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case $s.NOT_FOUND:return ce.NOT_FOUND;case $s.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case $s.ABORTED:return ce.ABORTED;case $s.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case $s.DATA_LOSS:return ce.DATA_LOSS;default:return ot(39323,{code:n})}}(Rn=$s||($s={}))[Rn.OK=0]="OK",Rn[Rn.CANCELLED=1]="CANCELLED",Rn[Rn.UNKNOWN=2]="UNKNOWN",Rn[Rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rn[Rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rn[Rn.NOT_FOUND=5]="NOT_FOUND",Rn[Rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rn[Rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rn[Rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rn[Rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rn[Rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rn[Rn.ABORTED=10]="ABORTED",Rn[Rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rn[Rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rn[Rn.INTERNAL=13]="INTERNAL",Rn[Rn.UNAVAILABLE=14]="UNAVAILABLE",Rn[Rn.DATA_LOSS=15]="DATA_LOSS";let zb=null;function $M(n){if(zb)throw new Error("a TestingHooksSpi instance is already set");zb=n}function yS(){return new TextEncoder}const WM=new Lo([4294967295,4294967295],0);function R2(n){const e=yS().encode(n),t=new ak;return t.update(e),new Uint8Array(t.digest())}function C2(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Lo([t,s],0),new Lo([o,c],0)]}class Hv{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Ih(`Invalid padding: ${t}`);if(s<0)throw new Ih(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Ih(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Ih(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Lo.fromNumber(this.ge)}ye(e,t,s){let o=e.add(t.multiply(Lo.fromNumber(s)));return o.compare(WM)===1&&(o=new Lo([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=R2(e),[s,o]=C2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);if(!this.we(u))return!1}return!0}static create(e,t,s){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),u=new Hv(c,o,t);return s.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=R2(e),[s,o]=C2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);this.be(u)}}be(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Ih extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Td{constructor(e,t,s,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const o=new Map;return o.set(e,Ed.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Td(Tt.min(),o,new us(Bt),zr(),Zt())}}class Ed{constructor(e,t,s,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Ed(s,t,Zt(),Zt(),Zt())}}class vm{constructor(e,t,s,o){this.Se=e,this.removedTargetIds=t,this.key=s,this.De=o}}class bS{constructor(e,t){this.targetId=e,this.Ce=t}}class vS{constructor(e,t,s=Ns.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=o}}class I2{constructor(){this.ve=0,this.Fe=D2(),this.Me=Ns.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Zt(),t=Zt(),s=Zt();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:s=s.add(o);break;default:ot(38017,{changeType:c})}})),new Ed(this.Me,this.xe,e,t,s)}Ke(){this.Oe=!1,this.Fe=D2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,pt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class GM{constructor(e){this.Ge=e,this.ze=new Map,this.je=zr(),this.He=Wf(),this.Je=Wf(),this.Ze=new us(Bt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.We(),s.Ne||s.Ke(),s.Le(e.resumeToken);break;case 2:s.We(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.Qe(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:ot(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,s=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(Vm(c))if(s===0){const u=new Je(c.path);this.et(t,u,fs.newNoDocument(u,Tt.min()))}else pt(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const d=this.ut(e),p=d?this.ct(d,e,u):1;if(p!==0){this.it(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}zb?.lt((function(b,x,T,N,B){const M={localCacheCount:b,existenceFilterCount:x.count,databaseId:T.database,projectId:T.projectId},D=x.unchangedNames;return D&&(M.bloomFilter={applied:B===0,hashCount:D?.hashCount??0,bitmapLength:D?.bits?.bitmap?.length??0,padding:D?.bits?.padding??0,mightContain:X=>N?.mightContain(X)??!1}),M})(u,e.Ce,this.Ge.ht(),d,p))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=t;let u,d;try{u=Ma(s).toUint8Array()}catch(p){if(p instanceof Mk)return xi("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new Hv(u,o,c)}catch(p){return xi(p instanceof Ih?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let o=0;return s.forEach((c=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${c.path.canonicalString()}`;e.mightContain(d)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,u)=>{const d=this.ot(u);if(d){if(c.current&&Vm(d.target)){const p=new Je(d.target.path);this.It(p).has(u)||this.Et(u,p)||this.et(u,p,fs.newNoDocument(p,e))}c.Be&&(t.set(u,c.ke()),c.Ke())}}));let s=Zt();this.Je.forEach(((c,u)=>{let d=!0;u.forEachWhile((p=>{const g=this.ot(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(s=s.add(c))})),this.je.forEach(((c,u)=>u.setReadTime(e)));const o=new Td(e,t,this.Ze,this.je,s);return this.je=zr(),this.He=Wf(),this.Je=Wf(),this.Ze=new us(Bt),o}Ye(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,s),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new I2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Yn(Bt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Yn(Bt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new I2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Wf(){return new us(Je.comparator)}function D2(){return new us(Je.comparator)}const KM={asc:"ASCENDING",desc:"DESCENDING"},QM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YM={and:"AND",or:"OR"};class XM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qb(n,e){return n.useProto3Json||yd(e)?e:{value:e}}function hu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function JM(n,e){return hu(n,e.toTimestamp())}function Ls(n){return pt(!!n,49232),Tt.fromTimestamp((function(t){const s=Pa(t);return new mt(s.seconds,s.nanos)})(n))}function $v(n,e){return Hb(n,e).canonicalString()}function Hb(n,e){const t=(function(o){return new mn(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function _S(n){const e=mn.fromString(n);return pt(RS(e),10190,{key:e.toString()}),e}function id(n,e){return $v(n.databaseId,e.path)}function ea(n,e){const t=_S(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Je(ES(t))}function wS(n,e){return $v(n.databaseId,e)}function TS(n){const e=_S(n);return e.length===4?mn.emptyPath():ES(e)}function $b(n){return new mn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ES(n){return pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function P2(n,e,t){return{name:id(n,e),fields:t.value.mapValue.fields}}function gp(n,e,t){const s=ea(n,e.name),o=Ls(e.updateTime),c=e.createTime?Ls(e.createTime):Tt.min(),u=new ir({mapValue:{fields:e.fields}}),d=fs.newFoundDocument(s,o,c,u);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function ZM(n,e){return"found"in e?(function(s,o){pt(!!o.found,43571),o.found.name,o.found.updateTime;const c=ea(s,o.found.name),u=Ls(o.found.updateTime),d=o.found.createTime?Ls(o.found.createTime):Tt.min(),p=new ir({mapValue:{fields:o.found.fields}});return fs.newFoundDocument(c,u,d,p)})(n,e):"missing"in e?(function(s,o){pt(!!o.missing,3894),pt(!!o.readTime,22933);const c=ea(s,o.missing),u=Ls(o.readTime);return fs.newNoDocument(c,u)})(n,e):ot(7234,{result:e})}function e3(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:ot(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?(pt(b===void 0||typeof b=="string",58123),Ns.fromBase64String(b||"")):(pt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Ns.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(g){const b=g.code===void 0?ce.UNKNOWN:gS(g.code);return new Ce(b,g.message||"")})(u);t=new vS(s,o,c,d||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=ea(n,s.document.name),c=Ls(s.document.updateTime),u=s.document.createTime?Ls(s.document.createTime):Tt.min(),d=new ir({mapValue:{fields:s.document.fields}}),p=fs.newFoundDocument(o,c,u,d),g=s.targetIds||[],b=s.removedTargetIds||[];t=new vm(g,b,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=ea(n,s.document),c=s.readTime?Ls(s.readTime):Tt.min(),u=fs.newNoDocument(o,c),d=s.removedTargetIds||[];t=new vm([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=ea(n,s.document),c=s.removedTargetIds||[];t=new vm([],c,o,null)}else{if(!("filter"in e))return ot(11601,{Vt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:c}=s,u=new HM(o,c),d=s.targetId;t=new bS(d,u)}}return t}function ad(n,e){let t;if(e instanceof ku)t={update:P2(n,e.key,e.value)};else if(e instanceof Su)t={delete:id(n,e.key)};else if(e instanceof za)t={update:P2(n,e.key,e.data),updateMask:a3(e.fieldMask)};else{if(!(e instanceof Uv))return ot(16599,{dt:e.type});t={verify:id(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(c,u){const d=u.transform;if(d instanceof cu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ul)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Fl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof uu)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw ot(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:JM(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:ot(27497)})(n,e.precondition)),t}function Wb(n,e){const t=e.currentDocument?(function(c){return c.updateTime!==void 0?vs.updateTime(Ls(c.updateTime)):c.exists!==void 0?vs.exists(c.exists):vs.none()})(e.currentDocument):vs.none(),s=e.updateTransforms?e.updateTransforms.map((o=>(function(u,d){let p=null;if("setToServerValue"in d)pt(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),p=new cu;else if("appendMissingElements"in d){const b=d.appendMissingElements.values||[];p=new Ul(b)}else if("removeAllFromArray"in d){const b=d.removeAllFromArray.values||[];p=new Fl(b)}else"increment"in d?p=new uu(u,d.increment):ot(16584,{proto:d});const g=bs.fromServerFormat(d.fieldPath);return new wd(g,p)})(n,o))):[];if(e.update){e.update.name;const o=ea(n,e.update.name),c=new ir({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(p){const g=p.fieldPaths||[];return new Fr(g.map((b=>bs.fromServerFormat(b))))})(e.updateMask);return new za(o,c,u,t,s)}return new ku(o,c,t,s)}if(e.delete){const o=ea(n,e.delete);return new Su(o,t)}if(e.verify){const o=ea(n,e.verify);return new Uv(o,t)}return ot(1463,{proto:e})}function t3(n,e){return n&&n.length>0?(pt(e!==void 0,14353),n.map((t=>(function(o,c){let u=o.updateTime?Ls(o.updateTime):Ls(c);return u.isEqual(Tt.min())&&(u=Ls(c)),new FM(u,o.transformResults||[])})(t,e)))):[]}function kS(n,e){return{documents:[wS(n,e.path)]}}function yp(n,e){const t={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=wS(n,o);const c=(function(g){if(g.length!==0)return AS(Qn.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const u=(function(g){if(g.length!==0)return g.map((b=>(function(T){return{field:So(T.field),direction:s3(T.dir)}})(b)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=qb(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function SS(n,e,t,s){const{ft:o,parent:c}=yp(n,e),u={},d=[];let p=0;return t.forEach((g=>{const b=s?g.alias:"aggregate_"+p++;u[b]=g.alias,g.aggregateType==="count"?d.push({alias:b,count:{}}):g.aggregateType==="avg"?d.push({alias:b,avg:{field:So(g.fieldPath)}}):g.aggregateType==="sum"&&d.push({alias:b,sum:{field:So(g.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:o.structuredQuery},parent:o.parent},gt:u,parent:c}}function jS(n){let e=TS(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let o=null;if(s>0){pt(s===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(x){const T=NS(x);return T instanceof Qn&&Lv(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((T=>(function(B){return new rd(qc(B.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(x){let T;return T=typeof x=="object"?x.value:x,yd(T)?null:T})(t.limit));let p=null;t.startAt&&(p=(function(x){const T=!!x.before,N=x.values||[];return new zo(N,T)})(t.startAt));let g=null;return t.endAt&&(g=(function(x){const T=!x.before,N=x.values||[];return new zo(N,T)})(t.endAt)),Xk(e,o,u,c,d,"F",p,g)}function n3(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function NS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=qc(t.unaryFilter.field);return kn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=qc(t.unaryFilter.field);return kn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=qc(t.unaryFilter.field);return kn.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=qc(t.unaryFilter.field);return kn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ot(61313);default:return ot(60726)}})(n):n.fieldFilter!==void 0?(function(t){return kn.create(qc(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ot(58110);default:return ot(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qn.create(t.compositeFilter.filters.map((s=>NS(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return ot(1026)}})(t.compositeFilter.op))})(n):ot(30097,{filter:n})}function s3(n){return KM[n]}function r3(n){return QM[n]}function i3(n){return YM[n]}function So(n){return{fieldPath:n.canonicalString()}}function qc(n){return bs.fromServerFormat(n.fieldPath)}function AS(n){return n instanceof kn?(function(t){if(t.op==="=="){if(b2(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NAN"}};if(y2(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(b2(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NAN"}};if(y2(t.value))return{unaryFilter:{field:So(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:So(t.field),op:r3(t.op),value:t.value}}})(n):n instanceof Qn?(function(t){const s=t.getFilters().map((o=>AS(o)));return s.length===1?s[0]:{compositeFilter:{op:i3(t.op),filters:s}}})(n):ot(54877,{filter:n})}function a3(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function RS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function CS(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class ja{constructor(e,t,s,o,c=Tt.min(),u=Tt.min(),d=Ns.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new ja(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class IS{constructor(e){this.yt=e}}function o3(n,e){let t;if(e.document)t=gp(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Je.fromSegments(e.noDocument.path),o=ql(e.noDocument.readTime);t=fs.newNoDocument(s,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ot(56709);{const s=Je.fromSegments(e.unknownDocument.path),o=ql(e.unknownDocument.version);t=fs.newUnknownDocument(s,o)}}return e.readTime&&t.setReadTime((function(o){const c=new mt(o[0],o[1]);return Tt.fromTimestamp(c)})(e.readTime)),t}function M2(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Um(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(c,u){return{name:id(c,u.key),fields:u.data.value.mapValue.fields,updateTime:hu(c,u.version.toTimestamp()),createTime:hu(c,u.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:zl(e.version)};else{if(!e.isUnknownDocument())return ot(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:zl(e.version)}}return s}function Um(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function zl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ql(n){const e=new mt(n.seconds,n.nanoseconds);return Tt.fromTimestamp(e)}function El(n,e){const t=(e.baseMutations||[]).map((c=>Wb(n.yt,c)));for(let c=0;c<e.mutations.length-1;++c){const u=e.mutations[c];if(c+1<e.mutations.length&&e.mutations[c+1].transform!==void 0){const d=e.mutations[c+1];u.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(c+1,1),++c}}const s=e.mutations.map((c=>Wb(n.yt,c))),o=mt.fromMillis(e.localWriteTimeMs);return new Fv(e.batchId,o,t,s)}function Dh(n){const e=ql(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ql(n.lastLimboFreeSnapshotVersion):Tt.min();let s;return s=(function(c){return c.documents!==void 0})(n.query)?(function(c){const u=c.documents.length;return pt(u===1,1966,{count:u}),wr(Eu(TS(c.documents[0])))})(n.query):(function(c){return wr(jS(c))})(n.query),new ja(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ns.fromBase64String(n.resumeToken))}function DS(n,e){const t=zl(e.snapshotVersion),s=zl(e.lastLimboFreeSnapshotVersion);let o;o=Vm(e.target)?kS(n.yt,e.target):yp(n.yt,e.target).ft;const c=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bl(e.target),readTime:t,resumeToken:c,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:o}}function bp(n){const e=jS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bm(e,e.limit,"L"):e}function Hy(n,e){return new qv(e.largestBatchId,Wb(n.yt,e.overlayMutation))}function L2(n,e){const t=e.path.lastSegment();return[n,_r(e.path.popLast()),t]}function V2(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:zl(s.readTime),documentKey:_r(s.documentKey.path),largestBatchId:s.largestBatchId}}class l3{getBundleMetadata(e,t){return O2(e).get(t).next((s=>{if(s)return(function(c){return{id:c.bundleId,createTime:ql(c.createTime),version:c.version}})(s)}))}saveBundleMetadata(e,t){return O2(e).put((function(o){return{bundleId:o.id,createTime:zl(Ls(o.createTime)),version:o.version}})(t))}getNamedQuery(e,t){return B2(e).get(t).next((s=>{if(s)return(function(c){return{name:c.name,query:bp(c.bundledQuery),readTime:ql(c.readTime)}})(s)}))}saveNamedQuery(e,t){return B2(e).put((function(o){return{name:o.name,readTime:zl(Ls(o.readTime)),bundledQuery:o.bundledQuery}})(t))}}function O2(n){return Js(n,lp)}function B2(n){return Js(n,cp)}class vp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new vp(e,s)}getOverlay(e,t){return vh(e).get(L2(this.userId,t)).next((s=>s?Hy(this.serializer,s):null))}getOverlays(e,t){const s=Ki();return se.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){const o=[];return s.forEach(((c,u)=>{const d=new qv(t,u);o.push(this.bt(e,d))})),se.waitFor(o)}removeOverlaysForBatchId(e,t,s){const o=new Set;t.forEach((u=>o.add(_r(u.getCollectionPath()))));const c=[];return o.forEach((u=>{const d=IDBKeyRange.bound([this.userId,u,s],[this.userId,u,s+1],!1,!0);c.push(vh(e).X(Pb,d))})),se.waitFor(c)}getOverlaysForCollection(e,t,s){const o=Ki(),c=_r(t),u=IDBKeyRange.bound([this.userId,c,s],[this.userId,c,Number.POSITIVE_INFINITY],!0);return vh(e).H(Pb,u).next((d=>{for(const p of d){const g=Hy(this.serializer,p);o.set(g.getKey(),g)}return o}))}getOverlaysForCollectionGroup(e,t,s,o){const c=Ki();let u;const d=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return vh(e).ee({index:Nk,range:d},((p,g,b)=>{const x=Hy(this.serializer,g);c.size()<o||x.largestBatchId===u?(c.set(x.getKey(),x),u=x.largestBatchId):b.done()})).next((()=>c))}bt(e,t){return vh(e).put((function(o,c,u){const[d,p,g]=L2(c,u.mutation.key);return{userId:c,collectionPath:p,documentId:g,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:ad(o.yt,u.mutation)}})(this.serializer,this.userId,t))}}function vh(n){return Js(n,up)}class c3{St(e){return Js(e,Iv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const s=t?.value;return s?Ns.fromUint8Array(s):Ns.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class kl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ys(e.integerValue));else if("doubleValue"in e){const s=ys(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),Yh(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=Pa(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ma(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?Fk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ot(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const s=e.fields||{};this.Ft(t,55);for(const o of Object.keys(s))this.Ot(o,t),this.Ct(s[o],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const o=au,c=s[o].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ys(c)),this.Ot(o,t),this.Ct(s[o],t)}qt(e,t){const s=e.values||[];this.Ft(t,50);for(const o of s)this.Ct(o,t)}Lt(e,t){this.Ft(t,37),Je.fromName(e).path.forEach((s=>{this.Ft(t,60),this.$t(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}kl.Wt=new kl;const Dc=255;function u3(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function U2(n){const e=64-(function(s){let o=0;for(let c=0;c<8;++c){const u=u3(255&s[c]);if(o+=u,u!==8)break}return o})(n);return Math.ceil(e/8)}class h3{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Ht(s.value),s=t.next();this.Jt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const o=t.codePointAt(0);this.Gt(240|o>>>18),this.Gt(128|63&o>>>12),this.Gt(128|63&o>>>6),this.Gt(128|63&o)}}this.zt()}Xt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Ht(s);else if(s<2048)this.Ht(960|s>>>6),this.Ht(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s);else{const o=t.codePointAt(0);this.Ht(240|o>>>18),this.Ht(128|63&o>>>12),this.Ht(128|63&o>>>6),this.Ht(128|63&o)}}this.Jt()}Yt(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=255&t[o]}nn(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}rn(){this.sn(Dc),this.sn(255)}_n(){this.an(Dc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(c){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,c,!1),new Uint8Array(u.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let o=1;o<t.length;++o)t[o]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Dc?(this.sn(Dc),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Dc?(this.an(Dc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const o=new Uint8Array(s);o.set(this.buffer),this.buffer=o}}class d3{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class f3{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xh{constructor(){this.cn=new h3,this.ascending=new d3(this.cn),this.descending=new f3(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class Sl{constructor(e,t,s,o){this.hn=e,this.Pn=t,this.Tn=s,this.In=o}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.In,0),t!==e?s.set([0],this.In.length):++s[s.length-1],new Sl(this.hn,this.Pn,this.Tn,s)}Rn(e,t,s){return{indexId:this.hn,uid:e,arrayValue:xm(this.Tn),directionalValue:xm(this.In),orderedDocumentKey:xm(t),documentKey:s.path.toArray()}}An(e,t,s){const o=this.Rn(e,t,s);return[o.indexId,o.uid,o.arrayValue,o.directionalValue,o.orderedDocumentKey,o.documentKey]}}function yo(n,e){let t=n.hn-e.hn;return t!==0?t:(t=F2(n.Tn,e.Tn),t!==0?t:(t=F2(n.In,e.In),t!==0?t:Je.comparator(n.Pn,e.Pn)))}function F2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function xm(n){return xE()?(function(t){let s="";for(let o=0;o<t.length;o++)s+=String.fromCharCode(t[o]);return s})(n):n}function z2(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(n)}class q2{constructor(e){this.Vn=new Yn(((t,s)=>bs.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const s=t;s.isInequality()?this.Vn=this.Vn.add(s):this.mn.push(s)}}get fn(){return this.Vn.size>1}gn(e){if(pt(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Cb(e);if(t!==void 0&&!this.pn(t))return!1;const s=_l(e);let o=new Set,c=0,u=0;for(;c<s.length&&this.pn(s[c]);++c)o=o.add(s[c].fieldPath.canonicalString());if(c===s.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!o.has(d.field.canonicalString())){const p=s[c];if(!this.yn(d,p)||!this.wn(this.dn[u++],p))return!1}++c}for(;c<s.length;++c){const d=s[c];if(u>=this.dn.length||!this.wn(this.dn[u++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new Yn(bs.comparator);const t=[];for(const s of this.mn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Al(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Al(s.field,0))}for(const s of this.dn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Al(s.field,s.dir==="asc"?0:1)));return new eu(eu.UNKNOWN_ID,this.collectionId,t,tu.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function PS(n){if(pt(n instanceof kn||n instanceof Qn,20012),n instanceof kn){if(n instanceof Yk){const t=n.value.arrayValue?.values?.map((s=>kn.create(n.field,"==",s)))||[];return Qn.create(t,"or")}return n}const e=n.filters.map((t=>PS(t)));return Qn.create(e,n.op)}function m3(n){if(n.getFilters().length===0)return[];const e=Qb(PS(n));return pt(MS(e),7391),Gb(e)||Kb(e)?[e]:e.getFilters()}function Gb(n){return n instanceof kn}function Kb(n){return n instanceof Qn&&Lv(n)}function MS(n){return Gb(n)||Kb(n)||(function(t){if(t instanceof Qn&&Ob(t)){for(const s of t.getFilters())if(!Gb(s)&&!Kb(s))return!1;return!0}return!1})(n)}function Qb(n){if(pt(n instanceof kn||n instanceof Qn,34018),n instanceof kn)return n;if(n.filters.length===1)return Qb(n.filters[0]);const e=n.filters.map((s=>Qb(s)));let t=Qn.create(e,n.op);return t=Fm(t),MS(t)?t:(pt(t instanceof Qn,64498),pt(lu(t),40251),pt(t.filters.length>1,57927),t.filters.reduce(((s,o)=>Wv(s,o))))}function Wv(n,e){let t;return pt(n instanceof kn||n instanceof Qn,38388),pt(e instanceof kn||e instanceof Qn,25473),t=n instanceof kn?e instanceof kn?(function(o,c){return Qn.create([o,c],"and")})(n,e):H2(n,e):e instanceof kn?H2(e,n):(function(o,c){if(pt(o.filters.length>0&&c.filters.length>0,48005),lu(o)&&lu(c))return Gk(o,c.getFilters());const u=Ob(o)?o:c,d=Ob(o)?c:o,p=u.filters.map((g=>Wv(g,d)));return Qn.create(p,"or")})(n,e),Fm(t)}function H2(n,e){if(lu(e))return Gk(e,n.getFilters());{const t=e.filters.map((s=>Wv(n,s)));return Qn.create(t,"or")}}function Fm(n){if(pt(n instanceof kn||n instanceof Qn,11850),n instanceof kn)return n;const e=n.getFilters();if(e.length===1)return Fm(e[0]);if($k(n))return n;const t=e.map((o=>Fm(o))),s=[];return t.forEach((o=>{o instanceof kn?s.push(o):o instanceof Qn&&(o.op===n.op?s.push(...o.filters):s.push(o))})),s.length===1?s[0]:Qn.create(s,n.op)}class p3{constructor(){this.Sn=new Gv}addToCollectionParentIndex(e,t){return this.Sn.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(si.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(si.min())}updateCollectionGroup(e,t,s){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class Gv{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t]||new Yn(mn.comparator),c=!o.has(s);return this.index[t]=o.add(s),c}has(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t];return o&&o.has(s)}getEntries(e){return(this.index[e]||new Yn(mn.comparator)).toArray()}}const $2="IndexedDbIndexManager",Gf=new Uint8Array(0);class g3{constructor(e,t){this.databaseId=t,this.Dn=new Gv,this.Cn=new Fa((s=>Bl(s)),((s,o)=>vd(s,o))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const s=t.lastSegment(),o=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const c={collectionId:s,parent:_r(o)};return W2(e).put(c)}return se.resolve()}getCollectionParents(e,t){const s=[],o=IDBKeyRange.bound([t,""],[mk(t),""],!1,!0);return W2(e).H(o).next((c=>{for(const u of c){if(u.collectionId!==t)break;s.push(Gi(u.parent))}return s}))}addFieldIndex(e,t){const s=_h(e),o=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((p=>[p.fieldPath.canonicalString(),p.kind]))}})(t);delete o.indexId;const c=s.add(o);if(t.indexState){const u=Mc(e);return c.next((d=>{u.put(V2(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return c.next()}deleteFieldIndex(e,t){const s=_h(e),o=Mc(e),c=Pc(e);return s.delete(t.indexId).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>c.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=_h(e),s=Pc(e),o=Mc(e);return t.X().next((()=>s.X())).next((()=>o.X()))}createTargetIndexes(e,t){return se.forEach(this.vn(t),(s=>this.getIndexType(e,s).next((o=>{if(o===0||o===1){const c=new q2(s).bn();if(c!=null)return this.addFieldIndex(e,c)}}))))}getDocumentsMatchingTarget(e,t){const s=Pc(e);let o=!0;const c=new Map;return se.forEach(this.vn(t),(u=>this.Fn(e,u).next((d=>{o&&(o=!!d),c.set(u,d)})))).next((()=>{if(o){let u=Zt();const d=[];return se.forEach(c,((p,g)=>{Oe($2,`Using index ${(function(J){return`id=${J.indexId}|cg=${J.collectionGroup}|f=${J.fields.map((he=>`${he.fieldPath}:${he.kind}`)).join(",")}`})(p)} to execute ${Bl(t)}`);const b=(function(J,he){const Ne=Cb(he);if(Ne===void 0)return null;for(const Te of Om(J,Ne.fieldPath))switch(Te.op){case"array-contains-any":return Te.value.arrayValue.values||[];case"array-contains":return[Te.value]}return null})(g,p),x=(function(J,he){const Ne=new Map;for(const Te of _l(he))for(const C of Om(J,Te.fieldPath))switch(C.op){case"==":case"in":Ne.set(Te.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return Ne.set(Te.fieldPath.canonicalString(),C.value),Array.from(Ne.values())}return null})(g,p),T=(function(J,he){const Ne=[];let Te=!0;for(const C of _l(he)){const S=C.kind===0?T2(J,C.fieldPath,J.startAt):E2(J,C.fieldPath,J.startAt);Ne.push(S.value),Te&&(Te=S.inclusive)}return new zo(Ne,Te)})(g,p),N=(function(J,he){const Ne=[];let Te=!0;for(const C of _l(he)){const S=C.kind===0?E2(J,C.fieldPath,J.endAt):T2(J,C.fieldPath,J.endAt);Ne.push(S.value),Te&&(Te=S.inclusive)}return new zo(Ne,Te)})(g,p),B=this.Mn(p,g,T),M=this.Mn(p,g,N),D=this.xn(p,g,x),X=this.On(p.indexId,b,B,T.inclusive,M,N.inclusive,D);return se.forEach(X,(H=>s.Z(H,t.limit).next((J=>{J.forEach((he=>{const Ne=Je.fromSegments(he.documentKey);u.has(Ne)||(u=u.add(Ne),d.push(Ne))}))}))))})).next((()=>d))}return se.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=m3(Qn.create(e.filters,"and")).map((s=>Ub(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,s,o,c,u,d){const p=(t!=null?t.length:1)*Math.max(s.length,c.length),g=p/(t!=null?t.length:1),b=[];for(let x=0;x<p;++x){const T=t?this.Nn(t[x/g]):Gf,N=this.Bn(e,T,s[x%g],o),B=this.Ln(e,T,c[x%g],u),M=d.map((D=>this.Bn(e,T,D,!0)));b.push(...this.createRange(N,B,M))}return b}Bn(e,t,s,o){const c=new Sl(e,Je.empty(),t,s);return o?c:c.En()}Ln(e,t,s,o){const c=new Sl(e,Je.empty(),t,s);return o?c.En():c}Fn(e,t){const s=new q2(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next((c=>{let u=null;for(const d of c)s.gn(d)&&(!u||d.fields.length>u.fields.length)&&(u=d);return u}))}getIndexType(e,t){let s=2;const o=this.vn(t);return se.forEach(o,(c=>this.Fn(e,c).next((u=>{u?s!==0&&u.fields.length<(function(p){let g=new Yn(bs.comparator),b=!1;for(const x of p.filters)for(const T of x.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?b=!0:g=g.add(T.field));for(const x of p.orderBy)x.field.isKeyField()||(g=g.add(x.field));return g.size+(b?1:0)})(c)&&(s=1):s=0})))).next((()=>(function(u){return u.limit!==null})(t)&&o.length>1&&s===2?1:s))}kn(e,t){const s=new xh;for(const o of _l(e)){const c=t.data.field(o.fieldPath);if(c==null)return null;const u=s.ln(o.kind);kl.Wt.Dt(c,u)}return s.un()}Nn(e){const t=new xh;return kl.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const s=new xh;return kl.Wt.Dt(Ol(this.databaseId,t),s.ln((function(c){const u=_l(c);return u.length===0?0:u[u.length-1].kind})(e))),s.un()}xn(e,t,s){if(s===null)return[];let o=[];o.push(new xh);let c=0;for(const u of _l(e)){const d=s[c++];for(const p of o)if(this.qn(t,u.fieldPath)&&sd(d))o=this.Un(o,u,d);else{const g=p.ln(u.kind);kl.Wt.Dt(d,g)}}return this.$n(o)}Mn(e,t,s){return this.xn(e,t,s.position)}$n(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Un(e,t,s){const o=[...e],c=[];for(const u of s.arrayValue.values||[])for(const d of o){const p=new xh;p.seed(d.un()),kl.Wt.Dt(u,p.ln(t.kind)),c.push(p)}return c}qn(e,t){return!!e.filters.find((s=>s instanceof kn&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=_h(e),o=Mc(e);return(t?s.H(Db,IDBKeyRange.bound(t,t)):s.H()).next((c=>{const u=[];return se.forEach(c,(d=>o.get([d.indexId,this.uid]).next((p=>{u.push((function(b,x){const T=x?new tu(x.sequenceNumber,new si(ql(x.readTime),new Je(Gi(x.documentKey)),x.largestBatchId)):tu.empty(),N=b.fields.map((([B,M])=>new Al(bs.fromServerFormat(B),M)));return new eu(b.indexId,b.collectionGroup,N,T)})(d,p))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,o)=>{const c=s.indexState.sequenceNumber-o.indexState.sequenceNumber;return c!==0?c:Bt(s.collectionGroup,o.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const o=_h(e),c=Mc(e);return this.Wn(e).next((u=>o.H(Db,IDBKeyRange.bound(t,t)).next((d=>se.forEach(d,(p=>c.put(V2(p.indexId,this.uid,u,s))))))))}updateIndexEntries(e,t){const s=new Map;return se.forEach(t,((o,c)=>{const u=s.get(o.collectionGroup);return(u?se.resolve(u):this.getFieldIndexes(e,o.collectionGroup)).next((d=>(s.set(o.collectionGroup,d),se.forEach(d,(p=>this.Qn(e,o,p).next((g=>{const b=this.Gn(c,p);return g.isEqual(b)?se.resolve():this.zn(e,c,p,g,b)})))))))}))}jn(e,t,s,o){return Pc(e).put(o.Rn(this.uid,this.Kn(s,t.key),t.key))}Hn(e,t,s,o){return Pc(e).delete(o.An(this.uid,this.Kn(s,t.key),t.key))}Qn(e,t,s){const o=Pc(e);let c=new Yn(yo);return o.ee({index:jk,range:IDBKeyRange.only([s.indexId,this.uid,xm(this.Kn(s,t))])},((u,d)=>{c=c.add(new Sl(s.indexId,t,z2(d.arrayValue),z2(d.directionalValue)))})).next((()=>c))}Gn(e,t){let s=new Yn(yo);const o=this.kn(t,e);if(o==null)return s;const c=Cb(t);if(c!=null){const u=e.data.field(c.fieldPath);if(sd(u))for(const d of u.arrayValue.values||[])s=s.add(new Sl(t.indexId,e.key,this.Nn(d),o))}else s=s.add(new Sl(t.indexId,e.key,Gf,o));return s}zn(e,t,s,o,c){Oe($2,"Updating index entries for document '%s'",t.key);const u=[];return(function(p,g,b,x,T){const N=p.getIterator(),B=g.getIterator();let M=Ic(N),D=Ic(B);for(;M||D;){let X=!1,H=!1;if(M&&D){const J=b(M,D);J<0?H=!0:J>0&&(X=!0)}else M!=null?H=!0:X=!0;X?(x(D),D=Ic(B)):H?(T(M),M=Ic(N)):(M=Ic(N),D=Ic(B))}})(o,c,yo,(d=>{u.push(this.jn(e,t,s,d))}),(d=>{u.push(this.Hn(e,t,s,d))})),se.waitFor(u)}Wn(e){let t=1;return Mc(e).ee({index:Sk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,o,c)=>{c.done(),t=o.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((u,d)=>yo(u,d))).filter(((u,d,p)=>!d||yo(u,p[d-1])!==0));const o=[];o.push(e);for(const u of s){const d=yo(u,e),p=yo(u,t);if(d===0)o[0]=e.En();else if(d>0&&p<0)o.push(u),o.push(u.En());else if(p>0)break}o.push(t);const c=[];for(let u=0;u<o.length;u+=2){if(this.Jn(o[u],o[u+1]))return[];const d=o[u].An(this.uid,Gf,Je.empty()),p=o[u+1].An(this.uid,Gf,Je.empty());c.push(IDBKeyRange.bound(d,p))}return c}Jn(e,t){return yo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(G2)}getMinOffset(e,t){return se.mapArray(this.vn(t),(s=>this.Fn(e,s).next((o=>o||ot(44426))))).next(G2)}}function W2(n){return Js(n,Zh)}function Pc(n){return Js(n,Bh)}function _h(n){return Js(n,Cv)}function Mc(n){return Js(n,Oh)}function G2(n){pt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const o=n[s].indexState.offset;Nv(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new si(e.readTime,e.documentKey,t)}const K2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},LS=41943040;class xr{static withCacheSize(e){return new xr(e,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}function VS(n,e,t){const s=n.store(Ci),o=n.store(nu),c=[],u=IDBKeyRange.only(t.batchId);let d=0;const p=s.ee({range:u},((b,x,T)=>(d++,T.delete())));c.push(p.next((()=>{pt(d===1,47070,{batchId:t.batchId})})));const g=[];for(const b of t.mutations){const x=Tk(e,b.key.path,t.batchId);c.push(o.delete(x)),g.push(b.key)}return se.waitFor(c).next((()=>g))}function zm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ot(14731);e=n.noDocument}return JSON.stringify(e).length}xr.DEFAULT_COLLECTION_PERCENTILE=10,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xr.DEFAULT=new xr(LS,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xr.DISABLED=new xr(-1,0,0);class xp{constructor(e,t,s,o){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=o,this.Zn={}}static wt(e,t,s,o){pt(e.uid!=="",64387);const c=e.isAuthenticated()?e.uid:"";return new xp(c,t,s,o)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bo(e).ee({index:jl,range:s},((o,c,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,s,o){const c=Hc(e),u=bo(e);return u.add({}).next((d=>{pt(typeof d=="number",49019);const p=new Fv(d,t,s,o),g=(function(N,B,M){const D=M.baseMutations.map((H=>ad(N.yt,H))),X=M.mutations.map((H=>ad(N.yt,H)));return{userId:B,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:D,mutations:X}})(this.serializer,this.userId,p),b=[];let x=new Yn(((T,N)=>Bt(T.canonicalString(),N.canonicalString())));for(const T of o){const N=Tk(this.userId,T.key.path,d);x=x.add(T.key.path.popLast()),b.push(u.put(g)),b.push(c.put(N,WP))}return x.forEach((T=>{b.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Zn[d]=p.keys()})),se.waitFor(b).next((()=>p))}))}lookupMutationBatch(e,t){return bo(e).get(t).next((s=>s?(pt(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),El(this.serializer,s)):null))}Xn(e,t){return this.Zn[t]?se.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const o=s.keys();return this.Zn[t]=o,o}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=IDBKeyRange.lowerBound([this.userId,s]);let c=null;return bo(e).ee({index:jl,range:o},((u,d,p)=>{d.userId===this.userId&&(pt(d.batchId>=s,47524,{Yn:s}),c=El(this.serializer,d)),p.done()})).next((()=>c))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Vo;return bo(e).ee({index:jl,range:t,reverse:!0},((o,c,u)=>{s=c.batchId,u.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Vo],[this.userId,Number.POSITIVE_INFINITY]);return bo(e).H(jl,t).next((s=>s.map((o=>El(this.serializer,o)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=fm(this.userId,t.path),o=IDBKeyRange.lowerBound(s),c=[];return Hc(e).ee({range:o},((u,d,p)=>{const[g,b,x]=u,T=Gi(b);if(g===this.userId&&t.path.isEqual(T))return bo(e).get(x).next((N=>{if(!N)throw ot(61480,{er:u,batchId:x});pt(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:x}),c.push(El(this.serializer,N))}));p.done()})).next((()=>c))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Yn(Bt);const o=[];return t.forEach((c=>{const u=fm(this.userId,c.path),d=IDBKeyRange.lowerBound(u),p=Hc(e).ee({range:d},((g,b,x)=>{const[T,N,B]=g,M=Gi(N);T===this.userId&&c.path.isEqual(M)?s=s.add(B):x.done()}));o.push(p)})),se.waitFor(o).next((()=>this.tr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1,c=fm(this.userId,s),u=IDBKeyRange.lowerBound(c);let d=new Yn(Bt);return Hc(e).ee({range:u},((p,g,b)=>{const[x,T,N]=p,B=Gi(T);x===this.userId&&s.isPrefixOf(B)?B.length===o&&(d=d.add(N)):b.done()})).next((()=>this.tr(e,d)))}tr(e,t){const s=[],o=[];return t.forEach((c=>{o.push(bo(e).get(c).next((u=>{if(u===null)throw ot(35274,{batchId:c});pt(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:c}),s.push(El(this.serializer,u))})))})),se.waitFor(o).next((()=>s))}removeMutationBatch(e,t){return VS(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),se.forEach(s,(o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return se.resolve();const s=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),o=[];return Hc(e).ee({range:s},((c,u,d)=>{if(c[0]===this.userId){const p=Gi(c[1]);o.push(p)}else d.done()})).next((()=>{pt(o.length===0,56720,{rr:o.map((c=>c.canonicalString()))})}))}))}containsKey(e,t){return OS(e,this.userId,t)}ir(e){return BS(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Vo,lastStreamToken:""}))}}function OS(n,e,t){const s=fm(e,t.path),o=s[1],c=IDBKeyRange.lowerBound(s);let u=!1;return Hc(n).ee({range:c,Y:!0},((d,p,g)=>{const[b,x,T]=d;b===e&&x===o&&(u=!0),g.done()})).next((()=>u))}function bo(n){return Js(n,Ci)}function Hc(n){return Js(n,nu)}function BS(n){return Js(n,Xh)}class Hl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Hl(0)}static ar(){return new Hl(-1)}}class y3{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const s=new Hl(t.highestTargetId);return t.highestTargetId=s.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Tt.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.ur(e).next((o=>(o.highestListenSequenceNumber=t,s&&(o.lastRemoteSnapshotVersion=s.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.cr(e,o))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((s=>(s.targetCount+=1,this.hr(t,s),this.cr(e,s))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Lc(e).delete(t.targetId))).next((()=>this.ur(e))).next((s=>(pt(s.targetCount>0,8065),s.targetCount-=1,this.cr(e,s))))}removeTargets(e,t,s){let o=0;const c=[];return Lc(e).ee(((u,d)=>{const p=Dh(d);p.sequenceNumber<=t&&s.get(p.targetId)===null&&(o++,c.push(this.removeTargetData(e,p)))})).next((()=>se.waitFor(c))).next((()=>o))}forEachTarget(e,t){return Lc(e).ee(((s,o)=>{const c=Dh(o);t(c)}))}ur(e){return Q2(e).get(Lm).next((t=>(pt(t!==null,2888),t)))}cr(e,t){return Q2(e).put(Lm,t)}lr(e,t){return Lc(e).put(DS(this.serializer,t))}hr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const s=Bl(t),o=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let c=null;return Lc(e).ee({range:o,index:kk},((u,d,p)=>{const g=Dh(d);vd(t,g.target)&&(c=g,p.done())})).next((()=>c))}addMatchingKeys(e,t,s){const o=[],c=jo(e);return t.forEach((u=>{const d=_r(u.path);o.push(c.put({targetId:s,path:d})),o.push(this.referenceDelegate.addReference(e,s,u))})),se.waitFor(o)}removeMatchingKeys(e,t,s){const o=jo(e);return se.forEach(t,(c=>{const u=_r(c.path);return se.waitFor([o.delete([s,u]),this.referenceDelegate.removeReference(e,s,c)])}))}removeMatchingKeysForTargetId(e,t){const s=jo(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(o)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),o=jo(e);let c=Zt();return o.ee({range:s,Y:!0},((u,d,p)=>{const g=Gi(u[1]),b=new Je(g);c=c.add(b)})).next((()=>c))}containsKey(e,t){const s=_r(t.path),o=IDBKeyRange.bound([s],[mk(s)],!1,!0);let c=0;return jo(e).ee({index:Rv,Y:!0,range:o},(([u,d],p,g)=>{u!==0&&(c++,g.done())})).next((()=>c>0))}At(e,t){return Lc(e).get(t).next((s=>s?Dh(s):null))}}function Lc(n){return Js(n,su)}function Q2(n){return Js(n,Rl)}function jo(n){return Js(n,ru)}const Y2="LruGarbageCollector",US=1048576;function X2([n,e],[t,s]){const o=Bt(n,t);return o===0?Bt(e,s):o}class b3{constructor(e){this.Pr=e,this.buffer=new Yn(X2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();X2(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FS{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Oe(Y2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ko(t)?Oe(Y2,"Ignoring IndexedDB error during garbage collection: ",t):await Go(t)}await this.Ar(3e5)}))}}class v3{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return se.resolve(Ur.ce);const s=new b3(t);return this.Vr.forEachTarget(e,(o=>s.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>s.Er(o))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(K2)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let s,o,c,u,d,p,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,u=Date.now(),this.nthSequenceNumber(e,o)))).next((x=>(s=x,d=Date.now(),this.removeTargets(e,s,t)))).next((x=>(c=x,p=Date.now(),this.removeOrphanedDocuments(e,s)))).next((x=>(g=Date.now(),Fc()<=En.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-b}ms
	Determined least recently used ${o} in `+(d-u)+`ms
	Removed ${c} targets in `+(p-d)+`ms
	Removed ${x} documents in `+(g-p)+`ms
Total Duration: ${g-b}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:x}))))}}function zS(n,e){return new v3(n,e)}class x3{constructor(e,t){this.db=e,this.garbageCollector=zS(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((s,o)=>t(o)))}addReference(e,t,s){return Kf(e,s)}removeReference(e,t,s){return Kf(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Kf(e,t)}wr(e,t){return(function(o,c){let u=!1;return BS(o).te((d=>OS(o,d,c).next((p=>(p&&(u=!0),se.resolve(!p)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let c=0;return this.yr(e,((u,d)=>{if(d<=t){const p=this.wr(e,u).next((g=>{if(!g)return c++,s.getEntry(e,u).next((()=>(s.removeEntry(u,Tt.min()),jo(e).delete((function(x){return[0,_r(x.path)]})(u)))))}));o.push(p)}})).next((()=>se.waitFor(o))).next((()=>s.apply(e))).next((()=>c))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Kf(e,t)}yr(e,t){const s=jo(e);let o,c=Ur.ce;return s.ee({index:Rv},(([u,d],{path:p,sequenceNumber:g})=>{u===0?(c!==Ur.ce&&t(new Je(Gi(o)),c),c=g,o=p):c=Ur.ce})).next((()=>{c!==Ur.ce&&t(new Je(Gi(o)),c)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kf(n,e){return jo(n).put((function(s,o){return{targetId:0,path:_r(s.path),sequenceNumber:o}})(e,n.currentSequenceNumber))}class qS{constructor(){this.changes=new Fa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,fs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?se.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class _3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return pl(e).put(s)}removeEntry(e,t,s){return pl(e).delete((function(c,u){const d=c.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Um(u),d[d.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.br(e,s))))}getEntry(e,t){let s=fs.newInvalidDocument(t);return pl(e).ee({index:mm,range:IDBKeyRange.only(wh(t))},((o,c)=>{s=this.Sr(t,c)})).next((()=>s))}Dr(e,t){let s={size:0,document:fs.newInvalidDocument(t)};return pl(e).ee({index:mm,range:IDBKeyRange.only(wh(t))},((o,c)=>{s={document:this.Sr(t,c),size:zm(c)}})).next((()=>s))}getEntries(e,t){let s=zr();return this.Cr(e,t,((o,c)=>{const u=this.Sr(o,c);s=s.insert(o,u)})).next((()=>s))}vr(e,t){let s=zr(),o=new us(Je.comparator);return this.Cr(e,t,((c,u)=>{const d=this.Sr(c,u);s=s.insert(c,d),o=o.insert(c,zm(u))})).next((()=>({documents:s,Fr:o})))}Cr(e,t,s){if(t.isEmpty())return se.resolve();let o=new Yn(eT);t.forEach((p=>o=o.add(p)));const c=IDBKeyRange.bound(wh(o.first()),wh(o.last())),u=o.getIterator();let d=u.getNext();return pl(e).ee({index:mm,range:c},((p,g,b)=>{const x=Je.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;d&&eT(d,x)<0;)s(d,null),d=u.getNext();d&&d.isEqual(x)&&(s(d,g),d=u.hasNext()?u.getNext():null),d?b.j(wh(d)):b.done()})).next((()=>{for(;d;)s(d,null),d=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,s,o,c){const u=t.path,d=[u.popLast().toArray(),u.lastSegment(),Um(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],p=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pl(e).H(IDBKeyRange.bound(d,p,!0)).next((g=>{c?.incrementDocumentReadCount(g.length);let b=zr();for(const x of g){const T=this.Sr(Je.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);T.isFoundDocument()&&(_d(t,T)||o.has(T.key))&&(b=b.insert(T.key,T))}return b}))}getAllFromCollectionGroup(e,t,s,o){let c=zr();const u=Z2(t,s),d=Z2(t,si.max());return pl(e).ee({index:Ek,range:IDBKeyRange.bound(u,d,!0)},((p,g,b)=>{const x=this.Sr(Je.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);c=c.insert(x.key,x),c.size===o&&b.done()})).next((()=>c))}newChangeBuffer(e){return new w3(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return J2(e).get(Ib).next((t=>(pt(!!t,20021),t)))}br(e,t){return J2(e).put(Ib,t)}Sr(e,t){if(t){const s=o3(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Tt.min())))return s}return fs.newInvalidDocument(e)}}function HS(n){return new _3(n)}class w3 extends qS{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Fa((s=>s.toString()),((s,o)=>s.isEqual(o)))}applyChanges(e){const t=[];let s=0,o=new Yn(((c,u)=>Bt(c.canonicalString(),u.canonicalString())));return this.changes.forEach(((c,u)=>{const d=this.Or.get(c);if(t.push(this.Mr.removeEntry(e,c,d.readTime)),u.isValidDocument()){const p=M2(this.Mr.serializer,u);o=o.add(c.path.popLast());const g=zm(p);s+=g-d.size,t.push(this.Mr.addEntry(e,c,p))}else if(s-=d.size,this.trackRemovals){const p=M2(this.Mr.serializer,u.convertToNoDocument(Tt.min()));t.push(this.Mr.addEntry(e,c,p))}})),o.forEach((c=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,c))})),t.push(this.Mr.updateMetadata(e,s)),se.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((s=>(this.Or.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:s,Fr:o})=>(o.forEach(((c,u)=>{this.Or.set(c,{size:u,readTime:s.get(c).readTime})})),s)))}}function J2(n){return Js(n,Jh)}function pl(n){return Js(n,Mm)}function wh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Z2(n,e){const t=e.documentKey.path.toArray();return[n,Um(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function eT(n,e){const t=n.path.toArray(),s=e.path.toArray();let o=0;for(let c=0;c<t.length-2&&c<s.length-2;++c)if(o=Bt(t[c],s[c]),o)return o;return o=Bt(t.length,s.length),o||(o=Bt(t[t.length-2],s[s.length-2]),o||Bt(t[t.length-1],s[s.length-1]))}class T3{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class $S{constructor(e,t,s,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(s!==null&&zh(s.mutation,o,Fr.empty(),mt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Zt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Zt()){const o=Ki();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,s).next((c=>{let u=Ch();return c.forEach(((d,p)=>{u=u.insert(d,p.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=Ki();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Zt())))}populateOverlays(e,t,s){const o=[];return s.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,s,o){let c=zr();const u=Fh(),d=(function(){return Fh()})();return t.forEach(((p,g)=>{const b=s.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof za)?c=c.insert(g.key,g):b!==void 0?(u.set(g.key,b.mutation.getFieldMask()),zh(b.mutation,g,b.mutation.getFieldMask(),mt.now())):u.set(g.key,Fr.empty())})),this.recalculateAndSaveOverlays(e,c).next((p=>(p.forEach(((g,b)=>u.set(g,b))),t.forEach(((g,b)=>d.set(g,new T3(b,u.get(g)??null)))),d)))}recalculateAndSaveOverlays(e,t){const s=Fh();let o=new us(((u,d)=>u-d)),c=Zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((p=>{const g=t.get(p);if(g===null)return;let b=s.get(p)||Fr.empty();b=d.applyToLocalView(g,b),s.set(p,b);const x=(o.get(d.batchId)||Zt()).add(p);o=o.insert(d.batchId,x)}))})).next((()=>{const u=[],d=o.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),g=p.key,b=p.value,x=iS();b.forEach((T=>{if(!c.has(T)){const N=dS(t.get(T),s.get(T));N!==null&&x.set(T,N),c=c.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,x))}return se.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,o){return AM(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,o):this.getDocumentsMatchingCollectionQuery(e,t,s,o)}getNextDocuments(e,t,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,o).next((c=>{const u=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,o-c.size):se.resolve(Ki());let d=Zc,p=c;return u.next((g=>se.forEach(g,((b,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),c.get(b)?se.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{p=p.insert(b,T)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,p,g,Zt()))).next((b=>({batchId:d,changes:rS(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Je(t)).next((s=>{let o=Ch();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,o){const c=t.collectionGroup;let u=Ch();return this.indexManager.getCollectionParents(e,c).next((d=>se.forEach(d,(p=>{const g=(function(x,T){return new Ua(T,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,s,o).next((b=>{b.forEach(((x,T)=>{u=u.insert(x,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(c=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,c,o)))).next((u=>{c.forEach(((p,g)=>{const b=g.getKey();u.get(b)===null&&(u=u.insert(b,fs.newInvalidDocument(b)))}));let d=Ch();return u.forEach(((p,g)=>{const b=c.get(p);b!==void 0&&zh(b.mutation,g,Fr.empty(),mt.now()),_d(t,g)&&(d=d.insert(p,g))})),d}))}}class E3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return se.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Ls(o.createTime)}})(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:bp(o.bundledQuery),readTime:Ls(o.readTime)}})(t)),se.resolve()}}class k3{constructor(){this.overlays=new us(Je.comparator),this.Lr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ki();return se.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((o,c)=>{this.bt(e,t,c)})),se.resolve()}removeOverlaysForBatchId(e,t,s){const o=this.Lr.get(s);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(s)),se.resolve()}getOverlaysForCollection(e,t,s){const o=Ki(),c=t.length+1,u=new Je(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const p=d.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>s&&o.set(p.getKey(),p)}return se.resolve(o)}getOverlaysForCollectionGroup(e,t,s,o){let c=new us(((g,b)=>g-b));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>s){let b=c.get(g.largestBatchId);b===null&&(b=Ki(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const d=Ki(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((g,b)=>d.set(g,b))),!(d.size()>=o)););return se.resolve(d)}bt(e,t,s){const o=this.overlays.get(s.key);if(o!==null){const u=this.Lr.get(o.largestBatchId).delete(s.key);this.Lr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new qv(t,s));let c=this.Lr.get(t);c===void 0&&(c=Zt(),this.Lr.set(t,c)),this.Lr.set(t,c.add(s.key))}}class S3{constructor(){this.sessionToken=Ns.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,se.resolve()}}class Kv{constructor(){this.kr=new Yn(sr.Kr),this.qr=new Yn(sr.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const s=new sr(e,t);this.kr=this.kr.add(s),this.qr=this.qr.add(s)}$r(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new sr(e,t))}Qr(e,t){e.forEach((s=>this.removeReference(s,t)))}Gr(e){const t=new Je(new mn([])),s=new sr(t,e),o=new sr(t,e+1),c=[];return this.qr.forEachInRange([s,o],(u=>{this.Wr(u),c.push(u.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Je(new mn([])),s=new sr(t,e),o=new sr(t,e+1);let c=Zt();return this.qr.forEachInRange([s,o],(u=>{c=c.add(u.key)})),c}containsKey(e){const t=new sr(e,0),s=this.kr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class sr{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Je.comparator(e.key,t.key)||Bt(e.Hr,t.Hr)}static Ur(e,t){return Bt(e.Hr,t.Hr)||Je.comparator(e.key,t.key)}}class j3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Yn(sr.Kr)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Fv(c,t,s,o);this.mutationQueue.push(u);for(const d of o)this.Jr=this.Jr.add(new sr(d.key,c)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return se.resolve(u)}lookupMutationBatch(e,t){return se.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=this.Xr(s),c=o<0?0:o;return se.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?Vo:this.Yn-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new sr(t,0),o=new sr(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([s,o],(u=>{const d=this.Zr(u.Hr);c.push(d)})),se.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Yn(Bt);return t.forEach((o=>{const c=new sr(o,0),u=new sr(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,u],(d=>{s=s.add(d.Hr)}))})),se.resolve(this.Yr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1;let c=s;Je.isDocumentKey(c)||(c=c.child(""));const u=new sr(new Je(c),0);let d=new Yn(Bt);return this.Jr.forEachWhile((p=>{const g=p.key.path;return!!s.isPrefixOf(g)&&(g.length===o&&(d=d.add(p.Hr)),!0)}),u),se.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((s=>{const o=this.Zr(s);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){pt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Jr;return se.forEach(t.mutations,(o=>{const c=new sr(o.key,t.batchId);return s=s.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=s}))}nr(e){}containsKey(e,t){const s=new sr(t,0),o=this.Jr.firstAfterOrEqual(s);return se.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class N3{constructor(e){this.ti=e,this.docs=(function(){return new us(Je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,o=this.docs.get(s),c=o?o.size:0,u=this.ti(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-c,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return se.resolve(s?s.document.mutableCopy():fs.newInvalidDocument(t))}getEntries(e,t){let s=zr();return t.forEach((o=>{const c=this.docs.get(o);s=s.insert(o,c?c.document.mutableCopy():fs.newInvalidDocument(o))})),se.resolve(s)}getDocumentsMatchingQuery(e,t,s,o){let c=zr();const u=t.path,d=new Je(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:g,value:{document:b}}=p.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||Nv(bk(b),s)<=0||(o.has(b.key)||_d(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return se.resolve(c)}getAllFromCollectionGroup(e,t,s,o){ot(9500)}ni(e,t){return se.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new A3(this)}getSize(e){return se.resolve(this.size)}}class A3 extends qS{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(s)})),se.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class R3{constructor(e){this.persistence=e,this.ri=new Fa((t=>Bl(t)),vd),this.lastRemoteSnapshotVersion=Tt.min(),this.highestTargetId=0,this.ii=0,this.si=new Kv,this.targetCount=0,this.oi=Hl._r()}forEachTarget(e,t){return this.ri.forEach(((s,o)=>t(o))),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.ii&&(this.ii=t),se.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Hl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.lr(t),se.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,s){let o=0;const c=[];return this.ri.forEach(((u,d)=>{d.sequenceNumber<=t&&s.get(d.targetId)===null&&(this.ri.delete(u),c.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),se.waitFor(c).next((()=>o))}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const s=this.ri.get(t)||null;return se.resolve(s)}addMatchingKeys(e,t,s){return this.si.$r(t,s),se.resolve()}removeMatchingKeys(e,t,s){this.si.Qr(t,s);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((u=>{c.push(o.markPotentiallyOrphaned(e,u))})),se.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const s=this.si.jr(t);return se.resolve(s)}containsKey(e,t){return se.resolve(this.si.containsKey(t))}}class Qv{constructor(e,t){this._i={},this.overlays={},this.ai=new Ur(0),this.ui=!1,this.ui=!0,this.ci=new S3,this.referenceDelegate=e(this),this.li=new R3(this),this.indexManager=new p3,this.remoteDocumentCache=(function(o){return new N3(o)})((s=>this.referenceDelegate.hi(s))),this.serializer=new IS(t),this.Pi=new E3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new k3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this._i[e.toKey()];return s||(s=new j3(t,this.referenceDelegate),this._i[e.toKey()]=s),s}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,s){Oe("MemoryPersistence","Starting transaction:",e);const o=new C3(this.ai.next());return this.referenceDelegate.Ti(),s(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return se.or(Object.values(this._i).map((s=>()=>s.containsKey(e,t))))}}class C3 extends xk{constructor(e){super(),this.currentSequenceNumber=e}}class _p{constructor(e){this.persistence=e,this.Ri=new Kv,this.Ai=null}static Vi(e){return new _p(e)}get di(){if(this.Ai)return this.Ai;throw ot(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.di.delete(s.toString()),se.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.di.add(s.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),se.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>s.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.di,(s=>{const o=Je.fromPath(s);return this.mi(e,o).next((c=>{c||t.removeEntry(o,Tt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((s=>{s?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return se.or([()=>se.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class qm{constructor(e,t){this.persistence=e,this.fi=new Fa((s=>_r(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=zS(this,t)}static Vi(e,t){return new qm(e,t)}Ti(){}Ii(e){return se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}mr(e,t){return se.forEach(this.fi,((s,o)=>this.wr(e,s,o).next((c=>c?se.resolve():t(o)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(u=>this.wr(e,u,t).next((d=>{d||(s++,c.removeEntry(u,Tt.min()))})))).next((()=>c.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),se.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),se.resolve()}removeReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),se.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=gm(e.data.value)),t}wr(e,t,s){return se.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return se.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class I3{constructor(e){this.serializer=e}k(e,t,s,o){const c=new op("createOrUpgrade",t);s<1&&o>=1&&((function(p){p.createObjectStore(bd)})(e),(function(p){p.createObjectStore(Xh,{keyPath:$P}),p.createObjectStore(Ci,{keyPath:h2,autoIncrement:!0}).createIndex(jl,d2,{unique:!0}),p.createObjectStore(nu)})(e),tT(e),(function(p){p.createObjectStore(wl)})(e));let u=se.resolve();return s<3&&o>=3&&(s!==0&&((function(p){p.deleteObjectStore(ru),p.deleteObjectStore(su),p.deleteObjectStore(Rl)})(e),tT(e)),u=u.next((()=>(function(p){const g=p.store(Rl),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Tt.min().toTimestamp(),targetCount:0};return g.put(Lm,b)})(c)))),s<4&&o>=4&&(s!==0&&(u=u.next((()=>(function(p,g){return g.store(Ci).H().next((x=>{p.deleteObjectStore(Ci),p.createObjectStore(Ci,{keyPath:h2,autoIncrement:!0}).createIndex(jl,d2,{unique:!0});const T=g.store(Ci),N=x.map((B=>T.put(B)));return se.waitFor(N)}))})(e,c)))),u=u.next((()=>{(function(p){p.createObjectStore(iu,{keyPath:eM})})(e)}))),s<5&&o>=5&&(u=u.next((()=>this.gi(c)))),s<6&&o>=6&&(u=u.next((()=>((function(p){p.createObjectStore(Jh)})(e),this.pi(c))))),s<7&&o>=7&&(u=u.next((()=>this.yi(c)))),s<8&&o>=8&&(u=u.next((()=>this.wi(e,c)))),s<9&&o>=9&&(u=u.next((()=>{(function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&o>=10&&(u=u.next((()=>this.bi(c)))),s<11&&o>=11&&(u=u.next((()=>{(function(p){p.createObjectStore(lp,{keyPath:tM})})(e),(function(p){p.createObjectStore(cp,{keyPath:nM})})(e)}))),s<12&&o>=12&&(u=u.next((()=>{(function(p){const g=p.createObjectStore(up,{keyPath:cM});g.createIndex(Pb,uM,{unique:!1}),g.createIndex(Nk,hM,{unique:!1})})(e)}))),s<13&&o>=13&&(u=u.next((()=>(function(p){const g=p.createObjectStore(Mm,{keyPath:GP});g.createIndex(mm,KP),g.createIndex(Ek,QP)})(e))).next((()=>this.Si(e,c))).next((()=>e.deleteObjectStore(wl)))),s<14&&o>=14&&(u=u.next((()=>this.Di(e,c)))),s<15&&o>=15&&(u=u.next((()=>(function(p){p.createObjectStore(Cv,{keyPath:sM,autoIncrement:!0}).createIndex(Db,rM,{unique:!1}),p.createObjectStore(Oh,{keyPath:iM}).createIndex(Sk,aM,{unique:!1}),p.createObjectStore(Bh,{keyPath:oM}).createIndex(jk,lM,{unique:!1})})(e)))),s<16&&o>=16&&(u=u.next((()=>{t.objectStore(Oh).clear()})).next((()=>{t.objectStore(Bh).clear()}))),s<17&&o>=17&&(u=u.next((()=>{(function(p){p.createObjectStore(Iv,{keyPath:dM})})(e)}))),s<18&&o>=18&&xE()&&(u=u.next((()=>{t.objectStore(Oh).clear()})).next((()=>{t.objectStore(Bh).clear()}))),u}pi(e){let t=0;return e.store(wl).ee(((s,o)=>{t+=zm(o)})).next((()=>{const s={byteSize:t};return e.store(Jh).put(Ib,s)}))}gi(e){const t=e.store(Xh),s=e.store(Ci);return t.H().next((o=>se.forEach(o,(c=>{const u=IDBKeyRange.bound([c.userId,Vo],[c.userId,c.lastAcknowledgedBatchId]);return s.H(jl,u).next((d=>se.forEach(d,(p=>{pt(p.userId===c.userId,18650,"Cannot process batch from unexpected user",{batchId:p.batchId});const g=El(this.serializer,p);return VS(e,c.userId,g).next((()=>{}))}))))}))))}yi(e){const t=e.store(ru),s=e.store(wl);return e.store(Rl).get(Lm).next((o=>{const c=[];return s.ee(((u,d)=>{const p=new mn(u),g=(function(x){return[0,_r(x)]})(p);c.push(t.get(g).next((b=>b?se.resolve():(x=>t.put({targetId:0,path:_r(x),sequenceNumber:o.highestListenSequenceNumber}))(p))))})).next((()=>se.waitFor(c)))}))}wi(e,t){e.createObjectStore(Zh,{keyPath:ZP});const s=t.store(Zh),o=new Gv,c=u=>{if(o.add(u)){const d=u.lastSegment(),p=u.popLast();return s.put({collectionId:d,parent:_r(p)})}};return t.store(wl).ee({Y:!0},((u,d)=>{const p=new mn(u);return c(p.popLast())})).next((()=>t.store(nu).ee({Y:!0},(([u,d,p],g)=>{const b=Gi(d);return c(b.popLast())}))))}bi(e){const t=e.store(su);return t.ee(((s,o)=>{const c=Dh(o),u=DS(this.serializer,c);return t.put(u)}))}Si(e,t){const s=t.store(wl),o=[];return s.ee(((c,u)=>{const d=t.store(Mm),p=(function(x){return x.document?new Je(mn.fromString(x.document.name).popFirst(5)):x.noDocument?Je.fromSegments(x.noDocument.path):x.unknownDocument?Je.fromSegments(x.unknownDocument.path):ot(36783)})(u).path.toArray(),g={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};o.push(d.put(g))})).next((()=>se.waitFor(o)))}Di(e,t){const s=t.store(Ci),o=HS(this.serializer),c=new Qv(_p.Vi,this.serializer.yt);return s.H().next((u=>{const d=new Map;return u.forEach((p=>{let g=d.get(p.userId)??Zt();El(this.serializer,p).keys().forEach((b=>g=g.add(b))),d.set(p.userId,g)})),se.forEach(d,((p,g)=>{const b=new rr(g),x=vp.wt(this.serializer,b),T=c.getIndexManager(b),N=xp.wt(b,this.serializer,T,c.referenceDelegate);return new $S(o,N,x,T).recalculateAndSaveOverlaysForDocumentKeys(new Mb(t,Ur.ce),p).next()}))}))}}function tT(n){n.createObjectStore(ru,{keyPath:XP}).createIndex(Rv,JP,{unique:!0}),n.createObjectStore(su,{keyPath:"targetId"}).createIndex(kk,YP,{unique:!0}),n.createObjectStore(Rl)}const vo="IndexedDbPersistence",$y=18e5,Wy=5e3,Gy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",WS="main";class Yv{constructor(e,t,s,o,c,u,d,p,g,b,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Ci=c,this.window=u,this.document=d,this.Fi=g,this.Mi=b,this.xi=x,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=T=>Promise.resolve(),!Yv.v())throw new Ce(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new x3(this,o),this.Ki=t+WS,this.serializer=new IS(p),this.qi=new Zi(this.Ki,this.xi,new I3(this.serializer)),this.ci=new c3,this.li=new y3(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HS(this.serializer),this.Pi=new l3,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Ms(vo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(ce.FAILED_PRECONDITION,Gy);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new Ur(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Qf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Ko(e))return Oe(vo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Oe(vo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Th(e).get(Cc).next((t=>se.resolve(this.Xi(t))))}Yi(e){return Qf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,$y)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=Js(t,iu);return s.H().next((o=>{const c=this.ns(o,$y),u=o.filter((d=>c.indexOf(d)===-1));return se.forEach(u,(d=>s.delete(d.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?se.resolve(!0):Th(e).get(Cc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Ce(ce.FAILED_PRECONDITION,Gy);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qf(e).H().next((s=>this.ns(s,Wy).find((o=>{if(this.clientId!==o.clientId){const c=!this.networkEnabled&&o.networkEnabled,u=!this.inForeground&&o.inForeground,d=this.networkEnabled===o.networkEnabled;if(c||u&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Oe(vo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[bd,iu],(e=>{const t=new Mb(e,Ur.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((s=>this.ts(s.updateTimeMs,t)&&!this.ss(s.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Qf(e).H().next((t=>this.ns(t,$y).map((s=>s.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return xp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new g3(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,s){Oe(vo,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",c=(function(p){return p===18?pM:p===17?Ik:p===16?mM:p===15?Dv:p===14?Ck:p===13?Rk:p===12?fM:p===11?Ak:void ot(60245)})(this.xi);let u;return this.qi.runTransaction(e,o,c,(d=>(u=new Mb(d,this.ai?this.ai.next():Ur.ce),t==="readwrite-primary"?this.ji(u).next((p=>!!p||this.Hi(u))).next((p=>{if(!p)throw Ms(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Ce(ce.FAILED_PRECONDITION,vk);return s(u)})).next((p=>this.Zi(u).next((()=>p)))):this.Ps(u).next((()=>s(u)))))).then((d=>(u.raiseOnCommittedEvent(),d)))}Ps(e){return Th(e).get(Cc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(ce.FAILED_PRECONDITION,Gy)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Th(e).put(Cc,t)}static v(){return Zi.v()}Ji(e){const t=Th(e);return t.get(Cc).next((s=>this.Xi(s)?(Oe(vo,"Releasing primary lease."),t.delete(Cc)):se.resolve()))}ts(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Ms(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;vE()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return Oe(vo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ms(vo,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Ms("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Th(n){return Js(n,bd)}function Qf(n){return Js(n,iu)}function Xv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Jv{constructor(e,t,s,o){this.targetId=e,this.fromCache=t,this.Ts=s,this.Is=o}static Es(e,t){let s=Zt(),o=Zt();for(const c of t.docChanges)switch(c.type){case 0:s=s.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Jv(e,t.fromCache,s,o)}}class D3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class GS{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return vE()?8:_k(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,o){const c={result:null};return this.gs(e,t).next((u=>{c.result=u})).next((()=>{if(!c.result)return this.ps(e,t,o,s).next((u=>{c.result=u}))})).next((()=>{if(c.result)return;const u=new D3;return this.ys(e,t,u).next((d=>{if(c.result=d,this.As)return this.ws(e,t,u,d.size)}))})).next((()=>c.result))}ws(e,t,s,o){return s.documentReadCount<this.Vs?(Fc()<=En.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",zc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),se.resolve()):(Fc()<=En.DEBUG&&Oe("QueryEngine","Query:",zc(t),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.ds*o?(Fc()<=En.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",zc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wr(t))):se.resolve())}gs(e,t){if(k2(t))return se.resolve(null);let s=wr(t);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Bm(t,null,"F"),s=wr(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((c=>{const u=Zt(...c);return this.fs.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,s).next((p=>{const g=this.bs(t,d);return this.Ss(t,g,u,p.readTime)?this.gs(e,Bm(t,null,"F")):this.Ds(e,g,t,p)}))))})))))}ps(e,t,s,o){return k2(t)||o.isEqual(Tt.min())?se.resolve(null):this.fs.getDocuments(e,s).next((c=>{const u=this.bs(t,c);return this.Ss(t,u,s,o)?se.resolve(null):(Fc()<=En.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),zc(t)),this.Ds(e,u,t,yk(o,Zc)).next((d=>d)))}))}bs(e,t){let s=new Yn(nS(e));return t.forEach(((o,c)=>{_d(e,c)&&(s=s.add(c))})),s}Ss(e,t,s,o){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,s){return Fc()<=En.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",zc(t)),this.fs.getDocumentsMatchingQuery(e,t,si.min(),s)}Ds(e,t,s,o){return this.fs.getDocumentsMatchingQuery(e,s,o).next((c=>(t.forEach((u=>{c=c.insert(u.key,u)})),c)))}}const Zv="LocalStore",P3=3e8;class M3{constructor(e,t,s,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new us(Bt),this.Fs=new Fa((c=>Bl(c)),vd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(s)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $S(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function KS(n,e,t,s){return new M3(n,e,t,s)}async function QS(n,e){const t=Ze(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return t.mutationQueue.getAllMutationBatches(s).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(s)))).next((c=>{const u=[],d=[];let p=Zt();for(const g of o){u.push(g.batchId);for(const b of g.mutations)p=p.add(b.key)}for(const g of c){d.push(g.batchId);for(const b of g.mutations)p=p.add(b.key)}return t.localDocuments.getDocuments(s,p).next((g=>({Ns:g,removedBatchIds:u,addedBatchIds:d})))}))}))}function L3(n,e){const t=Ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,p,g,b){const x=g.batch,T=x.keys();let N=se.resolve();return T.forEach((B=>{N=N.next((()=>b.getEntry(p,B))).next((M=>{const D=g.docVersions.get(B);pt(D!==null,48541),M.version.compareTo(D)<0&&(x.applyToRemoteDocument(M,g),M.isValidDocument()&&(M.setReadTime(g.commitVersion),b.addEntry(M)))}))})),N.next((()=>d.mutationQueue.removeMutationBatch(p,x)))})(t,s,e,c).next((()=>c.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(d){let p=Zt();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(p=p.add(d.batch.mutations[g].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(s,o)))}))}function YS(n){const e=Ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function V3(n,e){const t=Ze(n),s=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const d=[];e.targetChanges.forEach(((b,x)=>{const T=o.get(x);if(!T)return;d.push(t.li.removeMatchingKeys(c,b.removedDocuments,x).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,x))));let N=T.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(x)!==null?N=N.withResumeToken(Ns.EMPTY_BYTE_STRING,Tt.min()).withLastLimboFreeSnapshotVersion(Tt.min()):b.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(b.resumeToken,s)),o=o.insert(x,N),(function(M,D,X){return M.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=P3?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(T,N,b)&&d.push(t.li.updateTargetData(c,N))}));let p=zr(),g=Zt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),d.push(XS(c,u,e.documentUpdates).next((b=>{p=b.Bs,g=b.Ls}))),!s.isEqual(Tt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((x=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,s)));d.push(b)}return se.waitFor(d).next((()=>u.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,p,g))).next((()=>p))})).then((c=>(t.vs=o,c)))}function XS(n,e,t){let s=Zt(),o=Zt();return t.forEach((c=>s=s.add(c))),e.getEntries(n,s).next((c=>{let u=zr();return t.forEach(((d,p)=>{const g=c.get(d);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(d)),p.isNoDocument()&&p.version.isEqual(Tt.min())?(e.removeEntry(d,p.readTime),u=u.insert(d,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),u=u.insert(d,p)):Oe(Zv,"Ignoring outdated watch update for ",d,". Current version:",g.version," Watch version:",p.version)})),{Bs:u,Ls:o}}))}function O3(n,e){const t=Ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Vo),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function du(n,e){const t=Ze(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return t.li.getTargetData(s,e).next((c=>c?(o=c,se.resolve(o)):t.li.allocateTargetId(s).next((u=>(o=new ja(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.li.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=t.vs.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(s.targetId,s),t.Fs.set(e,s.targetId)),s}))}async function fu(n,e,t){const s=Ze(n),o=s.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",c,(u=>s.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!Ko(u))throw u;Oe(Zv,`Failed to update sequence numbers for target ${e}: ${u}`)}s.vs=s.vs.remove(e),s.Fs.delete(o.target)}function Hm(n,e,t){const s=Ze(n);let o=Tt.min(),c=Zt();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(p,g,b){const x=Ze(p),T=x.Fs.get(b);return T!==void 0?se.resolve(x.vs.get(T)):x.li.getTargetData(g,b)})(s,u,wr(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,s.li.getMatchingKeysForTargetId(u,d.targetId).next((p=>{c=p}))})).next((()=>s.Cs.getDocumentsMatchingQuery(u,e,t?o:Tt.min(),t?c:Zt()))).next((d=>(ej(s,tS(e),d),{documents:d,ks:c})))))}function JS(n,e){const t=Ze(n),s=Ze(t.li),o=t.vs.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",(c=>s.At(c,e).next((u=>u?u.target:null))))}function ZS(n,e){const t=Ze(n),s=t.Ms.get(e)||Tt.min();return t.persistence.runTransaction("Get new document changes","readonly",(o=>t.xs.getAllFromCollectionGroup(o,e,yk(s,Zc),Number.MAX_SAFE_INTEGER))).then((o=>(ej(t,e,o),o)))}function ej(n,e,t){let s=n.Ms.get(e)||Tt.min();t.forEach(((o,c)=>{c.readTime.compareTo(s)>0&&(s=c.readTime)})),n.Ms.set(e,s)}async function B3(n,e,t,s){const o=Ze(n);let c=Zt(),u=zr();for(const g of t){const b=e.Ks(g.metadata.name);g.document&&(c=c.add(b));const x=e.qs(g);x.setReadTime(e.Us(g.metadata.readTime)),u=u.insert(b,x)}const d=o.xs.newChangeBuffer({trackRemovals:!0}),p=await du(o,(function(b){return wr(Eu(mn.fromString(`__bundle__/docs/${b}`)))})(s));return o.persistence.runTransaction("Apply bundle documents","readwrite",(g=>XS(g,d,u).next((b=>(d.apply(g),b))).next((b=>o.li.removeMatchingKeysForTargetId(g,p.targetId).next((()=>o.li.addMatchingKeys(g,c,p.targetId))).next((()=>o.localDocuments.getLocalViewOfDocuments(g,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function U3(n,e,t=Zt()){const s=await du(n,wr(bp(e.bundledQuery))),o=Ze(n);return o.persistence.runTransaction("Save named query","readwrite",(c=>{const u=Ls(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Pi.saveNamedQuery(c,e);const d=s.withResumeToken(Ns.EMPTY_BYTE_STRING,u);return o.vs=o.vs.insert(d.targetId,d),o.li.updateTargetData(c,d).next((()=>o.li.removeMatchingKeysForTargetId(c,s.targetId))).next((()=>o.li.addMatchingKeys(c,t,s.targetId))).next((()=>o.Pi.saveNamedQuery(c,e)))}))}const tj="firestore_clients";function nT(n,e){return`${tj}_${n}_${e}`}const nj="firestore_mutations";function sT(n,e,t){let s=`${nj}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const sj="firestore_targets";function Ky(n,e){return`${sj}_${n}_${e}`}const Wi="SharedClientState";class $m{constructor(e,t,s,o){this.user=e,this.batchId=t,this.state=s,this.error=o}static $s(e,t,s){const o=JSON.parse(s);let c,u=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return u&&o.error&&(u=typeof o.error.message=="string"&&typeof o.error.code=="string",u&&(c=new Ce(o.error.code,o.error.message))),u?new $m(e,t,o.state,c):(Ms(Wi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class qh{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static $s(e,t){const s=JSON.parse(t);let o,c=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new Ce(s.error.code,s.error.message))),c?new qh(e,s.state,o):(Ms(Wi,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const s=JSON.parse(t);let o=typeof s=="object"&&s.activeTargetIds instanceof Array,c=Ov();for(let u=0;o&&u<s.activeTargetIds.length;++u)o=wk(s.activeTargetIds[u]),c=c.add(s.activeTargetIds[u]);return o?new Wm(e,c):(Ms(Wi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class e0{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new e0(t.clientId,t.onlineState):(Ms(Wi,`Failed to parse online state: ${e}`),null)}}class Yb{constructor(){this.activeTargetIds=Ov()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Qy{constructor(e,t,s,o,c){this.window=e,this.Ci=t,this.persistenceKey=s,this.zs=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new us(Bt),this.started=!1,this.Zs=[];const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.Xs=nT(this.persistenceKey,this.zs),this.Ys=(function(p){return`firestore_sequence_number_${p}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Yb),this.eo=new RegExp(`^${tj}_${u}_([^_]*)$`),this.no=new RegExp(`^${nj}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${sj}_${u}_(\\d+)$`),this.io=(function(p){return`firestore_online_state_${p}`})(this.persistenceKey),this.so=(function(p){return`firestore_bundle_loaded_v2_${p}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const s of e){if(s===this.zs)continue;const o=this.getItem(nT(this.persistenceKey,s));if(o){const c=Wm.$s(s,o);c&&(this.Js=this.Js.insert(c.clientId,c))}}this.oo();const t=this.storage.getItem(this.io);if(t){const s=this._o(t);s&&this.ao(s)}for(const s of this.Zs)this.Hs(s);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((s,o)=>{o.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,s){this.co(e,t,s),this.lo(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(Ky(this.persistenceKey,e));if(o){const c=qh.$s(e,o);c&&(s=c.state)}}return t&&this.ho.Qs(e),this.oo(),s}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ky(this.persistenceKey,e))}updateQueryState(e,t,s){this.Po(e,t,s)}handleUserChange(e,t,s){t.forEach((o=>{this.lo(o)})),this.currentUser=e,s.forEach((o=>{this.addPendingMutation(o)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Oe(Wi,"READ",e,t),t}setItem(e,t){Oe(Wi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Oe(Wi,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Oe(Wi,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Ms("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const s=this.Eo(t.key);return this.Ro(s,null)}{const s=this.Ao(t.key,t.newValue);if(s)return this.Ro(s.clientId,s)}}else if(this.no.test(t.key)){if(t.newValue!==null){const s=this.Vo(t.key,t.newValue);if(s)return this.mo(s)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(t.key===this.io){if(t.newValue!==null){const s=this._o(t.newValue);if(s)return this.ao(s)}}else if(t.key===this.Ys){const s=(function(c){let u=Ur.ce;if(c!=null)try{const d=JSON.parse(c);pt(typeof d=="number",30636,{yo:c}),u=d}catch(d){Ms(Wi,"Failed to read sequence number from WebStorage",d)}return u})(t.newValue);s!==Ur.ce&&this.sequenceNumberHandler(s)}else if(t.key===this.so){const s=this.wo(t.newValue);await Promise.all(s.map((o=>this.syncEngine.bo(o))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,s){const o=new $m(this.currentUser,e,t,s),c=sT(this.persistenceKey,this.currentUser,e);this.setItem(c,o.Ws())}lo(e){const t=sT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,s){const o=Ky(this.persistenceKey,e),c=new qh(e,t,s);this.setItem(o,c.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const s=this.Eo(e);return Wm.$s(s,t)}Vo(e,t){const s=this.no.exec(e),o=Number(s[1]),c=s[2]!==void 0?s[2]:null;return $m.$s(new rr(c),o,t)}fo(e,t){const s=this.ro.exec(e),o=Number(s[1]);return qh.$s(o,t)}_o(e){return e0.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Oe(Wi,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const s=t?this.Js.insert(e,t):this.Js.remove(e),o=this.uo(this.Js),c=this.uo(s),u=[],d=[];return c.forEach((p=>{o.has(p)||u.push(p)})),o.forEach((p=>{c.has(p)||d.push(p)})),this.syncEngine.Co(u,d).then((()=>{this.Js=s}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Ov();return e.forEach(((s,o)=>{t=t.unionWith(o.activeTargetIds)})),t}}class rj{constructor(){this.vo=new Yb,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,s){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yb,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class F3{Mo(e){}shutdown(){}}const rT="ConnectivityMonitor";class iT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Oe(rT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Oe(rT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Yf=null;function Xb(){return Yf===null?Yf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yf++,"0x"+Yf.toString(16)}const Yy="RestConnection",z3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class q3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${s}/databases/${o}`,this.$o=this.databaseId.database===td?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Wo(e,t,s,o,c){const u=Xb(),d=this.Qo(e,t.toUriEncodedString());Oe(Yy,`Sending RPC '${e}' ${u}:`,d,s);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,o,c);const{host:g}=new URL(d),b=Va(g);return this.zo(e,d,p,s,b).then((x=>(Oe(Yy,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw xi(Yy,`RPC '${e}' ${u} failed with error: `,x,"url: ",d,"request:",s),x}))}jo(e,t,s,o,c,u){return this.Wo(e,t,s,o,c)}Go(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Tu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),s&&s.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const s=z3[e];let o=`${this.qo}/v1/${t}:${s}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class H3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const vr="WebChannelConnection",Eh=(n,e,t)=>{n.listen(e,(s=>{try{t(s)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Yc extends q3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Yc.c_){const e=uk();Eh(e,ck.STAT_EVENT,(t=>{t.stat===jb.PROXY?Oe(vr,"STAT_EVENT: detected buffering proxy"):t.stat===jb.NOPROXY&&Oe(vr,"STAT_EVENT: detected no buffering proxy")})),Yc.c_=!0}}zo(e,t,s,o,c){const u=Xb();return new Promise(((d,p)=>{const g=new ok;g.setWithCredentials(!0),g.listenOnce(lk.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case dm.NO_ERROR:const x=g.getResponseJson();Oe(vr,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),d(x);break;case dm.TIMEOUT:Oe(vr,`RPC '${e}' ${u} timed out`),p(new Ce(ce.DEADLINE_EXCEEDED,"Request time out"));break;case dm.HTTP_ERROR:const T=g.getStatus();if(Oe(vr,`RPC '${e}' ${u} failed with status:`,T,"response text:",g.getResponseText()),T>0){let N=g.getResponseJson();Array.isArray(N)&&(N=N[0]);const B=N?.error;if(B&&B.status&&B.message){const M=(function(X){const H=X.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(H)>=0?H:ce.UNKNOWN})(B.status);p(new Ce(M,B.message))}else p(new Ce(ce.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new Ce(ce.UNAVAILABLE,"Connection failed."));break;default:ot(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Oe(vr,`RPC '${e}' ${u} completed.`)}}));const b=JSON.stringify(o);Oe(vr,`RPC '${e}' ${u} sending request:`,o),g.send(t,"POST",b,s,15)}))}T_(e,t,s){const o=Xb(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,s),d.encodeInitMessageHeaders=!0;const g=c.join("");Oe(vr,`Creating RPC '${e}' stream ${o}: ${g}`,d);const b=u.createWebChannel(g,d);this.I_(b);let x=!1,T=!1;const N=new H3({Ho:B=>{T?Oe(vr,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(x||(Oe(vr,`Opening RPC '${e}' stream ${o} transport.`),b.open(),x=!0),Oe(vr,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return Eh(b,Rh.EventType.OPEN,(()=>{T||(Oe(vr,`RPC '${e}' stream ${o} transport opened.`),N.i_())})),Eh(b,Rh.EventType.CLOSE,(()=>{T||(T=!0,Oe(vr,`RPC '${e}' stream ${o} transport closed`),N.o_(),this.E_(b))})),Eh(b,Rh.EventType.ERROR,(B=>{T||(T=!0,xi(vr,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),N.o_(new Ce(ce.UNAVAILABLE,"The operation could not be completed")))})),Eh(b,Rh.EventType.MESSAGE,(B=>{if(!T){const M=B.data[0];pt(!!M,16349);const D=M,X=D?.error||D[0]?.error;if(X){Oe(vr,`RPC '${e}' stream ${o} received error:`,X);const H=X.status;let J=(function(Te){const C=$s[Te];if(C!==void 0)return gS(C)})(H),he=X.message;J===void 0&&(J=ce.INTERNAL,he="Unknown error status: "+H+" with message "+X.message),T=!0,N.o_(new Ce(J,he)),b.close()}else Oe(vr,`RPC '${e}' stream ${o} received:`,M),N.__(M)}})),Yc.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,s){super.Go(e,t,s),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return hk()}}function $3(n){return new Yc(n)}function ij(){return typeof window<"u"?window:null}function _m(){return typeof document<"u"?document:null}function Yl(n){return new XM(n,!0)}Yc.c_=!1;class t0{constructor(e,t,s=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=s,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-s);o>0&&Oe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const aT="PersistentStream";class aj{constructor(e,t,s,o,c,u,d,p){this.Ci=e,this.b_=s,this.S_=o,this.connection=c,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new t0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Ms(t.toString()),Ms("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===t&&this.G_(s,o)}),(s=>{e((()=>{const o=new Ce(ce.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,t){const s=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.Yo((()=>{s((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(aT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Oe(aT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class W3 extends aj{constructor(e,t,s,o,c,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=e3(this.serializer,e),s=(function(c){if(!("targetChange"in c))return Tt.min();const u=c.targetChange;return u.targetIds&&u.targetIds.length?Tt.min():u.readTime?Ls(u.readTime):Tt.min()})(e);return this.listener.J_(t,s)}Z_(e){const t={};t.database=$b(this.serializer),t.addTarget=(function(c,u){let d;const p=u.target;if(d=Vm(p)?{documents:kS(c,p)}:{query:yp(c,p).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=xS(c,u.resumeToken);const g=qb(c,u.expectedCount);g!==null&&(d.expectedCount=g)}else if(u.snapshotVersion.compareTo(Tt.min())>0){d.readTime=hu(c,u.snapshotVersion.toTimestamp());const g=qb(c,u.expectedCount);g!==null&&(d.expectedCount=g)}return d})(this.serializer,e);const s=n3(this.serializer,e);s&&(t.labels=s),this.K_(t)}X_(e){const t={};t.database=$b(this.serializer),t.removeTarget=e,this.K_(t)}}class G3 extends aj{constructor(e,t,s,o,c,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=t3(e.writeResults,e.commitTime),s=Ls(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=$b(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>ad(this.serializer,s)))};this.K_(t)}}class K3{}class Q3 extends K3{constructor(e,t,s,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ce(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,u])=>this.connection.Wo(e,Hb(t,s),o,c,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ce(ce.UNKNOWN,c.toString())}))}jo(e,t,s,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.jo(e,Hb(t,s),o,u,d,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(ce.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Y3(n,e,t,s){return new Q3(n,e,t,s)}class X3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ms(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const $l="RemoteStore";class J3{constructor(e,t,s,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((u=>{s.enqueueAndForget((async()=>{Yo(this)&&(Oe($l,"Restarting streams for network reachability change."),await(async function(p){const g=Ze(p);g.Ea.add(4),await ju(g),g.Va.set("Unknown"),g.Ea.delete(4),await kd(g)})(this))}))})),this.Va=new X3(s,o)}}async function kd(n){if(Yo(n))for(const e of n.Ra)await e(!0)}async function ju(n){for(const e of n.Ra)await e(!1)}function wp(n,e){const t=Ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),r0(t)?s0(t):Au(t).O_()&&n0(t,e))}function mu(n,e){const t=Ze(n),s=Au(t);t.Ia.delete(e),s.O_()&&oj(t,e),t.Ia.size===0&&(s.O_()?s.L_():Yo(t)&&t.Va.set("Unknown"))}function n0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Tt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Au(n).Z_(e)}function oj(n,e){n.da.$e(e),Au(n).X_(e)}function s0(n){n.da=new GM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Au(n).start(),n.Va.ua()}function r0(n){return Yo(n)&&!Au(n).x_()&&n.Ia.size>0}function Yo(n){return Ze(n).Ea.size===0}function lj(n){n.da=void 0}async function Z3(n){n.Va.set("Online")}async function e6(n){n.Ia.forEach(((e,t)=>{n0(n,e)}))}async function t6(n,e){lj(n),r0(n)?(n.Va.ha(e),s0(n)):n.Va.set("Unknown")}async function n6(n,e,t){if(n.Va.set("Online"),e instanceof vS&&e.state===2&&e.cause)try{await(async function(o,c){const u=c.cause;for(const d of c.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,u),o.Ia.delete(d),o.da.removeTarget(d))})(n,e)}catch(s){Oe($l,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Gm(n,s)}else if(e instanceof vm?n.da.Xe(e):e instanceof bS?n.da.st(e):n.da.tt(e),!t.isEqual(Tt.min()))try{const s=await YS(n.localStore);t.compareTo(s)>=0&&await(function(c,u){const d=c.da.Tt(u);return d.targetChanges.forEach(((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(p.resumeToken,u))}})),d.targetMismatches.forEach(((p,g)=>{const b=c.Ia.get(p);if(!b)return;c.Ia.set(p,b.withResumeToken(Ns.EMPTY_BYTE_STRING,b.snapshotVersion)),oj(c,p);const x=new ja(b.target,p,g,b.sequenceNumber);n0(c,x)})),c.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(s){Oe($l,"Failed to raise snapshot:",s),await Gm(n,s)}}async function Gm(n,e,t){if(!Ko(e))throw e;n.Ea.add(1),await ju(n),n.Va.set("Offline"),t||(t=()=>YS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Oe($l,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await kd(n)}))}function cj(n,e){return e().catch((t=>Gm(n,t,e)))}async function Nu(n){const e=Ze(n),t=qo(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Vo;for(;s6(e);)try{const o=await O3(e.localStore,s);if(o===null){e.Ta.length===0&&t.L_();break}s=o.batchId,r6(e,o)}catch(o){await Gm(e,o)}uj(e)&&hj(e)}function s6(n){return Yo(n)&&n.Ta.length<10}function r6(n,e){n.Ta.push(e);const t=qo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function uj(n){return Yo(n)&&!qo(n).x_()&&n.Ta.length>0}function hj(n){qo(n).start()}async function i6(n){qo(n).ra()}async function a6(n){const e=qo(n);for(const t of n.Ta)e.ea(t.mutations)}async function o6(n,e,t){const s=n.Ta.shift(),o=zv.from(s,e,t);await cj(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Nu(n)}async function l6(n,e){e&&qo(n).Y_&&await(async function(s,o){if((function(u){return pS(u)&&u!==ce.ABORTED})(o.code)){const c=s.Ta.shift();qo(s).B_(),await cj(s,(()=>s.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Nu(s)}})(n,e),uj(n)&&hj(n)}async function oT(n,e){const t=Ze(n);t.asyncQueue.verifyOperationInProgress(),Oe($l,"RemoteStore received new credentials");const s=Yo(t);t.Ea.add(3),await ju(t),s&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kd(t)}async function Jb(n,e){const t=Ze(n);e?(t.Ea.delete(2),await kd(t)):e||(t.Ea.add(2),await ju(t),t.Va.set("Unknown"))}function Au(n){return n.ma||(n.ma=(function(t,s,o){const c=Ze(t);return c.sa(),new W3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:Z3.bind(null,n),Yo:e6.bind(null,n),t_:t6.bind(null,n),J_:n6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),r0(n)?s0(n):n.Va.set("Unknown")):(await n.ma.stop(),lj(n))}))),n.ma}function qo(n){return n.fa||(n.fa=(function(t,s,o){const c=Ze(t);return c.sa(),new G3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:i6.bind(null,n),t_:l6.bind(null,n),ta:a6.bind(null,n),na:o6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Nu(n)):(await n.fa.stop(),n.Ta.length>0&&(Oe($l,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class i0{constructor(e,t,s,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=o,this.removalCallback=c,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,o,c){const u=Date.now()+s,d=new i0(e,t,u,o,c);return d.start(s),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ru(n,e){if(Ms("AsyncQueue",`${e}: ${n}`),Ko(n))return new Ce(ce.UNAVAILABLE,`${e}: ${n}`);throw n}class Cl{static emptySet(e){return new Cl(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Je.comparator(t.key,s.key):(t,s)=>Je.comparator(t.key,s.key),this.keyedMap=Ch(),this.sortedSet=new us(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Cl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Cl;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class lT{constructor(){this.ga=new us(Je.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ot(63341,{Vt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Wl{constructor(e,t,s,o,c,u,d,p,g){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=c,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,s,o,c){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new Wl(e,t,Cl.emptySet(t),u,s,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==s[o].type||!t[o].doc.isEqual(s[o].doc))return!1;return!0}}class c6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class u6{constructor(){this.queries=cT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const o=Ze(t),c=o.queries;o.queries=cT(),c.forEach(((u,d)=>{for(const p of d.ba)p.onError(s)}))})(this,new Ce(ce.ABORTED,"Firestore shutting down"))}}function cT(){return new Fa((n=>eS(n)),xd)}async function a0(n,e){const t=Ze(n);let s=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(s=2):(c=new c6,s=e.Da()?0:1);try{switch(s){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const d=Ru(u,`Initialization of query '${zc(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&l0(t)}async function o0(n,e){const t=Ze(n),s=e.query;let o=3;const c=t.queries.get(s);if(c){const u=c.ba.indexOf(e);u>=0&&(c.ba.splice(u,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function h6(n,e){const t=Ze(n);let s=!1;for(const o of e){const c=o.query,u=t.queries.get(c);if(u){for(const d of u.ba)d.Fa(o)&&(s=!0);u.wa=o}}s&&l0(t)}function d6(n,e,t){const s=Ze(n),o=s.queries.get(e);if(o)for(const c of o.ba)c.onError(t);s.queries.delete(e)}function l0(n){n.Ca.forEach((e=>{e.next()}))}var Zb,uT;(uT=Zb||(Zb={})).Ma="default",uT.Cache="cache";class c0{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new Wl(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.Ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zb.Cache}}class dj{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class hT{constructor(e){this.serializer=e}Ks(e){return ea(this.serializer,e)}qs(e){return e.metadata.exists?gp(this.serializer,e.document,!1):fs.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Ls(e)}}class u0{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=fj(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const s=mn.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new hT(this.serializer);for(const o of e)if(o.metadata.queries){const c=s.Ks(o.metadata.name);for(const u of o.metadata.queries){const d=(t.get(u)||Zt()).add(c);t.set(u,d)}}return t}async ja(e){const t=await B3(e,new hT(this.serializer),this.Qa,this.$a.id),s=this.za(this.documents);for(const o of this.Wa)await U3(e,o,s.get(o.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function fj(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class mj{constructor(e){this.key=e}}class pj{constructor(e){this.key=e}}class gj{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Zt(),this.mutatedKeys=Zt(),this.eu=nS(e),this.tu=new Cl(this.eu)}get nu(){return this.Za}ru(e,t){const s=t?t.iu:new lT,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,u=o,d=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,x)=>{const T=o.get(b),N=_d(this.query,x)?x:null,B=!!T&&this.mutatedKeys.has(T.key),M=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let D=!1;T&&N?T.data.isEqual(N.data)?B!==M&&(s.track({type:3,doc:N}),D=!0):this.su(T,N)||(s.track({type:2,doc:N}),D=!0,(p&&this.eu(N,p)>0||g&&this.eu(N,g)<0)&&(d=!0)):!T&&N?(s.track({type:0,doc:N}),D=!0):T&&!N&&(s.track({type:1,doc:T}),D=!0,(p||g)&&(d=!0)),D&&(N?(u=u.add(N),c=M?c.add(b):c.delete(b)):(u=u.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const b=this.query.limitType==="F"?u.last():u.first();u=u.delete(b.key),c=c.delete(b.key),s.track({type:1,doc:b})}return{tu:u,iu:s,Ss:d,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((b,x)=>(function(N,B){const M=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot(20277,{Vt:D})}};return M(N)-M(B)})(b.type,x.type)||this.eu(b.doc,x.doc))),this.ou(s),o=o??!1;const d=t&&!o?this._u():[],p=this.Ya.size===0&&this.current&&!o?1:0,g=p!==this.Xa;return this.Xa=p,u.length!==0||g?{snapshot:new Wl(this.query,e.tu,c,u,e.mutatedKeys,p===0,g,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Zt(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Ya=this.Ya.add(s.key))}));const t=[];return e.forEach((s=>{this.Ya.has(s)||t.push(new pj(s))})),this.Ya.forEach((s=>{e.has(s)||t.push(new mj(s))})),t}cu(e){this.Za=e.ks,this.Ya=Zt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Xo="SyncEngine";class f6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class m6{constructor(e){this.key=e,this.hu=!1}}class p6{constructor(e,t,s,o,c,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Fa((d=>eS(d)),xd),this.Iu=new Map,this.Eu=new Set,this.Ru=new us(Je.comparator),this.Au=new Map,this.Vu=new Kv,this.du={},this.mu=new Map,this.fu=Hl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function g6(n,e,t=!0){const s=Tp(n);let o;const c=s.Tu.get(e);return c?(s.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await yj(s,e,t,!0),o}async function y6(n,e){const t=Tp(n);await yj(t,e,!0,!1)}async function yj(n,e,t,s){const o=await du(n.localStore,wr(e)),c=o.targetId,u=n.sharedClientState.addLocalQueryTarget(c,t);let d;return s&&(d=await h0(n,e,c,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&wp(n.remoteStore,o),d}async function h0(n,e,t,s,o){n.pu=(x,T,N)=>(async function(M,D,X,H){let J=D.view.ru(X);J.Ss&&(J=await Hm(M.localStore,D.query,!1).then((({documents:C})=>D.view.ru(C,J))));const he=H&&H.targetChanges.get(D.targetId),Ne=H&&H.targetMismatches.get(D.targetId)!=null,Te=D.view.applyChanges(J,M.isPrimaryClient,he,Ne);return ev(M,D.targetId,Te.au),Te.snapshot})(n,x,T,N);const c=await Hm(n.localStore,e,!0),u=new gj(e,c.ks),d=u.ru(c.documents),p=Ed.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",o),g=u.applyChanges(d,n.isPrimaryClient,p);ev(n,t,g.au);const b=new f6(e,t,u);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function b6(n,e,t){const s=Ze(n),o=s.Tu.get(e),c=s.Iu.get(o.targetId);if(c.length>1)return s.Iu.set(o.targetId,c.filter((u=>!xd(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await fu(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),t&&mu(s.remoteStore,o.targetId),pu(s,o.targetId)})).catch(Go)):(pu(s,o.targetId),await fu(s.localStore,o.targetId,!0))}async function v6(n,e){const t=Ze(n),s=t.Tu.get(e),o=t.Iu.get(s.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),mu(t.remoteStore,s.targetId))}async function x6(n,e,t){const s=p0(n);try{const o=await(function(u,d){const p=Ze(u),g=mt.now(),b=d.reduce(((N,B)=>N.add(B.key)),Zt());let x,T;return p.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let B=zr(),M=Zt();return p.xs.getEntries(N,b).next((D=>{B=D,B.forEach(((X,H)=>{H.isValidDocument()||(M=M.add(X))}))})).next((()=>p.localDocuments.getOverlayedDocuments(N,B))).next((D=>{x=D;const X=[];for(const H of d){const J=qM(H,x.get(H.key).overlayedDocument);J!=null&&X.push(new za(H.key,J,qk(J.value.mapValue),vs.exists(!0)))}return p.mutationQueue.addMutationBatch(N,g,X,d)})).next((D=>{T=D;const X=D.applyToLocalDocumentSet(x,M);return p.documentOverlayCache.saveOverlays(N,D.batchId,X)}))})).then((()=>({batchId:T.batchId,changes:rS(x)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(u,d,p){let g=u.du[u.currentUser.toKey()];g||(g=new us(Bt)),g=g.insert(d,p),u.du[u.currentUser.toKey()]=g})(s,o.batchId,t),await qa(s,o.changes),await Nu(s.remoteStore)}catch(o){const c=Ru(o,"Failed to persist write");t.reject(c)}}async function bj(n,e){const t=Ze(n);try{const s=await V3(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const u=t.Au.get(c);u&&(pt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?pt(u.hu,14607):o.removedDocuments.size>0&&(pt(u.hu,42227),u.hu=!1))})),await qa(t,s,e)}catch(s){await Go(s)}}function dT(n,e,t){const s=Ze(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const o=[];s.Tu.forEach(((c,u)=>{const d=u.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(u,d){const p=Ze(u);p.onlineState=d;let g=!1;p.queries.forEach(((b,x)=>{for(const T of x.ba)T.va(d)&&(g=!0)})),g&&l0(p)})(s.eventManager,e),o.length&&s.Pu.J_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function _6(n,e,t){const s=Ze(n);s.sharedClientState.updateQueryState(e,"rejected",t);const o=s.Au.get(e),c=o&&o.key;if(c){let u=new us(Je.comparator);u=u.insert(c,fs.newNoDocument(c,Tt.min()));const d=Zt().add(c),p=new Td(Tt.min(),new Map,new us(Bt),u,d);await bj(s,p),s.Ru=s.Ru.remove(c),s.Au.delete(e),m0(s)}else await fu(s.localStore,e,!1).then((()=>pu(s,e,t))).catch(Go)}async function w6(n,e){const t=Ze(n),s=e.batch.batchId;try{const o=await L3(t.localStore,e);f0(t,s,null),d0(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await qa(t,o)}catch(o){await Go(o)}}async function T6(n,e,t){const s=Ze(n);try{const o=await(function(u,d){const p=Ze(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return p.mutationQueue.lookupMutationBatch(g,d).next((x=>(pt(x!==null,37113),b=x.keys(),p.mutationQueue.removeMutationBatch(g,x)))).next((()=>p.mutationQueue.performConsistencyCheck(g))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(g,b,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>p.localDocuments.getDocuments(g,b)))}))})(s.localStore,e);f0(s,e,t),d0(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await qa(s,o)}catch(o){await Go(o)}}async function E6(n,e){const t=Ze(n);Yo(t.remoteStore)||Oe(Xo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(u){const d=Ze(u);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(p=>d.mutationQueue.getHighestUnacknowledgedBatchId(p)))})(t.localStore);if(s===Vo)return void e.resolve();const o=t.mu.get(s)||[];o.push(e),t.mu.set(s,o)}catch(s){const o=Ru(s,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}function d0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function f0(n,e,t){const s=Ze(n);let o=s.du[s.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),s.du[s.currentUser.toKey()]=o}}function pu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((s=>{n.Vu.containsKey(s)||vj(n,s)}))}function vj(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(mu(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),m0(n))}function ev(n,e,t){for(const s of t)s instanceof mj?(n.Vu.addReference(s.key,e),k6(n,s)):s instanceof pj?(Oe(Xo,"Document no longer in limbo: "+s.key),n.Vu.removeReference(s.key,e),n.Vu.containsKey(s.key)||vj(n,s.key)):ot(19791,{wu:s})}function k6(n,e){const t=e.key,s=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(s)||(Oe(Xo,"New document in limbo: "+t),n.Eu.add(s),m0(n))}function m0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Je(mn.fromString(e)),s=n.fu.next();n.Au.set(s,new m6(t)),n.Ru=n.Ru.insert(t,s),wp(n.remoteStore,new ja(wr(Eu(t.path)),s,"TargetPurposeLimboResolution",Ur.ce))}}async function qa(n,e,t){const s=Ze(n),o=[],c=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((d,p)=>{u.push(s.pu(p,e,t).then((g=>{if((g||t)&&s.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(p.targetId)?.current;s.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(g){o.push(g);const b=Jv.Es(p.targetId,g);c.push(b)}})))})),await Promise.all(u),s.Pu.J_(o),await(async function(p,g){const b=Ze(p);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>se.forEach(g,(T=>se.forEach(T.Ts,(N=>b.persistence.referenceDelegate.addReference(x,T.targetId,N))).next((()=>se.forEach(T.Is,(N=>b.persistence.referenceDelegate.removeReference(x,T.targetId,N)))))))))}catch(x){if(!Ko(x))throw x;Oe(Zv,"Failed to update sequence numbers: "+x)}for(const x of g){const T=x.targetId;if(!x.fromCache){const N=b.vs.get(T),B=N.snapshotVersion,M=N.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(T,M)}}})(s.localStore,c))}async function S6(n,e){const t=Ze(n);if(!t.currentUser.isEqual(e)){Oe(Xo,"User change. New user:",e.toKey());const s=await QS(t.localStore,e);t.currentUser=e,(function(c,u){c.mu.forEach((d=>{d.forEach((p=>{p.reject(new Ce(ce.CANCELLED,u))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await qa(t,s.Ns)}}function j6(n,e){const t=Ze(n),s=t.Au.get(e);if(s&&s.hu)return Zt().add(s.key);{let o=Zt();const c=t.Iu.get(e);if(!c)return o;for(const u of c){const d=t.Tu.get(u);o=o.unionWith(d.view.nu)}return o}}async function N6(n,e){const t=Ze(n),s=await Hm(t.localStore,e.query,!0),o=e.view.cu(s);return t.isPrimaryClient&&ev(t,e.targetId,o.au),o}async function A6(n,e){const t=Ze(n);return ZS(t.localStore,e).then((s=>qa(t,s)))}async function R6(n,e,t,s){const o=Ze(n),c=await(function(d,p){const g=Ze(d),b=Ze(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",(x=>b.Xn(x,p).next((T=>T?g.localDocuments.getDocuments(x,T):se.resolve(null)))))})(o.localStore,e);c!==null?(t==="pending"?await Nu(o.remoteStore):t==="acknowledged"||t==="rejected"?(f0(o,e,s||null),d0(o,e),(function(d,p){Ze(Ze(d).mutationQueue).nr(p)})(o.localStore,e)):ot(6720,"Unknown batchState",{bu:t}),await qa(o,c)):Oe(Xo,"Cannot apply mutation batch with id: "+e)}async function C6(n,e){const t=Ze(n);if(Tp(t),p0(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),o=await fT(t,s.toArray());t.gu=!0,await Jb(t.remoteStore,!0);for(const c of o)wp(t.remoteStore,c)}else if(e===!1&&t.gu!==!1){const s=[];let o=Promise.resolve();t.Iu.forEach(((c,u)=>{t.sharedClientState.isLocalQueryTarget(u)?s.push(u):o=o.then((()=>(pu(t,u),fu(t.localStore,u,!0)))),mu(t.remoteStore,u)})),await o,await fT(t,s),(function(u){const d=Ze(u);d.Au.forEach(((p,g)=>{mu(d.remoteStore,g)})),d.Vu.zr(),d.Au=new Map,d.Ru=new us(Je.comparator)})(t),t.gu=!1,await Jb(t.remoteStore,!1)}}async function fT(n,e,t){const s=Ze(n),o=[],c=[];for(const u of e){let d;const p=s.Iu.get(u);if(p&&p.length!==0){d=await du(s.localStore,wr(p[0]));for(const g of p){const b=s.Tu.get(g),x=await N6(s,b);x.snapshot&&c.push(x.snapshot)}}else{const g=await JS(s.localStore,u);d=await du(s.localStore,g),await h0(s,xj(g),u,!1,d.resumeToken)}o.push(d)}return s.Pu.J_(c),o}function xj(n){return Xk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function I6(n){return(function(t){return Ze(Ze(t).persistence).hs()})(Ze(n).localStore)}async function D6(n,e,t,s){const o=Ze(n);if(o.gu)return void Oe(Xo,"Ignoring unexpected query state notification.");const c=o.Iu.get(e);if(c&&c.length>0)switch(t){case"current":case"not-current":{const u=await ZS(o.localStore,tS(c[0])),d=Td.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ns.EMPTY_BYTE_STRING);await qa(o,u,d);break}case"rejected":await fu(o.localStore,e,!0),pu(o,e,s);break;default:ot(64155,t)}}async function P6(n,e,t){const s=Tp(n);if(s.gu){for(const o of e){if(s.Iu.has(o)&&s.sharedClientState.isActiveQueryTarget(o)){Oe(Xo,"Adding an already active target "+o);continue}const c=await JS(s.localStore,o),u=await du(s.localStore,c);await h0(s,xj(c),u.targetId,!1,u.resumeToken),wp(s.remoteStore,u)}for(const o of t)s.Iu.has(o)&&await fu(s.localStore,o,!1).then((()=>{mu(s.remoteStore,o),pu(s,o)})).catch(Go)}}function Tp(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=bj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_6.bind(null,e),e.Pu.J_=h6.bind(null,e.eventManager),e.Pu.yu=d6.bind(null,e.eventManager),e}function p0(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=w6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=T6.bind(null,e),e}function M6(n,e,t){const s=Ze(n);(async function(c,u,d){try{const p=await u.getMetadata();if(await(function(N,B){const M=Ze(N),D=Ls(B.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",(X=>M.Pi.getBundleMetadata(X,B.id))).then((X=>!!X&&X.createTime.compareTo(D)>=0))})(c.localStore,p))return await u.close(),d._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(p)),Promise.resolve(new Set);d._updateProgress(fj(p));const g=new u0(p,u.serializer);let b=await u.Su();for(;b;){const T=await g.Ga(b);T&&d._updateProgress(T),b=await u.Su()}const x=await g.ja(c.localStore);return await qa(c,x.Ja,void 0),await(function(N,B){const M=Ze(N);return M.persistence.runTransaction("Save bundle","readwrite",(D=>M.Pi.saveBundleMetadata(D,B)))})(c.localStore,p),d._completeWith(x.progress),Promise.resolve(x.Ha)}catch(p){return xi(Xo,`Loading bundle failed with ${p}`),d._failWith(p),Promise.resolve(new Set)}})(s,e,t).then((o=>{s.sharedClientState.notifyBundleLoaded(o)}))}class gu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return KS(this.persistence,new GS,e.initialUser,this.serializer)}Cu(e){return new Qv(_p.Vi,this.serializer)}Du(e){return new rj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gu.provider={build:()=>new gu};class g0 extends gu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){pt(this.persistence.referenceDelegate instanceof qm,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new FS(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new Qv((s=>qm.Vi(s,t)),this.serializer)}}class y0 extends gu{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await p0(this.xu.syncEngine),await Nu(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return KS(this.persistence,new GS,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new FS(s,e.asyncQueue,t)}Mu(e,t){const s=new qP(t,this.persistence);return new zP(e.asyncQueue,s)}Cu(e){const t=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new Yv(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,ij(),_m(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new rj}}class _j extends y0{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Qy&&(this.sharedClientState.syncEngine={So:R6.bind(null,t),Do:D6.bind(null,t),Co:P6.bind(null,t),hs:I6.bind(null,t),bo:A6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async s=>{await C6(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=ij();if(!Qy.v(t))throw new Ce(ce.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qy(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class Ho{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>dT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=S6.bind(null,this.syncEngine),await Jb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new u6})()}createDatastore(e){const t=Yl(e.databaseInfo.databaseId),s=$3(e.databaseInfo);return Y3(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,o,c,u,d){return new J3(s,o,c,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>dT(this.syncEngine,t,0)),(function(){return iT.v()?new iT:new F3})())}createSyncEngine(e,t){return(function(o,c,u,d,p,g,b){const x=new p6(o,c,u,d,p,g);return b&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Ze(t);Oe($l,"RemoteStore shutting down."),s.Ea.add(5),await ju(s),s.Aa.shutdown(),s.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ho.provider={build:()=>new Ho};function mT(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ms("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class L6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new ar,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.Ua()?this.metadata.resolve(s.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s?.qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.qu(`length string (${t}) is not valid number`);const o=await this.Uu(s);return new dj(JSON.parse(o),e.length+s)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class V6{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let s=this.Su();if(!s||!s.Ua())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(s?.qa)}`);this.metadata=s;do s=this.Su(),s!==null&&this.elements.push(s);while(s!==null)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;const e=this.Ku(),t=this.Uu(e);return new dj(JSON.parse(t),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new Ce(ce.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}let O6=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ce(ce.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(o,c){const u=Ze(o),d={documents:c.map((x=>id(u.serializer,x)))},p=await u.jo("BatchGetDocuments",u.serializer.databaseId,mn.emptyPath(),d,c.length),g=new Map;p.forEach((x=>{const T=ZM(u.serializer,x);g.set(T.key.toString(),T)}));const b=[];return c.forEach((x=>{const T=g.get(x.toString());pt(!!T,55234,{key:x}),b.push(T)})),b})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Su(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const o=Je.fromPath(s);this.mutations.push(new Uv(o,this.precondition(o)))})),await(async function(s,o){const c=Ze(s),u={writes:o.map((d=>ad(c.serializer,d)))};await c.Wo("Commit",c.serializer.databaseId,mn.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ot(50498,{Gu:e.constructor.name});t=Tt.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new Ce(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Tt.min())?vs.exists(!1):vs.updateTime(t):vs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Tt.min()))throw new Ce(ce.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(t)}return vs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class B6{constructor(e,t,s,o,c){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=o,this.deferred=c,this.zu=s.maxAttempts,this.M_=new t0(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new O6(this.datastore),t=this.Ju(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((o=>{this.Zu(o)}))))})).catch((s=>{this.Zu(s)}))}))}Ju(e){try{const t=this.updateFunction(e);return!yd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!pS(t)}return!1}}const $o="FirestoreClient";class U6{constructor(e,t,s,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this._databaseInfo=o,this.user=rr.UNAUTHENTICATED,this.clientId=Sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(s,(async u=>{Oe($o,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(Oe($o,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ru(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Xy(n,e){n.asyncQueue.verifyOperationInProgress(),Oe($o,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async o=>{s.isEqual(o)||(await QS(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function pT(n,e){n.asyncQueue.verifyOperationInProgress();const t=await b0(n);Oe($o,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>oT(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,o)=>oT(e.remoteStore,o))),n._onlineComponents=e}async function b0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe($o,"Using user provided OfflineComponentProvider");try{await Xy(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ce.FAILED_PRECONDITION||o.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;xi("Error using user provided cache. Falling back to memory cache: "+t),await Xy(n,new gu)}}else Oe($o,"Using default OfflineComponentProvider"),await Xy(n,new g0(void 0));return n._offlineComponents}async function kp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe($o,"Using user provided OnlineComponentProvider"),await pT(n,n._uninitializedComponentsProvider._online)):(Oe($o,"Using default OnlineComponentProvider"),await pT(n,new Ho))),n._onlineComponents}function wj(n){return b0(n).then((e=>e.persistence))}function Cu(n){return b0(n).then((e=>e.localStore))}function Tj(n){return kp(n).then((e=>e.remoteStore))}function v0(n){return kp(n).then((e=>e.syncEngine))}function Ej(n){return kp(n).then((e=>e.datastore))}async function yu(n){const e=await kp(n),t=e.eventManager;return t.onListen=g6.bind(null,e.syncEngine),t.onUnlisten=b6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=y6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=v6.bind(null,e.syncEngine),t}function F6(n){return n.asyncQueue.enqueue((async()=>{const e=await wj(n),t=await Tj(n);return e.setNetworkEnabled(!0),(function(o){const c=Ze(o);return c.Ea.delete(0),kd(c)})(t)}))}function z6(n){return n.asyncQueue.enqueue((async()=>{const e=await wj(n),t=await Tj(n);return e.setNetworkEnabled(!1),(async function(o){const c=Ze(o);c.Ea.add(0),await ju(c),c.Va.set("Offline")})(t)}))}function q6(n,e,t,s){const o=new Ep(s),c=new c0(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>a0(await yu(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>o0(await yu(n),c)))}}function H6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const d=await(function(g,b){const x=Ze(g);return x.persistence.runTransaction("read document","readonly",(T=>x.localDocuments.getDocument(T,b)))})(o,c);d.isFoundDocument()?u.resolve(d):d.isNoDocument()?u.resolve(null):u.reject(new Ce(ce.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const p=Ru(d,`Failed to get document '${c} from cache`);u.reject(p)}})(await Cu(n),e,t))),t.promise}function kj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,d,p,g){const b=new Ep({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x)));const N=T.docs.has(d);!N&&T.fromCache?g.reject(new Ce(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&T.fromCache&&p&&p.source==="server"?g.reject(new Ce(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(Eu(d.path),b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await yu(n),n.asyncQueue,e,t,s))),s.promise}function $6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const d=await Hm(o,c,!0),p=new gj(c,d.ks),g=p.ru(d.documents),b=p.applyChanges(g,!1);u.resolve(b.snapshot)}catch(d){const p=Ru(d,`Failed to execute query '${c} against cache`);u.reject(p)}})(await Cu(n),e,t))),t.promise}function Sj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,d,p,g){const b=new Ep({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x))),T.fromCache&&p.source==="server"?g.reject(new Ce(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(d,b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await yu(n),n.asyncQueue,e,t,s))),s.promise}function W6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{try{const o=await Ej(n);s.resolve((async function(u,d,p){const g=Ze(u),{request:b,gt:x,parent:T}=SS(g.serializer,Jk(d),p);g.connection.Ko||delete b.parent;const N=(await g.jo("RunAggregationQuery",g.serializer.databaseId,T,b,1)).filter((M=>!!M.result));pt(N.length===1,64727);const B=N[0].result?.aggregateFields;return Object.keys(B).reduce(((M,D)=>(M[x[D]]=B[D],M)),{})})(o,e,t))}catch(o){s.reject(o)}})),s.promise}function G6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>x6(await v0(n),e,t))),t.promise}function K6(n,e){const t=new Ep(e);return n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.add(c),c.next()})(await yu(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.delete(c)})(await yu(n),t)))}}function Q6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{const o=await Ej(n);new B6(n.asyncQueue,o,t,e,s).ju()})),s.promise}function Y6(n,e,t,s){const o=(function(u,d){let p;return p=typeof u=="string"?yS().encode(u):u,(function(b,x){return new L6(b,x)})((function(b,x){if(b instanceof Uint8Array)return mT(b,x);if(b instanceof ArrayBuffer)return mT(new Uint8Array(b),x);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(p),d)})(t,Yl(e));n.asyncQueue.enqueueAndForget((async()=>{M6(await v0(n),o,s)}))}function X6(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){const c=Ze(s);return c.persistence.runTransaction("Get named query","readonly",(u=>c.Pi.getNamedQuery(u,o)))})(await Cu(n),e)))}function jj(n,e){return(function(s,o){return new V6(s,o)})(n,e)}function J6(n,e){return n.asyncQueue.enqueue((async()=>(async function(s,o){const c=Ze(s),u=c.indexManager,d=[];return c.persistence.runTransaction("Configure indexes","readwrite",(p=>u.getFieldIndexes(p).next((g=>(function(x,T,N,B,M){x=[...x],T=[...T],x.sort(N),T.sort(N);const D=x.length,X=T.length;let H=0,J=0;for(;H<X&&J<D;){const he=N(x[J],T[H]);he<0?M(x[J++]):he>0?B(T[H++]):(H++,J++)}for(;H<X;)B(T[H++]);for(;J<D;)M(x[J++])})(g,o,OP,(b=>{d.push(u.addFieldIndex(p,b))}),(b=>{d.push(u.deleteFieldIndex(p,b))})))).next((()=>se.waitFor(d)))))})(await Cu(n),e)))}function Z6(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){Ze(s).Cs.As=o})(await Cu(n),e)))}function eL(n){return n.asyncQueue.enqueue((async()=>(function(t){const s=Ze(t),o=s.indexManager;return s.persistence.runTransaction("Delete All Indexes","readwrite",(c=>o.deleteAllFieldIndexes(c)))})(await Cu(n))))}function Nj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const tL="ComponentProvider",gT=new Map;function nL(n,e,t,s,o){return new yM(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Nj(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,s)}const Aj="firestore.googleapis.com",yT=!0;class bT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Aj,this.ssl=yT}else this.host=e.host,this.ssl=e.ssl??yT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=LS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<US)throw new Ce(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nj(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ce(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ce(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ce(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sd{constructor(e,t,s,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new jP;switch(s.type){case"firstParty":return new CP(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ce(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=gT.get(t);s&&(Oe(tL,"Removing Datastore"),gT.delete(t),s.terminate())})(this),Promise.resolve()}}function sL(n,e,t,s={}){n=bn(n,Sd);const o=Va(e),c=n._getSettings(),u={...c,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(np(`https://${d}`),hv("Firestore",!0)),c.host!==Aj&&c.host!==d&&xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...c,host:d,ssl:o,emulatorOptions:s};if(!Di(p,u)&&(n._setSettings(p),s.mockUserToken)){let g,b;if(typeof s.mockUserToken=="string")g=s.mockUserToken,b=rr.MOCK_USER;else{g=yE(s.mockUserToken,n._app?.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new Ce(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new rr(x)}n._authCredentials=new NP(new fk(g,b))}}class or{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new or(this.firestore,e,this._query)}}class ts{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ta(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Ql(t,ts._jsonSchema))return new ts(e,s||null,new Je(mn.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:Ws("string",ts._jsonSchemaVersion),referencePath:Ws("string")};class ta extends or{constructor(e,t,s){super(e,t,Eu(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new Je(e))}withConverter(e){return new ta(this.firestore,e,this._path)}}function qt(n,e,...t){if(n=Cn(n),jv("collection","path",e),n instanceof Sd){const s=mn.fromString(e,...t);return a2(s),new ta(n,null,s)}{if(!(n instanceof ts||n instanceof ta))throw new Ce(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(mn.fromString(e,...t));return a2(s),new ta(n.firestore,null,s)}}function VO(n,e){if(n=bn(n,Sd),jv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ce(ce.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new or(n,null,(function(s){return new Ua(mn.emptyPath(),s)})(e))}function Qe(n,e,...t){if(n=Cn(n),arguments.length===1&&(e=Sv.newId()),jv("doc","path",e),n instanceof Sd){const s=mn.fromString(e,...t);return i2(s),new ts(n,null,new Je(s))}{if(!(n instanceof ts||n instanceof ta))throw new Ce(ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(mn.fromString(e,...t));return i2(s),new ts(n.firestore,n instanceof ta?n.converter:null,new Je(s))}}function OO(n,e){return n=Cn(n),e=Cn(e),(n instanceof ts||n instanceof ta)&&(e instanceof ts||e instanceof ta)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Rj(n,e){return n=Cn(n),e=Cn(e),n instanceof or&&e instanceof or&&n.firestore===e.firestore&&xd(n._query,e._query)&&n.converter===e.converter}const vT="AsyncQueue";class xT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new t0(this,"async_queue_retry"),this._c=()=>{const s=_m();s&&Oe(vT,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=_m();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=_m();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ar;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ko(e))throw e;Oe(vT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Ms("INTERNAL UNHANDLED ERROR: ",_T(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=i0.createAndSchedule(this,e,t,s,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&ot(47125,{Pc:_T(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _T(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class rL{constructor(){this._progressObserver={},this._taskCompletionResolver=new ar,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const BO=-1;class as extends Sd{constructor(e,t,s,o){super(e,t,s,o),this.type="firestore",this._queue=new xT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xT(e),this._firestoreClient=void 0,await e}}}function UO(n,e,t){t||(t=td);const s=_u(n,"firestore");if(s.isInitialized(t)){const o=s.getImmediate({identifier:t}),c=s.getOptions(t);if(Di(c,e))return o;throw new Ce(ce.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ce(ce.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<US)throw new Ce(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Va(e.host)&&np(e.host),s.initialize({options:e,instanceIdentifier:t})}function iL(n,e){const t=typeof n=="object"?n:pv(),s=typeof n=="string"?n:e||td,o=_u(t,"firestore").getImmediate({identifier:s});if(!o._initialized){const c=mE("firestore");c&&sL(o,...c)}return o}function ws(n){if(n._terminated)throw new Ce(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Cj(n),n._firestoreClient}function Cj(n){const e=n._freezeSettings(),t=nL(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new U6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}function FO(n,e){xi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Ij(n,Ho.provider,{build:s=>new y0(s,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function zO(n){xi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Ij(n,Ho.provider,{build:t=>new _j(t,e.cacheSizeBytes)})}function Ij(n,e,t){if((n=bn(n,as))._firestoreClient||n._terminated)throw new Ce(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ce(ce.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Cj(n)}function qO(n){if(n._initialized&&!n._terminated)throw new Ce(ce.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ar;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!Zi.v())return Promise.resolve();const o=s+WS;await Zi.delete(o)})(Xv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function HO(n){return(function(t){const s=new ar;return t.asyncQueue.enqueueAndForget((async()=>E6(await v0(t),s))),s.promise})(ws(n=bn(n,as)))}function $O(n){return F6(ws(n=bn(n,as)))}function WO(n){return z6(ws(n=bn(n,as)))}function GO(n){return XI(n.app,"firestore",n._databaseId.database),n._delete()}function wT(n,e){const t=ws(n=bn(n,as)),s=new rL;return Y6(t,n._databaseId,e,s),s}function aL(n,e){return X6(ws(n=bn(n,as)),e).then((t=>t?new or(n,null,t.query):null))}class ei{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ei(Ns.fromBase64String(e))}catch(t){throw new Ce(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ei(Ns.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ei._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ql(e,ei._jsonSchema))return ei.fromBase64String(e.bytes)}}ei._jsonSchemaVersion="firestore/bytes/1.0",ei._jsonSchema={type:Ws("string",ei._jsonSchemaVersion),bytes:Ws("string")};class Iu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function KO(){return new Iu(Rb)}class Xl{constructor(e){this._methodName=e}}class na{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:na._jsonSchemaVersion}}static fromJSON(e){if(Ql(e,na._jsonSchema))return new na(e.latitude,e.longitude)}}na._jsonSchemaVersion="firestore/geoPoint/1.0",na._jsonSchema={type:Ws("string",na._jsonSchemaVersion),latitude:Ws("number"),longitude:Ws("number")};class bi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:bi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ql(e,bi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new bi(e.vectorValues);throw new Ce(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bi._jsonSchemaVersion="firestore/vectorValue/1.0",bi._jsonSchema={type:Ws("string",bi._jsonSchemaVersion),vectorValues:Ws("object")};const oL=/^__.*__$/;class lL{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new za(e,this.data,this.fieldMask,t,this.fieldTransforms):new ku(e,this.data,t,this.fieldTransforms)}}class Dj{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new za(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Pj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot(40011,{dataSource:n})}}class Sp{constructor(e,t,s,o,c,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePathSegment(e),s}childContextForFieldPath(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePath(),s}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Km(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Pj(this.dataSource)&&oL.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class cL{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Yl(e)}createContext(e,t,s,o=!1){return new Sp({dataSource:e,methodName:t,targetDoc:s,path:bs.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jl(n){const e=n._freezeSettings(),t=Yl(n._databaseId);return new cL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jp(n,e,t,s,o,c={}){const u=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);S0("Data must be an object, but it was:",u,s);const d=Vj(s,u);let p,g;if(c.merge)p=new Fr(u.fieldMask),g=u.fieldTransforms;else if(c.mergeFields){const b=[];for(const x of c.mergeFields){const T=La(e,x,t);if(!u.contains(T))throw new Ce(ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Bj(b,T)||b.push(T)}p=new Fr(b),g=u.fieldTransforms.filter((x=>p.covers(x.field)))}else p=null,g=u.fieldTransforms;return new lL(new ir(d),p,g)}class jd extends Xl{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jd}}function Mj(n,e,t){return new Sp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class x0 extends Xl{_toFieldTransform(e){return new wd(e.path,new cu)}isEqual(e){return e instanceof x0}}class _0 extends Xl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Mj(this,e,!0),s=this.Ac.map((c=>Zl(c,t))),o=new Ul(s);return new wd(e.path,o)}isEqual(e){return e instanceof _0&&Di(this.Ac,e.Ac)}}class w0 extends Xl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Mj(this,e,!0),s=this.Ac.map((c=>Zl(c,t))),o=new Fl(s);return new wd(e.path,o)}isEqual(e){return e instanceof w0&&Di(this.Ac,e.Ac)}}class T0 extends Xl{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new uu(e.serializer,oS(e.serializer,this.Vc));return new wd(e.path,t)}isEqual(e){return e instanceof T0&&this.Vc===e.Vc}}function E0(n,e,t,s){const o=n.createContext(1,e,t);S0("Data must be an object, but it was:",o,s);const c=[],u=ir.empty();Qo(s,((p,g)=>{const b=j0(e,p,t);g=Cn(g);const x=o.childContextForFieldPath(b);if(g instanceof jd)c.push(b);else{const T=Zl(g,x);T!=null&&(c.push(b),u.set(b,T))}}));const d=new Fr(c);return new Dj(u,d,o.fieldTransforms)}function k0(n,e,t,s,o,c){const u=n.createContext(1,e,t),d=[La(e,s,t)],p=[o];if(c.length%2!=0)throw new Ce(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<c.length;T+=2)d.push(La(e,c[T])),p.push(c[T+1]);const g=[],b=ir.empty();for(let T=d.length-1;T>=0;--T)if(!Bj(g,d[T])){const N=d[T];let B=p[T];B=Cn(B);const M=u.childContextForFieldPath(N);if(B instanceof jd)g.push(N);else{const D=Zl(B,M);D!=null&&(g.push(N),b.set(N,D))}}const x=new Fr(g);return new Dj(b,x,u.fieldTransforms)}function Lj(n,e,t,s=!1){return Zl(t,n.createContext(s?4:3,e))}function Zl(n,e){if(Oj(n=Cn(n)))return S0("Unsupported field value:",e,n),Vj(n,e);if(n instanceof Xl)return(function(s,o){if(!Pj(o.dataSource))throw o.createError(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${s._methodName}() is not currently supported inside arrays`);const c=s._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(s,o){const c=[];let u=0;for(const d of s){let p=Zl(d,o.childContextForArray(u));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),u++}return{arrayValue:{values:c}}})(n,e)}return(function(s,o){if((s=Cn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return oS(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const c=mt.fromDate(s);return{timestampValue:hu(o.serializer,c)}}if(s instanceof mt){const c=new mt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:hu(o.serializer,c)}}if(s instanceof na)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ei)return{bytesValue:xS(o.serializer,s._byteString)};if(s instanceof ts){const c=o.databaseId,u=s.firestore._databaseId;if(!u.isEqual(c))throw o.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:$v(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof bi)return(function(u,d){const p=u instanceof bi?u.toArray():u;return{mapValue:{fields:{[Pv]:{stringValue:Mv},[au]:{arrayValue:{values:p.map((b=>{if(typeof b!="number")throw d.createError("VectorValues must only contain numeric values.");return Bv(d.serializer,b)}))}}}}}})(s,o);if(CS(s))return s._toProto(o.serializer);throw o.createError(`Unsupported field value: ${ap(s)}`)})(n,e)}function Vj(n,e){const t={};return Pk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qo(n,((s,o)=>{const c=Zl(o,e.childContextForField(s));c!=null&&(t[s]=c)})),{mapValue:{fields:t}}}function Oj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof na||n instanceof ei||n instanceof ts||n instanceof Xl||n instanceof bi||CS(n))}function S0(n,e,t){if(!Oj(t)||!pk(t)){const s=ap(t);throw s==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+s)}}function La(n,e,t){if((e=Cn(e))instanceof Iu)return e._internalPath;if(typeof e=="string")return j0(n,e);throw Km("Field path arguments must be of type string or ",n,!1,void 0,t)}const uL=new RegExp("[~\\*/\\[\\]]");function j0(n,e,t){if(e.search(uL)>=0)throw Km(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Iu(...e.split("."))._internalPath}catch{throw Km(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Km(n,e,t,s,o){const c=s&&!s.isEmpty(),u=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(c||u)&&(p+=" (found",c&&(p+=` in field ${s}`),u&&(p+=` in document ${o}`),p+=")"),new Ce(ce.INVALID_ARGUMENT,d+n+p)}function Bj(n,e){return n.some((t=>t.isEqual(e)))}class Uj{convertValue(e,t="none"){switch(Uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ys(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ot(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Qo(e,((o,c)=>{s[o]=this.convertValue(c,t)})),s}convertVectorValue(e){const t=e.fields?.[au].arrayValue?.values?.map((s=>ys(s.doubleValue)));return new bi(t)}convertGeoPoint(e){return new na(ys(e.latitude),ys(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=dp(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ed(e));default:return null}}convertTimestamp(e){const t=Pa(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=mn.fromString(e);pt(RS(s),9688,{name:e});const o=new Vl(s.get(1),s.get(3)),c=new Je(s.popFirst(5));return o.isEqual(t)||Ms(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class Jo extends Uj{constructor(e){super(),this.firestore=e}convertBytes(e){return new ei(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}function QO(){return new jd("deleteField")}function yi(){return new x0("serverTimestamp")}function YO(...n){return new _0("arrayUnion",n)}function XO(...n){return new w0("arrayRemove",n)}function Nl(n){return new T0("increment",n)}function JO(n){return new bi(n)}function ZO(n){const e=ws(bn(n.firestore,as)),t=e._onlineComponents?.datastore.serializer;return t===void 0?null:yp(t,wr(n._query)).ft}function eB(n,e){const t=Dk(e,((c,u)=>new mS(u,c.aggregateType,c._internalFieldPath))),s=ws(bn(n.firestore,as)),o=s._onlineComponents?.datastore.serializer;return o===void 0?null:SS(o,Jk(n._query),t,!0).request}const TT="@firebase/firestore",ET="4.10.0";function Xc(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of s)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class od{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class hL{constructor(e,t,s){this._userDataWriter=t,this._data=s,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new ir({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class ld{constructor(e,t,s,o,c){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(La("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class dL extends ld{data(){return super.data()}}function Fj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class N0{}class Nd extends N0{}function Dn(n,e,...t){let s=[];e instanceof N0&&s.push(e),s=s.concat(t),(function(c){const u=c.filter((p=>p instanceof Du)).length,d=c.filter((p=>p instanceof Ad)).length;if(u>1||u>0&&d>0)throw new Ce(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)n=o._apply(n);return n}class Ad extends Nd{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Ad(e,t,s)}_apply(e){const t=this._parse(e);return qj(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t))}_parse(e){const t=Jl(e.firestore);return(function(c,u,d,p,g,b,x){let T;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ce(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){ST(x,b);const B=[];for(const M of x)B.push(kT(p,c,M));T={arrayValue:{values:B}}}else T=kT(p,c,x)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||ST(x,b),T=Lj(d,u,x,b==="in"||b==="not-in");return kn.create(g,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fn(n,e,t){const s=e,o=La("where",n);return Ad._create(o,s,t)}class Du extends N0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Du(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Qn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let u=o;const d=c.getFlattenedFilters();for(const p of d)qj(u,p),u=Fb(u,p)})(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function tB(...n){return n.forEach((e=>Hj("or",e))),Du._create("or",n)}function nB(...n){return n.forEach((e=>Hj("and",e))),Du._create("and",n)}class A0 extends Nd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new A0(e,t)}_apply(e){const t=(function(o,c,u){if(o.startAt!==null)throw new Ce(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Ce(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rd(c,u)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,RM(e._query,t))}}function Qm(n,e="asc"){const t=e,s=La("orderBy",n);return A0._create(s,t)}class Np extends Nd{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Np(e,t,s)}_apply(e){return new or(e.firestore,e.converter,Bm(e._query,this._limit,this._limitType))}}function Ym(n){return gk("limit",n),Np._create("limit",n,"F")}function sB(n){return gk("limitToLast",n),Np._create("limitToLast",n,"L")}class Ap extends Nd{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Ap(e,t,s)}_apply(e){const t=zj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,CM(e._query,t))}}function rB(...n){return Ap._create("startAt",n,!0)}function iB(...n){return Ap._create("startAfter",n,!1)}class Rp extends Nd{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Rp(e,t,s)}_apply(e){const t=zj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,IM(e._query,t))}}function aB(...n){return Rp._create("endBefore",n,!1)}function oB(...n){return Rp._create("endAt",n,!0)}function zj(n,e,t,s){if(t[0]=Cn(t[0]),t[0]instanceof ld)return(function(c,u,d,p,g){if(!p)throw new Ce(ce.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const b=[];for(const x of Qc(c))if(x.field.isKeyField())b.push(Ol(u,p.key));else{const T=p.data.field(x.field);if(hp(T))throw new Ce(ce.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const N=x.field.canonicalString();throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}b.push(T)}return new zo(b,g)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const o=Jl(n.firestore);return(function(u,d,p,g,b,x){const T=u.explicitOrderBy;if(b.length>T.length)throw new Ce(ce.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let B=0;B<b.length;B++){const M=b[B];if(T[B].field.isKeyField()){if(typeof M!="string")throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof M}`);if(!Vv(u)&&M.indexOf("/")!==-1)throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${M}' contains a slash.`);const D=u.path.child(mn.fromString(M));if(!Je.isDocumentKey(D))throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const X=new Je(D);N.push(Ol(d,X))}else{const D=Lj(p,g,M);N.push(D)}}return new zo(N,x)})(n._query,n.firestore._databaseId,o,e,t,s)}}function kT(n,e,t){if(typeof(t=Cn(t))=="string"){if(t==="")throw new Ce(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vv(e)&&t.indexOf("/")!==-1)throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(mn.fromString(t));if(!Je.isDocumentKey(s))throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Ol(n,new Je(s))}if(t instanceof ts)return Ol(n,t._key);throw new Ce(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ap(t)}.`)}function ST(n,e){if(!Array.isArray(n)||n.length===0)throw new Ce(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qj(n,e){const t=(function(o,c){for(const u of o)for(const d of u.getFlattenedFilters())if(c.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ce(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ce(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Hj(n,e){if(!(e instanceof Ad||e instanceof Du))throw new Ce(ce.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function Cp(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class R0 extends Uj{constructor(e){super(),this.firestore=e}convertBytes(e){return new ei(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}function lB(n){return new od("sum",La("sum",n))}function cB(n){return new od("avg",La("average",n))}function fL(){return new od("count")}function uB(n,e){return n instanceof od&&e instanceof od&&n.aggregateType===e.aggregateType&&n._internalFieldPath?.canonicalString()===e._internalFieldPath?.canonicalString()}function hB(n,e){return Rj(n.query,e.query)&&Di(n.data(),e.data())}function dB(n){return mL(n,{count:fL()})}function mL(n,e){const t=bn(n.firestore,as),s=ws(t),o=Dk(e,((c,u)=>new mS(u,c.aggregateType,c._internalFieldPath)));return W6(s,n._query,o).then((c=>(function(d,p,g){const b=new Jo(d);return new hL(p,b,g)})(t,n,c)))}class pL{constructor(e){this.kind="memory",this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new g0(void 0)}}toJSON(){return{kind:this.kind}}}class gL{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=_L(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class yL{constructor(){this.kind="memoryEager",this._offlineComponentProvider=gu.provider}toJSON(){return{kind:this.kind}}}class bL{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new g0(e)}}toJSON(){return{kind:this.kind}}}function fB(){return new yL}function mB(n){return new bL(n?.cacheSizeBytes)}function pB(n){return new pL(n)}function gB(n){return new gL(n)}class vL{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider={build:t=>new y0(t,e?.cacheSizeBytes,this.forceOwnership)}}}class xL{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ho.provider,this._offlineComponentProvider={build:t=>new _j(t,e?.cacheSizeBytes)}}}function _L(n){return new vL(n?.forceOwnership)}function yB(){return new xL}const $j="NOT SUPPORTED";class Ro{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ti extends ld{constructor(e,t,s,o,c,u){super(e,t,s,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(La("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ti._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}function bB(n,e,t){if(Ql(e,ti._jsonSchema)){if(e.bundle===$j)throw new Ce(ce.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Yl(n._databaseId),o=jj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const b of c)u.o(b);const d=u.documents;if(d.length!==1)throw new Ce(ce.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${d.length} documents.`);const p=gp(s,d[0].document),g=new Je(mn.fromString(e.bundleName));return new ti(n,new R0(n),g,p,new Ro(!1,!1),t||null)}}ti._jsonSchemaVersion="firestore/documentSnapshot/1.0",ti._jsonSchema={type:Ws("string",ti._jsonSchemaVersion),bundleSource:Ws("string","DocumentSnapshot"),bundleName:Ws("string"),bundle:Ws("string")};class wm extends ti{data(e={}){return super.data(e)}}class ni{constructor(e,t,s,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Ro(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new wm(this._firestore,this._userDataWriter,s.key,s,new Ro(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((d=>{const p=new wm(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ro(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>c||d.type!==3)).map((d=>{const p=new wm(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ro(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return d.type!==0&&(g=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),b=u.indexOf(d.doc.key)),{type:wL(d.type),doc:p,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ni._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vB(n,e,t){if(Ql(e,ni._jsonSchema)){if(e.bundle===$j)throw new Ce(ce.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Yl(n._databaseId),o=jj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const T of c)u.o(T);if(u.queries.length!==1)throw new Ce(ce.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${u.queries.length} queries.`);const d=bp(u.queries[0].bundledQuery),p=u.documents;let g=new Cl;p.map((T=>{const N=gp(s,T.document);g=g.add(N)}));const b=Wl.fromInitialDocuments(d,g,Zt(),!1,!1),x=new or(n,t||null,d);return new ni(n,new R0(n),x,b)}}function wL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot(61501,{type:n})}}function xB(n,e){return n instanceof ti&&e instanceof ti?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ni&&e instanceof ni&&n._firestore===e._firestore&&Rj(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}ni._jsonSchemaVersion="firestore/querySnapshot/1.0",ni._jsonSchema={type:Ws("string",ni._jsonSchemaVersion),bundleSource:Ws("string","QuerySnapshot"),bundleName:Ws("string"),bundle:Ws("string")};const TL={maxAttempts:5};class EL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Jl(e)}set(e,t,s){this._verifyNotCommitted();const o=Co(e,this._firestore),c=Cp(o.converter,t,s),u=jp(this._dataReader,"WriteBatch.set",o._key,c,o.converter!==null,s);return this._mutations.push(u.toMutation(o._key,vs.none())),this}update(e,t,s,...o){this._verifyNotCommitted();const c=Co(e,this._firestore);let u;return u=typeof(t=Cn(t))=="string"||t instanceof Iu?k0(this._dataReader,"WriteBatch.update",c._key,t,s,o):E0(this._dataReader,"WriteBatch.update",c._key,t),this._mutations.push(u.toMutation(c._key,vs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Co(e,this._firestore);return this._mutations=this._mutations.concat(new Su(t._key,vs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ce(ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Co(n,e){if((n=Cn(n)).firestore!==e)throw new Ce(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class kL{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jl(e)}get(e){const t=Co(e,this._firestore),s=new R0(this._firestore);return this._transaction.lookup([t._key]).then((o=>{if(!o||o.length!==1)return ot(24041);const c=o[0];if(c.isFoundDocument())return new ld(this._firestore,s,c.key,c,t.converter);if(c.isNoDocument())return new ld(this._firestore,s,t._key,null,t.converter);throw ot(18433,{doc:c})}))}set(e,t,s){const o=Co(e,this._firestore),c=Cp(o.converter,t,s),u=jp(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,s);return this._transaction.set(o._key,u),this}update(e,t,s,...o){const c=Co(e,this._firestore);let u;return u=typeof(t=Cn(t))=="string"||t instanceof Iu?k0(this._dataReader,"Transaction.update",c._key,t,s,o):E0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,u),this}delete(e){const t=Co(e,this._firestore);return this._transaction.delete(t._key),this}}class SL extends kL{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Co(e,this._firestore),s=new Jo(this._firestore);return super.get(e).then((o=>new ti(this._firestore,s,t._key,o._document,new Ro(!1,!1),t.converter)))}}function _B(n,e,t){n=bn(n,as);const s={...TL,...t};(function(u){if(u.maxAttempts<1)throw new Ce(ce.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s);const o=ws(n);return Q6(o,(c=>e(new SL(n,c))),s)}function Vn(n){n=bn(n,ts);const e=bn(n.firestore,as),t=ws(e);return kj(t,n._key).then((s=>C0(e,n,s)))}function wB(n){n=bn(n,ts);const e=bn(n.firestore,as),t=ws(e),s=new Jo(e);return H6(t,n._key).then((o=>new ti(e,s,n._key,o,new Ro(o!==null&&o.hasLocalMutations,!0),n.converter)))}function TB(n){n=bn(n,ts);const e=bn(n.firestore,as),t=ws(e);return kj(t,n._key,{source:"server"}).then((s=>C0(e,n,s)))}function An(n){n=bn(n,or);const e=bn(n.firestore,as),t=ws(e),s=new Jo(e);return Fj(n._query),Sj(t,n._query).then((o=>new ni(e,s,n,o)))}function EB(n){n=bn(n,or);const e=bn(n.firestore,as),t=ws(e),s=new Jo(e);return $6(t,n._query).then((o=>new ni(e,s,n,o)))}function kB(n){n=bn(n,or);const e=bn(n.firestore,as),t=ws(e),s=new Jo(e);return Sj(t,n._query,{source:"server"}).then((o=>new ni(e,s,n,o)))}function Kn(n,e,t){n=bn(n,ts);const s=bn(n.firestore,as),o=Cp(n.converter,e,t),c=Jl(s);return Rd(s,[jp(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,vs.none())])}function Ea(n,e,t,...s){n=bn(n,ts);const o=bn(n.firestore,as),c=Jl(o);let u;return u=typeof(e=Cn(e))=="string"||e instanceof Iu?k0(c,"updateDoc",n._key,e,t,s):E0(c,"updateDoc",n._key,e),Rd(o,[u.toMutation(n._key,vs.exists(!0))])}function Ar(n){return Rd(bn(n.firestore,as),[new Su(n._key,vs.none())])}function Ra(n,e){const t=bn(n.firestore,as),s=Qe(n),o=Cp(n.converter,e),c=Jl(n.firestore);return Rd(t,[jp(c,"addDoc",s._key,o,n.converter!==null,{}).toMutation(s._key,vs.exists(!1))]).then((()=>s))}function Xm(n,...e){n=Cn(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Xc(e[s])||(t=e[s++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Xc(e[s])){const g=e[s];e[s]=g.next?.bind(g),e[s+1]=g.error?.bind(g),e[s+2]=g.complete?.bind(g)}let c,u,d;if(n instanceof ts)u=bn(n.firestore,as),d=Eu(n._key.path),c={next:g=>{e[s]&&e[s](C0(u,n,g))},error:e[s+1],complete:e[s+2]};else{const g=bn(n,or);u=bn(g.firestore,as),d=g._query;const b=new Jo(u);c={next:x=>{e[s]&&e[s](new ni(u,b,g,x))},error:e[s+1],complete:e[s+2]},Fj(n._query)}const p=ws(u);return q6(p,d,o,c)}function SB(n,e,...t){const s=Cn(n),o=(function(p){const g={bundle:"",bundleName:"",bundleSource:""},b=["bundle","bundleName","bundleSource"];for(const x of b){if(!(x in p)){g.error=`snapshotJson missing required field: ${x}`;break}const T=p[x];if(typeof T!="string"){g.error=`snapshotJson field '${x}' must be a string.`;break}if(T.length===0){g.error=`snapshotJson field '${x}' cannot be an empty string.`;break}x==="bundle"?g.bundle=T:x==="bundleName"?g.bundleName=T:x==="bundleSource"&&(g.bundleSource=T)}return g})(e);if(o.error)throw new Ce(ce.INVALID_ARGUMENT,o.error);let c,u=0;if(typeof t[u]!="object"||Xc(t[u])||(c=t[u++]),o.bundleSource==="QuerySnapshot"){let d=null;if(typeof t[u]=="object"&&Xc(t[u])){const p=t[u++];d={next:p.next,error:p.error,complete:p.complete}}else d={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,M=!1;return wT(g,b.bundle).then((()=>aL(g,b.bundleName))).then((X=>{X&&!M&&(N&&X.withConverter(N),B=Xm(X,x||{},T))})).catch((X=>(T.error&&T.error(X),()=>{}))),()=>{M||(M=!0,B&&B())}})(s,o,c,d,t[u])}if(o.bundleSource==="DocumentSnapshot"){let d=null;if(typeof t[u]=="object"&&Xc(t[u])){const p=t[u++];d={next:p.next,error:p.error,complete:p.complete}}else d={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,M=!1;return wT(g,b.bundle).then((()=>{if(!M){const X=new ts(g,N||null,Je.fromPath(b.bundleName));B=Xm(X,x||{},T)}})).catch((X=>(T.error&&T.error(X),()=>{}))),()=>{M||(M=!0,B&&B())}})(s,o,c,d,t[u])}throw new Ce(ce.INVALID_ARGUMENT,`unsupported bundle source: ${o.bundleSource}`)}function jB(n,e){n=bn(n,as);const t=ws(n),s=Xc(e)?e:{next:e};return K6(t,s)}function Rd(n,e){const t=ws(n);return G6(t,e)}function C0(n,e,t){const s=t.docs.get(e._key),o=new Jo(n);return new ti(n,o,e._key,s,new Ro(t.hasPendingWrites,t.fromCache),e.converter)}function jT(n){return n=bn(n,as),ws(n),new EL(n,(e=>Rd(n,e)))}function NB(n,e){n=bn(n,as);const t=ws(n);if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return xi("Cannot enable indexes when persistence is disabled"),Promise.resolve();const s=(function(c){const u=typeof c=="string"?(function(g){try{return JSON.parse(g)}catch(b){throw new Ce(ce.INVALID_ARGUMENT,"Failed to parse JSON: "+b?.message)}})(c):c,d=[];if(Array.isArray(u.indexes))for(const p of u.indexes){const g=NT(p,"collectionGroup"),b=[];if(Array.isArray(p.fields))for(const x of p.fields){const T=NT(x,"fieldPath"),N=j0("setIndexConfiguration",T);x.arrayConfig==="CONTAINS"?b.push(new Al(N,2)):x.order==="ASCENDING"?b.push(new Al(N,0)):x.order==="DESCENDING"&&b.push(new Al(N,1))}d.push(new eu(eu.UNKNOWN_ID,g,b,tu.empty()))}return d})(e);return J6(t,s)}function NT(n,e){if(typeof n[e]!="string")throw new Ce(ce.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}class jL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function AB(n){n=bn(n,as);const e=AT.get(n);if(e)return e;if(ws(n)._uninitializedComponentsProvider?._offline.kind!=="persistent")return null;const s=new jL(n);return AT.set(n,s),s}function RB(n){Wj(n,!0)}function CB(n){Wj(n,!1)}function IB(n){const e=ws(n._firestore);eL(e).then((t=>Oe("deleting all persistent cache indexes succeeded"))).catch((t=>xi("deleting all persistent cache indexes failed",t)))}function Wj(n,e){const t=ws(n._firestore);Z6(t,e).then((s=>Oe(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((s=>xi(`setting persistent cache index auto creation isEnabled=${e} failed`,s)))}const AT=new WeakMap;class DB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return I0.instance.onExistenceFilterMismatch(e)}}class I0{constructor(){this.i=new Map}static get instance(){return Xf||(Xf=new I0,$M(Xf)),Xf}u(e){this.i.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),s=this.i;return s.set(t,e),()=>s.delete(t)}}let Xf=null;(function(e,t=!0){SP(Kl),Pl(new Oo("firestore",((s,{instanceIdentifier:o,options:c})=>{const u=s.getProvider("app").getImmediate(),d=new as(new AP(s.getProvider("auth-internal")),new IP(u,s.getProvider("app-check-internal")),bM(u,o),u);return c={useFetchStreams:t,...c},d._setSettings(c),d}),"PUBLIC").setMultipleInstances(!0)),Yi(TT,ET,e),Yi(TT,ET,"esm2020")})();var NL="firebase",AL="12.8.0";Yi(NL,AL,"app");const Gj="firebasestorage.googleapis.com",Kj="storageBucket",RL=120*1e3,CL=600*1e3;class Rs extends ia{constructor(e,t,s=0){super(Jy(e),`Firebase Storage: ${t} (${Jy(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var As;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(As||(As={}));function Jy(n){return"storage/"+n}function D0(){const n="An unknown error occurred, please check the error payload for server response.";return new Rs(As.UNKNOWN,n)}function IL(n){return new Rs(As.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function DL(n){return new Rs(As.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function PL(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rs(As.UNAUTHENTICATED,n)}function ML(){return new Rs(As.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function LL(n){return new Rs(As.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function VL(){return new Rs(As.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OL(){return new Rs(As.CANCELED,"User canceled the upload/download.")}function BL(n){return new Rs(As.INVALID_URL,"Invalid URL '"+n+"'.")}function UL(n){return new Rs(As.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FL(){return new Rs(As.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Kj+"' property when initializing the app?")}function zL(){return new Rs(As.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qL(){return new Rs(As.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function HL(n){return new Rs(As.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tv(n){return new Rs(As.INVALID_ARGUMENT,n)}function Qj(){return new Rs(As.APP_DELETED,"The Firebase app was deleted.")}function $L(n){return new Rs(As.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Hh(n,e){return new Rs(As.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function kh(n){throw new Rs(As.INTERNAL_ERROR,"Internal error: "+n)}class Rr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Rr.makeFromUrl(e,t)}catch{return new Rr(e,"")}if(s.path==="")return s;throw UL(e)}static makeFromUrl(e,t){let s=null;const o="([A-Za-z0-9.\\-_]+)";function c(he){he.path.charAt(he.path.length-1)==="/"&&(he.path_=he.path_.slice(0,-1))}const u="(/(.*))?$",d=new RegExp("^gs://"+o+u,"i"),p={bucket:1,path:3};function g(he){he.path_=decodeURIComponent(he.path)}const b="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",N=new RegExp(`^https?://${x}/${b}/b/${o}/o${T}`,"i"),B={bucket:1,path:3},M=t===Gj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,D="([^?#]*)",X=new RegExp(`^https?://${M}/${o}/${D}`,"i"),J=[{regex:d,indices:p,postModify:c},{regex:N,indices:B,postModify:g},{regex:X,indices:{bucket:1,path:2},postModify:g}];for(let he=0;he<J.length;he++){const Ne=J[he],Te=Ne.regex.exec(e);if(Te){const C=Te[Ne.indices.bucket];let S=Te[Ne.indices.path];S||(S=""),s=new Rr(C,S),Ne.postModify(s);break}}if(s==null)throw BL(e);return s}}class WL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function GL(n,e,t){let s=1,o=null,c=null,u=!1,d=0;function p(){return d===2}let g=!1;function b(...D){g||(g=!0,e.apply(null,D))}function x(D){o=setTimeout(()=>{o=null,n(N,p())},D)}function T(){c&&clearTimeout(c)}function N(D,...X){if(g){T();return}if(D){T(),b.call(null,D,...X);return}if(p()||u){T(),b.call(null,D,...X);return}s<64&&(s*=2);let J;d===1?(d=2,J=0):J=(s+Math.random())*1e3,x(J)}let B=!1;function M(D){B||(B=!0,T(),!g&&(o!==null?(D||(d=2),clearTimeout(o),x(0)):D||(d=1)))}return x(0),c=setTimeout(()=>{u=!0,M(!0)},t),M}function KL(n){n(!1)}function QL(n){return n!==void 0}function YL(n){return typeof n=="object"&&!Array.isArray(n)}function P0(n){return typeof n=="string"||n instanceof String}function RT(n){return M0()&&n instanceof Blob}function M0(){return typeof Blob<"u"}function nv(n,e,t,s){if(s<e)throw tv(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw tv(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ip(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function Yj(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const o=e(s)+"="+e(n[s]);t=t+o+"&"}return t=t.slice(0,-1),t}var Il;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Il||(Il={}));function XL(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class JL{constructor(e,t,s,o,c,u,d,p,g,b,x,T=!0,N=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=u,this.callback_=d,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=x,this.retry=T,this.isUsingEmulator=N,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,M)=>{this.resolve_=B,this.reject_=M,this.start_()})}start_(){const e=(s,o)=>{if(o){s(!1,new Jf(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const u=d=>{const p=d.loaded,g=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(u),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(u),this.pendingConnection_=null;const d=c.getErrorCode()===Il.NO_ERROR,p=c.getStatus();if(!d||XL(p,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===Il.ABORT;s(!1,new Jf(!1,null,b));return}const g=this.successCodes_.indexOf(p)!==-1;s(!0,new Jf(g,c))})},t=(s,o)=>{const c=this.resolve_,u=this.reject_,d=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(d,d.getResponse());QL(p)?c(p):c()}catch(p){u(p)}else if(d!==null){const p=D0();p.serverResponse=d.getErrorText(),this.errorCallback_?u(this.errorCallback_(d,p)):u(p)}else if(o.canceled){const p=this.appDelete_?Qj():OL();u(p)}else{const p=VL();u(p)}};this.canceled_?t(!1,new Jf(!1,null,!0)):this.backoffId_=GL(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Jf{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function ZL(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function eV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function nV(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function sV(n,e,t,s,o,c,u=!0,d=!1){const p=Yj(n.urlParams),g=n.url+p,b=Object.assign({},n.headers);return tV(b,e),ZL(b,t),eV(b,c),nV(b,s),new JL(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,u,d)}function rV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function iV(...n){const e=rV();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(M0())return new Blob(n);throw new Rs(As.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function aV(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function oV(n){if(typeof atob>"u")throw HL("base-64");return atob(n)}const Qi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zy{constructor(e,t){this.data=e,this.contentType=t||null}}function lV(n,e){switch(n){case Qi.RAW:return new Zy(Xj(e));case Qi.BASE64:case Qi.BASE64URL:return new Zy(Jj(n,e));case Qi.DATA_URL:return new Zy(uV(e),hV(e))}throw D0()}function Xj(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=s,u=n.charCodeAt(++t);s=65536|(c&1023)<<10|u&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function cV(n){let e;try{e=decodeURIComponent(n)}catch{throw Hh(Qi.DATA_URL,"Malformed data URL.")}return Xj(e)}function Jj(n,e){switch(n){case Qi.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw Hh(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Qi.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw Hh(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=oV(e)}catch(o){throw o.message.includes("polyfill")?o:Hh(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s}class Zj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Hh(Qi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=dV(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function uV(n){const e=new Zj(n);return e.base64?Jj(Qi.BASE64,e.rest):cV(e.rest)}function hV(n){return new Zj(n).contentType}function dV(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class No{constructor(e,t){let s=0,o="";RT(e)?(this.data_=e,s=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(RT(this.data_)){const s=this.data_,o=aV(s,e,t);return o===null?null:new No(o)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new No(s,!0)}}static getBlob(...e){if(M0()){const t=e.map(s=>s instanceof No?s.data_:s);return new No(iV.apply(null,t))}else{const t=e.map(u=>P0(u)?lV(Qi.RAW,u).data:u.data_);let s=0;t.forEach(u=>{s+=u.byteLength});const o=new Uint8Array(s);let c=0;return t.forEach(u=>{for(let d=0;d<u.length;d++)o[c++]=u[d]}),new No(o,!0)}}uploadData(){return this.data_}}function L0(n){let e;try{e=JSON.parse(n)}catch{return null}return YL(e)?e:null}function fV(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function mV(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function eN(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function pV(n,e){return e}class Nr{constructor(e,t,s,o){this.server=e,this.local=t||e,this.writable=!!s,this.xform=o||pV}}let Zf=null;function gV(n){return!P0(n)||n.length<2?n:eN(n)}function tN(){if(Zf)return Zf;const n=[];n.push(new Nr("bucket")),n.push(new Nr("generation")),n.push(new Nr("metageneration")),n.push(new Nr("name","fullPath",!0));function e(c,u){return gV(u)}const t=new Nr("name");t.xform=e,n.push(t);function s(c,u){return u!==void 0?Number(u):u}const o=new Nr("size");return o.xform=s,n.push(o),n.push(new Nr("timeCreated")),n.push(new Nr("updated")),n.push(new Nr("md5Hash",null,!0)),n.push(new Nr("cacheControl",null,!0)),n.push(new Nr("contentDisposition",null,!0)),n.push(new Nr("contentEncoding",null,!0)),n.push(new Nr("contentLanguage",null,!0)),n.push(new Nr("contentType",null,!0)),n.push(new Nr("metadata","customMetadata",!0)),Zf=n,Zf}function yV(n,e){function t(){const s=n.bucket,o=n.fullPath,c=new Rr(s,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function bV(n,e,t){const s={};s.type="file";const o=t.length;for(let c=0;c<o;c++){const u=t[c];s[u.local]=u.xform(s,e[u.server])}return yV(s,n),s}function nN(n,e,t){const s=L0(e);return s===null?null:bV(n,s,t)}function vV(n,e,t,s){const o=L0(e);if(o===null||!P0(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const u=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,x=n.fullPath,T="/b/"+u(b)+"/o/"+u(x),N=Ip(T,t,s),B=Yj({alt:"media",token:g});return N+B})[0]}function xV(n,e){const t={},s=e.length;for(let o=0;o<s;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}const CT="prefixes",IT="items";function _V(n,e,t){const s={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[CT])for(const o of t[CT]){const c=o.replace(/\/$/,""),u=n._makeStorageReference(new Rr(e,c));s.prefixes.push(u)}if(t[IT])for(const o of t[IT]){const c=n._makeStorageReference(new Rr(e,o.name));s.items.push(c)}return s}function wV(n,e,t){const s=L0(t);return s===null?null:_V(n,e,s)}class V0{constructor(e,t,s,o){this.url=e,this.method=t,this.handler=s,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function O0(n){if(!n)throw D0()}function TV(n,e){function t(s,o){const c=nN(n,o,e);return O0(c!==null),c}return t}function EV(n,e){function t(s,o){const c=wV(n,e,o);return O0(c!==null),c}return t}function kV(n,e){function t(s,o){const c=nN(n,o,e);return O0(c!==null),vV(c,o,n.host,n._protocol)}return t}function B0(n){function e(t,s){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=ML():o=PL():t.getStatus()===402?o=DL(n.bucket):t.getStatus()===403?o=LL(n.path):o=s,o.status=t.getStatus(),o.serverResponse=s.serverResponse,o}return e}function SV(n){const e=B0(n);function t(s,o){let c=e(s,o);return s.getStatus()===404&&(c=IL(n.path)),c.serverResponse=o.serverResponse,c}return t}function jV(n,e,t,s,o){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",t.length>0&&(c.delimiter=t),s&&(c.pageToken=s),o&&(c.maxResults=o);const u=e.bucketOnlyServerUrl(),d=Ip(u,n.host,n._protocol),p="GET",g=n.maxOperationRetryTime,b=new V0(d,p,EV(n,e.bucket),g);return b.urlParams=c,b.errorHandler=B0(e),b}function NV(n,e,t){const s=e.fullServerUrl(),o=Ip(s,n.host,n._protocol),c="GET",u=n.maxOperationRetryTime,d=new V0(o,c,kV(n,t),u);return d.errorHandler=SV(e),d}function AV(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function RV(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=AV(null,e)),s}function CV(n,e,t,s,o){const c=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function d(){let J="";for(let he=0;he<2;he++)J=J+Math.random().toString().slice(2);return J}const p=d();u["Content-Type"]="multipart/related; boundary="+p;const g=RV(e,s,o),b=xV(g,t),x="--"+p+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+p+`\r
Content-Type: `+g.contentType+`\r
\r
`,T=`\r
--`+p+"--",N=No.getBlob(x,s,T);if(N===null)throw zL();const B={name:g.fullPath},M=Ip(c,n.host,n._protocol),D="POST",X=n.maxUploadRetryTime,H=new V0(M,D,TV(n,t),X);return H.urlParams=B,H.headers=u,H.body=N.uploadData(),H.errorHandler=B0(e),H}class IV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Il.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Il.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Il.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,o,c){if(this.sent_)throw kh("cannot .send() more than once");if(Va(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const u in c)c.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,c[u].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw kh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw kh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw kh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw kh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class DV extends IV{initXhr(){this.xhr_.responseType="text"}}function U0(){return new DV}class Gl{constructor(e,t){this._service=e,t instanceof Rr?this._location=t:this._location=Rr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Gl(e,t)}get root(){const e=new Rr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return eN(this._location.path)}get storage(){return this._service}get parent(){const e=fV(this._location.path);if(e===null)return null;const t=new Rr(this._location.bucket,e);return new Gl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $L(e)}}function PV(n,e,t){n._throwIfRoot("uploadBytes");const s=CV(n.storage,n._location,tN(),new No(e,!0),t);return n.storage.makeRequestWithTokens(s,U0).then(o=>({metadata:o,ref:n}))}function MV(n){const e={prefixes:[],items:[]};return sN(n,e).then(()=>e)}async function sN(n,e,t){const o=await LV(n,{pageToken:t});e.prefixes.push(...o.prefixes),e.items.push(...o.items),o.nextPageToken!=null&&await sN(n,e,o.nextPageToken)}function LV(n,e){e!=null&&typeof e.maxResults=="number"&&nv("options.maxResults",1,1e3,e.maxResults);const t=e||{},s=jV(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(s,U0)}function VV(n){n._throwIfRoot("getDownloadURL");const e=NV(n.storage,n._location,tN());return n.storage.makeRequestWithTokens(e,U0).then(t=>{if(t===null)throw qL();return t})}function OV(n,e){const t=mV(n._location.path,e),s=new Rr(n._location.bucket,t);return new Gl(n.storage,s)}function BV(n){return/^[A-Za-z]+:\/\//.test(n)}function UV(n,e){return new Gl(n,e)}function rN(n,e){if(n instanceof F0){const t=n;if(t._bucket==null)throw FL();const s=new Gl(t,t._bucket);return e!=null?rN(s,e):s}else return e!==void 0?OV(n,e):n}function FV(n,e){if(e&&BV(e)){if(n instanceof F0)return UV(n,e);throw tv("To use ref(service, url), the first argument must be a Storage instance.")}else return rN(n,e)}function DT(n,e){const t=e?.[Kj];return t==null?null:Rr.makeFromBucketSpec(t,n)}function zV(n,e,t,s={}){n.host=`${e}:${t}`;const o=Va(e);o&&(np(`https://${n.host}/b`),hv("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=s;c&&(n._overrideAuthToken=typeof c=="string"?c:yE(c,n.app.options.projectId))}class F0{constructor(e,t,s,o,c,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=u,this._bucket=null,this._host=Gj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RL,this._maxUploadRetryTime=CL,this._requests=new Set,o!=null?this._bucket=Rr.makeFromBucketSpec(o,this._host):this._bucket=DT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Rr.makeFromBucketSpec(this._url,e):this._bucket=DT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gl(this,e)}_makeRequest(e,t,s,o,c=!0){if(this._deleted)return new WL(Qj());{const u=sV(e,this._appId,s,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,o).getPromise()}}const PT="@firebase/storage",MT="0.14.0";const iN="storage";function eb(n,e,t){return n=Cn(n),PV(n,e,t)}function LT(n){return n=Cn(n),MV(n)}function Dl(n){return n=Cn(n),VV(n)}function Io(n,e){return n=Cn(n),FV(n,e)}function qV(n=pv(),e){n=Cn(n);const s=_u(n,iN).getImmediate({identifier:e}),o=mE("storage");return o&&HV(s,...o),s}function HV(n,e,t,s={}){zV(n,e,t,s)}function $V(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new F0(t,s,o,e,Kl)}function WV(){Pl(new Oo(iN,$V,"PUBLIC").setMultipleInstances(!0)),Yi(PT,MT,""),Yi(PT,MT,"esm2020")}WV();const aN={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},z0=mv(aN),gl=ik(z0),_e=iL(z0),Do=qV(z0),GV=mv(aN,"secondary"),PB=ik(GV),KV="EYdciKDOi3UYBLk1u8hHams5tmO2",oN=_.createContext();function ii(){return _.useContext(oN)}function QV({children:n}){const[e,t]=_.useState(null),[s,o]=_.useState(!1),[c,u]=_.useState(!1),[d,p]=_.useState(null),[g,b]=_.useState(!0);_.useEffect(()=>{let H=null;const J=mD(gl,he=>{if(t(he),H&&(H(),H=null),he)if(he.uid===KV)o(!0),u(!1),p(null),b(!1);else{o(!1);const Ne=Dn(qt(_e,"clients"),fn("uid","==",he.uid)),Te=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const S=await Vn(Qe(_e,"clients",C));S.exists()&&(u(!0),p({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};H=Xm(Ne,async C=>{if(C.empty)await Te();else{const S=C.docs[0];u(!0),p({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async C=>{console.error("Error listening to client data:",C),await Te(),b(!1)})}else o(!1),u(!1),p(null),b(!1)});return()=>{J(),H&&H()}},[]);const X={currentUser:e,isAdmin:s,isClient:c,clientData:d,updateClientData:H=>{p(J=>J?{...J,...H}:H)},resolveClient:async()=>{if(d)return d;const H=localStorage.getItem("mcf_clientId");if(H)try{const J=await Vn(Qe(_e,"clients",H));if(J.exists()){const he={id:J.id,...J.data()};return u(!0),p(he),he}}catch(J){console.error("resolveClient direct read failed:",J)}if(e){const J=Dn(qt(_e,"clients"),fn("uid","==",e.uid)),he=await An(J);if(!he.empty){const Ne={id:he.docs[0].id,...he.docs[0].data()};return u(!0),p(Ne),Ne}}return null},login:async(H,J,he=!0)=>(await Kw(gl,he?kb:wv),await hD(gl,H,J)),signup:async(H,J,he)=>{await Kw(gl,kb);const Ne=await uD(gl,J.trim().toLowerCase(),he),Te=Ne.user,C=Qe(qt(_e,"clients")),S={uid:Te.uid,name:H.trim(),email:J.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:mt.now()};await Kn(C,S),u(!0),p({id:C.id,...S});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Ne},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return pD(gl)},resetPassword:H=>cD(gl,H),loading:g};return a.jsx(oN.Provider,{value:X,children:n})}const lN=_.createContext();function Vi(){return _.useContext(lN)}function YV({children:n}){const[e,t]=_.useState(()=>{const p=localStorage.getItem("theme");return p?p==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[s,o]=_.useState(()=>localStorage.getItem("accent")||"red");_.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),_.useEffect(()=>{localStorage.setItem("accent",s)},[s]);const d={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:s,setAccent:p=>o(p)};return a.jsx(lN.Provider,{value:d,children:n})}const cN=_.createContext();function Dp(){return _.useContext(cN)}const XV=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],JV=[5,10],ZV=1;function e5({children:n}){const{clientData:e}=ii(),t=_.useMemo(()=>{const s=e?.tier||"free",o=e?.subscriptionStatus||null,c=e&&e.signupSource!=="self_signup",u=s==="premium"||!!c;function d(p){return u?!0:!XV.includes(p)}return{tier:s,subscriptionStatus:o,isPremium:u,canAccess:d,FREE_RANDOMISER_DURATIONS:JV,FREE_RANDOMISER_WEEKLY_LIMIT:ZV}},[e?.tier,e?.subscriptionStatus,e?.signupSource]);return a.jsx(cN.Provider,{value:t,children:n})}function t5(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function n5({className:n=""}){const{isDark:e,toggleTheme:t}=Vi();return a.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function s5(){const[n,e]=_.useState(""),[t,s]=_.useState(""),[o,c]=_.useState(!0),[u,d]=_.useState(""),[p,g]=_.useState(!1),[b,x]=_.useState(!1),[T,N]=_.useState(!1),{login:B,resetPassword:M,currentUser:D,isAdmin:X,isClient:H,clientData:J,loading:he}=ii(),Ne=gr();if(_.useEffect(()=>{!he&&D&&(X?Ne("/dashboard"):H?Ne(t5(J)):(g(!1),d("No account found. Please sign up or contact your trainer.")))},[he,D,X,H,J,Ne]),he)return null;const Te=async S=>{S.preventDefault(),d(""),g(!0);try{await B(n,t,o)}catch(P){d(P.message||"Failed to log in"),g(!1)}},C=async S=>{if(S.preventDefault(),d(""),!n.trim()){d("Please enter your email address");return}g(!0);try{await M(n.trim()),N(!0)}catch(P){P.code==="auth/user-not-found"?d("No account found with this email"):d(P.message||"Failed to send reset email")}g(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(n5,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),u&&a.jsx("div",{className:"error-message",children:u}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{x(!1),N(!1),d("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:p,children:p?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!1),d("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Te,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>s(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>c(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:p,children:p?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!0),d("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>Ne("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function yl({feature:n,children:e}){const{canAccess:t}=Dp(),s=gr();return t(n)?e:a.jsxs("div",{className:"locked-feature-wrap",children:[a.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),a.jsx("div",{className:"locked-feature-overlay",children:a.jsxs("div",{className:"locked-feature-card",children:[a.jsx("div",{className:"locked-icon",children:a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("h2",{children:"Premium Feature"}),a.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),a.jsx("button",{className:"locked-upgrade-btn",onClick:()=>s("/upgrade"),children:"Upgrade Now"})]})})]})}function ra({active:n}){const e=gr(),{clientData:t}=ii(),{isPremium:s}=Dp(),o=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/nutrition":"/upgrade"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/buddies":"/upgrade"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),o&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Cd(n,e,t,s,o){const c=[];for(let u=0;u<n;u++){const d=(u*(360/n)-90)*(Math.PI/180);c.push({x1:e+s*Math.cos(d),y1:t+s*Math.sin(d),x2:e+o*Math.cos(d),y2:t+o*Math.sin(d),thick:u%5===0})}return c}const q0=Cd(60,100,100,85,96),$h=Cd(60,100,100,78,94),r5=Cd(60,100,100,82,94);Cd(60,50,50,38,46);const i5=Cd(60,40,40,30,37),a5="/login/assets/first_workout-B8SFkzJX.PNG",o5="/login/assets/workouts_10-Z5R3u0xH.PNG",l5="/login/assets/workouts_25-CzxSlcAj.PNG",c5="/login/assets/workouts_50-BpzWup3V.PNG",u5="/login/assets/workouts_100-D7_r6tn1.PNG",h5="/login/assets/streak_2-CsRr-XA9.PNG",d5="/login/assets/streak_4-BHO09tbw.PNG",f5="/login/assets/streak_8-DX2UWMko.PNG",m5="/login/assets/first_pb-aVf_CNWy.PNG",p5="/login/assets/pbs_5-Cippawgg.PNG",g5="/login/assets/pbs_10-CZgGh9Kv.PNG",y5="/login/assets/pbs_100-C67b1wfS.PNG",b5="/login/assets/nutrition_7-CHVV11fj.PNG",v5="/login/assets/leaderboard_join-BLoId4Hz.PNG",x5="/login/assets/habits_7-Dvki70KO.PNG",Jm=[{id:"first_workout",img:a5,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:o5,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:l5,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:c5,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:u5,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:h5,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:d5,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:f5,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:m5,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:p5,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:g5,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:y5,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:b5,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:v5,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:x5,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function _5({steps:n,onFinish:e,active:t}){const[s,o]=_.useState(0),[c,u]=_.useState(null),[d,p]=_.useState("below"),[g,b]=_.useState(!1),x=_.useRef(null),T=_.useRef(t);T.current=t,_.useEffect(()=>{t||o(0)},[t]),_.useEffect(()=>{if(!t)return;const Ne=Te=>Te.preventDefault();return document.addEventListener("touchmove",Ne,{passive:!1}),document.addEventListener("wheel",Ne,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ne),document.removeEventListener("wheel",Ne),document.body.style.overflow=""}},[t]);const N=_.useMemo(()=>t?n.filter(Ne=>document.querySelector(Ne.selector)):[],[t]),B=N[s],M=s===N.length-1,D=B?.selector,X=_.useCallback(()=>{if(!D)return;const Ne=document.querySelector(D);if(!Ne){u(null);return}const Te=Ne.getBoundingClientRect(),C=8;u({top:Te.top-C,left:Te.left-C,width:Te.width+C*2,height:Te.height+C*2});const S=window.innerHeight-Te.bottom;p(S<260?"above":"below")},[D]);if(_.useEffect(()=>{if(!t||!D)return;b(!0);const Ne=document.querySelector(D);if(Ne){document.body.style.overflow="",Ne.scrollIntoView({behavior:"smooth",block:"center"});const Te=setTimeout(()=>{T.current&&(document.body.style.overflow="hidden"),X(),b(!1)},400);return()=>{clearTimeout(Te),T.current&&(document.body.style.overflow="hidden")}}},[t,s,D,X]),_.useEffect(()=>{if(!t)return;const Ne=()=>{x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(X)};return window.addEventListener("scroll",Ne,!0),window.addEventListener("resize",Ne),()=>{window.removeEventListener("scroll",Ne,!0),window.removeEventListener("resize",Ne),x.current&&cancelAnimationFrame(x.current)}},[t,X]),!t||!B||N.length===0)return null;const H=()=>{M?e():o(s+1)},J=()=>{s>0&&o(s-1)},he=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:Ne=>{Ne.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:H}),c&&a.jsx("div",{className:`st-spotlight${g?" st-transitioning":""}`,style:{top:c.top,left:c.left,width:c.width,height:c.height}}),c&&a.jsxs("div",{className:`st-tooltip st-tooltip-${d}${g?" st-transitioning":""}`,style:{top:d==="below"?c.top+c.height+16:void 0,bottom:d==="above"?window.innerHeight-c.top+16:void 0,left:Math.max(16,Math.min(c.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:N.map((Ne,Te)=>a.jsx("span",{className:`st-dot${Te===s?" active":""}${Te<s?" done":""}`},Te))}),a.jsx("h3",{className:"st-title",children:B.title}),a.jsx("p",{className:"st-body",children:B.body}),a.jsxs("div",{className:"st-actions",children:[s>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:J,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:H,children:B.cta||(M?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:he,children:"Skip tour"})]})]})}const tb=[10,25,50,100,200,500,1e3],xo=5;function Vc(n){return n.toISOString().split("T")[0]}function w5(n){let e=0;for(const t of tb){if(n<t)return{prev:e,next:t};e=t}return{prev:tb[tb.length-1],next:n+100}}const T5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},E5={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},nb=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function sb(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Sh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function k5(n,e=800){return new Promise(t=>{const s=new Image;s.onload=()=>{const o=document.createElement("canvas");let c=s.width,u=s.height;c>u?c>e&&(u=Math.round(u*e/c),c=e):u>e&&(c=Math.round(c*e/u),u=e),o.width=c,o.height=u,o.getContext("2d").drawImage(s,0,0,c,u),o.toBlob(d=>t(d),"image/jpeg",.8)},s.src=URL.createObjectURL(n)})}function S5(){const{currentUser:n,isClient:e,clientData:t,logout:s,updateClientData:o,loading:c}=ii(),{isDark:u,toggleTheme:d}=Vi(),{isPremium:p}=Dp(),g=gr(),[b,x]=_.useState({hours:0,minutes:0,seconds:0}),[T,N]=_.useState(0),[B,M]=_.useState(0),[D,X]=_.useState(""),[H,J]=_.useState(0),[he,Ne]=_.useState(0),[Te,C]=_.useState(!1),[S,P]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[U,V]=_.useState(null),[q,L]=_.useState(0),[We,wt]=_.useState(null),[$,ye]=_.useState(!1),[Le,Ke]=_.useState(!1),[te,O]=_.useState(0),[K,we]=_.useState(0),[Ae,Ge]=_.useState([]),[Pe,ct]=_.useState([]),[gt,nt]=_.useState(null),[Ft,Pn]=_.useState(!1),Lt=_.useRef(null),[Et,me]=_.useState([]),[sn,rn]=_.useState(null),[yt,At]=_.useState(0),[dt,it]=_.useState(0),[an,Ts]=_.useState(0),[Rt,ln]=_.useState(0),[ns,Qt]=_.useState(null),Wt=_.useCallback((I,ne="info")=>{Qt({message:I,type:ne}),setTimeout(()=>Qt(null),4e3)},[]),[cn,vn]=_.useState([]),[be,De]=_.useState(!1),[Be,et]=_.useState(""),[Ue,Me]=_.useState(null),[ze,St]=_.useState(null),[bt,Vt]=_.useState(!1),[Ht,ee]=_.useState(new Set),[ve,lt]=_.useState(new Set),[Ct,It]=_.useState({}),[Xt,Jt]=_.useState({}),[zt,Fn]=_.useState({}),[os,pn]=_.useState({}),[In,On]=_.useState({}),[z,xe]=_.useState({}),ke=_.useRef(null),Se=_.useRef(null),pe=_.useRef({}),[rt,Dt]=_.useState([]),[ut,jt]=_.useState(!1),kt=_.useRef(null),[un,yr]=_.useState([]),[Gs,Zs]=_.useState(""),[Xn,W]=_.useState(!1),[de,k]=_.useState(null),[A,Q]=_.useState([]),[ae,Ye]=_.useState(null),[$e,qe]=_.useState(!1),Ut=_.useRef(!1),Mt=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return p&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();_.useEffect(()=>{!c&&!n&&g("/")},[c,n,g]),_.useEffect(()=>{!c&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&g("/onboarding")},[c,t,g]),_.useEffect(()=>{let I=t?.tourComplete||Ut.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(Te&&t&&!I){const ne=setTimeout(()=>qe(!0),600);return()=>clearTimeout(ne)}},[Te,t]),_.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const ne=JSON.parse(I);M(ne.programmePct??0),X(ne.programmeName??""),J(ne.totalWorkouts??0),Ne(ne.habitWeekPct??0),P(ne.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),V(ne.nutritionTargetData??null),L(ne.todayHabitsCount??0),wt(ne.nextSession??null),ye(ne.hasProgramme??!1),Ke(ne.programmeComplete??!1),O(ne.weeklyWorkouts??0),we(ne.pbCount??0),Ge(ne.topPBs??[]),ct(ne.leaderboardTop3??[]),me(ne.unlockedBadges??[]),At(ne.streakWeeks??0),C(!0)}}catch{}},[t]),_.useEffect(()=>{t?.photoURL&&nt(t.photoURL)},[t]),_.useEffect(()=>{if(!t)return;const I=Dn(qt(_e,"notifications"),fn("toId","==",t.id)),ne=Xm(I,Ve=>{const tt=Ve.docs.map(_t=>({id:_t.id,..._t.data()}));tt.sort((_t,at)=>{const st=_t.createdAt?.toMillis?.()||0;return(at.createdAt?.toMillis?.()||0)-st}),Dt(tt.slice(0,50))},Ve=>{console.error("Notification listener error:",Ve),Ve.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>ne()},[t]),_.useEffect(()=>{const I=ne=>{kt.current&&!kt.current.contains(ne.target)&&jt(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),_.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[ne,Ve,tt]=await Promise.all([An(Dn(qt(_e,"buddies"),fn("user1","==",I))),An(Dn(qt(_e,"buddies"),fn("user2","==",I))),An(qt(_e,"clients"))]),_t=new Set;[...ne.docs,...Ve.docs].forEach(st=>{const Kt=st.data();_t.add(Kt.user1===I?Kt.user2:Kt.user1)});const at={};tt.docs.forEach(st=>{at[st.id]=st.data()}),yr(Array.from(_t).filter(st=>at[st]).map(st=>({id:st,name:at[st].name,photoURL:at[st].photoURL||null})))}catch(ne){console.error("Error loading buddies for mentions:",ne)}})()},[t]);const Hn=rt.filter(I=>!I.read).length,er=async()=>{const I=rt.filter(Ve=>!Ve.read);if(!I.length)return;const ne=jT(_e);I.forEach(Ve=>ne.update(Qe(_e,"notifications",Ve.id),{read:!0})),await ne.commit()},Vs=async()=>{if(!rt.length)return;const I=jT(_e);rt.forEach(ne=>I.delete(Qe(_e,"notifications",ne.id))),await I.commit()},zn=async(I,ne,Ve={})=>{if(!(!t||I===t.id))try{await Ra(qt(_e,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:ne,read:!1,createdAt:yi(),...Ve})}catch(tt){console.error("Notification create error:",tt),tt.code==="permission-denied"&&Wt("Notifications blocked  check Firestore rules","error")}},qn=(I,ne)=>{const Ve=ne==="compose"?ke.current?.selectionStart:null,_t=(Ve!=null?I.slice(0,Ve):I).match(/@(\w*)$/);if(_t){W(!0),k(ne),Zs(_t[1].toLowerCase());const at=un.filter(st=>st.name&&st.name.toLowerCase().includes(_t[1].toLowerCase())).slice(0,5);Q(at)}else W(!1),Q([])},Y=(I,ne)=>{if(ne==="compose"){const Ve=ke.current,tt=Be,_t=Ve?.selectionStart??tt.length,at=tt.slice(0,_t),st=tt.slice(_t),Kt=at.replace(/@\w*$/,`@${I.name} `);et(Kt+st),setTimeout(()=>{Ve?.focus(),Ve.selectionStart=Ve.selectionEnd=Kt.length},0)}else{const tt=(Xt[ne]||"").replace(/@\w*$/,`@${I.name} `);Jt(_t=>({..._t,[ne]:tt}))}W(!1),Q([])},Ee=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Ve,tt)=>Ve.startsWith("@")&&un.some(_t=>Ve.trim()===`@${_t.name}`)?a.jsx("span",{className:"mention-highlight",children:Ve.trim()},tt):Ve),re=async I=>{const ne=I.target.files?.[0];if(!(!ne||!t)){if(!ne.type.startsWith("image/")){Wt("Please select an image file","error");return}if(ne.size>5*1024*1024){Wt("Image must be under 5MB","error");return}Pn(!0);try{const Ve=await new Promise(at=>{const st=new Image;st.onload=()=>{const Kt=document.createElement("canvas"),$t=400;let _n=st.width,jn=st.height;_n>jn?(jn=jn/_n*$t,_n=$t):(_n=_n/jn*$t,jn=$t),Kt.width=_n,Kt.height=jn,Kt.getContext("2d").drawImage(st,0,0,_n,jn),Kt.toBlob(en=>at(en),"image/jpeg",.75)},st.src=URL.createObjectURL(ne)}),tt=Io(Do,`profilePhotos/${t.id}`);await eb(tt,Ve);const _t=await Dl(tt);await Ea(Qe(_e,"clients",t.id),{photoURL:_t}),nt(_t),o({photoURL:_t}),Wt("Profile photo updated!","success")}catch(Ve){console.error("Photo upload error:",Ve),Wt("Failed to upload photo","error")}Pn(!1),Lt.current&&(Lt.current.value="")}};_.useEffect(()=>{const I=()=>{const Ve=new Date,tt=new Date(Ve);tt.setHours(23,59,59,999);const _t=tt-Ve,at=Math.floor(_t/(1e3*60*60)),st=Math.floor(_t%(1e3*60*60)/(1e3*60)),Kt=Math.floor(_t%(1e3*60)/1e3);x({hours:at,minutes:st,seconds:Kt}),N(60-Kt)};I();const ne=setInterval(I,1e3);return()=>clearInterval(ne)},[]),_.useEffect(()=>{const I=setInterval(()=>{ln(ne=>(ne+1)%nb.length)},8e3);return()=>clearInterval(I)},[]),_.useEffect(()=>{if(!n||!t)return;(async()=>{let ne=null,Ve=0,tt=[],_t=!1,at=null;try{const st=Vc(new Date),Kt=await Vn(Qe(_e,"clientProgrammes",t.id));if(Kt.exists()){const Us=Kt.data(),kr=T5[Us.templateId];if(ye(!0),kr){const oi=Us.completedSessions||{},Pr=Object.keys(oi).length,Ha=kr.duration*kr.daysPerWeek;M(Ha>0?Math.round(Pr/Ha*100):0);const ec=Us.templateId.replace(/_/g," ").replace(/\b\w/g,wi=>wi.toUpperCase());X(ec);const $a=E5[Us.templateId];let oa=!1;for(let wi=1;wi<=kr.duration&&!oa;wi++)for(let ur=0;ur<kr.daysPerWeek&&!oa;ur++)oi[`w${wi}d${ur}`]||(wt({week:wi,dayIdx:ur,label:$a?.[ur]||`Day ${ur+1}`}),oa=!0);oa||(Ke(!0),_t=!0)}}const $t=qt(_e,"workoutLogs"),_n=Dn($t,fn("clientId","==",t.id));ne=await An(_n);const jn=ne.docs.filter(Us=>Us.data().type!=="programme").length;J(jn);const en=new Date,ms=en.getDay(),dn=ms===0?6:ms-1,$n=new Date(en);$n.setDate(en.getDate()-dn),$n.setHours(0,0,0,0);const ss=Vc($n),rs=ne.docs.filter(Us=>(Us.data().date||"")>=ss).length;O(rs);const Qs=qt(_e,"habitLogs"),cr=Dn(Qs,fn("clientId","==",t.id),fn("date","==",st)),Er=await An(cr);let ks=0;if(!Er.empty){const Us=Er.docs[0].data().habits||{};ks=Object.values(Us).filter(Boolean).length}Ne(Math.round(ks/xo*100)),L(ks);const ai=await Vn(Qe(_e,"nutritionTargets",t.id));ai.exists()&&(V(ai.data()),at=ai.data());const Oi=await Vn(Qe(_e,"nutritionLogs",`${t.id}_${st}`));if(Oi.exists()){const kr=(Oi.data().entries||[]).reduce((oi,Pr)=>({protein:oi.protein+(Pr.protein||0),carbs:oi.carbs+(Pr.carbs||0),fats:oi.fats+(Pr.fats||0),calories:oi.calories+(Pr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});P(kr)}}catch(st){console.error("Error loading dashboard stats:",st)}try{let st=[];const Kt=await Vn(Qe(_e,"coreBuddyPBs",t.id));if(Kt.exists()){const $t=Kt.data().exercises||{};we(Object.keys($t).length),Ve=Object.keys($t).length,st=Object.entries($t).sort(([,_n],[,jn])=>(jn.weight||0)-(_n.weight||0)).slice(0,3).map(([_n,jn])=>({name:_n,weight:jn.weight,reps:jn.reps}))}if(st.length===0){const $t={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},_n=Dn(qt(_e,"personalBests"),fn("clientId","==",t.id)),jn=await An(_n);if(!jn.empty){const en={};jn.docs.forEach(dn=>{const $n=dn.data().benchmarks||{};Object.entries($n).forEach(([ss,rs])=>{if(!rs.weight||!$t[ss])return;const Qs=(rs.weight||0)*(rs.reps||1);(!en[ss]||Qs>(en[ss].weight||0)*(en[ss].reps||1))&&(en[ss]={name:$t[ss],weight:rs.weight,reps:rs.reps})})});const ms=Object.values(en);we(ms.length),Ve=ms.length,st=ms.sort((dn,$n)=>($n.weight||0)-(dn.weight||0)).slice(0,3)}}tt=st,Ge(st)}catch(st){console.error("PB fetch error:",st)}try{const st=qt(_e,"clients"),Kt=Dn(st,fn("leaderboardOptIn","==",!0)),_n=(await An(Kt)).docs.map(jn=>({id:jn.id,name:jn.data().name,photoURL:jn.data().photoURL||null}));ct(_n.slice(0,3))}catch(st){console.error("Leaderboard preview error:",st)}try{let st=0;if(ne){const dn=ne.docs.map($n=>$n.data().date).filter(Boolean).sort().reverse();if(dn.length>0){const $n=new Date;let ss=new Date($n);e:for(let rs=0;rs<52;rs++){const Qs=new Date(ss),cr=Qs.getDay(),Er=cr===0?6:cr-1;Qs.setDate(Qs.getDate()-Er),Qs.setHours(0,0,0,0);const ks=new Date(Qs);ks.setDate(ks.getDate()+7);const ai=Vc(Qs),Oi=Vc(ks);if(dn.some(kr=>kr>=ai&&kr<Oi))st++;else{if(rs>0)break e;break}ss.setDate(ss.getDate()-7)}}}At(st);let Kt=0;for(let dn=0;dn<30;dn++){const $n=new Date;$n.setDate($n.getDate()-dn);const ss=Vc($n);try{const rs=await An(Dn(qt(_e,"habitLogs"),fn("clientId","==",t.id),fn("date","==",ss)));if(rs.empty)break;{const Qs=rs.docs[0].data().habits||{};if(Object.values(Qs).filter(Boolean).length>=xo)Kt++;else break}}catch{break}}it(Kt);let $t=0;for(let dn=0;dn<30;dn++){const $n=new Date;$n.setDate($n.getDate()-dn);const ss=Vc($n);try{const rs=await Vn(Qe(_e,"nutritionLogs",`${t.id}_${ss}`));if(rs.exists()&&(rs.data().entries||[]).length>0)if(at){const cr=(rs.data().entries||[]).reduce((Er,ks)=>({protein:Er.protein+(ks.protein||0),carbs:Er.carbs+(ks.carbs||0),fats:Er.fats+(ks.fats||0)}),{protein:0,carbs:0,fats:0});if(cr.protein>=(at.protein||0)&&cr.carbs>=(at.carbs||0)&&cr.fats>=(at.fats||0))$t++;else break}else $t++;else break}catch{break}}Ts($t);const _n=ne?ne.docs.length:0,jn=[],en=dn=>jn.push(dn);_n>=1&&en("first_workout"),_n>=10&&en("workouts_10"),_n>=25&&en("workouts_25"),_n>=50&&en("workouts_50"),_n>=100&&en("workouts_100"),st>=2&&en("streak_2"),st>=4&&en("streak_4"),st>=8&&en("streak_8"),Ve>=1&&en("first_pb"),Ve>=5&&en("pbs_5"),Ve>=10&&en("pbs_10"),Ve>=100&&en("pbs_100"),$t>=7&&en("nutrition_7"),t.leaderboardOptIn&&en("leaderboard_join"),Kt>=7&&en("habits_7"),me(jn);const ms={};jn.forEach(dn=>{ms[dn]={unlockedAt:new Date().toISOString()}}),Kn(Qe(_e,"achievements",t.id),{badges:ms,progress:{streakWeeks:st,pbCount:Ve,nutritionStreak:$t,habitStreak:Kt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(st){console.error("Achievement computation error:",st)}C(!0)})()},[n,t]),_.useEffect(()=>{if(!(!Te||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:B,programmeName:D,totalWorkouts:H,habitWeekPct:he,nutritionTotals:S,nutritionTargetData:U,todayHabitsCount:q,nextSession:We,hasProgramme:$,programmeComplete:Le,weeklyWorkouts:te,pbCount:K,topPBs:Ae,leaderboardTop3:Pe,unlockedBadges:Et,streakWeeks:yt}))}catch{}},[Te,B,D,H,he,S,U,q,We,$,Le,te,K,Ae,Pe,Et,yt,t]);const Fe=_.useCallback(async()=>{if(Ut.current=!0,qe(!1),o({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Ea(Qe(_e,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,o]),He=I=>{const ne=I.currentTarget,Ve=ne.querySelector(".ripple");Ve&&Ve.remove();const tt=ne.getBoundingClientRect(),_t=Math.max(tt.width,tt.height),at=I.clientX-tt.left-_t/2,st=I.clientY-tt.top-_t/2,Kt=document.createElement("span");Kt.className="ripple",Kt.style.cssText=`width:${_t}px;height:${_t}px;left:${at}px;top:${st}px;`,ne.appendChild(Kt),setTimeout(()=>Kt.remove(),600)},ht=t?.name?.split(" ")[0]||"there",{prev:vt,next:Gt}=w5(H),Sn=Gt>vt?Math.round((H-vt)/(Gt-vt)*100):100,Cs=[{label:"Programme",value:`${B}%`,pct:B,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${H}`,pct:Sn,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${he}%`,pct:he,color:"#38B6FF",size:"normal"}],hn=I=>!U||!U[I]?0:Math.min(Math.round(S[I]/U[I]*100),100),tr=(()=>{const I=new Date().getHours();return Te&&q>=xo&&S.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Os=Te?$&&We&&!Le?{label:"NEXT SESSION",message:`Week ${We.week}, Day ${We.dayIdx+1}  ${We.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:B,ringLabel:`${B}%`}:q<xo?{label:"DAILY HABITS",message:`${q}/${xo} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:he,ringLabel:`${q}/${xo}`}:S.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:$?Le?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,Es=_.useCallback(async()=>{if(t){De(!0);try{const I=await An(Dn(qt(_e,"posts"),fn("authorId","==",t.id),Qm("createdAt","desc"),Ym(30)));vn(I.docs.map(Ve=>({id:Ve.id,...Ve.data()})));const ne=await An(Dn(qt(_e,"postLikes"),fn("userId","==",t.id)));ee(new Set(ne.docs.map(Ve=>Ve.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{De(!1)}}},[t]);_.useEffect(()=>{Te&&t&&Es()},[Te,t,Es]);const aa=I=>{const ne=I.target.files?.[0];if(ne){if(!ne.type.startsWith("image/")){Wt("Please select an image file","error");return}if(ne.size>10*1024*1024){Wt("Image must be under 10MB","error");return}Me(ne),St(URL.createObjectURL(ne))}},_i=()=>{Me(null),ze&&URL.revokeObjectURL(ze),St(null),Se.current&&(Se.current.value="")},xn=async()=>{if(!(!Be.trim()&&!Ue||bt||!t)){Vt(!0);try{let I=null;if(Ue){const tt=await k5(Ue),_t=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,at=Io(Do,`postImages/${t.id}/${_t}`);await eb(at,tt),I=await Dl(at)}await Ra(qt(_e,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Be.trim(),type:I?"image":"text",imageURL:I||null,createdAt:yi(),likeCount:0,commentCount:0});const Ve=Be.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ve){const tt=new Set;Ve.forEach(_t=>{const at=_t.slice(1).trim(),st=un.find(Kt=>Kt.name&&Kt.name.toLowerCase()===at.toLowerCase());st&&!tt.has(st.id)&&(tt.add(st.id),zn(st.id,"mention",{}))})}et(""),_i(),ke.current&&(ke.current.style.height="auto"),await Es(),Wt("Posted!","success")}catch(I){console.error("Error posting:",I),Wt(I?.message||"Failed to post","error")}finally{Vt(!1)}}},_s=async I=>{if(window.confirm("Delete this post?"))try{await Ar(Qe(_e,"posts",I)),vn(ne=>ne.filter(Ve=>Ve.id!==I)),Wt("Post deleted","info")}catch(ne){console.error("Delete error:",ne),Wt("Failed to delete","error")}},Tr=async I=>{if(!t)return;const ne=t.id,Ve=`${I}_${ne}`,tt=Ht.has(I),_t=new Set(Ht);tt?_t.delete(I):_t.add(I),ee(_t),vn(at=>at.map(st=>st.id===I?{...st,likeCount:Math.max(0,(st.likeCount||0)+(tt?-1:1))}:st));try{if(tt)await Ar(Qe(_e,"postLikes",Ve)),await Ea(Qe(_e,"posts",I),{likeCount:Nl(-1)});else{await Kn(Qe(_e,"postLikes",Ve),{postId:I,userId:ne,createdAt:yi()}),await Ea(Qe(_e,"posts",I),{likeCount:Nl(1)});const at=cn.find(st=>st.id===I);at&&zn(at.authorId,"like",{postId:I})}}catch(at){console.error("Like error:",at),Es()}},Ks=async I=>{try{const ne=await An(Dn(qt(_e,"postComments"),fn("postId","==",I),Qm("createdAt","asc"),Ym(50)));It(Ve=>({...Ve,[I]:ne.docs.map(tt=>({id:tt.id,...tt.data()}))}))}catch(ne){console.error("Error loading comments:",ne)}},Ir=I=>{const ne=new Set(ve);ne.has(I)?ne.delete(I):(ne.add(I),Ct[I]||Ks(I)),lt(ne)},ls=async I=>{const ne=(Xt[I]||"").trim(),Ve=In[I];if(!(!ne&&!Ve||!t)){Fn(tt=>({...tt,[I]:!0}));try{let tt=null;if(Ve){const $t=Io(Do,`comment-images/${Date.now()}_${Ve.name}`);await eb($t,Ve),tt=await Dl($t)}const _t={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ne||"",createdAt:yi()};tt&&(_t.imageURL=tt);const at=os[I];at&&(_t.replyToId=at.id,_t.replyToName=at.authorName),await Ra(qt(_e,"postComments"),_t),await Ea(Qe(_e,"posts",I),{commentCount:Nl(1)});const st=cn.find($t=>$t.id===I);st&&zn(st.authorId,"comment",{postId:I});const Kt=ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Kt){const $t=new Set;Kt.forEach(_n=>{const jn=_n.slice(1).trim(),en=un.find(ms=>ms.name&&ms.name.toLowerCase()===jn.toLowerCase());en&&!$t.has(en.id)&&($t.add(en.id),zn(en.id,"mention",{postId:I}))})}Jt($t=>({...$t,[I]:""})),On($t=>({...$t,[I]:null})),xe($t=>({...$t,[I]:null})),pn($t=>({...$t,[I]:null})),pe.current[I]&&(pe.current[I].value=""),vn($t=>$t.map(_n=>_n.id===I?{..._n,commentCount:(_n.commentCount||0)+1}:_n)),await Ks(I)}catch(tt){console.error("Comment error:",tt),Wt("Failed to comment","error")}finally{Fn(tt=>({...tt,[I]:!1}))}}},lr=async(I,ne)=>{try{await Ar(Qe(_e,"postComments",ne)),await Ea(Qe(_e,"posts",I),{commentCount:Nl(-1)}),It(Ve=>({...Ve,[I]:(Ve[I]||[]).filter(tt=>tt.id!==ne)})),vn(Ve=>Ve.map(tt=>tt.id===I?{...tt,commentCount:Math.max((tt.commentCount||1)-1,0)}:tt))}catch(Ve){console.error("Delete comment error:",Ve),Wt("Failed to delete comment","error")}},Bs=(I,ne)=>{const Ve=ne.target.files?.[0];if(!Ve)return;if(Ve.size>5*1024*1024){Wt("Image must be under 5MB","error");return}On(_t=>({..._t,[I]:Ve}));const tt=new FileReader;tt.onload=_t=>xe(at=>({...at,[I]:_t.target.result})),tt.readAsDataURL(Ve)},qr=I=>{On(ne=>({...ne,[I]:null})),xe(ne=>({...ne,[I]:null})),pe.current[I]&&(pe.current[I].value="")},Dr=I=>{et(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",qn(I.target.value,"compose")},Hr=(I,ne)=>{Jt(Ve=>({...Ve,[I]:ne})),qn(ne,I)};return a.jsxs("div",{className:"cb-dashboard","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:kt,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{jt(!ut),ut||er()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Hn>0&&a.jsx("span",{className:"header-notif-badge",children:Hn>9?"9+":Hn})]}),ut&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),rt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Vs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:rt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):rt.map(I=>a.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(jt(!1),I.type==="buddy_request"||I.type==="buddy_accept")g("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!ve.has(I.postId)){const ne=new Set(ve);ne.add(I.postId),lt(ne),Ct[I.postId]||Ks(I.postId)}setTimeout(()=>{const ne=document.getElementById(`post-${I.postId}`);ne&&ne.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&g(`/client/core-buddy/profile/${I.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?a.jsx("img",{src:I.fromPhotoURL,alt:""}):a.jsx("span",{children:(I.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:sb(I.createdAt)})]})]},I.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:s,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:q0.map((I,ne)=>{const Ve=ne<T;return a.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Ve?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},ne)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Lt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:gt||"/Logo.webp",alt:gt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ft?" uploading":""}`,children:Ft?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Lt,type:"file",accept:"image/*",onChange:re,style:{display:"none"}})]}),!gt&&!Ft&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Lt.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(b.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(b.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(b.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[nb[Rt].text," ",a.jsx("strong",{children:nb[Rt].bold})]},Rt)]}),a.jsx("div",{className:"cb-stats-row",children:Cs.map(I=>{const ne=(I.size==="large",38),Ve=2*Math.PI*ne,tt=Ve-I.pct/100*Ve;return a.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:ne}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:ne,style:{stroke:I.color},strokeDasharray:Ve,strokeDashoffset:tt})]}),a.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),a.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[tr.main," ",a.jsx("strong",{children:ht}),"  ",tr.sub]}),Os&&a.jsxs("button",{className:"cb-nudge-card",onClick:Os.action||void 0,style:Os.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Os.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Os.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Os.label}),a.jsx("span",{className:"cb-nudge-title",children:Os.message}),Os.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Os.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{He(I),g(p?"/client/core-buddy/nutrition":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsxs("h3",{children:["Today's Nutrition ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:hn("protein"),color:"#14b8a6"},{label:"C",pct:hn("carbs"),color:"var(--color-primary)"},{label:"F",pct:hn("fats"),color:"#eab308"},{label:"Cal",pct:hn("calories"),color:"#38B6FF"}].map(I=>{const Ve=2*Math.PI*38,tt=Ve-I.pct/100*Ve;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Ve,strokeDashoffset:tt})]}),a.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{He(I),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[te," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[H," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{He(I),g(p?"/client/core-buddy/consistency":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Habits ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:xo},(I,ne)=>a.jsx("span",{className:`cb-habit-dot${ne<q?" done":""}`},ne))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[q,"/",xo," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{He(I),g(p?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["PBs ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Ae.length>0?a.jsx("div",{className:"cb-pb-preview",children:Ae.slice(0,2).map(I=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:I.name}),a.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{He(I),g(p?"/client/leaderboard":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Leaderboard ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Pe.length>0?a.jsx("div",{className:"cb-lb-preview",children:Pe.map((I,ne)=>{const Ve=["#FFD700","#A8B4C0","#CD7F32"][ne],tt=I.name?I.name.split(" ").map(at=>at[0]).join("").slice(0,2).toUpperCase():"?",_t=I.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${_t?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ve},children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:tt})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ve},children:["#",ne+1]})]},I.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${p?"":" cb-card-locked"}`,onClick:I=>{He(I),g(p?"/client/core-buddy/buddies":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddies ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:`cb-achievements-section${p?"":" cb-card-locked"}`,children:[a.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"cb-badges-scroll",children:Jm.map(I=>{const ne=Et.includes(I.id);return a.jsx("button",{className:`cb-badge${ne?" unlocked":" locked"}`,onClick:()=>rn(I),children:a.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),a.jsxs("p",{className:"cb-badges-count",children:[Et.length,"/",Jm.length," unlocked"]})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),sn&&a.jsx("div",{className:"cb-badge-overlay",onClick:()=>rn(null),children:a.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[a.jsx("img",{src:sn.img,alt:sn.name,className:`cb-badge-overlay-img${Et.includes(sn.id)?"":" cb-badge-overlay-img-locked"}`}),a.jsx("p",{className:"cb-badge-overlay-desc",children:sn.desc}),Et.includes(sn.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),a.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>rn(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),p?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:gt?a.jsx("img",{src:gt,alt:""}):a.jsx("span",{children:Sh(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:ke,placeholder:"Share your progress... (use @ to mention)",value:Be,onChange:Dr,rows:1,maxLength:500}),Xn&&de==="compose"&&A.length>0&&a.jsx("div",{className:"mention-dropdown",children:A.map(I=>a.jsxs("button",{className:"mention-option",onClick:()=>Y(I,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:""}):a.jsx("span",{children:Sh(I.name)})}),a.jsx("span",{children:I.name})]},I.id))}),ze&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:ze,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:_i,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Se.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Se,type:"file",accept:"image/*",onChange:aa,hidden:!0}),(Be.trim()||Ue)&&a.jsx("button",{className:"journey-post-btn",onClick:xn,disabled:bt,children:bt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),be?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):cn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:cn.map(I=>a.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?a.jsx("img",{src:I.authorPhotoURL,alt:""}):a.jsx("span",{children:Sh(I.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:I.authorName}),a.jsx("span",{className:"journey-post-time",children:sb(I.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>_s(I.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&a.jsx("p",{className:"journey-post-content",children:Ee(I.content)}),I.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Ht.has(I.id)?" liked":""}`,onClick:()=>Tr(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Ht.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:I.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${ve.has(I.id)?" active":""}`,onClick:()=>Ir(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:I.commentCount||0})]})]}),ve.has(I.id)&&a.jsxs("div",{className:"journey-comments",children:[Ct[I.id]?.length>0?Ct[I.id].map(ne=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:ne.authorPhotoURL?a.jsx("img",{src:ne.authorPhotoURL,alt:""}):a.jsx("span",{children:Sh(ne.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:ne.authorName}),ne.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),ne.replyToName]}),ne.content&&a.jsx("span",{className:"journey-comment-text",children:Ee(ne.content)}),ne.imageURL&&a.jsx("img",{className:"journey-comment-image",src:ne.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:sb(ne.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>pn(Ve=>({...Ve,[I.id]:{id:ne.id,authorName:ne.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>lr(I.id,ne.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},ne.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),os[I.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:os[I.id].authorName})]}),a.jsx("button",{onClick:()=>pn(ne=>({...ne,[I.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),z[I.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:z[I.id],alt:"Preview"}),a.jsx("button",{onClick:()=>qr(I.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>pe.current[I.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:ne=>{pe.current[I.id]=ne},type:"file",accept:"image/*",onChange:ne=>Bs(I.id,ne),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Xt[I.id]||"",onChange:ne=>Hr(I.id,ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&ls(I.id)},maxLength:300}),Xn&&de===I.id&&A.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:A.map(ne=>a.jsxs("button",{className:"mention-option",onClick:()=>Y(ne,I.id),children:[a.jsx("div",{className:"mention-option-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:""}):a.jsx("span",{children:Sh(ne.name)})}),a.jsx("span",{children:ne.name})]},ne.id))}),a.jsx("button",{onClick:()=>ls(I.id),disabled:!(Xt[I.id]||"").trim()&&!In[I.id]||zt[I.id],children:zt[I.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),a.jsx(ra,{active:"home"}),ns&&a.jsxs("div",{className:`toast-notification ${ns.type}`,children:[ns.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),ns.message]}),a.jsx(_5,{steps:Mt,active:$e,onFinish:Fe})]})}const rb=new Map;function _o(){return new Date().toISOString().split("T")[0]}const VT=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],j5={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function N5(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function A5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c,accent:u}=Vi(),d=gr(),[p,g]=_.useState("loading"),[b,x]=_.useState(null),[T,N]=_.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[B,M]=_.useState(null),[D,X]=_.useState(_o()),[H,J]=_.useState({entries:[],water:0}),[he,Ne]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[Te,C]=_.useState(!1),[S,P]=_.useState(!1),[U,V]=_.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[q,L]=_.useState(N5),[We,wt]=_.useState(null),[$,ye]=_.useState(null),[Le,Ke]=_.useState(!1),[te,O]=_.useState(null),[K,we]=_.useState(""),[Ae,Ge]=_.useState(!1),[Pe,ct]=_.useState(""),[gt,nt]=_.useState([]),[Ft,Pn]=_.useState(!1),[Lt,Et]=_.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[me,sn]=_.useState(null),[rn,yt]=_.useState("100"),[At,dt]=_.useState(0),[it,an]=_.useState("weight"),[Ts,Rt]=_.useState(0),[ln,ns]=_.useState(null);_.useRef(null);const Qt=_.useRef(!1),Wt=_.useRef(null),cn=_.useRef(null),vn=_.useRef(null),be=_.useCallback((k,A="info")=>{ns({message:k,type:A}),setTimeout(()=>ns(null),3e3)},[]);_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const A=await Vn(Qe(_e,"nutritionTargets",t.id));A.exists()?(x(A.data()),g("dashboard")):g("setup")}catch(A){console.error("Error loading nutrition data:",A),g("setup")}})()},[t?.id]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const A=await Vn(Qe(_e,"nutritionLogs",`${t.id}_${D}`));if(A.exists()){const Q=A.data();J({entries:Q.entries||[],water:Q.water||0})}else J({entries:[],water:0})}catch(A){console.error("Error loading log:",A),J({entries:[],water:0})}})()},[t?.id,D]),_.useEffect(()=>{const k=H.entries.reduce((A,Q)=>({protein:A.protein+(Q.protein||0),carbs:A.carbs+(Q.carbs||0),fats:A.fats+(Q.fats||0),calories:A.calories+(Q.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ne(k)},[H.entries]);const De=async k=>{try{await Kn(Qe(_e,"nutritionLogs",`${t.id}_${D}`),{clientId:t.id,date:D,entries:k.entries,water:k.water,updatedAt:mt.now()})}catch(A){console.error("Error saving nutrition log:",A)}},Be=D===_o(),et=(k,A)=>new Date(k,A+1,0).getDate(),Ue=(k,A)=>new Date(k,A,1).getDay(),Me=["January","February","March","April","May","June","July","August","September","October","November","December"],ze=["Su","Mo","Tu","We","Th","Fr","Sa"],St=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let A;T.heightUnit==="cm"?A=parseFloat(T.height):A=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const Q=parseInt(T.age);let ae=T.gender==="male"?10*k+6.25*A-5*Q+5:10*k+6.25*A-5*Q-161;const $e=ae*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],qe={low:100,moderate:200,high:300,daily:400},Ut=Math.round($e+qe[T.trainingFrequency]);let Mt=Ut,Hn,er;switch(T.goal){case"lose":Mt=Ut*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Hn=2.2,er=.3;break;case"build":Mt=Ut*1.1,Hn=2,er=.22;break;default:Hn=1.8,er=.25}Mt=Math.max(Mt,T.gender==="male"?1400:1100);const Vs=Math.round(k*Hn),zn=Math.round(Mt*er/9),qn=Math.max(0,Math.round((Mt-Vs*4-zn*9)/4));M({calories:Math.round(Mt),protein:Vs,carbs:qn,fats:zn,bmr:Math.round(ae),neat:Math.round($e),exerciseAdd:qe[T.trainingFrequency],tdee:Math.round(Ut)})},bt=async()=>{if(B)try{const k={clientId:t.id,calories:B.calories,protein:B.protein,carbs:B.carbs,fats:B.fats,waterGoal:8,goal:T.goal,updatedAt:mt.now()};await Kn(Qe(_e,"nutritionTargets",t.id),k),x(k),g("dashboard"),be("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),be("Failed to save targets. Please try again.","error")}},Vt=()=>{const k=T.weight&&parseFloat(T.weight)>0,A=T.age&&parseInt(T.age)>0,Q=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&A&&Q},Ht="nut_favourite_foods",ee=()=>{try{return JSON.parse(localStorage.getItem(Ht)||"[]")}catch{return[]}},ve=k=>ee().some(A=>A.name.toLowerCase()===(k||"").toLowerCase()),lt=k=>{const A=ee(),Q=A.findIndex(ae=>ae.name.toLowerCase()===k.name.toLowerCase());Q>=0?A.splice(Q,1):A.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(Ht,JSON.stringify(A)),Rt(ae=>ae+1)},Ct=k=>{const A=[...H.entries,{...k,meal:q,id:Date.now(),addedAt:new Date().toISOString()}],Q={...H,entries:A};J(Q),De(Q),ye(null),sn(null),yt("100"),dt(0),an("weight"),Et({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),be("Food added!","success")},It=k=>{const A=H.entries.filter(ae=>ae.id!==k),Q={...H,entries:A};J(Q),De(Q)},Xt=_.useRef(null),Jt=async()=>{Ke(!0);const k=document.querySelector("#barcode-reader");if(!k){Ke(!1),be("Scanner container not found.","error");return}if(!Xt.current)try{const Q=await Cr(()=>import("./quagga.min-BbicSfvA.js").then(ae=>ae.q),[]);Xt.current=Q.default}catch(Q){console.error("Failed to load barcode scanner:",Q),Ke(!1),be("Could not load scanner.","error");return}const A=Xt.current;A.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},Q=>{if(Q){console.error("Quagga init error:",Q),Ke(!1),be("Could not access camera. Check permissions.","error");return}A.start(),Qt.current=!0}),A.onDetected(Q=>{const ae=Q.codeResult.decodedCodes?.filter($e=>$e.error!==void 0)?.map($e=>$e.error)||[];if((ae.length>0?ae.reduce(($e,qe)=>$e+qe,0)/ae.length:1)<.15){const $e=Q.codeResult.code;A.offDetected(),O($e)}})},zt=()=>{const k=Xt.current;Qt.current&&k&&(k.stop(),k.offDetected(),Qt.current=!1),Ke(!1)},Fn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,os=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),pn=k=>{if(!k)return{value:100,unit:"g"};const A=k.toLowerCase().replace(/\s/g,""),Q=A.match(/([\d.]+)/),ae=Q?parseFloat(Q[1]):100;return os(k)?/cl/.test(A)?{value:ae*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(A)&&!/ml/.test(A)?{value:ae*1e3,unit:"ml"}:{value:ae,unit:"ml"}:{value:ae,unit:"g"}},In=k=>{if(os(k.serving_size)||os(k.quantity))return"ml";const A=k.product_name||k.product_name_en||"";return Fn.test(A)?"ml":"g"},On=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],z=(k,A)=>{const Q=k||"",ae=Q.match(/\((\d+\.?\d*)\s*g\)/i),Ye=Q.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ae&&Ye){const Ut=parseFloat(ae[1]);let Mt=Ye[1].replace(/^\d+\s*/,"").trim();if(Mt&&Ut>0)return{label:Mt,weight:Ut}}const $e=Q.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if($e){const Ut=parseFloat($e[1]);let Mt=$e[2].replace(/^\d+\s*/,"").trim();if(Mt&&Ut>0)return{label:Mt,weight:Ut}}const qe=A||"";for(const{pattern:Ut,label:Mt,weight:Hn}of On)if(Ut.test(qe))return{label:Mt,weight:Hn};return null},xe=k=>{const A=k.nutriments||{},Q=In(k),ae=pn(k.serving_size),Ye=Q==="ml"?ae.unit==="ml"?ae.value:100:ae.value,$e=k.product_name||k.product_name_en||"Unknown Product",qe=z(k.serving_size,$e);return{name:$e,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:Ye,servingUnit:Q,portion:qe,protein:Math.round(A.proteins_100g||A.proteins||0),carbs:Math.round(A.carbohydrates_100g||A.carbohydrates||0),fats:Math.round(A.fat_100g||A.fat||0),calories:Math.round(A["energy-kcal_100g"]||A["energy-kcal"]||(A.energy_100g?A.energy_100g/4.184:0)),per100g:!0}},ke=async k=>{Ge(!0);try{const A=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Q=await fetch(A);if(!Q.ok)throw new Error(`HTTP ${Q.status}`);const ae=await Q.json();if(ae.status==="success"||ae.status===1||ae.product){const Ye=xe(ae.product);Ye.calories===0&&Ye.protein===0&&Ye.carbs===0?be("Product found but no nutrition data available.","error"):(sn(Ye),Ye.portion?(dt(1),yt(String(Ye.portion.weight)),an("portion")):(dt(0),yt(String(Ye.servingValue||100)),an("weight")),we(""))}else be("Product not found. Try search or manual entry.","error")}catch(A){console.error("Barcode lookup error:",A),be("Failed to look up product. Check your connection.","error")}Ge(!1)},Se=(k,A,Q)=>{const ae=k.toLowerCase().trim(),Ye=A.toLowerCase().trim(),$e=Q.toLowerCase().trim();let qe=0;return(ae===$e||ae===$e+"s"||ae+"s"===$e)&&(qe+=100),(ae.endsWith(" "+$e)||ae.endsWith(" "+$e+"s"))&&(qe+=40),(ae.startsWith($e+" ")||ae.startsWith($e+"s "))&&(qe+=15),$e.split(/\s+/).some(Mt=>Ye===Mt||Ye.startsWith(Mt))&&(qe+=30),qe+=Math.max(0,30-ae.length),qe},pe=async()=>{if(!Pe.trim())return;Wt.current&&Wt.current.abort();const k=new AbortController;Wt.current=k;const A=Pe.trim().toLowerCase(),Q=A.split(/\s+/).filter(Boolean);if(rb.has(A)){nt(rb.get(A));return}Pn(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Pe.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,$e=await fetch(Ye,{signal:k.signal});if(!$e.ok)throw new Error(`HTTP ${$e.status}`);const Ut=((await $e.json()).products||[]).map(Mt=>xe(Mt)).filter(Mt=>Mt.name!=="Unknown Product"&&(Mt.calories>0||Mt.protein>0)).filter(Mt=>{const Hn=(Mt.name+" "+Mt.brand).toLowerCase();return Q.every(er=>Hn.includes(er))}).sort((Mt,Hn)=>Se(Hn.name,Hn.brand,A)-Se(Mt.name,Mt.brand,A)).slice(0,10);rb.set(A,Ut),nt(Ut),Ut.length===0&&be("No results found. Try a different search.","info")}catch(ae){if(ae.name==="AbortError")return;console.error("Search error:",ae),be("Search failed. Check your connection.","error")}Pn(!1)};_.useEffect(()=>{if(cn.current&&clearTimeout(cn.current),!(!Pe.trim()||$!=="search"||me))return cn.current=setTimeout(()=>{pe()},700),()=>clearTimeout(cn.current)},[Pe]);const rt=()=>{const k={...H,water:H.water+1};J(k),De(k)},Dt=()=>{if(H.water<=0)return;const k={...H,water:H.water-1};J(k),De(k)},ut={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},jt=80,kt=2*Math.PI*jt,un=(k,A,Q,ae,Ye)=>{const $e=ae>0?Math.min(100,Math.round(Q/ae*100)):0,qe=kt-$e/100*kt,Ut=ut[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:jt}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:jt,style:{stroke:Ut},strokeDasharray:kt,strokeDashoffset:qe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ut},children:Math.round(Q)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ae,k==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ut},children:A})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ut},children:[$e,"%"]})]})};if(_.useEffect(()=>{if(!te)return;const k=setTimeout(()=>{const A=te;zt(),O(null),ke(A)},1500);return()=>clearTimeout(k)},[te]),_.useEffect(()=>()=>{const k=Xt.current;if(Qt.current&&k){try{k.stop(),k.offDetected()}catch{}Qt.current=!1}},[]),s||p==="loading")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(p==="setup")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{N(k=>({...k,gender:"male"})),M(null)},children:"Male"}),a.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{N(k=>({...k,gender:"female"})),M(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:T.age,onChange:k=>{N(A=>({...A,age:k.target.value})),M(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:T.weight,onChange:k=>{N(A=>({...A,weight:k.target.value})),M(null)},placeholder:T.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{N(k=>({...k,weightUnit:"kg"})),M(null)},children:"kg"}),a.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{N(k=>({...k,weightUnit:"lbs"})),M(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?a.jsx("input",{type:"number",value:T.height,onChange:k=>{N(A=>({...A,height:k.target.value})),M(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{N(A=>({...A,heightFeet:k.target.value})),M(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{N(A=>({...A,heightInches:k.target.value})),M(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{N(k=>({...k,heightUnit:"cm"})),M(null)},children:"cm"}),a.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{N(k=>({...k,heightUnit:"ft"})),M(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:T.dailyActivity,onChange:k=>{N(A=>({...A,dailyActivity:k.target.value})),M(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:T.trainingFrequency,onChange:k=>{N(A=>({...A,trainingFrequency:k.target.value})),M(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{N(k=>({...k,goal:"lose"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{N(k=>({...k,goal:"maintain"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{N(k=>({...k,goal:"build"})),M(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"light"})),M(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"moderate"})),M(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{N(k=>({...k,deficitLevel:"harsh"})),M(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:St,disabled:!Vt(),children:"Calculate Macros"})]}),B&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[un("Protein","Protein",B.protein,B.protein,"ring-protein"),un("Carbs","Carbs",B.carbs,B.carbs,"ring-carbs"),un("Fats","Fats",B.fats,B.fats,"ring-fats"),un("Calories","Calories",B.calories,B.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[B.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[B.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",B.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[B.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:bt,children:"Set as My Daily Targets"})]})]}),ln&&a.jsx("div",{className:`toast-notification ${ln.type}`,children:ln.message})]});const yr=k=>{const A=new Date(k+"T12:00:00"),Q=A.getDay(),ae=new Date(A);ae.setDate(A.getDate()-(Q+6)%7);const Ye=[];for(let $e=0;$e<7;$e++){const qe=new Date(ae);qe.setDate(ae.getDate()+$e),Ye.push(qe.toISOString().split("T")[0])}return Ye},Gs=["M","T","W","T","F","S","S"],Zs=(k,A="search")=>{L(k),A==="scan"?(ye("scan"),sn(null)):A==="manual"?(ye("manual"),Et({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):A==="favourites"?ye("favourites"):(ye("search"),nt([]),ct(""))},Xn=yr(D),W=new Date(D+"T12:00:00"),de=`${Me[W.getMonth()]} ${W.getFullYear()}`;return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{g("setup"),M(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(D+"T12:00:00");k.setDate(k.getDate()-7);const A=k.toISOString().split("T")[0];X(A)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!Te),V({year:W.getFullYear(),month:W.getMonth()})},children:de}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(D+"T12:00:00");k.setDate(k.getDate()+7);const A=k.toISOString().split("T")[0];A<=_o()&&X(A)},"aria-label":"Next week",disabled:Xn[6]>=_o(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Xn.map((k,A)=>{const Q=new Date(k+"T12:00:00").getDate(),ae=k===D,Ye=k>_o(),$e=k===_o();return a.jsxs("button",{className:`nut-week-day${ae?" selected":""}${$e?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>X(k),children:[a.jsx("span",{className:"nut-week-day-letter",children:Gs[A]}),a.jsx("span",{className:"nut-week-day-num",children:Q})]},k)})})]}),Te&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>V(k=>{let A=k.month-1,Q=k.year;return A<0&&(A=11,Q--),{year:Q,month:A}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Me[U.month]," ",U.year]}),a.jsx("button",{onClick:()=>V(k=>{let A=k.month+1,Q=k.year;return A>11&&(A=0,Q++),{year:Q,month:A}}),disabled:U.year===new Date().getFullYear()&&U.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:ze.map(k=>a.jsx("span",{children:k},k))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Ue(U.year,U.month))].map((k,A)=>a.jsx("span",{},`e${A}`)),[...Array(et(U.year,U.month))].map((k,A)=>{const Q=A+1,ae=`${U.year}-${String(U.month+1).padStart(2,"0")}-${String(Q).padStart(2,"0")}`,Ye=ae>_o(),$e=ae===D,qe=ae===_o();return a.jsx("button",{className:`nut-cal-day${$e?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{X(ae),C(!1)},children:Q},Q)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[un("Protein","Protein",he.protein,b.protein,"ring-protein"),un("Carbs","Carbs",he.carbs,b.carbs,"ring-carbs"),un("Fats","Fats",he.fats,b.fats,"ring-fats"),un("Calories","kCal",he.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Be&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>P(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[H.water," / ",b?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:VT.map(k=>{const A=H.entries.filter(ae=>(ae.meal||"snacks")===k.key),Q=A.reduce((ae,Ye)=>({protein:ae.protein+(Ye.protein||0),carbs:ae.carbs+(Ye.carbs||0),fats:ae.fats+(Ye.fats||0),calories:ae.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:j5[k.key]}),a.jsx("span",{className:"nut-meal-card-title",children:k.label}),A.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[Q.calories," cal"]}),Be&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>wt(We===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),A.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?Q.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?Q.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?Q.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Q.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?Q.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:Q.calories})]})]}),A.length>0&&a.jsx("div",{className:"nut-log-list",children:A.map(ae=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ae.name}),ae.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ae.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ae.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ae.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ae.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ae.calories})]}),Be&&a.jsx("button",{className:"nut-log-delete",onClick:()=>It(ae.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))}),A.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Be?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),We&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>wt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",VT.find(k=>k.key===We)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const k=We;wt(null),Zs(k,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const k=We;wt(null),Zs(k,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const k=We;wt(null),Zs(k,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const k=We;wt(null),Zs(k,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),S&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>P(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>P(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(b?.waterGoal||8)].map((k,A)=>a.jsx("div",{className:`nut-water-glass ${A<H.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:A<H.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},A))}),a.jsxs("div",{className:"nut-water-popup-count",children:[H.water," / ",b?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:Dt,disabled:H.water<=0,children:"-"}),a.jsx("button",{onClick:rt,children:"+"})]})]})]})}),$&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{zt(),O(null),ye(null),sn(null)},children:a.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:$==="scan"?"Scan Barcode":$==="search"?"Search Food":$==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{zt(),O(null),ye(null),sn(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$==="scan"&&!me&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Le&&!te&&a.jsx("div",{className:"nut-scan-line"}),te&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:te})]})]}),!Le&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Jt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Le&&!te&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:K,onChange:k=>we(k.target.value),onKeyDown:k=>k.key==="Enter"&&K.trim()&&ke(K.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>K.trim()&&ke(K.trim()),disabled:!K.trim()||Ae,children:Ae?"...":"Look Up"})]})]}),$==="scan"&&me&&(()=>{const k=me.servingUnit||"g",A=me.portion,Q=it==="portion"&&A?At*A.weight:parseFloat(rn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&A?`${At} ${A.label}${At!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[me.image&&a.jsx("img",{src:me.image,alt:me.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:me.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(me.name)?" active":""}`,onClick:()=>lt({name:me.name,protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories,serving:me.servingSize,per100g:{protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories},servingUnit:me.servingUnit||"g",portion:me.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(me.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),me.brand&&a.jsx("p",{className:"nut-product-brand",children:me.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[me.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[me.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[me.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[me.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{an("portion"),At<1&&dt(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{an("weight"),yt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(Math.max(1,At-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:At}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,At!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(At+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:rn,onChange:qe=>yt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${rn===String(qe)?" active":""}`,onClick:()=>yt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(me.protein*ae),"p / ",Math.round(me.carbs*ae),"c / ",Math.round(me.fats*ae),"f / ",Math.round(me.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{sn(null),ye("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ct({name:me.name,protein:Math.round(me.protein*ae),carbs:Math.round(me.carbs*ae),fats:Math.round(me.fats*ae),calories:Math.round(me.calories*ae),serving:$e}),children:"Add"})]})]})})(),$==="search"&&!me&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:vn,value:Pe,onChange:k=>ct(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(cn.current),pe())},onFocus:()=>setTimeout(()=>vn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:pe,disabled:Ft,children:Ft?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[gt.map((k,A)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{sn(k),k.portion?(dt(1),yt(String(k.portion.weight)),an("portion")):(dt(0),yt(String(k.servingValue||100)),an("weight"))},children:[k.image&&a.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&a.jsx("span",{className:"nut-search-item-brand",children:k.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},A)),gt.length===0&&Pe&&!Ft&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),$==="search"&&me&&(()=>{const k=me.servingUnit||"g",A=me.portion,Q=it==="portion"&&A?At*A.weight:parseFloat(rn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&A?`${At} ${A.label}${At!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[me.image&&a.jsx("img",{src:me.image,alt:me.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:me.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(me.name)?" active":""}`,onClick:()=>lt({name:me.name,protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories,serving:me.servingSize,per100g:{protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories},servingUnit:me.servingUnit||"g",portion:me.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(me.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),me.brand&&a.jsx("p",{className:"nut-product-brand",children:me.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[me.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[me.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[me.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[me.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{an("portion"),At<1&&dt(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{an("weight"),yt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(Math.max(1,At-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:At}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,At!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(At+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:rn,onChange:qe=>yt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${rn===String(qe)?" active":""}`,onClick:()=>yt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(me.protein*ae),"p / ",Math.round(me.carbs*ae),"c / ",Math.round(me.fats*ae),"f / ",Math.round(me.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>sn(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ct({name:me.name,protein:Math.round(me.protein*ae),carbs:Math.round(me.carbs*ae),fats:Math.round(me.fats*ae),calories:Math.round(me.calories*ae),serving:$e}),children:"Add"})]})]})})(),$==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Lt.name,onChange:k=>Et(A=>({...A,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Lt.serving,onChange:k=>Et(A=>({...A,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Lt.protein,onChange:k=>Et(A=>({...A,protein:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Lt.carbs,onChange:k=>Et(A=>({...A,carbs:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Lt.fats,onChange:k=>Et(A=>({...A,fats:k.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Lt.calories,onChange:k=>Et(A=>({...A,calories:k.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Lt.name.trim(),onClick:()=>Ct({name:Lt.name,protein:parseFloat(Lt.protein)||0,carbs:parseFloat(Lt.carbs)||0,fats:parseFloat(Lt.fats)||0,calories:parseFloat(Lt.calories)||0,serving:Lt.serving||""}),children:"Add Food"})]}),$==="favourites"&&!me&&(()=>{const k=ee(),A=Q=>{if(Q.per100g){const ae=Q.per100g;sn({name:Q.name,brand:"",image:null,servingSize:Q.serving||"100g",servingValue:100,servingUnit:Q.servingUnit||"g",portion:Q.portion||null,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,per100g:!0}),Q.portion?(dt(1),yt(String(Q.portion.weight)),an("portion")):(dt(0),yt("100"),an("weight"))}else Ct({name:Q.name,protein:Q.protein,carbs:Q.carbs,fats:Q.fats,calories:Q.calories,serving:Q.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:k.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:k.map((Q,ae)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),lt(Q)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>A(Q),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:Q.name}),a.jsx("span",{className:"nut-recent-item-serving",children:Q.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[Q.calories," cal"]})]})]},ae))})})})(),$==="favourites"&&me&&(()=>{const k=me.servingUnit||"g",A=me.portion,Q=it==="portion"&&A?At*A.weight:parseFloat(rn)||0,ae=Q/100,Ye=k==="ml"?[100,200,250,500]:[50,100,150,200],$e=it==="portion"&&A?`${At} ${A.label}${At!==1?"s":""} (${Math.round(Q)}${k})`:`${Math.round(Q)}${k}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:me.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(me.name)?" active":""}`,onClick:()=>lt({name:me.name,protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories,serving:me.servingSize,per100g:{protein:me.protein,carbs:me.carbs,fats:me.fats,calories:me.calories},servingUnit:me.servingUnit||"g",portion:me.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(me.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[me.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[me.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[me.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[me.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:it==="portion"?"active":"",onClick:()=>{an("portion"),At<1&&dt(1)},children:"Portions"}),a.jsxs("button",{className:it==="weight"?"active":"",onClick:()=>{an("weight"),yt(String(Math.round(Q)||100))},children:["Custom (",k,")"]})]}),it==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(Math.max(1,At-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:At}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,At!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Q),k]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>dt(At+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",k,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:rn,onChange:qe=>yt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${rn===String(qe)?" active":""}`,onClick:()=>yt(String(qe)),children:[qe,k]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(me.protein*ae),"p / ",Math.round(me.carbs*ae),"c / ",Math.round(me.fats*ae),"f / ",Math.round(me.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>sn(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ct({name:me.name,protein:Math.round(me.protein*ae),carbs:Math.round(me.carbs*ae),fats:Math.round(me.fats*ae),calories:Math.round(me.calories*ae),serving:$e}),children:"Add"})]})]})})()]})}),a.jsx(ra,{active:"nutrition"}),ln&&a.jsx("div",{className:`toast-notification ${ln.type}`,children:ln.message})]})}const OT="/login/assets/randomiser-glq9YJkL.jpg",R5="/login/assets/programme-card-workout-CnNzTYkz.webp",C5="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",I5="/login/assets/mg-arms-BeOQU3wx.jpg",D5=60,ib=5,P5=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],M5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},L5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},V5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ab={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},ob=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:C5},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],jh=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:I5},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],BT={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},UT=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],lb=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Oc=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],cb=[5,10,15,20,30];function O5(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function B5(n){const e=[...n];for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function U5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c,accent:u}=Vi(),{isPremium:d,FREE_RANDOMISER_DURATIONS:p,FREE_RANDOMISER_WEEKLY_LIMIT:g}=Dp(),b=gr(),[x,T]=_.useState("menu"),[N,B]=_.useState(["bodyweight"]),[M,D]=_.useState("core"),[X,H]=_.useState("intermediate"),[J,he]=_.useState(d?15:5),[Ne,Te]=_.useState([]),[C,S]=_.useState(!1),P=_.useRef(!1),U=_.useRef([]),[V,q]=_.useState([]),[L,We]=_.useState(2),[wt,$]=_.useState(Oc[1]),[ye,Le]=_.useState(1),[Ke,te]=_.useState(0),[O,K]=_.useState("work"),[we,Ae]=_.useState(0),[Ge,Pe]=_.useState(!1),[ct,gt]=_.useState(0),[nt,Ft]=_.useState(null),Pn=_.useRef(null);_.useRef(null),_.useRef(null);const[Lt,Et]=_.useState(null),me=_.useCallback((Y,Ee="info")=>{Et({message:Y,type:Ee}),setTimeout(()=>Et(null),3e3)},[]),[sn,rn]=_.useState(null),[yt,At]=_.useState(null),[dt,it]=_.useState(0),[an,Ts]=_.useState(0),[Rt,ln]=_.useState([]),[ns,Qt]=_.useState(""),[Wt,cn]=_.useState(""),[vn,be]=_.useState(!1),[De,Be]=_.useState(0),[et,Ue]=_.useState(!1),[Me,ze]=_.useState({}),St=_.useRef(null),bt=_.useRef(null),[Vt,Ht]=_.useState([]),[ee,ve]=_.useState(null),[lt,Ct]=_.useState(0),[It,Xt]=_.useState(0),[Jt,zt]=_.useState(0),[Fn,os]=_.useState(0),[pn,In]=_.useState(0),[On,z]=_.useState(0),[xe,ke]=_.useState({beginner:0,intermediate:0,advanced:0}),Se=d?cb:cb.filter(Y=>p.includes(Y)),pe=!d&&lt>=g,[rt,Dt]=_.useState(null),[ut,jt]=_.useState(""),[kt,un]=_.useState(!1);_.useEffect(()=>{!s&&(!n||!e)&&b("/")},[n,e,s,b]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ee=qt(_e,"workoutLogs"),re=Dn(Ee,fn("clientId","==",t.id)),He=(await An(re)).docs.map(xn=>xn.data()),ht=He.filter(xn=>xn.type!=="programme");os(ht.length);const vt=ht.reduce((xn,_s)=>xn+(_s.duration||0),0);In(vt);const Gt={beginner:0,intermediate:0,advanced:0};ht.forEach(xn=>{xn.level&&Gt[xn.level]!==void 0&&Gt[xn.level]++}),ke(Gt);const Sn=new Date,Cs=Sn.getDay(),hn=Cs===0?-6:1-Cs,tr=new Date(Sn);tr.setDate(Sn.getDate()+hn),tr.setHours(0,0,0,0);const Os=tr.getTime(),Es=He.filter(xn=>{const _s=xn.completedAt;return _s?(_s.toDate?_s.toDate().getTime():new Date(_s).getTime())>=Os:!1});Ct(Es.filter(xn=>xn.type!=="programme").length);let aa=0;if(t)try{const xn=await Vn(Qe(_e,"clientProgrammes",t.id));if(xn.exists()){const _s=xn.data(),Tr=_s.templateId;aa=Es.filter(ls=>ls.type==="programme"&&ls.programmeId===Tr).length,Dt(Tr);const Ks=ob.find(ls=>ls.id===Tr);Ks&&jt(Ks.name);const Ir=L5[Tr];if(Ir){const ls=Object.keys(_s.completedSessions||{}).length,lr=Ir.duration*Ir.daysPerWeek;zt(lr>0?Math.round(ls/lr*100):0)}}else Dt(null),jt(""),zt(0)}catch{}Xt(aa);const _i=ht.map(xn=>xn.completedAt).filter(Boolean).map(xn=>xn.toDate?xn.toDate().getTime():new Date(xn).getTime()).sort((xn,_s)=>_s-xn);if(_i.length===0)z(0);else{const xn=new Set;_i.forEach(lr=>{const Bs=new Date(lr),qr=Bs.getDay(),Dr=qr===0?-6:1-qr,Hr=new Date(Bs);Hr.setDate(Bs.getDate()+Dr),Hr.setHours(0,0,0,0),xn.add(Hr.getTime())});const _s=[...xn].sort((lr,Bs)=>Bs-lr);let Tr=0;const Ks=new Date(Sn),Ir=Sn.getDay()===0?-6:1-Sn.getDay();Ks.setDate(Sn.getDate()+Ir),Ks.setHours(0,0,0,0);let ls=Ks.getTime();_s.includes(ls)||(ls-=10080*60*1e3);for(let lr=0;lr<200&&_s.includes(ls);lr++)Tr++,ls-=10080*60*1e3;z(Tr)}}catch(Ee){console.error("Error loading workout stats:",Ee)}finally{un(!0)}})()},[n,t,x]);const yr=()=>{const Y=[];let Ee;M==="mix"?Ee=["core","upper","lower"]:M==="fullbody"?Ee=["upper","lower"]:Ee=[M];for(const re of N)for(const Fe of Ee)Y.push(`exercises/${re}/${Fe}`);return Y},Gs=async()=>{if(P.current){for(;P.current;)await new Promise(Y=>setTimeout(Y,200));return U.current}P.current=!0,S(!0);try{const Y=yr(),Ee=[];for(const ht of Y)try{const vt=Io(Do,ht),Gt=await LT(vt);Ee.push(...Gt.items)}catch{console.warn(`Folder ${ht} not found, skipping.`)}if(Ee.length===0&&N.includes("bodyweight")&&M==="core")try{const ht=Io(Do,"core"),vt=await LT(ht);Ee.push(...vt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(Ee.length===0){const ht=N.map(Gt=>UT.find(Sn=>Sn.key===Gt)?.label).join(" + "),vt=lb.find(Gt=>Gt.key===M)?.label;return me(`No exercises found for ${ht} / ${vt}. Upload videos to Firebase Storage.`,"error"),P.current=!1,S(!1),[]}const re=new Set,Fe=Ee.filter(ht=>{const vt=ht.name.replace(/\.(mp4|gif)$/i,"");return re.has(vt)?!1:(re.add(vt),!0)}),He=await Promise.all(Fe.map(async ht=>{const vt=await Dl(ht),Gt=O5(ht.name.replace(/\.(mp4|gif)$/i,"")),Sn=/\.gif$/i.test(ht.name);return{name:Gt,videoUrl:vt,isGif:Sn}}));return U.current=He,Te(He),P.current=!1,S(!1),He}catch(Y){console.error("Error loading exercises:",Y);const Ee=Y.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Y.message||Y.code||"Unknown error"}`;return me(Ee,"error"),P.current=!1,S(!1),[]}},Zs=async()=>{if(pe)return;T("spinning"),U.current=[];const Y=await Gs();if(Y.length===0){T("setup");return}const Ee=Oc.find(Cs=>Cs.key===X);$(Ee);const re=Ee.work+Ee.rest,Fe=J*60,He=Math.floor(Fe/re);let ht,vt;He<=6?(ht=Math.max(3,Math.floor(He/2)),vt=Math.floor(He/ht)):He<=12?(ht=Math.min(6,Math.floor(He/2)),vt=Math.floor(He/ht)):(ht=Math.min(10,Math.floor(He/2)),vt=Math.floor(He/ht)),vt=Math.max(2,vt);const Gt=B5(Y),Sn=Gt.slice(0,Math.min(ht,Gt.length));q(Sn),We(vt),setTimeout(()=>T("preview"),2e3)},Xn=()=>{T("countdown"),gt(3)};_.useEffect(()=>{if(x!=="countdown")return;if(ct<=0){T("workout"),Le(1),te(0),K("work"),Ae(wt.work),Pe(!1),er();return}Hn();const Y=setTimeout(()=>gt(Ee=>Ee-1),1e3);return()=>clearTimeout(Y)},[ct,x]),_.useEffect(()=>{if(x!=="workout"||Ge)return;if(we<=0){W();return}we<=3&&Hn();const Y=setTimeout(()=>Ae(Ee=>Ee-1),1e3);return()=>clearTimeout(Y)},[we,x,Ge]);const W=()=>{if(O==="work")K("rest"),Ae(wt.rest);else{const Y=Ke+1;if(Y>=V.length){const Ee=ye+1;if(Ee>L){T("complete"),de();return}Le(Ee),te(0)}else te(Y);K("work"),Ae(wt.work),er()}},de=async()=>{if(n)try{await Ra(qt(_e,"workoutLogs"),{clientId:t.id,level:X,duration:J,equipment:N,focus:M,exerciseCount:V.length,rounds:L,exercises:V.map(Y=>Y.name),completedAt:mt.now()}),Ct(Y=>Y+1),os(Y=>Y+1),In(Y=>Y+J),ke(Y=>({...Y,[X]:(Y[X]||0)+1}))}catch(Y){console.error("Error saving workout log:",Y)}},k=async(Y,Ee,re)=>{if(!(!t||!Ee))try{const Fe=t.id,He=await Vn(Qe(_e,"coreBuddyPBs",Fe)),vt=(He.exists()?He.data():null)?.exercises||{},Gt=vt[Y];let Sn=!1;if(Gt?(Ee>(Gt.weight||0)||Ee===(Gt.weight||0)&&re>(Gt.reps||0))&&(Sn=!0):Sn=!0,Sn){const Cs={...vt,[Y]:{weight:Ee,reps:re,achievedAt:mt.now()}};await Kn(Qe(_e,"coreBuddyPBs",Fe),{clientId:t.id,exercises:Cs,updatedAt:mt.now()}),me(`New PB! ${Ee}kg  ${re} reps`,"success"),Hn(),await A(Y,Ee)}}catch(Fe){console.error("Error checking PB:",Fe)}},A=async(Y,Ee)=>{if(t)try{const re=await Vn(Qe(_e,"coreBuddyTargets",t.id));if(!re.exists())return;const He=(re.data().targets||{})[Y];if(!He||Ee<He.targetWeight)return;const ht=await Vn(Qe(_e,"coreBuddyAchievements",t.id)),vt=ht.exists()?ht.data():{clientId:t.id,badges:[],totalVolume:0};if(vt.badges.some(hn=>hn.type==="pb_target"&&hn.exercise===Y&&hn.targetWeight===He.targetWeight))return;const Sn={type:"pb_target",exercise:Y,group:M5[Y]||"push",targetWeight:He.targetWeight,achievedAt:mt.now()},Cs=[...vt.badges,Sn];await Kn(Qe(_e,"coreBuddyAchievements",t.id),{...vt,badges:Cs,updatedAt:mt.now()}),Ht(hn=>[...hn,Sn])}catch(re){console.error("Error checking target badge:",re)}},Q=async Y=>{if(!(!t||Y<=0))try{const Ee=await Vn(Qe(_e,"coreBuddyAchievements",t.id)),re=Ee.exists()?Ee.data():{clientId:t.id,badges:[],totalVolume:0},Fe=re.totalVolume||0,He=Fe+Y,ht=[];P5.forEach(Gt=>{He>=Gt.threshold&&Fe<Gt.threshold&&(re.badges.some(Cs=>Cs.type==="volume_milestone"&&Cs.milestone===Gt.threshold)||ht.push({type:"volume_milestone",milestone:Gt.threshold,label:Gt.label,achievedAt:mt.now()}))});const vt=[...re.badges,...ht];await Kn(Qe(_e,"coreBuddyAchievements",t.id),{clientId:t.id,badges:vt,totalVolume:Math.round(He),updatedAt:mt.now()}),ht.length>0&&Ht(Gt=>[...Gt,...ht])}catch(Ee){console.error("Error updating volume:",Ee)}},ae=async Y=>{if(At(Y),Y.interval){const Fe=[];for(const He of Y.exercises){let ht=null,vt=!1;if(He.storagePath)try{const Gt=Io(Do,He.storagePath);ht=await Dl(Gt),vt=/\.gif$/i.test(He.storagePath)}catch{}Fe.push({name:He.name,videoUrl:ht,isGif:vt})}q(Fe),We(Y.rounds),$({work:Y.work,rest:Y.rest}),T("preview");return}const Ee={};for(const Fe of Y.exercises)if(Fe.storagePath)try{const He=Io(Do,Fe.storagePath);Ee[Fe.name]={url:await Dl(He),isGif:/\.gif$/i.test(Fe.storagePath)}}catch{}ze(Ee);const re=Y.exercises.map(Fe=>({name:Fe.name,type:Fe.type,targetSets:Fe.sets,targetReps:Fe.reps||0,targetTime:Fe.time||0,sets:[]}));ln(re),it(0),Ts(0),Qt(""),cn(""),Ue(!1),be(!1),Be(0),Ht([]),ve(null),T("muscle_workout")},Ye=()=>{const Y=St.current;Y&&(Y.paused?(Y.play(),Ue(!0)):(Y.pause(),Ue(!1)))};_.useEffect(()=>{if(x!=="muscle_workout"||!vn||De<=0){x==="muscle_workout"&&vn&&De<=0&&(be(!1),Hn());return}return bt.current=setTimeout(()=>Be(Y=>Y-1),1e3),()=>clearTimeout(bt.current)},[x,vn,De]);const $e=async()=>{const Y=Rt[dt];let Ee={};if(Y.type==="weighted"){const He=parseFloat(ns)||0,ht=parseInt(Wt)||0;if(ht===0){me("Enter your reps","error");return}Ee={weight:He,reps:ht}}else if(Y.type==="reps"){const He=parseInt(Wt)||0;if(He===0){me("Enter your reps","error");return}Ee={reps:He}}else if(Y.type==="timed"){const He=Y.targetTime-De;Ee={time:Math.max(He,1)}}const re=[...Rt];re[dt]={...Y,sets:[...Y.sets,Ee]},ln(re),Y.type==="weighted"&&Ee.weight>0&&await k(Y.name,Ee.weight,Ee.reps);const Fe=Y.sets.length+1;if(Fe<Y.targetSets)Ts(Fe),cn(""),be(!1),Be(0);else if(dt+1<Rt.length){const He=dt+1;it(He),Ts(0),Qt(""),cn(""),Ue(!1),be(!1),Be(0)}else await qe(re),T("muscle_complete")},qe=async Y=>{if(!(!n||!t))try{const Ee=Y.reduce((Fe,He)=>Fe+He.sets.reduce((ht,vt)=>ht+(vt.weight||0)*(vt.reps||0),0),0),re=Y.reduce((Fe,He)=>Fe+He.sets.length,0);await Ra(qt(_e,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:sn,sessionId:yt?.id,sessionName:yt?.name,exerciseCount:Y.length,totalSets:re,duration:Math.round(re*1.5),volume:Math.round(Ee),exercises:Y.map(Fe=>({name:Fe.name,type:Fe.type,sets:Fe.sets})),completedAt:mt.now()}),Ee>0&&await Q(Ee),Vt.length>0&&ve({badges:[...Vt]})}catch(Ee){console.error("Error saving muscle group workout log:",Ee)}},Ut=_.useRef(null),Mt=()=>(Ut.current||(Ut.current=new(window.AudioContext||window.webkitAudioContext)),Ut.current),Hn=()=>{try{const Y=Mt(),Ee=Y.createOscillator(),re=Y.createGain();Ee.connect(re),re.connect(Y.destination),Ee.frequency.value=880,re.gain.value=.3,Ee.start(Y.currentTime),Ee.stop(Y.currentTime+.15)}catch{}},er=()=>{try{const Y=Mt(),Ee=Y.createOscillator(),re=Y.createGain();Ee.connect(re),re.connect(Y.destination),Ee.frequency.value=1200,re.gain.value=.4,Ee.start(Y.currentTime),Ee.stop(Y.currentTime+.3)}catch{}};_.useEffect(()=>{if(x!=="workout"||O!=="work"||!V[Ke]?.isGif)return;const Ee=setInterval(()=>{const re=Pn.current;if(!re)return;const Fe=re.getAttribute("src");re.removeAttribute("src"),setTimeout(()=>{Pn.current&&Pn.current.setAttribute("src",Fe)},0)},4e3);return()=>clearInterval(Ee)},[x,O,Ke,ye,V]);const Vs=(Y,Ee,re)=>{const Fe=Math.round(Y/Ee*D5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:r5.map((He,ht)=>a.jsx("line",{x1:He.x1,y1:He.y1,x2:He.x2,y2:He.y2,className:ht<Fe?`wk-tick-filled ${re}`:"wk-tick-empty",strokeWidth:He.thick?"3":"2"},ht))})},zn=()=>{const Y=V.length*L;return((ye-1)*V.length+Ke+(O==="rest"?.5:0))/Y},qn=Lt&&a.jsx("div",{className:`toast-notification ${Lt.type}`,children:Lt.message});if(s)return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(x==="menu")return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:a.jsx("img",{src:OT,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Programmes ",!d&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[ob.length," available"]})]}),d?a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:ob.map((Y,Ee)=>Y.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${Ee*.06}s`},children:[a.jsx("img",{src:Y.image,alt:Y.name,className:"wk-prog-img"}),Ee===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${Ee*.06}s`},children:[a.jsx("img",{src:R5,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:V5[Y.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[Y.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:Y.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:Y.name.toUpperCase()}),a.jsxs("p",{children:[Y.daysPerWeek,"x per week  ",Y.focus==="fullbody"?"Full Body":Y.focus.charAt(0).toUpperCase()+Y.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),Ee===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id))})}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock programmes"})]}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Muscle Groups ",!d&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[jh.length," groups"]})]}),d?a.jsx("div",{className:"wk-muscle-grid",children:jh.map((Y,Ee)=>a.jsx("button",{className:`wk-muscle-hero-card${Y.image?" wk-muscle-thumb":""}`,onClick:()=>{rn(Y.key),T("muscle_sessions")},style:{animationDelay:`${Ee*.05}s`},children:Y.image?a.jsx("img",{src:Y.image,alt:Y.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:OT,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ab[Y.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Y.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:Y.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[BT[Y.key]?.length||0," sessions"]})]})]})]})},Y.key))}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),a.jsx(ra,{active:"workouts"}),qn]});if(x==="setup"){const Y=lb.find(re=>re.key===M)?.label||M,Ee=Oc.find(re=>re.key===X)?.label||X;return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Fn}`,pct:Fn>0?Math.min(Math.round(Fn/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${lt}/${ib}`,pct:Math.round(Math.min(lt,ib)/ib*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${On}`,pct:On>0?Math.min(Math.round(On/12*100),100):0,color:"#38B6FF",size:"normal"}].map(re=>{const He=2*Math.PI*38,ht=He-re.pct/100*He;return a.jsxs("div",{className:`wk-stat-item${re.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:re.color},strokeDasharray:He,strokeDashoffset:ht})]}),a.jsx("span",{className:"wk-stat-value",style:{color:re.color},children:re.value})]}),a.jsx("span",{className:"wk-stat-label",children:re.label})]},re.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:lb.map(re=>a.jsxs("button",{className:`wk-equip-btn${M===re.key?" active":""}${re.key==="mix"?" wk-mix-btn":""}`,onClick:()=>D(re.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:re.icon})}),a.jsx("span",{children:re.label})]},re.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Oc.map(re=>a.jsxs("button",{className:`wk-level-card wk-level-${re.key}${X===re.key?" active":""}`,onClick:()=>H(re.key),children:[a.jsx("span",{className:"wk-level-name",children:re.label}),a.jsx("span",{className:"wk-level-desc",children:re.desc})]},re.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:cb.map(re=>{const Fe=!Se.includes(re);return a.jsxs("button",{className:`wk-time-btn${J===re?" active":""}${Fe?" locked":""}`,onClick:()=>!Fe&&he(re),disabled:Fe,children:[a.jsx("span",{className:"wk-time-num",children:re}),a.jsx("span",{className:"wk-time-unit",children:Fe?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},re)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:UT.map(re=>{const Fe=N.includes(re.key);return a.jsxs("button",{className:`wk-equip-btn${Fe?" active":""}`,onClick:()=>{B(He=>Fe&&He.length===1?He:Fe?He.filter(ht=>ht!==re.key):[...He,re.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:re.icon})}),a.jsx("span",{children:re.label})]},re.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[Y,"  ",Ee,"  ",J," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[pe&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Zs,disabled:C||pe,children:C?"Loading exercises...":pe?"Limit Reached":"Randomise Workout"})]}),qn]})}if(x==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:$h.map((Y,Ee)=>a.jsx("line",{x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,className:"wk-spin-tick",strokeWidth:Y.thick?"3.5":"2",style:{animationDelay:`${Ee*.03}s`}},Ee))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),qn]});if(x==="preview"){const Y=yt?.interval?{work:yt.work,rest:yt.rest}:Oc.find(re=>re.key===X),Ee=V.length*L*(Y.work+Y.rest);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T(yt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[yt?.interval&&a.jsx("h2",{className:"mg-preview-title",children:yt.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(Ee/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[Y.work,"/",Y.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:V.map((re,Fe)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Fe*.06}s`},onClick:()=>Ft(re),children:[a.jsx("span",{className:"wk-preview-num",children:Fe+1}),a.jsx("div",{className:"wk-preview-thumb",children:re.isGif?a.jsx("img",{src:re.videoUrl,alt:re.name,loading:"lazy"}):a.jsx("video",{src:`${re.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:re.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Fe))}),nt&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Ft(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:re=>re.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Ft(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:nt.isGif?a.jsx("img",{src:nt.videoUrl,alt:nt.name}):a.jsx("video",{src:nt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:nt.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!yt?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>Zs(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:Xn,children:"Start Workout"})]})]})]})}if(x==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:ct}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(x==="workout"){const Y=V[Ke],Ee=O==="work"?wt.work:wt.rest,re=O==="rest"?Ke+1<V.length?V[Ke+1]:ye<L?V[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"wk-video-container",children:O==="work"?Y.isGif?a.jsx("img",{ref:Pn,className:"wk-video",src:Y.videoUrl,alt:Y.name},Y.videoUrl):a.jsx("video",{className:"wk-video",src:Y.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Y.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),re&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",re.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ke+1," / ",V.length]}),a.jsx("h2",{className:"wk-exercise-name",children:Y.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",ye," of ",L]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Vs(we,Ee,O==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:we}),a.jsx("span",{className:`wk-timer-phase ${O}`,children:O==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Pe(!Ge),children:Ge?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ae(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${zn()*100}%`}})})]})}if(x==="complete"){const Y=Oc.find(re=>re.key===X),Ee=V.length*L*(Y.work+Y.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:$h.map((re,Fe)=>a.jsx("line",{x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,className:"wk-tick-complete",strokeWidth:re.thick?"3.5":"2",style:{animationDelay:`${Fe*.02}s`}},Fe))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(Ee/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length*L}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{At(null),rn(null),T("menu")},children:"Done"})})]})})}if(x==="muscle_sessions"){const Y=jh.find(re=>re.key===sn),Ee=BT[sn]||[];return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ab[sn]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Y?.icon})})}),a.jsxs("h2",{children:[Y?.label," Workouts"]}),a.jsxs("p",{children:[Ee.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:Ee.map((re,Fe)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{At(re),T("muscle_overview")},style:{animationDelay:`${Fe*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:re.name}),a.jsx("p",{children:re.desc}),a.jsx("div",{className:"mg-session-meta",children:re.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[re.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[re.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[re.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const He=re.exercises.map(Gt=>Gt.sets||0),ht=Math.min(...He),vt=Math.max(...He);return ht===vt?`${ht} sets each`:`${ht}-${vt} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},re.id))})]}),qn]})}if(x==="muscle_overview"){const Y=yt;if(!Y)return null;const Ee=jh.find(re=>re.key===sn);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:ab[sn]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:Ee?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:Y.name}),Y.level&&a.jsx("span",{className:"mg-overview-level",children:Y.level})]}),a.jsx("p",{className:"mg-overview-desc",children:Y.desc})]}),Y.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:Y.overview})]}),Y.tips&&Y.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:Y.tips.map((re,Fe)=>a.jsx("li",{children:re},Fe))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Y.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:Y.exercises.map((re,Fe)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Fe+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:re.name}),Y.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[Y.work,"s work / ",Y.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[re.sets," sets  ",re.reps?`${re.reps} reps`:`${re.time}s`,re.type==="weighted"&&"  weighted"]})]})]},Fe))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ae(Y),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),qn]})}if(x==="muscle_workout"){const Y=yt;if(!Y)return null;const Ee=Y.exercises[dt],re=Rt[dt];if(!Ee||!re)return null;const Fe=re.sets.length,He=Y.exercises.length,ht=Y.exercises.reduce((hn,tr)=>hn+(tr.sets||0),0),Gt=Rt.reduce((hn,tr)=>hn+tr.sets.length,0)/ht*100,Sn=Me[Ee.name];Ee.type==="timed"&&De===0&&!vn&&Fe===an&&setTimeout(()=>Be(Ee.time),0);const Cs=Fe+1<Ee.sets?"Log Set":dt+1<He?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Gt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",dt+1,"/",He]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Sn?a.jsxs("div",{className:"mg-video-container",onClick:Ye,children:[Sn.isGif?a.jsx("img",{className:"mg-video",src:Sn.url,alt:Ee.name}):a.jsx("video",{ref:St,className:"mg-video",src:Sn.url,loop:!0,muted:!0,playsInline:!0},Ee.name),!et&&!Sn.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:Ee.name}),a.jsx("span",{className:`mg-ex-type-badge ${Ee.type}`,children:Ee.type==="weighted"?"Weight + Reps":Ee.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Fe+1," of ",Ee.sets]}),Ee.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Ee.reps," reps"]}),Ee.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",Ee.time,"s"]})]}),Ee.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:ns,onChange:hn=>Qt(hn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Wt,onChange:hn=>cn(hn.target.value),placeholder:"0"})]})]}),Ee.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Wt,onChange:hn=>cn(hn.target.value),placeholder:"0"})]})}),Ee.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[De,"s"]})}),vn?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>be(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{De===0&&Be(Ee.time),be(!0)},children:De<Ee.time&&De>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:$e,children:Cs}),re.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:re.sets.map((hn,tr)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",tr+1,": ",hn.weight!=null?`${hn.weight}kg  ${hn.reps}`:hn.reps!=null?`${hn.reps} reps`:`${hn.time}s`]})]},tr))})]})]}),qn]})}if(x==="muscle_complete"){const Y=Rt.reduce((Fe,He)=>Fe+He.sets.length,0),Ee=Rt.reduce((Fe,He)=>Fe+He.sets.reduce((ht,vt)=>ht+(vt.weight||0)*(vt.reps||0),0),0),re=jh.find(Fe=>Fe.key===sn)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:$h.map((Fe,He)=>a.jsx("line",{x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,className:"wk-tick-complete",strokeWidth:Fe.thick?"3.5":"2",style:{animationDelay:`${He*.02}s`}},He))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[re," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:yt?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Rt.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Y}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),Ee>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(Ee).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{At(null),rn(null),ve(null),T("menu")},children:"Done"})})]}),ee&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>ve(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:ee.badges.length===1?"Badge Earned!":`${ee.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:ee.badges.map((Fe,He)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Fe.type==="pb_target"?`${Fe.exercise}  ${Fe.targetWeight}kg`:Fe.label},He))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const F5=60,z5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},q5=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],FT=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function em(n,e,t){const s=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,o=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:s,time:o}}const H5={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function $5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c,accent:u}=Vi(),d=gr(),p=Li(),[g,b]=_.useState("loading"),[x,T]=_.useState(null),N=_.useRef(!1),[B,M]=_.useState(null),[D,X]=_.useState(1),[H,J]=_.useState(0),[he,Ne]=_.useState(0),[Te,C]=_.useState(0),[S,P]=_.useState([]),[U,V]=_.useState(""),[q,L]=_.useState(""),[We,wt]=_.useState(!1),[$,ye]=_.useState(0),Le=_.useRef(null),[Ke,te]=_.useState({}),[O,K]=_.useState(!1),we=_.useRef(null),[Ae,Ge]=_.useState(null),[Pe,ct]=_.useState([]);_.useEffect(()=>{window.scrollTo(0,0)},[g]);const[gt,nt]=_.useState(null),Ft=_.useCallback((be,De="info")=>{nt({message:be,type:De}),setTimeout(()=>nt(null),4e3)},[]),Pn=_.useRef(null),Lt=()=>(Pn.current||(Pn.current=new(window.AudioContext||window.webkitAudioContext)),Pn.current),Et=()=>{try{const be=Lt(),De=be.createOscillator(),Be=be.createGain();De.connect(Be),Be.connect(be.destination),De.frequency.value=1200,Be.gain.value=.4,De.start(be.currentTime),De.stop(be.currentTime+.3)}catch{}};_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t)return;(async()=>{try{const De=Qe(_e,"clientProgrammes",t.id),Be=await Vn(De);Be.exists()&&M(Be.data());const et=p.state?.templateId;if(et&&!N.current){const Ue=FT.find(Me=>Me.id===et);if(Ue){N.current=!0,T(Ue),b("overview");return}}Be.exists()?b("dashboard"):d("/client/core-buddy/workouts",{replace:!0})}catch(De){console.error("Error loading programme:",De),d("/client/core-buddy/workouts",{replace:!0})}})()},[t]),_.useEffect(()=>{if(!We||$<=0){We&&$<=0&&(wt(!1),Et());return}return Le.current=setTimeout(()=>ye(be=>be-1),1e3),()=>clearTimeout(Le.current)},[We,$]);const me=async be=>{if(t)try{await Kn(Qe(_e,"clientProgrammes",t.id),be),M(be)}catch(De){console.error("Error saving programme:",De),Ft("Failed to save. Check Firestore rules for clientProgrammes.","error")}},sn=async be=>{const De={templateId:be.id,startDate:mt.now(),completedSessions:{}};await me(De),b("dashboard")},rn=async()=>{if(t)try{await Ar(Qe(_e,"clientProgrammes",t.id)),M(null),b("browse")}catch(be){console.error("Error quitting programme:",be)}},yt=()=>B?FT.find(be=>be.id===B.templateId):null,At=()=>{if(!B?.startDate)return 1;const be=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),Be=new Date-be,et=Math.floor(Be/(1e3*60*60*24));return Math.floor(et/7)+1},dt=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const be=B.completedSessions||{},De=Object.keys(be).length,Be=yt();if(!Be)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const et=Be.duration*Be.daysPerWeek,Ue=At(),Me=Math.min(Ue,Be.duration);let ze=0;for(let bt=0;bt<Be.daysPerWeek;bt++)be[`w${Me}d${bt}`]&&ze++;if(De>=et)return{currentWeek:Be.duration,completedThisWeek:Be.daysPerWeek,nextDay:-1,totalCompleted:De,totalSessions:et,complete:!0};if(Ue>Be.duration)return{currentWeek:Be.duration,completedThisWeek:ze,nextDay:-1,totalCompleted:De,totalSessions:et,complete:!0};let St=-1;for(let bt=0;bt<Be.daysPerWeek;bt++)if(!be[`w${Me}d${bt}`]){St=bt;break}return{currentWeek:Me,completedThisWeek:ze,nextDay:St,nextWeek:Me,totalCompleted:De,totalSessions:et}},it=be=>{const De=At();return be<De},an=(be,De,Be)=>{if(!B||be<=1)return null;const et=`w${be-1}d${De}`,Ue=B.completedSessions?.[et];if(!Ue)return null;const Me=Ue.exercises?.find(ze=>ze.name===Be);return Me?.sets?.length?Me.sets[Me.sets.length-1]:null},Ts=(be,De)=>{const Be=yt();if(!Be)return;X(be),J(De),Ne(0),C(0),P([]),L(""),wt(!1),ye(0),K(!1),te({});const et=Be.days[De],Ue=et.exercises.map(bt=>{const Vt=em(bt,be,Be);return{name:bt.name,type:bt.type,pbKey:bt.pbKey,targetSets:Vt.sets,targetReps:Vt.reps,targetTime:Vt.time,sets:[]}});P(Ue);const Me=et.exercises[0],ze=an(be,De,Me.name);ze?.weight&&Me.type==="weighted"?V(String(ze.weight)):V(""),(async()=>{const bt={};for(const Vt of et.exercises)if(Vt.storagePath)try{const Ht=Io(Do,Vt.storagePath),ee=await Dl(Ht);bt[Vt.name]={url:ee,isGif:/\.gif$/i.test(Vt.storagePath)}}catch(Ht){console.warn(`Video not found for ${Vt.name}:`,Ht)}te(bt)})(),b("session")},Rt=async()=>{yt();const be=S[he];if(!be)return;let De={};if(be.type==="weighted"){const Ue=parseFloat(U)||0,Me=parseInt(q)||0;if(Me===0){Ft("Enter your reps","error");return}De={weight:Ue,reps:Me}}else if(be.type==="reps"){const Ue=parseInt(q)||0;if(Ue===0){Ft("Enter your reps","error");return}De={reps:Ue}}else if(be.type==="timed"){const Ue=be.targetTime-$;De={time:Math.max(Ue,1)}}const Be=[...S];Be[he]={...be,sets:[...be.sets,De]},P(Be),be.type==="weighted"&&De.weight>0&&await Qt(be.name,De.weight,De.reps);const et=be.sets.length+1;if(et<be.targetSets)C(et),V(De.weight?String(De.weight):""),L(""),wt(!1),ye(0);else if(he+1<S.length){const Ue=he+1;Ne(Ue),C(0),K(!1);const ze=yt()?.days[H]?.exercises[Ue],St=an(D,H,ze?.name);St?.weight&&ze?.type==="weighted"?V(String(St.weight)):V(""),L(""),wt(!1),ye(0)}else await ln(Be)},ln=async be=>{if(!B||!t)return;const De=`w${D}d${H}`,Be={...B.completedSessions,[De]:{completedAt:new Date().toISOString(),exercises:be.map(Me=>({name:Me.name,type:Me.type,sets:Me.sets}))}},et={...B,completedSessions:Be};await me(et);const Ue=be.reduce((Me,ze)=>Me+ze.sets.reduce((St,bt)=>St+(bt.weight||0)*(bt.reps||0),0),0);Ue>0&&await ns(Ue);try{const Me=yt();await Ra(qt(_e,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Me?.id,programmeName:Me?.name,week:D,day:H+1,exerciseCount:be.length,duration:Math.round(be.reduce((ze,St)=>ze+St.sets.length*1.5,0)),volume:Math.round(Ue),completedAt:mt.now()})}catch(Me){console.error("Error saving workout log:",Me)}Pe.length>0&&(Ge({badges:[...Pe]}),ct([])),b("sessionComplete")},ns=async be=>{if(t)try{const De=await Vn(Qe(_e,"coreBuddyAchievements",t.id)),Be=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0},et=Be.totalVolume||0,Ue=et+be,Me=[];q5.forEach(St=>{Ue>=St.threshold&&et<St.threshold&&(Be.badges.some(Vt=>Vt.type==="volume_milestone"&&Vt.milestone===St.threshold)||Me.push({type:"volume_milestone",milestone:St.threshold,label:St.label,achievedAt:mt.now()}))});const ze=[...Be.badges,...Me];await Kn(Qe(_e,"coreBuddyAchievements",t.id),{clientId:t.id,badges:ze,totalVolume:Math.round(Ue),updatedAt:mt.now()}),Me.length>0&&ct(St=>[...St,...Me])}catch(De){console.error("Error updating volume:",De)}},Qt=async(be,De,Be)=>{if(t)try{const et=t.id,Ue=await Vn(Qe(_e,"coreBuddyPBs",et)),ze=(Ue.exists()?Ue.data():null)?.exercises||{},St=ze[be];let bt=!1;if(St?(De>(St.weight||0)||De===(St.weight||0)&&Be>(St.reps||0))&&(bt=!0):bt=!0,bt){const Vt={...ze,[be]:{weight:De,reps:Be,achievedAt:mt.now()}};await Kn(Qe(_e,"coreBuddyPBs",et),{clientId:t.id,exercises:Vt,updatedAt:mt.now()}),Ft(`New PB! ${De}kg  ${Be} reps`,"success"),Et(),await Wt(be,De)}}catch(et){console.error("Error checking PB:",et)}},Wt=async(be,De)=>{if(t)try{const Be=await Vn(Qe(_e,"coreBuddyTargets",t.id));if(!Be.exists())return;const Ue=(Be.data().targets||{})[be];if(!Ue||De<Ue.targetWeight)return;const Me=await Vn(Qe(_e,"coreBuddyAchievements",t.id)),ze=Me.exists()?Me.data():{clientId:t.id,badges:[],totalVolume:0};if(ze.badges.some(Ht=>Ht.type==="pb_target"&&Ht.exercise===be&&Ht.targetWeight===Ue.targetWeight))return;const bt={type:"pb_target",exercise:be,group:z5[be]||"push",targetWeight:Ue.targetWeight,achievedAt:mt.now()},Vt=[...ze.badges,bt];await Kn(Qe(_e,"coreBuddyAchievements",t.id),{...ze,badges:Vt,updatedAt:mt.now()}),ct(Ht=>[...Ht,bt])}catch(Be){console.error("Error checking target badge:",Be)}},cn=gt&&a.jsxs("div",{className:`toast-notification ${gt.type}`,children:[gt.type==="success"&&a.jsx("span",{children:" "}),gt.message]}),vn=(be,De)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:De,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(s||g==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(g==="browse")return d("/client/core-buddy/workouts",{replace:!0}),null;if(g==="overview"&&x){const be=x;return a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[vn(be.name,()=>d("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:H5[be.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:be.name}),a.jsx("p",{className:"pg-overview-desc",children:be.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:be.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:be.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:be.duration*be.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:be.days.map((De,Be)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:De.name}),a.jsx("span",{className:"pg-day-label",children:De.label})]}),a.jsx("div",{className:"pg-day-exercises",children:De.exercises.map((et,Ue)=>{const Me=em(et,1,be);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:et.name}),a.jsx("span",{className:"pg-day-ex-target",children:et.type==="timed"?`${Me.sets}${Me.time}s`:`${Me.sets}${Me.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${et.type}`,children:et.type==="weighted"?"WT":et.type==="timed"?"TMR":"BW"})]},Ue)})})]},Be))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",be.repProg," reps/week",be.timeProg?`, +${be.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>sn(be),children:"Start Programme"})]}),cn]})}if(g==="dashboard"){const be=yt();if(!be)return b("browse"),null;const De=dt(),Be=B?.completedSessions||{},et=De.totalSessions?Math.round(De.totalCompleted/De.totalSessions*100):0;return Math.round(De.totalCompleted/(De.totalSessions||1)*F5),a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[vn("Programme",()=>d("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-et/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[et,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:be.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[et,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",De.currentWeek," of ",be.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:be.duration},(Ue,Me)=>{const ze=Me+1,St=it(ze);return a.jsxs("div",{className:`pg-week-row${ze===De.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",ze]}),a.jsx("div",{className:"pg-week-days",children:be.days.map((bt,Vt)=>{const Ht=`w${ze}d${Vt}`,ee=!!Be[Ht],ve=!ee&&St,lt=!ee&&!ve&&ze===De.currentWeek&&!De.complete;return a.jsx("button",{className:`pg-day-dot${ee?" done":""}${ve?" missed":""}${lt?" next":""}`,disabled:!lt,onClick:()=>{lt&&Ts(ze,Vt)},children:ee?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):ve?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:bt.name.replace("Day ","")})},Vt)})})]},Me)})}),!De.complete&&(()=>{const Ue=be.days.map((Me,ze)=>({day:Me,d:ze})).filter(({d:Me})=>!Be[`w${De.currentWeek}d${Me}`]);return Ue.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Ue.length===be.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",De.currentWeek,"  ",Ue.length," session",Ue.length!==1?"s":""," left this week"]}),Ue.map(({day:Me,d:ze})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[Me.name,": ",Me.label]}),Me.exercises.map((St,bt)=>{const Vt=em(St,De.currentWeek,be);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:St.name}),a.jsx("span",{className:"pg-next-ex-target",children:St.type==="timed"?`${Vt.sets}${Vt.time}s`:`${Vt.sets}${Vt.reps}`})]},bt)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>Ts(De.currentWeek,ze),children:["Start ",Me.name]})]},ze))]})})(),De.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",De.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:rn,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&rn()},children:"Quit Programme"})]}),a.jsx(ra,{active:"workouts"}),cn]})}if(g==="session"){const be=yt();if(!be)return null;const De=be.days[H],Be=De.exercises[he],et=em(Be,D,be),Ue=S[he],Me=Ue?.sets?.length||0,ze=De.exercises.length,St=(he+Me/et.sets)/ze,bt=Ke[Be.name],Vt=an(D,H,Be.name);Be.type==="timed"&&$===0&&!We&&Me===Te&&setTimeout(()=>ye(et.time),0);const Ht=()=>{bt?.isGif?K(!O):we.current&&(O?we.current.pause():we.current.play(),K(!O))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${St*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&b("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[he+1," / ",ze]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",D,"  ",De.name]})]})]}),bt&&a.jsxs("div",{className:"pg-video-container",onClick:Ht,children:[bt.isGif?a.jsx("img",{className:"pg-video",src:bt.url,alt:Be.name}):a.jsx("video",{ref:we,className:"pg-video",src:bt.url,loop:!0,muted:!0,playsInline:!0},Be.name),!O&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Be.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Be.type}`,children:Be.type==="weighted"?"Weight + Reps":Be.type==="timed"?"Timed":"Reps Only"}),Be.type==="weighted"&&Vt&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Vt.weight,"kg x ",Vt.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Me+1," of ",et.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Be.type==="timed"?`${et.time}s hold`:`${et.reps} reps`]})]}),Be.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:U,onChange:ee=>V(ee.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:ee=>L(ee.target.value),placeholder:String(et.reps),className:"pg-input"})]})]}),Be.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:ee=>L(ee.target.value),placeholder:String(et.reps),className:"pg-input"})]})}),Be.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[$,"s"]})}),We?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>wt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{$===0&&ye(et.time),wt(!0)},children:$<et.time&&$>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Rt,disabled:Be.type==="timed"&&We,children:Me+1<et.sets?"Log Set":he+1<ze?"Log Set  Next Exercise":"Log Set  Complete"}),Ue?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Ue.sets.map((ee,ve)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",ve+1,": ",ee.weight!==void 0?`${ee.weight}kg  ${ee.reps}`:ee.time!==void 0?`${ee.time}s`:`${ee.reps} reps`]})]},ve))})]}),cn]})}if(g==="sessionComplete"){const De=yt()?.days[H],Be=S.reduce((Ue,Me)=>Ue+Me.sets.length,0),et=S.reduce((Ue,Me)=>Ue+Me.sets.reduce((ze,St)=>ze+(St.weight||0)*(St.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:$h.map((Ue,Me)=>a.jsx("line",{x1:Ue.x1,y1:Ue.y1,x2:Ue.x2,y2:Ue.y2,className:"pg-tick-complete",strokeWidth:Ue.thick?"3.5":"2",style:{animationDelay:`${Me*.02}s`}},Me))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",D,"  ",De?.name,": ",De?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:S.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Be}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),et>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(et).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>b("dashboard"),children:"Back to Programme"})]}),Ae&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>Ge(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ue=>Ue.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Ae.badges.length===1?"Badge Earned!":`${Ae.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Ae.badges.map((Ue,Me)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Ue.type==="pb_target"?`${Ue.exercise}  ${Ue.targetWeight}kg`:Ue.label},Me))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>Ge(null),children:"Tap to dismiss"})]})}),cn]})}return null}const W5={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},G5={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},ub=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function K5(n){return W5[n]||"push"}function Q5(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function Y5(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function X5(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c,accent:u}=Vi(),d=gr(),[p,g]=_.useState(!0),[b,x]=_.useState(null),[T,N]=_.useState({}),[B,M]=_.useState([]),[D,X]=_.useState(null),[H,J]=_.useState(0),[he,Ne]=_.useState({});_.useRef(null),_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!t)return;(async()=>{try{const[ye,Le,Ke,te]=await Promise.all([Vn(Qe(_e,"coreBuddyAchievements",t.id)),Vn(Qe(_e,"coreBuddyPBs",t.id)),Vn(Qe(_e,"achievements",t.id)),An(Dn(qt(_e,"workoutLogs"),fn("clientId","==",t.id)))]);ye.exists()&&x(ye.data()),Le.exists()&&N(Le.data().exercises||{}),Ke.exists()&&(M(Object.keys(Ke.data().badges||{})),Ne(Ke.data().progress||{})),J(te.docs.length)}catch(ye){console.error("Error loading achievements:",ye)}g(!1)})()},[t]);const Te=b?.badges||[],C=b?.totalVolume||0,S=Te.filter($=>$.type==="pb_target"),P=Te.filter($=>$.type==="volume_milestone"),U={push:[],pull:[],lower:[],core:[]};S.forEach($=>{const ye=$.group||K5($.exercise);U[ye]&&U[ye].push($)});const V=ub.find($=>C<$.threshold),q=ub.filter($=>C>=$.threshold).pop()?.threshold||0,L=V?(C-q)/(V.threshold-q):1;if(s||p)return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const We=Te.length+B.length,wt=We>0||C>0||H>0;return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>d("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:We}),a.jsx("span",{className:"ach-stat-label",children:We===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Q5(C)}),a.jsxs("span",{className:"ach-stat-label",children:[Y5(C)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!wt&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const ye=Jm.filter(te=>te.category===$.key);if(ye.length===0)return null;const Le=(()=>{switch($.key){case"workouts":return H;case"streaks":return he.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return he.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return he.habitStreak||0;default:return 0}})(),Ke=ye.filter(te=>B.includes(te.id)).length;return a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:$.iconPath})}),$.title]}),a.jsx("div",{className:"ach-workout-carousel",children:ye.map(te=>{const O=B.includes(te.id);return a.jsxs("button",{className:`ach-workout-badge${O?" unlocked":" locked"}`,onClick:()=>X(te),children:[a.jsx("img",{src:te.img,alt:te.name,className:"ach-workout-badge-img"}),!O&&te.threshold&&a.jsx("div",{className:"ach-workout-badge-progress",children:a.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Le/te.threshold*100,100)}%`}})})]},te.id)})}),a.jsxs("p",{className:"ach-workout-badges-count",children:[Ke,"/",ye.length," unlocked"]})]},$.key)}),D&&a.jsx("div",{className:"ach-badge-overlay",onClick:()=>X(null),children:a.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[a.jsx("img",{src:D.img,alt:D.name,className:`ach-badge-overlay-img${B.includes(D.id)?"":" ach-badge-overlay-img-locked"}`}),a.jsx("p",{className:"ach-badge-overlay-desc",children:D.desc}),B.includes(D.id)?a.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),a.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>X(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:$h.map(($,ye)=>{const Le=ye<Math.round(L*60);return a.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Le?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},ye)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),V&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:V.label})," (",(V.threshold-C).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:ub.map(($,ye)=>{const Le=C>=$.threshold,Ke=P.find(te=>te.milestone===$.threshold);return a.jsxs("div",{className:`ach-milestone ${Le?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),a.jsx("span",{className:"ach-milestone-label",children:$.label}),Ke?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},ye)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),S.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(U).map(([$,ye])=>{if(ye.length===0)return null;const Le=G5[$];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Le.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:Le.color},children:Le.label}),a.jsx("span",{className:"ach-group-count",children:ye.length})]}),a.jsx("div",{className:"ach-badge-grid",children:ye.map((Ke,te)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${te*.06}s`,"--group-color":Le.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:Le.color,boxShadow:`0 0 12px ${Le.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Le.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:Le.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:Ke.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:Le.color},children:[Ke.targetWeight,"kg"]}),Ke.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},te))})]},$)})]})]}),a.jsx(ra,{active:"home"})]})}const tm=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"}];function J5(n){const e=new Date(n),t=e.getDay(),s=t===0?-6:1-t;return e.setDate(e.getDate()+s),e.setHours(0,0,0,0),e}function hb(n){return n.toISOString().split("T")[0]}function Z5(n){return Array.from({length:7},(e,t)=>{const s=new Date(n);return s.setDate(n.getDate()+t),s})}function eO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c,accent:u}=Vi(),d=gr(),[p,g]=_.useState({}),[b,x]=_.useState(!0),[T,N]=_.useState(!1),[B,M]=_.useState(0),[D,X]=_.useState(null),[H,J]=_.useState(null),[he,Ne]=_.useState(!1),Te=_.useRef([]),C=_.useRef([]),S=_.useCallback((K,we="info")=>{X({message:K,type:we}),setTimeout(()=>X(null),3e3)},[]),P=new Date,U=hb(P),V=J5(P),q=Z5(V),L=["M","T","W","T","F","S","S"];_.useEffect(()=>{!s&&(!n||!e)&&d("/")},[n,e,s,d]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const we=qt(_e,"habitLogs"),Ae=Dn(we,fn("clientId","==",t.id)),Ge=await An(Ae),Pe={};Ge.docs.forEach(nt=>{const Ft=nt.data();Pe[Ft.date]={...Ft,_id:nt.id}}),g(Pe);let ct=0;const gt=new Date(P);for(;;){const nt=hb(gt),Ft=Pe[nt];if(Ft)if(Object.values(Ft.habits||{}).filter(Boolean).length>=3)ct++,gt.setDate(gt.getDate()-1);else break;else if(nt===U)gt.setDate(gt.getDate()-1);else break}M(ct)}catch(we){console.error("Error loading habit logs:",we)}finally{x(!1)}})()},[n,t]);const We=p[U]||{habits:{}},wt=async K=>{if(!n||T)return;const we=We.habits?.[K]||!1;we||(Te.current=[...Array(10)].map((Ae,Ge)=>{const Pe=Ge/10*2*Math.PI,ct=18+Math.random()*20;return{tx:Math.cos(Pe)*ct,ty:Math.sin(Pe)*ct,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),J(K),setTimeout(()=>J(null),700)),N(!0);try{const Ae=We.habits||{},Ge={...Ae,[K]:!Ae[K]},Pe=We._id||`${t.id}_${U}`;await Kn(Qe(_e,"habitLogs",Pe),{clientId:t.id,date:U,habits:Ge}),g(gt=>({...gt,[U]:{clientId:t.id,date:U,habits:Ge,_id:Pe}})),Object.values(Ge).filter(Boolean).length===tm.length&&!we&&(C.current=[...Array(50)].map((gt,nt)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][nt%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{Ne(!0),setTimeout(()=>Ne(!1),3500)},500))}catch(Ae){console.error("Error saving habit:",Ae),S("Failed to save. Try again.","error")}finally{N(!1)}},$=q.map(K=>{const we=hb(K),Ae=p[we],Ge=Ae?Object.values(Ae.habits||{}).filter(Boolean).length:0;return{date:K,dateStr:we,completed:Ge,total:tm.length}}),ye=$.reduce((K,we)=>K+we.completed,0),Le=$.reduce((K,we)=>K+we.total,0),Ke=Le>0?Math.round(ye/Le*100):0,te=Object.values(We.habits||{}).filter(Boolean).length,O=Math.round(te/tm.length*100);return a.jsxs("div",{className:"cbc-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),s||b?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-O/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[O,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:B}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsx("div",{className:"cbc-habits",children:tm.map(K=>{const we=We.habits?.[K.key]||!1,Ae=H===K.key;return a.jsxs("button",{className:`cbc-habit-btn cbc-habit-${K.key} ${we?"cbc-habit-done":""} ${Ae?"cbc-habit-just-checked":""}`,onClick:()=>wt(K.key),disabled:T,children:[a.jsx("div",{className:"cbc-habit-check",children:we?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12",className:`cbc-check-path ${Ae?"cbc-check-animate":""}`})}):a.jsx("div",{className:"cbc-habit-circle"})}),Ae&&a.jsx("div",{className:"cbc-particles",children:Te.current.map((Ge,Pe)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ge.tx}px`,"--ty":`${Ge.ty}px`,"--size":`${Ge.size}px`,animationDuration:`${Ge.duration}s`}},Pe))}),a.jsx("div",{className:`cbc-habit-icon cbc-icon-${K.key}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:K.icon})})}),a.jsx("span",{className:"cbc-habit-label",children:K.label})]},K.key)})})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:$.map((K,we)=>{const Ae=K.dateStr===U,Ge=K.total>0?K.completed/K.total:0,Pe=38,ct=2*Math.PI*Pe,gt=ct-Ge*ct;return a.jsxs("div",{className:`cbc-day-ring ${Ae?"cbc-day-today":""} ${K.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Pe}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Pe,strokeDasharray:ct,strokeDashoffset:gt})]}),a.jsx("span",{className:"cbc-day-label",children:L[we]}),a.jsxs("span",{className:"cbc-day-count",children:[K.completed,"/",K.total]})]},we)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Ke}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[ye," / ",Le," habits this week (",Ke,"%)"]})]})]})]}),a.jsx(ra,{active:"home"}),he&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>Ne(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:C.current.map((K,we)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${K.x}%`,"--delay":`${K.delay}s`,"--color":K.color,"--drift":`${K.drift}px`,"--spin":`${K.spin}deg`,"--duration":`${K.duration}s`,width:`${K.width}px`,height:`${K.height}px`}},we))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),D&&a.jsx("div",{className:`toast-notification ${D.type}`,children:D.message})]})}function nm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function zT(n,e){return[n,e].sort().join("_")}function tO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=ii(),{isDark:o,toggleTheme:c}=Vi(),u=gr(),[d,p]=_.useState("buddies"),[g,b]=_.useState([]),[x,T]=_.useState([]),[N,B]=_.useState([]),[M,D]=_.useState(""),[X,H]=_.useState([]),[J,he]=_.useState([]),[Ne,Te]=_.useState(!0),[C,S]=_.useState(null),[P,U]=_.useState(null),V=_.useCallback((te,O="info")=>{U({message:te,type:O}),setTimeout(()=>U(null),3500)},[]);_.useEffect(()=>{!s&&(!n||!e)&&u("/")},[n,e,s,u]);const q=_.useCallback(async()=>{if(t){Te(!0);try{const te=t.id,K=(await An(qt(_e,"clients"))).docs.map(nt=>({id:nt.id,...nt.data()}));he(K);const we=Object.fromEntries(K.map(nt=>[nt.id,nt])),Ae=await An(Dn(qt(_e,"buddies"),fn("user1","==",te))),Ge=await An(Dn(qt(_e,"buddies"),fn("user2","==",te))),Pe=new Set;[...Ae.docs,...Ge.docs].forEach(nt=>{const Ft=nt.data(),Pn=Ft.user1===te?Ft.user2:Ft.user1;Pe.add(Pn)}),b(Array.from(Pe).map(nt=>we[nt]).filter(Boolean));const ct=await An(Dn(qt(_e,"buddyRequests"),fn("toId","==",te),fn("status","==","pending")));T(ct.docs.map(nt=>({reqId:nt.id,...nt.data(),fromClient:we[nt.data().fromId]})).filter(nt=>nt.fromClient));const gt=await An(Dn(qt(_e,"buddyRequests"),fn("fromId","==",te),fn("status","==","pending")));B(gt.docs.map(nt=>({reqId:nt.id,...nt.data(),toClient:we[nt.data().toId]})).filter(nt=>nt.toClient))}catch(te){console.error("Error fetching buddy data:",te),V("Failed to load buddies","error")}finally{Te(!1)}}},[t,V]);_.useEffect(()=>{q()},[q]),_.useEffect(()=>{if(!M.trim()||!t){H([]);return}const te=M.toLowerCase(),O=t.id,K=new Set(g.map(Pe=>Pe.id)),we=new Set(N.map(Pe=>Pe.toId)),Ae=new Set(x.map(Pe=>Pe.fromId)),Ge=J.filter(Pe=>Pe.id===O||!Pe.name||!Pe.coreBuddyAccess&&Pe.clientType!=="core_buddy"?!1:Pe.name.toLowerCase().includes(te)).map(Pe=>({...Pe,isBuddy:K.has(Pe.id),isPendingOut:we.has(Pe.id),isPendingIn:Ae.has(Pe.id)})).slice(0,20);H(Ge)},[M,J,g,N,x,t]);const L=async(te,O)=>{if(!(!t||te===t.id))try{await Ra(qt(_e,"notifications"),{toId:te,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:O,read:!1,createdAt:yi()})}catch(K){console.error("Notification error:",K),K.code==="permission-denied"&&V("Notifications blocked  check Firestore rules","error")}},We=async te=>{S(te);try{const O=`${t.id}_${te}`;await Kn(Qe(_e,"buddyRequests",O),{fromId:t.id,toId:te,status:"pending",createdAt:yi()}),await L(te,"buddy_request"),V("Buddy request sent!","success"),await q()}catch(O){console.error("Error sending request:",O),V("Failed to send request","error")}finally{S(null)}},wt=async te=>{S(te.reqId);try{const O=zT(te.fromId,t.id);await Kn(Qe(_e,"buddies",O),{user1:[te.fromId,t.id].sort()[0],user2:[te.fromId,t.id].sort()[1],connectedAt:yi()}),await Ar(Qe(_e,"buddyRequests",te.reqId)),await L(te.fromId,"buddy_accept"),V("Buddy added!","success"),await q()}catch(O){console.error("Error accepting request:",O),V("Failed to accept","error")}finally{S(null)}},$=async te=>{S(te.reqId);try{await Ar(Qe(_e,"buddyRequests",te.reqId)),V("Request declined","info"),await q()}catch(O){console.error("Error declining:",O),V("Failed to decline","error")}finally{S(null)}},ye=async te=>{S(te.reqId);try{await Ar(Qe(_e,"buddyRequests",te.reqId)),V("Request cancelled","info"),await q()}catch(O){console.error("Error cancelling:",O),V("Failed to cancel","error")}finally{S(null)}},Le=async te=>{S(te);try{const O=zT(t.id,te);await Ar(Qe(_e,"buddies",O)),V("Buddy removed","info"),await q()}catch(O){console.error("Error removing buddy:",O),V("Failed to remove buddy","error")}finally{S(null)}},Ke=x.length;return s?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:a.jsxs("div",{className:"bdy-page","data-theme":o?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>u("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>u("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${d==="buddies"?" active":""}`,onClick:()=>p("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${d==="requests"?" active":""}`,onClick:()=>p("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ke>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ke})]}),a.jsxs("button",{className:`bdy-tab${d==="search"?" active":""}`,onClick:()=>p("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),Ne?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[d==="buddies"&&a.jsx("div",{className:"bdy-section",children:g.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>p("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:g.map(te=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${te.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:te.name}):a.jsx("span",{children:nm(te.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:te.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:O=>{O.stopPropagation(),Le(te.id)},disabled:C===te.id,"aria-label":"Remove buddy",children:C===te.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},te.id))})}),d==="requests"&&a.jsxs("div",{className:"bdy-section",children:[x.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:x.map(te=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:te.fromClient.photoURL?a.jsx("img",{src:te.fromClient.photoURL,alt:te.fromClient.name}):a.jsx("span",{children:nm(te.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:te.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>wt(te),disabled:C===te.reqId,children:C===te.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(te),disabled:C===te.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},te.reqId))})]}),N.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:N.map(te=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:te.toClient?.photoURL?a.jsx("img",{src:te.toClient.photoURL,alt:te.toClient.name}):a.jsx("span",{children:nm(te.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:te.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ye(te),disabled:C===te.reqId,children:C===te.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},te.reqId))})]}),x.length===0&&N.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),d==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:M,onChange:te=>D(te.target.value),autoFocus:!0}),M&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>D(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),M.trim()&&X.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',M,'"']})}),X.length>0&&a.jsx("div",{className:"bdy-list",children:X.map(te=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${te.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:te.name}):a.jsx("span",{children:nm(te.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:te.name}),te.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),te.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):te.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):te.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:O=>{O.stopPropagation();const K=x.find(we=>we.fromId===te.id);K&&wt(K)},disabled:!!C,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:O=>{O.stopPropagation(),We(te.id)},disabled:C===te.id,children:C===te.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},te.id))})]})]})]}),a.jsx(ra,{}),P&&a.jsxs("div",{className:`toast-notification ${P.type}`,children:[a.jsx("span",{className:"toast-icon",children:P.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):P.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:P.message})]})]})}function sm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function db(n,e){return[n,e].sort().join("_")}const nO=5;function fb(n){return n.toISOString().split("T")[0]}function sO(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const rO={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function qT(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function iO(){const{userId:n}=PR(),{currentUser:e,isClient:t,clientData:s,loading:o}=ii(),{isDark:c,toggleTheme:u}=Vi(),d=gr(),[p,g]=_.useState(null),[b,x]=_.useState("none"),[T,N]=_.useState(null),[B,M]=_.useState(!0),[D,X]=_.useState(!1),[H,J]=_.useState(null),[he,Ne]=_.useState([]),[Te,C]=_.useState(!1),[S,P]=_.useState(new Set),[U,V]=_.useState(new Set),[q,L]=_.useState({}),[We,wt]=_.useState({}),[$,ye]=_.useState({}),[Le,Ke]=_.useState(!0),[te,O]=_.useState(0),[K,we]=_.useState(0),[Ae,Ge]=_.useState(0),[Pe,ct]=_.useState(0),[gt,nt]=_.useState([]),[Ft,Pn]=_.useState([]),[Lt,Et]=_.useState(null),[me,sn]=_.useState(null),[rn,yt]=_.useState(0),[At,dt]=_.useState([]),[it,an]=_.useState(!1),[Ts,Rt]=_.useState(null),[ln,ns]=_.useState([]),Qt=_.useCallback((ee,ve="info")=>{J({message:ee,type:ve}),setTimeout(()=>J(null),3500)},[]);_.useEffect(()=>{!o&&(!e||!t)&&d("/")},[e,t,o,d]),_.useEffect(()=>{s&&n&&s.id===n&&d("/client/core-buddy",{replace:!0})},[s,n,d]),_.useEffect(()=>{if(!s||!n||s.id===n)return;let ee=!1;return(async()=>{M(!0);try{const Ct=(await An(qt(_e,"clients"))).docs.map(zt=>({id:zt.id,...zt.data()})).find(zt=>zt.id===n);if(!Ct){ee||M(!1);return}ee||g(Ct);const It=s.id,Xt=db(It,n);if((await Vn(Qe(_e,"buddies",Xt))).exists())ee||x("buddy");else{const zt=`${It}_${n}`,Fn=await Vn(Qe(_e,"buddyRequests",zt));if(Fn.exists()&&Fn.data().status==="pending")ee||(x("pending_out"),N(zt));else{const os=`${n}_${It}`,pn=await Vn(Qe(_e,"buddyRequests",os));pn.exists()&&pn.data().status==="pending"?ee||(x("pending_in"),N(os)):ee||x("none")}}}catch(ve){console.error("Error loading profile:",ve)}finally{ee||M(!1)}})(),()=>{ee=!0}},[s,n]),_.useEffect(()=>{if(!n||!p)return;let ee=!1;return(async()=>{Ke(!0);try{const[ve,lt,Ct,It]=await Promise.all([An(Dn(qt(_e,"workoutLogs"),fn("clientId","==",n))),Vn(Qe(_e,"coreBuddyAchievements",n)),Vn(Qe(_e,"coreBuddyPBs",n)),Vn(Qe(_e,"clientProgrammes",n))]);if(ee)return;const Xt=ve.docs.length;O(Xt),lt.exists()&&we(lt.data().totalVolume||0);let Jt=0;const zt=ve.docs.map(pn=>pn.data().date).filter(Boolean).sort().reverse();if(zt.length>0){const pn=new Date;let In=new Date(pn);for(let On=0;On<52;On++){const z=new Date(In),xe=z.getDay(),ke=xe===0?6:xe-1;z.setDate(z.getDate()-ke),z.setHours(0,0,0,0);const Se=new Date(z);Se.setDate(Se.getDate()+7);const pe=fb(z),rt=fb(Se);if(zt.some(ut=>ut>=pe&&ut<rt))Jt++;else{if(On>0)break;break}In.setDate(In.getDate()-7)}}if(ee||Ge(Jt),Ct.exists()){const pn=Ct.data().exercises||{},In=Object.entries(pn).sort(([,On],[,z])=>(z.weight||0)-(On.weight||0)).slice(0,3).map(([On,z])=>({name:On,weight:z.weight,reps:z.reps}));ee||nt(In)}if(It.exists()){const pn=It.data(),In=rO[pn.templateId];if(In){const On=Object.keys(pn.completedSessions||{}).length,z=In.duration*In.daysPerWeek;ee||(sn(pn.templateId.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase())),yt(z>0?Math.round(On/z*100):0))}}const Fn=await Vn(Qe(_e,"achievements",n));if(!ee&&Fn.exists()){const pn=Fn.data().badges||{};Pn(Object.keys(pn))}let os=0;for(let pn=0;pn<30;pn++){const In=new Date;In.setDate(In.getDate()-pn);const On=fb(In);try{const z=await An(Dn(qt(_e,"habitLogs"),fn("clientId","==",n),fn("date","==",On)));if(z.empty)break;{const xe=z.docs[0].data().habits||{};if(Object.values(xe).filter(Boolean).length>=nO)os++;else break}}catch{break}}ee||ct(os)}catch(ve){console.error("Error loading buddy stats:",ve)}finally{ee||Ke(!1)}})(),()=>{ee=!0}},[n,p]),_.useEffect(()=>{if(!s)return;const ee=s.id;(async()=>{try{const[ve,lt,Ct]=await Promise.all([An(Dn(qt(_e,"buddies"),fn("user1","==",ee))),An(Dn(qt(_e,"buddies"),fn("user2","==",ee))),An(qt(_e,"clients"))]),It=new Set;[...ve.docs,...lt.docs].forEach(Jt=>{const zt=Jt.data();It.add(zt.user1===ee?zt.user2:zt.user1)});const Xt={};Ct.docs.forEach(Jt=>{Xt[Jt.id]=Jt.data()}),dt(Array.from(It).filter(Jt=>Xt[Jt]).map(Jt=>({id:Jt,name:Xt[Jt].name,photoURL:Xt[Jt].photoURL||null})))}catch(ve){console.error("Error loading buddies for mentions:",ve)}})()},[s]);const Wt=async(ee,ve,lt={})=>{if(!(!s||ee===s.id))try{await Ra(qt(_e,"notifications"),{toId:ee,fromId:s.id,fromName:s.name||"Someone",fromPhotoURL:s.photoURL||null,type:ve,read:!1,createdAt:yi(),...lt})}catch(Ct){console.error("Notification error:",Ct),Ct.code==="permission-denied"&&Qt("Notifications blocked  check Firestore rules","error")}},cn=async()=>{X(!0);try{const ee=`${s.id}_${n}`;await Kn(Qe(_e,"buddyRequests",ee),{fromId:s.id,toId:n,status:"pending",createdAt:yi()}),await Wt(n,"buddy_request"),x("pending_out"),N(ee),Qt("Buddy request sent!","success")}catch(ee){console.error(ee),Qt("Failed to send request","error")}finally{X(!1)}},vn=async()=>{if(T){X(!0);try{const ee=db(s.id,n);await Kn(Qe(_e,"buddies",ee),{user1:[s.id,n].sort()[0],user2:[s.id,n].sort()[1],connectedAt:yi()}),await Ar(Qe(_e,"buddyRequests",T)),await Wt(n,"buddy_accept"),x("buddy"),Qt("Buddy added!","success")}catch(ee){console.error(ee),Qt("Failed to accept","error")}finally{X(!1)}}},be=async()=>{if(T){X(!0);try{await Ar(Qe(_e,"buddyRequests",T)),x("none"),Qt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ee){console.error(ee),Qt("Failed","error")}finally{X(!1)}}},De=async()=>{X(!0);try{const ee=db(s.id,n);await Ar(Qe(_e,"buddies",ee)),x("none"),Qt("Buddy removed","info")}catch(ee){console.error(ee),Qt("Failed to remove","error")}finally{X(!1)}},Be=_.useCallback(async()=>{if(n){C(!0);try{const ee=await An(Dn(qt(_e,"posts"),fn("authorId","==",n),Qm("createdAt","desc"),Ym(30)));if(Ne(ee.docs.map(ve=>({id:ve.id,...ve.data()}))),s){const ve=await An(Dn(qt(_e,"postLikes"),fn("userId","==",s.id)));P(new Set(ve.docs.map(lt=>lt.data().postId)))}}catch(ee){console.error("Error loading journey:",ee)}finally{C(!1)}}},[n,s]);_.useEffect(()=>{!B&&p&&Be()},[B,p,Be]);const et=async ee=>{if(window.confirm("Delete this post?"))try{await Ar(Qe(_e,"posts",ee)),Ne(ve=>ve.filter(lt=>lt.id!==ee)),Qt("Post deleted","info")}catch(ve){console.error("Delete error:",ve),Qt("Failed to delete","error")}},Ue=async ee=>{if(!s)return;const ve=s.id,lt=`${ee}_${ve}`,Ct=S.has(ee),It=new Set(S);Ct?It.delete(ee):It.add(ee),P(It),Ne(Xt=>Xt.map(Jt=>Jt.id===ee?{...Jt,likeCount:Math.max(0,(Jt.likeCount||0)+(Ct?-1:1))}:Jt));try{if(Ct)await Ar(Qe(_e,"postLikes",lt)),await Ea(Qe(_e,"posts",ee),{likeCount:Nl(-1)});else{await Kn(Qe(_e,"postLikes",lt),{postId:ee,userId:ve,createdAt:yi()}),await Ea(Qe(_e,"posts",ee),{likeCount:Nl(1)});const Xt=he.find(Jt=>Jt.id===ee);Xt&&Wt(Xt.authorId,"like",{postId:ee})}}catch(Xt){console.error("Like error:",Xt),Be()}},Me=async ee=>{try{const ve=await An(Dn(qt(_e,"postComments"),fn("postId","==",ee),Qm("createdAt","asc"),Ym(50)));L(lt=>({...lt,[ee]:ve.docs.map(Ct=>({id:Ct.id,...Ct.data()}))}))}catch(ve){console.error("Error loading comments:",ve)}},ze=ee=>{const ve=new Set(U);ve.has(ee)?ve.delete(ee):(ve.add(ee),q[ee]||Me(ee)),V(ve)},St=(ee,ve)=>{const lt=ee.match(/@(\w*)$/);if(lt){an(!0),Rt(ve);const Ct=At.filter(It=>It.name&&It.name.toLowerCase().includes(lt[1].toLowerCase())).slice(0,5);ns(Ct)}else an(!1),ns([])},bt=(ee,ve)=>{const Ct=(We[ve]||"").replace(/@\w*$/,`@${ee.name} `);wt(It=>({...It,[ve]:Ct})),an(!1),ns([])},Vt=(ee,ve)=>{wt(lt=>({...lt,[ee]:ve})),St(ve,ee)},Ht=async ee=>{const ve=(We[ee]||"").trim();if(!(!ve||!s)){ye(lt=>({...lt,[ee]:!0}));try{await Ra(qt(_e,"postComments"),{postId:ee,authorId:s.id,authorName:s.name||"Unknown",authorPhotoURL:s.photoURL||null,content:ve,createdAt:yi()}),await Ea(Qe(_e,"posts",ee),{commentCount:Nl(1)});const lt=he.find(It=>It.id===ee);lt&&Wt(lt.authorId,"comment",{postId:ee});const Ct=ve.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ct){const It=new Set;Ct.forEach(Xt=>{const Jt=Xt.slice(1).trim(),zt=At.find(Fn=>Fn.name&&Fn.name.toLowerCase()===Jt.toLowerCase());zt&&!It.has(zt.id)&&(It.add(zt.id),Wt(zt.id,"mention",{postId:ee}))})}wt(It=>({...It,[ee]:""})),Ne(It=>It.map(Xt=>Xt.id===ee?{...Xt,commentCount:(Xt.commentCount||0)+1}:Xt)),await Me(ee)}catch(lt){console.error("Comment error:",lt),Qt("Failed to comment","error")}finally{ye(lt=>({...lt,[ee]:!1}))}}};return o||B||!s?a.jsx("div",{className:"prf-loading","data-theme":c?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:p?a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:c?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:p.photoURL?a.jsx("img",{src:p.photoURL,alt:p.name}):a.jsx("span",{children:sm(p.name)})}),a.jsx("h1",{className:"prf-name",children:p.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:cn,disabled:D,children:D?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:be,disabled:D,children:D?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:vn,disabled:D,children:D?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:be,disabled:D,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:De,disabled:D,children:D?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Le?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:te}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[sO(K),a.jsx("span",{className:"prf-stat-unit",children:K>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[K>=1e6?"Million kg":K>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Ae,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(me||Pe>0)&&a.jsxs("div",{className:"prf-info-row",children:[me&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:me}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(rn,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[rn,"% complete"]})]})]}),Pe>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Pe," day",Pe!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),gt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:gt.map((ee,ve)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:ve===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ve+1}`}),a.jsx("span",{className:"prf-pb-name",children:ee.name}),a.jsxs("span",{className:"prf-pb-weight",children:[ee.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",ee.reps]})]},ve))})]}),Ft.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Ft.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:Ft.map(ee=>{const ve=Jm.find(lt=>lt.id===ee);return ve?a.jsx("button",{className:"prf-badge-chip",onClick:()=>Et(ve),children:a.jsx("img",{src:ve.img,alt:ve.name,className:"prf-badge-chip-img"})},ee):null})})]}),Lt&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Et(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:ee=>ee.stopPropagation(),children:[a.jsx("img",{src:Lt.img,alt:Lt.name,className:"prf-badge-overlay-img"}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Lt.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Et(null),children:"Tap to close"})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${p.name?.split(" ")[0]}'s Journey`}),Te?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):he.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:he.map(ee=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:ee.authorPhotoURL?a.jsx("img",{src:ee.authorPhotoURL,alt:""}):a.jsx("span",{children:sm(ee.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:ee.authorName}),a.jsx("span",{className:"journey-post-time",children:qT(ee.createdAt)})]}),ee.authorId===s.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>et(ee.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ee.content&&a.jsx("p",{className:"journey-post-content",children:ee.content}),ee.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:ee.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(ee.id)?" liked":""}`,onClick:()=>Ue(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(ee.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:ee.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${U.has(ee.id)?" active":""}`,onClick:()=>ze(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:ee.commentCount||0})]})]}),U.has(ee.id)&&a.jsxs("div",{className:"journey-comments",children:[q[ee.id]?.length>0?q[ee.id].map(ve=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>d(`/client/core-buddy/profile/${ve.authorId}`),children:ve.authorPhotoURL?a.jsx("img",{src:ve.authorPhotoURL,alt:""}):a.jsx("span",{children:sm(ve.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:ve.authorName}),a.jsx("span",{className:"journey-comment-text",children:ve.content})]}),a.jsx("span",{className:"journey-comment-time",children:qT(ve.createdAt)})]})]},ve.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:We[ee.id]||"",onChange:ve=>Vt(ee.id,ve.target.value),onKeyDown:ve=>{ve.key==="Enter"&&Ht(ee.id)},maxLength:300}),it&&Ts===ee.id&&ln.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ln.map(ve=>a.jsxs("button",{className:"mention-option",onClick:()=>bt(ve,ee.id),children:[a.jsx("div",{className:"mention-option-avatar",children:ve.photoURL?a.jsx("img",{src:ve.photoURL,alt:""}):a.jsx("span",{children:sm(ve.name)})}),a.jsx("span",{children:ve.name})]},ve.id))}),a.jsx("button",{onClick:()=>Ht(ee.id),disabled:!(We[ee.id]||"").trim()||$[ee.id],children:$[ee.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ee.id))})]})]}),a.jsx(ra,{}),H&&a.jsxs("div",{className:`toast-notification ${H.type}`,children:[a.jsx("span",{className:"toast-icon",children:H.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):H.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:H.message})]})]}):a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ra,{})]})}const Ni=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],bl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function aO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ai(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function oO(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function lO(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function rm(n,e){if(!e)return"-";switch(n.unit){case"weight":return lO(e.weight,e.reps);case"time":return oO(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Bc(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function mb(n,e){return!e||e===0?null:(n-e)/e*100}function cO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(M=>{const D=M.benchmarks?.[e];if(!D)return 0;switch(t){case"weight":return(D.weight||0)*(D.reps||0);case"time":return D.time||0;case"reps":return D.reps||0;case"distance":return D.distance||0;default:return 0}}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,d=300,p=100,g=20,b=d-g*2,x=p-g*2,T=s.map((M,D)=>{const X=g+D/(s.length-1)*b,H=g+x-(M-c)/u*x;return{x:X,y:H,value:M}}),N=T.map((M,D)=>`${D===0?"M":"L"} ${M.x} ${M.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${d} ${p}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((M,D)=>a.jsx("circle",{cx:M.x,cy:M.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((M,D)=>a.jsxs("span",{className:"pb-trend-label",children:[M.month.split("-")[1],"/",M.month.split("-")[0].slice(2)]},D))})]})}function uO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,d]=_.useState(!1),[p,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,M]=_.useState(!1),[D,X]=_.useState({}),[H,J]=_.useState({}),[he,Ne]=_.useState({}),[Te,C]=_.useState({}),[S,P]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[We,wt]=_.useState([]),[$,ye]=_.useState(null),[Le,Ke]=_.useState(null),[te,O]=_.useState(!1),[K,we]=_.useState(""),[Ae,Ge]=_.useState(""),Pe=_.useRef(null),ct=_.useRef(0),gt=_.useRef(0),nt=_.useRef("right"),Ft=_.useCallback(z=>{g(xe=>{const ke=Math.max(0,Math.min(Ni.length-1,z));return ke===xe?xe:(nt.current=ke>xe?"right":"left",ke)})},[]),{currentUser:Pn,isClient:Lt,clientData:Et,loading:me}=ii(),{isDark:sn}=Vi(),rn=gr(),yt=_.useCallback((z,xe="info")=>{Ke({message:z,type:xe}),setTimeout(()=>Ke(null),4e3)},[]);_.useEffect(()=>{!me&&(!Pn||!Lt)&&rn("/")},[Pn,Lt,me,rn]),_.useEffect(()=>{Et&&At()},[Et]);const At=async()=>{try{const z=Dn(qt(_e,"juniorPBs"),fn("clientId","==",Et.id)),ke=(await An(z)).docs.map(ut=>({id:ut.id,...ut.data()}));ke.sort((ut,jt)=>ut.month.localeCompare(jt.month)),s(ke);const Se=Dn(qt(_e,"juniorPBTargets"),fn("clientId","==",Et.id)),pe=await An(Se);if(!pe.empty){const ut=pe.docs[0].data();Ne(ut.targets||{}),C(ut.metricTargets||{}),P(ut.targets||{}),L(ut.metricTargets||{})}const rt=Dn(qt(_e,"juniorAchievements"),fn("clientId","==",Et.id)),Dt=await An(rt);Dt.empty||wt(Dt.docs[0].data().badges||[])}catch(z){console.error("Error fetching junior personal bests:",z)}c(!1)},dt=aO(),it=t.find(z=>z.month===dt),an=t.filter(z=>z.month<dt),Ts=an.length>0?an[an.length-1]:null;_.useEffect(()=>{it?(X(it.benchmarks||{}),J(it.bodyMetrics||{})):(X({}),J({}))},[it?.id]);const Rt=async(z,xe)=>{const ke=[];if(z==="strength"?Ni.forEach(Se=>{const pe=he[Se.key];if(!pe)return;const rt=xe[Se.key];if(!rt)return;let Dt;if(pe.targetType==="time"){if(!pe.targetValue)return;const ut=pe.startValue||0,jt=rt.time||0,kt=pe.targetValue-ut;Dt=kt===0?jt>=pe.targetValue?1:0:Math.max(0,(jt-ut)/kt)}else if(pe.targetType==="reps"){if(!pe.targetReps)return;const ut=pe.startReps||0,jt=rt.reps||0,kt=pe.targetReps-ut;Dt=kt===0?jt>=pe.targetReps?1:0:Math.max(0,(jt-ut)/kt)}else if(pe.targetType==="distance"){if(!pe.targetDistance)return;const ut=pe.startDistance||0,jt=rt.distance||0,kt=pe.targetDistance-ut;Dt=kt===0?jt>=pe.targetDistance?1:0:Math.max(0,(jt-ut)/kt)}else{if(!pe.targetWeight&&!pe.targetReps)return;const ut=(pe.startWeight||0)*(pe.startReps||0),jt=(pe.targetWeight||0)*(pe.targetReps||0),kt=(rt.weight||0)*(rt.reps||0),un=jt-ut;Dt=un===0?kt>=jt?1:0:Math.max(0,(kt-ut)/un)}if(Dt>=1){let ut,jt;pe.targetType==="time"?(ut=We.some(kt=>kt.type==="strength"&&kt.key===Se.key&&kt.targetValue===pe.targetValue),jt=`${Se.name} ${pe.targetValue}s`):pe.targetType==="reps"?(ut=We.some(kt=>kt.type==="strength"&&kt.key===Se.key&&kt.targetReps===pe.targetReps),jt=`${Se.name} ${pe.targetReps} reps`):pe.targetType==="distance"?(ut=We.some(kt=>kt.type==="strength"&&kt.key===Se.key&&kt.targetDistance===pe.targetDistance),jt=`${Se.name} ${pe.targetDistance}cm`):(ut=We.some(kt=>kt.type==="strength"&&kt.key===Se.key&&kt.targetWeight===pe.targetWeight&&kt.targetReps===pe.targetReps),jt=`${Se.name} ${pe.targetWeight}kg  ${pe.targetReps}`),ut||ke.push({type:"strength",key:Se.key,...pe.targetType==="time"?{targetType:"time",targetValue:pe.targetValue}:pe.targetType==="reps"?{targetType:"reps",targetReps:pe.targetReps}:pe.targetType==="distance"?{targetType:"distance",targetDistance:pe.targetDistance}:{targetWeight:pe.targetWeight,targetReps:pe.targetReps},achievedMonth:dt,label:jt})}}):bl.forEach(Se=>{const pe=Te[Se.key];if(!pe||!pe.targetValue)return;const rt=xe[Se.key];if(rt==null)return;const Dt=pe.startValue||0,ut=pe.targetValue,jt=ut-Dt;(jt===0?rt===ut?1:0:Math.max(0,(rt-Dt)/jt))>=1&&(We.some(yr=>yr.type==="metric"&&yr.key===Se.key&&yr.targetValue===ut)||ke.push({type:"metric",key:Se.key,targetValue:ut,achievedMonth:dt,label:`${Se.name} ${ut}${Se.suffix}`}))}),ke.length>0){const Se=[...We,...ke];await Kn(Qe(_e,"juniorAchievements",Et.id),{clientId:Et.id,badges:Se,updatedAt:mt.now()}),wt(Se),ye(ke),setTimeout(()=>ye(null),5e3)}},ln=(z,xe)=>{if(z==="strength"){const ke=he[xe];if(!ke)return!1;switch(Ni.find(pe=>pe.key===xe)?.unit){case"time":return We.some(pe=>pe.type==="strength"&&pe.key===xe&&pe.targetValue===ke.targetValue);case"reps":return We.some(pe=>pe.type==="strength"&&pe.key===xe&&pe.targetReps===ke.targetReps);case"distance":return We.some(pe=>pe.type==="strength"&&pe.key===xe&&pe.targetDistance===ke.targetDistance);default:return!ke.targetWeight&&!ke.targetReps?!1:We.some(pe=>pe.type==="strength"&&pe.key===xe&&pe.targetWeight===ke.targetWeight&&pe.targetReps===ke.targetReps)}}else{const ke=Te[xe];return!ke||!ke.targetValue?!1:We.some(Se=>Se.type==="metric"&&Se.key===xe&&Se.targetValue===ke.targetValue)}},ns=async()=>{d(!0);try{const z=`${Et.id}_${dt}`,xe=it||{};await Kn(Qe(_e,"juniorPBs",z),{clientId:Et.id,month:dt,benchmarks:D,bodyMetrics:xe.bodyMetrics||H||{},createdAt:xe.createdAt||mt.now(),updatedAt:mt.now()}),await Rt("strength",D),yt("Benchmarks saved!","success"),x(!1),await At()}catch(z){console.error("Error saving benchmarks:",z),yt("Failed to save. Please try again.","error")}d(!1)},Qt=async()=>{d(!0);try{const z=`${Et.id}_${dt}`,xe=it||{};await Kn(Qe(_e,"juniorPBs",z),{clientId:Et.id,month:dt,benchmarks:xe.benchmarks||D||{},bodyMetrics:H,createdAt:xe.createdAt||mt.now(),updatedAt:mt.now()}),await Rt("metric",H),yt("Body metrics saved!","success"),N(!1),await At()}catch(z){console.error("Error saving metrics:",z),yt("Failed to save. Please try again.","error")}d(!1)},Wt=(z,xe,ke)=>{X(Se=>({...Se,[z]:{...Se[z],[xe]:ke===""?"":parseFloat(ke)}}))},cn=(z,xe)=>{J(ke=>({...ke,[z]:xe===""?"":parseFloat(xe)}))},vn=(z,xe,ke)=>{P(Se=>({...Se,[z]:{...Se[z],[xe]:ke===""?"":parseFloat(ke)}}))},be=async()=>{d(!0);try{const z=`targets_${Et.id}`,xe=it?.benchmarks||{},ke={};Ni.forEach(Se=>{const pe=xe[Se.key];switch(Se.unit){case"time":S[Se.key]?.targetValue&&(ke[Se.key]={targetType:"time",targetValue:S[Se.key].targetValue,startValue:pe?.time||0});break;case"reps":S[Se.key]?.targetReps&&(ke[Se.key]={targetType:"reps",targetReps:S[Se.key].targetReps,startReps:pe?.reps||0});break;case"distance":S[Se.key]?.targetDistance&&(ke[Se.key]={targetType:"distance",targetDistance:S[Se.key].targetDistance,startDistance:pe?.distance||0});break;default:(S[Se.key]?.targetWeight||S[Se.key]?.targetReps)&&(ke[Se.key]={targetWeight:S[Se.key].targetWeight||0,targetReps:S[Se.key].targetReps||0,startWeight:pe?.weight||0,startReps:pe?.reps||0})}}),await Kn(Qe(_e,"juniorPBTargets",z),{clientId:Et.id,targets:ke,metricTargets:Te,updatedAt:mt.now()}),Ne(ke),P(ke),yt("Targets saved!","success"),M(!1)}catch(z){console.error("Error saving targets:",z),yt("Failed to save targets.","error")}d(!1)},De=(z,xe)=>{L(ke=>({...ke,[z]:{...ke[z],targetValue:xe===""?"":parseFloat(xe)}}))},Be=async()=>{d(!0);try{const z=`targets_${Et.id}`,xe={};bl.forEach(ke=>{if(q[ke.key]?.targetValue){const Se=it?.bodyMetrics?.[ke.key]||0;xe[ke.key]={targetValue:q[ke.key].targetValue,startValue:Se}}}),await Kn(Qe(_e,"juniorPBTargets",z),{clientId:Et.id,targets:he,metricTargets:xe,updatedAt:mt.now()}),C(xe),L(xe),yt("Metric targets saved!","success"),V(!1)}catch(z){console.error("Error saving metric targets:",z),yt("Failed to save targets.","error")}d(!1)},et=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){d(!0);try{const z=Qe(_e,"juniorPBTargets",`targets_${Et.id}`);await Ar(z),Ne({}),C({}),P({}),L({}),yt("All goals have been reset","success")}catch(z){console.error("Error resetting targets:",z),yt("Failed to reset goals","error")}d(!1)}},Ue=(z,xe)=>{const ke=he[z];if(!ke||!xe)return null;if(ke.targetType==="time"){if(!ke.targetValue)return null;const ut=ke.startValue||0,jt=ke.targetValue,kt=xe.time||0,un=jt-ut;return un<=0?kt>=jt?1:0:Math.max(0,Math.min((kt-ut)/un,1))}if(ke.targetType==="reps"){if(!ke.targetReps)return null;const ut=ke.startReps||0,jt=ke.targetReps,kt=xe.reps||0,un=jt-ut;return un<=0?kt>=jt?1:0:Math.max(0,Math.min((kt-ut)/un,1))}if(ke.targetType==="distance"){if(!ke.targetDistance)return null;const ut=ke.startDistance||0,jt=ke.targetDistance,kt=xe.distance||0,un=jt-ut;return un<=0?kt>=jt?1:0:Math.max(0,Math.min((kt-ut)/un,1))}if(!ke.targetWeight&&!ke.targetReps)return null;const Se=(ke.startWeight||0)*(ke.startReps||0),pe=(ke.targetWeight||0)*(ke.targetReps||0),rt=(xe.weight||0)*(xe.reps||0),Dt=pe-Se;return Dt<=0?rt>=pe?1:0:Math.max(0,Math.min((rt-Se)/Dt,1))},Me=z=>{const xe=Te[z];if(!xe||!xe.targetValue)return null;const ke=it?.bodyMetrics?.[z];if(ke==null)return null;const Se=xe.startValue||0,pe=xe.targetValue,rt=pe-Se;return rt===0?ke===pe?1:0:Math.max(0,Math.min((ke-Se)/rt,1))},ze=z=>{ct.current=z.touches[0].clientX,gt.current=0},St=z=>{gt.current=z.touches[0].clientX-ct.current},bt=()=>{gt.current<-50?Ft(p+1):gt.current>50&&Ft(p-1),gt.current=0},Vt=z=>{const xe=it?.bodyMetrics?.[z],ke=Ts?.bodyMetrics?.[z];return xe==null||ke==null?null:parseFloat((xe-ke).toFixed(2))},Ht=t.find(z=>z.month===K),ee=t.find(z=>z.month===Ae);if(me||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Pn||!Lt||!Et)return null;const ve=Ni[p],lt=it?.benchmarks?.[ve.key],Ct=Ts?.benchmarks?.[ve.key],It=Bc(ve,lt),Xt=Bc(ve,Ct),Jt=mb(It,Xt),zt=Ue(ve.key,lt),Fn=zt!==null,os=zt!==null&&zt>=1,pn=Fn?Math.round(zt*60):It>0?15:0,In=he[ve.key],On=z=>z?z.targetType==="time"?`${z.startValue||0}s  ${z.targetValue}s`:z.targetType==="reps"?`${z.startReps||0}  ${z.targetReps} reps`:z.targetType==="distance"?`${z.startDistance||0}  ${z.targetDistance}cm`:`${z.startWeight||0}kg${z.startReps||0}  ${z.targetWeight}kg${z.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>rn("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Pe,onTouchStart:ze,onTouchMove:St,onTouchEnd:bt,children:[a.jsx("div",{className:`pb-ring-container slide-from-${nt.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((z,xe)=>{const ke=xe<Math.round(pn);return a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:`pb-ring-tick ${ke?os?"hit":"filled":"empty"}`,strokeWidth:z.thick?"3":"2"},xe)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:ve.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[ve.name,ln("strength",ve.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:lt?rm(ve,lt):"-"}),Jt!==null&&a.jsxs("div",{className:`pb-ring-change ${Jt>=0?"positive":"negative"}`,children:[Jt>=0?"+":"",Jt.toFixed(1),"%"]}),Jt===null&&lt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),In&&a.jsx("div",{className:`pb-ring-target ${os?"hit":""}`,children:os?"Target hit!":On(In)}),!In&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},p),a.jsx("div",{className:"pb-carousel-dots",children:Ni.map((z,xe)=>a.jsx("button",{className:`pb-dot ${xe===p?"active":""}`,onClick:()=>Ft(xe)},xe))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ft(p-1),disabled:p===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ft(p+1),disabled:p===Ni.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(cO,{data:t,exerciseKey:ve.key,unit:ve.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:it?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:et,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Ai(dt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),X(it?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ni.map(z=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:D[z.key]?.weight??"",onChange:xe=>Wt(z.key,"weight",xe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:D[z.key]?.reps??"",onChange:xe=>Wt(z.key,"reps",xe.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:D[z.key]?.reps??"",onChange:xe=>Wt(z.key,"reps",xe.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:D[z.key]?.distance??"",onChange:xe=>Wt(z.key,"distance",xe.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:D[z.key]?.time??"",onChange:xe=>Wt(z.key,"time",xe.target.value),placeholder:"0"})]})})]},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),X(it?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ns,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),P(he)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ni.map(z=>{const xe=it?.benchmarks?.[z.key];let ke="-";if(xe)switch(z.unit){case"weight":(xe.weight||xe.reps)&&(ke=`${xe.weight||0}kg  ${xe.reps||0}`);break;case"time":xe.time&&(ke=`${xe.time}s`);break;case"reps":xe.reps&&(ke=`${xe.reps} reps`);break;case"distance":xe.distance&&(ke=`${xe.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ke]})]}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetWeight??"",onChange:Se=>vn(z.key,"targetWeight",Se.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Se=>vn(z.key,"targetReps",Se.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Se=>vn(z.key,"targetReps",Se.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetDistance??"",onChange:Se=>vn(z.key,"targetDistance",Se.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[z.key]?.targetValue??"",onChange:Se=>vn(z.key,"targetValue",Se.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),P(he)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:be,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Ai(dt)}),a.jsx("div",{className:"pb-metrics-list",children:bl.map(z=>{const xe=it?.bodyMetrics?.[z.key],ke=Vt(z.key),Se=Te[z.key],pe=Me(z.key),rt=pe!==null&&pe>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[z.name,ln("metric",z.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Se&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Se.targetValue," ",z.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:xe!=null?`${xe} ${z.suffix}`:"-"}),ke!==null&&a.jsxs("span",{className:`pb-metric-change ${ke>0?"up":ke<0?"down":"same"}`,children:[ke>0?"+":"",ke," ",z.suffix]})]})]}),pe!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${rt?"hit":""}`,style:{width:`${Math.round(pe*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${rt?"hit":""}`,children:rt?"Hit!":`${Math.round(pe*100)}%`})]})]},z.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:it?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:et,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Ai(dt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),J(it?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:bl.map(z=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[z.name," (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:H[z.key]??"",onChange:xe=>cn(z.key,xe.target.value),placeholder:"0"})]})},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),J(it?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Qt,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),bl.map(z=>{const xe=it?.bodyMetrics?.[z.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",xe!=null?`${xe} ${z.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[z.key]?.targetValue??"",onChange:ke=>De(z.key,ke.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[We.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((z,xe)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${xe*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:z.label}),a.jsx("span",{className:"pb-achievement-date",children:Ai(z.achievedMonth)})]})]},xe))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${te?"active":""}`,onClick:()=>{O(!te),!te&&t.length>=2&&(we(t[0].month),Ge(t[t.length-1].month))},children:te?"Back to Timeline":"Compare Months"})}),te?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:K,onChange:z=>we(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ai(z.month)},z.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ae,onChange:z=>Ge(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ai(z.month)},z.month))})]})]}),Ht&&ee&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Ai(K).split(" ")[0]}),a.jsx("span",{children:Ai(Ae).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ni.map(z=>{const xe=Ht.benchmarks?.[z.key],ke=ee.benchmarks?.[z.key],Se=Bc(z,xe),pe=Bc(z,ke),rt=mb(pe,Se);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:xe?rm(z,xe):"-"}),a.jsx("span",{className:"pb-compare-val",children:ke?rm(z,ke):"-"}),a.jsx("span",{className:`pb-compare-change ${rt!==null?rt>=0?"positive":"negative":""}`,children:rt!==null?`${rt>=0?"+":""}${rt.toFixed(1)}%`:"-"})]},z.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Ai(K).split(" ")[0]}),a.jsx("span",{children:Ai(Ae).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),bl.map(z=>{const xe=Ht.bodyMetrics?.[z.key],ke=ee.bodyMetrics?.[z.key],Se=xe!=null&&ke!=null?parseFloat((ke-xe).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:xe!=null?`${xe}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:ke!=null?`${ke}`:"-"}),a.jsx("span",{className:`pb-compare-change ${Se!==null?Se>0?"positive":Se<0?"negative":"neutral":""}`,children:Se!==null?`${Se>0?"+":""}${Se} ${z.suffix}`:"-"})]},z.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((z,xe)=>{const ke=t.filter(Se=>Se.month<z.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${xe*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Ai(z.month)}),z.benchmarks&&Object.keys(z.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),Ni.map(Se=>{const pe=z.benchmarks[Se.key];if(!pe)return null;const rt=ke?.benchmarks?.[Se.key],Dt=Bc(Se,pe),ut=Bc(Se,rt),jt=mb(Dt,ut);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Se.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:rm(Se,pe)}),jt!==null&&a.jsxs("span",{className:`pb-timeline-change ${jt>=0?"positive":"negative"}`,children:[jt>=0?"+":"",jt.toFixed(1),"%"]})]})]},Se.key)})]}),z.bodyMetrics&&Object.keys(z.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),bl.map(Se=>{const pe=z.bodyMetrics[Se.key];if(pe==null)return null;const rt=ke?.bodyMetrics?.[Se.key],Dt=rt!=null?parseFloat((pe-rt).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Se.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[pe," ",Se.suffix]}),Dt!==null&&a.jsxs("span",{className:`pb-timeline-change ${Dt>0?"positive":Dt<0?"negative":"neutral"}`,children:[Dt>0?"+":"",Dt," ",Se.suffix]})]})]},Se.key)})]})]})]},z.id)})})]})})]}),$&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:$.map((z,xe)=>a.jsx("div",{className:"pb-celebration-badge",children:z.label},xe))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Le&&a.jsxs("div",{className:`toast-notification ${Le.type}`,children:[a.jsx("span",{className:"toast-icon",children:Le.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Le.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>rn("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>rn("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>rn("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Et?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>rn("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const Hi=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],vl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function hO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ri(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function im(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function HT(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Uc(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function pb(n,e){return!e||e===0?null:(n-e)/e*100}function dO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(M=>{const D=M.benchmarks?.[e];return D?t==="time"?D.time||0:(D.weight||0)*(D.reps||0):0}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,d=300,p=100,g=20,b=d-g*2,x=p-g*2,T=s.map((M,D)=>{const X=g+D/(s.length-1)*b,H=g+x-(M-c)/u*x;return{x:X,y:H,value:M}}),N=T.map((M,D)=>`${D===0?"M":"L"} ${M.x} ${M.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${d} ${p}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradient)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((M,D)=>a.jsx("circle",{cx:M.x,cy:M.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((M,D)=>a.jsxs("span",{className:"pb-trend-label",children:[M.month.split("-")[1],"/",M.month.split("-")[0].slice(2)]},D))})]})}function fO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,d]=_.useState(!1),[p,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,M]=_.useState(!1),[D,X]=_.useState({}),[H,J]=_.useState({}),[he,Ne]=_.useState({}),[Te,C]=_.useState({}),[S,P]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[We,wt]=_.useState([]),[$,ye]=_.useState(null),[Le,Ke]=_.useState(null),[te,O]=_.useState(!1),[K,we]=_.useState(""),[Ae,Ge]=_.useState(""),[Pe,ct]=_.useState({}),[gt,nt]=_.useState({}),[Ft,Pn]=_.useState(null),[Lt,Et]=_.useState(null),[me,sn]=_.useState(""),rn=_.useRef(null),yt=_.useRef(0),At=_.useRef(0),dt=_.useRef("right"),it=_.useCallback(W=>{g(de=>{const k=Math.max(0,Math.min(Hi.length-1,W));return k===de?de:(dt.current=k>de?"right":"left",k)})},[]),{currentUser:an,isClient:Ts,clientData:Rt,loading:ln}=ii(),{isDark:ns}=Vi(),Qt=gr(),[Wt]=SC(),cn=Wt.get("mode")==="corebuddy",vn=!cn&&(!Rt?.clientType||Rt.clientType==="block"),be=_.useCallback((W,de="info")=>{Ke({message:W,type:de}),setTimeout(()=>Ke(null),4e3)},[]);_.useEffect(()=>{!ln&&(!an||!Ts)&&Qt("/")},[an,Ts,ln,Qt]),_.useEffect(()=>{Rt&&(vn?De():(async()=>{try{const[de,k,A]=await Promise.all([Vn(Qe(_e,"coreBuddyPBs",Rt.id)),Vn(Qe(_e,"coreBuddyTargets",Rt.id)),Vn(Qe(_e,"coreBuddyAchievements",Rt.id))]);de.exists()&&ct(de.data().exercises||{}),k.exists()&&nt(k.data().targets||{}),A.exists()&&Pn(A.data())}catch(de){console.error("Error loading Core Buddy PBs:",de)}c(!1)})())},[Rt]);const De=async()=>{try{const W=Dn(qt(_e,"personalBests"),fn("clientId","==",Rt.id)),k=(await An(W)).docs.map($e=>({id:$e.id,...$e.data()}));k.sort(($e,qe)=>$e.month.localeCompare(qe.month)),s(k);const A=Dn(qt(_e,"personalBestTargets"),fn("clientId","==",Rt.id)),Q=await An(A);if(!Q.empty){const $e=Q.docs[0].data();Ne($e.targets||{}),C($e.metricTargets||{}),P($e.targets||{}),L($e.metricTargets||{})}const ae=Dn(qt(_e,"achievements"),fn("clientId","==",Rt.id)),Ye=await An(ae);Ye.empty||wt(Ye.docs[0].data().badges||[])}catch(W){console.error("Error fetching personal bests:",W)}c(!1)},Be=async()=>{if(!Lt||!me||!Rt)return;const W=parseFloat(me),de=Pe[Lt];if(!de||W<=de.weight){be("Target must be higher than current PB","error");return}d(!0);try{const k={...gt,[Lt]:{targetWeight:W,setAt:mt.now(),currentPBWhenSet:de.weight}};await Kn(Qe(_e,"coreBuddyTargets",Rt.id),{clientId:Rt.id,targets:k,updatedAt:mt.now()}),nt(k),Et(null),sn(""),be("Target set!","success")}catch(k){console.error("Error saving target:",k),be("Failed to save target","error")}d(!1)},et=W=>{if(!Ft?.badges)return!1;const de=gt[W];return de?Ft.badges.some(k=>k.type==="pb_target"&&k.exercise===W&&k.targetWeight===de.targetWeight):!1},Ue=W=>{const de=gt[W];if(!de)return null;const k=Pe[W];if(!k)return 0;const A=de.currentPBWhenSet||0,Q=de.targetWeight,ae=Q-A;return ae<=0?k.weight>=Q?1:0:Math.max(0,Math.min((k.weight-A)/ae,1))},Me=hO(),ze=t.find(W=>W.month===Me),St=t.filter(W=>W.month<Me),bt=St.length>0?St[St.length-1]:null;_.useEffect(()=>{ze?(X(ze.benchmarks||{}),J(ze.bodyMetrics||{})):(X({}),J({}))},[ze?.id]);const Vt=async(W,de)=>{const k=[];if(W==="strength"?Hi.forEach(A=>{const Q=he[A.key];if(!Q)return;const ae=de[A.key];if(!ae)return;let Ye;if(Q.targetType==="time"){if(!Q.targetValue)return;const $e=Q.startValue||0,qe=ae.time||0,Ut=Q.targetValue-$e;Ye=Ut===0?qe>=Q.targetValue?1:0:Math.max(0,(qe-$e)/Ut)}else{if(!Q.targetWeight&&!Q.targetReps)return;const $e=(Q.startWeight||0)*(Q.startReps||0),qe=(Q.targetWeight||0)*(Q.targetReps||0),Ut=(ae.weight||0)*(ae.reps||0),Mt=qe-$e;Ye=Mt===0?Ut>=qe?1:0:Math.max(0,(Ut-$e)/Mt)}if(Ye>=1&&!(Q.targetType==="time"?We.some(qe=>qe.type==="strength"&&qe.key===A.key&&qe.targetValue===Q.targetValue):We.some(qe=>qe.type==="strength"&&qe.key===A.key&&qe.targetWeight===Q.targetWeight&&qe.targetReps===Q.targetReps))){const qe=Q.targetType==="time"?`${A.name} ${Q.targetValue}s`:`${A.name} ${Q.targetWeight}kg  ${Q.targetReps}`;k.push({type:"strength",key:A.key,...Q.targetType==="time"?{targetType:"time",targetValue:Q.targetValue}:{targetWeight:Q.targetWeight,targetReps:Q.targetReps},achievedMonth:Me,label:qe})}}):vl.forEach(A=>{const Q=Te[A.key];if(!Q||!Q.targetValue)return;const ae=de[A.key];if(ae==null)return;const Ye=Q.startValue||0,$e=Q.targetValue,qe=$e-Ye;(qe===0?ae===$e?1:0:Math.max(0,(ae-Ye)/qe))>=1&&(We.some(Hn=>Hn.type==="metric"&&Hn.key===A.key&&Hn.targetValue===$e)||k.push({type:"metric",key:A.key,targetValue:$e,achievedMonth:Me,label:`${A.name} ${$e}${A.suffix}`}))}),k.length>0){const A=[...We,...k];await Kn(Qe(_e,"achievements",Rt.id),{clientId:Rt.id,badges:A,updatedAt:mt.now()}),wt(A),ye(k),setTimeout(()=>ye(null),5e3)}},Ht=(W,de)=>{if(W==="strength"){const k=he[de];return k?k.targetType==="time"?We.some(A=>A.type==="strength"&&A.key===de&&A.targetValue===k.targetValue):!k.targetWeight&&!k.targetReps?!1:We.some(A=>A.type==="strength"&&A.key===de&&A.targetWeight===k.targetWeight&&A.targetReps===k.targetReps):!1}else{const k=Te[de];return!k||!k.targetValue?!1:We.some(A=>A.type==="metric"&&A.key===de&&A.targetValue===k.targetValue)}},ee=async()=>{d(!0);try{const W=`${Rt.id}_${Me}`,de=ze||{};await Kn(Qe(_e,"personalBests",W),{clientId:Rt.id,month:Me,benchmarks:D,bodyMetrics:de.bodyMetrics||H||{},createdAt:de.createdAt||mt.now(),updatedAt:mt.now()}),await Vt("strength",D),be("Benchmarks saved!","success"),x(!1),await De()}catch(W){console.error("Error saving benchmarks:",W),be("Failed to save. Please try again.","error")}d(!1)},ve=async()=>{d(!0);try{const W=`${Rt.id}_${Me}`,de=ze||{};await Kn(Qe(_e,"personalBests",W),{clientId:Rt.id,month:Me,benchmarks:de.benchmarks||D||{},bodyMetrics:H,createdAt:de.createdAt||mt.now(),updatedAt:mt.now()}),await Vt("metric",H),be("Body metrics saved!","success"),N(!1),await De()}catch(W){console.error("Error saving metrics:",W),be("Failed to save. Please try again.","error")}d(!1)},lt=(W,de,k)=>{X(A=>({...A,[W]:{...A[W],[de]:k===""?"":parseFloat(k)}}))},Ct=(W,de)=>{J(k=>({...k,[W]:de===""?"":parseFloat(de)}))},It=(W,de,k)=>{P(A=>({...A,[W]:{...A[W],[de]:k===""?"":parseFloat(k)}}))},Xt=async()=>{d(!0);try{const W=`targets_${Rt.id}`,de=ze?.benchmarks||{},k={};Hi.forEach(A=>{const Q=de[A.key];A.unit==="time"?S[A.key]?.targetValue&&(k[A.key]={targetType:"time",targetValue:S[A.key].targetValue,startValue:Q?.time||0}):(S[A.key]?.targetWeight||S[A.key]?.targetReps)&&(k[A.key]={targetWeight:S[A.key].targetWeight||0,targetReps:S[A.key].targetReps||0,startWeight:Q?.weight||0,startReps:Q?.reps||0})}),await Kn(Qe(_e,"personalBestTargets",W),{clientId:Rt.id,targets:k,metricTargets:Te,updatedAt:mt.now()}),Ne(k),P(k),be("Targets saved!","success"),M(!1)}catch(W){console.error("Error saving targets:",W),be("Failed to save targets.","error")}d(!1)},Jt=(W,de)=>{L(k=>({...k,[W]:{...k[W],targetValue:de===""?"":parseFloat(de)}}))},zt=async()=>{d(!0);try{const W=`targets_${Rt.id}`,de={};vl.forEach(k=>{if(q[k.key]?.targetValue){const A=ze?.bodyMetrics?.[k.key]||0;de[k.key]={targetValue:q[k.key].targetValue,startValue:A}}}),await Kn(Qe(_e,"personalBestTargets",W),{clientId:Rt.id,targets:he,metricTargets:de,updatedAt:mt.now()}),C(de),L(de),be("Metric targets saved!","success"),V(!1)}catch(W){console.error("Error saving metric targets:",W),be("Failed to save targets.","error")}d(!1)},Fn=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){d(!0);try{const W=Qe(_e,"personalBestTargets",`targets_${Rt.id}`);await Ar(W),Ne({}),C({}),P({}),L({}),be("All goals have been reset","success")}catch(W){console.error("Error resetting targets:",W),be("Failed to reset goals","error")}d(!1)}},os=(W,de)=>{const k=he[W];if(!k||!de)return null;if(k.targetType==="time"){if(!k.targetValue)return null;const $e=k.startValue||0,qe=k.targetValue,Ut=de.time||0,Mt=qe-$e;return Mt<=0?Ut>=qe?1:0:Math.max(0,Math.min((Ut-$e)/Mt,1))}if(!k.targetWeight&&!k.targetReps)return null;const A=(k.startWeight||0)*(k.startReps||0),Q=(k.targetWeight||0)*(k.targetReps||0),ae=(de.weight||0)*(de.reps||0),Ye=Q-A;return Ye<=0?ae>=Q?1:0:Math.max(0,Math.min((ae-A)/Ye,1))},pn=W=>{const de=Te[W];if(!de||!de.targetValue)return null;const k=ze?.bodyMetrics?.[W];if(k==null)return null;const A=de.startValue||0,Q=de.targetValue,ae=Q-A;return ae===0?k===Q?1:0:Math.max(0,Math.min((k-A)/ae,1))},In=W=>{yt.current=W.touches[0].clientX,At.current=0},On=W=>{At.current=W.touches[0].clientX-yt.current},z=()=>{At.current<-50?it(p+1):At.current>50&&it(p-1),At.current=0},xe=W=>{const de=ze?.bodyMetrics?.[W],k=bt?.bodyMetrics?.[W];return de==null||k==null?null:parseFloat((de-k).toFixed(2))},ke=t.find(W=>W.month===K),Se=t.find(W=>W.month===Ae);if(ln||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!an||!Ts||!Rt)return null;if(vn&&Rt?.isJunior)return a.jsx(uO,{});const pe=Hi[p],rt=ze?.benchmarks?.[pe.key],Dt=bt?.benchmarks?.[pe.key],ut=Uc(pe,rt),jt=Uc(pe,Dt),kt=pb(ut,jt),un=os(pe.key,rt),yr=un!==null,Gs=un!==null&&un>=1,Zs=yr?Math.round(un*60):ut>0?15:0,Xn=he[pe.key];return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>Qt(cn?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:vn?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!vn&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(Pe).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(Pe).sort(([W],[de])=>W.localeCompare(de)).map(([W,de],k)=>{const A=gt[W],Q=Ue(W),ae=Q!==null&&Q>=1,Ye=et(W),$e=Q!==null?Math.round(Q*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${k*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:i5.map((qe,Ut)=>{const Mt=Ut<$e;return a.jsx("line",{x1:qe.x1,y1:qe.y1,x2:qe.x2,y2:qe.y2,className:`pb-ring-tick ${Mt?ae?"hit":"filled":"empty"}`,strokeWidth:qe.thick?"2":"1.5"},Ut)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:Ye?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:W}),a.jsxs("div",{className:"pb-cb-card-value",children:[de.weight,"kg  ",de.reps]}),de.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(de.achievedAt.toDate?de.achievedAt.toDate():new Date(de.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),A&&!ae&&a.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",A.targetWeight,"kg (",Math.round((Q||0)*100),"%)"]}),A&&ae&&!Ye&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ye&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:A?ae&&Ye?a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Et(W),sn("")},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Et(W),sn("")},children:a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},W)})}),Object.keys(Pe).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>Qt("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Lt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Et(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:W=>W.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Lt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[Pe[Lt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:me,onChange:W=>sn(W.target.value),placeholder:String((Pe[Lt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Et(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Set Target"})]})]})})]}),vn&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:rn,onTouchStart:In,onTouchMove:On,onTouchEnd:z,children:[a.jsx("div",{className:`pb-ring-container slide-from-${dt.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((W,de)=>{const k=de<Math.round(Zs);return a.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:`pb-ring-tick ${k?Gs?"hit":"filled":"empty"}`,strokeWidth:W.thick?"3":"2"},de)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:pe.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[pe.name,Ht("strength",pe.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:rt?pe.unit==="time"?im(rt.time):HT(rt.weight,rt.reps):"-"}),kt!==null&&a.jsxs("div",{className:`pb-ring-change ${kt>=0?"positive":"negative"}`,children:[kt>=0?"+":"",kt.toFixed(1),"%"]}),kt===null&&rt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Xn&&a.jsx("div",{className:`pb-ring-target ${Gs?"hit":""}`,children:Gs?"Target hit!":Xn.targetType==="time"?`${Xn.startValue||0}s  ${Xn.targetValue}s`:`${Xn.startWeight||0}kg${Xn.startReps||0}  ${Xn.targetWeight}kg${Xn.targetReps}`}),!Xn&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},p),a.jsx("div",{className:"pb-carousel-dots",children:Hi.map((W,de)=>a.jsx("button",{className:`pb-dot ${de===p?"active":""}`,onClick:()=>it(de)},de))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>it(p-1),disabled:p===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>it(p+1),disabled:p===Hi.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(dO,{data:t,exerciseKey:pe.key,unit:pe.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:ze?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Fn,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Ri(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),X(ze?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Hi.map(W=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:D[W.key]?.weight??"",onChange:de=>lt(W.key,"weight",de.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:D[W.key]?.reps??"",onChange:de=>lt(W.key,"reps",de.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:D[W.key]?.time??"",onChange:de=>lt(W.key,"time",de.target.value),placeholder:"0"})]})})]},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),X(ze?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ee,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),P(he)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Hi.map(W=>{const de=ze?.benchmarks?.[W.key];let k="-";return de&&(W.unit==="time"&&de.time?k=`${de.time}s`:(de.weight||de.reps)&&(k=`${de.weight||0}kg  ${de.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",k]})]}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[W.key]?.targetWeight??"",onChange:A=>It(W.key,"targetWeight",A.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[W.key]?.targetReps??"",onChange:A=>It(W.key,"targetReps",A.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[W.key]?.targetValue??"",onChange:A=>It(W.key,"targetValue",A.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),P(he)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Xt,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Ri(Me)}),a.jsx("div",{className:"pb-metrics-list",children:vl.map(W=>{const de=ze?.bodyMetrics?.[W.key],k=xe(W.key),A=Te[W.key],Q=pn(W.key),ae=Q!==null&&Q>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[W.name,Ht("metric",W.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),A&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",A.targetValue," ",W.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:de!=null?`${de} ${W.suffix}`:"-"}),k!==null&&a.jsxs("span",{className:`pb-metric-change ${k>0?"up":k<0?"down":"same"}`,children:[k>0?"+":"",k," ",W.suffix]})]})]}),Q!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${ae?"hit":""}`,style:{width:`${Math.round(Q*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${ae?"hit":""}`,children:ae?"Hit!":`${Math.round(Q*100)}%`})]})]},W.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:ze?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Fn,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Ri(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),J(ze?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:vl.map(W=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[W.name," (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:H[W.key]??"",onChange:de=>Ct(W.key,de.target.value),placeholder:"0"})]})},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),J(ze?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ve,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),vl.map(W=>{const de=ze?.bodyMetrics?.[W.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",de!=null?`${de} ${W.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[W.key]?.targetValue??"",onChange:k=>Jt(W.key,k.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:zt,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[We.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((W,de)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${de*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:W.label}),a.jsx("span",{className:"pb-achievement-date",children:Ri(W.achievedMonth)})]})]},de))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${te?"active":""}`,onClick:()=>{O(!te),!te&&t.length>=2&&(we(t[0].month),Ge(t[t.length-1].month))},children:te?"Back to Timeline":"Compare Months"})}),te?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:K,onChange:W=>we(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Ri(W.month)},W.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ae,onChange:W=>Ge(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Ri(W.month)},W.month))})]})]}),ke&&Se&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Ri(K).split(" ")[0]}),a.jsx("span",{children:Ri(Ae).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Hi.map(W=>{const de=ke.benchmarks?.[W.key],k=Se.benchmarks?.[W.key],A=Uc(W,de),Q=Uc(W,k),ae=pb(Q,A);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:de?W.unit==="time"?im(de.time):`${de.weight}x${de.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:k?W.unit==="time"?im(k.time):`${k.weight}x${k.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ae!==null?ae>=0?"positive":"negative":""}`,children:ae!==null?`${ae>=0?"+":""}${ae.toFixed(1)}%`:"-"})]},W.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Ri(K).split(" ")[0]}),a.jsx("span",{children:Ri(Ae).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),vl.map(W=>{const de=ke.bodyMetrics?.[W.key],k=Se.bodyMetrics?.[W.key],A=de!=null&&k!=null?parseFloat((k-de).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:de!=null?`${de}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:k!=null?`${k}`:"-"}),a.jsx("span",{className:`pb-compare-change ${A!==null?A>0?"positive":A<0?"negative":"neutral":""}`,children:A!==null?`${A>0?"+":""}${A} ${W.suffix}`:"-"})]},W.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((W,de)=>{const k=t.find(A=>A.month<W.month&&t.indexOf(A)===t.indexOf(W)-1)||t.filter(A=>A.month<W.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${de*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Ri(W.month)}),W.benchmarks&&Object.keys(W.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),Hi.map(A=>{const Q=W.benchmarks[A.key];if(!Q)return null;const ae=k?.benchmarks?.[A.key],Ye=Uc(A,Q),$e=Uc(A,ae),qe=pb(Ye,$e);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:A.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:A.unit==="time"?im(Q.time):HT(Q.weight,Q.reps)}),qe!==null&&a.jsxs("span",{className:`pb-timeline-change ${qe>=0?"positive":"negative"}`,children:[qe>=0?"+":"",qe.toFixed(1),"%"]})]})]},A.key)})]}),W.bodyMetrics&&Object.keys(W.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),vl.map(A=>{const Q=W.bodyMetrics[A.key];if(Q==null)return null;const ae=k?.bodyMetrics?.[A.key],Ye=ae!=null?parseFloat((Q-ae).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:A.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[Q," ",A.suffix]}),Ye!==null&&a.jsxs("span",{className:`pb-timeline-change ${Ye>0?"positive":Ye<0?"negative":"neutral"}`,children:[Ye>0?"+":"",Ye," ",A.suffix]})]})]},A.key)})]})]})]},W.id)})})]})})]})]}),$&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ye(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:$.map((W,de)=>a.jsx("div",{className:"pb-celebration-badge",children:W.label},de))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Le&&a.jsxs("div",{className:`toast-notification ${Le.type}`,children:[a.jsx("span",{className:"toast-icon",children:Le.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Le.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),vn&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>Qt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Qt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Qt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Rt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>Qt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),cn&&a.jsx(ra,{active:"progress"})]})}const mO=_.lazy(()=>Cr(()=>import("./Dashboard-DzW0p7q1.js"),__vite__mapDeps([0,1]))),pO=_.lazy(()=>Cr(()=>import("./AddClient-DorY_zjf.js"),__vite__mapDeps([2,3]))),gO=_.lazy(()=>Cr(()=>import("./ClientDashboard-nsCxdtAR.js"),[])),yO=_.lazy(()=>Cr(()=>import("./ClientForms-BkzWmzsx.js"),__vite__mapDeps([4,5]))),bO=_.lazy(()=>Cr(()=>import("./ClientTools-DfeEbLk8.js"),__vite__mapDeps([6,7]))),vO=_.lazy(()=>Cr(()=>import("./MacroCalculator-e-okHNY2.js"),__vite__mapDeps([8,7]))),xO=_.lazy(()=>Cr(()=>import("./ProteinSnacks-BWA5ftvg.js"),__vite__mapDeps([9,7]))),_O=_.lazy(()=>Cr(()=>import("./DailyMotivation-CMWMSNfE.js"),__vite__mapDeps([10,7]))),wO=_.lazy(()=>Cr(()=>import("./CircuitDashboard-UEMl62iF.js"),__vite__mapDeps([11,12]))),TO=_.lazy(()=>Cr(()=>import("./CircuitBooking-DdvLj3N_.js"),__vite__mapDeps([13,14,12]))),EO=_.lazy(()=>Cr(()=>import("./Leaderboard-UplGlmvd.js"),__vite__mapDeps([15,16]))),kO=_.lazy(()=>Cr(()=>import("./UpgradePage-D0wfExQz.js"),__vite__mapDeps([17,18,19]))),SO=_.lazy(()=>Cr(()=>import("./SignUp-RdvelYHz.js"),[])),jO=_.lazy(()=>Cr(()=>import("./Onboarding-CPQXn9V6.js"),__vite__mapDeps([20,18,21])));function NO({children:n}){const{pathname:e}=Li();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function AO(){const n=gr();return _.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function RO(){return a.jsx(YV,{children:a.jsx(QV,{children:a.jsx(e5,{children:a.jsxs(_C,{basename:"/login",children:[a.jsx(AO,{}),a.jsx(NO,{children:a.jsx(_.Suspense,{fallback:null,children:a.jsxs(YR,{children:[a.jsx(cs,{path:"/",element:a.jsx(s5,{})}),a.jsx(cs,{path:"/dashboard",element:a.jsx(mO,{})}),a.jsx(cs,{path:"/add-client",element:a.jsx(pO,{})}),a.jsx(cs,{path:"/client",element:a.jsx(gO,{})}),a.jsx(cs,{path:"/client/forms",element:a.jsx(yO,{})}),a.jsx(cs,{path:"/client/tools",element:a.jsx(bO,{})}),a.jsx(cs,{path:"/client/tools/macros",element:a.jsx(vO,{})}),a.jsx(cs,{path:"/client/tools/snacks",element:a.jsx(xO,{})}),a.jsx(cs,{path:"/client/tools/motivation",element:a.jsx(_O,{})}),a.jsx(cs,{path:"/client/personal-bests",element:a.jsx(yl,{feature:"personalBests",children:a.jsx(fO,{})})}),a.jsx(cs,{path:"/client/circuit",element:a.jsx(wO,{})}),a.jsx(cs,{path:"/client/circuit/booking",element:a.jsx(TO,{})}),a.jsx(cs,{path:"/client/core-buddy",element:a.jsx(S5,{})}),a.jsx(cs,{path:"/client/core-buddy/nutrition",element:a.jsx(yl,{feature:"nutrition",children:a.jsx(A5,{})})}),a.jsx(cs,{path:"/client/core-buddy/workouts",element:a.jsx(U5,{})}),a.jsx(cs,{path:"/client/core-buddy/programmes",element:a.jsx(yl,{feature:"programmes",children:a.jsx($5,{})})}),a.jsx(cs,{path:"/client/core-buddy/achievements",element:a.jsx(yl,{feature:"achievements",children:a.jsx(X5,{})})}),a.jsx(cs,{path:"/client/core-buddy/consistency",element:a.jsx(yl,{feature:"consistency",children:a.jsx(eO,{})})}),a.jsx(cs,{path:"/client/core-buddy/buddies",element:a.jsx(yl,{feature:"buddies",children:a.jsx(tO,{})})}),a.jsx(cs,{path:"/client/core-buddy/profile/:userId",element:a.jsx(iO,{})}),a.jsx(cs,{path:"/client/leaderboard",element:a.jsx(yl,{feature:"leaderboard",children:a.jsx(EO,{})})}),a.jsx(cs,{path:"/signup",element:a.jsx(SO,{})}),a.jsx(cs,{path:"/onboarding",element:a.jsx(jO,{})}),a.jsx(cs,{path:"/upgrade",element:a.jsx(kO,{})}),a.jsx(cs,{path:"*",element:a.jsx(KR,{to:"/",replace:!0})})]})})})]})})})})}QA.createRoot(document.getElementById("root")).render(a.jsx(_.StrictMode,{children:a.jsx(RO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Ap as $,Uj as A,od as B,ra as C,hL as D,ei as E,BO as F,ta as G,ts as H,ti as I,Iu as J,Xl as K,as as L,Ce as M,na as N,rL as O,jL as P,or as Q,Du as R,Nd as S,mt as T,wm as U,Rp as V,Ad as W,Np as X,A0 as Y,ni as Z,Cr as _,gr as a,tB as a$,Ro as a0,SL as a1,bi as a2,EL as a3,Sv as a4,Ns as a5,Vl as a6,Je as a7,DO as a8,jP as a9,zO as aA,$O as aB,RB as aC,oB as aD,aB as aE,ws as aF,Rd as aG,mL as aH,dB as aI,wB as aJ,TB as aK,EB as aL,kB as aM,iL as aN,AB as aO,Nl as aP,UO as aQ,Ym as aR,sB as aS,wT as aT,fB as aU,pB as aV,mB as aW,aL as aX,Xm as aY,SB as aZ,jB as a_,bs as aa,DB as ab,bn as ac,IO as ad,eB as ae,ZO as af,MO as ag,xi as ah,VP as ai,uB as aj,hB as ak,nB as al,XO as am,YO as an,cB as ao,qO as ap,VO as aq,sL as ar,fL as as,IB as at,QO as au,WO as av,CB as aw,KO as ax,bB as ay,FO as az,_e as b,gB as b0,yB as b1,_L as b2,Rj as b3,vB as b4,OO as b5,_B as b6,NB as b7,CO as b8,xB as b9,iB as ba,rB as bb,lB as bc,GO as bd,JO as be,HO as bf,jT as bg,Ea as c,Qe as d,Vi as e,qt as f,Vn as g,An as h,q0 as i,a as j,t5 as k,n5 as l,uD as m,PB as n,pD as o,Ra as p,Dn as q,_ as r,Kn as s,Ar as t,ii as u,Dp as v,fn as w,SC as x,yi as y,Qm as z};
