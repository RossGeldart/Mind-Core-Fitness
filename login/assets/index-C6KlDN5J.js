const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard--1eBSnU9.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-sxpbjvlw.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-YNpyW40b.js","assets/ClientForms-BM39Da_t.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-Hwo9J3X2.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BHUTkPPi.js","assets/ProteinSnacks-BKGA_Sy7.js","assets/DailyMotivation-DKUOvT1M.js","assets/CircuitDashboard-uxrDo-_g.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-CfRWy1XP.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-BxItv3mI.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-DbHmhBUG.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-DV7FLw_2.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var bp={exports:{}},Jc={};var w1;function jT(){if(w1)return Jc;w1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Jc.Fragment=e,Jc.jsx=t,Jc.jsxs=t,Jc}var _1;function TT(){return _1||(_1=1,bp.exports=jT()),bp.exports}var r=TT(),vp={exports:{}},rs={};var k1;function ET(){if(k1)return rs;k1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.iterator;function B(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function ee(P,re,Pe){this.props=P,this.context=re,this.refs=L,this.updater=Pe||W}ee.prototype.isReactComponent={},ee.prototype.setState=function(P,re){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,re,"setState")},ee.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Y(){}Y.prototype=ee.prototype;function te(P,re,Pe){this.props=P,this.context=re,this.refs=L,this.updater=Pe||W}var we=te.prototype=new Y;we.constructor=te,V(we,ee.prototype),we.isPureReactComponent=!0;var Ce=Array.isArray;function xe(){}var C={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function A(P,re,Pe){var Be=Pe.ref;return{$$typeof:n,type:P,key:re,ref:Be!==void 0?Be:null,props:Pe}}function O(P,re){return A(P.type,re,P.props)}function M(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function z(P){var re={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Pe){return re[Pe]})}var I=/\/+/g;function We(P,re){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):re.toString(36)}function bt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(xe,xe):(P.status="pending",P.then(function(re){P.status==="pending"&&(P.status="fulfilled",P.value=re)},function(re){P.status==="pending"&&(P.status="rejected",P.reason=re)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function q(P,re,Pe,Be,De){var Ne=typeof P;(Ne==="undefined"||Ne==="boolean")&&(P=null);var it=!1;if(P===null)it=!0;else switch(Ne){case"bigint":case"string":case"number":it=!0;break;case"object":switch(P.$$typeof){case n:case e:it=!0;break;case x:return it=P._init,q(it(P._payload),re,Pe,Be,De)}}if(it)return De=De(P),it=Be===""?"."+We(P,0):Be,Ce(De)?(Pe="",it!=null&&(Pe=it.replace(I,"$&/")+"/"),q(De,re,Pe,"",function(Yt){return Yt})):De!=null&&(M(De)&&(De=O(De,Pe+(De.key==null||P&&P.key===De.key?"":(""+De.key).replace(I,"$&/")+"/")+it)),re.push(De)),1;it=0;var ft=Be===""?".":Be+":";if(Ce(P))for(var et=0;et<P.length;et++)Be=P[et],Ne=ft+We(Be,et),it+=q(Be,re,Pe,Ne,De);else if(et=B(P),typeof et=="function")for(P=et.call(P),et=0;!(Be=P.next()).done;)Be=Be.value,Ne=ft+We(Be,et++),it+=q(Be,re,Pe,Ne,De);else if(Ne==="object"){if(typeof P.then=="function")return q(bt(P),re,Pe,Be,De);throw re=String(P),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return it}function me(P,re,Pe){if(P==null)return P;var Be=[],De=0;return q(P,Be,"","",function(Ne){return re.call(Pe,Ne,De++)}),Be}function Me(P){if(P._status===-1){var re=P._result;re=re(),re.then(function(Pe){(P._status===0||P._status===-1)&&(P._status=1,P._result=Pe)},function(Pe){(P._status===0||P._status===-1)&&(P._status=2,P._result=Pe)}),P._status===-1&&(P._status=0,P._result=re)}if(P._status===1)return P._result.default;throw P._result}var Ue=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},X={map:me,forEach:function(P,re,Pe){me(P,function(){re.apply(this,arguments)},Pe)},count:function(P){var re=0;return me(P,function(){re++}),re},toArray:function(P){return me(P,function(re){return re})||[]},only:function(P){if(!M(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return rs.Activity=k,rs.Children=X,rs.Component=ee,rs.Fragment=t,rs.Profiler=l,rs.PureComponent=te,rs.StrictMode=i,rs.Suspense=g,rs.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,rs.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},rs.cache=function(P){return function(){return P.apply(null,arguments)}},rs.cacheSignal=function(){return null},rs.cloneElement=function(P,re,Pe){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Be=V({},P.props),De=P.key;if(re!=null)for(Ne in re.key!==void 0&&(De=""+re.key),re)!T.call(re,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&re.ref===void 0||(Be[Ne]=re[Ne]);var Ne=arguments.length-2;if(Ne===1)Be.children=Pe;else if(1<Ne){for(var it=Array(Ne),ft=0;ft<Ne;ft++)it[ft]=arguments[ft+2];Be.children=it}return A(P.type,De,Be)},rs.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},rs.createElement=function(P,re,Pe){var Be,De={},Ne=null;if(re!=null)for(Be in re.key!==void 0&&(Ne=""+re.key),re)T.call(re,Be)&&Be!=="key"&&Be!=="__self"&&Be!=="__source"&&(De[Be]=re[Be]);var it=arguments.length-2;if(it===1)De.children=Pe;else if(1<it){for(var ft=Array(it),et=0;et<it;et++)ft[et]=arguments[et+2];De.children=ft}if(P&&P.defaultProps)for(Be in it=P.defaultProps,it)De[Be]===void 0&&(De[Be]=it[Be]);return A(P,Ne,De)},rs.createRef=function(){return{current:null}},rs.forwardRef=function(P){return{$$typeof:p,render:P}},rs.isValidElement=M,rs.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:Me}},rs.memo=function(P,re){return{$$typeof:y,type:P,compare:re===void 0?null:re}},rs.startTransition=function(P){var re=C.T,Pe={};C.T=Pe;try{var Be=P(),De=C.S;De!==null&&De(Pe,Be),typeof Be=="object"&&Be!==null&&typeof Be.then=="function"&&Be.then(xe,Ue)}catch(Ne){Ue(Ne)}finally{re!==null&&Pe.types!==null&&(re.types=Pe.types),C.T=re}},rs.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},rs.use=function(P){return C.H.use(P)},rs.useActionState=function(P,re,Pe){return C.H.useActionState(P,re,Pe)},rs.useCallback=function(P,re){return C.H.useCallback(P,re)},rs.useContext=function(P){return C.H.useContext(P)},rs.useDebugValue=function(){},rs.useDeferredValue=function(P,re){return C.H.useDeferredValue(P,re)},rs.useEffect=function(P,re){return C.H.useEffect(P,re)},rs.useEffectEvent=function(P){return C.H.useEffectEvent(P)},rs.useId=function(){return C.H.useId()},rs.useImperativeHandle=function(P,re,Pe){return C.H.useImperativeHandle(P,re,Pe)},rs.useInsertionEffect=function(P,re){return C.H.useInsertionEffect(P,re)},rs.useLayoutEffect=function(P,re){return C.H.useLayoutEffect(P,re)},rs.useMemo=function(P,re){return C.H.useMemo(P,re)},rs.useOptimistic=function(P,re){return C.H.useOptimistic(P,re)},rs.useReducer=function(P,re,Pe){return C.H.useReducer(P,re,Pe)},rs.useRef=function(P){return C.H.useRef(P)},rs.useState=function(P){return C.H.useState(P)},rs.useSyncExternalStore=function(P,re,Pe){return C.H.useSyncExternalStore(P,re,Pe)},rs.useTransition=function(){return C.H.useTransition()},rs.version="19.2.4",rs}var j1;function Dg(){return j1||(j1=1,vp.exports=ET()),vp.exports}var v=Dg(),xp={exports:{}},Zc={},wp={exports:{}},_p={};var T1;function ST(){return T1||(T1=1,(function(n){function e(q,me){var Me=q.length;q.push(me);e:for(;0<Me;){var Ue=Me-1>>>1,X=q[Ue];if(0<l(X,me))q[Ue]=me,q[Me]=X,Me=Ue;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var me=q[0],Me=q.pop();if(Me!==me){q[0]=Me;e:for(var Ue=0,X=q.length,P=X>>>1;Ue<P;){var re=2*(Ue+1)-1,Pe=q[re],Be=re+1,De=q[Be];if(0>l(Pe,Me))Be<X&&0>l(De,Pe)?(q[Ue]=De,q[Be]=Me,Ue=Be):(q[Ue]=Pe,q[re]=Me,Ue=re);else if(Be<X&&0>l(De,Me))q[Ue]=De,q[Be]=Me,Ue=Be;else break e}}return me}function l(q,me){var Me=q.sortIndex-me.sortIndex;return Me!==0?Me:q.id-me.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,k=null,j=3,B=!1,W=!1,V=!1,L=!1,ee=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function we(q){for(var me=t(y);me!==null;){if(me.callback===null)i(y);else if(me.startTime<=q)i(y),me.sortIndex=me.expirationTime,e(g,me);else break;me=t(y)}}function Ce(q){if(V=!1,we(q),!W)if(t(g)!==null)W=!0,xe||(xe=!0,z());else{var me=t(y);me!==null&&bt(Ce,me.startTime-q)}}var xe=!1,C=-1,T=5,A=-1;function O(){return L?!0:!(n.unstable_now()-A<T)}function M(){if(L=!1,xe){var q=n.unstable_now();A=q;var me=!0;try{e:{W=!1,V&&(V=!1,Y(C),C=-1),B=!0;var Me=j;try{t:{for(we(q),k=t(g);k!==null&&!(k.expirationTime>q&&O());){var Ue=k.callback;if(typeof Ue=="function"){k.callback=null,j=k.priorityLevel;var X=Ue(k.expirationTime<=q);if(q=n.unstable_now(),typeof X=="function"){k.callback=X,we(q),me=!0;break t}k===t(g)&&i(g),we(q)}else i(g);k=t(g)}if(k!==null)me=!0;else{var P=t(y);P!==null&&bt(Ce,P.startTime-q),me=!1}}break e}finally{k=null,j=Me,B=!1}me=void 0}}finally{me?z():xe=!1}}}var z;if(typeof te=="function")z=function(){te(M)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,We=I.port2;I.port1.onmessage=M,z=function(){We.postMessage(null)}}else z=function(){ee(M,0)};function bt(q,me){C=ee(function(){q(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(q){switch(j){case 1:case 2:case 3:var me=3;break;default:me=j}var Me=j;j=me;try{return q()}finally{j=Me}},n.unstable_requestPaint=function(){L=!0},n.unstable_runWithPriority=function(q,me){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Me=j;j=q;try{return me()}finally{j=Me}},n.unstable_scheduleCallback=function(q,me,Me){var Ue=n.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?Ue+Me:Ue):Me=Ue,q){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Me+X,q={id:x++,callback:me,priorityLevel:q,startTime:Me,expirationTime:X,sortIndex:-1},Me>Ue?(q.sortIndex=Me,e(y,q),t(g)===null&&q===t(y)&&(V?(Y(C),C=-1):V=!0,bt(Ce,Me-Ue))):(q.sortIndex=X,e(g,q),W||B||(W=!0,xe||(xe=!0,z()))),q},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(q){var me=j;return function(){var Me=j;j=me;try{return q.apply(this,arguments)}finally{j=Me}}}})(_p)),_p}var E1;function NT(){return E1||(E1=1,wp.exports=ST()),wp.exports}var kp={exports:{}},pr={};var S1;function CT(){if(S1)return pr;S1=1;var n=Dg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return pr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pr.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},pr.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},pr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},pr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},pr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,B=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:j,fetchPriority:B}):x==="script"&&i.d.X(g,{crossOrigin:k,integrity:j,fetchPriority:B,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},pr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},pr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},pr.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},pr.requestFormReset=function(g){i.d.r(g)},pr.unstable_batchedUpdates=function(g,y){return g(y)},pr.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},pr.useFormStatus=function(){return d.H.useHostTransitionStatus()},pr.version="19.2.4",pr}var N1;function RT(){if(N1)return kp.exports;N1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kp.exports=CT(),kp.exports}var C1;function AT(){if(C1)return Zc;C1=1;var n=NT(),e=Dg(),t=RT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,S=m.child;S;){if(S===o){w=!0,o=m,c=f;break}if(S===c){w=!0,c=m,o=f;break}S=S.sibling}if(!w){for(S=f.child;S;){if(S===o){w=!0,o=f,c=m;break}if(S===c){w=!0,c=f,o=m;break}S=S.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var k=Object.assign,j=Symbol.for("react.element"),B=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),te=Symbol.for("react.context"),we=Symbol.for("react.forward_ref"),Ce=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=M&&s[M]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function We(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case ee:return"Profiler";case L:return"StrictMode";case Ce:return"Suspense";case xe:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case W:return"Portal";case te:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case we:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:We(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return We(s(a))}catch{}}return null}var bt=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},Ue=[],X=-1;function P(s){return{current:s}}function re(s){0>X||(s.current=Ue[X],Ue[X]=null,X--)}function Pe(s,a){X++,Ue[X]=s.current,s.current=a}var Be=P(null),De=P(null),Ne=P(null),it=P(null);function ft(s,a){switch(Pe(Ne,a),Pe(De,s),Pe(Be,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?H0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=H0(a),s=$0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(Be),Pe(Be,s)}function et(){re(Be),re(De),re(Ne)}function Yt(s){s.memoizedState!==null&&Pe(it,s);var a=Be.current,o=$0(a,s.type);a!==o&&(Pe(De,s),Pe(Be,o))}function Ts(s){De.current===s&&(re(Be),re(De)),it.current===s&&(re(it),Kc._currentValue=Me)}var Pt,vt;function ie(s){if(Pt===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);Pt=a&&a[1]||"",vt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pt+s+vt}var Ct=!1;function _t(s,a){if(!s||Ct)return"";Ct=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(ve){var he=ve}Reflect.construct(s,[],Oe)}else{try{Oe.call()}catch(ve){he=ve}s.call(Oe.prototype)}}else{try{throw Error()}catch(ve){he=ve}(Oe=s())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(ve){if(ve&&he&&typeof ve.stack=="string")return[ve.stack,he.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],S=f[1];if(w&&S){var F=w.split(`
`),ce=S.split(`
`);for(m=c=0;c<F.length&&!F[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ce.length&&!ce[m].includes("DetermineComponentFrameRoot");)m++;if(c===F.length||m===ce.length)for(c=F.length-1,m=ce.length-1;1<=c&&0<=m&&F[c]!==ce[m];)m--;for(;1<=c&&0<=m;c--,m--)if(F[c]!==ce[m]){if(c!==1||m!==1)do if(c--,m--,0>m||F[c]!==ce[m]){var Ee=`
`+F[c].replace(" at new "," at ");return s.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",s.displayName)),Ee}while(1<=c&&0<=m);break}}}finally{Ct=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ie(o):""}function zt(s,a){switch(s.tag){case 26:case 27:case 5:return ie(s.type);case 16:return ie("Lazy");case 13:return s.child!==a&&a!==null?ie("Suspense Fallback"):ie("Suspense");case 19:return ie("SuspenseList");case 0:case 15:return _t(s.type,!1);case 11:return _t(s.type.render,!1);case 1:return _t(s.type,!0);case 31:return ie("Activity");default:return""}}function Tt(s){try{var a="",o=null;do a+=zt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var kt=Object.prototype.hasOwnProperty,tt=n.unstable_scheduleCallback,pt=n.unstable_cancelCallback,Qt=n.unstable_shouldYield,zs=n.unstable_requestPaint,Ft=n.unstable_now,At=n.unstable_getCurrentPriorityLevel,is=n.unstable_ImmediatePriority,Cs=n.unstable_UserBlockingPriority,ss=n.unstable_NormalPriority,sn=n.unstable_LowPriority,Ms=n.unstable_IdlePriority,Os=n.log,ls=n.unstable_setDisableYieldValue,ps=null,ye=null;function Se(s){if(typeof Os=="function"&&ls(s),ye&&typeof ye.setStrictMode=="function")try{ye.setStrictMode(ps,s)}catch{}}var Le=Math.clz32?Math.clz32:Xe,Qe=Math.log,ze=Math.LN2;function Xe(s){return s>>>=0,s===0?32:31-(Qe(s)/ze|0)|0}var dt=256,Q=262144,se=4194304;function He(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function gt(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=He(c):(w&=S,w!==0?m=He(w):o||(o=S&~s,o!==0&&(m=He(o))))):(S=c&~f,S!==0?m=He(S):w!==0?m=He(w):o||(o=c&~s,o!==0&&(m=He(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function Ye(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function J(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ke(){var s=se;return se<<=1,(se&62914560)===0&&(se=4194304),s}function qe(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function nt(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function lt(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,F=s.expirationTimes,ce=s.hiddenUpdates;for(o=w&~o;0<o;){var Ee=31-Le(o),Oe=1<<Ee;S[Ee]=0,F[Ee]=-1;var he=ce[Ee];if(he!==null)for(ce[Ee]=null,Ee=0;Ee<he.length;Ee++){var ve=he[Ee];ve!==null&&(ve.lane&=-536870913)}o&=~Oe}c!==0&&St(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function St(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Le(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Xt(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Le(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Bt(s,a){var o=a&-a;return o=(o&42)!==0?1:U(o),(o&(s.suspendedLanes|a))!==0?0:o}function U(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function fe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Re(){var s=me.p;return s!==0?s:(s=window.event,s===void 0?32:f1(s.type))}function Te(s,a){var o=me.p;try{return me.p=s,a()}finally{me.p=o}}var je=Math.random().toString(36).slice(2),ht="__reactFiber$"+je,Et="__reactProps$"+je,ot="__reactContainer$"+je,Lt="__reactEvents$"+je,It="__reactListeners$"+je,nn="__reactHandles$"+je,hn="__reactResources$"+je,mn="__reactMarker$"+je;function rn(s){delete s[ht],delete s[Et],delete s[Lt],delete s[It],delete s[nn]}function xn(s){var a=s[ht];if(a)return a;for(var o=s.parentNode;o;){if(a=o[ot]||o[ht]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=J0(s);s!==null;){if(o=s[ht])return o;s=J0(s)}return a}s=o,o=s.parentNode}return null}function ln(s){if(s=s[ht]||s[ot]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function ms(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function $(s){var a=s[hn];return a||(a=s[hn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function de(s){s[mn]=!0}var ue=new Set,E={};function D(s,a){ne(s,a),ne(s+"Capture",a)}function ne(s,a){for(E[s]=a,s=0;s<a.length;s++)ue.add(a[s])}var ae=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},Ge={};function Je(s){return kt.call(Ge,s)?!0:kt.call($e,s)?!1:ae.test(s)?Ge[s]=!0:($e[s]=!0,!1)}function Vt(s,a,o){if(Je(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function xt(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function qt(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function vs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function yn(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function wr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function fs(s){if(!s._valueTracker){var a=yn(s)?"checked":"value";s._valueTracker=wr(s,a,""+s[a])}}function ea(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=yn(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Mn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var G=/[\n"\\]/g;function be(s){return s.replace(G,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function _e(s,a,o,c,m,f,w,S){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+vs(a)):s.value!==""+vs(a)&&(s.value=""+vs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?rt(s,w,vs(a)):o!=null?rt(s,w,vs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+vs(S):s.removeAttribute("name")}function at(s,a,o,c,m,f,w,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){fs(s);return}o=o!=null?""+vs(o):"",a=a!=null?""+vs(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),fs(s)}function rt(s,a,o){a==="number"&&Mn(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function mt(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+vs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Gt(s,a,o){if(a!=null&&(a=""+vs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+vs(o):""}function Kt(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(bt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=vs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),fs(s)}function Jt(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Dn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function os(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Dn.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Es(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&os(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&os(s,f,a[f])}function wn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ds=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $s(s){return Ds.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Zt(){}var Ps=null;function an(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var er=null,zn=null;function Nn(s){var a=ln(s);if(a&&(s=a.stateNode)){var o=s[Et]||null;e:switch(s=a.stateNode,a.type){case"input":if(_e(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+be(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[Et]||null;if(!m)throw Error(i(90));_e(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&ea(c)}break e;case"textarea":Gt(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&mt(s,!!o.multiple,a,!1)}}}var Kn=!1;function hr(s,a,o){if(Kn)return s(a,o);Kn=!0;try{var c=s(a);return c}finally{if(Kn=!1,(er!==null||zn!==null)&&(Md(),er&&(a=er,s=zn,zn=er=null,Nn(a),s)))for(a=0;a<s.length;a++)Nn(s[a])}}function Yn(s,a){var o=s.stateNode;if(o===null)return null;var c=o[Et]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rr=!1;if(mr)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){Rr=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{Rr=!1}var ta=null,wo=null,Xa=null;function _o(){if(Xa)return Xa;var s,a=wo,o=a.length,c,m="value"in ta?ta.value:ta.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return Xa=m.slice(s,1<c?1-c:void 0)}function N(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function K(){return!0}function Fe(){return!1}function Ze(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?K:Fe,this.isPropagationStopped=Fe,this}return k(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=K)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=K)},persist:function(){},isPersistent:K}),a}var wt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ot=Ze(wt),ut=k({},wt,{view:0,detail:0}),es=Ze(ut),ns,Ss,hs,Bs=k({},ut,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ma,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hs&&(hs&&s.type==="mousemove"?(ns=s.screenX-hs.screenX,Ss=s.screenY-hs.screenY):Ss=ns=0,hs=s),ns)},movementY:function(s){return"movementY"in s?s.movementY:Ss}}),qr=Ze(Bs),Ar=k({},Bs,{dataTransfer:0}),cn=Ze(Ar),bn=k({},ut,{relatedTarget:0}),qn=Ze(bn),Qn=k({},wt,{animationName:0,elapsedTime:0,pseudoElement:0}),tr=Ze(Qn),sr=k({},wt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ir=Ze(sr),_r=k({},wt,{data:0}),_n=Ze(_r),Hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ko(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Dr[s])?!!a[s]:!1}function Ma(){return ko}var nr=k({},ut,{key:function(s){if(s.key){var a=Hn[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=N(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Mr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ma,charCode:function(s){return s.type==="keypress"?N(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?N(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ja=Ze(nr),pa=k({},Bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fr=Ze(pa),h=k({},ut,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ma}),b=Ze(h),_=k({},wt,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=Ze(_),oe=k({},Bs,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ge=Ze(oe),st=k({},wt,{newState:0,oldState:0}),cs=Ze(st),Cn=[9,13,27,32],qs=mr&&"CompositionEvent"in window,fn=null;mr&&"documentMode"in document&&(fn=document.documentMode);var sa=mr&&"TextEvent"in window&&!fn,Da=mr&&(!qs||fn&&8<fn&&11>=fn),ga=" ",ya=!1;function jo(s,a){switch(s){case"keyup":return Cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ll(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var cl=!1;function Kk(s,a){switch(s){case"compositionend":return ll(a);case"keypress":return a.which!==32?null:(ya=!0,ga);case"textInput":return s=a.data,s===ga&&ya?null:s;default:return null}}function Yk(s,a){if(cl)return s==="compositionend"||!qs&&jo(s,a)?(s=_o(),Xa=wo=ta=null,cl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Da&&a.locale!=="ko"?null:a.data;default:return null}}var Qk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Qk[s.type]:a==="textarea"}function sb(s,a,o,c){er?zn?zn.push(c):zn=[c]:er=c,a=Ud(a,"onChange"),0<a.length&&(o=new Ot("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var gc=null,yc=null;function Xk(s){B0(s,0)}function Ju(s){var a=ms(s);if(ea(a))return s}function nb(s,a){if(s==="change")return a}var rb=!1;if(mr){var jm;if(mr){var Tm="oninput"in document;if(!Tm){var ab=document.createElement("div");ab.setAttribute("oninput","return;"),Tm=typeof ab.oninput=="function"}jm=Tm}else jm=!1;rb=jm&&(!document.documentMode||9<document.documentMode)}function ib(){gc&&(gc.detachEvent("onpropertychange",ob),yc=gc=null)}function ob(s){if(s.propertyName==="value"&&Ju(yc)){var a=[];sb(a,yc,s,an(s)),hr(Xk,a)}}function Jk(s,a,o){s==="focusin"?(ib(),gc=a,yc=o,gc.attachEvent("onpropertychange",ob)):s==="focusout"&&ib()}function Zk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ju(yc)}function ej(s,a){if(s==="click")return Ju(a)}function tj(s,a){if(s==="input"||s==="change")return Ju(a)}function sj(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Hr=typeof Object.is=="function"?Object.is:sj;function bc(s,a){if(Hr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!kt.call(a,m)||!Hr(s[m],a[m]))return!1}return!0}function lb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cb(s,a){var o=lb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=lb(o)}}function ub(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?ub(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function db(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Mn(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Mn(s.document)}return a}function Em(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var nj=mr&&"documentMode"in document&&11>=document.documentMode,ul=null,Sm=null,vc=null,Nm=!1;function hb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Nm||ul==null||ul!==Mn(c)||(c=ul,"selectionStart"in c&&Em(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),vc&&bc(vc,c)||(vc=c,c=Ud(Sm,"onSelect"),0<c.length&&(a=new Ot("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=ul)))}function To(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var dl={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionrun:To("Transition","TransitionRun"),transitionstart:To("Transition","TransitionStart"),transitioncancel:To("Transition","TransitionCancel"),transitionend:To("Transition","TransitionEnd")},Cm={},mb={};mr&&(mb=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function Eo(s){if(Cm[s])return Cm[s];if(!dl[s])return s;var a=dl[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in mb)return Cm[s]=a[o];return s}var fb=Eo("animationend"),pb=Eo("animationiteration"),gb=Eo("animationstart"),rj=Eo("transitionrun"),aj=Eo("transitionstart"),ij=Eo("transitioncancel"),yb=Eo("transitionend"),bb=new Map,Rm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rm.push("scrollEnd");function ba(s,a){bb.set(s,a),D(a,[s])}var Zu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},na=[],hl=0,Am=0;function ed(){for(var s=hl,a=Am=hl=0;a<s;){var o=na[a];na[a++]=null;var c=na[a];na[a++]=null;var m=na[a];na[a++]=null;var f=na[a];if(na[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&vb(o,m,f)}}function td(s,a,o,c){na[hl++]=s,na[hl++]=a,na[hl++]=o,na[hl++]=c,Am|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Im(s,a,o,c){return td(s,a,o,c),sd(s)}function So(s,a){return td(s,null,null,a),sd(s)}function vb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Le(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function sd(s){if(50<Fc)throw Fc=0,zf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ml={};function oj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $r(s,a,o,c){return new oj(s,a,o,c)}function Mm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Za(s,a){var o=s.alternate;return o===null?(o=$r(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function xb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function nd(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Mm(s)&&(w=1);else if(typeof s=="string")w=hT(s,o,Be.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=$r(31,o,a,m),s.elementType=A,s.lanes=f,s;case V:return No(o.children,m,f,a);case L:w=8,m|=24;break;case ee:return s=$r(12,o,a,m|2),s.elementType=ee,s.lanes=f,s;case Ce:return s=$r(13,o,a,m),s.elementType=Ce,s.lanes=f,s;case xe:return s=$r(19,o,a,m),s.elementType=xe,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:w=10;break e;case Y:w=9;break e;case we:w=11;break e;case C:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=$r(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function No(s,a,o,c){return s=$r(7,s,c,a),s.lanes=o,s}function Dm(s,a,o){return s=$r(6,s,null,a),s.lanes=o,s}function wb(s){var a=$r(18,null,null,0);return a.stateNode=s,a}function Pm(s,a,o){return a=$r(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var _b=new WeakMap;function ra(s,a){if(typeof s=="object"&&s!==null){var o=_b.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Tt(a)},_b.set(s,a),a)}return{value:s,source:a,stack:Tt(a)}}var fl=[],pl=0,rd=null,xc=0,aa=[],ia=0,Si=null,Pa=1,La="";function ei(s,a){fl[pl++]=xc,fl[pl++]=rd,rd=s,xc=a}function kb(s,a,o){aa[ia++]=Pa,aa[ia++]=La,aa[ia++]=Si,Si=s;var c=Pa;s=La;var m=32-Le(c)-1;c&=~(1<<m),o+=1;var f=32-Le(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Pa=1<<32-Le(a)+m|o<<m|c,La=f+s}else Pa=1<<f|o<<m|c,La=s}function Lm(s){s.return!==null&&(ei(s,1),kb(s,1,0))}function Om(s){for(;s===rd;)rd=fl[--pl],fl[pl]=null,xc=fl[--pl],fl[pl]=null;for(;s===Si;)Si=aa[--ia],aa[ia]=null,La=aa[--ia],aa[ia]=null,Pa=aa[--ia],aa[ia]=null}function jb(s,a){aa[ia++]=Pa,aa[ia++]=La,aa[ia++]=Si,Pa=a.id,La=a.overflow,Si=s}var rr=null,un=null,Ns=!1,Ni=null,oa=!1,Bm=Error(i(519));function Ci(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wc(ra(a,s)),Bm}function Tb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[ht]=s,a[Et]=c,o){case"dialog":ys("cancel",a),ys("close",a);break;case"iframe":case"object":case"embed":ys("load",a);break;case"video":case"audio":for(o=0;o<qc.length;o++)ys(qc[o],a);break;case"source":ys("error",a);break;case"img":case"image":case"link":ys("error",a),ys("load",a);break;case"details":ys("toggle",a);break;case"input":ys("invalid",a),at(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ys("invalid",a);break;case"textarea":ys("invalid",a),Kt(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||z0(a.textContent,o)?(c.popover!=null&&(ys("beforetoggle",a),ys("toggle",a)),c.onScroll!=null&&ys("scroll",a),c.onScrollEnd!=null&&ys("scrollend",a),c.onClick!=null&&(a.onclick=Zt),a=!0):a=!1,a||Ci(s,!0)}function Eb(s){for(rr=s.return;rr;)switch(rr.tag){case 5:case 31:case 13:oa=!1;return;case 27:case 3:oa=!0;return;default:rr=rr.return}}function gl(s){if(s!==rr)return!1;if(!Ns)return Eb(s),Ns=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||np(s.type,s.memoizedProps)),o=!o),o&&un&&Ci(s),Eb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));un=X0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));un=X0(s)}else a===27?(a=un,qi(s.type)?(s=lp,lp=null,un=s):un=a):un=rr?ca(s.stateNode.nextSibling):null;return!0}function Co(){un=rr=null,Ns=!1}function Vm(){var s=Ni;return s!==null&&(Br===null?Br=s:Br.push.apply(Br,s),Ni=null),s}function wc(s){Ni===null?Ni=[s]:Ni.push(s)}var Um=P(null),Ro=null,ti=null;function Ri(s,a,o){Pe(Um,a._currentValue),a._currentValue=o}function si(s){s._currentValue=Um.current,re(Um)}function Fm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function zm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var F=0;F<a.length;F++)if(S.context===a[F]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Fm(f.return,o,s),c||(w=null);break e}f=S.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),Fm(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function yl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var S=m.type;Hr(m.pendingProps.value,w.value)||(s!==null?s.push(S):s=[S])}}else if(m===it.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Kc):s=[Kc])}m=m.return}s!==null&&zm(a,s,o,c),a.flags|=262144}function ad(s){for(s=s.firstContext;s!==null;){if(!Hr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ao(s){Ro=s,ti=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ar(s){return Sb(Ro,s)}function id(s,a){return Ro===null&&Ao(s),Sb(s,a)}function Sb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},ti===null){if(s===null)throw Error(i(308));ti=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else ti=ti.next=a;return o}var lj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},cj=n.unstable_scheduleCallback,uj=n.unstable_NormalPriority,Pn={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qm(){return{controller:new lj,data:new Map,refCount:0}}function _c(s){s.refCount--,s.refCount===0&&cj(uj,function(){s.controller.abort()})}var kc=null,Hm=0,bl=0,vl=null;function dj(s,a){if(kc===null){var o=kc=[];Hm=0,bl=Kf(),vl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Hm++,a.then(Nb,Nb),a}function Nb(){if(--Hm===0&&kc!==null){vl!==null&&(vl.status="fulfilled");var s=kc;kc=null,bl=0,vl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function hj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Cb=q.S;q.S=function(s,a){h0=Ft(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&dj(s,a),Cb!==null&&Cb(s,a)};var Io=P(null);function $m(){var s=Io.current;return s!==null?s:en.pooledCache}function od(s,a){a===null?Pe(Io,Io.current):Pe(Io,a.pool)}function Rb(){var s=$m();return s===null?null:{parent:Pn._currentValue,pool:s}}var xl=Error(i(460)),Wm=Error(i(474)),ld=Error(i(542)),cd={then:function(){}};function Ab(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ib(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Zt,Zt),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s;default:if(typeof a.status=="string")a.then(Zt,Zt);else{if(s=en,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s}throw Do=a,xl}}function Mo(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Do=o,xl):o}}var Do=null;function Mb(){if(Do===null)throw Error(i(459));var s=Do;return Do=null,s}function Db(s){if(s===xl||s===ld)throw Error(i(483))}var wl=null,jc=0;function ud(s){var a=jc;return jc+=1,wl===null&&(wl=[]),Ib(wl,s,a)}function Tc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function dd(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Pb(s){function a(Z,H){if(s){var le=Z.deletions;le===null?(Z.deletions=[H],Z.flags|=16):le.push(H)}}function o(Z,H){if(!s)return null;for(;H!==null;)a(Z,H),H=H.sibling;return null}function c(Z){for(var H=new Map;Z!==null;)Z.key!==null?H.set(Z.key,Z):H.set(Z.index,Z),Z=Z.sibling;return H}function m(Z,H){return Z=Za(Z,H),Z.index=0,Z.sibling=null,Z}function f(Z,H,le){return Z.index=le,s?(le=Z.alternate,le!==null?(le=le.index,le<H?(Z.flags|=67108866,H):le):(Z.flags|=67108866,H)):(Z.flags|=1048576,H)}function w(Z){return s&&Z.alternate===null&&(Z.flags|=67108866),Z}function S(Z,H,le,Ie){return H===null||H.tag!==6?(H=Dm(le,Z.mode,Ie),H.return=Z,H):(H=m(H,le),H.return=Z,H)}function F(Z,H,le,Ie){var Mt=le.type;return Mt===V?Ee(Z,H,le.props.children,Ie,le.key):H!==null&&(H.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===T&&Mo(Mt)===H.type)?(H=m(H,le.props),Tc(H,le),H.return=Z,H):(H=nd(le.type,le.key,le.props,null,Z.mode,Ie),Tc(H,le),H.return=Z,H)}function ce(Z,H,le,Ie){return H===null||H.tag!==4||H.stateNode.containerInfo!==le.containerInfo||H.stateNode.implementation!==le.implementation?(H=Pm(le,Z.mode,Ie),H.return=Z,H):(H=m(H,le.children||[]),H.return=Z,H)}function Ee(Z,H,le,Ie,Mt){return H===null||H.tag!==7?(H=No(le,Z.mode,Ie,Mt),H.return=Z,H):(H=m(H,le),H.return=Z,H)}function Oe(Z,H,le){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Dm(""+H,Z.mode,le),H.return=Z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case B:return le=nd(H.type,H.key,H.props,null,Z.mode,le),Tc(le,H),le.return=Z,le;case W:return H=Pm(H,Z.mode,le),H.return=Z,H;case T:return H=Mo(H),Oe(Z,H,le)}if(bt(H)||z(H))return H=No(H,Z.mode,le,null),H.return=Z,H;if(typeof H.then=="function")return Oe(Z,ud(H),le);if(H.$$typeof===te)return Oe(Z,id(Z,H),le);dd(Z,H)}return null}function he(Z,H,le,Ie){var Mt=H!==null?H.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Mt!==null?null:S(Z,H,""+le,Ie);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case B:return le.key===Mt?F(Z,H,le,Ie):null;case W:return le.key===Mt?ce(Z,H,le,Ie):null;case T:return le=Mo(le),he(Z,H,le,Ie)}if(bt(le)||z(le))return Mt!==null?null:Ee(Z,H,le,Ie,null);if(typeof le.then=="function")return he(Z,H,ud(le),Ie);if(le.$$typeof===te)return he(Z,H,id(Z,le),Ie);dd(Z,le)}return null}function ve(Z,H,le,Ie,Mt){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Z=Z.get(le)||null,S(H,Z,""+Ie,Mt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case B:return Z=Z.get(Ie.key===null?le:Ie.key)||null,F(H,Z,Ie,Mt);case W:return Z=Z.get(Ie.key===null?le:Ie.key)||null,ce(H,Z,Ie,Mt);case T:return Ie=Mo(Ie),ve(Z,H,le,Ie,Mt)}if(bt(Ie)||z(Ie))return Z=Z.get(le)||null,Ee(H,Z,Ie,Mt,null);if(typeof Ie.then=="function")return ve(Z,H,le,ud(Ie),Mt);if(Ie.$$typeof===te)return ve(Z,H,le,id(H,Ie),Mt);dd(H,Ie)}return null}function jt(Z,H,le,Ie){for(var Mt=null,Vs=null,Nt=H,ds=H=0,ws=null;Nt!==null&&ds<le.length;ds++){Nt.index>ds?(ws=Nt,Nt=null):ws=Nt.sibling;var Us=he(Z,Nt,le[ds],Ie);if(Us===null){Nt===null&&(Nt=ws);break}s&&Nt&&Us.alternate===null&&a(Z,Nt),H=f(Us,H,ds),Vs===null?Mt=Us:Vs.sibling=Us,Vs=Us,Nt=ws}if(ds===le.length)return o(Z,Nt),Ns&&ei(Z,ds),Mt;if(Nt===null){for(;ds<le.length;ds++)Nt=Oe(Z,le[ds],Ie),Nt!==null&&(H=f(Nt,H,ds),Vs===null?Mt=Nt:Vs.sibling=Nt,Vs=Nt);return Ns&&ei(Z,ds),Mt}for(Nt=c(Nt);ds<le.length;ds++)ws=ve(Nt,Z,ds,le[ds],Ie),ws!==null&&(s&&ws.alternate!==null&&Nt.delete(ws.key===null?ds:ws.key),H=f(ws,H,ds),Vs===null?Mt=ws:Vs.sibling=ws,Vs=ws);return s&&Nt.forEach(function(Ki){return a(Z,Ki)}),Ns&&ei(Z,ds),Mt}function Ut(Z,H,le,Ie){if(le==null)throw Error(i(151));for(var Mt=null,Vs=null,Nt=H,ds=H=0,ws=null,Us=le.next();Nt!==null&&!Us.done;ds++,Us=le.next()){Nt.index>ds?(ws=Nt,Nt=null):ws=Nt.sibling;var Ki=he(Z,Nt,Us.value,Ie);if(Ki===null){Nt===null&&(Nt=ws);break}s&&Nt&&Ki.alternate===null&&a(Z,Nt),H=f(Ki,H,ds),Vs===null?Mt=Ki:Vs.sibling=Ki,Vs=Ki,Nt=ws}if(Us.done)return o(Z,Nt),Ns&&ei(Z,ds),Mt;if(Nt===null){for(;!Us.done;ds++,Us=le.next())Us=Oe(Z,Us.value,Ie),Us!==null&&(H=f(Us,H,ds),Vs===null?Mt=Us:Vs.sibling=Us,Vs=Us);return Ns&&ei(Z,ds),Mt}for(Nt=c(Nt);!Us.done;ds++,Us=le.next())Us=ve(Nt,Z,ds,Us.value,Ie),Us!==null&&(s&&Us.alternate!==null&&Nt.delete(Us.key===null?ds:Us.key),H=f(Us,H,ds),Vs===null?Mt=Us:Vs.sibling=Us,Vs=Us);return s&&Nt.forEach(function(kT){return a(Z,kT)}),Ns&&ei(Z,ds),Mt}function Js(Z,H,le,Ie){if(typeof le=="object"&&le!==null&&le.type===V&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case B:e:{for(var Mt=le.key;H!==null;){if(H.key===Mt){if(Mt=le.type,Mt===V){if(H.tag===7){o(Z,H.sibling),Ie=m(H,le.props.children),Ie.return=Z,Z=Ie;break e}}else if(H.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===T&&Mo(Mt)===H.type){o(Z,H.sibling),Ie=m(H,le.props),Tc(Ie,le),Ie.return=Z,Z=Ie;break e}o(Z,H);break}else a(Z,H);H=H.sibling}le.type===V?(Ie=No(le.props.children,Z.mode,Ie,le.key),Ie.return=Z,Z=Ie):(Ie=nd(le.type,le.key,le.props,null,Z.mode,Ie),Tc(Ie,le),Ie.return=Z,Z=Ie)}return w(Z);case W:e:{for(Mt=le.key;H!==null;){if(H.key===Mt)if(H.tag===4&&H.stateNode.containerInfo===le.containerInfo&&H.stateNode.implementation===le.implementation){o(Z,H.sibling),Ie=m(H,le.children||[]),Ie.return=Z,Z=Ie;break e}else{o(Z,H);break}else a(Z,H);H=H.sibling}Ie=Pm(le,Z.mode,Ie),Ie.return=Z,Z=Ie}return w(Z);case T:return le=Mo(le),Js(Z,H,le,Ie)}if(bt(le))return jt(Z,H,le,Ie);if(z(le)){if(Mt=z(le),typeof Mt!="function")throw Error(i(150));return le=Mt.call(le),Ut(Z,H,le,Ie)}if(typeof le.then=="function")return Js(Z,H,ud(le),Ie);if(le.$$typeof===te)return Js(Z,H,id(Z,le),Ie);dd(Z,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,H!==null&&H.tag===6?(o(Z,H.sibling),Ie=m(H,le),Ie.return=Z,Z=Ie):(o(Z,H),Ie=Dm(le,Z.mode,Ie),Ie.return=Z,Z=Ie),w(Z)):o(Z,H)}return function(Z,H,le,Ie){try{jc=0;var Mt=Js(Z,H,le,Ie);return wl=null,Mt}catch(Nt){if(Nt===xl||Nt===ld)throw Nt;var Vs=$r(29,Nt,null,Z.mode);return Vs.lanes=Ie,Vs.return=Z,Vs}}}var Po=Pb(!0),Lb=Pb(!1),Ai=!1;function Gm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Km(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ii(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Mi(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Hs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=sd(s),vb(s,null,o),a}return td(s,c,a,o),sd(s)}function Ec(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Xt(s,o)}}function Ym(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Qm=!1;function Sc(){if(Qm){var s=vl;if(s!==null)throw s}}function Nc(s,a,o,c){Qm=!1;var m=s.updateQueue;Ai=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var F=S,ce=F.next;F.next=null,w===null?f=ce:w.next=ce,w=F;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,S=Ee.lastBaseUpdate,S!==w&&(S===null?Ee.firstBaseUpdate=ce:S.next=ce,Ee.lastBaseUpdate=F))}if(f!==null){var Oe=m.baseState;w=0,Ee=ce=F=null,S=f;do{var he=S.lane&-536870913,ve=he!==S.lane;if(ve?(xs&he)===he:(c&he)===he){he!==0&&he===bl&&(Qm=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var jt=s,Ut=S;he=a;var Js=o;switch(Ut.tag){case 1:if(jt=Ut.payload,typeof jt=="function"){Oe=jt.call(Js,Oe,he);break e}Oe=jt;break e;case 3:jt.flags=jt.flags&-65537|128;case 0:if(jt=Ut.payload,he=typeof jt=="function"?jt.call(Js,Oe,he):jt,he==null)break e;Oe=k({},Oe,he);break e;case 2:Ai=!0}}he=S.callback,he!==null&&(s.flags|=64,ve&&(s.flags|=8192),ve=m.callbacks,ve===null?m.callbacks=[he]:ve.push(he))}else ve={lane:he,tag:S.tag,payload:S.payload,callback:S.callback,next:null},Ee===null?(ce=Ee=ve,F=Oe):Ee=Ee.next=ve,w|=he;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ve=S,S=ve.next,ve.next=null,m.lastBaseUpdate=ve,m.shared.pending=null}}while(!0);Ee===null&&(F=Oe),m.baseState=F,m.firstBaseUpdate=ce,m.lastBaseUpdate=Ee,f===null&&(m.shared.lanes=0),Bi|=w,s.lanes=w,s.memoizedState=Oe}}function Ob(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Bb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ob(o[s],a)}var _l=P(null),hd=P(0);function Vb(s,a){s=di,Pe(hd,s),Pe(_l,a),di=s|a.baseLanes}function Xm(){Pe(hd,di),Pe(_l,_l.current)}function Jm(){di=hd.current,re(_l),re(hd)}var Wr=P(null),la=null;function Di(s){var a=s.alternate;Pe(Rn,Rn.current&1),Pe(Wr,s),la===null&&(a===null||_l.current!==null||a.memoizedState!==null)&&(la=s)}function Zm(s){Pe(Rn,Rn.current),Pe(Wr,s),la===null&&(la=s)}function Ub(s){s.tag===22?(Pe(Rn,Rn.current),Pe(Wr,s),la===null&&(la=s)):Pi()}function Pi(){Pe(Rn,Rn.current),Pe(Wr,Wr.current)}function Gr(s){re(Wr),la===s&&(la=null),re(Rn)}var Rn=P(0);function md(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ip(o)||op(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ni=0,us=null,Qs=null,Ln=null,fd=!1,kl=!1,Lo=!1,pd=0,Cc=0,jl=null,mj=0;function kn(){throw Error(i(321))}function ef(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Hr(s[o],a[o]))return!1;return!0}function tf(s,a,o,c,m,f){return ni=f,us=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,q.H=s===null||s.memoizedState===null?kv:yf,Lo=!1,f=o(c,m),Lo=!1,kl&&(f=zb(a,o,c,m)),Fb(s),f}function Fb(s){q.H=Ic;var a=Qs!==null&&Qs.next!==null;if(ni=0,Ln=Qs=us=null,fd=!1,Cc=0,jl=null,a)throw Error(i(300));s===null||On||(s=s.dependencies,s!==null&&ad(s)&&(On=!0))}function zb(s,a,o,c){us=s;var m=0;do{if(kl&&(jl=null),Cc=0,kl=!1,25<=m)throw Error(i(301));if(m+=1,Ln=Qs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}q.H=jv,f=a(o,c)}while(kl);return f}function fj(){var s=q.H,a=s.useState()[0];return a=typeof a.then=="function"?Rc(a):a,s=s.useState()[0],(Qs!==null?Qs.memoizedState:null)!==s&&(us.flags|=1024),a}function sf(){var s=pd!==0;return pd=0,s}function nf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function rf(s){if(fd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}fd=!1}ni=0,Ln=Qs=us=null,kl=!1,Cc=pd=0,jl=null}function kr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?us.memoizedState=Ln=s:Ln=Ln.next=s,Ln}function An(){if(Qs===null){var s=us.alternate;s=s!==null?s.memoizedState:null}else s=Qs.next;var a=Ln===null?us.memoizedState:Ln.next;if(a!==null)Ln=a,Qs=s;else{if(s===null)throw us.alternate===null?Error(i(467)):Error(i(310));Qs=s,s={memoizedState:Qs.memoizedState,baseState:Qs.baseState,baseQueue:Qs.baseQueue,queue:Qs.queue,next:null},Ln===null?us.memoizedState=Ln=s:Ln=Ln.next=s}return Ln}function gd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rc(s){var a=Cc;return Cc+=1,jl===null&&(jl=[]),s=Ib(jl,s,a),a=us,(Ln===null?a.memoizedState:Ln.next)===null&&(a=a.alternate,q.H=a===null||a.memoizedState===null?kv:yf),s}function yd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Rc(s);if(s.$$typeof===te)return ar(s)}throw Error(i(438,String(s)))}function af(s){var a=null,o=us.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=us.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=gd(),us.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=O;return a.index++,o}function ri(s,a){return typeof a=="function"?a(s):a}function bd(s){var a=An();return of(a,Qs,s)}function of(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=w=null,F=null,ce=a,Ee=!1;do{var Oe=ce.lane&-536870913;if(Oe!==ce.lane?(xs&Oe)===Oe:(ni&Oe)===Oe){var he=ce.revertLane;if(he===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),Oe===bl&&(Ee=!0);else if((ni&he)===he){ce=ce.next,he===bl&&(Ee=!0);continue}else Oe={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},F===null?(S=F=Oe,w=f):F=F.next=Oe,us.lanes|=he,Bi|=he;Oe=ce.action,Lo&&o(f,Oe),f=ce.hasEagerState?ce.eagerState:o(f,Oe)}else he={lane:Oe,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},F===null?(S=F=he,w=f):F=F.next=he,us.lanes|=Oe,Bi|=Oe;ce=ce.next}while(ce!==null&&ce!==a);if(F===null?w=f:F.next=S,!Hr(f,s.memoizedState)&&(On=!0,Ee&&(o=vl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=F,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function lf(s){var a=An(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);Hr(f,a.memoizedState)||(On=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function qb(s,a,o){var c=us,m=An(),f=Ns;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!Hr((Qs||m).memoizedState,o);if(w&&(m.memoizedState=o,On=!0),m=m.queue,df(Wb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Ln!==null&&Ln.memoizedState.tag&1){if(c.flags|=2048,Tl(9,{destroy:void 0},$b.bind(null,c,m,o,a),null),en===null)throw Error(i(349));f||(ni&127)!==0||Hb(c,a,o)}return o}function Hb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=us.updateQueue,a===null?(a=gd(),us.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function $b(s,a,o,c){a.value=o,a.getSnapshot=c,Gb(a)&&Kb(s)}function Wb(s,a,o){return o(function(){Gb(a)&&Kb(s)})}function Gb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Hr(s,o)}catch{return!0}}function Kb(s){var a=So(s,2);a!==null&&Vr(a,s,2)}function cf(s){var a=kr();if(typeof s=="function"){var o=s;if(s=o(),Lo){Se(!0);try{o()}finally{Se(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:s},a}function Yb(s,a,o,c){return s.baseState=o,of(s,Qs,typeof c=="function"?c:ri)}function pj(s,a,o,c,m){if(wd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};q.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Qb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Qb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=q.T,w={};q.T=w;try{var S=o(m,c),F=q.S;F!==null&&F(w,S),Xb(s,a,S)}catch(ce){uf(s,a,ce)}finally{f!==null&&w.types!==null&&(f.types=w.types),q.T=f}}else try{f=o(m,c),Xb(s,a,f)}catch(ce){uf(s,a,ce)}}function Xb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Jb(s,a,c)},function(c){return uf(s,a,c)}):Jb(s,a,o)}function Jb(s,a,o){a.status="fulfilled",a.value=o,Zb(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Qb(s,o)))}function uf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,Zb(a),a=a.next;while(a!==c)}s.action=null}function Zb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function ev(s,a){return a}function tv(s,a){if(Ns){var o=en.formState;if(o!==null){e:{var c=us;if(Ns){if(un){t:{for(var m=un,f=oa;m.nodeType!==8;){if(!f){m=null;break t}if(m=ca(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){un=ca(m.nextSibling),c=m.data==="F!";break e}}Ci(c)}c=!1}c&&(a=o[0])}}return o=kr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ev,lastRenderedState:a},o.queue=c,o=xv.bind(null,us,c),c.dispatch=o,c=cf(!1),f=gf.bind(null,us,!1,c.queue),c=kr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=pj.bind(null,us,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function sv(s){var a=An();return nv(a,Qs,s)}function nv(s,a,o){if(a=of(s,a,ev)[0],s=bd(ri)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Rc(a)}catch(w){throw w===xl?ld:w}else c=a;a=An();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(us.flags|=2048,Tl(9,{destroy:void 0},gj.bind(null,m,o),null)),[c,f,s]}function gj(s,a){s.action=a}function rv(s){var a=An(),o=Qs;if(o!==null)return nv(a,o,s);An(),a=a.memoizedState,o=An();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function Tl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=us.updateQueue,a===null&&(a=gd(),us.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function av(){return An().memoizedState}function vd(s,a,o,c){var m=kr();us.flags|=s,m.memoizedState=Tl(1|a,{destroy:void 0},o,c===void 0?null:c)}function xd(s,a,o,c){var m=An();c=c===void 0?null:c;var f=m.memoizedState.inst;Qs!==null&&c!==null&&ef(c,Qs.memoizedState.deps)?m.memoizedState=Tl(a,f,o,c):(us.flags|=s,m.memoizedState=Tl(1|a,f,o,c))}function iv(s,a){vd(8390656,8,s,a)}function df(s,a){xd(2048,8,s,a)}function yj(s){us.flags|=4;var a=us.updateQueue;if(a===null)a=gd(),us.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function ov(s){var a=An().memoizedState;return yj({ref:a,nextImpl:s}),function(){if((Hs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function lv(s,a){return xd(4,2,s,a)}function cv(s,a){return xd(4,4,s,a)}function uv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function dv(s,a,o){o=o!=null?o.concat([s]):null,xd(4,4,uv.bind(null,a,s),o)}function hf(){}function hv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&ef(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function mv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&ef(a,c[1]))return c[0];if(c=s(),Lo){Se(!0);try{s()}finally{Se(!1)}}return o.memoizedState=[c,a],c}function mf(s,a,o){return o===void 0||(ni&1073741824)!==0&&(xs&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=f0(),us.lanes|=s,Bi|=s,o)}function fv(s,a,o,c){return Hr(o,a)?o:_l.current!==null?(s=mf(s,o,c),Hr(s,a)||(On=!0),s):(ni&42)===0||(ni&1073741824)!==0&&(xs&261930)===0?(On=!0,s.memoizedState=o):(s=f0(),us.lanes|=s,Bi|=s,a)}function pv(s,a,o,c,m){var f=me.p;me.p=f!==0&&8>f?f:8;var w=q.T,S={};q.T=S,gf(s,!1,a,o);try{var F=m(),ce=q.S;if(ce!==null&&ce(S,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var Ee=hj(F,c);Ac(s,a,Ee,Qr(s))}else Ac(s,a,c,Qr(s))}catch(Oe){Ac(s,a,{then:function(){},status:"rejected",reason:Oe},Qr())}finally{me.p=f,w!==null&&S.types!==null&&(w.types=S.types),q.T=w}}function bj(){}function ff(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=gv(s).queue;pv(s,m,a,Me,o===null?bj:function(){return yv(s),o(c)})}function gv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:Me},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function yv(s){var a=gv(s);a.next===null&&(a=s.alternate.memoizedState),Ac(s,a.next.queue,{},Qr())}function pf(){return ar(Kc)}function bv(){return An().memoizedState}function vv(){return An().memoizedState}function vj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Qr();s=Ii(o);var c=Mi(a,s,o);c!==null&&(Vr(c,a,o),Ec(c,a,o)),a={cache:qm()},s.payload=a;return}a=a.return}}function xj(s,a,o){var c=Qr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},wd(s)?wv(a,o):(o=Im(s,a,o,c),o!==null&&(Vr(o,s,c),_v(o,a,c)))}function xv(s,a,o){var c=Qr();Ac(s,a,o,c)}function Ac(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(wd(s))wv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,S=f(w,o);if(m.hasEagerState=!0,m.eagerState=S,Hr(S,w))return td(s,a,m,0),en===null&&ed(),!1}catch{}if(o=Im(s,a,m,c),o!==null)return Vr(o,s,c),_v(o,a,c),!0}return!1}function gf(s,a,o,c){if(c={lane:2,revertLane:Kf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},wd(s)){if(a)throw Error(i(479))}else a=Im(s,o,c,2),a!==null&&Vr(a,s,2)}function wd(s){var a=s.alternate;return s===us||a!==null&&a===us}function wv(s,a){kl=fd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function _v(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Xt(s,o)}}var Ic={readContext:ar,use:yd,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useLayoutEffect:kn,useInsertionEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useSyncExternalStore:kn,useId:kn,useHostTransitionStatus:kn,useFormState:kn,useActionState:kn,useOptimistic:kn,useMemoCache:kn,useCacheRefresh:kn};Ic.useEffectEvent=kn;var kv={readContext:ar,use:yd,useCallback:function(s,a){return kr().memoizedState=[s,a===void 0?null:a],s},useContext:ar,useEffect:iv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,vd(4194308,4,uv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return vd(4194308,4,s,a)},useInsertionEffect:function(s,a){vd(4,2,s,a)},useMemo:function(s,a){var o=kr();a=a===void 0?null:a;var c=s();if(Lo){Se(!0);try{s()}finally{Se(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=kr();if(o!==void 0){var m=o(a);if(Lo){Se(!0);try{o(a)}finally{Se(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=xj.bind(null,us,s),[c.memoizedState,s]},useRef:function(s){var a=kr();return s={current:s},a.memoizedState=s},useState:function(s){s=cf(s);var a=s.queue,o=xv.bind(null,us,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:hf,useDeferredValue:function(s,a){var o=kr();return mf(o,s,a)},useTransition:function(){var s=cf(!1);return s=pv.bind(null,us,s.queue,!0,!1),kr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=us,m=kr();if(Ns){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),en===null)throw Error(i(349));(xs&127)!==0||Hb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,iv(Wb.bind(null,c,f,s),[s]),c.flags|=2048,Tl(9,{destroy:void 0},$b.bind(null,c,f,o,a),null),o},useId:function(){var s=kr(),a=en.identifierPrefix;if(Ns){var o=La,c=Pa;o=(c&~(1<<32-Le(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=pd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=mj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:pf,useFormState:tv,useActionState:tv,useOptimistic:function(s){var a=kr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=gf.bind(null,us,!0,o),o.dispatch=a,[s,a]},useMemoCache:af,useCacheRefresh:function(){return kr().memoizedState=vj.bind(null,us)},useEffectEvent:function(s){var a=kr(),o={impl:s};return a.memoizedState=o,function(){if((Hs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},yf={readContext:ar,use:yd,useCallback:hv,useContext:ar,useEffect:df,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:bd,useRef:av,useState:function(){return bd(ri)},useDebugValue:hf,useDeferredValue:function(s,a){var o=An();return fv(o,Qs.memoizedState,s,a)},useTransition:function(){var s=bd(ri)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Rc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:pf,useFormState:sv,useActionState:sv,useOptimistic:function(s,a){var o=An();return Yb(o,Qs,s,a)},useMemoCache:af,useCacheRefresh:vv};yf.useEffectEvent=ov;var jv={readContext:ar,use:yd,useCallback:hv,useContext:ar,useEffect:df,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:lf,useRef:av,useState:function(){return lf(ri)},useDebugValue:hf,useDeferredValue:function(s,a){var o=An();return Qs===null?mf(o,s,a):fv(o,Qs.memoizedState,s,a)},useTransition:function(){var s=lf(ri)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Rc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:pf,useFormState:rv,useActionState:rv,useOptimistic:function(s,a){var o=An();return Qs!==null?Yb(o,Qs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:af,useCacheRefresh:vv};jv.useEffectEvent=ov;function bf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:k({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var vf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Qr(),m=Ii(c);m.payload=a,o!=null&&(m.callback=o),a=Mi(s,m,c),a!==null&&(Vr(a,s,c),Ec(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Qr(),m=Ii(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Mi(s,m,c),a!==null&&(Vr(a,s,c),Ec(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Qr(),c=Ii(o);c.tag=2,a!=null&&(c.callback=a),a=Mi(s,c,o),a!==null&&(Vr(a,s,o),Ec(a,s,o))}};function Tv(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!bc(o,c)||!bc(m,f):!0}function Ev(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&vf.enqueueReplaceState(a,a.state,null)}function Oo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=k({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Sv(s){Zu(s)}function Nv(s){console.error(s)}function Cv(s){Zu(s)}function _d(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Rv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function xf(s,a,o){return o=Ii(o),o.tag=3,o.payload={element:null},o.callback=function(){_d(s,a)},o}function Av(s){return s=Ii(s),s.tag=3,s}function Iv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Rv(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Rv(a,o,c),typeof m!="function"&&(Vi===null?Vi=new Set([this]):Vi.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function wj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&yl(a,o,m,!0),o=Wr.current,o!==null){switch(o.tag){case 31:case 13:return la===null?Dd():o.alternate===null&&jn===0&&(jn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===cd?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),$f(s,c,m)),!1;case 22:return o.flags|=65536,c===cd?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),$f(s,c,m)),!1}throw Error(i(435,o.tag))}return $f(s,c,m),Dd(),!1}if(Ns)return a=Wr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Bm&&(s=Error(i(422),{cause:c}),wc(ra(s,o)))):(c!==Bm&&(a=Error(i(423),{cause:c}),wc(ra(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=ra(c,o),m=xf(s.stateNode,c,m),Ym(s,m),jn!==4&&(jn=2)),!1;var f=Error(i(520),{cause:c});if(f=ra(f,o),Uc===null?Uc=[f]:Uc.push(f),jn!==4&&(jn=2),a===null)return!0;c=ra(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=xf(o.stateNode,c,s),Ym(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Vi===null||!Vi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Av(m),Iv(m,s,o,c),Ym(o,m),!1}o=o.return}while(o!==null);return!1}var wf=Error(i(461)),On=!1;function ir(s,a,o,c){a.child=s===null?Lb(a,null,o,c):Po(a,s.child,o,c)}function Mv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var S in c)S!=="ref"&&(w[S]=c[S])}else w=c;return Ao(a),c=tf(s,a,o,w,f,m),S=sf(),s!==null&&!On?(nf(s,a,m),ai(s,a,m)):(Ns&&S&&Lm(a),a.flags|=1,ir(s,a,c,m),a.child)}function Dv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Mm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Pv(s,a,f,c,m)):(s=nd(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Cf(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:bc,o(w,c)&&s.ref===a.ref)return ai(s,a,m)}return a.flags|=1,s=Za(f,c),s.ref=a.ref,s.return=a,a.child=s}function Pv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(bc(f,c)&&s.ref===a.ref)if(On=!1,a.pendingProps=c=f,Cf(s,m))(s.flags&131072)!==0&&(On=!0);else return a.lanes=s.lanes,ai(s,a,m)}return _f(s,a,o,c,m)}function Lv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Ov(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&od(a,f!==null?f.cachePool:null),f!==null?Vb(a,f):Xm(),Ub(a);else return c=a.lanes=536870912,Ov(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(od(a,f.cachePool),Vb(a,f),Pi(),a.memoizedState=null):(s!==null&&od(a,null),Xm(),Pi());return ir(s,a,m,o),a.child}function Mc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ov(s,a,o,c,m){var f=$m();return f=f===null?null:{parent:Pn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&od(a,null),Xm(),Ub(a),s!==null&&yl(s,a,c,!0),a.childLanes=m,null}function kd(s,a){return a=Td({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Bv(s,a,o){return Po(a,s.child,null,o),s=kd(a,a.pendingProps),s.flags|=2,Gr(a),a.memoizedState=null,s}function _j(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Ns){if(c.mode==="hidden")return s=kd(a,c),a.lanes=536870912,Mc(null,s);if(Zm(a),(s=un)?(s=Q0(s,oa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Si!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,rr=a,un=null)):s=null,s===null)throw Ci(a);return a.lanes=536870912,null}return kd(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(Zm(a),m)if(a.flags&256)a.flags&=-257,a=Bv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(On||yl(s,a,o,!1),m=(o&s.childLanes)!==0,On||m){if(c=en,c!==null&&(w=Bt(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,So(s,w),Vr(c,s,w),wf;Dd(),a=Bv(s,a,o)}else s=f.treeContext,un=ca(w.nextSibling),rr=a,Ns=!0,Ni=null,oa=!1,s!==null&&jb(a,s),a=kd(a,c),a.flags|=4096;return a}return s=Za(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function jd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function _f(s,a,o,c,m){return Ao(a),o=tf(s,a,o,c,void 0,m),c=sf(),s!==null&&!On?(nf(s,a,m),ai(s,a,m)):(Ns&&c&&Lm(a),a.flags|=1,ir(s,a,o,m),a.child)}function Vv(s,a,o,c,m,f){return Ao(a),a.updateQueue=null,o=zb(a,c,o,m),Fb(s),c=sf(),s!==null&&!On?(nf(s,a,f),ai(s,a,f)):(Ns&&c&&Lm(a),a.flags|=1,ir(s,a,o,f),a.child)}function Uv(s,a,o,c,m){if(Ao(a),a.stateNode===null){var f=ml,w=o.contextType;typeof w=="object"&&w!==null&&(f=ar(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=vf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Gm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?ar(w):ml,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(bf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&vf.enqueueReplaceState(f,f.state,null),Nc(a,c,f,m),Sc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,F=Oo(o,S);f.props=F;var ce=f.context,Ee=o.contextType;w=ml,typeof Ee=="object"&&Ee!==null&&(w=ar(Ee));var Oe=o.getDerivedStateFromProps;Ee=typeof Oe=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,Ee||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||ce!==w)&&Ev(a,f,c,w),Ai=!1;var he=a.memoizedState;f.state=he,Nc(a,c,f,m),Sc(),ce=a.memoizedState,S||he!==ce||Ai?(typeof Oe=="function"&&(bf(a,o,Oe,c),ce=a.memoizedState),(F=Ai||Tv(a,o,F,c,he,ce,w))?(Ee||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ce),f.props=c,f.state=ce,f.context=w,c=F):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Km(s,a),w=a.memoizedProps,Ee=Oo(o,w),f.props=Ee,Oe=a.pendingProps,he=f.context,ce=o.contextType,F=ml,typeof ce=="object"&&ce!==null&&(F=ar(ce)),S=o.getDerivedStateFromProps,(ce=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==Oe||he!==F)&&Ev(a,f,c,F),Ai=!1,he=a.memoizedState,f.state=he,Nc(a,c,f,m),Sc();var ve=a.memoizedState;w!==Oe||he!==ve||Ai||s!==null&&s.dependencies!==null&&ad(s.dependencies)?(typeof S=="function"&&(bf(a,o,S,c),ve=a.memoizedState),(Ee=Ai||Tv(a,o,Ee,c,he,ve,F)||s!==null&&s.dependencies!==null&&ad(s.dependencies))?(ce||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,ve,F),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,ve,F)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&he===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&he===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ve),f.props=c,f.state=ve,f.context=F,c=Ee):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&he===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&he===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,jd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Po(a,s.child,null,m),a.child=Po(a,null,o,m)):ir(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ai(s,a,m),s}function Fv(s,a,o,c){return Co(),a.flags|=256,ir(s,a,o,c),a.child}var kf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jf(s){return{baseLanes:s,cachePool:Rb()}}function Tf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Yr),s}function zv(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(Ns){if(m?Di(a):Pi(),(s=un)?(s=Q0(s,oa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Si!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,rr=a,un=null)):s=null,s===null)throw Ci(a);return op(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Pi(),m=a.mode,S=Td({mode:"hidden",children:S},m),c=No(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=jf(o),c.childLanes=Tf(s,w,o),a.memoizedState=kf,Mc(null,c)):(Di(a),Ef(a,S))}var F=s.memoizedState;if(F!==null&&(S=F.dehydrated,S!==null)){if(f)a.flags&256?(Di(a),a.flags&=-257,a=Sf(s,a,o)):a.memoizedState!==null?(Pi(),a.child=s.child,a.flags|=128,a=null):(Pi(),S=c.fallback,m=a.mode,c=Td({mode:"visible",children:c.children},m),S=No(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Po(a,s.child,null,o),c=a.child,c.memoizedState=jf(o),c.childLanes=Tf(s,w,o),a.memoizedState=kf,a=Mc(null,c));else if(Di(a),op(S)){if(w=S.nextSibling&&S.nextSibling.dataset,w)var ce=w.dgst;w=ce,c=Error(i(419)),c.stack="",c.digest=w,wc({value:c,source:null,stack:null}),a=Sf(s,a,o)}else if(On||yl(s,a,o,!1),w=(o&s.childLanes)!==0,On||w){if(w=en,w!==null&&(c=Bt(w,o),c!==0&&c!==F.retryLane))throw F.retryLane=c,So(s,c),Vr(w,s,c),wf;ip(S)||Dd(),a=Sf(s,a,o)}else ip(S)?(a.flags|=192,a.child=s.child,a=null):(s=F.treeContext,un=ca(S.nextSibling),rr=a,Ns=!0,Ni=null,oa=!1,s!==null&&jb(a,s),a=Ef(a,c.children),a.flags|=4096);return a}return m?(Pi(),S=c.fallback,m=a.mode,F=s.child,ce=F.sibling,c=Za(F,{mode:"hidden",children:c.children}),c.subtreeFlags=F.subtreeFlags&65011712,ce!==null?S=Za(ce,S):(S=No(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Mc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=jf(o):(m=S.cachePool,m!==null?(F=Pn._currentValue,m=m.parent!==F?{parent:F,pool:F}:m):m=Rb(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=Tf(s,w,o),a.memoizedState=kf,Mc(s.child,c)):(Di(a),o=s.child,s=o.sibling,o=Za(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Ef(s,a){return a=Td({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Td(s,a){return s=$r(22,s,null,a),s.lanes=0,s}function Sf(s,a,o){return Po(a,s.child,null,o),s=Ef(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function qv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Fm(s.return,a,o)}function Nf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function Hv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Rn.current,S=(w&2)!==0;if(S?(w=w&1|2,a.flags|=128):w&=1,Pe(Rn,w),ir(s,a,c,o),c=Ns?xc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&qv(s,o,a);else if(s.tag===19)qv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&md(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Nf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&md(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Nf(a,!0,o,null,f,c);break;case"together":Nf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ai(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Bi|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(yl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Za(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Za(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Cf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ad(s)))}function kj(s,a,o){switch(a.tag){case 3:ft(a,a.stateNode.containerInfo),Ri(a,Pn,s.memoizedState.cache),Co();break;case 27:case 5:Yt(a);break;case 4:ft(a,a.stateNode.containerInfo);break;case 10:Ri(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Zm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Di(a),a.flags|=128,null):(o&a.child.childLanes)!==0?zv(s,a,o):(Di(a),s=ai(s,a,o),s!==null?s.sibling:null);Di(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(yl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Hv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Pe(Rn,Rn.current),c)break;return null;case 22:return a.lanes=0,Lv(s,a,o,a.pendingProps);case 24:Ri(a,Pn,s.memoizedState.cache)}return ai(s,a,o)}function $v(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)On=!0;else{if(!Cf(s,o)&&(a.flags&128)===0)return On=!1,kj(s,a,o);On=(s.flags&131072)!==0}else On=!1,Ns&&(a.flags&1048576)!==0&&kb(a,xc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Mo(a.elementType),a.type=s,typeof s=="function")Mm(s)?(c=Oo(s,c),a.tag=1,a=Uv(null,a,s,c,o)):(a.tag=0,a=_f(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===we){a.tag=11,a=Mv(null,a,s,c,o);break e}else if(m===C){a.tag=14,a=Dv(null,a,s,c,o);break e}}throw a=We(s)||s,Error(i(306,a,""))}}return a;case 0:return _f(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Oo(c,a.pendingProps),Uv(s,a,c,m,o);case 3:e:{if(ft(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Km(s,a),Nc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Ri(a,Pn,c),c!==f.cache&&zm(a,[Pn],o,!0),Sc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Fv(s,a,c,o);break e}else if(c!==m){m=ra(Error(i(424)),a),wc(m),a=Fv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,un=ca(s.firstChild),rr=a,Ns=!0,Ni=null,oa=!0,o=Lb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Co(),c===m){a=ai(s,a,o);break e}ir(s,a,c,o)}a=a.child}return a;case 26:return jd(s,a),s===null?(o=s1(a.type,null,a.pendingProps,null))?a.memoizedState=o:Ns||(o=a.type,s=a.pendingProps,c=Fd(Ne.current).createElement(o),c[ht]=a,c[Et]=s,or(c,o,s),de(c),a.stateNode=c):a.memoizedState=s1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Yt(a),s===null&&Ns&&(c=a.stateNode=Z0(a.type,a.pendingProps,Ne.current),rr=a,oa=!0,m=un,qi(a.type)?(lp=m,un=ca(c.firstChild)):un=m),ir(s,a,a.pendingProps.children,o),jd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Ns&&((m=c=un)&&(c=Zj(c,a.type,a.pendingProps,oa),c!==null?(a.stateNode=c,rr=a,un=ca(c.firstChild),oa=!1,m=!0):m=!1),m||Ci(a)),Yt(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,np(m,f)?c=null:w!==null&&np(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=tf(s,a,fj,null,null,o),Kc._currentValue=m),jd(s,a),ir(s,a,c,o),a.child;case 6:return s===null&&Ns&&((s=o=un)&&(o=eT(o,a.pendingProps,oa),o!==null?(a.stateNode=o,rr=a,un=null,s=!0):s=!1),s||Ci(a)),null;case 13:return zv(s,a,o);case 4:return ft(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Po(a,null,c,o):ir(s,a,c,o),a.child;case 11:return Mv(s,a,a.type,a.pendingProps,o);case 7:return ir(s,a,a.pendingProps,o),a.child;case 8:return ir(s,a,a.pendingProps.children,o),a.child;case 12:return ir(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ri(a,a.type,c.value),ir(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Ao(a),m=ar(m),c=c(m),a.flags|=1,ir(s,a,c,o),a.child;case 14:return Dv(s,a,a.type,a.pendingProps,o);case 15:return Pv(s,a,a.type,a.pendingProps,o);case 19:return Hv(s,a,o);case 31:return _j(s,a,o);case 22:return Lv(s,a,o,a.pendingProps);case 24:return Ao(a),c=ar(Pn),s===null?(m=$m(),m===null&&(m=en,f=qm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Gm(a),Ri(a,Pn,m)):((s.lanes&o)!==0&&(Km(s,a),Nc(a,null,null,o),Sc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ri(a,Pn,c)):(c=f.cache,Ri(a,Pn,c),c!==m.cache&&zm(a,[Pn],o,!0))),ir(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ii(s){s.flags|=4}function Rf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(b0())s.flags|=8192;else throw Do=cd,Wm}else s.flags&=-16777217}function Wv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!o1(a))if(b0())s.flags|=8192;else throw Do=cd,Wm}function Ed(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?ke():536870912,s.lanes|=a,Cl|=a)}function Dc(s,a){if(!Ns)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function dn(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function jj(s,a,o){var c=a.pendingProps;switch(Om(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(a),null;case 1:return dn(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),si(Pn),et(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(gl(a)?ii(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Vm())),dn(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ii(a),f!==null?(dn(a),Wv(a,f)):(dn(a),Rf(a,m,null,c,o))):f?f!==s.memoizedState?(ii(a),dn(a),Wv(a,f)):(dn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ii(a),dn(a),Rf(a,m,s,c,o)),null;case 27:if(Ts(a),o=Ne.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return dn(a),null}s=Be.current,gl(a)?Tb(a):(s=Z0(m,c,o),a.stateNode=s,ii(a))}return dn(a),null;case 5:if(Ts(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return dn(a),null}if(f=Be.current,gl(a))Tb(a);else{var w=Fd(Ne.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[ht]=a,f[Et]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(or(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ii(a)}}return dn(a),Rf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Ne.current,gl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=rr,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[ht]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||z0(s.nodeValue,o)),s||Ci(a,!0)}else s=Fd(s).createTextNode(c),s[ht]=a,a.stateNode=s}return dn(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=gl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[ht]=a}else Co(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;dn(a),s=!1}else o=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Gr(a),a):(Gr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return dn(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=gl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ht]=a}else Co(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;dn(a),m=!1}else m=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Gr(a),a):(Gr(a),null)}return Gr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Ed(a,a.updateQueue),dn(a),null);case 4:return et(),s===null&&Jf(a.stateNode.containerInfo),dn(a),null;case 10:return si(a.type),dn(a),null;case 19:if(re(Rn),c=a.memoizedState,c===null)return dn(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Dc(c,!1);else{if(jn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=md(s),f!==null){for(a.flags|=128,Dc(c,!1),s=f.updateQueue,a.updateQueue=s,Ed(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)xb(o,s),o=o.sibling;return Pe(Rn,Rn.current&1|2),Ns&&ei(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ft()>Ad&&(a.flags|=128,m=!0,Dc(c,!1),a.lanes=4194304)}else{if(!m)if(s=md(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Ed(a,s),Dc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Ns)return dn(a),null}else 2*Ft()-c.renderingStartTime>Ad&&o!==536870912&&(a.flags|=128,m=!0,Dc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ft(),s.sibling=null,o=Rn.current,Pe(Rn,m?o&1|2:o&1),Ns&&ei(a,c.treeForkCount),s):(dn(a),null);case 22:case 23:return Gr(a),Jm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(dn(a),a.subtreeFlags&6&&(a.flags|=8192)):dn(a),o=a.updateQueue,o!==null&&Ed(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&re(Io),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),si(Pn),dn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Tj(s,a){switch(Om(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return si(Pn),et(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ts(a),null;case 31:if(a.memoizedState!==null){if(Gr(a),a.alternate===null)throw Error(i(340));Co()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Gr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Co()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return re(Rn),null;case 4:return et(),null;case 10:return si(a.type),null;case 22:case 23:return Gr(a),Jm(),s!==null&&re(Io),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return si(Pn),null;case 25:return null;default:return null}}function Gv(s,a){switch(Om(a),a.tag){case 3:si(Pn),et();break;case 26:case 27:case 5:Ts(a);break;case 4:et();break;case 31:a.memoizedState!==null&&Gr(a);break;case 13:Gr(a);break;case 19:re(Rn);break;case 10:si(a.type);break;case 22:case 23:Gr(a),Jm(),s!==null&&re(Io);break;case 24:si(Pn)}}function Pc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(S){Ys(a,a.return,S)}}function Li(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,S=w.destroy;if(S!==void 0){w.destroy=void 0,m=a;var F=o,ce=S;try{ce()}catch(Ee){Ys(m,F,Ee)}}}c=c.next}while(c!==f)}}catch(Ee){Ys(a,a.return,Ee)}}function Kv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Bb(a,o)}catch(c){Ys(s,s.return,c)}}}function Yv(s,a,o){o.props=Oo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Ys(s,a,c)}}function Lc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Ys(s,a,m)}}function Oa(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Ys(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ys(s,a,m)}else o.current=null}function Qv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Ys(s,s.return,m)}}function Af(s,a,o){try{var c=s.stateNode;Gj(c,s.type,o,a),c[Et]=a}catch(m){Ys(s,s.return,m)}}function Xv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&qi(s.type)||s.tag===4}function If(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Xv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&qi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Zt));else if(c!==4&&(c===27&&qi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Mf(s,a,o),s=s.sibling;s!==null;)Mf(s,a,o),s=s.sibling}function Sd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&qi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Sd(s,a,o),s=s.sibling;s!==null;)Sd(s,a,o),s=s.sibling}function Jv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);or(a,c,o),a[ht]=s,a[Et]=o}catch(f){Ys(s,s.return,f)}}var oi=!1,Bn=!1,Df=!1,Zv=typeof WeakSet=="function"?WeakSet:Set,Xn=null;function Ej(s,a){if(s=s.containerInfo,tp=Kd,s=db(s),Em(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,S=-1,F=-1,ce=0,Ee=0,Oe=s,he=null;t:for(;;){for(var ve;Oe!==o||m!==0&&Oe.nodeType!==3||(S=w+m),Oe!==f||c!==0&&Oe.nodeType!==3||(F=w+c),Oe.nodeType===3&&(w+=Oe.nodeValue.length),(ve=Oe.firstChild)!==null;)he=Oe,Oe=ve;for(;;){if(Oe===s)break t;if(he===o&&++ce===m&&(S=w),he===f&&++Ee===c&&(F=w),(ve=Oe.nextSibling)!==null)break;Oe=he,he=Oe.parentNode}Oe=ve}o=S===-1||F===-1?null:{start:S,end:F}}else o=null}o=o||{start:0,end:0}}else o=null;for(sp={focusedElem:s,selectionRange:o},Kd=!1,Xn=a;Xn!==null;)if(a=Xn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Xn=s;else for(;Xn!==null;){switch(a=Xn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var jt=Oo(o.type,m);s=c.getSnapshotBeforeUpdate(jt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Ut){Ys(o,o.return,Ut)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)ap(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ap(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Xn=s;break}Xn=a.return}}function e0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ci(s,o),c&4&&Pc(5,o);break;case 1:if(ci(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Ys(o,o.return,w)}else{var m=Oo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Ys(o,o.return,w)}}c&64&&Kv(o),c&512&&Lc(o,o.return);break;case 3:if(ci(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Bb(s,a)}catch(w){Ys(o,o.return,w)}}break;case 27:a===null&&c&4&&Jv(o);case 26:case 5:ci(s,o),a===null&&c&4&&Qv(o),c&512&&Lc(o,o.return);break;case 12:ci(s,o);break;case 31:ci(s,o),c&4&&n0(s,o);break;case 13:ci(s,o),c&4&&r0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Pj.bind(null,o),tT(s,o))));break;case 22:if(c=o.memoizedState!==null||oi,!c){a=a!==null&&a.memoizedState!==null||Bn,m=oi;var f=Bn;oi=c,(Bn=a)&&!f?ui(s,o,(o.subtreeFlags&8772)!==0):ci(s,o),oi=m,Bn=f}break;case 30:break;default:ci(s,o)}}function t0(s){var a=s.alternate;a!==null&&(s.alternate=null,t0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&rn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,Pr=!1;function li(s,a,o){for(o=o.child;o!==null;)s0(s,a,o),o=o.sibling}function s0(s,a,o){if(ye&&typeof ye.onCommitFiberUnmount=="function")try{ye.onCommitFiberUnmount(ps,o)}catch{}switch(o.tag){case 26:Bn||Oa(o,a),li(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Bn||Oa(o,a);var c=pn,m=Pr;qi(o.type)&&(pn=o.stateNode,Pr=!1),li(s,a,o),$c(o.stateNode),pn=c,Pr=m;break;case 5:Bn||Oa(o,a);case 6:if(c=pn,m=Pr,pn=null,li(s,a,o),pn=c,Pr=m,pn!==null)if(Pr)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(o.stateNode)}catch(f){Ys(o,a,f)}else try{pn.removeChild(o.stateNode)}catch(f){Ys(o,a,f)}break;case 18:pn!==null&&(Pr?(s=pn,K0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Ol(s)):K0(pn,o.stateNode));break;case 4:c=pn,m=Pr,pn=o.stateNode.containerInfo,Pr=!0,li(s,a,o),pn=c,Pr=m;break;case 0:case 11:case 14:case 15:Li(2,o,a),Bn||Li(4,o,a),li(s,a,o);break;case 1:Bn||(Oa(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Yv(o,a,c)),li(s,a,o);break;case 21:li(s,a,o);break;case 22:Bn=(c=Bn)||o.memoizedState!==null,li(s,a,o),Bn=c;break;default:li(s,a,o)}}function n0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ol(s)}catch(o){Ys(a,a.return,o)}}}function r0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ol(s)}catch(o){Ys(a,a.return,o)}}function Sj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Zv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Zv),a;default:throw Error(i(435,s.tag))}}function Nd(s,a){var o=Sj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Lj.bind(null,s,c);c.then(m,m)}})}function Lr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,S=w;e:for(;S!==null;){switch(S.tag){case 27:if(qi(S.type)){pn=S.stateNode,Pr=!1;break e}break;case 5:pn=S.stateNode,Pr=!1;break e;case 3:case 4:pn=S.stateNode.containerInfo,Pr=!0;break e}S=S.return}if(pn===null)throw Error(i(160));s0(f,w,m),pn=null,Pr=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)a0(a,s),a=a.sibling}var va=null;function a0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Lr(a,s),Or(s),c&4&&(Li(3,s,s.return),Pc(3,s),Li(5,s,s.return));break;case 1:Lr(a,s),Or(s),c&512&&(Bn||o===null||Oa(o,o.return)),c&64&&oi&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=va;if(Lr(a,s),Or(s),c&512&&(Bn||o===null||Oa(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[mn]||f[ht]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),or(f,c,o),f[ht]=s,de(f),c=f;break e;case"link":var w=a1("link","href",m).get(c+(o.href||""));if(w){for(var S=0;S<w.length;S++)if(f=w[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(S,1);break t}}f=m.createElement(c),or(f,c,o),m.head.appendChild(f);break;case"meta":if(w=a1("meta","content",m).get(c+(o.content||""))){for(S=0;S<w.length;S++)if(f=w[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(S,1);break t}}f=m.createElement(c),or(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[ht]=s,de(f),c=f}s.stateNode=c}else i1(m,s.type,s.stateNode);else s.stateNode=r1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?i1(m,s.type,s.stateNode):r1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Af(s,s.memoizedProps,o.memoizedProps)}break;case 27:Lr(a,s),Or(s),c&512&&(Bn||o===null||Oa(o,o.return)),o!==null&&c&4&&Af(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Lr(a,s),Or(s),c&512&&(Bn||o===null||Oa(o,o.return)),s.flags&32){m=s.stateNode;try{Jt(m,"")}catch(jt){Ys(s,s.return,jt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Af(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Df=!0);break;case 6:if(Lr(a,s),Or(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(jt){Ys(s,s.return,jt)}}break;case 3:if(Hd=null,m=va,va=zd(a.containerInfo),Lr(a,s),va=m,Or(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ol(a.containerInfo)}catch(jt){Ys(s,s.return,jt)}Df&&(Df=!1,i0(s));break;case 4:c=va,va=zd(s.stateNode.containerInfo),Lr(a,s),Or(s),va=c;break;case 12:Lr(a,s),Or(s);break;case 31:Lr(a,s),Or(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Nd(s,c)));break;case 13:Lr(a,s),Or(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Rd=Ft()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Nd(s,c)));break;case 22:m=s.memoizedState!==null;var F=o!==null&&o.memoizedState!==null,ce=oi,Ee=Bn;if(oi=ce||m,Bn=Ee||F,Lr(a,s),Bn=Ee,oi=ce,Or(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||F||oi||Bn||Bo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){F=o=a;try{if(f=F.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{S=F.stateNode;var Oe=F.memoizedProps.style,he=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;S.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(jt){Ys(F,F.return,jt)}}}else if(a.tag===6){if(o===null){F=a;try{F.stateNode.nodeValue=m?"":F.memoizedProps}catch(jt){Ys(F,F.return,jt)}}}else if(a.tag===18){if(o===null){F=a;try{var ve=F.stateNode;m?Y0(ve,!0):Y0(F.stateNode,!1)}catch(jt){Ys(F,F.return,jt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Nd(s,o))));break;case 19:Lr(a,s),Or(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Nd(s,c)));break;case 30:break;case 21:break;default:Lr(a,s),Or(s)}}function Or(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Xv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=If(s);Sd(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Jt(w,""),o.flags&=-33);var S=If(s);Sd(s,S,w);break;case 3:case 4:var F=o.stateNode.containerInfo,ce=If(s);Mf(s,ce,F);break;default:throw Error(i(161))}}catch(Ee){Ys(s,s.return,Ee)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function i0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;i0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ci(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)e0(s,a.alternate,a),a=a.sibling}function Bo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Li(4,a,a.return),Bo(a);break;case 1:Oa(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Yv(a,a.return,o),Bo(a);break;case 27:$c(a.stateNode);case 26:case 5:Oa(a,a.return),Bo(a);break;case 22:a.memoizedState===null&&Bo(a);break;case 30:Bo(a);break;default:Bo(a)}s=s.sibling}}function ui(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:ui(m,f,o),Pc(4,f);break;case 1:if(ui(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ce){Ys(c,c.return,ce)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var F=m.shared.hiddenCallbacks;if(F!==null)for(m.shared.hiddenCallbacks=null,m=0;m<F.length;m++)Ob(F[m],S)}catch(ce){Ys(c,c.return,ce)}}o&&w&64&&Kv(f),Lc(f,f.return);break;case 27:Jv(f);case 26:case 5:ui(m,f,o),o&&c===null&&w&4&&Qv(f),Lc(f,f.return);break;case 12:ui(m,f,o);break;case 31:ui(m,f,o),o&&w&4&&n0(m,f);break;case 13:ui(m,f,o),o&&w&4&&r0(m,f);break;case 22:f.memoizedState===null&&ui(m,f,o),Lc(f,f.return);break;case 30:break;default:ui(m,f,o)}a=a.sibling}}function Pf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&_c(o))}function Lf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&_c(s))}function xa(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)o0(s,a,o,c),a=a.sibling}function o0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:xa(s,a,o,c),m&2048&&Pc(9,a);break;case 1:xa(s,a,o,c);break;case 3:xa(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&_c(s)));break;case 12:if(m&2048){xa(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,S=f.onPostCommit;typeof S=="function"&&S(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(F){Ys(a,a.return,F)}}else xa(s,a,o,c);break;case 31:xa(s,a,o,c);break;case 13:xa(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?xa(s,a,o,c):Oc(s,a):f._visibility&2?xa(s,a,o,c):(f._visibility|=2,El(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Pf(w,a);break;case 24:xa(s,a,o,c),m&2048&&Lf(a.alternate,a);break;default:xa(s,a,o,c)}}function El(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,S=o,F=c,ce=w.flags;switch(w.tag){case 0:case 11:case 15:El(f,w,S,F,m),Pc(8,w);break;case 23:break;case 22:var Ee=w.stateNode;w.memoizedState!==null?Ee._visibility&2?El(f,w,S,F,m):Oc(f,w):(Ee._visibility|=2,El(f,w,S,F,m)),m&&ce&2048&&Pf(w.alternate,w);break;case 24:El(f,w,S,F,m),m&&ce&2048&&Lf(w.alternate,w);break;default:El(f,w,S,F,m)}a=a.sibling}}function Oc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Oc(o,c),m&2048&&Pf(c.alternate,c);break;case 24:Oc(o,c),m&2048&&Lf(c.alternate,c);break;default:Oc(o,c)}a=a.sibling}}var Bc=8192;function Sl(s,a,o){if(s.subtreeFlags&Bc)for(s=s.child;s!==null;)l0(s,a,o),s=s.sibling}function l0(s,a,o){switch(s.tag){case 26:Sl(s,a,o),s.flags&Bc&&s.memoizedState!==null&&mT(o,va,s.memoizedState,s.memoizedProps);break;case 5:Sl(s,a,o);break;case 3:case 4:var c=va;va=zd(s.stateNode.containerInfo),Sl(s,a,o),va=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Bc,Bc=16777216,Sl(s,a,o),Bc=c):Sl(s,a,o));break;default:Sl(s,a,o)}}function c0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Vc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Xn=c,d0(c,s)}c0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)u0(s),s=s.sibling}function u0(s){switch(s.tag){case 0:case 11:case 15:Vc(s),s.flags&2048&&Li(9,s,s.return);break;case 3:Vc(s);break;case 12:Vc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Cd(s)):Vc(s);break;default:Vc(s)}}function Cd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Xn=c,d0(c,s)}c0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Li(8,a,a.return),Cd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Cd(a));break;default:Cd(a)}s=s.sibling}}function d0(s,a){for(;Xn!==null;){var o=Xn;switch(o.tag){case 0:case 11:case 15:Li(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:_c(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Xn=c;else e:for(o=s;Xn!==null;){c=Xn;var m=c.sibling,f=c.return;if(t0(c),c===o){Xn=null;break e}if(m!==null){m.return=f,Xn=m;break e}Xn=f}}}var Nj={getCacheForType:function(s){var a=ar(Pn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return ar(Pn).controller.signal}},Cj=typeof WeakMap=="function"?WeakMap:Map,Hs=0,en=null,gs=null,xs=0,Ks=0,Kr=null,Oi=!1,Nl=!1,Of=!1,di=0,jn=0,Bi=0,Vo=0,Bf=0,Yr=0,Cl=0,Uc=null,Br=null,Vf=!1,Rd=0,h0=0,Ad=1/0,Id=null,Vi=null,$n=0,Ui=null,Rl=null,hi=0,Uf=0,Ff=null,m0=null,Fc=0,zf=null;function Qr(){return(Hs&2)!==0&&xs!==0?xs&-xs:q.T!==null?Kf():Re()}function f0(){if(Yr===0)if((xs&536870912)===0||Ns){var s=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),Yr=s}else Yr=536870912;return s=Wr.current,s!==null&&(s.flags|=32),Yr}function Vr(s,a,o){(s===en&&(Ks===2||Ks===9)||s.cancelPendingCommit!==null)&&(Al(s,0),Fi(s,xs,Yr,!1)),nt(s,o),((Hs&2)===0||s!==en)&&(s===en&&((Hs&2)===0&&(Vo|=o),jn===4&&Fi(s,xs,Yr,!1)),Ba(s))}function p0(s,a,o){if((Hs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||Ye(s,a),m=c?Ij(s,a):Hf(s,a,!0),f=c;do{if(m===0){Nl&&!c&&Fi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Rj(o)){m=Hf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var S=s;m=Uc;var F=S.current.memoizedState.isDehydrated;if(F&&(Al(S,w).flags|=256),w=Hf(S,w,!1),w!==2){if(Of&&!F){S.errorRecoveryDisabledLanes|=f,Vo|=f,m=4;break e}f=Br,Br=m,f!==null&&(Br===null?Br=f:Br.push.apply(Br,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Al(s,0),Fi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Fi(c,a,Yr,!Oi);break e;case 2:Br=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Rd+300-Ft(),10<m)){if(Fi(c,a,Yr,!Oi),gt(c,0,!0)!==0)break e;hi=a,c.timeoutHandle=W0(g0.bind(null,c,o,Br,Id,Vf,a,Yr,Vo,Cl,Oi,f,"Throttled",-0,0),m);break e}g0(c,o,Br,Id,Vf,a,Yr,Vo,Cl,Oi,f,null,-0,0)}}break}while(!0);Ba(s)}function g0(s,a,o,c,m,f,w,S,F,ce,Ee,Oe,he,ve){if(s.timeoutHandle=-1,Oe=a.subtreeFlags,Oe&8192||(Oe&16785408)===16785408){Oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zt},l0(a,f,Oe);var jt=(f&62914560)===f?Rd-Ft():(f&4194048)===f?h0-Ft():0;if(jt=fT(Oe,jt),jt!==null){hi=f,s.cancelPendingCommit=jt(j0.bind(null,s,a,f,o,c,m,w,S,F,Ee,Oe,null,he,ve)),Fi(s,f,w,!ce);return}}j0(s,a,f,o,c,m,w,S,F)}function Rj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Hr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Fi(s,a,o,c){a&=~Bf,a&=~Vo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Le(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&St(s,o,a)}function Md(){return(Hs&6)===0?(zc(0),!1):!0}function qf(){if(gs!==null){if(Ks===0)var s=gs.return;else s=gs,ti=Ro=null,rf(s),wl=null,jc=0,s=gs;for(;s!==null;)Gv(s.alternate,s),s=s.return;gs=null}}function Al(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Qj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),hi=0,qf(),en=s,gs=o=Za(s.current,null),xs=a,Ks=0,Kr=null,Oi=!1,Nl=Ye(s,a),Of=!1,Cl=Yr=Bf=Vo=Bi=jn=0,Br=Uc=null,Vf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Le(c),f=1<<m;a|=s[m],c&=~f}return di=a,ed(),o}function y0(s,a){us=null,q.H=Ic,a===xl||a===ld?(a=Mb(),Ks=3):a===Wm?(a=Mb(),Ks=4):Ks=a===wf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Kr=a,gs===null&&(jn=1,_d(s,ra(a,s.current)))}function b0(){var s=Wr.current;return s===null?!0:(xs&4194048)===xs?la===null:(xs&62914560)===xs||(xs&536870912)!==0?s===la:!1}function v0(){var s=q.H;return q.H=Ic,s===null?Ic:s}function x0(){var s=q.A;return q.A=Nj,s}function Dd(){jn=4,Oi||(xs&4194048)!==xs&&Wr.current!==null||(Nl=!0),(Bi&134217727)===0&&(Vo&134217727)===0||en===null||Fi(en,xs,Yr,!1)}function Hf(s,a,o){var c=Hs;Hs|=2;var m=v0(),f=x0();(en!==s||xs!==a)&&(Id=null,Al(s,a)),a=!1;var w=jn;e:do try{if(Ks!==0&&gs!==null){var S=gs,F=Kr;switch(Ks){case 8:qf(),w=6;break e;case 3:case 2:case 9:case 6:Wr.current===null&&(a=!0);var ce=Ks;if(Ks=0,Kr=null,Il(s,S,F,ce),o&&Nl){w=0;break e}break;default:ce=Ks,Ks=0,Kr=null,Il(s,S,F,ce)}}Aj(),w=jn;break}catch(Ee){y0(s,Ee)}while(!0);return a&&s.shellSuspendCounter++,ti=Ro=null,Hs=c,q.H=m,q.A=f,gs===null&&(en=null,xs=0,ed()),w}function Aj(){for(;gs!==null;)w0(gs)}function Ij(s,a){var o=Hs;Hs|=2;var c=v0(),m=x0();en!==s||xs!==a?(Id=null,Ad=Ft()+500,Al(s,a)):Nl=Ye(s,a);e:do try{if(Ks!==0&&gs!==null){a=gs;var f=Kr;t:switch(Ks){case 1:Ks=0,Kr=null,Il(s,a,f,1);break;case 2:case 9:if(Ab(f)){Ks=0,Kr=null,_0(a);break}a=function(){Ks!==2&&Ks!==9||en!==s||(Ks=7),Ba(s)},f.then(a,a);break e;case 3:Ks=7;break e;case 4:Ks=5;break e;case 7:Ab(f)?(Ks=0,Kr=null,_0(a)):(Ks=0,Kr=null,Il(s,a,f,7));break;case 5:var w=null;switch(gs.tag){case 26:w=gs.memoizedState;case 5:case 27:var S=gs;if(w?o1(w):S.stateNode.complete){Ks=0,Kr=null;var F=S.sibling;if(F!==null)gs=F;else{var ce=S.return;ce!==null?(gs=ce,Pd(ce)):gs=null}break t}}Ks=0,Kr=null,Il(s,a,f,5);break;case 6:Ks=0,Kr=null,Il(s,a,f,6);break;case 8:qf(),jn=6;break e;default:throw Error(i(462))}}Mj();break}catch(Ee){y0(s,Ee)}while(!0);return ti=Ro=null,q.H=c,q.A=m,Hs=o,gs!==null?0:(en=null,xs=0,ed(),jn)}function Mj(){for(;gs!==null&&!Qt();)w0(gs)}function w0(s){var a=$v(s.alternate,s,di);s.memoizedProps=s.pendingProps,a===null?Pd(s):gs=a}function _0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Vv(o,a,a.pendingProps,a.type,void 0,xs);break;case 11:a=Vv(o,a,a.pendingProps,a.type.render,a.ref,xs);break;case 5:rf(a);default:Gv(o,a),a=gs=xb(a,di),a=$v(o,a,di)}s.memoizedProps=s.pendingProps,a===null?Pd(s):gs=a}function Il(s,a,o,c){ti=Ro=null,rf(a),wl=null,jc=0;var m=a.return;try{if(wj(s,m,a,o,xs)){jn=1,_d(s,ra(o,s.current)),gs=null;return}}catch(f){if(m!==null)throw gs=m,f;jn=1,_d(s,ra(o,s.current)),gs=null;return}a.flags&32768?(Ns||c===1?s=!0:Nl||(xs&536870912)!==0?s=!1:(Oi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Wr.current,c!==null&&c.tag===13&&(c.flags|=16384))),k0(a,s)):Pd(a)}function Pd(s){var a=s;do{if((a.flags&32768)!==0){k0(a,Oi);return}s=a.return;var o=jj(a.alternate,a,di);if(o!==null){gs=o;return}if(a=a.sibling,a!==null){gs=a;return}gs=a=s}while(a!==null);jn===0&&(jn=5)}function k0(s,a){do{var o=Tj(s.alternate,s);if(o!==null){o.flags&=32767,gs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){gs=s;return}gs=s=o}while(s!==null);jn=6,gs=null}function j0(s,a,o,c,m,f,w,S,F){s.cancelPendingCommit=null;do Ld();while($n!==0);if((Hs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Am,lt(s,o,f,w,S,F),s===en&&(gs=en=null,xs=0),Rl=a,Ui=s,hi=o,Uf=f,Ff=m,m0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Oj(ss,function(){return C0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=q.T,q.T=null,m=me.p,me.p=2,w=Hs,Hs|=4;try{Ej(s,a,o)}finally{Hs=w,me.p=m,q.T=c}}$n=1,T0(),E0(),S0()}}function T0(){if($n===1){$n=0;var s=Ui,a=Rl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=q.T,q.T=null;var c=me.p;me.p=2;var m=Hs;Hs|=4;try{a0(a,s);var f=sp,w=db(s.containerInfo),S=f.focusedElem,F=f.selectionRange;if(w!==S&&S&&S.ownerDocument&&ub(S.ownerDocument.documentElement,S)){if(F!==null&&Em(S)){var ce=F.start,Ee=F.end;if(Ee===void 0&&(Ee=ce),"selectionStart"in S)S.selectionStart=ce,S.selectionEnd=Math.min(Ee,S.value.length);else{var Oe=S.ownerDocument||document,he=Oe&&Oe.defaultView||window;if(he.getSelection){var ve=he.getSelection(),jt=S.textContent.length,Ut=Math.min(F.start,jt),Js=F.end===void 0?Ut:Math.min(F.end,jt);!ve.extend&&Ut>Js&&(w=Js,Js=Ut,Ut=w);var Z=cb(S,Ut),H=cb(S,Js);if(Z&&H&&(ve.rangeCount!==1||ve.anchorNode!==Z.node||ve.anchorOffset!==Z.offset||ve.focusNode!==H.node||ve.focusOffset!==H.offset)){var le=Oe.createRange();le.setStart(Z.node,Z.offset),ve.removeAllRanges(),Ut>Js?(ve.addRange(le),ve.extend(H.node,H.offset)):(le.setEnd(H.node,H.offset),ve.addRange(le))}}}}for(Oe=[],ve=S;ve=ve.parentNode;)ve.nodeType===1&&Oe.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Oe.length;S++){var Ie=Oe[S];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}Kd=!!tp,sp=tp=null}finally{Hs=m,me.p=c,q.T=o}}s.current=a,$n=2}}function E0(){if($n===2){$n=0;var s=Ui,a=Rl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=q.T,q.T=null;var c=me.p;me.p=2;var m=Hs;Hs|=4;try{e0(s,a.alternate,a)}finally{Hs=m,me.p=c,q.T=o}}$n=3}}function S0(){if($n===4||$n===3){$n=0,zs();var s=Ui,a=Rl,o=hi,c=m0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?$n=5:($n=0,Rl=Ui=null,N0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Vi=null),fe(o),a=a.stateNode,ye&&typeof ye.onCommitFiberRoot=="function")try{ye.onCommitFiberRoot(ps,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=q.T,m=me.p,me.p=2,q.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var S=c[w];f(S.value,{componentStack:S.stack})}}finally{q.T=a,me.p=m}}(hi&3)!==0&&Ld(),Ba(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===zf?Fc++:(Fc=0,zf=s):Fc=0,zc(0)}}function N0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,_c(a)))}function Ld(){return T0(),E0(),S0(),C0()}function C0(){if($n!==5)return!1;var s=Ui,a=Uf;Uf=0;var o=fe(hi),c=q.T,m=me.p;try{me.p=32>o?32:o,q.T=null,o=Ff,Ff=null;var f=Ui,w=hi;if($n=0,Rl=Ui=null,hi=0,(Hs&6)!==0)throw Error(i(331));var S=Hs;if(Hs|=4,u0(f.current),o0(f,f.current,w,o),Hs=S,zc(0,!1),ye&&typeof ye.onPostCommitFiberRoot=="function")try{ye.onPostCommitFiberRoot(ps,f)}catch{}return!0}finally{me.p=m,q.T=c,N0(s,a)}}function R0(s,a,o){a=ra(o,a),a=xf(s.stateNode,a,2),s=Mi(s,a,2),s!==null&&(nt(s,2),Ba(s))}function Ys(s,a,o){if(s.tag===3)R0(s,s,o);else for(;a!==null;){if(a.tag===3){R0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Vi===null||!Vi.has(c))){s=ra(o,s),o=Av(2),c=Mi(a,o,2),c!==null&&(Iv(o,c,a,s),nt(c,2),Ba(c));break}}a=a.return}}function $f(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Cj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Of=!0,m.add(o),s=Dj.bind(null,s,a,o),a.then(s,s))}function Dj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,en===s&&(xs&o)===o&&(jn===4||jn===3&&(xs&62914560)===xs&&300>Ft()-Rd?(Hs&2)===0&&Al(s,0):Bf|=o,Cl===xs&&(Cl=0)),Ba(s)}function A0(s,a){a===0&&(a=ke()),s=So(s,a),s!==null&&(nt(s,a),Ba(s))}function Pj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),A0(s,o)}function Lj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),A0(s,o)}function Oj(s,a){return tt(s,a)}var Od=null,Ml=null,Wf=!1,Bd=!1,Gf=!1,zi=0;function Ba(s){s!==Ml&&s.next===null&&(Ml===null?Od=Ml=s:Ml=Ml.next=s),Bd=!0,Wf||(Wf=!0,Vj())}function zc(s,a){if(!Gf&&Bd){Gf=!0;do for(var o=!1,c=Od;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Le(42|s)+1)-1,f&=m&~(w&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,P0(c,f))}else f=xs,f=gt(c,c===en?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||Ye(c,f)||(o=!0,P0(c,f));c=c.next}while(o);Gf=!1}}function Bj(){I0()}function I0(){Bd=Wf=!1;var s=0;zi!==0&&Yj()&&(s=zi);for(var a=Ft(),o=null,c=Od;c!==null;){var m=c.next,f=M0(c,a);f===0?(c.next=null,o===null?Od=m:o.next=m,m===null&&(Ml=o)):(o=c,(s!==0||(f&3)!==0)&&(Bd=!0)),c=m}$n!==0&&$n!==5||zc(s),zi!==0&&(zi=0)}function M0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-Le(f),S=1<<w,F=m[w];F===-1?((S&o)===0||(S&c)!==0)&&(m[w]=J(S,a)):F<=a&&(s.expiredLanes|=S),f&=~S}if(a=en,o=xs,o=gt(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Ks===2||Ks===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&pt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Ye(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&pt(c),fe(o)){case 2:case 8:o=Cs;break;case 32:o=ss;break;case 268435456:o=Ms;break;default:o=ss}return c=D0.bind(null,s),o=tt(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&pt(c),s.callbackPriority=2,s.callbackNode=null,2}function D0(s,a){if($n!==0&&$n!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Ld()&&s.callbackNode!==o)return null;var c=xs;return c=gt(s,s===en?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(p0(s,c,a),M0(s,Ft()),s.callbackNode!=null&&s.callbackNode===o?D0.bind(null,s):null)}function P0(s,a){if(Ld())return null;p0(s,a,!0)}function Vj(){Xj(function(){(Hs&6)!==0?tt(is,Bj):I0()})}function Kf(){if(zi===0){var s=bl;s===0&&(s=dt,dt<<=1,(dt&261888)===0&&(dt=256)),zi=s}return zi}function L0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$s(""+s)}function O0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Uj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=L0((m[Et]||null).action),w=c.submitter;w&&(a=(a=w[Et]||null)?L0(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var S=new Ot("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(zi!==0){var F=w?O0(m,w):new FormData(m);ff(o,{pending:!0,data:F,method:m.method,action:f},null,F)}}else typeof f=="function"&&(S.preventDefault(),F=w?O0(m,w):new FormData(m),ff(o,{pending:!0,data:F,method:m.method,action:f},f,F))},currentTarget:m}]})}}for(var Yf=0;Yf<Rm.length;Yf++){var Qf=Rm[Yf],Fj=Qf.toLowerCase(),zj=Qf[0].toUpperCase()+Qf.slice(1);ba(Fj,"on"+zj)}ba(fb,"onAnimationEnd"),ba(pb,"onAnimationIteration"),ba(gb,"onAnimationStart"),ba("dblclick","onDoubleClick"),ba("focusin","onFocus"),ba("focusout","onBlur"),ba(rj,"onTransitionRun"),ba(aj,"onTransitionStart"),ba(ij,"onTransitionCancel"),ba(yb,"onTransitionEnd"),ne("onMouseEnter",["mouseout","mouseover"]),ne("onMouseLeave",["mouseout","mouseover"]),ne("onPointerEnter",["pointerout","pointerover"]),ne("onPointerLeave",["pointerout","pointerover"]),D("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),D("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),D("onBeforeInput",["compositionend","keypress","textInput","paste"]),D("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),D("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),D("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qc));function B0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var S=c[w],F=S.instance,ce=S.currentTarget;if(S=S.listener,F!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=ce;try{f(m)}catch(Ee){Zu(Ee)}m.currentTarget=null,f=F}else for(w=0;w<c.length;w++){if(S=c[w],F=S.instance,ce=S.currentTarget,S=S.listener,F!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=ce;try{f(m)}catch(Ee){Zu(Ee)}m.currentTarget=null,f=F}}}}function ys(s,a){var o=a[Lt];o===void 0&&(o=a[Lt]=new Set);var c=s+"__bubble";o.has(c)||(V0(a,s,2,!1),o.add(c))}function Xf(s,a,o){var c=0;a&&(c|=4),V0(o,s,c,a)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function Jf(s){if(!s[Vd]){s[Vd]=!0,ue.forEach(function(o){o!=="selectionchange"&&(qj.has(o)||Xf(o,!1,s),Xf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Vd]||(a[Vd]=!0,Xf("selectionchange",!1,a))}}function V0(s,a,o,c){switch(f1(a)){case 2:var m=yT;break;case 8:m=bT;break;default:m=mp}o=m.bind(null,a,o,s),m=void 0,!Rr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Zf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===m)break;if(w===4)for(w=c.return;w!==null;){var F=w.tag;if((F===3||F===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;S!==null;){if(w=xn(S),w===null)return;if(F=w.tag,F===5||F===6||F===26||F===27){c=f=w;continue e}S=S.parentNode}}c=c.return}hr(function(){var ce=f,Ee=an(o),Oe=[];e:{var he=bb.get(s);if(he!==void 0){var ve=Ot,jt=s;switch(s){case"keypress":if(N(o)===0)break e;case"keydown":case"keyup":ve=Ja;break;case"focusin":jt="focus",ve=qn;break;case"focusout":jt="blur",ve=qn;break;case"beforeblur":case"afterblur":ve=qn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=qr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=cn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=b;break;case fb:case pb:case gb:ve=tr;break;case yb:ve=R;break;case"scroll":case"scrollend":ve=es;break;case"wheel":ve=ge;break;case"copy":case"cut":case"paste":ve=Ir;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=fr;break;case"toggle":case"beforetoggle":ve=cs}var Ut=(a&4)!==0,Js=!Ut&&(s==="scroll"||s==="scrollend"),Z=Ut?he!==null?he+"Capture":null:he;Ut=[];for(var H=ce,le;H!==null;){var Ie=H;if(le=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||le===null||Z===null||(Ie=Yn(H,Z),Ie!=null&&Ut.push(Hc(H,Ie,le))),Js)break;H=H.return}0<Ut.length&&(he=new ve(he,jt,null,o,Ee),Oe.push({event:he,listeners:Ut}))}}if((a&7)===0){e:{if(he=s==="mouseover"||s==="pointerover",ve=s==="mouseout"||s==="pointerout",he&&o!==Ps&&(jt=o.relatedTarget||o.fromElement)&&(xn(jt)||jt[ot]))break e;if((ve||he)&&(he=Ee.window===Ee?Ee:(he=Ee.ownerDocument)?he.defaultView||he.parentWindow:window,ve?(jt=o.relatedTarget||o.toElement,ve=ce,jt=jt?xn(jt):null,jt!==null&&(Js=u(jt),Ut=jt.tag,jt!==Js||Ut!==5&&Ut!==27&&Ut!==6)&&(jt=null)):(ve=null,jt=ce),ve!==jt)){if(Ut=qr,Ie="onMouseLeave",Z="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Ut=fr,Ie="onPointerLeave",Z="onPointerEnter",H="pointer"),Js=ve==null?he:ms(ve),le=jt==null?he:ms(jt),he=new Ut(Ie,H+"leave",ve,o,Ee),he.target=Js,he.relatedTarget=le,Ie=null,xn(Ee)===ce&&(Ut=new Ut(Z,H+"enter",jt,o,Ee),Ut.target=le,Ut.relatedTarget=Js,Ie=Ut),Js=Ie,ve&&jt)t:{for(Ut=Hj,Z=ve,H=jt,le=0,Ie=Z;Ie;Ie=Ut(Ie))le++;Ie=0;for(var Mt=H;Mt;Mt=Ut(Mt))Ie++;for(;0<le-Ie;)Z=Ut(Z),le--;for(;0<Ie-le;)H=Ut(H),Ie--;for(;le--;){if(Z===H||H!==null&&Z===H.alternate){Ut=Z;break t}Z=Ut(Z),H=Ut(H)}Ut=null}else Ut=null;ve!==null&&U0(Oe,he,ve,Ut,!1),jt!==null&&Js!==null&&U0(Oe,Js,jt,Ut,!0)}}e:{if(he=ce?ms(ce):window,ve=he.nodeName&&he.nodeName.toLowerCase(),ve==="select"||ve==="input"&&he.type==="file")var Vs=nb;else if(tb(he))if(rb)Vs=tj;else{Vs=Zk;var Nt=Jk}else ve=he.nodeName,!ve||ve.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?ce&&wn(ce.elementType)&&(Vs=nb):Vs=ej;if(Vs&&(Vs=Vs(s,ce))){sb(Oe,Vs,o,Ee);break e}Nt&&Nt(s,he,ce),s==="focusout"&&ce&&he.type==="number"&&ce.memoizedProps.value!=null&&rt(he,"number",he.value)}switch(Nt=ce?ms(ce):window,s){case"focusin":(tb(Nt)||Nt.contentEditable==="true")&&(ul=Nt,Sm=ce,vc=null);break;case"focusout":vc=Sm=ul=null;break;case"mousedown":Nm=!0;break;case"contextmenu":case"mouseup":case"dragend":Nm=!1,hb(Oe,o,Ee);break;case"selectionchange":if(nj)break;case"keydown":case"keyup":hb(Oe,o,Ee)}var ds;if(qs)e:{switch(s){case"compositionstart":var ws="onCompositionStart";break e;case"compositionend":ws="onCompositionEnd";break e;case"compositionupdate":ws="onCompositionUpdate";break e}ws=void 0}else cl?jo(s,o)&&(ws="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ws="onCompositionStart");ws&&(Da&&o.locale!=="ko"&&(cl||ws!=="onCompositionStart"?ws==="onCompositionEnd"&&cl&&(ds=_o()):(ta=Ee,wo="value"in ta?ta.value:ta.textContent,cl=!0)),Nt=Ud(ce,ws),0<Nt.length&&(ws=new _n(ws,s,null,o,Ee),Oe.push({event:ws,listeners:Nt}),ds?ws.data=ds:(ds=ll(o),ds!==null&&(ws.data=ds)))),(ds=sa?Kk(s,o):Yk(s,o))&&(ws=Ud(ce,"onBeforeInput"),0<ws.length&&(Nt=new _n("onBeforeInput","beforeinput",null,o,Ee),Oe.push({event:Nt,listeners:ws}),Nt.data=ds)),Uj(Oe,s,ce,o,Ee)}B0(Oe,a)})}function Hc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Ud(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Yn(s,o),m!=null&&c.unshift(Hc(s,m,f)),m=Yn(s,a),m!=null&&c.push(Hc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Hj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function U0(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var S=o,F=S.alternate,ce=S.stateNode;if(S=S.tag,F!==null&&F===c)break;S!==5&&S!==26&&S!==27||ce===null||(F=ce,m?(ce=Yn(o,f),ce!=null&&w.unshift(Hc(o,ce,F))):m||(ce=Yn(o,f),ce!=null&&w.push(Hc(o,ce,F)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var $j=/\r\n?/g,Wj=/\u0000|\uFFFD/g;function F0(s){return(typeof s=="string"?s:""+s).replace($j,`
`).replace(Wj,"")}function z0(s,a){return a=F0(a),F0(s)===a}function Xs(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Jt(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Jt(s,""+c);break;case"className":xt(s,"class",c);break;case"tabIndex":xt(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":xt(s,o,c);break;case"style":Es(s,c,f);break;case"data":if(a!=="object"){xt(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=$s(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Xs(s,a,"name",m.name,m,null),Xs(s,a,"formEncType",m.formEncType,m,null),Xs(s,a,"formMethod",m.formMethod,m,null),Xs(s,a,"formTarget",m.formTarget,m,null)):(Xs(s,a,"encType",m.encType,m,null),Xs(s,a,"method",m.method,m,null),Xs(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=$s(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"onScroll":c!=null&&ys("scroll",s);break;case"onScrollEnd":c!=null&&ys("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=$s(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":ys("beforetoggle",s),ys("toggle",s),Vt(s,"popover",c);break;case"xlinkActuate":qt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":qt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":qt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":qt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":qt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":qt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":qt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":qt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":qt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Vt(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Zn.get(o)||o,Vt(s,o,c))}}function ep(s,a,o,c,m,f){switch(o){case"style":Es(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Jt(s,c):(typeof c=="number"||typeof c=="bigint")&&Jt(s,""+c);break;case"onScroll":c!=null&&ys("scroll",s);break;case"onScrollEnd":c!=null&&ys("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!E.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[Et]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):Vt(s,o,c)}}}function or(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ys("error",s),ys("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Xs(s,a,f,w,o,null)}}m&&Xs(s,a,"srcSet",o.srcSet,o,null),c&&Xs(s,a,"src",o.src,o,null);return;case"input":ys("invalid",s);var S=f=w=m=null,F=null,ce=null;for(c in o)if(o.hasOwnProperty(c)){var Ee=o[c];if(Ee!=null)switch(c){case"name":m=Ee;break;case"type":w=Ee;break;case"checked":F=Ee;break;case"defaultChecked":ce=Ee;break;case"value":f=Ee;break;case"defaultValue":S=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(i(137,a));break;default:Xs(s,a,c,Ee,o,null)}}at(s,f,S,F,ce,w,m,!1);return;case"select":ys("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":w=S;break;case"multiple":c=S;default:Xs(s,a,m,S,o,null)}a=f,o=w,s.multiple=!!c,a!=null?mt(s,!!c,a,!1):o!=null&&mt(s,!!c,o,!0);return;case"textarea":ys("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(S=o[w],S!=null))switch(w){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Xs(s,a,w,S,o,null)}Kt(s,c,m,f);return;case"option":for(F in o)o.hasOwnProperty(F)&&(c=o[F],c!=null)&&(F==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Xs(s,a,F,c,o,null));return;case"dialog":ys("beforetoggle",s),ys("toggle",s),ys("cancel",s),ys("close",s);break;case"iframe":case"object":ys("load",s);break;case"video":case"audio":for(c=0;c<qc.length;c++)ys(qc[c],s);break;case"image":ys("error",s),ys("load",s);break;case"details":ys("toggle",s);break;case"embed":case"source":case"link":ys("error",s),ys("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in o)if(o.hasOwnProperty(ce)&&(c=o[ce],c!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Xs(s,a,ce,c,o,null)}return;default:if(wn(a)){for(Ee in o)o.hasOwnProperty(Ee)&&(c=o[Ee],c!==void 0&&ep(s,a,Ee,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Xs(s,a,S,c,o,null))}function Gj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,S=null,F=null,ce=null,Ee=null;for(ve in o){var Oe=o[ve];if(o.hasOwnProperty(ve)&&Oe!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":F=Oe;default:c.hasOwnProperty(ve)||Xs(s,a,ve,null,c,Oe)}}for(var he in c){var ve=c[he];if(Oe=o[he],c.hasOwnProperty(he)&&(ve!=null||Oe!=null))switch(he){case"type":f=ve;break;case"name":m=ve;break;case"checked":ce=ve;break;case"defaultChecked":Ee=ve;break;case"value":w=ve;break;case"defaultValue":S=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(i(137,a));break;default:ve!==Oe&&Xs(s,a,he,ve,c,Oe)}}_e(s,w,S,F,ce,Ee,f,m);return;case"select":ve=w=S=he=null;for(f in o)if(F=o[f],o.hasOwnProperty(f)&&F!=null)switch(f){case"value":break;case"multiple":ve=F;default:c.hasOwnProperty(f)||Xs(s,a,f,null,c,F)}for(m in c)if(f=c[m],F=o[m],c.hasOwnProperty(m)&&(f!=null||F!=null))switch(m){case"value":he=f;break;case"defaultValue":S=f;break;case"multiple":w=f;default:f!==F&&Xs(s,a,m,f,c,F)}a=S,o=w,c=ve,he!=null?mt(s,!!o,he,!1):!!c!=!!o&&(a!=null?mt(s,!!o,a,!0):mt(s,!!o,o?[]:"",!1));return;case"textarea":ve=he=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Xs(s,a,S,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":he=m;break;case"defaultValue":ve=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Xs(s,a,w,m,c,f)}Gt(s,he,ve);return;case"option":for(var jt in o)he=o[jt],o.hasOwnProperty(jt)&&he!=null&&!c.hasOwnProperty(jt)&&(jt==="selected"?s.selected=!1:Xs(s,a,jt,null,c,he));for(F in c)he=c[F],ve=o[F],c.hasOwnProperty(F)&&he!==ve&&(he!=null||ve!=null)&&(F==="selected"?s.selected=he&&typeof he!="function"&&typeof he!="symbol":Xs(s,a,F,he,c,ve));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ut in o)he=o[Ut],o.hasOwnProperty(Ut)&&he!=null&&!c.hasOwnProperty(Ut)&&Xs(s,a,Ut,null,c,he);for(ce in c)if(he=c[ce],ve=o[ce],c.hasOwnProperty(ce)&&he!==ve&&(he!=null||ve!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,a));break;default:Xs(s,a,ce,he,c,ve)}return;default:if(wn(a)){for(var Js in o)he=o[Js],o.hasOwnProperty(Js)&&he!==void 0&&!c.hasOwnProperty(Js)&&ep(s,a,Js,void 0,c,he);for(Ee in c)he=c[Ee],ve=o[Ee],!c.hasOwnProperty(Ee)||he===ve||he===void 0&&ve===void 0||ep(s,a,Ee,he,c,ve);return}}for(var Z in o)he=o[Z],o.hasOwnProperty(Z)&&he!=null&&!c.hasOwnProperty(Z)&&Xs(s,a,Z,null,c,he);for(Oe in c)he=c[Oe],ve=o[Oe],!c.hasOwnProperty(Oe)||he===ve||he==null&&ve==null||Xs(s,a,Oe,he,c,ve)}function q0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,S=m.duration;if(f&&S&&q0(w)){for(w=0,S=m.responseEnd,c+=1;c<o.length;c++){var F=o[c],ce=F.startTime;if(ce>S)break;var Ee=F.transferSize,Oe=F.initiatorType;Ee&&q0(Oe)&&(F=F.responseEnd,w+=Ee*(F<S?1:(S-ce)/(F-ce)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var tp=null,sp=null;function Fd(s){return s.nodeType===9?s:s.ownerDocument}function H0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function np(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var rp=null;function Yj(){var s=window.event;return s&&s.type==="popstate"?s===rp?!1:(rp=s,!0):(rp=null,!1)}var W0=typeof setTimeout=="function"?setTimeout:void 0,Qj=typeof clearTimeout=="function"?clearTimeout:void 0,G0=typeof Promise=="function"?Promise:void 0,Xj=typeof queueMicrotask=="function"?queueMicrotask:typeof G0<"u"?function(s){return G0.resolve(null).then(s).catch(Jj)}:W0;function Jj(s){setTimeout(function(){throw s})}function qi(s){return s==="head"}function K0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Ol(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")$c(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,$c(o);for(var f=o.firstChild;f;){var w=f.nextSibling,S=f.nodeName;f[mn]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&$c(s.ownerDocument.body);o=m}while(o);Ol(a)}function Y0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function ap(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ap(o),rn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Zj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[mn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ca(s.nextSibling),s===null)break}return null}function eT(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ca(s.nextSibling),s===null))return null;return s}function Q0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ca(s.nextSibling),s===null))return null;return s}function ip(s){return s.data==="$?"||s.data==="$~"}function op(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function tT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ca(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var lp=null;function X0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ca(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function J0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function Z0(s,a,o){switch(a=Fd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function $c(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);rn(s)}var ua=new Map,e1=new Set;function zd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var mi=me.d;me.d={f:sT,r:nT,D:rT,C:aT,L:iT,m:oT,X:cT,S:lT,M:uT};function sT(){var s=mi.f(),a=Md();return s||a}function nT(s){var a=ln(s);a!==null&&a.tag===5&&a.type==="form"?yv(a):mi.r(s)}var Dl=typeof document>"u"?null:document;function t1(s,a,o){var c=Dl;if(c&&typeof a=="string"&&a){var m=be(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),e1.has(m)||(e1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),or(a,"link",s),de(a),c.head.appendChild(a)))}}function rT(s){mi.D(s),t1("dns-prefetch",s,null)}function aT(s,a){mi.C(s,a),t1("preconnect",s,a)}function iT(s,a,o){mi.L(s,a,o);var c=Dl;if(c&&s&&a){var m='link[rel="preload"][as="'+be(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+be(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+be(o.imageSizes)+'"]')):m+='[href="'+be(s)+'"]';var f=m;switch(a){case"style":f=Pl(s);break;case"script":f=Ll(s)}ua.has(f)||(s=k({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),ua.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Wc(f))||a==="script"&&c.querySelector(Gc(f))||(a=c.createElement("link"),or(a,"link",s),de(a),c.head.appendChild(a)))}}function oT(s,a){mi.m(s,a);var o=Dl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+be(c)+'"][href="'+be(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Ll(s)}if(!ua.has(f)&&(s=k({rel:"modulepreload",href:s},a),ua.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Gc(f)))return}c=o.createElement("link"),or(c,"link",s),de(c),o.head.appendChild(c)}}}function lT(s,a,o){mi.S(s,a,o);var c=Dl;if(c&&s){var m=$(c).hoistableStyles,f=Pl(s);a=a||"default";var w=m.get(f);if(!w){var S={loading:0,preload:null};if(w=c.querySelector(Wc(f)))S.loading=5;else{s=k({rel:"stylesheet",href:s,"data-precedence":a},o),(o=ua.get(f))&&cp(s,o);var F=w=c.createElement("link");de(F),or(F,"link",s),F._p=new Promise(function(ce,Ee){F.onload=ce,F.onerror=Ee}),F.addEventListener("load",function(){S.loading|=1}),F.addEventListener("error",function(){S.loading|=2}),S.loading|=4,qd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:S},m.set(f,w)}}}function cT(s,a){mi.X(s,a);var o=Dl;if(o&&s){var c=$(o).hoistableScripts,m=Ll(s),f=c.get(m);f||(f=o.querySelector(Gc(m)),f||(s=k({src:s,async:!0},a),(a=ua.get(m))&&up(s,a),f=o.createElement("script"),de(f),or(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function uT(s,a){mi.M(s,a);var o=Dl;if(o&&s){var c=$(o).hoistableScripts,m=Ll(s),f=c.get(m);f||(f=o.querySelector(Gc(m)),f||(s=k({src:s,async:!0,type:"module"},a),(a=ua.get(m))&&up(s,a),f=o.createElement("script"),de(f),or(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function s1(s,a,o,c){var m=(m=Ne.current)?zd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Pl(o.href),o=$(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Pl(o.href);var f=$(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Wc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),ua.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ua.set(s,o),f||dT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ll(o),o=$(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Pl(s){return'href="'+be(s)+'"'}function Wc(s){return'link[rel="stylesheet"]['+s+"]"}function n1(s){return k({},s,{"data-precedence":s.precedence,precedence:null})}function dT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),or(a,"link",o),de(a),s.head.appendChild(a))}function Ll(s){return'[src="'+be(s)+'"]'}function Gc(s){return"script[async]"+s}function r1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+be(o.href)+'"]');if(c)return a.instance=c,de(c),c;var m=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),de(c),or(c,"style",m),qd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Pl(o.href);var f=s.querySelector(Wc(m));if(f)return a.state.loading|=4,a.instance=f,de(f),f;c=n1(o),(m=ua.get(m))&&cp(c,m),f=(s.ownerDocument||s).createElement("link"),de(f);var w=f;return w._p=new Promise(function(S,F){w.onload=S,w.onerror=F}),or(f,"link",c),a.state.loading|=4,qd(f,o.precedence,s),a.instance=f;case"script":return f=Ll(o.src),(m=s.querySelector(Gc(f)))?(a.instance=m,de(m),m):(c=o,(m=ua.get(f))&&(c=k({},o),up(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),de(m),or(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,qd(c,o.precedence,s));return a.instance}function qd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var S=c[w];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function cp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function up(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Hd=null;function a1(s,a,o){if(Hd===null){var c=new Map,m=Hd=new Map;m.set(o,c)}else m=Hd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[mn]||f[ht]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var S=c.get(w);S?S.push(f):c.set(w,[f])}}return c}function i1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function hT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function o1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function mT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Pl(c.href),f=a.querySelector(Wc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=$d.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,de(f);return}f=a.ownerDocument||a,c=n1(c),(m=ua.get(m))&&cp(c,m),f=f.createElement("link"),de(f);var w=f;w._p=new Promise(function(S,F){w.onload=S,w.onerror=F}),or(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=$d.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var dp=0;function fT(s,a){return s.stylesheets&&s.count===0&&Gd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&dp===0&&(dp=62500*Kj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>dp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function $d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Wd=null;function Gd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Wd=new Map,a.forEach(pT,s),Wd=null,$d.call(s))}function pT(s,a){if(!(a.state.loading&4)){var o=Wd.get(s);if(o)var c=o.get(null);else{o=new Map,Wd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=$d.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Kc={$$typeof:te,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function gT(s,a,o,c,m,f,w,S,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qe(0),this.hiddenUpdates=qe(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function l1(s,a,o,c,m,f,w,S,F,ce,Ee,Oe){return s=new gT(s,a,o,w,F,ce,Ee,Oe,S),a=1,f===!0&&(a|=24),f=$r(3,null,null,a),s.current=f,f.stateNode=s,a=qm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Gm(f),s}function c1(s){return s?(s=ml,s):ml}function u1(s,a,o,c,m,f){m=c1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ii(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Mi(s,c,a),o!==null&&(Vr(o,s,a),Ec(o,s,a))}function d1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function hp(s,a){d1(s,a),(s=s.alternate)&&d1(s,a)}function h1(s){if(s.tag===13||s.tag===31){var a=So(s,67108864);a!==null&&Vr(a,s,67108864),hp(s,67108864)}}function m1(s){if(s.tag===13||s.tag===31){var a=Qr();a=U(a);var o=So(s,a);o!==null&&Vr(o,s,a),hp(s,a)}}var Kd=!0;function yT(s,a,o,c){var m=q.T;q.T=null;var f=me.p;try{me.p=2,mp(s,a,o,c)}finally{me.p=f,q.T=m}}function bT(s,a,o,c){var m=q.T;q.T=null;var f=me.p;try{me.p=8,mp(s,a,o,c)}finally{me.p=f,q.T=m}}function mp(s,a,o,c){if(Kd){var m=fp(c);if(m===null)Zf(s,a,c,Yd,o),p1(s,c);else if(xT(m,s,a,o,c))c.stopPropagation();else if(p1(s,c),a&4&&-1<vT.indexOf(s)){for(;m!==null;){var f=ln(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=He(f.pendingLanes);if(w!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;w;){var F=1<<31-Le(w);S.entanglements[1]|=F,w&=~F}Ba(f),(Hs&6)===0&&(Ad=Ft()+500,zc(0))}}break;case 31:case 13:S=So(f,2),S!==null&&Vr(S,f,2),Md(),hp(f,2)}if(f=fp(c),f===null&&Zf(s,a,c,Yd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Zf(s,a,c,null,o)}}function fp(s){return s=an(s),pp(s)}var Yd=null;function pp(s){if(Yd=null,s=xn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Yd=s,null}function f1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(At()){case is:return 2;case Cs:return 8;case ss:case sn:return 32;case Ms:return 268435456;default:return 32}default:return 32}}var gp=!1,Hi=null,$i=null,Wi=null,Yc=new Map,Qc=new Map,Gi=[],vT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p1(s,a){switch(s){case"focusin":case"focusout":Hi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":Yc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qc.delete(a.pointerId)}}function Xc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=ln(a),a!==null&&h1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function xT(s,a,o,c,m){switch(a){case"focusin":return Hi=Xc(Hi,s,a,o,c,m),!0;case"dragenter":return $i=Xc($i,s,a,o,c,m),!0;case"mouseover":return Wi=Xc(Wi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Yc.set(f,Xc(Yc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Qc.set(f,Xc(Qc.get(f)||null,s,a,o,c,m)),!0}return!1}function g1(s){var a=xn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Te(s.priority,function(){m1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Te(s.priority,function(){m1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Qd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=fp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Ps=c,o.target.dispatchEvent(c),Ps=null}else return a=ln(o),a!==null&&h1(a),s.blockedOn=o,!1;a.shift()}return!0}function y1(s,a,o){Qd(s)&&o.delete(a)}function wT(){gp=!1,Hi!==null&&Qd(Hi)&&(Hi=null),$i!==null&&Qd($i)&&($i=null),Wi!==null&&Qd(Wi)&&(Wi=null),Yc.forEach(y1),Qc.forEach(y1)}function Xd(s,a){s.blockedOn===a&&(s.blockedOn=null,gp||(gp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,wT)))}var Jd=null;function b1(s){Jd!==s&&(Jd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Jd===s&&(Jd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(pp(c||o)===null)continue;break}var f=ln(o);f!==null&&(s.splice(a,3),a-=3,ff(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Ol(s){function a(F){return Xd(F,s)}Hi!==null&&Xd(Hi,s),$i!==null&&Xd($i,s),Wi!==null&&Xd(Wi,s),Yc.forEach(a),Qc.forEach(a);for(var o=0;o<Gi.length;o++){var c=Gi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Gi.length&&(o=Gi[0],o.blockedOn===null);)g1(o),o.blockedOn===null&&Gi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[Et]||null;if(typeof f=="function")w||b1(o);else if(w){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[Et]||null)S=w.formAction;else if(pp(m)!==null)continue}else S=w.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),b1(o)}}}function v1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function yp(s){this._internalRoot=s}Zd.prototype.render=yp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Qr();u1(o,c,s,a,null,null)},Zd.prototype.unmount=yp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;u1(s.current,2,null,s,null,null),Md(),a[ot]=null}};function Zd(s){this._internalRoot=s}Zd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Re();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Gi.length&&a!==0&&a<Gi[o].priority;o++);Gi.splice(o,0,s),o===0&&g1(s)}};var x1=e.version;if(x1!=="19.2.4")throw Error(i(527,x1,"19.2.4"));me.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var _T={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eh.isDisabled&&eh.supportsFiber)try{ps=eh.inject(_T),ye=eh}catch{}}return Zc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Sv,f=Nv,w=Cv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=l1(s,1,!1,null,null,o,c,null,m,f,w,v1),s[ot]=a.current,Jf(s),new yp(a)},Zc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Sv,w=Nv,S=Cv,F=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(F=o.formState)),a=l1(s,1,!0,a,o??null,c,m,F,f,w,S,v1),a.context=c1(null),o=a.current,c=Qr(),c=U(c),m=Ii(c),m.callback=null,Mi(o,m,c),o=c,a.current.lanes=o,nt(a,o),Ba(a),s[ot]=a.current,Jf(s),new Zd(a)},Zc.version="19.2.4",Zc}var R1;function IT(){if(R1)return xp.exports;R1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xp.exports=AT(),xp.exports}var MT=IT();const DT="modulepreload",PT=function(n){return"/login/"+n},A1={},Cr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=PT(y),y in A1)return;A1[y]=!0;const x=y.endsWith(".css"),k=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":DT,x||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),x)return new Promise((B,W)=>{j.addEventListener("load",B),j.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var I1="popstate";function LT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return sg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:xu(l)}return BT(e,t,null,n)}function gn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ma(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function OT(){return Math.random().toString(36).substring(2,10)}function M1(n,e){return{usr:n.state,key:n.key,idx:e}}function sg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ic(e):e,state:t,key:e&&e.key||i||OT()}}function xu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ic(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function BT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function k(){p="POP";let L=x(),ee=L==null?null:L-y;y=L,g&&g({action:p,location:V.location,delta:ee})}function j(L,ee){p="PUSH";let Y=sg(V.location,L,ee);y=x()+1;let te=M1(Y,y),we=V.createHref(Y);try{d.pushState(te,"",we)}catch(Ce){if(Ce instanceof DOMException&&Ce.name==="DataCloneError")throw Ce;l.location.assign(we)}u&&g&&g({action:p,location:V.location,delta:1})}function B(L,ee){p="REPLACE";let Y=sg(V.location,L,ee);y=x();let te=M1(Y,y),we=V.createHref(Y);d.replaceState(te,"",we),u&&g&&g({action:p,location:V.location,delta:0})}function W(L){return VT(L)}let V={get action(){return p},get location(){return n(l,d)},listen(L){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(I1,k),g=L,()=>{l.removeEventListener(I1,k),g=null}},createHref(L){return e(l,L)},createURL:W,encodeLocation(L){let ee=W(L);return{pathname:ee.pathname,search:ee.search,hash:ee.hash}},push:j,replace:B,go(L){return d.go(L)}};return V}function VT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),gn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:xu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function L2(n,e,t="/"){return UT(n,e,t,!1)}function UT(n,e,t,i){let l=typeof e=="string"?ic(e):e,u=vi(l.pathname||"/",t);if(u==null)return null;let d=O2(n);FT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=JT(u);p=QT(d[g],y,i)}return p}function O2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;gn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let k=gi([i,x.relativePath]),j=t.concat(x);d.children&&d.children.length>0&&(gn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),O2(d.children,e,j,k,g)),!(d.path==null&&!d.index)&&e.push({path:k,score:KT(k,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of B2(d.path))u(d,p,!0,g)}),e}function B2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=B2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function FT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:YT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var zT=/^:[\w-]+$/,qT=3,HT=2,$T=1,WT=10,GT=-2,D1=n=>n==="*";function KT(n,e){let t=n.split("/"),i=t.length;return t.some(D1)&&(i+=GT),e&&(i+=HT),t.filter(l=>!D1(l)).reduce((l,u)=>l+(zT.test(u)?qT:u===""?$T:WT),i)}function YT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function QT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",k=Nh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),j=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=Nh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:gi([u,k.pathname]),pathnameBase:sE(gi([u,k.pathnameBase])),route:j}),k.pathnameBase!=="/"&&(u=gi([u,k.pathnameBase]))}return d}function Nh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=XT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:k},j)=>{if(x==="*"){let W=p[j]||"";d=u.slice(0,u.length-W.length).replace(/(.)\/+$/,"$1")}const B=p[j];return k&&!B?y[x]=void 0:y[x]=(B||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function XT(n,e=!1,t=!0){ma(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function JT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ma(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function vi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var ZT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function eE(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?ic(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=P1(t.substring(1),"/"):u=P1(t,e)):u=e,{pathname:u,search:nE(i),hash:rE(l)}}function P1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function jp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Pg(n){let e=tE(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Lg(n,e,t,i=!1){let l;typeof n=="string"?l=ic(n):(l={...n},gn(!l.pathname||!l.pathname.includes("?"),jp("?","pathname","search",l)),gn(!l.pathname||!l.pathname.includes("#"),jp("#","pathname","hash",l)),gn(!l.search||!l.search.includes("#"),jp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),k-=1;l.pathname=j.join("/")}p=k>=0?e[k]:"/"}let g=eE(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var gi=n=>n.join("/").replace(/\/\/+/g,"/"),sE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),nE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,rE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,aE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function iE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function oE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var V2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function U2(n,e){let t=n;if(typeof t!="string"||!ZT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(V2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=vi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ma(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var F2=["POST","PUT","PATCH","DELETE"];new Set(F2);var lE=["GET",...F2];new Set(lE);var oc=v.createContext(null);oc.displayName="DataRouter";var Jh=v.createContext(null);Jh.displayName="DataRouterState";var cE=v.createContext(!1),z2=v.createContext({isTransitioning:!1});z2.displayName="ViewTransition";var uE=v.createContext(new Map);uE.displayName="Fetchers";var dE=v.createContext(null);dE.displayName="Await";var Zr=v.createContext(null);Zr.displayName="Navigation";var Mu=v.createContext(null);Mu.displayName="Location";var Ra=v.createContext({outlet:null,matches:[],isDataRoute:!1});Ra.displayName="Route";var Og=v.createContext(null);Og.displayName="RouteError";var q2="REACT_ROUTER_ERROR",hE="REDIRECT",mE="ROUTE_ERROR_RESPONSE";function fE(n){if(n.startsWith(`${q2}:${hE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function pE(n){if(n.startsWith(`${q2}:${mE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new aE(e.status,e.statusText,e.data)}catch{}}function gE(n,{relative:e}={}){gn(lc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Zr),{hash:l,pathname:u,search:d}=Du(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:gi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function lc(){return v.useContext(Mu)!=null}function Aa(){return gn(lc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Mu).location}var H2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $2(n){v.useContext(Zr).static||v.useLayoutEffect(n)}function dr(){let{isDataRoute:n}=v.useContext(Ra);return n?RE():yE()}function yE(){gn(lc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(oc),{basename:e,navigator:t}=v.useContext(Zr),{matches:i}=v.useContext(Ra),{pathname:l}=Aa(),u=JSON.stringify(Pg(i)),d=v.useRef(!1);return $2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(ma(d.current,H2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Lg(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:gi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}v.createContext(null);function bE(){let{matches:n}=v.useContext(Ra),e=n[n.length-1];return e?e.params:{}}function Du(n,{relative:e}={}){let{matches:t}=v.useContext(Ra),{pathname:i}=Aa(),l=JSON.stringify(Pg(t));return v.useMemo(()=>Lg(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function vE(n,e){return W2(n,e)}function W2(n,e,t,i,l){gn(lc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Zr),{matches:d}=v.useContext(Ra),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",k=p&&p.route;{let Y=k&&k.path||"";K2(y,!k||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let j=Aa(),B;if(e){let Y=typeof e=="string"?ic(e):e;gn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),B=Y}else B=j;let W=B.pathname||"/",V=W;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");V="/"+W.replace(/^\//,"").split("/").slice(Y.length).join("/")}let L=L2(n,{pathname:V});ma(k||L!=null,`No routes matched location "${B.pathname}${B.search}${B.hash}" `),ma(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${B.pathname}${B.search}${B.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ee=jE(L&&L.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:gi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:gi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&ee?v.createElement(Mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...B},navigationType:"POP"}},ee):ee}function xE(){let n=CE(),e=iE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var wE=v.createElement(xE,null),G2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=pE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(Ra.Provider,{value:this.props.routeContext},v.createElement(Og.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(_E,{error:n},e):e}};G2.contextType=cE;var Tp=new WeakMap;function _E({children:n,error:e}){let{basename:t}=v.useContext(Zr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=fE(e.digest);if(i){let l=Tp.get(e);if(l)throw l;let u=U2(i.location,t);if(V2&&!Tp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Tp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function kE({routeContext:n,match:e,children:t}){let i=v.useContext(oc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(Ra.Provider,{value:n},t)}function jE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);gn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let k=u[x];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=x),k.route.id){let{loaderData:j,errors:B}=t,W=k.route.loader&&!j.hasOwnProperty(k.route.id)&&(!B||B[k.route.id]===void 0);if(k.route.lazy||W){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,k)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:oE(t.matches),errorInfo:k})}:void 0;return u.reduceRight((x,k,j)=>{let B,W=!1,V=null,L=null;t&&(B=d&&k.route.id?d[k.route.id]:void 0,V=k.route.errorElement||wE,p&&(g<0&&j===0?(K2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),W=!0,L=null):g===j&&(W=!0,L=k.route.hydrateFallbackElement||null)));let ee=e.concat(u.slice(0,j+1)),Y=()=>{let te;return B?te=V:W?te=L:k.route.Component?te=v.createElement(k.route.Component,null):k.route.element?te=k.route.element:te=x,v.createElement(kE,{match:k,routeContext:{outlet:x,matches:ee,isDataRoute:t!=null},children:te})};return t&&(k.route.ErrorBoundary||k.route.errorElement||j===0)?v.createElement(G2,{location:t.location,revalidation:t.revalidation,component:V,error:B,children:Y(),routeContext:{outlet:null,matches:ee,isDataRoute:!0},onError:y}):Y()},null)}function Bg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TE(n){let e=v.useContext(oc);return gn(e,Bg(n)),e}function EE(n){let e=v.useContext(Jh);return gn(e,Bg(n)),e}function SE(n){let e=v.useContext(Ra);return gn(e,Bg(n)),e}function Vg(n){let e=SE(n),t=e.matches[e.matches.length-1];return gn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function NE(){return Vg("useRouteId")}function CE(){let n=v.useContext(Og),e=EE("useRouteError"),t=Vg("useRouteError");return n!==void 0?n:e.errors?.[t]}function RE(){let{router:n}=TE("useNavigate"),e=Vg("useNavigate"),t=v.useRef(!1);return $2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{ma(t.current,H2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var L1={};function K2(n,e,t){!e&&!L1[n]&&(L1[n]=!0,ma(!1,t))}v.memo(AE);function AE({routes:n,future:e,state:t,onError:i}){return W2(n,void 0,t,i,e)}function Y2({to:n,replace:e,state:t,relative:i}){gn(lc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Zr);ma(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(Ra),{pathname:d}=Aa(),p=dr(),g=Lg(n,Pg(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function tn(n){gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function IE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){gn(!lc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=ic(t));let{pathname:y="/",search:x="",hash:k="",state:j=null,key:B="default"}=t,W=v.useMemo(()=>{let V=vi(y,p);return V==null?null:{location:{pathname:V,search:x,hash:k,state:j,key:B},navigationType:i}},[p,y,x,k,j,B,i]);return ma(W!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${k}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:v.createElement(Zr.Provider,{value:g},v.createElement(Mu.Provider,{children:e,value:W}))}function ME({children:n,location:e}){return vE(ng(n),e)}function ng(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,ng(i.props.children,u));return}gn(i.type===tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ng(i.props.children,u)),t.push(d)}),t}var gh="get",yh="application/x-www-form-urlencoded";function Zh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function DE(n){return Zh(n)&&n.tagName.toLowerCase()==="button"}function PE(n){return Zh(n)&&n.tagName.toLowerCase()==="form"}function LE(n){return Zh(n)&&n.tagName.toLowerCase()==="input"}function OE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function BE(n,e){return n.button===0&&(!e||e==="_self")&&!OE(n)}function rg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function VE(n,e){let t=rg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var th=null;function UE(){if(th===null)try{new FormData(document.createElement("form"),0),th=!1}catch{th=!0}return th}var FE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ep(n){return n!=null&&!FE.has(n)?(ma(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yh}"`),null):n}function zE(n,e){let t,i,l,u,d;if(PE(n)){let p=n.getAttribute("action");i=p?vi(p,e):null,t=n.getAttribute("method")||gh,l=Ep(n.getAttribute("enctype"))||yh,u=new FormData(n)}else if(DE(n)||LE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?vi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||gh,l=Ep(n.getAttribute("formenctype"))||Ep(p.getAttribute("enctype"))||yh,u=new FormData(p,n),!UE()){let{name:y,type:x,value:k}=n;if(x==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,k)}}else{if(Zh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=gh,i=null,l=yh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ug(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&vi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function HE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $E(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function WE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await HE(u,t);return d.links?d.links():[]}return[]}));return QE(i.flat(1).filter($E).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function O1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function GE(n,e,{includeHydrateFallback:t}={}){return KE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function KE(n){return[...new Set(n)]}function YE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function QE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(YE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Q2(){let n=v.useContext(oc);return Ug(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function XE(){let n=v.useContext(Jh);return Ug(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Fg=v.createContext(void 0);Fg.displayName="FrameworkContext";function X2(){let n=v.useContext(Fg);return Ug(n,"You must render this element inside a <HydratedRouter> element"),n}function JE(n,e){let t=v.useContext(Fg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:k}=e,j=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=ee=>{ee.forEach(Y=>{d(Y.isIntersecting)})},L=new IntersectionObserver(V,{threshold:.5});return j.current&&L.observe(j.current),()=>{L.disconnect()}}},[n]),v.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let B=()=>{l(!0)},W=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:eu(p,B),onBlur:eu(g,W),onMouseEnter:eu(y,B),onMouseLeave:eu(x,W),onTouchStart:eu(k,B)}]:[!1,j,{}]}function eu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function ZE({page:n,...e}){let{router:t}=Q2(),i=v.useMemo(()=>L2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(tS,{page:n,matches:i,...e}):null}function eS(n){let{manifest:e,routeModules:t}=X2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return WE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function tS({page:n,matches:e,...t}){let i=Aa(),{future:l,manifest:u,routeModules:d}=X2(),{basename:p}=Q2(),{loaderData:g,matches:y}=XE(),x=v.useMemo(()=>O1(n,e,y,u,i,"data"),[n,e,y,u,i]),k=v.useMemo(()=>O1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,L=!1;if(e.forEach(Y=>{let te=u.routes[Y.route.id];!te||!te.hasLoader||(!x.some(we=>we.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||te.hasClientLoader?L=!0:V.add(Y.route.id))}),V.size===0)return[];let ee=qE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return L&&V.size>0&&ee.searchParams.set("_routes",e.filter(Y=>V.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[ee.pathname+ee.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),B=v.useMemo(()=>GE(k,u),[k,u]),W=eS(k);return v.createElement(v.Fragment,null,j.map(V=>v.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),B.map(V=>v.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),W.map(({key:V,link:L})=>v.createElement("link",{key:V,nonce:t.nonce,...L,crossOrigin:L.crossOrigin??t.crossOrigin})))}function sS(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var nS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nS&&(window.__reactRouterVersion="7.13.0")}catch{}function rS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=LT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(IE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var J2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Z2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:j,...B},W){let{basename:V,unstable_useTransitions:L}=v.useContext(Zr),ee=typeof y=="string"&&J2.test(y),Y=U2(y,V);y=Y.to;let te=gE(y,{relative:l}),[we,Ce,xe]=JE(i,B),C=lS(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:j,unstable_useTransitions:L});function T(O){e&&e(O),O.defaultPrevented||C(O)}let A=v.createElement("a",{...B,...xe,href:Y.absoluteURL||te,onClick:Y.isExternal||u?e:T,ref:sS(W,Ce),target:g,"data-discover":!ee&&t==="render"?"true":void 0});return we&&!ee?v.createElement(v.Fragment,null,A,v.createElement(ZE,{page:te})):A});Z2.displayName="Link";var aS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let k=Du(d,{relative:y.relative}),j=Aa(),B=v.useContext(Jh),{navigator:W,basename:V}=v.useContext(Zr),L=B!=null&&fS(k)&&p===!0,ee=W.encodeLocation?W.encodeLocation(k).pathname:k.pathname,Y=j.pathname,te=B&&B.navigation&&B.navigation.location?B.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),te=te?te.toLowerCase():null,ee=ee.toLowerCase()),te&&V&&(te=vi(te,V)||te);const we=ee!=="/"&&ee.endsWith("/")?ee.length-1:ee.length;let Ce=Y===ee||!l&&Y.startsWith(ee)&&Y.charAt(we)==="/",xe=te!=null&&(te===ee||!l&&te.startsWith(ee)&&te.charAt(ee.length)==="/"),C={isActive:Ce,isPending:xe,isTransitioning:L},T=Ce?e:void 0,A;typeof i=="function"?A=i(C):A=[i,Ce?"active":null,xe?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let O=typeof u=="function"?u(C):u;return v.createElement(Z2,{...y,"aria-current":T,className:A,ref:x,style:O,to:d,viewTransition:p},typeof g=="function"?g(C):g)});aS.displayName="NavLink";var iS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=gh,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:j,...B},W)=>{let{unstable_useTransitions:V}=v.useContext(Zr),L=hS(),ee=mS(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",te=typeof p=="string"&&J2.test(p),we=Ce=>{if(g&&g(Ce),Ce.defaultPrevented)return;Ce.preventDefault();let xe=Ce.nativeEvent.submitter,C=xe?.getAttribute("formmethod")||d,T=()=>L(xe||Ce.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:j});V&&t!==!1?v.startTransition(()=>T()):T()};return v.createElement("form",{ref:W,method:Y,action:ee,onSubmit:i?g:we,...B,"data-discover":!te&&n==="render"?"true":void 0})});iS.displayName="Form";function oS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ew(n){let e=v.useContext(oc);return gn(e,oS(n)),e}function lS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=dr(),x=Aa(),k=Du(n,{relative:u});return v.useCallback(j=>{if(BE(j,e)){j.preventDefault();let B=t!==void 0?t:xu(x)===xu(k),W=()=>y(n,{replace:B,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>W()):W()}},[x,y,k,t,i,e,n,l,u,d,p,g])}function cS(n){ma(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(rg(n)),t=v.useRef(!1),i=Aa(),l=v.useMemo(()=>VE(i.search,t.current?null:e.current),[i.search]),u=dr(),d=v.useCallback((p,g)=>{const y=rg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var uS=0,dS=()=>`__${String(++uS)}__`;function hS(){let{router:n}=ew("useSubmit"),{basename:e}=v.useContext(Zr),t=NE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:k}=zE(u,e);if(d.navigate===!1){let j=d.fetcherKey||dS();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:k,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:k,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function mS(n,{relative:e}={}){let{basename:t}=v.useContext(Zr),i=v.useContext(Ra);gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Du(n||".",{relative:e})},d=Aa();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:gi([t,u.pathname])),xu(u)}function fS(n,{relative:e}={}){let t=v.useContext(z2);gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=ew("useViewTransitionState"),l=Du(n,{relative:e});if(!t.isTransitioning)return!1;let u=vi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=vi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Nh(l.pathname,d)!=null||Nh(l.pathname,u)!=null}const pS=()=>{};var B1={};const tw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},gS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},sw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,k=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,B=y&63;g||(B=64,d||(j=64)),i.push(t[x],t[k],t[j],t[B])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(tw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const k=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new yS;const j=u<<2|p>>4;if(i.push(j),y!==64){const B=p<<4&240|y>>2;if(i.push(B),k!==64){const W=y<<6&192|k;i.push(W)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bS=function(n){const e=tw(n);return sw.encodeByteArray(e,!0)},Ch=function(n){return bS(n).replace(/\./g,"")},nw=function(n){try{return sw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const xS=()=>vS().__FIREBASE_DEFAULTS__,wS=()=>{if(typeof process>"u"||typeof B1>"u")return;const n=B1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_S=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&nw(n[1]);return e&&JSON.parse(e)},em=()=>{try{return pS()||xS()||wS()||_S()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},rw=n=>em()?.emulatorHosts?.[n],aw=n=>{const e=rw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},iw=()=>em()?.config,ow=n=>em()?.[`_${n}`];class kS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function yo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zg(n){return(await fetch(n,{credentials:"include"})).ok}function lw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ch(JSON.stringify(t)),Ch(JSON.stringify(d)),""].join(".")}const mu={};function jS(){const n={prod:[],emulator:[]};for(const e of Object.keys(mu))mu[e]?n.emulator.push(e):n.prod.push(e);return n}function TS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let V1=!1;function qg(n,e){if(typeof window>"u"||typeof document>"u"||!yo(window.location.host)||mu[n]===e||mu[n]||V1)return;mu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=jS().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,B){j.setAttribute("width","24"),j.setAttribute("id",B),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{V1=!0,d()},j}function x(j,B){j.setAttribute("id",B),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function k(){const j=TS(i),B=t("text"),W=document.getElementById(B)||document.createElement("span"),V=t("learnmore"),L=document.getElementById(V)||document.createElement("a"),ee=t("preprendIcon"),Y=document.getElementById(ee)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const te=j.element;p(te),x(L,V);const we=y();g(Y,ee),te.append(Y,W,L,we),document.body.appendChild(te)}u?(W.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,W.innerText="Preview backend running in this workspace."),W.setAttribute("id",B)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function xr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ES(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xr())}function SS(){const n=em()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AS(){const n=xr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function IS(){return!SS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MS(){try{return typeof indexedDB=="object"}catch{return!1}}function DS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const PS="FirebaseError";class Qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=PS,Object.setPrototypeOf(this,Qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pu.prototype.create)}}class Pu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?LS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Qa(l,p,i)}}function LS(n,e){return n.replace(OS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const OS=/\{\$([^}]+)}/g;function BS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(U1(u)&&U1(d)){if(!Xo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function U1(n){return n!==null&&typeof n=="object"}function Lu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ou(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function lu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function VS(n,e){const t=new US(n,e);return t.subscribe.bind(t)}class US{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FS(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Sp),l.error===void 0&&(l.error=Sp),l.complete===void 0&&(l.complete=Sp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Sp(){}function Zs(n){return n&&n._delegate?n._delegate:n}class co{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ho="[DEFAULT]";class zS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new kS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HS(e))try{this.getOrInitializeService({instanceIdentifier:Ho})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ho){return this.instances.has(e)}getOptions(e=Ho){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ho){return this.component?this.component.multipleInstances?e:Ho:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qS(n){return n===Ho?void 0:n}function HS(n){return n.instantiationMode==="EAGER"}class $S{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var _s;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_s||(_s={}));const WS={debug:_s.DEBUG,verbose:_s.VERBOSE,info:_s.INFO,warn:_s.WARN,error:_s.ERROR,silent:_s.SILENT},GS=_s.INFO,KS={[_s.DEBUG]:"log",[_s.VERBOSE]:"log",[_s.INFO]:"info",[_s.WARN]:"warn",[_s.ERROR]:"error"},YS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=KS[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hg{constructor(e){this.name=e,this._logLevel=GS,this._logHandler=YS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _s))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_s.DEBUG,...e),this._logHandler(this,_s.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_s.VERBOSE,...e),this._logHandler(this,_s.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_s.INFO,...e),this._logHandler(this,_s.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_s.WARN,...e),this._logHandler(this,_s.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_s.ERROR,...e),this._logHandler(this,_s.ERROR,...e)}}const QS=(n,e)=>e.some(t=>n instanceof t);let F1,z1;function XS(){return F1||(F1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JS(){return z1||(z1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cw=new WeakMap,ag=new WeakMap,uw=new WeakMap,Np=new WeakMap,$g=new WeakMap;function ZS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(ao(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&cw.set(t,n)}).catch(()=>{}),$g.set(e,n),e}function eN(n){if(ag.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ag.set(n,e)}let ig={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ag.get(n);if(e==="objectStoreNames")return n.objectStoreNames||uw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ao(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function tN(n){ig=n(ig)}function sN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Cp(this),e,...t);return uw.set(i,e.sort?e.sort():[e]),ao(i)}:JS().includes(n)?function(...e){return n.apply(Cp(this),e),ao(cw.get(this))}:function(...e){return ao(n.apply(Cp(this),e))}}function nN(n){return typeof n=="function"?sN(n):(n instanceof IDBTransaction&&eN(n),QS(n,XS())?new Proxy(n,ig):n)}function ao(n){if(n instanceof IDBRequest)return ZS(n);if(Np.has(n))return Np.get(n);const e=nN(n);return e!==n&&(Np.set(n,e),$g.set(e,n)),e}const Cp=n=>$g.get(n);function rN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=ao(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ao(d.result),g.oldVersion,g.newVersion,ao(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const aN=["get","getKey","getAll","getAllKeys","count"],iN=["put","add","delete","clear"],Rp=new Map;function q1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rp.get(e))return Rp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=iN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||aN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Rp.set(e,u),u}tN(n=>({...n,get:(e,t,i)=>q1(e,t)||n.get(e,t,i),has:(e,t)=>!!q1(e,t)||n.has(e,t)}));class oN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lN(n){return n.getComponent()?.type==="VERSION"}const og="@firebase/app",H1="0.14.7";const xi=new Hg("@firebase/app"),cN="@firebase/app-compat",uN="@firebase/analytics-compat",dN="@firebase/analytics",hN="@firebase/app-check-compat",mN="@firebase/app-check",fN="@firebase/auth",pN="@firebase/auth-compat",gN="@firebase/database",yN="@firebase/data-connect",bN="@firebase/database-compat",vN="@firebase/functions",xN="@firebase/functions-compat",wN="@firebase/installations",_N="@firebase/installations-compat",kN="@firebase/messaging",jN="@firebase/messaging-compat",TN="@firebase/performance",EN="@firebase/performance-compat",SN="@firebase/remote-config",NN="@firebase/remote-config-compat",CN="@firebase/storage",RN="@firebase/storage-compat",AN="@firebase/firestore",IN="@firebase/ai",MN="@firebase/firestore-compat",DN="firebase",PN="12.8.0";const lg="[DEFAULT]",LN={[og]:"fire-core",[cN]:"fire-core-compat",[dN]:"fire-analytics",[uN]:"fire-analytics-compat",[mN]:"fire-app-check",[hN]:"fire-app-check-compat",[fN]:"fire-auth",[pN]:"fire-auth-compat",[gN]:"fire-rtdb",[yN]:"fire-data-connect",[bN]:"fire-rtdb-compat",[vN]:"fire-fn",[xN]:"fire-fn-compat",[wN]:"fire-iid",[_N]:"fire-iid-compat",[kN]:"fire-fcm",[jN]:"fire-fcm-compat",[TN]:"fire-perf",[EN]:"fire-perf-compat",[SN]:"fire-rc",[NN]:"fire-rc-compat",[CN]:"fire-gcs",[RN]:"fire-gcs-compat",[AN]:"fire-fst",[MN]:"fire-fst-compat",[IN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Rh=new Map,ON=new Map,cg=new Map;function $1(n,e){try{n.container.addComponent(e)}catch(t){xi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Jo(n){const e=n.name;if(cg.has(e))return xi.debug(`There were multiple attempts to register component ${e}.`),!1;cg.set(e,n);for(const t of Rh.values())$1(t,n);for(const t of ON.values())$1(t,n);return!0}function tm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Xr(n){return n==null?!1:n.settings!==void 0}const BN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new Pu("app","Firebase",BN);class VN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new co("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}const al=PN;function Wg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:lg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw io.create("bad-app-name",{appName:String(l)});if(t||(t=iw()),!t)throw io.create("no-options");const u=Rh.get(l);if(u){if(Xo(t,u.options)&&Xo(i,u.config))return u;throw io.create("duplicate-app",{appName:l})}const d=new $S(l);for(const g of cg.values())d.addComponent(g);const p=new VN(t,i,d);return Rh.set(l,p),p}function Gg(n=lg){const e=Rh.get(n);if(!e&&n===lg&&iw())return Wg();if(!e)throw io.create("no-app",{appName:n});return e}function za(n,e,t){let i=LN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xi.warn(d.join(" "));return}Jo(new co(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UN="firebase-heartbeat-database",FN=1,wu="firebase-heartbeat-store";let Ap=null;function dw(){return Ap||(Ap=rN(UN,FN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wu)}catch(t){console.warn(t)}}}}).catch(n=>{throw io.create("idb-open",{originalErrorMessage:n.message})})),Ap}async function zN(n){try{const t=(await dw()).transaction(wu),i=await t.objectStore(wu).get(hw(n));return await t.done,i}catch(e){if(e instanceof Qa)xi.warn(e.message);else{const t=io.create("idb-get",{originalErrorMessage:e?.message});xi.warn(t.message)}}}async function W1(n,e){try{const i=(await dw()).transaction(wu,"readwrite");await i.objectStore(wu).put(e,hw(n)),await i.done}catch(t){if(t instanceof Qa)xi.warn(t.message);else{const i=io.create("idb-set",{originalErrorMessage:t?.message});xi.warn(i.message)}}}function hw(n){return`${n.name}!${n.options.appId}`}const qN=1024,HN=30;class $N{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=G1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>HN){const l=KN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=G1(),{heartbeatsToSend:t,unsentEntries:i}=WN(this._heartbeatsCache.heartbeats),l=Ch(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return xi.warn(e),""}}}function G1(){return new Date().toISOString().substring(0,10)}function WN(n,e=qN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),K1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),K1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MS()?DS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function K1(n){return Ch(JSON.stringify({version:2,heartbeats:n})).length}function KN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function YN(n){Jo(new co("platform-logger",e=>new oN(e),"PRIVATE")),Jo(new co("heartbeat",e=>new $N(e),"PRIVATE")),za(og,H1,n),za(og,H1,"esm2020"),za("fire-js","")}YN("");function mw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QN=mw,fw=new Pu("auth","Firebase",mw());const Ah=new Hg("@firebase/auth");function XN(n,...e){Ah.logLevel<=_s.WARN&&Ah.warn(`Auth (${al}): ${n}`,...e)}function bh(n,...e){Ah.logLevel<=_s.ERROR&&Ah.error(`Auth (${al}): ${n}`,...e)}function Sa(n,...e){throw Kg(n,...e)}function qa(n,...e){return Kg(n,...e)}function pw(n,e,t){const i={...QN(),[e]:t};return new Pu("auth","Firebase",i).create(e,{appName:n.name})}function yi(n){return pw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Kg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return fw.create(n,...e)}function $t(n,e,...t){if(!n)throw Kg(e,...t)}function fi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw bh(e),new Error(e)}function wi(n,e){n||fi(e)}function ug(){return typeof self<"u"&&self.location?.href||""}function JN(){return Y1()==="http:"||Y1()==="https:"}function Y1(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||CS()||"connection"in navigator)?navigator.onLine:!0}function eC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,wi(t>e,"Short delay should be less than long delay!"),this.isMobile=ES()||RS()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Yg(n,e){wi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class gw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const sC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nC=new Ou(3e4,6e4);function ji(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ti(n,e,t,i,l={}){return yw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Lu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return NS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&yo(n.emulatorConfig.host)&&(y.credentials="include"),gw.fetch()(await bw(n,n.config.apiHost,t,p),y)})}async function yw(n,e,t){n._canInitEmulator=!1;const i={...tC,...e};try{const l=new aC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw sh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw sh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw sh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw sh(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw pw(n,x,y);Sa(n,x)}}catch(l){if(l instanceof Qa)throw l;Sa(n,"network-request-failed",{message:String(l)})}}async function Bu(n,e,t,i,l={}){const u=await Ti(n,e,t,i,l);return"mfaPendingCredential"in u&&Sa(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function bw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Yg(n.config,l):`${n.config.apiScheme}://${l}`;return sC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(qa(this.auth,"network-request-failed")),nC.get())})}}function sh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=qa(n,e,i);return l.customData._tokenResponse=t,l}function Q1(n){return n!==void 0&&n.enterprise!==void 0}class iC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oC(n,e){return Ti(n,"GET","/v2/recaptchaConfig",ji(n,e))}async function lC(n,e){return Ti(n,"POST","/v1/accounts:delete",e)}async function Ih(n,e){return Ti(n,"POST","/v1/accounts:lookup",e)}function fu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cC(n,e=!1){const t=Zs(n),i=await t.getIdToken(e),l=Qg(i);$t(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:fu(Ip(l.auth_time)),issuedAtTime:fu(Ip(l.iat)),expirationTime:fu(Ip(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ip(n){return Number(n)*1e3}function Qg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return bh("JWT malformed, contained fewer than 3 sections"),null;try{const l=nw(t);return l?JSON.parse(l):(bh("Failed to decode base64 JWT payload"),null)}catch(l){return bh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function X1(n){const e=Qg(n);return $t(e,"internal-error"),$t(typeof e.exp<"u","internal-error"),$t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Qa&&uC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function uC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class dC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mh(n){const e=n.auth,t=await n.getIdToken(),i=await _u(n,Ih(e,{idToken:t}));$t(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?vw(l.providerUserInfo):[],d=mC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function hC(n){const e=Zs(n);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function vw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function fC(n,e){const t=await yw(n,{},async()=>{const i=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await bw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&yo(n.emulatorConfig.host)&&(g.credentials="include"),gw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pC(n,e){return Ti(n,"POST","/v2/accounts:revokeToken",ji(n,e))}class Yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$t(e.idToken,"internal-error"),$t(typeof e.idToken<"u","internal-error"),$t(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):X1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$t(e.length!==0,"internal-error");const t=X1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await fC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Yl;return i&&($t(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&($t(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&($t(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yl,this.toJSON())}_performRefresh(){return fi("not implemented")}}function Yi(n,e){$t(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ta{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new dg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await _u(this,this.stsTokenManager.getToken(this.auth,e));return $t(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cC(this,e)}reload(){return hC(this)}_assign(e){this!==e&&($t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ta({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){$t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Mh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xr(this.auth.app))return Promise.reject(yi(this.auth));const e=await this.getIdToken();return await _u(this,lC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:k,emailVerified:j,isAnonymous:B,providerData:W,stsTokenManager:V}=t;$t(k&&V,e,"internal-error");const L=Yl.fromJSON(this.name,V);$t(typeof k=="string",e,"internal-error"),Yi(i,e.name),Yi(l,e.name),$t(typeof j=="boolean",e,"internal-error"),$t(typeof B=="boolean",e,"internal-error"),Yi(u,e.name),Yi(d,e.name),Yi(p,e.name),Yi(g,e.name),Yi(y,e.name),Yi(x,e.name);const ee=new Ta({uid:k,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:B,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:L,createdAt:y,lastLoginAt:x});return W&&Array.isArray(W)&&(ee.providerData=W.map(Y=>({...Y}))),g&&(ee._redirectEventId=g),ee}static async _fromIdTokenResponse(e,t,i=!1){const l=new Yl;l.updateFromServerResponse(t);const u=new Ta({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Mh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];$t(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?vw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Yl;p.updateFromIdToken(i);const g=new Ta({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const J1=new Map;function pi(n){wi(n instanceof Function,"Expected a class definition");let e=J1.get(n);return e?(wi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,J1.set(n,e),e)}class xw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}xw.type="NONE";const Z1=xw;function vh(n,e,t){return`firebase:${n}:${e}:${t}`}class Ql{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=vh(this.userKey,l.apiKey,u),this.fullPersistenceKey=vh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ih(this.auth,{idToken:e}).catch(()=>{});return t?Ta._fromGetAccountInfoResponse(this.auth,t,e):null}return Ta._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ql(pi(Z1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||pi(Z1);const d=vh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let k;if(typeof x=="string"){const j=await Ih(e,{idToken:x}).catch(()=>{});if(!j)break;k=await Ta._fromGetAccountInfoResponse(e,j,x)}else k=Ta._fromJSON(e,x);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Ql(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Ql(u,e,i))}}function ex(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ww(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ew(e))return"Blackberry";if(Sw(e))return"Webos";if(_w(e))return"Safari";if((e.includes("chrome/")||kw(e))&&!e.includes("edge/"))return"Chrome";if(Tw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function ww(n=xr()){return/firefox\//i.test(n)}function _w(n=xr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kw(n=xr()){return/crios\//i.test(n)}function jw(n=xr()){return/iemobile/i.test(n)}function Tw(n=xr()){return/android/i.test(n)}function Ew(n=xr()){return/blackberry/i.test(n)}function Sw(n=xr()){return/webos/i.test(n)}function Xg(n=xr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function gC(n=xr()){return Xg(n)&&!!window.navigator?.standalone}function yC(){return AS()&&document.documentMode===10}function Nw(n=xr()){return Xg(n)||Tw(n)||Sw(n)||Ew(n)||/windows phone/i.test(n)||jw(n)}function Cw(n,e=[]){let t;switch(n){case"Browser":t=ex(xr());break;case"Worker":t=`${ex(xr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${al}/${i}`}class bC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function vC(n,e={}){return Ti(n,"GET","/v2/passwordPolicy",ji(n,e))}const xC=6;class wC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _C{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tx(this),this.idTokenSubscription=new tx(this),this.beforeStateQueue=new bC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ql.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ih(this,{idToken:e}),i=await Ta._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Xr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xr(this.app))return Promise.reject(yi(this));const t=e?Zs(e):null;return t&&$t(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xr(this.app)?Promise.reject(yi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xr(this.app)?Promise.reject(yi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vC(this),t=new wC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await pC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pi(e)||this._popupRedirectResolver;$t(t,this,"argument-error"),this.redirectPersistenceManager=await Ql.create(this,[pi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if($t(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function bo(n){return Zs(n)}class tx{constructor(e){this.auth=e,this.observer=null,this.addObserver=VS(t=>this.observer=t)}get next(){return $t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kC(n){sm=n}function Rw(n){return sm.loadJS(n)}function jC(){return sm.recaptchaEnterpriseScript}function TC(){return sm.gapiScript}function EC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class SC{constructor(){this.enterprise=new NC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class NC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const CC="recaptcha-enterprise",Aw="NO_RECAPTCHA";class RC{constructor(e){this.type=CC,this.auth=bo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{oC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new iC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Q1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Aw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Q1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=jC();g.length!==0&&(g+=p),Rw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function sx(n,e,t,i=!1,l=!1){const u=new RC(n);let d;if(l)d=Aw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Dh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await sx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await sx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function AC(n,e){const t=tm(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Xo(u,e??{}))return l;Sa(l,"already-initialized")}return t.initialize({options:e})}function IC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(pi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function MC(n,e,t){const i=bo(n);$t(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Iw(e),{host:d,port:p}=DC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){$t(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),$t(Xo(y,i.config.emulator)&&Xo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,yo(d)?(zg(`${u}//${d}${g}`),qg("Auth",!0)):PC()}function Iw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function DC(n){const e=Iw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:nx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:nx(d)}}}function nx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function PC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Jg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fi("not implemented")}_getIdTokenResponse(e){return fi("not implemented")}_linkToIdToken(e,t){return fi("not implemented")}_getReauthenticationResolver(e){return fi("not implemented")}}async function LC(n,e){return Ti(n,"POST","/v1/accounts:signUp",e)}async function OC(n,e){return Bu(n,"POST","/v1/accounts:signInWithPassword",ji(n,e))}async function Mw(n,e){return Ti(n,"POST","/v1/accounts:sendOobCode",ji(n,e))}async function BC(n,e){return Mw(n,e)}async function VC(n,e){return Mw(n,e)}async function UC(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",ji(n,e))}async function FC(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",ji(n,e))}class ku extends Jg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new ku(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ku(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dh(e,t,"signInWithPassword",OC);case"emailLink":return UC(e,{email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dh(e,i,"signUpPassword",LC);case"emailLink":return FC(e,{idToken:t,email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Xl(n,e){return Bu(n,"POST","/v1/accounts:signInWithIdp",ji(n,e))}const zC="http://localhost";class Zo extends Jg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Zo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Xl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Xl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xl(e,t)}buildRequest(){const e={requestUri:zC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lu(t)}return e}}function qC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HC(n){const e=ou(lu(n)).link,t=e?ou(lu(e)).deep_link_id:null,i=ou(lu(n)).deep_link_id;return(i?ou(lu(i)).link:null)||i||t||e||n}class Zg{constructor(e){const t=ou(lu(e)),i=t.apiKey??null,l=t.oobCode??null,u=qC(t.mode??null);$t(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=HC(e);try{return new Zg(t)}catch{return null}}}class cc{constructor(){this.providerId=cc.PROVIDER_ID}static credential(e,t){return ku._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Zg.parseLink(t);return $t(i,"argument-error"),ku._fromEmailAndCode(e,i.code,i.tenantId)}}cc.PROVIDER_ID="password";cc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Dw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vu extends Dw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Xi extends Vu{constructor(){super("facebook.com")}static credential(e){return Zo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xi.PROVIDER_ID="facebook.com";class Ji extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zo._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ji.credential(t,i)}catch{return null}}}Ji.GOOGLE_SIGN_IN_METHOD="google.com";Ji.PROVIDER_ID="google.com";class Zi extends Vu{constructor(){super("github.com")}static credential(e){return Zo._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com";Zi.PROVIDER_ID="github.com";class eo extends Vu{constructor(){super("twitter.com")}static credential(e,t){return Zo._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return eo.credential(t,i)}catch{return null}}}eo.TWITTER_SIGN_IN_METHOD="twitter.com";eo.PROVIDER_ID="twitter.com";async function $C(n,e){return Bu(n,"POST","/v1/accounts:signUp",ji(n,e))}class el{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await Ta._fromIdTokenResponse(e,i,l),d=rx(i);return new el({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=rx(i);return new el({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function rx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ph extends Qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Ph.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Ph(e,t,i,l)}}function Pw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ph._fromErrorAndOperation(n,u,e,i):u})}async function WC(n,e,t=!1){const i=await _u(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return el._forOperation(n,"link",i)}async function GC(n,e,t=!1){const{auth:i}=n;if(Xr(i.app))return Promise.reject(yi(i));const l="reauthenticate";try{const u=await _u(n,Pw(i,l,e,n),t);$t(u.idToken,i,"internal-error");const d=Qg(u.idToken);$t(d,i,"internal-error");const{sub:p}=d;return $t(n.uid===p,i,"user-mismatch"),el._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&Sa(i,"user-mismatch"),u}}async function Lw(n,e,t=!1){if(Xr(n.app))return Promise.reject(yi(n));const i="signIn",l=await Pw(n,i,e),u=await el._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function KC(n,e){return Lw(bo(n),e)}async function Ow(n){const e=bo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YC(n,e,t){const i=bo(n);await Dh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",VC)}async function QC(n,e,t){if(Xr(n.app))return Promise.reject(yi(n));const i=bo(n),d=await Dh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$C).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Ow(n),g}),p=await el._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function XC(n,e,t){return Xr(n.app)?Promise.reject(yi(n)):KC(Zs(n),cc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Ow(n),i})}async function FP(n,e){const t=Zs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await BC(t.auth,l);u!==n.email&&await n.reload()}function ax(n,e){return Zs(n).setPersistence(e)}function JC(n,e,t,i){return Zs(n).onIdTokenChanged(e,t,i)}function ZC(n,e,t){return Zs(n).beforeAuthStateChanged(e,t)}function e4(n,e,t,i){return Zs(n).onAuthStateChanged(e,t,i)}function t4(n){return Zs(n).signOut()}const Lh="__sak";class Bw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Lh,"1"),this.storage.removeItem(Lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const s4=1e3,n4=10;class Vw extends Bw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Nw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,n4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},s4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Vw.type="LOCAL";const hg=Vw;class Uw extends Bw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Uw.type="SESSION";const ey=Uw;function r4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class nm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new nm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await r4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nm.receivers=[];function ty(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class a4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ty("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const j=k;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ha(){return window}function i4(n){Ha().location.href=n}function Fw(){return typeof Ha().WorkerGlobalScope<"u"&&typeof Ha().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return Fw()?self:null}const zw="firebaseLocalStorageDb",u4=1,Oh="firebaseLocalStorage",qw="fbase_key";class Uu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rm(n,e){return n.transaction([Oh],e?"readwrite":"readonly").objectStore(Oh)}function d4(){const n=indexedDB.deleteDatabase(zw);return new Uu(n).toPromise()}function mg(){const n=indexedDB.open(zw,u4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Oh,{keyPath:qw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Oh)?e(i):(i.close(),await d4(),e(await mg()))})})}async function ix(n,e,t){const i=rm(n,!0).put({[qw]:e,value:t});return new Uu(i).toPromise()}async function h4(n,e){const t=rm(n,!1).get(e),i=await new Uu(t).toPromise();return i===void 0?null:i.value}function ox(n,e){const t=rm(n,!0).delete(e);return new Uu(t).toPromise()}const m4=800,f4=3;class Hw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>f4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Fw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nm._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new a4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mg();return await ix(e,Lh,"1"),await ox(e,Lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ix(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ox(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=rm(l,!1).getAll();return new Uu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),m4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hw.type="LOCAL";const p4=Hw;new Ou(3e4,6e4);function g4(n,e){return e?pi(e):($t(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class sy extends Jg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function y4(n){return Lw(n.auth,new sy(n),n.bypassAuthState)}function b4(n){const{auth:e,user:t}=n;return $t(t,e,"internal-error"),GC(t,new sy(n),n.bypassAuthState)}async function v4(n){const{auth:e,user:t}=n;return $t(t,e,"internal-error"),WC(t,new sy(n),n.bypassAuthState)}class $w{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y4;case"linkViaPopup":case"linkViaRedirect":return v4;case"reauthViaPopup":case"reauthViaRedirect":return b4;default:Sa(this.auth,"internal-error")}}resolve(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const x4=new Ou(2e3,1e4);class Kl extends $w{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Kl.currentPopupAction&&Kl.currentPopupAction.cancel(),Kl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $t(e,this.auth,"internal-error"),e}async onExecution(){wi(this.filter.length===1,"Popup operations only handle one event");const e=ty();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(qa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(qa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,x4.get())};e()}}Kl.currentPopupAction=null;const w4="pendingRedirect",xh=new Map;class _4 extends $w{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(n,e){const t=E4(e),i=T4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function j4(n,e){xh.set(n._key(),e)}function T4(n){return pi(n._redirectPersistence)}function E4(n){return vh(w4,n.config.apiKey,n.name)}async function S4(n,e,t=!1){if(Xr(n.app))return Promise.reject(yi(n));const i=bo(n),l=g4(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const N4=600*1e3;class C4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Ww(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(qa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N4&&this.cachedEventUids.clear(),this.cachedEventUids.has(lx(e))}saveEventToCache(e){this.cachedEventUids.add(lx(e)),this.lastProcessedEventTime=Date.now()}}function lx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Ww({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function R4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ww(n);default:return!1}}async function A4(n,e={}){return Ti(n,"GET","/v1/projects",e)}const I4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function D4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await A4(n);for(const t of e)try{if(P4(t))return}catch{}Sa(n,"unauthorized-domain")}function P4(n){const e=ug(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(I4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const L4=new Ou(3e4,6e4);function cx(){const n=Ha().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function O4(n){return new Promise((e,t)=>{function i(){cx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cx(),t(qa(n,"network-request-failed"))},timeout:L4.get()})}if(Ha().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ha().gapi?.load)i();else{const l=EC("iframefcb");return Ha()[l]=()=>{gapi.load?i():t(qa(n,"network-request-failed"))},Rw(`${TC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw wh=null,e})}let wh=null;function B4(n){return wh=wh||O4(n),wh}const V4=new Ou(5e3,15e3),U4="__/auth/iframe",F4="emulator/auth/iframe",z4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function H4(n){const e=n.config;$t(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Yg(e,F4):`https://${n.config.authDomain}/${U4}`,i={apiKey:e.apiKey,appName:n.name,v:al},l=q4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Lu(i).slice(1)}`}async function $4(n){const e=await B4(n),t=Ha().gapi;return $t(t,n,"internal-error"),e.open({where:document.body,url:H4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=qa(n,"network-request-failed"),p=Ha().setTimeout(()=>{u(d)},V4.get());function g(){Ha().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class ux{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(n,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...W4,width:i.toString(),height:l.toString(),top:u,left:d},y=xr().toLowerCase();t&&(p=kw(y)?Y4:t),ww(y)&&(e=e||Q4,g.scrollbars="yes");const x=Object.entries(g).reduce((j,[B,W])=>`${j}${B}=${W},`,"");if(gC(y)&&p!=="_self")return J4(e||"",p),new ux(null);const k=window.open(e||"",p,x);$t(k,n,"popup-blocked");try{k.focus()}catch{}return new ux(k)}function J4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function dx(n,e,t,i,l,u){$t(n.config.authDomain,n,"auth-domain-config-required"),$t(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:al,eventId:l};if(e instanceof Dw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",BS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,k]of Object.entries({}))d[x]=k}if(e instanceof Vu){const x=e.getScopes().filter(k=>k!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${tR}=${encodeURIComponent(g)}`:"";return`${sR(n)}?${Lu(p).slice(1)}${y}`}function sR({config:n}){return n.emulator?Yg(n,eR):`https://${n.authDomain}/${Z4}`}const Mp="webStorageSupport";class nR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ey,this._completeRedirectFn=S4,this._overrideRedirectResult=j4}async _openPopup(e,t,i,l){wi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await dx(e,t,i,ug(),l);return X4(e,u,ty())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await dx(e,t,i,ug(),l);return i4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(wi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new C4(e);return t.register("authEvent",l=>($t(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mp,{type:Mp},l=>{const u=l?.[0]?.[Mp];u!==void 0&&t(!!u),Sa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Nw()||_w()||Xg()}}const rR=nR;var hx="@firebase/auth",mx="1.12.0";class aR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function iR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(n){Jo(new co("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;$t(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cw(n)},y=new _C(i,l,u,g);return IC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Jo(new co("auth-internal",e=>{const t=bo(e.getProvider("auth").getImmediate());return(i=>new aR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),za(hx,mx,iR(n)),za(hx,mx,"esm2020")}const lR=300,cR=ow("authIdTokenMaxAge")||lR;let fx=null;const uR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;fx!==l&&(fx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Gw(n=Gg()){const e=tm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=AC(n,{popupRedirectResolver:rR,persistence:[p4,hg,ey]}),i=ow("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZC(t,d,()=>d(t.currentUser)),JC(t,p=>d(p))}}const l=rw("auth");return l&&MC(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=qa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var oo,Kw;(function(){var n;function e(C,T){function A(){}A.prototype=T.prototype,C.F=T.prototype,C.prototype=new A,C.prototype.constructor=C,C.D=function(O,M,z){for(var I=Array(arguments.length-2),We=2;We<arguments.length;We++)I[We-2]=arguments[We];return T.prototype[M].apply(O,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,T,A){A||(A=0);const O=Array(16);if(typeof T=="string")for(var M=0;M<16;++M)O[M]=T.charCodeAt(A++)|T.charCodeAt(A++)<<8|T.charCodeAt(A++)<<16|T.charCodeAt(A++)<<24;else for(M=0;M<16;++M)O[M]=T[A++]|T[A++]<<8|T[A++]<<16|T[A++]<<24;T=C.g[0],A=C.g[1],M=C.g[2];let z=C.g[3],I;I=T+(z^A&(M^z))+O[0]+3614090360&4294967295,T=A+(I<<7&4294967295|I>>>25),I=z+(M^T&(A^M))+O[1]+3905402710&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(A^z&(T^A))+O[2]+606105819&4294967295,M=z+(I<<17&4294967295|I>>>15),I=A+(T^M&(z^T))+O[3]+3250441966&4294967295,A=M+(I<<22&4294967295|I>>>10),I=T+(z^A&(M^z))+O[4]+4118548399&4294967295,T=A+(I<<7&4294967295|I>>>25),I=z+(M^T&(A^M))+O[5]+1200080426&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(A^z&(T^A))+O[6]+2821735955&4294967295,M=z+(I<<17&4294967295|I>>>15),I=A+(T^M&(z^T))+O[7]+4249261313&4294967295,A=M+(I<<22&4294967295|I>>>10),I=T+(z^A&(M^z))+O[8]+1770035416&4294967295,T=A+(I<<7&4294967295|I>>>25),I=z+(M^T&(A^M))+O[9]+2336552879&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(A^z&(T^A))+O[10]+4294925233&4294967295,M=z+(I<<17&4294967295|I>>>15),I=A+(T^M&(z^T))+O[11]+2304563134&4294967295,A=M+(I<<22&4294967295|I>>>10),I=T+(z^A&(M^z))+O[12]+1804603682&4294967295,T=A+(I<<7&4294967295|I>>>25),I=z+(M^T&(A^M))+O[13]+4254626195&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(A^z&(T^A))+O[14]+2792965006&4294967295,M=z+(I<<17&4294967295|I>>>15),I=A+(T^M&(z^T))+O[15]+1236535329&4294967295,A=M+(I<<22&4294967295|I>>>10),I=T+(M^z&(A^M))+O[1]+4129170786&4294967295,T=A+(I<<5&4294967295|I>>>27),I=z+(A^M&(T^A))+O[6]+3225465664&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^A&(z^T))+O[11]+643717713&4294967295,M=z+(I<<14&4294967295|I>>>18),I=A+(z^T&(M^z))+O[0]+3921069994&4294967295,A=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(A^M))+O[5]+3593408605&4294967295,T=A+(I<<5&4294967295|I>>>27),I=z+(A^M&(T^A))+O[10]+38016083&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^A&(z^T))+O[15]+3634488961&4294967295,M=z+(I<<14&4294967295|I>>>18),I=A+(z^T&(M^z))+O[4]+3889429448&4294967295,A=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(A^M))+O[9]+568446438&4294967295,T=A+(I<<5&4294967295|I>>>27),I=z+(A^M&(T^A))+O[14]+3275163606&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^A&(z^T))+O[3]+4107603335&4294967295,M=z+(I<<14&4294967295|I>>>18),I=A+(z^T&(M^z))+O[8]+1163531501&4294967295,A=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(A^M))+O[13]+2850285829&4294967295,T=A+(I<<5&4294967295|I>>>27),I=z+(A^M&(T^A))+O[2]+4243563512&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^A&(z^T))+O[7]+1735328473&4294967295,M=z+(I<<14&4294967295|I>>>18),I=A+(z^T&(M^z))+O[12]+2368359562&4294967295,A=M+(I<<20&4294967295|I>>>12),I=T+(A^M^z)+O[5]+4294588738&4294967295,T=A+(I<<4&4294967295|I>>>28),I=z+(T^A^M)+O[8]+2272392833&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^A)+O[11]+1839030562&4294967295,M=z+(I<<16&4294967295|I>>>16),I=A+(M^z^T)+O[14]+4259657740&4294967295,A=M+(I<<23&4294967295|I>>>9),I=T+(A^M^z)+O[1]+2763975236&4294967295,T=A+(I<<4&4294967295|I>>>28),I=z+(T^A^M)+O[4]+1272893353&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^A)+O[7]+4139469664&4294967295,M=z+(I<<16&4294967295|I>>>16),I=A+(M^z^T)+O[10]+3200236656&4294967295,A=M+(I<<23&4294967295|I>>>9),I=T+(A^M^z)+O[13]+681279174&4294967295,T=A+(I<<4&4294967295|I>>>28),I=z+(T^A^M)+O[0]+3936430074&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^A)+O[3]+3572445317&4294967295,M=z+(I<<16&4294967295|I>>>16),I=A+(M^z^T)+O[6]+76029189&4294967295,A=M+(I<<23&4294967295|I>>>9),I=T+(A^M^z)+O[9]+3654602809&4294967295,T=A+(I<<4&4294967295|I>>>28),I=z+(T^A^M)+O[12]+3873151461&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^A)+O[15]+530742520&4294967295,M=z+(I<<16&4294967295|I>>>16),I=A+(M^z^T)+O[2]+3299628645&4294967295,A=M+(I<<23&4294967295|I>>>9),I=T+(M^(A|~z))+O[0]+4096336452&4294967295,T=A+(I<<6&4294967295|I>>>26),I=z+(A^(T|~M))+O[7]+1126891415&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~A))+O[14]+2878612391&4294967295,M=z+(I<<15&4294967295|I>>>17),I=A+(z^(M|~T))+O[5]+4237533241&4294967295,A=M+(I<<21&4294967295|I>>>11),I=T+(M^(A|~z))+O[12]+1700485571&4294967295,T=A+(I<<6&4294967295|I>>>26),I=z+(A^(T|~M))+O[3]+2399980690&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~A))+O[10]+4293915773&4294967295,M=z+(I<<15&4294967295|I>>>17),I=A+(z^(M|~T))+O[1]+2240044497&4294967295,A=M+(I<<21&4294967295|I>>>11),I=T+(M^(A|~z))+O[8]+1873313359&4294967295,T=A+(I<<6&4294967295|I>>>26),I=z+(A^(T|~M))+O[15]+4264355552&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~A))+O[6]+2734768916&4294967295,M=z+(I<<15&4294967295|I>>>17),I=A+(z^(M|~T))+O[13]+1309151649&4294967295,A=M+(I<<21&4294967295|I>>>11),I=T+(M^(A|~z))+O[4]+4149444226&4294967295,T=A+(I<<6&4294967295|I>>>26),I=z+(A^(T|~M))+O[11]+3174756917&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~A))+O[2]+718787259&4294967295,M=z+(I<<15&4294967295|I>>>17),I=A+(z^(M|~T))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(M+(I<<21&4294967295|I>>>11))&4294967295,C.g[2]=C.g[2]+M&4294967295,C.g[3]=C.g[3]+z&4294967295}i.prototype.v=function(C,T){T===void 0&&(T=C.length);const A=T-this.blockSize,O=this.C;let M=this.h,z=0;for(;z<T;){if(M==0)for(;z<=A;)l(this,C,z),z+=this.blockSize;if(typeof C=="string"){for(;z<T;)if(O[M++]=C.charCodeAt(z++),M==this.blockSize){l(this,O),M=0;break}}else for(;z<T;)if(O[M++]=C[z++],M==this.blockSize){l(this,O),M=0;break}}this.h=M,this.o+=T},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;T=this.o*8;for(var A=C.length-8;A<C.length;++A)C[A]=T&255,T/=256;for(this.v(C),C=Array(16),T=0,A=0;A<4;++A)for(let O=0;O<32;O+=8)C[T++]=this.g[A]>>>O&255;return C};function u(C,T){var A=p;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=T(C)}function d(C,T){this.h=T;const A=[];let O=!0;for(let M=C.length-1;M>=0;M--){const z=C[M]|0;O&&z==T||(A[M]=z,O=!1)}this.g=A}var p={};function g(C){return-128<=C&&C<128?u(C,function(T){return new d([T|0],T<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return k;if(C<0)return L(y(-C));const T=[];let A=1;for(let O=0;C>=A;O++)T[O]=C/A|0,A*=4294967296;return new d(T,0)}function x(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return L(x(C.substring(1),T));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(T,8));let O=k;for(let z=0;z<C.length;z+=8){var M=Math.min(8,C.length-z);const I=parseInt(C.substring(z,z+M),T);M<8?(M=y(Math.pow(T,M)),O=O.j(M).add(y(I))):(O=O.j(A),O=O.add(y(I)))}return O}var k=g(0),j=g(1),B=g(16777216);n=d.prototype,n.m=function(){if(V(this))return-L(this).m();let C=0,T=1;for(let A=0;A<this.g.length;A++){const O=this.i(A);C+=(O>=0?O:4294967296+O)*T,T*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(W(this))return"0";if(V(this))return"-"+L(this).toString(C);const T=y(Math.pow(C,6));var A=this;let O="";for(;;){const M=we(A,T).g;A=ee(A,M.j(T));let z=((A.g.length>0?A.g[0]:A.h)>>>0).toString(C);if(A=M,W(A))return z+O;for(;z.length<6;)z="0"+z;O=z+O}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function W(C){if(C.h!=0)return!1;for(let T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function V(C){return C.h==-1}n.l=function(C){return C=ee(this,C),V(C)?-1:W(C)?0:1};function L(C){const T=C.g.length,A=[];for(let O=0;O<T;O++)A[O]=~C.g[O];return new d(A,~C.h).add(j)}n.abs=function(){return V(this)?L(this):this},n.add=function(C){const T=Math.max(this.g.length,C.g.length),A=[];let O=0;for(let M=0;M<=T;M++){let z=O+(this.i(M)&65535)+(C.i(M)&65535),I=(z>>>16)+(this.i(M)>>>16)+(C.i(M)>>>16);O=I>>>16,z&=65535,I&=65535,A[M]=I<<16|z}return new d(A,A[A.length-1]&-2147483648?-1:0)};function ee(C,T){return C.add(L(T))}n.j=function(C){if(W(this)||W(C))return k;if(V(this))return V(C)?L(this).j(L(C)):L(L(this).j(C));if(V(C))return L(this.j(L(C)));if(this.l(B)<0&&C.l(B)<0)return y(this.m()*C.m());const T=this.g.length+C.g.length,A=[];for(var O=0;O<2*T;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(let M=0;M<C.g.length;M++){const z=this.i(O)>>>16,I=this.i(O)&65535,We=C.i(M)>>>16,bt=C.i(M)&65535;A[2*O+2*M]+=I*bt,Y(A,2*O+2*M),A[2*O+2*M+1]+=z*bt,Y(A,2*O+2*M+1),A[2*O+2*M+1]+=I*We,Y(A,2*O+2*M+1),A[2*O+2*M+2]+=z*We,Y(A,2*O+2*M+2)}for(C=0;C<T;C++)A[C]=A[2*C+1]<<16|A[2*C];for(C=T;C<2*T;C++)A[C]=0;return new d(A,0)};function Y(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function te(C,T){this.g=C,this.h=T}function we(C,T){if(W(T))throw Error("division by zero");if(W(C))return new te(k,k);if(V(C))return T=we(L(C),T),new te(L(T.g),L(T.h));if(V(T))return T=we(C,L(T)),new te(L(T.g),T.h);if(C.g.length>30){if(V(C)||V(T))throw Error("slowDivide_ only works with positive integers.");for(var A=j,O=T;O.l(C)<=0;)A=Ce(A),O=Ce(O);var M=xe(A,1),z=xe(O,1);for(O=xe(O,2),A=xe(A,2);!W(O);){var I=z.add(O);I.l(C)<=0&&(M=M.add(A),z=I),O=xe(O,1),A=xe(A,1)}return T=ee(C,M.j(T)),new te(M,T)}for(M=k;C.l(T)>=0;){for(A=Math.max(1,Math.floor(C.m()/T.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),z=y(A),I=z.j(T);V(I)||I.l(C)>0;)A-=O,z=y(A),I=z.j(T);W(z)&&(z=j),M=M.add(z),C=ee(C,I)}return new te(M,C)}n.B=function(C){return we(this,C).h},n.and=function(C){const T=Math.max(this.g.length,C.g.length),A=[];for(let O=0;O<T;O++)A[O]=this.i(O)&C.i(O);return new d(A,this.h&C.h)},n.or=function(C){const T=Math.max(this.g.length,C.g.length),A=[];for(let O=0;O<T;O++)A[O]=this.i(O)|C.i(O);return new d(A,this.h|C.h)},n.xor=function(C){const T=Math.max(this.g.length,C.g.length),A=[];for(let O=0;O<T;O++)A[O]=this.i(O)^C.i(O);return new d(A,this.h^C.h)};function Ce(C){const T=C.g.length+1,A=[];for(let O=0;O<T;O++)A[O]=C.i(O)<<1|C.i(O-1)>>>31;return new d(A,C.h)}function xe(C,T){const A=T>>5;T%=32;const O=C.g.length-A,M=[];for(let z=0;z<O;z++)M[z]=T>0?C.i(z+A)>>>T|C.i(z+A+1)<<32-T:C.i(z+A);return new d(M,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Kw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,oo=d}).apply(typeof px<"u"?px:typeof self<"u"?self:typeof window<"u"?window:{});var nh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Yw,cu,Qw,_h,fg,Xw,Jw,Zw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof nh=="object"&&nh];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var R=0;R<h.length-1;R++){var oe=h[R];if(!(oe in _))break e;_=_[oe]}h=h[h.length-1],R=_[h],b=b(R),b!=R&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],R;for(R in b)Object.prototype.hasOwnProperty.call(b,R)&&_.push([R,b[R]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function x(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function k(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(R,oe,ge){for(var st=Array(arguments.length-2),cs=2;cs<arguments.length;cs++)st[cs-2]=arguments[cs];return b.prototype[oe].apply(R,st)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function B(h){const b=h.length;if(b>0){const _=Array(b);for(let R=0;R<b;R++)_[R]=h[R];return _}return[]}function W(h,b){for(let R=1;R<arguments.length;R++){const oe=arguments[R];var _=typeof oe;if(_=_!="object"?_:oe?Array.isArray(oe)?"array":_:"null",_=="array"||_=="object"&&typeof oe.length=="number"){_=h.length||0;const ge=oe.length||0;h.length=_+ge;for(let st=0;st<ge;st++)h[_+st]=oe[st]}else h.push(oe)}}class V{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function L(h){d.setTimeout(()=>{throw h},0)}function ee(){var h=C;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class Y{constructor(){this.h=this.g=null}add(b,_){const R=te.get();R.set(b,_),this.h?this.h.next=R:this.g=R,this.h=R}}var te=new V(()=>new we,h=>h.reset());class we{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,xe=!1,C=new Y,T=()=>{const h=Promise.resolve(void 0);Ce=()=>{h.then(A)}};function A(){for(var h;h=ee();){try{h.h.call(h.g)}catch(_){L(_)}var b=te;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}xe=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function We(h,b){M.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}k(We,M),We.prototype.init=function(h,b){const _=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&We.Z.h.call(this)},We.prototype.h=function(){We.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var bt="closure_listenable_"+(Math.random()*1e6|0),q=0;function me(h,b,_,R,oe){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!R,this.ha=oe,this.key=++q,this.da=this.fa=!1}function Me(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ue(h,b,_){for(const R in h)b.call(_,h[R],R,h)}function X(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function P(h){const b={};for(const _ in h)b[_]=h[_];return b}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pe(h,b){let _,R;for(let oe=1;oe<arguments.length;oe++){R=arguments[oe];for(_ in R)h[_]=R[_];for(let ge=0;ge<re.length;ge++)_=re[ge],Object.prototype.hasOwnProperty.call(R,_)&&(h[_]=R[_])}}function Be(h){this.src=h,this.g={},this.h=0}Be.prototype.add=function(h,b,_,R,oe){const ge=h.toString();h=this.g[ge],h||(h=this.g[ge]=[],this.h++);const st=Ne(h,b,R,oe);return st>-1?(b=h[st],_||(b.fa=!1)):(b=new me(b,this.src,ge,!!R,oe),b.fa=_,h.push(b)),b};function De(h,b){const _=b.type;if(_ in h.g){var R=h.g[_],oe=Array.prototype.indexOf.call(R,b,void 0),ge;(ge=oe>=0)&&Array.prototype.splice.call(R,oe,1),ge&&(Me(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ne(h,b,_,R){for(let oe=0;oe<h.length;++oe){const ge=h[oe];if(!ge.da&&ge.listener==b&&ge.capture==!!_&&ge.ha==R)return oe}return-1}var it="closure_lm_"+(Math.random()*1e6|0),ft={};function et(h,b,_,R,oe){if(Array.isArray(b)){for(let ge=0;ge<b.length;ge++)et(h,b[ge],_,R,oe);return null}return _=Tt(_),h&&h[bt]?h.J(b,_,p(R)?!!R.capture:!1,oe):Yt(h,b,_,!1,R,oe)}function Yt(h,b,_,R,oe,ge){if(!b)throw Error("Invalid event type");const st=p(oe)?!!oe.capture:!!oe;let cs=_t(h);if(cs||(h[it]=cs=new Be(h)),_=cs.add(b,_,R,st,ge),_.proxy)return _;if(R=Ts(),_.proxy=R,R.src=h,R.listener=_,h.addEventListener)z||(oe=st),oe===void 0&&(oe=!1),h.addEventListener(b.toString(),R,oe);else if(h.attachEvent)h.attachEvent(ie(b.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Ts(){function h(_){return b.call(h.src,h.listener,_)}const b=Ct;return h}function Pt(h,b,_,R,oe){if(Array.isArray(b))for(var ge=0;ge<b.length;ge++)Pt(h,b[ge],_,R,oe);else R=p(R)?!!R.capture:!!R,_=Tt(_),h&&h[bt]?(h=h.i,ge=String(b).toString(),ge in h.g&&(b=h.g[ge],_=Ne(b,_,R,oe),_>-1&&(Me(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[ge],h.h--)))):h&&(h=_t(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ne(b,_,R,oe)),(_=h>-1?b[h]:null)&&vt(_))}function vt(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[bt])De(b.i,h);else{var _=h.type,R=h.proxy;b.removeEventListener?b.removeEventListener(_,R,h.capture):b.detachEvent?b.detachEvent(ie(_),R):b.addListener&&b.removeListener&&b.removeListener(R),(_=_t(b))?(De(_,h),_.h==0&&(_.src=null,b[it]=null)):Me(h)}}}function ie(h){return h in ft?ft[h]:ft[h]="on"+h}function Ct(h,b){if(h.da)h=!0;else{b=new We(b,this);const _=h.listener,R=h.ha||h.src;h.fa&&vt(h),h=_.call(R,b)}return h}function _t(h){return h=h[it],h instanceof Be?h:null}var zt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Tt(h){return typeof h=="function"?h:(h[zt]||(h[zt]=function(b){return h.handleEvent(b)}),h[zt])}function kt(){O.call(this),this.i=new Be(this),this.M=this,this.G=null}k(kt,O),kt.prototype[bt]=!0,kt.prototype.removeEventListener=function(h,b,_,R){Pt(this,h,b,_,R)};function tt(h,b){var _,R=h.G;if(R)for(_=[];R;R=R.G)_.push(R);if(h=h.M,R=b.type||b,typeof b=="string")b=new M(b,h);else if(b instanceof M)b.target=b.target||h;else{var oe=b;b=new M(R,h),Pe(b,oe)}oe=!0;let ge,st;if(_)for(st=_.length-1;st>=0;st--)ge=b.g=_[st],oe=pt(ge,R,!0,b)&&oe;if(ge=b.g=h,oe=pt(ge,R,!0,b)&&oe,oe=pt(ge,R,!1,b)&&oe,_)for(st=0;st<_.length;st++)ge=b.g=_[st],oe=pt(ge,R,!1,b)&&oe}kt.prototype.N=function(){if(kt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let R=0;R<_.length;R++)Me(_[R]);delete h.g[b],h.h--}}this.G=null},kt.prototype.J=function(h,b,_,R){return this.i.add(String(h),b,!1,_,R)},kt.prototype.K=function(h,b,_,R){return this.i.add(String(h),b,!0,_,R)};function pt(h,b,_,R){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let oe=!0;for(let ge=0;ge<b.length;++ge){const st=b[ge];if(st&&!st.da&&st.capture==_){const cs=st.listener,Cn=st.ha||st.src;st.fa&&De(h.i,st),oe=cs.call(Cn,R)!==!1&&oe}}return oe&&!R.defaultPrevented}function Qt(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function zs(h){h.g=Qt(()=>{h.g=null,h.i&&(h.i=!1,zs(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Ft extends O{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:zs(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(h){O.call(this),this.h=h,this.g={}}k(At,O);var is=[];function Cs(h){Ue(h.g,function(b,_){this.g.hasOwnProperty(_)&&vt(b)},h),h.g={}}At.prototype.N=function(){At.Z.N.call(this),Cs(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ss=d.JSON.stringify,sn=d.JSON.parse,Ms=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Os(){}function ls(){}var ps={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ye(){M.call(this,"d")}k(ye,M);function Se(){M.call(this,"c")}k(Se,M);var Le={},Qe=null;function ze(){return Qe=Qe||new kt}Le.Ia="serverreachability";function Xe(h){M.call(this,Le.Ia,h)}k(Xe,M);function dt(h){const b=ze();tt(b,new Xe(b))}Le.STAT_EVENT="statevent";function Q(h,b){M.call(this,Le.STAT_EVENT,h),this.stat=b}k(Q,M);function se(h){const b=ze();tt(b,new Q(b,h))}Le.Ja="timingevent";function He(h,b){M.call(this,Le.Ja,h),this.size=b}k(He,M);function gt(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function Ye(){this.g=!0}Ye.prototype.ua=function(){this.g=!1};function J(h,b,_,R,oe,ge){h.info(function(){if(h.g)if(ge){var st="",cs=ge.split("&");for(let qs=0;qs<cs.length;qs++){var Cn=cs[qs].split("=");if(Cn.length>1){const fn=Cn[0];Cn=Cn[1];const sa=fn.split("_");st=sa.length>=2&&sa[1]=="type"?st+(fn+"="+Cn+"&"):st+(fn+"=redacted&")}}}else st=null;else st=ge;return"XMLHTTP REQ ("+R+") [attempt "+oe+"]: "+b+`
`+_+`
`+st})}function ke(h,b,_,R,oe,ge,st){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+oe+"]: "+b+`
`+_+`
`+ge+" "+st})}function qe(h,b,_,R){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+lt(h,_)+(R?" "+R:"")})}function nt(h,b){h.info(function(){return"TIMEOUT: "+b})}Ye.prototype.info=function(){};function lt(h,b){if(!h.g)return b;if(!b)return null;try{const ge=JSON.parse(b);if(ge){for(h=0;h<ge.length;h++)if(Array.isArray(ge[h])){var _=ge[h];if(!(_.length<2)){var R=_[1];if(Array.isArray(R)&&!(R.length<1)){var oe=R[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(let st=1;st<R.length;st++)R[st]=""}}}}return ss(ge)}catch{return b}}var St={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Xt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function U(){}k(U,Os),U.prototype.g=function(){return new XMLHttpRequest},Bt=new U;function fe(h){return encodeURIComponent(String(h))}function Re(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function Te(h,b,_,R){this.j=h,this.i=b,this.l=_,this.S=R||1,this.V=new At(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}var ht={},Et={};function ot(h,b,_){h.M=1,h.A=ea(qt(b)),h.u=_,h.R=!0,Lt(h,null)}function Lt(h,b){h.F=Date.now(),mn(h),h.B=qt(h.A);var _=h.B,R=h.S;Array.isArray(R)||(R=[String(R)]),wn(_.i,"t",R),h.C=0,_=h.j.L,h.h=new je,h.g=Dr(h.j,_?b:null,!h.u),h.P>0&&(h.O=new Ft(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,R=h.ba;var oe="readystatechange";Array.isArray(oe)||(oe&&(is[0]=oe.toString()),oe=is);for(let ge=0;ge<oe.length;ge++){const st=et(_,oe[ge],R||b.handleEvent,!1,b.h||b);if(!st)break;b.g[st.key]=st}b=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),dt(),J(h.i,h.v,h.B,h.l,h.S,h.u)}Te.prototype.ba=function(h){h=h.target;const b=this.O;b&&Fe(h)==3?b.j():this.Y(h)},Te.prototype.Y=function(h){try{if(h==this.g)e:{const cs=Fe(this.g),Cn=this.g.ya(),qs=this.g.ca();if(!(cs<3)&&(cs!=3||this.g&&(this.h.h||this.g.la()||Ze(this.g)))){this.K||cs!=4||Cn==7||(Cn==8||qs<=0?dt(3):dt(2)),xn(this);var b=this.g.ca();this.X=b;var _=It(this);if(this.o=b==200,ke(this.i,this.v,this.B,this.l,this.S,cs,b),this.o){if(this.U&&!this.L){t:{if(this.g){var R,oe=this.g;if((R=oe.g?oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(R)){var ge=R;break t}}ge=null}if(h=ge)qe(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$(this,h);else{this.o=!1,this.m=3,se(12),ms(this),ln(this);break e}}if(this.R){h=!0;let fn;for(;!this.K&&this.C<_.length;)if(fn=hn(this,_),fn==Et){cs==4&&(this.m=4,se(14),h=!1),qe(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==ht){this.m=4,se(15),qe(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else qe(this.i,this.l,fn,null),$(this,fn);if(nn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cs!=4||_.length!=0||this.h.h||(this.m=1,se(16),h=!1),this.o=this.o&&h,!h)qe(this.i,this.l,_,"[Invalid Chunked Response]"),ms(this),ln(this);else if(_.length>0&&!this.W){this.W=!0;var st=this.j;st.g==this&&st.aa&&!st.P&&(st.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Qn(st),st.P=!0,se(11))}}else qe(this.i,this.l,_,null),$(this,_);cs==4&&ms(this),this.o&&!this.K&&(cs==4?Ir(this.j,this):(this.o=!1,mn(this)))}else wt(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,se(12)):(this.m=0,se(13)),ms(this),ln(this)}}}catch{}};function It(h){if(!nn(h))return h.g.la();const b=Ze(h.g);if(b==="")return"";let _="";const R=b.length,oe=Fe(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ms(h),ln(h),"";h.h.i=new d.TextDecoder}for(let ge=0;ge<R;ge++)h.h.h=!0,_+=h.h.i.decode(b[ge],{stream:!(oe&&ge==R-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function nn(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function hn(h,b){var _=h.C,R=b.indexOf(`
`,_);return R==-1?Et:(_=Number(b.substring(_,R)),isNaN(_)?ht:(R+=1,R+_>b.length?Et:(b=b.slice(R,R+_),h.C=R+_,b)))}Te.prototype.cancel=function(){this.K=!0,ms(this)};function mn(h){h.T=Date.now()+h.H,rn(h,h.H)}function rn(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=gt(y(h.aa,h),b)}function xn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Te.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(nt(this.i,this.B),this.M!=2&&(dt(),se(17)),ms(this),this.m=2,ln(this)):rn(this,this.T-h)};function ln(h){h.j.I==0||h.K||Ir(h.j,h)}function ms(h){xn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Cs(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function $(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||ne(_.h,h))){if(!h.L&&ne(_.h,h)&&_.I==3){try{var R=_.Ba.g.parse(b)}catch{R=null}if(Array.isArray(R)&&R.length==3){var oe=R;if(oe[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)sr(_),ns(_);else break e;qn(_),se(18)}}else _.xa=oe[1],0<_.xa-_.K&&oe[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=gt(y(_.Va,_),6e3));D(_.h)<=1&&_.ta&&(_.ta=void 0)}else _n(_,11)}else if((h.L||_.g==h)&&sr(_),!I(b))for(oe=_.Ba.g.parse(b),b=0;b<oe.length;b++){let qs=oe[b];const fn=qs[0];if(!(fn<=_.K))if(_.K=fn,qs=qs[1],_.I==2)if(qs[0]=="c"){_.M=qs[1],_.ba=qs[2];const sa=qs[3];sa!=null&&(_.ka=sa,_.j.info("VER="+_.ka));const Da=qs[4];Da!=null&&(_.za=Da,_.j.info("SVER="+_.za));const ga=qs[5];ga!=null&&typeof ga=="number"&&ga>0&&(R=1.5*ga,_.O=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const ya=h.g;if(ya){const jo=ya.g?ya.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jo){var ge=R.h;ge.g||jo.indexOf("spdy")==-1&&jo.indexOf("quic")==-1&&jo.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(ae(ge,ge.h),ge.h=null))}if(R.G){const ll=ya.g?ya.g.getResponseHeader("X-HTTP-Session-Id"):null;ll&&(R.wa=ll,fs(R.J,R.G,ll))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),R=_;var st=h;if(R.na=Mr(R,R.L?R.ba:null,R.W),st.L){$e(R.h,st);var cs=st,Cn=R.O;Cn&&(cs.H=Cn),cs.D&&(xn(cs),mn(cs)),R.g=st}else bn(R);_.i.length>0&&hs(_)}else qs[0]!="stop"&&qs[0]!="close"||_n(_,7);else _.I==3&&(qs[0]=="stop"||qs[0]=="close"?qs[0]=="stop"?_n(_,7):es(_):qs[0]!="noop"&&_.l&&_.l.qa(qs),_.A=0)}}dt(4)}catch{}}var de=class{constructor(h,b){this.g=h,this.map=b}};function ue(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function E(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function D(h){return h.h?1:h.g?h.g.size:0}function ne(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function ae(h,b){h.g?h.g.add(b):h.h=b}function $e(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}ue.prototype.cancel=function(){if(this.i=Ge(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ge(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return B(h.i)}var Je=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vt(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const R=h[_].indexOf("=");let oe,ge=null;R>=0?(oe=h[_].substring(0,R),ge=h[_].substring(R+1)):oe=h[_],b(oe,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function xt(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof xt?(this.l=h.l,vs(this,h.j),this.o=h.o,this.g=h.g,yn(this,h.u),this.h=h.h,wr(this,Zn(h.i)),this.m=h.m):h&&(b=String(h).match(Je))?(this.l=!1,vs(this,b[1]||"",!0),this.o=Mn(b[2]||""),this.g=Mn(b[3]||"",!0),yn(this,b[4]),this.h=Mn(b[5]||"",!0),wr(this,b[6]||"",!0),this.m=Mn(b[7]||"")):(this.l=!1,this.i=new Kt(null,this.l))}xt.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(G(b,_e,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(G(b,_e,!0),"@"),h.push(fe(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(G(_,_.charAt(0)=="/"?rt:at,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",G(_,Gt)),h.join("")},xt.prototype.resolve=function(h){const b=qt(this);let _=!!h.j;_?vs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var R=h.h;if(_)yn(b,h.u);else if(_=!!h.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var oe=b.h.lastIndexOf("/");oe!=-1&&(R=b.h.slice(0,oe+1)+R)}if(oe=R,oe==".."||oe==".")R="";else if(oe.indexOf("./")!=-1||oe.indexOf("/.")!=-1){R=oe.lastIndexOf("/",0)==0,oe=oe.split("/");const ge=[];for(let st=0;st<oe.length;){const cs=oe[st++];cs=="."?R&&st==oe.length&&ge.push(""):cs==".."?((ge.length>1||ge.length==1&&ge[0]!="")&&ge.pop(),R&&st==oe.length&&ge.push("")):(ge.push(cs),R=!0)}R=ge.join("/")}else R=oe}return _?b.h=R:_=h.i.toString()!=="",_?wr(b,Zn(h.i)):_=!!h.m,_&&(b.m=h.m),b};function qt(h){return new xt(h)}function vs(h,b,_){h.j=_?Mn(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function yn(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function wr(h,b,_){b instanceof Kt?(h.i=b,$s(h.i,h.l)):(_||(b=G(b,mt)),h.i=new Kt(b,h.l))}function fs(h,b,_){h.i.set(b,_)}function ea(h){return fs(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Mn(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function G(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,be),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function be(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var _e=/[#\/\?@]/g,at=/[#\?:]/g,rt=/[#\?]/g,mt=/[#\?@]/g,Gt=/#/g;function Kt(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Jt(h){h.g||(h.g=new Map,h.h=0,h.i&&Vt(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Kt.prototype,n.add=function(h,b){Jt(this),this.i=null,h=Ds(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function Dn(h,b){Jt(h),b=Ds(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function os(h,b){return Jt(h),b=Ds(h,b),h.g.has(b)}n.forEach=function(h,b){Jt(this),this.g.forEach(function(_,R){_.forEach(function(oe){h.call(b,oe,R,this)},this)},this)};function Es(h,b){Jt(h);let _=[];if(typeof b=="string")os(h,b)&&(_=_.concat(h.g.get(Ds(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return Jt(this),this.i=null,h=Ds(this,h),os(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Es(this,h),h.length>0?String(h[0]):b):b};function wn(h,b,_){Dn(h,b),_.length>0&&(h.i=null,h.g.set(Ds(h,b),B(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let R=0;R<b.length;R++){var _=b[R];const oe=fe(_);_=Es(this,_);for(let ge=0;ge<_.length;ge++){let st=oe;_[ge]!==""&&(st+="="+fe(_[ge])),h.push(st)}}return this.i=h.join("&")};function Zn(h){const b=new Kt;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Ds(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function $s(h,b){b&&!h.j&&(Jt(h),h.i=null,h.g.forEach(function(_,R){const oe=R.toLowerCase();R!=oe&&(Dn(this,R),wn(this,oe,_))},h)),h.j=b}function Zt(h,b){const _=new Ye;if(d.Image){const R=new Image;R.onload=x(an,_,"TestLoadImage: loaded",!0,b,R),R.onerror=x(an,_,"TestLoadImage: error",!1,b,R),R.onabort=x(an,_,"TestLoadImage: abort",!1,b,R),R.ontimeout=x(an,_,"TestLoadImage: timeout",!1,b,R),d.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else b(!1)}function Ps(h,b){const _=new Ye,R=new AbortController,oe=setTimeout(()=>{R.abort(),an(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:R.signal}).then(ge=>{clearTimeout(oe),ge.ok?an(_,"TestPingServer: ok",!0,b):an(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(oe),an(_,"TestPingServer: error",!1,b)})}function an(h,b,_,R,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),R(_)}catch{}}function er(){this.g=new Ms}function zn(h){this.i=h.Sb||null,this.h=h.ab||!1}k(zn,Os),zn.prototype.g=function(){return new Nn(this.i,this.h)};function Nn(h,b){kt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Nn,kt),n=Nn.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Yn(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,hr(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kn(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kn(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?hr(this):Yn(this),this.readyState==3&&Kn(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,hr(this))},n.Na=function(h){this.g&&(this.response=h,hr(this))},n.ga=function(){this.g&&hr(this)};function hr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Yn(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function Yn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Nn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function mr(h){let b="";return Ue(h,function(_,R){b+=R,b+=":",b+=_,b+=`\r
`}),b}function Rr(h,b,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=mr(_),typeof h=="string"?_!=null&&fe(_):fs(h,b,_))}function Ws(h){kt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(Ws,kt);var ta=/^https?$/i,wo=["POST","PUT"];n=Ws.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ge){Xa(this,ge);return}if(h=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var oe in R)_.set(oe,R[oe]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const ge of R.keys())_.set(ge,R.get(ge));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(ge=>ge.toLowerCase()=="content-type"),oe=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(wo,b,void 0)>=0)||R||oe||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,st]of _)this.g.setRequestHeader(ge,st);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ge){Xa(this,ge)}};function Xa(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,_o(h),K(h)}function _o(h){h.A||(h.A=!0,tt(h,"complete"),tt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,tt(this,"complete"),tt(this,"abort"),K(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),K(this,!0)),Ws.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?N(this):this.Xa())},n.Xa=function(){N(this)};function N(h){if(h.h&&typeof u<"u"){if(h.v&&Fe(h)==4)setTimeout(h.Ca.bind(h),0);else if(tt(h,"readystatechange"),Fe(h)==4){h.h=!1;try{const ge=h.ca();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var R;if(R=ge===0){let st=String(h.D).match(Je)[1]||null;!st&&d.self&&d.self.location&&(st=d.self.location.protocol.slice(0,-1)),R=!ta.test(st?st.toLowerCase():"")}_=R}if(_)tt(h,"complete"),tt(h,"success");else{h.o=6;try{var oe=Fe(h)>2?h.g.statusText:""}catch{oe=""}h.l=oe+" ["+h.ca()+"]",_o(h)}}finally{K(h)}}}}function K(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||tt(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Fe(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Fe(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),sn(b)}};function Ze(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function wt(h){const b={};h=(h.g&&Fe(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(I(h[R]))continue;var _=Re(h[R]);const oe=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ge=b[oe]||[];b[oe]=ge,ge.push(_)}X(b,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ot(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function ut(h){this.za=0,this.i=[],this.j=new Ye,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ot("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ot("baseRetryDelayMs",5e3,h),this.Za=Ot("retryDelaySeedMs",1e4,h),this.Ta=Ot("forwardChannelMaxRetries",2,h),this.va=Ot("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ue(h&&h.concurrentRequestLimit),this.Ba=new er,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ut.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,R){se(0),this.W=h,this.H=b||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.J=Mr(this,null,this.W),hs(this)};function es(h){if(Ss(h),h.I==3){var b=h.V++,_=qt(h.J);if(fs(_,"SID",h.M),fs(_,"RID",b),fs(_,"TYPE","terminate"),Ar(h,_),b=new Te(h,h.j,b),b.M=2,b.A=ea(qt(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Dr(b.j,null),b.g.ea(b.A)),b.F=Date.now(),mn(b)}Hn(h)}function ns(h){h.g&&(Qn(h),h.g.cancel(),h.g=null)}function Ss(h){ns(h),h.v&&(d.clearTimeout(h.v),h.v=null),sr(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function hs(h){if(!E(h.h)&&!h.m){h.m=!0;var b=h.Ea;Ce||T(),xe||(Ce(),xe=!0),C.add(b,h),h.D=0}}function Bs(h,b){return D(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=gt(y(h.Ea,h,b),_r(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const oe=new Te(this,this.j,h);let ge=this.o;if(this.U&&(ge?(ge=P(ge),Pe(ge,this.U)):ge=this.U),this.u!==null||this.R||(oe.J=ge,ge=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(b+=R,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=cn(this,oe,b),_=qt(this.J),fs(_,"RID",h),fs(_,"CVER",22),this.G&&fs(_,"X-HTTP-Session-Id",this.G),Ar(this,_),ge&&(this.R?b="headers="+fe(mr(ge))+"&"+b:this.u&&Rr(_,this.u,ge)),ae(this.h,oe),this.Ra&&fs(_,"TYPE","init"),this.S?(fs(_,"$req",b),fs(_,"SID","null"),oe.U=!0,ot(oe,_,null)):ot(oe,_,b),this.I=2}}else this.I==3&&(h?qr(this,h):this.i.length==0||E(this.h)||qr(this))};function qr(h,b){var _;b?_=b.l:_=h.V++;const R=qt(h.J);fs(R,"SID",h.M),fs(R,"RID",_),fs(R,"AID",h.K),Ar(h,R),h.u&&h.o&&Rr(R,h.u,h.o),_=new Te(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=cn(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ae(h.h,_),ot(_,R,b)}function Ar(h,b){h.H&&Ue(h.H,function(_,R){fs(b,R,_)}),h.l&&Ue({},function(_,R){fs(b,R,_)})}function cn(h,b,_){_=Math.min(h.i.length,_);const R=h.l?y(h.l.Ka,h.l,h):null;e:{var oe=h.i;let cs=-1;for(;;){const Cn=["count="+_];cs==-1?_>0?(cs=oe[0].g,Cn.push("ofs="+cs)):cs=0:Cn.push("ofs="+cs);let qs=!0;for(let fn=0;fn<_;fn++){var ge=oe[fn].g;const sa=oe[fn].map;if(ge-=cs,ge<0)cs=Math.max(0,oe[fn].g-100),qs=!1;else try{ge="req"+ge+"_"||"";try{var st=sa instanceof Map?sa:Object.entries(sa);for(const[Da,ga]of st){let ya=ga;p(ga)&&(ya=ss(ga)),Cn.push(ge+Da+"="+encodeURIComponent(ya))}}catch(Da){throw Cn.push(ge+"type="+encodeURIComponent("_badmap")),Da}}catch{R&&R(sa)}}if(qs){st=Cn.join("&");break e}}st=void 0}return h=h.i.splice(0,_),b.G=h,st}function bn(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Ce||T(),xe||(Ce(),xe=!0),C.add(b,h),h.A=0}}function qn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=gt(y(h.Da,h),_r(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,tr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=gt(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,se(10),ns(this),tr(this))};function Qn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function tr(h){h.g=new Te(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=qt(h.na);fs(b,"RID","rpc"),fs(b,"SID",h.M),fs(b,"AID",h.K),fs(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&fs(b,"TO",h.ia),fs(b,"TYPE","xmlhttp"),Ar(h,b),h.u&&h.o&&Rr(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=ea(qt(b)),_.u=null,_.R=!0,Lt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,ns(this),qn(this),se(19))};function sr(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Ir(h,b){var _=null;if(h.g==b){sr(h),Qn(h),h.g=null;var R=2}else if(ne(h.h,b))_=b.G,$e(h.h,b),R=1;else return;if(h.I!=0){if(b.o)if(R==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var oe=h.D;R=ze(),tt(R,new He(R,_)),hs(h)}else bn(h);else if(oe=b.m,oe==3||oe==0&&b.X>0||!(R==1&&Bs(h,b)||R==2&&qn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),oe){case 1:_n(h,5);break;case 4:_n(h,10);break;case 3:_n(h,6);break;default:_n(h,2)}}}function _r(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function _n(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),R=h.Ua;const oe=!R;R=new xt(R||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||vs(R,"https"),ea(R),oe?Zt(R.toString(),_):Ps(R.toString(),_)}else se(2);h.I=0,h.l&&h.l.pa(b),Hn(h),Ss(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),se(2)):(this.j.info("Failed to ping google.com"),se(1))};function Hn(h){if(h.I=0,h.ja=[],h.l){const b=Ge(h.h);(b.length!=0||h.i.length!=0)&&(W(h.ja,b),W(h.ja,h.i),h.h.i.length=0,B(h.i),h.i.length=0),h.l.oa()}}function Mr(h,b,_){var R=_ instanceof xt?qt(_):new xt(_);if(R.g!="")b&&(R.g=b+"."+R.g),yn(R,R.u);else{var oe=d.location;R=oe.protocol,b=b?b+"."+oe.hostname:oe.hostname,oe=+oe.port;const ge=new xt(null);R&&vs(ge,R),b&&(ge.g=b),oe&&yn(ge,oe),_&&(ge.h=_),R=ge}return _=h.G,b=h.wa,_&&b&&fs(R,_,b),fs(R,"VER",h.ka),Ar(h,R),R}function Dr(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ws(new zn({ab:_})):new Ws(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ko(){}n=ko.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ma(){}Ma.prototype.g=function(h,b){return new nr(h,b)};function nr(h,b){kt.call(this),this.g=new ut(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!I(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!I(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new fr(this)}k(nr,kt),nr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){es(this.g)},nr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=ss(h),h=_);b.i.push(new de(b.Ya++,h)),b.I==3&&hs(b)},nr.prototype.N=function(){this.g.l=null,delete this.j,es(this.g),delete this.g,nr.Z.N.call(this)};function Ja(h){ye.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}k(Ja,ye);function pa(){Se.call(this),this.status=1}k(pa,Se);function fr(h){this.g=h}k(fr,ko),fr.prototype.ra=function(){tt(this.g,"a")},fr.prototype.qa=function(h){tt(this.g,new Ja(h))},fr.prototype.pa=function(h){tt(this.g,new pa)},fr.prototype.oa=function(){tt(this.g,"b")},Ma.prototype.createWebChannel=Ma.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,Zw=function(){return new Ma},Jw=function(){return ze()},Xw=Le,fg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},St.NO_ERROR=0,St.TIMEOUT=8,St.HTTP_ERROR=6,_h=St,Xt.COMPLETE="complete",Qw=Xt,ls.EventType=ps,ps.OPEN="a",ps.CLOSE="b",ps.ERROR="c",ps.MESSAGE="d",kt.prototype.listen=kt.prototype.J,cu=ls,Ws.prototype.listenOnce=Ws.prototype.K,Ws.prototype.getLastError=Ws.prototype.Ha,Ws.prototype.getLastErrorCode=Ws.prototype.ya,Ws.prototype.getStatus=Ws.prototype.ca,Ws.prototype.getResponseJson=Ws.prototype.La,Ws.prototype.getResponseText=Ws.prototype.la,Ws.prototype.send=Ws.prototype.ea,Ws.prototype.setWithCredentials=Ws.prototype.Fa,Yw=Ws}).apply(typeof nh<"u"?nh:typeof self<"u"?self:typeof window<"u"?window:{});class yr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yr.UNAUTHENTICATED=new yr(null),yr.GOOGLE_CREDENTIALS=new yr("google-credentials-uid"),yr.FIRST_PARTY=new yr("first-party-uid"),yr.MOCK_USER=new yr("mock-user");let uc="12.8.0";function hR(n){uc=n}const tl=new Hg("@firebase/firestore");function Hl(){return tl.logLevel}function yt(n,...e){if(tl.logLevel<=_s.DEBUG){const t=e.map(ny);tl.debug(`Firestore (${uc}): ${n}`,...t)}}function _i(n,...e){if(tl.logLevel<=_s.ERROR){const t=e.map(ny);tl.error(`Firestore (${uc}): ${n}`,...t)}}function ec(n,...e){if(tl.logLevel<=_s.WARN){const t=e.map(ny);tl.warn(`Firestore (${uc}): ${n}`,...t)}}function ny(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Wt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,e_(n,i,t)}function e_(n,e,t){let i=`FIRESTORE (${uc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw _i(i),new Error(i)}function Gs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||e_(e,l,i)}function as(n,e){return n}const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends Qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class bi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class t_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yr.UNAUTHENTICATED)))}shutdown(){}}class fR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Gs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new bi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new bi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{yt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(yt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new bi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(yt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Gs(typeof i.accessToken=="string",31837,{l:i}),new t_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Gs(e===null||typeof e=="string",2055,{h:e}),new yr(e)}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new gR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Xr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Gs(this.o===void 0,3512);const i=u=>{u.error!=null&&yt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,yt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{yt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):yt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Gs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function vR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ry{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=vR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function ks(n,e){return n<e?-1:n>e?1:0}function pg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Dp(l)===Dp(u)?ks(l,u):Dp(l)?1:-1}return ks(n.length,e.length)}const xR=55296,wR=57343;function Dp(n){const e=n.charCodeAt(0);return e>=xR&&e<=wR}function tc(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const yx="__name__";class Ua{constructor(e,t,i){t===void 0?t=0:t>e.length&&Wt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Wt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ua.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ua?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ua.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return ks(e.length,t.length)}static compareSegments(e,t){const i=Ua.isNumericId(e),l=Ua.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ua.extractNumericId(e).compare(Ua.extractNumericId(t)):pg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oo.fromString(e.substring(4,e.length-2))}}class on extends Ua{construct(e,t,i){return new on(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ct(Ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new on(t)}static emptyPath(){return new on([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cr extends Ua{construct(e,t,i){return new cr(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yx}static keyField(){return new cr([yx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new ct(Ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new ct(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ct(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new ct(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cr(t)}static emptyPath(){return new cr([])}}class Dt{constructor(e){this.path=e}static fromPath(e){return new Dt(on.fromString(e))}static fromName(e){return new Dt(on.fromString(e).popFirst(5))}static empty(){return new Dt(on.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&on.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return on.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Dt(new on(e.slice()))}}function s_(n,e,t){if(!t)throw new ct(Ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kR(n,e,t,i){if(e===!0&&i===!0)throw new ct(Ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bx(n){if(!Dt.isDocumentKey(n))throw new ct(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vx(n){if(Dt.isDocumentKey(n))throw new ct(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function n_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function am(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Wt(12329,{type:typeof n})}function Sr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ct(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=am(n);throw new ct(Ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function jR(n,e){if(e<=0)throw new ct(Ae.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Fu(n,e){if(!n_(n))throw new ct(Ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new ct(Ae.INVALID_ARGUMENT,t);return!0}const xx=-62135596800,wx=1e6;class Rt{static now(){return Rt.fromMillis(Date.now())}static fromDate(e){return Rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wx);return new Rt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ct(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ct(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xx)throw new ct(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wx}_compareTo(e){return this.seconds===e.seconds?ks(this.nanoseconds,e.nanoseconds):ks(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fu(e,Rt._jsonSchema))return new Rt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rt._jsonSchemaVersion="firestore/timestamp/1.0",Rt._jsonSchema={type:Fn("string",Rt._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};class ts{static fromTimestamp(e){return new ts(e)}static min(){return new ts(new Rt(0,0))}static max(){return new ts(new Rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ju=-1;function TR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=ts.fromTimestamp(i===1e9?new Rt(t+1,0):new Rt(t,i));return new uo(l,Dt.empty(),e)}function ER(n){return new uo(n.readTime,n.key,ju)}class uo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new uo(ts.min(),Dt.empty(),ju)}static max(){return new uo(ts.max(),Dt.empty(),ju)}}function SR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Dt.comparator(n.documentKey,e.documentKey),t!==0?t:ks(n.largestBatchId,e.largestBatchId))}const NR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function dc(n){if(n.code!==Ae.FAILED_PRECONDITION||n.message!==NR)throw n;yt("LocalStore","Unexpectedly lost primary lease")}class Ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Wt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ve(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ve?t:Ve.resolve(t)}catch(t){return Ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ve.reject(t)}static resolve(e){return new Ve(((t,i)=>{t(e)}))}static reject(e){return new Ve(((t,i)=>{i(e)}))}static waitFor(e){return new Ve(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Ve.resolve(!1);for(const i of e)t=t.next((l=>l?Ve.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ve(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new Ve(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function RR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hc(n){return n.name==="IndexedDbTransactionError"}class im{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}im.ce=-1;const ay=-1;function om(n){return n==null}function Bh(n){return n===0&&1/n==-1/0}function AR(n){return typeof n=="number"&&Number.isInteger(n)&&!Bh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const r_="";function IR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_x(e)),e=MR(n.get(t),e);return _x(e)}function MR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case r_:t+="";break;default:t+=u}}return t}function _x(n){return n+r_+""}function kx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function a_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class vn{constructor(e,t){this.comparator=e,this.root=t||lr.EMPTY}insert(e,t){return new vn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lr.BLACK,null,null))}remove(e){return new vn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rh(this.root,e,this.comparator,!1)}getReverseIterator(){return new rh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rh(this.root,e,this.comparator,!0)}}class rh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??lr.RED,this.left=l??lr.EMPTY,this.right=u??lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new lr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return lr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Wt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Wt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Wt(27949);return e+(this.isRed()?0:1)}}lr.EMPTY=null,lr.RED=!0,lr.BLACK=!1;lr.EMPTY=new class{constructor(){this.size=0}get key(){throw Wt(57766)}get value(){throw Wt(16141)}get color(){throw Wt(16727)}get left(){throw Wt(29726)}get right(){throw Wt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new lr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gn{constructor(e){this.comparator=e,this.data=new vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jx(this.data.getIterator())}getIteratorFrom(e){return new jx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Gn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gn(this.comparator);return t.data=e,t}}class jx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Jr{constructor(e){this.fields=e,e.sort(cr.comparator)}static empty(){return new Jr([])}unionWith(e){let t=new Gn(cr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Jr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class i_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ur{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new i_("Invalid base64 string: "+u):u}})(e);return new ur(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new ur(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ks(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ur.EMPTY_BYTE_STRING=new ur("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(n){if(Gs(!!n,39018),typeof n=="string"){let e=0;const t=DR.exec(n);if(Gs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:In(n.seconds),nanos:In(n.nanos)}}function In(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function mo(n){return typeof n=="string"?ur.fromBase64String(n):ur.fromUint8Array(n)}const o_="server_timestamp",l_="__type__",c_="__previous_value__",u_="__local_write_time__";function iy(n){return(n?.mapValue?.fields||{})[l_]?.stringValue===o_}function lm(n){const e=n.mapValue.fields[c_];return iy(e)?lm(e):e}function Tu(n){const e=ho(n.mapValue.fields[u_].timestampValue);return new Rt(e.seconds,e.nanos)}class PR{constructor(e,t,i,l,u,d,p,g,y,x,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=k}}const Vh="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||Vh}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===Vh}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}function LR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ct(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(n.options.projectId,e)}const d_="__type__",OR="__max__",ah={mapValue:{}},h_="__vector__",Uh="value";function fo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?iy(n)?4:VR(n)?9007199254740991:BR(n)?10:11:Wt(28295,{value:n})}function Ka(n,e){if(n===e)return!0;const t=fo(n);if(t!==fo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tu(n).isEqual(Tu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=ho(l.timestampValue),p=ho(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return mo(l.bytesValue).isEqual(mo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return In(l.geoPointValue.latitude)===In(u.geoPointValue.latitude)&&In(l.geoPointValue.longitude)===In(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return In(l.integerValue)===In(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=In(l.doubleValue),p=In(u.doubleValue);return d===p?Bh(d)===Bh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return tc(n.arrayValue.values||[],e.arrayValue.values||[],Ka);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(kx(d)!==kx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ka(d[g],p[g])))return!1;return!0})(n,e);default:return Wt(52216,{left:n})}}function Su(n,e){return(n.values||[]).find((t=>Ka(t,e)))!==void 0}function sc(n,e){if(n===e)return 0;const t=fo(n),i=fo(e);if(t!==i)return ks(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ks(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=In(u.integerValue||u.doubleValue),g=In(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Tx(n.timestampValue,e.timestampValue);case 4:return Tx(Tu(n),Tu(e));case 5:return pg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=mo(u),g=mo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=ks(p[y],g[y]);if(x!==0)return x}return ks(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=ks(In(u.latitude),In(d.latitude));return p!==0?p:ks(In(u.longitude),In(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ex(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Uh]?.arrayValue,x=g[Uh]?.arrayValue,k=ks(y?.values?.length||0,x?.values?.length||0);return k!==0?k:Ex(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===ah.mapValue&&d===ah.mapValue)return 0;if(u===ah.mapValue)return 1;if(d===ah.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let k=0;k<g.length&&k<x.length;++k){const j=pg(g[k],x[k]);if(j!==0)return j;const B=sc(p[g[k]],y[x[k]]);if(B!==0)return B}return ks(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Wt(23264,{he:t})}}function Tx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ks(n,e);const t=ho(n),i=ho(e),l=ks(t.seconds,i.seconds);return l!==0?l:ks(t.nanos,i.nanos)}function Ex(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=sc(t[l],i[l]);if(u)return u}return ks(t.length,i.length)}function nc(n){return gg(n)}function gg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ho(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return mo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Dt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=gg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${gg(t.fields[d])}`;return l+"}"})(n.mapValue):Wt(61005,{value:n})}function kh(n){switch(fo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lm(n);return e?16+kh(e):16;case 5:return 2*n.stringValue.length;case 6:return mo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+kh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return vo(i.fields,((u,d)=>{l+=u.length+kh(d)})),l})(n.mapValue);default:throw Wt(13486,{value:n})}}function Sx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yg(n){return!!n&&"integerValue"in n}function oy(n){return!!n&&"arrayValue"in n}function Nx(n){return!!n&&"nullValue"in n}function Cx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jh(n){return!!n&&"mapValue"in n}function BR(n){return(n?.mapValue?.fields||{})[d_]?.stringValue===h_}function pu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return vo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=pu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pu(n.arrayValue.values[t]);return e}return{...n}}function VR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===OR}class Fr{constructor(e){this.value=e}static empty(){return new Fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!jh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pu(t)}setAll(e){let t=cr.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=pu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());jh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ka(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];jh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){vo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Fr(pu(this.value))}}function m_(n){const e=[];return vo(n.fields,((t,i)=>{const l=new cr([t]);if(jh(i)){const u=m_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Jr(e)}class br{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new br(e,0,ts.min(),ts.min(),ts.min(),Fr.empty(),0)}static newFoundDocument(e,t,i,l){return new br(e,1,t,ts.min(),i,l,0)}static newNoDocument(e,t){return new br(e,2,t,ts.min(),ts.min(),Fr.empty(),0)}static newUnknownDocument(e,t){return new br(e,3,t,ts.min(),ts.min(),Fr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ts.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ts.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof br&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fh{constructor(e,t){this.position=e,this.inclusive=t}}function Rx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Dt.comparator(Dt.fromName(d.referenceValue),t.key):i=sc(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ax(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ka(n.position[t],e.position[t]))return!1;return!0}class Nu{constructor(e,t="asc"){this.field=e,this.dir=t}}function UR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class f_{}class Un extends f_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new zR(e,t,i):t==="array-contains"?new $R(e,i):t==="in"?new WR(e,i):t==="not-in"?new GR(e,i):t==="array-contains-any"?new KR(e,i):new Un(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qR(e,i):new HR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sc(t,this.value)):t!==null&&fo(this.value)===fo(t)&&this.matchesComparison(sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Wt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends f_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Na(e,t)}matches(e){return p_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function p_(n){return n.op==="and"}function g_(n){return FR(n)&&p_(n)}function FR(n){for(const e of n.filters)if(e instanceof Na)return!1;return!0}function bg(n){if(n instanceof Un)return n.field.canonicalString()+n.op.toString()+nc(n.value);if(g_(n))return n.filters.map((e=>bg(e))).join(",");{const e=n.filters.map((t=>bg(t))).join(",");return`${n.op}(${e})`}}function y_(n,e){return n instanceof Un?(function(i,l){return l instanceof Un&&i.op===l.op&&i.field.isEqual(l.field)&&Ka(i.value,l.value)})(n,e):n instanceof Na?(function(i,l){return l instanceof Na&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&y_(d,l.filters[p])),!0):!1})(n,e):void Wt(19439)}function b_(n){return n instanceof Un?(function(t){return`${t.field.canonicalString()} ${t.op} ${nc(t.value)}`})(n):n instanceof Na?(function(t){return t.op.toString()+" {"+t.getFilters().map(b_).join(" ,")+"}"})(n):"Filter"}class zR extends Un{constructor(e,t,i){super(e,t,i),this.key=Dt.fromName(i.referenceValue)}matches(e){const t=Dt.comparator(e.key,this.key);return this.matchesComparison(t)}}class qR extends Un{constructor(e,t){super(e,"in",t),this.keys=v_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class HR extends Un{constructor(e,t){super(e,"not-in",t),this.keys=v_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function v_(n,e){return(e.arrayValue?.values||[]).map((t=>Dt.fromName(t.referenceValue)))}class $R extends Un{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return oy(t)&&Su(t.arrayValue,this.value)}}class WR extends Un{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Su(this.value.arrayValue,t)}}class GR extends Un{constructor(e,t){super(e,"not-in",t)}matches(e){if(Su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Su(this.value.arrayValue,t)}}class KR extends Un{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!oy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Su(this.value.arrayValue,i)))}}class YR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Ix(n,e=null,t=[],i=[],l=null,u=null,d=null){return new YR(n,e,t,i,l,u,d)}function ly(n){const e=as(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>bg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),om(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>nc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>nc(i))).join(",")),e.Te=t}return e.Te}function cy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!y_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ax(n.startAt,e.startAt)&&Ax(n.endAt,e.endAt)}function vg(n){return Dt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class mc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function QR(n,e,t,i,l,u,d,p){return new mc(n,e,t,i,l,u,d,p)}function cm(n){return new mc(n)}function Mx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function XR(n){return Dt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function x_(n){return n.collectionGroup!==null}function gu(n){const e=as(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Gn(cr.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Nu(u,i))})),t.has(cr.keyField().canonicalString())||e.Ie.push(new Nu(cr.keyField(),i))}return e.Ie}function $a(n){const e=as(n);return e.Ee||(e.Ee=JR(e,gu(n))),e.Ee}function JR(n,e){if(n.limitType==="F")return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Nu(l.field,u)}));const t=n.endAt?new Fh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Fh(n.startAt.position,n.startAt.inclusive):null;return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function xg(n,e){const t=n.filters.concat([e]);return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ZR(n,e){const t=n.explicitOrderBy.concat([e]);return new mc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function zh(n,e,t){return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function um(n,e){return cy($a(n),$a(e))&&n.limitType===e.limitType}function w_(n){return`${ly($a(n))}|lt:${n.limitType}`}function $l(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>b_(l))).join(", ")}]`),om(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>nc(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>nc(l))).join(",")),`Target(${i})`})($a(n))}; limitType=${n.limitType})`}function dm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Dt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of gu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,gu(i),l)||i.endAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,gu(i),l))})(n,e)}function eA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function __(n){return(e,t)=>{let i=!1;for(const l of gu(n)){const u=tA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function tA(n,e,t){const i=n.field.isKeyField()?Dt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?sc(g,y):Wt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Wt(19790,{direction:n.dir})}}class il{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){vo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return a_(this.inner)}size(){return this.innerSize}}const sA=new vn(Dt.comparator);function ki(){return sA}const k_=new vn(Dt.comparator);function uu(...n){let e=k_;for(const t of n)e=e.insert(t.key,t);return e}function j_(n){let e=k_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function $o(){return yu()}function T_(){return yu()}function yu(){return new il((n=>n.toString()),((n,e)=>n.isEqual(e)))}const nA=new vn(Dt.comparator),rA=new Gn(Dt.comparator);function js(...n){let e=rA;for(const t of n)e=e.add(t);return e}const aA=new Gn(ks);function iA(){return aA}function uy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bh(e)?"-0":e}}function E_(n){return{integerValue:""+n}}function S_(n,e){return AR(e)?E_(e):uy(n,e)}class hm{constructor(){this._=void 0}}function oA(n,e,t){return n instanceof Cu?(function(l,u){const d={fields:{[l_]:{stringValue:o_},[u_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&iy(u)&&(u=lm(u)),u&&(d.fields[c_]=u),{mapValue:d}})(t,e):n instanceof Ru?C_(n,e):n instanceof Au?R_(n,e):(function(l,u){const d=N_(l,u),p=Dx(d)+Dx(l.Ae);return yg(d)&&yg(l.Ae)?E_(p):uy(l.serializer,p)})(n,e)}function lA(n,e,t){return n instanceof Ru?C_(n,e):n instanceof Au?R_(n,e):t}function N_(n,e){return n instanceof Iu?(function(i){return yg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Cu extends hm{}class Ru extends hm{constructor(e){super(),this.elements=e}}function C_(n,e){const t=A_(e);for(const i of n.elements)t.some((l=>Ka(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends hm{constructor(e){super(),this.elements=e}}function R_(n,e){let t=A_(e);for(const i of n.elements)t=t.filter((l=>!Ka(l,i)));return{arrayValue:{values:t}}}class Iu extends hm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Dx(n){return In(n.integerValue||n.doubleValue)}function A_(n){return oy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class I_{constructor(e,t){this.field=e,this.transform=t}}function cA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Ru&&l instanceof Ru||i instanceof Au&&l instanceof Au?tc(i.elements,l.elements,Ka):i instanceof Iu&&l instanceof Iu?Ka(i.Ae,l.Ae):i instanceof Cu&&l instanceof Cu})(n.transform,e.transform)}class uA{constructor(e,t){this.version=e,this.transformResults=t}}class Nr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Nr}static exists(e){return new Nr(void 0,e)}static updateTime(e){return new Nr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Th(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class mm{}function M_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fm(n.key,Nr.none()):new zu(n.key,n.data,Nr.none());{const t=n.data,i=Fr.empty();let l=new Gn(cr.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new xo(n.key,i,new Jr(l.toArray()),Nr.none())}}function dA(n,e,t){n instanceof zu?(function(l,u,d){const p=l.value.clone(),g=Lx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof xo?(function(l,u,d){if(!Th(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Lx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(D_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function bu(n,e,t,i){return n instanceof zu?(function(u,d,p,g){if(!Th(u.precondition,d))return p;const y=u.value.clone(),x=Ox(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof xo?(function(u,d,p,g){if(!Th(u.precondition,d))return p;const y=Ox(u.fieldTransforms,g,d),x=d.data;return x.setAll(D_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(n,e,t,i):(function(u,d,p){return Th(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function hA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=N_(i.transform,l||null);u!=null&&(t===null&&(t=Fr.empty()),t.set(i.field,u))}return t||null}function Px(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&tc(i,l,((u,d)=>cA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zu extends mm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class xo extends mm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function D_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Lx(n,e,t){const i=new Map;Gs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,lA(d,p,t[l]))}return i}function Ox(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,oA(u,d,e))}return i}class fm extends mm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mA extends mm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&dA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=bu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=bu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=T_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=M_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(ts.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),js())}isEqual(e){return this.batchId===e.batchId&&tc(this.mutations,e.mutations,((t,i)=>Px(t,i)))&&tc(this.baseMutations,e.baseMutations,((t,i)=>Px(t,i)))}}class dy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Gs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return nA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new dy(e,t,i,l)}}class pA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Rs;function yA(n){switch(n){case Ae.OK:return Wt(64938);case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0;default:return Wt(15467,{code:n})}}function P_(n){if(n===void 0)return _i("GRPC error has no .code"),Ae.UNKNOWN;switch(n){case Vn.OK:return Ae.OK;case Vn.CANCELLED:return Ae.CANCELLED;case Vn.UNKNOWN:return Ae.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return Ae.INTERNAL;case Vn.UNAVAILABLE:return Ae.UNAVAILABLE;case Vn.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case Vn.NOT_FOUND:return Ae.NOT_FOUND;case Vn.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case Vn.ABORTED:return Ae.ABORTED;case Vn.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case Vn.DATA_LOSS:return Ae.DATA_LOSS;default:return Wt(39323,{code:n})}}(Rs=Vn||(Vn={}))[Rs.OK=0]="OK",Rs[Rs.CANCELLED=1]="CANCELLED",Rs[Rs.UNKNOWN=2]="UNKNOWN",Rs[Rs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rs[Rs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rs[Rs.NOT_FOUND=5]="NOT_FOUND",Rs[Rs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rs[Rs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rs[Rs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rs[Rs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rs[Rs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rs[Rs.ABORTED=10]="ABORTED",Rs[Rs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rs[Rs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rs[Rs.INTERNAL=13]="INTERNAL",Rs[Rs.UNAVAILABLE=14]="UNAVAILABLE",Rs[Rs.DATA_LOSS=15]="DATA_LOSS";function bA(){return new TextEncoder}const vA=new oo([4294967295,4294967295],0);function Bx(n){const e=bA().encode(n),t=new Kw;return t.update(e),new Uint8Array(t.digest())}function Vx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new oo([t,i],0),new oo([l,u],0)]}class hy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new du(`Invalid padding: ${t}`);if(i<0)throw new du(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new du(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new du(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=oo.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(oo.fromNumber(i)));return l.compare(vA)===1&&(l=new oo([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Bx(e),[i,l]=Vx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new hy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Bx(e),[i,l]=Vx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class du extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class pm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,qu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new pm(ts.min(),l,new vn(ks),ki(),js())}}class qu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new qu(i,t,js(),js(),js())}}class Eh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class L_{constructor(e,t){this.targetId=e,this.Ce=t}}class O_{constructor(e,t,i=ur.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Ux{constructor(){this.ve=0,this.Fe=Fx(),this.Me=ur.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=js(),t=js(),i=js();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Wt(38017,{changeType:u})}})),new qu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Fx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Gs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class xA{constructor(e){this.Ge=e,this.ze=new Map,this.je=ki(),this.He=ih(),this.Je=ih(),this.Ze=new vn(ks)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Wt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(vg(u))if(i===0){const d=new Dt(u.path);this.et(t,d,br.newNoDocument(d,ts.min()))}else Gs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=mo(i).toUint8Array()}catch(g){if(g instanceof i_)return ec("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new hy(d,l,u)}catch(g){return ec(g instanceof du?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&vg(p.target)){const g=new Dt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,br.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=js();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new pm(e,t,this.Ze,this.je,i);return this.je=ki(),this.He=ih(),this.Je=ih(),this.Ze=new vn(ks),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Ux,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Gn(ks),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Gn(ks),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||yt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ux),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ih(){return new vn(Dt.comparator)}function Fx(){return new vn(Dt.comparator)}const wA={asc:"ASCENDING",desc:"DESCENDING"},_A={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kA={and:"AND",or:"OR"};class jA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wg(n,e){return n.useProto3Json||om(e)?e:{value:e}}function qh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function TA(n,e){return qh(n,e.toTimestamp())}function Wa(n){return Gs(!!n,49232),ts.fromTimestamp((function(t){const i=ho(t);return new Rt(i.seconds,i.nanos)})(n))}function my(n,e){return _g(n,e).canonicalString()}function _g(n,e){const t=(function(l){return new on(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function V_(n){const e=on.fromString(n);return Gs(H_(e),10190,{key:e.toString()}),e}function kg(n,e){return my(n.databaseId,e.path)}function Pp(n,e){const t=V_(e);if(t.get(1)!==n.databaseId.projectId)throw new ct(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ct(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Dt(F_(t))}function U_(n,e){return my(n.databaseId,e)}function EA(n){const e=V_(n);return e.length===4?on.emptyPath():F_(e)}function jg(n){return new on(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function F_(n){return Gs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zx(n,e,t){return{name:kg(n,e),fields:t.value.mapValue.fields}}function SA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Wt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Gs(x===void 0||typeof x=="string",58123),ur.fromBase64String(x||"")):(Gs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),ur.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Ae.UNKNOWN:P_(y.code);return new ct(x,y.message||"")})(d);t=new O_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Pp(n,i.document.name),u=Wa(i.document.updateTime),d=i.document.createTime?Wa(i.document.createTime):ts.min(),p=new Fr({mapValue:{fields:i.document.fields}}),g=br.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Eh(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Pp(n,i.document),u=i.readTime?Wa(i.readTime):ts.min(),d=br.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Eh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Pp(n,i.document),u=i.removedTargetIds||[];t=new Eh([],u,l,null)}else{if(!("filter"in e))return Wt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new gA(l,u),p=i.targetId;t=new L_(p,d)}}return t}function NA(n,e){let t;if(e instanceof zu)t={update:zx(n,e.key,e.value)};else if(e instanceof fm)t={delete:kg(n,e.key)};else if(e instanceof xo)t={update:zx(n,e.key,e.data),updateMask:OA(e.fieldMask)};else{if(!(e instanceof mA))return Wt(16599,{dt:e.type});t={verify:kg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Cu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Ru)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Au)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Iu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Wt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:TA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Wt(27497)})(n,e.precondition)),t}function CA(n,e){return n&&n.length>0?(Gs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Wa(l.updateTime):Wa(u);return d.isEqual(ts.min())&&(d=Wa(u)),new uA(d,l.transformResults||[])})(t,e)))):[]}function RA(n,e){return{documents:[U_(n,e.path)]}}function AA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=U_(n,l);const u=(function(y){if(y.length!==0)return q_(Na.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(j){return{field:Wl(j.field),direction:DA(j.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=wg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function IA(n){let e=EA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Gs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(k){const j=z_(k);return j instanceof Na&&g_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((j=>(function(W){return new Nu(Gl(W.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(W.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let j;return j=typeof k=="object"?k.value:k,om(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(k){const j=!!k.before,B=k.values||[];return new Fh(B,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const j=!k.before,B=k.values||[];return new Fh(B,j)})(t.endAt)),QR(e,l,d,u,p,"F",g,y)}function MA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Wt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function z_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Gl(t.unaryFilter.field);return Un.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Gl(t.unaryFilter.field);return Un.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Gl(t.unaryFilter.field);return Un.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Gl(t.unaryFilter.field);return Un.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Wt(61313);default:return Wt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Un.create(Gl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Wt(58110);default:return Wt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Na.create(t.compositeFilter.filters.map((i=>z_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Wt(1026)}})(t.compositeFilter.op))})(n):Wt(30097,{filter:n})}function DA(n){return wA[n]}function PA(n){return _A[n]}function LA(n){return kA[n]}function Wl(n){return{fieldPath:n.canonicalString()}}function Gl(n){return cr.fromServerFormat(n.fieldPath)}function q_(n){return n instanceof Un?(function(t){if(t.op==="=="){if(Cx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Cx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wl(t.field),op:PA(t.op),value:t.value}}})(n):n instanceof Na?(function(t){const i=t.getFilters().map((l=>q_(l)));return i.length===1?i[0]:{compositeFilter:{op:LA(t.op),filters:i}}})(n):Wt(54877,{filter:n})}function OA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function H_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function $_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class so{constructor(e,t,i,l,u=ts.min(),d=ts.min(),p=ur.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new so(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new so(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class BA{constructor(e){this.yt=e}}function VA(n){const e=IA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zh(e,e.limit,"L"):e}class UA{constructor(){this.Sn=new FA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ve.resolve()}getCollectionParents(e,t){return Ve.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ve.resolve()}deleteFieldIndex(e,t){return Ve.resolve()}deleteAllFieldIndexes(e){return Ve.resolve()}createTargetIndexes(e,t){return Ve.resolve()}getDocumentsMatchingTarget(e,t){return Ve.resolve(null)}getIndexType(e,t){return Ve.resolve(0)}getFieldIndexes(e,t){return Ve.resolve([])}getNextCollectionGroupToUpdate(e){return Ve.resolve(null)}getMinOffset(e,t){return Ve.resolve(uo.min())}getMinOffsetFromCollectionGroup(e,t){return Ve.resolve(uo.min())}updateCollectionGroup(e,t,i){return Ve.resolve()}updateIndexEntries(e,t){return Ve.resolve()}}class FA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Gn(on.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Gn(on.comparator)).toArray()}}const qx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},W_=41943040;class Ur{static withCacheSize(e){return new Ur(e,Ur.DEFAULT_COLLECTION_PERCENTILE,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Ur.DEFAULT_COLLECTION_PERCENTILE=10,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ur.DEFAULT=new Ur(W_,Ur.DEFAULT_COLLECTION_PERCENTILE,Ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ur.DISABLED=new Ur(-1,0,0);class rc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new rc(0)}static ar(){return new rc(-1)}}const Hx="LruGarbageCollector",zA=1048576;function $x([n,e],[t,i]){const l=ks(n,t);return l===0?ks(e,i):l}class qA{constructor(e){this.Pr=e,this.buffer=new Gn($x),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();$x(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){yt(Hx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hc(t)?yt(Hx,"Ignoring IndexedDB error during garbage collection: ",t):await dc(t)}await this.Ar(3e5)}))}}class $A{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ve.resolve(im.ce);const i=new qA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(yt("LruGarbageCollector","Garbage collection skipped; disabled"),Ve.resolve(qx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(yt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(yt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Hl()<=_s.DEBUG&&yt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),Ve.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function WA(n,e){return new $A(n,e)}class GA{constructor(){this.changes=new il((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,br.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ve.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&bu(i.mutation,l,Jr.empty(),Rt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,js()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=js()){const l=$o();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=uu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=$o();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,js())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=ki();const d=yu(),p=(function(){return yu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof xo)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),bu(x.mutation,y,x.mutation.getFieldMask(),Rt.now())):d.set(y.key,Jr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new KA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=yu();let l=new vn(((d,p)=>d-p)),u=js();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Jr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const k=(l.get(p.batchId)||js()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,k=T_();x.forEach((j=>{if(!u.has(j)){const B=M_(t.get(j),i.get(j));B!==null&&k.set(j,B),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Ve.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return XR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):x_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ve.resolve($o());let p=ju,g=u;return d.next((y=>Ve.forEach(y,((x,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(x)?Ve.resolve():this.remoteDocumentCache.getEntry(e,x).next((j=>{g=g.insert(x,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,js()))).next((x=>({batchId:p,changes:j_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Dt(t)).next((i=>{let l=uu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=uu();return this.indexManager.getCollectionParents(e,u).next((p=>Ve.forEach(p,(g=>{const y=(function(k,j){return new mc(j,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((k,j)=>{d=d.insert(k,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,br.newInvalidDocument(x)))}));let p=uu();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&bu(x.mutation,y,Jr.empty(),Rt.now()),dm(t,y)&&(p=p.insert(g,y))})),p}))}}class QA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ve.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Wa(l.createTime)}})(t)),Ve.resolve()}getNamedQuery(e,t){return Ve.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:VA(l.bundledQuery),readTime:Wa(l.readTime)}})(t)),Ve.resolve()}}class XA{constructor(){this.overlays=new vn(Dt.comparator),this.Lr=new Map}getOverlay(e,t){return Ve.resolve(this.overlays.get(t))}getOverlays(e,t){const i=$o();return Ve.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ve.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ve.resolve()}getOverlaysForCollection(e,t,i){const l=$o(),u=t.length+1,d=new Dt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ve.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new vn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=$o(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=$o(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return Ve.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new pA(t,i));let u=this.Lr.get(t);u===void 0&&(u=js(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class JA{constructor(){this.sessionToken=ur.EMPTY_BYTE_STRING}getSessionToken(e){return Ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ve.resolve()}}class fy{constructor(){this.kr=new Gn(Jn.Kr),this.qr=new Gn(Jn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Jn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Jn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Dt(new on([])),i=new Jn(t,e),l=new Jn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Dt(new on([])),i=new Jn(t,e),l=new Jn(t,e+1);let u=js();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Jn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Jn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Dt.comparator(e.key,t.key)||ks(e.Hr,t.Hr)}static Ur(e,t){return ks(e.Hr,t.Hr)||Dt.comparator(e.key,t.key)}}class ZA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Gn(Jn.Kr)}checkEmpty(e){return Ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new fA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Jn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ve.resolve(d)}lookupMutationBatch(e,t){return Ve.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ve.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ve.resolve(this.mutationQueue.length===0?ay:this.Yn-1)}getAllMutationBatches(e){return Ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Jn(t,0),l=new Jn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Ve.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Gn(ks);return t.forEach((l=>{const u=new Jn(l,0),d=new Jn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Ve.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Dt.isDocumentKey(u)||(u=u.child(""));const d=new Jn(new Dt(u),0);let p=new Gn(ks);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Ve.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Gs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ve.forEach(t.mutations,(l=>{const u=new Jn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Jn(t,0),l=this.Jr.firstAfterOrEqual(i);return Ve.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ve.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eI{constructor(e){this.ti=e,this.docs=(function(){return new vn(Dt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ve.resolve(i?i.document.mutableCopy():br.newInvalidDocument(t))}getEntries(e,t){let i=ki();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():br.newInvalidDocument(l))})),Ve.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ki();const d=t.path,p=new Dt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||SR(ER(x),i)<=0||(l.has(x.key)||dm(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return Ve.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Wt(9500)}ni(e,t){return Ve.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new tI(this)}getSize(e){return Ve.resolve(this.size)}}class tI extends GA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ve.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class sI{constructor(e){this.persistence=e,this.ri=new il((t=>ly(t)),cy),this.lastRemoteSnapshotVersion=ts.min(),this.highestTargetId=0,this.ii=0,this.si=new fy,this.targetCount=0,this.oi=rc._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ve.resolve()}getLastRemoteSnapshotVersion(e){return Ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ve.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ve.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new rc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ve.resolve()}updateTargetData(e,t){return this.lr(t),Ve.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ve.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ve.waitFor(u).next((()=>l))}getTargetCount(e){return Ve.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ve.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ve.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ve.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ve.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ve.resolve(i)}containsKey(e,t){return Ve.resolve(this.si.containsKey(t))}}class G_{constructor(e,t){this._i={},this.overlays={},this.ai=new im(0),this.ui=!1,this.ui=!0,this.ci=new JA,this.referenceDelegate=e(this),this.li=new sI(this),this.indexManager=new UA,this.remoteDocumentCache=(function(l){return new eI(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new BA(t),this.Pi=new QA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new ZA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){yt("MemoryPersistence","Starting transaction:",e);const l=new nI(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ve.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class nI extends CR{constructor(e){super(),this.currentSequenceNumber=e}}class py{constructor(e){this.persistence=e,this.Ri=new fy,this.Ai=null}static Vi(e){return new py(e)}get di(){if(this.Ai)return this.Ai;throw Wt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ve.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ve.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ve.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ve.forEach(this.di,(i=>{const l=Dt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,ts.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ve.or([()=>Ve.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hh{constructor(e,t){this.persistence=e,this.fi=new il((i=>IR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=WA(this,t)}static Vi(e,t){return new Hh(e,t)}Ti(){}Ii(e){return Ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ve.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ve.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,ts.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ve.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ve.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ve.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ve.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=kh(e.data.value)),t}wr(e,t,i){return Ve.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ve.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class gy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=js(),l=js();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new gy(e,t.fromCache,i,l)}}class rI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class aI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return IS()?8:RR(xr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new rI;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Hl()<=_s.DEBUG&&yt("QueryEngine","SDK will not create cache indexes for query:",$l(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ve.resolve()):(Hl()<=_s.DEBUG&&yt("QueryEngine","Query:",$l(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Hl()<=_s.DEBUG&&yt("QueryEngine","The SDK decides to create cache indexes for query:",$l(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$a(t))):Ve.resolve())}gs(e,t){if(Mx(t))return Ve.resolve(null);let i=$a(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=zh(t,null,"F"),i=$a(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=js(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,zh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Mx(t)||l.isEqual(ts.min())?Ve.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ve.resolve(null):(Hl()<=_s.DEBUG&&yt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),$l(t)),this.Ds(e,d,t,TR(l,ju)).next((p=>p)))}))}bs(e,t){let i=new Gn(__(e));return t.forEach(((l,u)=>{dm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Hl()<=_s.DEBUG&&yt("QueryEngine","Using full collection scan to execute query:",$l(t)),this.fs.getDocumentsMatchingQuery(e,t,uo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const yy="LocalStore",iI=3e8;class oI{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new vn(ks),this.Fs=new il((u=>ly(u)),cy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function lI(n,e,t,i){return new oI(n,e,t,i)}async function K_(n,e){const t=as(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=js();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function cI(n,e){const t=as(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const k=y.batch,j=k.keys();let B=Ve.resolve();return j.forEach((W=>{B=B.next((()=>x.getEntry(g,W))).next((V=>{const L=y.docVersions.get(W);Gs(L!==null,48541),V.version.compareTo(L)<0&&(k.applyToRemoteDocument(V,y),V.isValidDocument()&&(V.setReadTime(y.commitVersion),x.addEntry(V)))}))})),B.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=js();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Y_(n){const e=as(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function uI(n,e){const t=as(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,k)=>{const j=l.get(k);if(!j)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,k))));let B=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?B=B.withResumeToken(ur.EMPTY_BYTE_STRING,ts.min()).withLastLimboFreeSnapshotVersion(ts.min()):x.resumeToken.approximateByteSize()>0&&(B=B.withResumeToken(x.resumeToken,i)),l=l.insert(k,B),(function(V,L,ee){return V.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=iI?!0:ee.addedDocuments.size+ee.modifiedDocuments.size+ee.removedDocuments.size>0})(j,B,x)&&p.push(t.li.updateTargetData(u,B))}));let g=ki(),y=js();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(dI(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(ts.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return Ve.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function dI(n,e,t){let i=js(),l=js();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=ki();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(ts.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):yt(yy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function hI(n,e){const t=as(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ay),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function mI(n,e){const t=as(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ve.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new so(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Tg(n,e,t){const i=as(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!hc(d))throw d;yt(yy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Wx(n,e,t){const i=as(n);let l=ts.min(),u=js();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const k=as(g),j=k.Fs.get(x);return j!==void 0?Ve.resolve(k.vs.get(j)):k.li.getTargetData(y,x)})(i,d,$a(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:ts.min(),t?u:js()))).next((p=>(fI(i,eA(e),p),{documents:p,ks:u})))))}function fI(n,e,t){let i=n.Ms.get(e)||ts.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Gx{constructor(){this.activeTargetIds=iA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pI{constructor(){this.vo=new Gx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Gx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gI{Mo(e){}shutdown(){}}const Kx="ConnectivityMonitor";class Yx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){yt(Kx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){yt(Kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let oh=null;function Eg(){return oh===null?oh=(function(){return 268435456+Math.round(2147483648*Math.random())})():oh++,"0x"+oh.toString(16)}const Lp="RestConnection",yI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class bI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Vh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Eg(),p=this.Qo(e,t.toUriEncodedString());yt(Lp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=yo(y);return this.zo(e,p,g,i,x).then((k=>(yt(Lp,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw ec(Lp,`RPC '${e}' ${d} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+uc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=yI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class vI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const gr="WebChannelConnection",tu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Jl extends bI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Jl.c_){const e=Jw();tu(e,Xw.STAT_EVENT,(t=>{t.stat===fg.PROXY?yt(gr,"STAT_EVENT: detected buffering proxy"):t.stat===fg.NOPROXY&&yt(gr,"STAT_EVENT: detected no buffering proxy")})),Jl.c_=!0}}zo(e,t,i,l,u){const d=Eg();return new Promise(((p,g)=>{const y=new Yw;y.setWithCredentials(!0),y.listenOnce(Qw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case _h.NO_ERROR:const k=y.getResponseJson();yt(gr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),p(k);break;case _h.TIMEOUT:yt(gr,`RPC '${e}' ${d} timed out`),g(new ct(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case _h.HTTP_ERROR:const j=y.getStatus();if(yt(gr,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let B=y.getResponseJson();Array.isArray(B)&&(B=B[0]);const W=B?.error;if(W&&W.status&&W.message){const V=(function(ee){const Y=ee.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(Y)>=0?Y:Ae.UNKNOWN})(W.status);g(new ct(V,W.message))}else g(new ct(Ae.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ct(Ae.UNAVAILABLE,"Connection failed."));break;default:Wt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{yt(gr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);yt(gr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Eg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");yt(gr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let k=!1,j=!1;const B=new vI({Ho:W=>{j?yt(gr,`Not sending because RPC '${e}' stream ${l} is closed:`,W):(k||(yt(gr,`Opening RPC '${e}' stream ${l} transport.`),x.open(),k=!0),yt(gr,`RPC '${e}' stream ${l} sending:`,W),x.send(W))},Jo:()=>x.close()});return tu(x,cu.EventType.OPEN,(()=>{j||(yt(gr,`RPC '${e}' stream ${l} transport opened.`),B.i_())})),tu(x,cu.EventType.CLOSE,(()=>{j||(j=!0,yt(gr,`RPC '${e}' stream ${l} transport closed`),B.o_(),this.E_(x))})),tu(x,cu.EventType.ERROR,(W=>{j||(j=!0,ec(gr,`RPC '${e}' stream ${l} transport errored. Name:`,W.name,"Message:",W.message),B.o_(new ct(Ae.UNAVAILABLE,"The operation could not be completed")))})),tu(x,cu.EventType.MESSAGE,(W=>{if(!j){const V=W.data[0];Gs(!!V,16349);const L=V,ee=L?.error||L[0]?.error;if(ee){yt(gr,`RPC '${e}' stream ${l} received error:`,ee);const Y=ee.status;let te=(function(xe){const C=Vn[xe];if(C!==void 0)return P_(C)})(Y),we=ee.message;te===void 0&&(te=Ae.INTERNAL,we="Unknown error status: "+Y+" with message "+ee.message),j=!0,B.o_(new ct(te,we)),x.close()}else yt(gr,`RPC '${e}' stream ${l} received:`,V),B.__(V)}})),Jl.u_(),setTimeout((()=>{B.s_()}),0),B}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Zw()}}function xI(n){return new Jl(n)}function Op(){return typeof document<"u"?document:null}function gm(n){return new jA(n,!0)}Jl.c_=!1;class Q_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&yt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Qx="PersistentStream";class X_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Q_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ae.RESOURCE_EXHAUSTED?(_i(t.toString()),_i("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new ct(Ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return yt(Qx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(yt(Qx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class wI extends X_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return ts.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?ts.min():d.readTime?Wa(d.readTime):ts.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=jg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=vg(g)?{documents:RA(u,g)}:{query:AA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=B_(u,d.resumeToken);const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(ts.min())>0){p.readTime=qh(u,d.snapshotVersion.toTimestamp());const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=MA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=jg(this.serializer),t.removeTarget=e,this.K_(t)}}class _I extends X_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Gs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Gs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Gs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CA(e.writeResults,e.commitTime),i=Wa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=jg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>NA(this.serializer,i)))};this.K_(t)}}class kI{}class jI extends kI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new ct(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,_g(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ct(Ae.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,_g(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ct(Ae.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function TI(n,e,t,i){return new jI(n,e,t,i)}class EI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(_i(t),this.aa=!1):yt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const sl="RemoteStore";class SI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{ol(this)&&(yt(sl,"Restarting streams for network reachability change."),await(async function(g){const y=as(g);y.Ea.add(4),await Hu(y),y.Va.set("Unknown"),y.Ea.delete(4),await ym(y)})(this))}))})),this.Va=new EI(i,l)}}async function ym(n){if(ol(n))for(const e of n.Ra)await e(!0)}async function Hu(n){for(const e of n.Ra)await e(!1)}function J_(n,e){const t=as(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),wy(t)?xy(t):fc(t).O_()&&vy(t,e))}function by(n,e){const t=as(n),i=fc(t);t.Ia.delete(e),i.O_()&&Z_(t,e),t.Ia.size===0&&(i.O_()?i.L_():ol(t)&&t.Va.set("Unknown"))}function vy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ts.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fc(n).Z_(e)}function Z_(n,e){n.da.$e(e),fc(n).X_(e)}function xy(n){n.da=new xA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),fc(n).start(),n.Va.ua()}function wy(n){return ol(n)&&!fc(n).x_()&&n.Ia.size>0}function ol(n){return as(n).Ea.size===0}function ek(n){n.da=void 0}async function NI(n){n.Va.set("Online")}async function CI(n){n.Ia.forEach(((e,t)=>{vy(n,e)}))}async function RI(n,e){ek(n),wy(n)?(n.Va.ha(e),xy(n)):n.Va.set("Unknown")}async function AI(n,e,t){if(n.Va.set("Online"),e instanceof O_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){yt(sl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await $h(n,i)}else if(e instanceof Eh?n.da.Xe(e):e instanceof L_?n.da.st(e):n.da.tt(e),!t.isEqual(ts.min()))try{const i=await Y_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(ur.EMPTY_BYTE_STRING,x.snapshotVersion)),Z_(u,g);const k=new so(x.target,g,y,x.sequenceNumber);vy(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){yt(sl,"Failed to raise snapshot:",i),await $h(n,i)}}async function $h(n,e,t){if(!hc(e))throw e;n.Ea.add(1),await Hu(n),n.Va.set("Offline"),t||(t=()=>Y_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{yt(sl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ym(n)}))}function tk(n,e){return e().catch((t=>$h(n,t,e)))}async function bm(n){const e=as(n),t=po(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ay;for(;II(e);)try{const l=await hI(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MI(e,l)}catch(l){await $h(e,l)}sk(e)&&nk(e)}function II(n){return ol(n)&&n.Ta.length<10}function MI(n,e){n.Ta.push(e);const t=po(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function sk(n){return ol(n)&&!po(n).x_()&&n.Ta.length>0}function nk(n){po(n).start()}async function DI(n){po(n).ra()}async function PI(n){const e=po(n);for(const t of n.Ta)e.ea(t.mutations)}async function LI(n,e,t){const i=n.Ta.shift(),l=dy.from(i,e,t);await tk(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await bm(n)}async function OI(n,e){e&&po(n).Y_&&await(async function(i,l){if((function(d){return yA(d)&&d!==Ae.ABORTED})(l.code)){const u=i.Ta.shift();po(i).B_(),await tk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await bm(i)}})(n,e),sk(n)&&nk(n)}async function Xx(n,e){const t=as(n);t.asyncQueue.verifyOperationInProgress(),yt(sl,"RemoteStore received new credentials");const i=ol(t);t.Ea.add(3),await Hu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ym(t)}async function BI(n,e){const t=as(n);e?(t.Ea.delete(2),await ym(t)):e||(t.Ea.add(2),await Hu(t),t.Va.set("Unknown"))}function fc(n){return n.ma||(n.ma=(function(t,i,l){const u=as(t);return u.sa(),new wI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:NI.bind(null,n),Yo:CI.bind(null,n),t_:RI.bind(null,n),J_:AI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),wy(n)?xy(n):n.Va.set("Unknown")):(await n.ma.stop(),ek(n))}))),n.ma}function po(n){return n.fa||(n.fa=(function(t,i,l){const u=as(t);return u.sa(),new _I(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DI.bind(null,n),t_:OI.bind(null,n),ta:PI.bind(null,n),na:LI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await bm(n)):(await n.fa.stop(),n.Ta.length>0&&(yt(sl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class _y{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new bi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new _y(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(Ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ky(n,e){if(_i("AsyncQueue",`${e}: ${n}`),hc(n))return new ct(Ae.UNAVAILABLE,`${e}: ${n}`);throw n}class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Dt.comparator(t.key,i.key):(t,i)=>Dt.comparator(t.key,i.key),this.keyedMap=uu(),this.sortedSet=new vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Zl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Jx{constructor(){this.ga=new vn(Dt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Wt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ac{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ac(e,t,Zl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&um(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class VI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class UI{constructor(){this.queries=Zx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=as(t),u=l.queries;l.queries=Zx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new ct(Ae.ABORTED,"Firestore shutting down"))}}function Zx(){return new il((n=>w_(n)),um)}async function jy(n,e){const t=as(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new VI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=ky(d,`Initialization of query '${$l(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ey(t)}async function Ty(n,e){const t=as(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function FI(n,e){const t=as(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ey(t)}function zI(n,e,t){const i=as(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ey(n){n.Ca.forEach((e=>{e.next()}))}var Sg,e2;(e2=Sg||(Sg={})).Ma="default",e2.Cache="cache";class Sy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ac(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sg.Cache}}class rk{constructor(e){this.key=e}}class ak{constructor(e){this.key=e}}class qI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=js(),this.mutatedKeys=js(),this.eu=__(e),this.tu=new Zl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Jx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,k)=>{const j=l.get(x),B=dm(this.query,k)?k:null,W=!!j&&this.mutatedKeys.has(j.key),V=!!B&&(B.hasLocalMutations||this.mutatedKeys.has(B.key)&&B.hasCommittedMutations);let L=!1;j&&B?j.data.isEqual(B.data)?W!==V&&(i.track({type:3,doc:B}),L=!0):this.su(j,B)||(i.track({type:2,doc:B}),L=!0,(g&&this.eu(B,g)>0||y&&this.eu(B,y)<0)&&(p=!0)):!j&&B?(i.track({type:0,doc:B}),L=!0):j&&!B&&(i.track({type:1,doc:j}),L=!0,(g||y)&&(p=!0)),L&&(B?(d=d.add(B),u=V?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,k)=>(function(B,W){const V=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wt(20277,{Vt:L})}};return V(B)-V(W)})(x.type,k.type)||this.eu(x.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ac(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=js(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new ak(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new rk(i))})),t}cu(e){this.Za=e.ks,this.Ya=js();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ac.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ny="SyncEngine";class HI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $I{constructor(e){this.key=e,this.hu=!1}}class WI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new il((p=>w_(p)),um),this.Iu=new Map,this.Eu=new Set,this.Ru=new vn(Dt.comparator),this.Au=new Map,this.Vu=new fy,this.du={},this.mu=new Map,this.fu=rc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GI(n,e,t=!0){const i=dk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await ik(i,e,t,!0),l}async function KI(n,e){const t=dk(n);await ik(t,e,!0,!1)}async function ik(n,e,t,i){const l=await mI(n.localStore,$a(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await YI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&J_(n.remoteStore,l),p}async function YI(n,e,t,i,l){n.pu=(k,j,B)=>(async function(V,L,ee,Y){let te=L.view.ru(ee);te.Ss&&(te=await Wx(V.localStore,L.query,!1).then((({documents:C})=>L.view.ru(C,te))));const we=Y&&Y.targetChanges.get(L.targetId),Ce=Y&&Y.targetMismatches.get(L.targetId)!=null,xe=L.view.applyChanges(te,V.isPrimaryClient,we,Ce);return s2(V,L.targetId,xe.au),xe.snapshot})(n,k,j,B);const u=await Wx(n.localStore,e,!0),d=new qI(e,u.ks),p=d.ru(u.documents),g=qu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);s2(n,t,y.au);const x=new HI(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function QI(n,e,t){const i=as(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!um(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Tg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&by(i.remoteStore,l.targetId),Ng(i,l.targetId)})).catch(dc)):(Ng(i,l.targetId),await Tg(i.localStore,l.targetId,!0))}async function XI(n,e){const t=as(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),by(t.remoteStore,i.targetId))}async function JI(n,e,t){const i=aM(n);try{const l=await(function(d,p){const g=as(d),y=Rt.now(),x=p.reduce(((B,W)=>B.add(W.key)),js());let k,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(B=>{let W=ki(),V=js();return g.xs.getEntries(B,x).next((L=>{W=L,W.forEach(((ee,Y)=>{Y.isValidDocument()||(V=V.add(ee))}))})).next((()=>g.localDocuments.getOverlayedDocuments(B,W))).next((L=>{k=L;const ee=[];for(const Y of p){const te=hA(Y,k.get(Y.key).overlayedDocument);te!=null&&ee.push(new xo(Y.key,te,m_(te.value.mapValue),Nr.exists(!0)))}return g.mutationQueue.addMutationBatch(B,y,ee,p)})).next((L=>{j=L;const ee=L.applyToLocalDocumentSet(k,V);return g.documentOverlayCache.saveOverlays(B,L.batchId,ee)}))})).then((()=>({batchId:j.batchId,changes:j_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new vn(ks)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await $u(i,l.changes),await bm(i.remoteStore)}catch(l){const u=ky(l,"Failed to persist write");t.reject(u)}}async function ok(n,e){const t=as(n);try{const i=await uI(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Gs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Gs(d.hu,14607):l.removedDocuments.size>0&&(Gs(d.hu,42227),d.hu=!1))})),await $u(t,i,e)}catch(i){await dc(i)}}function t2(n,e,t){const i=as(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=as(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,k)=>{for(const j of k.ba)j.va(p)&&(y=!0)})),y&&Ey(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ZI(n,e,t){const i=as(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new vn(Dt.comparator);d=d.insert(u,br.newNoDocument(u,ts.min()));const p=js().add(u),g=new pm(ts.min(),new Map,new vn(ks),d,p);await ok(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Cy(i)}else await Tg(i.localStore,e,!1).then((()=>Ng(i,e,t))).catch(dc)}async function eM(n,e){const t=as(n),i=e.batch.batchId;try{const l=await cI(t.localStore,e);ck(t,i,null),lk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $u(t,l)}catch(l){await dc(l)}}async function tM(n,e,t){const i=as(n);try{const l=await(function(d,p){const g=as(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(Gs(k!==null,37113),x=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);ck(i,e,t),lk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $u(i,l)}catch(l){await dc(l)}}function lk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ck(n,e,t){const i=as(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||uk(n,i)}))}function uk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(by(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Cy(n))}function s2(n,e,t){for(const i of t)i instanceof rk?(n.Vu.addReference(i.key,e),sM(n,i)):i instanceof ak?(yt(Ny,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||uk(n,i.key)):Wt(19791,{wu:i})}function sM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(yt(Ny,"New document in limbo: "+t),n.Eu.add(i),Cy(n))}function Cy(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Dt(on.fromString(e)),i=n.fu.next();n.Au.set(i,new $I(t)),n.Ru=n.Ru.insert(t,i),J_(n.remoteStore,new so($a(cm(t.path)),i,"TargetPurposeLimboResolution",im.ce))}}async function $u(n,e,t){const i=as(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=gy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=as(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ve.forEach(y,(j=>Ve.forEach(j.Ts,(B=>x.persistence.referenceDelegate.addReference(k,j.targetId,B))).next((()=>Ve.forEach(j.Is,(B=>x.persistence.referenceDelegate.removeReference(k,j.targetId,B)))))))))}catch(k){if(!hc(k))throw k;yt(yy,"Failed to update sequence numbers: "+k)}for(const k of y){const j=k.targetId;if(!k.fromCache){const B=x.vs.get(j),W=B.snapshotVersion,V=B.withLastLimboFreeSnapshotVersion(W);x.vs=x.vs.insert(j,V)}}})(i.localStore,u))}async function nM(n,e){const t=as(n);if(!t.currentUser.isEqual(e)){yt(Ny,"User change. New user:",e.toKey());const i=await K_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new ct(Ae.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $u(t,i.Ns)}}function rM(n,e){const t=as(n),i=t.Au.get(e);if(i&&i.hu)return js().add(i.key);{let l=js();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function dk(n){const e=as(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ok.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZI.bind(null,e),e.Pu.J_=FI.bind(null,e.eventManager),e.Pu.yu=zI.bind(null,e.eventManager),e}function aM(n){const e=as(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tM.bind(null,e),e}class Wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return lI(this.persistence,new aI,e.initialUser,this.serializer)}Cu(e){return new G_(py.Vi,this.serializer)}Du(e){return new pI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wh.provider={build:()=>new Wh};class iM extends Wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Gs(this.persistence.referenceDelegate instanceof Hh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new HA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ur.withCacheSize(this.cacheSizeBytes):Ur.DEFAULT;return new G_((i=>Hh.Vi(i,t)),this.serializer)}}class Cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>t2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nM.bind(null,this.syncEngine),await BI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UI})()}createDatastore(e){const t=gm(e.databaseInfo.databaseId),i=xI(e.databaseInfo);return TI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new SI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>t2(this.syncEngine,t,0)),(function(){return Yx.v()?new Yx:new gI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const k=new WI(l,u,d,p,g,y);return x&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=as(t);yt(sl,"RemoteStore shutting down."),i.Ea.add(5),await Hu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cg.provider={build:()=>new Cg};class Ry{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):_i("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const go="FirestoreClient";class oM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=yr.UNAUTHENTICATED,this.clientId=ry.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{yt(go,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(yt(go,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ky(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Bp(n,e){n.asyncQueue.verifyOperationInProgress(),yt(go,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await K_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function n2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lM(n);yt(go,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Xx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Xx(e.remoteStore,l))),n._onlineComponents=e}async function lM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){yt(go,"Using user provided OfflineComponentProvider");try{await Bp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Ae.FAILED_PRECONDITION||l.code===Ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;ec("Error using user provided cache. Falling back to memory cache: "+t),await Bp(n,new Wh)}}else yt(go,"Using default OfflineComponentProvider"),await Bp(n,new iM(void 0));return n._offlineComponents}async function hk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(yt(go,"Using user provided OnlineComponentProvider"),await n2(n,n._uninitializedComponentsProvider._online)):(yt(go,"Using default OnlineComponentProvider"),await n2(n,new Cg))),n._onlineComponents}function cM(n){return hk(n).then((e=>e.syncEngine))}async function Gh(n){const e=await hk(n),t=e.eventManager;return t.onListen=GI.bind(null,e.syncEngine),t.onUnlisten=QI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XI.bind(null,e.syncEngine),t}function uM(n,e,t,i){const l=new Ry(i),u=new Sy(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>jy(await Gh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Ty(await Gh(n),u)))}}function dM(n,e,t={}){const i=new bi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Ry({next:j=>{x.Nu(),d.enqueueAndForget((()=>Ty(u,k)));const B=j.docs.has(p);!B&&j.fromCache?y.reject(new ct(Ae.UNAVAILABLE,"Failed to get document because the client is offline.")):B&&j.fromCache&&g&&g.source==="server"?y.reject(new ct(Ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new Sy(cm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return jy(u,k)})(await Gh(n),n.asyncQueue,e,t,i))),i.promise}function hM(n,e,t={}){const i=new bi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Ry({next:j=>{x.Nu(),d.enqueueAndForget((()=>Ty(u,k))),j.fromCache&&g.source==="server"?y.reject(new ct(Ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new Sy(p,x,{includeMetadataChanges:!0,Ka:!0});return jy(u,k)})(await Gh(n),n.asyncQueue,e,t,i))),i.promise}function mM(n,e){const t=new bi;return n.asyncQueue.enqueueAndForget((async()=>JI(await cM(n),e,t))),t.promise}function mk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const fM="ComponentProvider",r2=new Map;function pM(n,e,t,i,l){return new PR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,mk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const fk="firestore.googleapis.com",a2=!0;class i2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ct(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fk,this.ssl=a2}else this.host=e.host,this.ssl=e.ssl??a2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=W_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zA)throw new ct(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ct(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ct(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ct(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new mR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ct(Ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=r2.get(t);i&&(yt(fM,"Removing Datastore"),r2.delete(t),i.terminate())})(this),Promise.resolve()}}function gM(n,e,t,i={}){n=Sr(n,vm);const l=yo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(zg(`https://${p}`),qg("Firestore",!0)),u.host!==fk&&u.host!==p&&ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Xo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=yr.MOCK_USER;else{y=lw(i.mockUserToken,n._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new ct(Ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new yr(k)}n._authCredentials=new fR(new t_(y,x))}}class Ei{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ei(this.firestore,e,this._query)}}class Tn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Fu(t,Tn._jsonSchema))return new Tn(e,i||null,new Dt(on.fromString(t.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:Fn("string",Tn._jsonSchemaVersion),referencePath:Fn("string")};class lo extends Ei{constructor(e,t,i){super(e,t,cm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Dt(e))}withConverter(e){return new lo(this.firestore,e,this._path)}}function Ht(n,e,...t){if(n=Zs(n),s_("collection","path",e),n instanceof vm){const i=on.fromString(e,...t);return vx(i),new lo(n,null,i)}{if(!(n instanceof Tn||n instanceof lo))throw new ct(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(on.fromString(e,...t));return vx(i),new lo(n.firestore,null,i)}}function Ke(n,e,...t){if(n=Zs(n),arguments.length===1&&(e=ry.newId()),s_("doc","path",e),n instanceof vm){const i=on.fromString(e,...t);return bx(i),new Tn(n,null,new Dt(i))}{if(!(n instanceof Tn||n instanceof lo))throw new ct(Ae.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(on.fromString(e,...t));return bx(i),new Tn(n.firestore,n instanceof lo?n.converter:null,new Dt(i))}}const o2="AsyncQueue";class l2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Q_(this,"async_queue_retry"),this._c=()=>{const i=Op();i&&yt(o2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Op();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Op();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new bi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!hc(e))throw e;yt(o2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,_i("INTERNAL UNHANDLED ERROR: ",c2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=_y.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Wt(47125,{Pc:c2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function c2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ya extends vm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new l2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l2(e),this._firestoreClient=void 0,await e}}}function yM(n,e){const t=typeof n=="object"?n:Gg(),i=typeof n=="string"?n:Vh,l=tm(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=aw("firestore");u&&gM(l,...u)}return l}function Wu(n){if(n._terminated)throw new ct(Ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bM(n),n._firestoreClient}function bM(n){const e=n._freezeSettings(),t=pM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new oM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class da{constructor(e){this._byteString=e}static fromBase64String(e){try{return new da(ur.fromBase64String(e))}catch(t){throw new ct(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new da(ur.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:da._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fu(e,da._jsonSchema))return da.fromBase64String(e.bytes)}}da._jsonSchemaVersion="firestore/bytes/1.0",da._jsonSchema={type:Fn("string",da._jsonSchemaVersion),bytes:Fn("string")};class xm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ct(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gu{constructor(e){this._methodName=e}}class Ga{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ct(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ct(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ks(this._lat,e._lat)||ks(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ga._jsonSchemaVersion}}static fromJSON(e){if(Fu(e,Ga._jsonSchema))return new Ga(e.latitude,e.longitude)}}Ga._jsonSchemaVersion="firestore/geoPoint/1.0",Ga._jsonSchema={type:Fn("string",Ga._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};class Ea{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ea._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fu(e,Ea._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ea(e.vectorValues);throw new ct(Ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ea._jsonSchemaVersion="firestore/vectorValue/1.0",Ea._jsonSchema={type:Fn("string",Ea._jsonSchemaVersion),vectorValues:Fn("object")};const vM=/^__.*__$/;class xM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new xo(e,this.data,this.fieldMask,t,this.fieldTransforms):new zu(e,this.data,t,this.fieldTransforms)}}class pk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new xo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Wt(40011,{dataSource:n})}}class Ay{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ay({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Kh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(gk(this.dataSource)&&vM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class wM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gm(e)}createContext(e,t,i,l=!1){return new Ay({dataSource:e,methodName:t,targetDoc:i,path:cr.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ku(n){const e=n._freezeSettings(),t=gm(n._databaseId);return new wM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Iy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Py("Data must be an object, but it was:",d,i);const p=vk(i,d);let g,y;if(u.merge)g=new Jr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const k of u.mergeFields){const j=nl(e,k,t);if(!d.contains(j))throw new ct(Ae.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);_k(x,j)||x.push(j)}g=new Jr(x),y=d.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=d.fieldTransforms;return new xM(new Fr(p),g,y)}class wm extends Gu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wm}}class My extends Gu{_toFieldTransform(e){return new I_(e.path,new Cu)}isEqual(e){return e instanceof My}}class Dy extends Gu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Iu(e.serializer,S_(e.serializer,this.Vc));return new I_(e.path,t)}isEqual(e){return e instanceof Dy&&this.Vc===e.Vc}}function yk(n,e,t,i){const l=n.createContext(1,e,t);Py("Data must be an object, but it was:",l,i);const u=[],d=Fr.empty();vo(i,((g,y)=>{const x=wk(e,g,t);y=Zs(y);const k=l.childContextForFieldPath(x);if(y instanceof wm)u.push(x);else{const j=Yu(y,k);j!=null&&(u.push(x),d.set(x,j))}}));const p=new Jr(u);return new pk(d,p,l.fieldTransforms)}function bk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[nl(e,i,t)],g=[l];if(u.length%2!=0)throw new ct(Ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(nl(e,u[j])),g.push(u[j+1]);const y=[],x=Fr.empty();for(let j=p.length-1;j>=0;--j)if(!_k(y,p[j])){const B=p[j];let W=g[j];W=Zs(W);const V=d.childContextForFieldPath(B);if(W instanceof wm)y.push(B);else{const L=Yu(W,V);L!=null&&(y.push(B),x.set(B,L))}}const k=new Jr(y);return new pk(x,k,d.fieldTransforms)}function _M(n,e,t,i=!1){return Yu(t,n.createContext(i?4:3,e))}function Yu(n,e){if(xk(n=Zs(n)))return Py("Unsupported field value:",e,n),vk(n,e);if(n instanceof Gu)return(function(i,l){if(!gk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Yu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Zs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return S_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Rt.fromDate(i);return{timestampValue:qh(l.serializer,u)}}if(i instanceof Rt){const u=new Rt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:qh(l.serializer,u)}}if(i instanceof Ga)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof da)return{bytesValue:B_(l.serializer,i._byteString)};if(i instanceof Tn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:my(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof Ea)return(function(d,p){const g=d instanceof Ea?d.toArray():d;return{mapValue:{fields:{[d_]:{stringValue:h_},[Uh]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return uy(p.serializer,x)}))}}}}}})(i,l);if($_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${am(i)}`)})(n,e)}function vk(n,e){const t={};return a_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vo(n,((i,l)=>{const u=Yu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function xk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rt||n instanceof Ga||n instanceof da||n instanceof Tn||n instanceof Gu||n instanceof Ea||$_(n))}function Py(n,e,t){if(!xk(t)||!n_(t)){const i=am(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function nl(n,e,t){if((e=Zs(e))instanceof xm)return e._internalPath;if(typeof e=="string")return wk(n,e);throw Kh("Field path arguments must be of type string or ",n,!1,void 0,t)}const kM=new RegExp("[~\\*/\\[\\]]");function wk(n,e,t){if(e.search(kM)>=0)throw Kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xm(...e.split("."))._internalPath}catch{throw Kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new ct(Ae.INVALID_ARGUMENT,p+n+g)}function _k(n,e){return n.some((t=>t.isEqual(e)))}class jM{convertValue(e,t="none"){switch(fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return In(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Wt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return vo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Uh].arrayValue?.values?.map((i=>In(i.doubleValue)));return new Ea(t)}convertGeoPoint(e){return new Ga(In(e.latitude),In(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=lm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Tu(e));default:return null}}convertTimestamp(e){const t=ho(e);return new Rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=on.fromString(e);Gs(H_(i),9688,{name:e});const l=new Eu(i.get(1),i.get(3)),u=new Dt(i.popFirst(5));return l.isEqual(t)||_i(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Ly extends jM{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,t)}}function vr(){return new My("serverTimestamp")}function Wo(n){return new Dy("increment",n)}const u2="@firebase/firestore",d2="4.10.0";function h2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class kk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(nl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class TM extends kk{data(){return super.data()}}function jk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ct(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Oy{}class By extends Oy{}function Fs(n,e,...t){let i=[];e instanceof Oy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Vy)).length,p=u.filter((g=>g instanceof _m)).length;if(d>1||d>0&&p>0)throw new ct(Ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class _m extends By{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new _m(e,t,i)}_apply(e){const t=this._parse(e);return Tk(e._query,t),new Ei(e.firestore,e.converter,xg(e._query,t))}_parse(e){const t=Ku(e.firestore);return(function(u,d,p,g,y,x,k){let j;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ct(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){f2(k,x);const W=[];for(const V of k)W.push(m2(g,u,V));j={arrayValue:{values:W}}}else j=m2(g,u,k)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||f2(k,x),j=_M(p,d,k,x==="in"||x==="not-in");return Un.create(y,x,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bs(n,e,t){const i=e,l=nl("where",n);return _m._create(l,i,t)}class Vy extends Oy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Na.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)Tk(d,g),d=xg(d,g)})(e._query,t),new Ei(e.firestore,e.converter,xg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Uy extends By{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Uy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new ct(Ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new ct(Ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nu(u,d)})(e._query,this._field,this._direction);return new Ei(e.firestore,e.converter,ZR(e._query,t))}}function Yh(n,e="asc"){const t=e,i=nl("orderBy",n);return Uy._create(i,t)}class Fy extends By{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Fy(e,t,i)}_apply(e){return new Ei(e.firestore,e.converter,zh(e._query,this._limit,this._limitType))}}function Qh(n){return jR("limit",n),Fy._create("limit",n,"F")}function m2(n,e,t){if(typeof(t=Zs(t))=="string"){if(t==="")throw new ct(Ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!x_(e)&&t.indexOf("/")!==-1)throw new ct(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(on.fromString(t));if(!Dt.isDocumentKey(i))throw new ct(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Sx(n,new Dt(i))}if(t instanceof Tn)return Sx(n,t._key);throw new ct(Ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${am(t)}.`)}function f2(n,e){if(!Array.isArray(n)||n.length===0)throw new ct(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ct(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ct(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function zy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class hu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Go extends kk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Sh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(nl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Go._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Go._jsonSchemaVersion="firestore/documentSnapshot/1.0",Go._jsonSchema={type:Fn("string",Go._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class Sh extends Go{data(e={}){return super.data(e)}}class Ko{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new hu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Sh(this._firestore,this._userDataWriter,i.key,i,new hu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ct(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Sh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new hu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Sh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new hu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:EM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ko._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ry.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wt(61501,{type:n})}}Ko._jsonSchemaVersion="firestore/querySnapshot/1.0",Ko._jsonSchema={type:Fn("string",Ko._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class SM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ku(e)}set(e,t,i){this._verifyNotCommitted();const l=Vp(e,this._firestore),u=zy(l.converter,t,i),d=Iy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Nr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Vp(e,this._firestore);let d;return d=typeof(t=Zs(t))=="string"||t instanceof xm?bk(this._dataReader,"WriteBatch.update",u._key,t,i,l):yk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Nr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vp(e,this._firestore);return this._mutations=this._mutations.concat(new fm(t._key,Nr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ct(Ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Vp(n,e){if((n=Zs(n)).firestore!==e)throw new ct(Ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Ls(n){n=Sr(n,Tn);const e=Sr(n.firestore,Ya),t=Wu(e);return dM(t,n._key).then((i=>Sk(e,n,i)))}function As(n){n=Sr(n,Ei);const e=Sr(n.firestore,Ya),t=Wu(e),i=new Ly(e);return jk(n._query),hM(t,n._query).then((l=>new Ko(e,i,n,l)))}function Is(n,e,t){n=Sr(n,Tn);const i=Sr(n.firestore,Ya),l=zy(n.converter,e,t),u=Ku(i);return Qu(i,[Iy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Nr.none())])}function ja(n,e,t,...i){n=Sr(n,Tn);const l=Sr(n.firestore,Ya),u=Ku(l);let d;return d=typeof(e=Zs(e))=="string"||e instanceof xm?bk(u,"updateDoc",n._key,e,t,i):yk(u,"updateDoc",n._key,e),Qu(l,[d.toMutation(n._key,Nr.exists(!0))])}function Tr(n){return Qu(Sr(n.firestore,Ya),[new fm(n._key,Nr.none())])}function ha(n,e){const t=Sr(n.firestore,Ya),i=Ke(n),l=zy(n.converter,e),u=Ku(n.firestore);return Qu(t,[Iy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Nr.exists(!1))]).then((()=>i))}function Ek(n,...e){n=Zs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||h2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(h2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof Tn)d=Sr(n.firestore,Ya),p=cm(n._key.path),u={next:y=>{e[i]&&e[i](Sk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=Sr(n,Ei);d=Sr(y.firestore,Ya),p=y._query;const x=new Ly(d);u={next:k=>{e[i]&&e[i](new Ko(d,x,y,k))},error:e[i+1],complete:e[i+2]},jk(n._query)}const g=Wu(d);return uM(g,p,l,u)}function Qu(n,e){const t=Wu(n);return mM(t,e)}function Sk(n,e,t){const i=t.docs.get(e._key),l=new Ly(n);return new Go(n,l,e._key,i,new hu(t.hasPendingWrites,t.fromCache),e.converter)}function p2(n){return n=Sr(n,Ya),Wu(n),new SM(n,(e=>Qu(n,e)))}(function(e,t=!0){hR(al),Jo(new co("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ya(new pR(i.getProvider("auth-internal")),new bR(d,i.getProvider("app-check-internal")),LR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),za(u2,d2,e),za(u2,d2,"esm2020")})();var NM="firebase",CM="12.8.0";za(NM,CM,"app");const Nk="firebasestorage.googleapis.com",Ck="storageBucket",RM=120*1e3,AM=600*1e3;class Sn extends Qa{constructor(e,t,i=0){super(Up(e),`Firebase Storage: ${t} (${Up(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Sn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Up(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var En;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(En||(En={}));function Up(n){return"storage/"+n}function qy(){const n="An unknown error occurred, please check the error payload for server response.";return new Sn(En.UNKNOWN,n)}function IM(n){return new Sn(En.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function MM(n){return new Sn(En.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function DM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Sn(En.UNAUTHENTICATED,n)}function PM(){return new Sn(En.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function LM(n){return new Sn(En.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function OM(){return new Sn(En.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BM(){return new Sn(En.CANCELED,"User canceled the upload/download.")}function VM(n){return new Sn(En.INVALID_URL,"Invalid URL '"+n+"'.")}function UM(n){return new Sn(En.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FM(){return new Sn(En.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ck+"' property when initializing the app?")}function zM(){return new Sn(En.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qM(){return new Sn(En.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function HM(n){return new Sn(En.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rg(n){return new Sn(En.INVALID_ARGUMENT,n)}function Rk(){return new Sn(En.APP_DELETED,"The Firebase app was deleted.")}function $M(n){return new Sn(En.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vu(n,e){return new Sn(En.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function su(n){throw new Sn(En.INTERNAL_ERROR,"Internal error: "+n)}class Er{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Er.makeFromUrl(e,t)}catch{return new Er(e,"")}if(i.path==="")return i;throw UM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(we){we.path.charAt(we.path.length-1)==="/"&&(we.path_=we.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(we){we.path_=decodeURIComponent(we.path)}const x="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",B=new RegExp(`^https?://${k}/${x}/b/${l}/o${j}`,"i"),W={bucket:1,path:3},V=t===Nk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,L="([^?#]*)",ee=new RegExp(`^https?://${V}/${l}/${L}`,"i"),te=[{regex:p,indices:g,postModify:u},{regex:B,indices:W,postModify:y},{regex:ee,indices:{bucket:1,path:2},postModify:y}];for(let we=0;we<te.length;we++){const Ce=te[we],xe=Ce.regex.exec(e);if(xe){const C=xe[Ce.indices.bucket];let T=xe[Ce.indices.path];T||(T=""),i=new Er(C,T),Ce.postModify(i);break}}if(i==null)throw VM(e);return i}}class WM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function GM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...L){y||(y=!0,e.apply(null,L))}function k(L){l=setTimeout(()=>{l=null,n(B,g())},L)}function j(){u&&clearTimeout(u)}function B(L,...ee){if(y){j();return}if(L){j(),x.call(null,L,...ee);return}if(g()||d){j(),x.call(null,L,...ee);return}i<64&&(i*=2);let te;p===1?(p=2,te=0):te=(i+Math.random())*1e3,k(te)}let W=!1;function V(L){W||(W=!0,j(),!y&&(l!==null?(L||(p=2),clearTimeout(l),k(0)):L||(p=1)))}return k(0),u=setTimeout(()=>{d=!0,V(!0)},t),V}function KM(n){n(!1)}function YM(n){return n!==void 0}function QM(n){return typeof n=="object"&&!Array.isArray(n)}function Hy(n){return typeof n=="string"||n instanceof String}function g2(n){return $y()&&n instanceof Blob}function $y(){return typeof Blob<"u"}function Ag(n,e,t,i){if(i<e)throw Rg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rg(`Invalid value for '${n}'. Expected ${t} or less.`)}function km(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Ak(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Yo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Yo||(Yo={}));function XM(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class JM{constructor(e,t,i,l,u,d,p,g,y,x,k,j=!0,B=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=k,this.retry=j,this.isUsingEmulator=B,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((W,V)=>{this.resolve_=W,this.reject_=V,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new lh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Yo.NO_ERROR,g=u.getStatus();if(!p||XM(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Yo.ABORT;i(!1,new lh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new lh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());YM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=qy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Rk():BM();d(g)}else{const g=OM();d(g)}};this.canceled_?t(!1,new lh(!1,null,!0)):this.backoffId_=GM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function ZM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function e3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function t3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function s3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function n3(n,e,t,i,l,u,d=!0,p=!1){const g=Ak(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return t3(x,e),ZM(x,t),e3(x,u),s3(x,i),new JM(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function r3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function a3(...n){const e=r3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if($y())return new Blob(n);throw new Sn(En.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function i3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function o3(n){if(typeof atob>"u")throw HM("base-64");return atob(n)}const Fa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Fp{constructor(e,t){this.data=e,this.contentType=t||null}}function l3(n,e){switch(n){case Fa.RAW:return new Fp(Ik(e));case Fa.BASE64:case Fa.BASE64URL:return new Fp(Mk(n,e));case Fa.DATA_URL:return new Fp(u3(e),d3(e))}throw qy()}function Ik(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function c3(n){let e;try{e=decodeURIComponent(n)}catch{throw vu(Fa.DATA_URL,"Malformed data URL.")}return Ik(e)}function Mk(n,e){switch(n){case Fa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw vu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Fa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw vu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=o3(e)}catch(l){throw l.message.includes("polyfill")?l:vu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Dk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw vu(Fa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=h3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function u3(n){const e=new Dk(n);return e.base64?Mk(Fa.BASE64,e.rest):c3(e.rest)}function d3(n){return new Dk(n).contentType}function h3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class to{constructor(e,t){let i=0,l="";g2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(g2(this.data_)){const i=this.data_,l=i3(i,e,t);return l===null?null:new to(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new to(i,!0)}}static getBlob(...e){if($y()){const t=e.map(i=>i instanceof to?i.data_:i);return new to(a3.apply(null,t))}else{const t=e.map(d=>Hy(d)?l3(Fa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new to(l,!0)}}uploadData(){return this.data_}}function Wy(n){let e;try{e=JSON.parse(n)}catch{return null}return QM(e)?e:null}function m3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function f3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Pk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function p3(n,e){return e}class jr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||p3}}let ch=null;function g3(n){return!Hy(n)||n.length<2?n:Pk(n)}function Lk(){if(ch)return ch;const n=[];n.push(new jr("bucket")),n.push(new jr("generation")),n.push(new jr("metageneration")),n.push(new jr("name","fullPath",!0));function e(u,d){return g3(d)}const t=new jr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new jr("size");return l.xform=i,n.push(l),n.push(new jr("timeCreated")),n.push(new jr("updated")),n.push(new jr("md5Hash",null,!0)),n.push(new jr("cacheControl",null,!0)),n.push(new jr("contentDisposition",null,!0)),n.push(new jr("contentEncoding",null,!0)),n.push(new jr("contentLanguage",null,!0)),n.push(new jr("contentType",null,!0)),n.push(new jr("metadata","customMetadata",!0)),ch=n,ch}function y3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new Er(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function b3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return y3(i,n),i}function Ok(n,e,t){const i=Wy(e);return i===null?null:b3(n,i,t)}function v3(n,e,t,i){const l=Wy(e);if(l===null||!Hy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,k=n.fullPath,j="/b/"+d(x)+"/o/"+d(k),B=km(j,t,i),W=Ak({alt:"media",token:y});return B+W})[0]}function x3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const y2="prefixes",b2="items";function w3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[y2])for(const l of t[y2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new Er(e,u));i.prefixes.push(d)}if(t[b2])for(const l of t[b2]){const u=n._makeStorageReference(new Er(e,l.name));i.items.push(u)}return i}function _3(n,e,t){const i=Wy(t);return i===null?null:w3(n,e,i)}class Gy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ky(n){if(!n)throw qy()}function k3(n,e){function t(i,l){const u=Ok(n,l,e);return Ky(u!==null),u}return t}function j3(n,e){function t(i,l){const u=_3(n,e,l);return Ky(u!==null),u}return t}function T3(n,e){function t(i,l){const u=Ok(n,l,e);return Ky(u!==null),v3(u,l,n.host,n._protocol)}return t}function Yy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=PM():l=DM():t.getStatus()===402?l=MM(n.bucket):t.getStatus()===403?l=LM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function E3(n){const e=Yy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=IM(n.path)),u.serverResponse=l.serverResponse,u}return t}function S3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=km(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Gy(p,g,j3(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Yy(e),x}function N3(n,e,t){const i=e.fullServerUrl(),l=km(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Gy(l,u,T3(n,t),d);return p.errorHandler=E3(e),p}function C3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function R3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=C3(null,e)),i}function A3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let te="";for(let we=0;we<2;we++)te=te+Math.random().toString().slice(2);return te}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=R3(e,i,l),x=x3(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",B=to.getBlob(k,i,j);if(B===null)throw zM();const W={name:y.fullPath},V=km(u,n.host,n._protocol),L="POST",ee=n.maxUploadRetryTime,Y=new Gy(V,L,k3(n,t),ee);return Y.urlParams=W,Y.headers=d,Y.body=B.uploadData(),Y.errorHandler=Yy(e),Y}class I3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Yo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Yo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Yo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw su("cannot .send() more than once");if(yo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw su("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw su("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw su("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw su("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class M3 extends I3{initXhr(){this.xhr_.responseType="text"}}function Qy(){return new M3}class rl{constructor(e,t){this._service=e,t instanceof Er?this._location=t:this._location=Er.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new rl(e,t)}get root(){const e=new Er(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Pk(this._location.path)}get storage(){return this._service}get parent(){const e=m3(this._location.path);if(e===null)return null;const t=new Er(this._location.bucket,e);return new rl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $M(e)}}function D3(n,e,t){n._throwIfRoot("uploadBytes");const i=A3(n.storage,n._location,Lk(),new to(e,!0),t);return n.storage.makeRequestWithTokens(i,Qy).then(l=>({metadata:l,ref:n}))}function P3(n){const e={prefixes:[],items:[]};return Bk(n,e).then(()=>e)}async function Bk(n,e,t){const l=await L3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Bk(n,e,l.nextPageToken)}function L3(n,e){e!=null&&typeof e.maxResults=="number"&&Ag("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=S3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Qy)}function O3(n){n._throwIfRoot("getDownloadURL");const e=N3(n.storage,n._location,Lk());return n.storage.makeRequestWithTokens(e,Qy).then(t=>{if(t===null)throw qM();return t})}function B3(n,e){const t=f3(n._location.path,e),i=new Er(n._location.bucket,t);return new rl(n.storage,i)}function V3(n){return/^[A-Za-z]+:\/\//.test(n)}function U3(n,e){return new rl(n,e)}function Vk(n,e){if(n instanceof Xy){const t=n;if(t._bucket==null)throw FM();const i=new rl(t,t._bucket);return e!=null?Vk(i,e):i}else return e!==void 0?B3(n,e):n}function F3(n,e){if(e&&V3(e)){if(n instanceof Xy)return U3(n,e);throw Rg("To use ref(service, url), the first argument must be a Storage instance.")}else return Vk(n,e)}function v2(n,e){const t=e?.[Ck];return t==null?null:Er.makeFromBucketSpec(t,n)}function z3(n,e,t,i={}){n.host=`${e}:${t}`;const l=yo(e);l&&(zg(`https://${n.host}/b`),qg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:lw(u,n.app.options.projectId))}class Xy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Nk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RM,this._maxUploadRetryTime=AM,this._requests=new Set,l!=null?this._bucket=Er.makeFromBucketSpec(l,this._host):this._bucket=v2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Er.makeFromBucketSpec(this._url,e):this._bucket=v2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rl(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new WM(Rk());{const d=n3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const x2="@firebase/storage",w2="0.14.0";const Uk="storage";function zp(n,e,t){return n=Zs(n),D3(n,e,t)}function _2(n){return n=Zs(n),P3(n)}function Qo(n){return n=Zs(n),O3(n)}function no(n,e){return n=Zs(n),F3(n,e)}function q3(n=Gg(),e){n=Zs(n);const i=tm(n,Uk).getImmediate({identifier:e}),l=aw("storage");return l&&H3(i,...l),i}function H3(n,e,t,i={}){z3(n,e,t,i)}function $3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Xy(t,i,l,e,al)}function W3(){Jo(new co(Uk,$3,"PUBLIC").setMultipleInstances(!0)),za(x2,w2,""),za(x2,w2,"esm2020")}W3();const Fk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Jy=Wg(Fk),Uo=Gw(Jy),pe=yM(Jy),ro=q3(Jy),G3=Wg(Fk,"secondary"),qP=Gw(G3),K3="EYdciKDOi3UYBLk1u8hHams5tmO2",zk=v.createContext();function zr(){return v.useContext(zk)}function Y3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,x]=v.useState(!0);v.useEffect(()=>{let Y=null;const te=e4(Uo,we=>{if(t(we),Y&&(Y(),Y=null),we)if(we.uid===K3)l(!0),d(!1),g(null),x(!1);else{l(!1);const Ce=Fs(Ht(pe,"clients"),bs("uid","==",we.uid)),xe=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const T=await Ls(Ke(pe,"clients",C));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Y=Ek(Ce,async C=>{if(C.empty)await xe();else{const T=C.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}x(!1)},async C=>{console.error("Error listening to client data:",C),await xe(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{te(),Y&&Y()}},[]);const ee={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(te=>te?{...te,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const te=await Ls(Ke(pe,"clients",Y));if(te.exists()){const we={id:te.id,...te.data()};return d(!0),g(we),we}}catch(te){console.error("resolveClient direct read failed:",te)}if(e){const te=Fs(Ht(pe,"clients"),bs("uid","==",e.uid)),we=await As(te);if(!we.empty){const Ce={id:we.docs[0].id,...we.docs[0].data()};return d(!0),g(Ce),Ce}}return null},login:async(Y,te,we=!0)=>(await ax(Uo,we?hg:ey),await XC(Uo,Y,te)),signup:async(Y,te,we)=>{await ax(Uo,hg);const Ce=await QC(Uo,te.trim().toLowerCase(),we),xe=Ce.user,C=Ke(Ht(pe,"clients")),T={uid:xe.uid,name:Y.trim(),email:te.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Rt.now()};await Is(C,T),d(!0),g({id:C.id,...T});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Ce},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(Uo)},resetPassword:Y=>YC(Uo,Y),loading:y};return r.jsx(zk.Provider,{value:ee,children:n})}const qk=v.createContext();function Ia(){return v.useContext(qk)}function Q3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(qk.Provider,{value:p,children:n})}const Hk=v.createContext();function pc(){return v.useContext(Hk)}const X3=["nutrition","personalBests","achievements","buddies","programmes"],J3=[5,10],Z3=3,eD=1;function tD({children:n}){const{clientData:e,loading:t}=zr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!X3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:J3,FREE_RANDOMISER_WEEKLY_LIMIT:Z3,FREE_HABIT_LIMIT:eD}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Hk.Provider,{value:i,children:n})}function sD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function nD({className:n=""}){const{isDark:e,toggleTheme:t}=Ia();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function rD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[x,k]=v.useState(!1),[j,B]=v.useState(!1),{login:W,resetPassword:V,currentUser:L,isAdmin:ee,isClient:Y,clientData:te,loading:we}=zr(),Ce=dr();if(v.useEffect(()=>{!we&&L&&(ee?Ce("/dashboard"):Y?Ce(sD(te)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[we,L,ee,Y,te,Ce]),we||L)return null;const xe=async T=>{T.preventDefault(),p(""),y(!0);try{await W(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},C=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await V(n.trim()),B(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(nD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),B(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:xe,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Ce("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Bl({feature:n,children:e}){const{canAccess:t,loading:i}=pc();return i||t(n)?e:r.jsx(Y2,{to:"/upgrade",replace:!0})}function fa({active:n}){const e=dr(),{clientData:t}=zr(),{isPremium:i}=pc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Ca({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),x=v.useCallback(j=>{if(!g.current||l)return;const B=j.touches[0].clientY-p.current;B>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((B-20)*.35,80)))},[l]),k=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:k,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Xu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Zy=Xu(60,100,100,85,96),$k=Xu(60,100,100,78,94),aD=Xu(60,100,100,82,94);Xu(60,50,50,38,46);const k2=Xu(60,40,40,30,37),iD="/login/assets/first_workout-B8SFkzJX.PNG",oD="/login/assets/workouts_10-Z5R3u0xH.PNG",lD="/login/assets/workouts_25-CzxSlcAj.PNG",cD="/login/assets/workouts_50-BpzWup3V.PNG",uD="/login/assets/workouts_100-D7_r6tn1.PNG",dD="/login/assets/streak_2-CsRr-XA9.PNG",hD="/login/assets/streak_4-BHO09tbw.PNG",mD="/login/assets/streak_8-DX2UWMko.PNG",fD="/login/assets/first_pb-aVf_CNWy.PNG",pD="/login/assets/pbs_5-Cippawgg.PNG",gD="/login/assets/pbs_10-CZgGh9Kv.PNG",yD="/login/assets/pbs_100-C67b1wfS.PNG",bD="/login/assets/nutrition_7-CHVV11fj.PNG",vD="/login/assets/leaderboard_join-BLoId4Hz.PNG",xD="/login/assets/habits_7-Dvki70KO.PNG",Wn=[{id:"first_workout",img:iD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:oD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:lD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:cD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:uD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:dD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:hD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:mD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:fD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:pD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:gD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:yD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:bD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:vD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:xD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function wD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,x]=v.useState(!1),k=v.useRef(null),j=v.useRef(t);j.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Ce=xe=>xe.preventDefault();return document.addEventListener("touchmove",Ce,{passive:!1}),document.addEventListener("wheel",Ce,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ce),document.removeEventListener("wheel",Ce),document.body.style.overflow=""}},[t]);const B=v.useMemo(()=>t?n.filter(Ce=>document.querySelector(Ce.selector)):[],[t]),W=B[i],V=i===B.length-1,L=W?.selector,ee=v.useCallback(()=>{if(!L)return;const Ce=document.querySelector(L);if(!Ce){d(null);return}const xe=Ce.getBoundingClientRect(),C=8;d({top:xe.top-C,left:xe.left-C,width:xe.width+C*2,height:xe.height+C*2});const T=window.innerHeight-xe.bottom;g(T<260?"above":"below")},[L]);if(v.useEffect(()=>{if(!t||!L)return;x(!0);const Ce=document.querySelector(L);if(Ce){document.body.style.overflow="",Ce.scrollIntoView({behavior:"smooth",block:"center"});let xe=null,C=0,T=0;const A=60,O=()=>{T++;const I=Ce.getBoundingClientRect(),We=Math.round(I.top);if(xe!==null&&We===xe?C++:C=0,xe=We,C>=3||T>=A){j.current&&(document.body.style.overflow="hidden"),ee(),x(!1);return}M=requestAnimationFrame(O)};let M;const z=setTimeout(()=>{M=requestAnimationFrame(O)},120);return()=>{clearTimeout(z),M&&cancelAnimationFrame(M),j.current&&(document.body.style.overflow="hidden")}}},[t,i,L,ee]),v.useEffect(()=>{if(!t)return;const Ce=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(ee)};return window.addEventListener("scroll",Ce,!0),window.addEventListener("resize",Ce),()=>{window.removeEventListener("scroll",Ce,!0),window.removeEventListener("resize",Ce),k.current&&cancelAnimationFrame(k.current)}},[t,ee]),!t||!W||B.length===0)return null;const Y=()=>{V?e():l(i+1)},te=()=>{i>0&&l(i-1)},we=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Ce=>{Ce.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:B.map((Ce,xe)=>r.jsx("span",{className:`st-dot${xe===i?" active":""}${xe<i?" done":""}`},xe))}),r.jsx("h3",{className:"st-title",children:W.title}),r.jsx("p",{className:"st-body",children:W.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:te,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:W.cta||(V?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:we,children:"Skip tour"})]})]})}const j2=3,_D=5;function nu(n){return n.toISOString().split("T")[0]}const kD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},jD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},qp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Hp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function ru(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function TD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function ED(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=zr(),{isDark:d,toggleTheme:p}=Ia(),{isPremium:g,FREE_HABIT_LIMIT:y}=pc(),x=dr(),k=g?_D:y,[j,B]=v.useState({hours:0,minutes:0,seconds:0}),[W,V]=v.useState(0),[L,ee]=v.useState(0),[Y,te]=v.useState(""),[we,Ce]=v.useState(0),[xe,C]=v.useState(0),[T,A]=v.useState(!1),[O,M]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[z,I]=v.useState(null),[We,bt]=v.useState(0),[q,me]=v.useState(null),[Me,Ue]=v.useState(!1),[X,P]=v.useState(!1),[re,Pe]=v.useState(0),[Be,De]=v.useState(j2),[Ne,it]=v.useState(!1),[ft,et]=v.useState(!1),[Yt,Ts]=v.useState(0),[Pt,vt]=v.useState([]),[ie,Ct]=v.useState([]),[_t,zt]=v.useState(null),[Tt,kt]=v.useState(!1),tt=v.useRef(null),[pt,Qt]=v.useState([]),[zs,Ft]=v.useState(null),[At,is]=v.useState(null),Cs=v.useRef(null),[ss,sn]=v.useState(0),[Ms,Os]=v.useState(0),[ls,ps]=v.useState(0),[ye,Se]=v.useState(0),[Le,Qe]=v.useState(null),ze=v.useCallback((N,K="info")=>{Qe({message:N,type:K}),setTimeout(()=>Qe(null),4e3)},[]),[Xe,dt]=v.useState([]),[Q,se]=v.useState(!1),[He,gt]=v.useState(""),[Ye,J]=v.useState(null),[ke,qe]=v.useState(null),[nt,lt]=v.useState(!1),[St,Xt]=v.useState(new Set),[Bt,U]=v.useState(new Set),[fe,Re]=v.useState({}),[Te,je]=v.useState({}),[ht,Et]=v.useState({}),[ot,Lt]=v.useState({}),[It,nn]=v.useState({}),[hn,mn]=v.useState({}),rn=v.useRef(null),xn=v.useRef(null),ln=v.useRef({}),[ms,$]=v.useState([]),[de,ue]=v.useState(!1),E=v.useRef(null),[D,ne]=v.useState([]),[ae,$e]=v.useState(""),[Ge,Je]=v.useState(!1),[Vt,xt]=v.useState(null),[qt,vs]=v.useState([]),[yn,wr]=v.useState(null),[fs,ea]=v.useState(!1),Mn=v.useRef(!1),G=(()=>{const N=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&N.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),N.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),N})();v.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),v.useEffect(()=>{let N=t?.tourComplete||Mn.current;if(!N&&t?.id)try{N=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!N){const K=setTimeout(()=>ea(!0),600);return()=>clearTimeout(K)}},[T,t]),v.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const N=setTimeout(()=>et(!0),1500);return()=>clearTimeout(N)}}},[T,t]),v.useEffect(()=>{if(t)try{const N=sessionStorage.getItem(`cbDash_${t.id}`);if(N){const K=JSON.parse(N);ee(K.programmePct??0),te(K.programmeName??""),Ce(K.totalWorkouts??0),C(K.habitWeekPct??0),M(K.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),I(K.nutritionTargetData??null),bt(K.todayHabitsCount??0),me(K.nextSession??null),Ue(K.hasProgramme??!1),P(K.programmeComplete??!1),Pe(K.weeklyWorkouts??0),De(K.weeklyWorkoutTarget??j2),Ts(K.pbCount??0),vt(K.topPBs??[]),Ct(K.leaderboardTop3??[]),Qt(K.unlockedBadges??[]),Cs.current=K.unlockedBadges??[],sn(K.streakWeeks??0),A(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&zt(t.photoURL),t?.weeklyWorkoutTarget&&De(t.weeklyWorkoutTarget)},[t]),v.useEffect(()=>{if(!t)return;const N=Fs(Ht(pe,"notifications"),bs("toId","==",t.id)),K=Ek(N,Fe=>{const Ze=Fe.docs.map(wt=>({id:wt.id,...wt.data()}));Ze.sort((wt,Ot)=>{const ut=wt.createdAt?.toMillis?.()||0;return(Ot.createdAt?.toMillis?.()||0)-ut}),$(Ze.slice(0,50))},Fe=>{console.error("Notification listener error:",Fe),Fe.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>K()},[t]),v.useEffect(()=>{const N=K=>{E.current&&!E.current.contains(K.target)&&ue(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),v.useEffect(()=>{if(!t)return;const N=t.id;(async()=>{try{const[K,Fe,Ze]=await Promise.all([As(Fs(Ht(pe,"buddies"),bs("user1","==",N))),As(Fs(Ht(pe,"buddies"),bs("user2","==",N))),As(Ht(pe,"clients"))]),wt=new Set;[...K.docs,...Fe.docs].forEach(ut=>{const es=ut.data();wt.add(es.user1===N?es.user2:es.user1)});const Ot={};Ze.docs.forEach(ut=>{Ot[ut.id]=ut.data()}),ne(Array.from(wt).filter(ut=>Ot[ut]).map(ut=>({id:ut,name:Ot[ut].name,photoURL:Ot[ut].photoURL||null})))}catch(K){console.error("Error loading buddies for mentions:",K)}})()},[t]);const be=ms.filter(N=>!N.read).length,_e=async()=>{const N=ms.filter(Fe=>!Fe.read);if(!N.length)return;const K=p2(pe);N.forEach(Fe=>K.update(Ke(pe,"notifications",Fe.id),{read:!0})),await K.commit()},at=async()=>{if(!ms.length)return;const N=p2(pe);ms.forEach(K=>N.delete(Ke(pe,"notifications",K.id))),await N.commit()},rt=async(N,K,Fe={})=>{if(!(!t||N===t.id))try{await ha(Ht(pe,"notifications"),{toId:N,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:K,read:!1,createdAt:vr(),...Fe})}catch(Ze){console.error("Notification create error:",Ze),Ze.code==="permission-denied"&&ze("Notifications blocked  check Firestore rules","error")}},mt=(N,K)=>{const Fe=K==="compose"?rn.current?.selectionStart:null,wt=(Fe!=null?N.slice(0,Fe):N).match(/@(\w*)$/);if(wt){Je(!0),xt(K),$e(wt[1].toLowerCase());const Ot=D.filter(ut=>ut.name&&ut.name.toLowerCase().includes(wt[1].toLowerCase())).slice(0,5);vs(Ot)}else Je(!1),vs([])},Gt=(N,K)=>{if(K==="compose"){const Fe=rn.current,Ze=He,wt=Fe?.selectionStart??Ze.length,Ot=Ze.slice(0,wt),ut=Ze.slice(wt),es=Ot.replace(/@\w*$/,`@${N.name} `);gt(es+ut),setTimeout(()=>{Fe?.focus(),Fe.selectionStart=Fe.selectionEnd=es.length},0)}else{const Ze=(Te[K]||"").replace(/@\w*$/,`@${N.name} `);je(wt=>({...wt,[K]:Ze}))}Je(!1),vs([])},Kt=N=>N&&N.split(/(@\w[\w\s]*?\s)/g).map((Fe,Ze)=>Fe.startsWith("@")&&D.some(wt=>Fe.trim()===`@${wt.name}`)?r.jsx("span",{className:"mention-highlight",children:Fe.trim()},Ze):Fe),Jt=async N=>{const K=N.target.files?.[0];if(!(!K||!t)){if(!K.type.startsWith("image/")){ze("Please select an image file","error");return}if(K.size>5*1024*1024){ze("Image must be under 5MB","error");return}kt(!0);try{const Fe=await new Promise(Ot=>{const ut=new Image;ut.onload=()=>{const es=document.createElement("canvas"),ns=400;let Ss=ut.width,hs=ut.height;Ss>hs?(hs=hs/Ss*ns,Ss=ns):(Ss=Ss/hs*ns,hs=ns),es.width=Ss,es.height=hs,es.getContext("2d").drawImage(ut,0,0,Ss,hs),es.toBlob(Bs=>Ot(Bs),"image/jpeg",.75)},ut.src=URL.createObjectURL(K)}),Ze=no(ro,`profilePhotos/${t.id}`);await zp(Ze,Fe);const wt=await Qo(Ze);await ja(Ke(pe,"clients",t.id),{photoURL:wt}),zt(wt),l({photoURL:wt}),ze("Profile photo updated!","success")}catch(Fe){console.error("Photo upload error:",Fe),ze("Failed to upload photo","error")}kt(!1),tt.current&&(tt.current.value="")}};v.useEffect(()=>{const N=()=>{const Fe=new Date,Ze=new Date(Fe);Ze.setHours(23,59,59,999);const wt=Ze-Fe,Ot=Math.floor(wt/(1e3*60*60)),ut=Math.floor(wt%(1e3*60*60)/(1e3*60)),es=Math.floor(wt%(1e3*60)/1e3);B({hours:Ot,minutes:ut,seconds:es}),V(60-es)};N();const K=setInterval(N,1e3);return()=>clearInterval(K)},[]),v.useEffect(()=>{const N=setInterval(()=>{Se(K=>(K+1)%qp.length)},8e3);return()=>clearInterval(N)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let K=null,Fe=0,Ze=[],wt=!1,Ot=null;try{const ut=nu(new Date),es=await Ls(Ke(pe,"clientProgrammes",t.id));if(es.exists()){const _n=es.data(),Hn=kD[_n.templateId];if(Ue(!0),Hn){const Mr=_n.completedSessions||{},Dr=Object.keys(Mr).length,ko=Hn.duration*Hn.daysPerWeek;ee(ko>0?Math.round(Dr/ko*100):0);const Ma=_n.templateId.replace(/_/g," ").replace(/\b\w/g,pa=>pa.toUpperCase());te(Ma);const nr=jD[_n.templateId];let Ja=!1;for(let pa=1;pa<=Hn.duration&&!Ja;pa++)for(let fr=0;fr<Hn.daysPerWeek&&!Ja;fr++)Mr[`w${pa}d${fr}`]||(me({week:pa,dayIdx:fr,label:nr?.[fr]||`Day ${fr+1}`}),Ja=!0);Ja||(P(!0),wt=!0)}}const ns=Ht(pe,"workoutLogs"),Ss=Fs(ns,bs("clientId","==",t.id));K=await As(Ss),Ce(K.docs.length);const hs=new Date,Bs=hs.getDay(),qr=Bs===0?6:Bs-1,Ar=new Date(hs);Ar.setDate(hs.getDate()-qr),Ar.setHours(0,0,0,0);const cn=Ar.getTime(),bn=K.docs.filter(_n=>{const Hn=_n.data().completedAt;return Hn?(Hn.toDate?Hn.toDate().getTime():new Date(Hn).getTime())>=cn:!1}).length;Pe(bn);const qn=Ht(pe,"habitLogs"),Qn=Fs(qn,bs("clientId","==",t.id),bs("date","==",ut)),tr=await As(Qn);let sr=0;if(!tr.empty){const _n=tr.docs[0].data().habits||{};sr=Math.min(Object.values(_n).filter(Boolean).length,k)}C(Math.round(sr/k*100)),bt(sr);const Ir=await Ls(Ke(pe,"nutritionTargets",t.id));Ir.exists()&&(I(Ir.data()),Ot=Ir.data());const _r=await Ls(Ke(pe,"nutritionLogs",`${t.id}_${ut}`));if(_r.exists()){const Hn=(_r.data().entries||[]).reduce((Mr,Dr)=>({protein:Mr.protein+(Dr.protein||0),carbs:Mr.carbs+(Dr.carbs||0),fats:Mr.fats+(Dr.fats||0),calories:Mr.calories+(Dr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});M(Hn)}}catch(ut){console.error("Error loading dashboard stats:",ut)}try{let ut=[];const es=await Ls(Ke(pe,"coreBuddyPBs",t.id));if(es.exists()){const ns=es.data().exercises||{};Ts(Object.keys(ns).length),Fe=Object.keys(ns).length,ut=Object.entries(ns).sort(([,Ss],[,hs])=>(hs.weight||0)-(Ss.weight||0)).slice(0,3).map(([Ss,hs])=>({name:Ss,weight:hs.weight,reps:hs.reps}))}Ze=ut,vt(ut)}catch(ut){console.error("PB fetch error:",ut)}try{const ut=Ht(pe,"clients"),es=Fs(ut,bs("leaderboardOptIn","==",!0)),Ss=(await As(es)).docs.map(hs=>({id:hs.id,name:hs.data().name,photoURL:hs.data().photoURL||null}));Ct(Ss.slice(0,3))}catch(ut){console.error("Leaderboard preview error:",ut)}try{let ut=0;if(K){const cn=K.docs.map(bn=>bn.data().date).filter(Boolean).sort().reverse();if(cn.length>0){const bn=new Date;let qn=new Date(bn);e:for(let Qn=0;Qn<52;Qn++){const tr=new Date(qn),sr=tr.getDay(),Ir=sr===0?6:sr-1;tr.setDate(tr.getDate()-Ir),tr.setHours(0,0,0,0);const _r=new Date(tr);_r.setDate(_r.getDate()+7);const _n=nu(tr),Hn=nu(_r);if(cn.some(Dr=>Dr>=_n&&Dr<Hn))ut++;else{if(Qn>0)break e;break}qn.setDate(qn.getDate()-7)}}}sn(ut);let es=0;for(let cn=0;cn<30;cn++){const bn=new Date;bn.setDate(bn.getDate()-cn);const qn=nu(bn);try{const Qn=await As(Fs(Ht(pe,"habitLogs"),bs("clientId","==",t.id),bs("date","==",qn)));if(Qn.empty)break;{const tr=Qn.docs[0].data().habits||{};if(Object.values(tr).filter(Boolean).length>=k)es++;else break}}catch{break}}Os(es);let ns=0;for(let cn=0;cn<30;cn++){const bn=new Date;bn.setDate(bn.getDate()-cn);const qn=nu(bn);try{const Qn=await Ls(Ke(pe,"nutritionLogs",`${t.id}_${qn}`));if(Qn.exists()&&(Qn.data().entries||[]).length>0)if(Ot){const sr=(Qn.data().entries||[]).reduce((Ir,_r)=>({protein:Ir.protein+(_r.protein||0),carbs:Ir.carbs+(_r.carbs||0),fats:Ir.fats+(_r.fats||0)}),{protein:0,carbs:0,fats:0});if(sr.protein>=(Ot.protein||0)&&sr.carbs>=(Ot.carbs||0)&&sr.fats>=(Ot.fats||0))ns++;else break}else ns++;else break}catch{break}}ps(ns);const Ss=K?K.docs.length:0,hs=[],Bs=cn=>hs.push(cn);Ss>=1&&Bs("first_workout"),Ss>=10&&Bs("workouts_10"),Ss>=25&&Bs("workouts_25"),Ss>=50&&Bs("workouts_50"),Ss>=100&&Bs("workouts_100"),ut>=2&&Bs("streak_2"),ut>=4&&Bs("streak_4"),ut>=8&&Bs("streak_8"),Fe>=1&&Bs("first_pb"),Fe>=5&&Bs("pbs_5"),Fe>=10&&Bs("pbs_10"),Fe>=100&&Bs("pbs_100"),ns>=7&&Bs("nutrition_7"),t.leaderboardOptIn&&Bs("leaderboard_join"),es>=7&&Bs("habits_7"),Qt(hs);const qr=Cs.current;if(qr!==null){const cn=hs.filter(bn=>!qr.includes(bn));if(cn.length>0){const bn=Wn.find(qn=>qn.id===cn[cn.length-1]);bn&&setTimeout(()=>is(bn),600)}}Cs.current=hs;const Ar={};hs.forEach(cn=>{Ar[cn]={unlockedAt:new Date().toISOString()}}),Is(Ke(pe,"achievements",t.id),{badges:Ar,progress:{streakWeeks:ut,pbCount:Fe,nutritionStreak:ns,habitStreak:es},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(ut){console.error("Achievement computation error:",ut)}A(!0)})()},[n,t,k]),v.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:L,programmeName:Y,totalWorkouts:we,habitWeekPct:xe,nutritionTotals:O,nutritionTargetData:z,todayHabitsCount:We,nextSession:q,hasProgramme:Me,programmeComplete:X,weeklyWorkouts:re,weeklyWorkoutTarget:Be,pbCount:Yt,topPBs:Pt,leaderboardTop3:ie,unlockedBadges:pt,streakWeeks:ss}))}catch{}},[T,L,Y,we,xe,O,z,We,q,Me,X,re,Be,Yt,Pt,ie,pt,ss,t]);const Dn=v.useCallback(async()=>{if(Mn.current=!0,ea(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await ja(Ke(pe,"clients",t.id),{tourComplete:!0})}catch(N){console.error("Failed to save tour completion:",N)}}},[t,l]),os=v.useCallback(async N=>{if(De(N),it(!1),et(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await ja(Ke(pe,"clients",t.id),{weeklyWorkoutTarget:N})}catch(K){console.error("Failed to save weekly target:",K)}}},[t]),Es=N=>{const K=N.currentTarget,Fe=K.querySelector(".ripple");Fe&&Fe.remove();const Ze=K.getBoundingClientRect(),wt=Math.max(Ze.width,Ze.height),Ot=N.clientX-Ze.left-wt/2,ut=N.clientY-Ze.top-wt/2,es=document.createElement("span");es.className="ripple",es.style.cssText=`width:${wt}px;height:${wt}px;left:${Ot}px;top:${ut}px;`,K.appendChild(es),setTimeout(()=>es.remove(),600)},wn=t?.name?.split(" ")[0]||"there",Zn=Math.min(Math.round(re/Be*100),100),Ds=[{label:"Programme",value:`${L}%`,pct:L,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${re}/${Be}`,pct:Zn,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${xe}%`,pct:xe,color:"var(--color-primary)",size:"normal"}],$s=N=>!z||!z[N]?0:Math.min(Math.round(O[N]/z[N]*100),100),Zt=(()=>{const N=new Date().getHours();return T&&We>=k&&O.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:N>=5&&N<12?{main:"Rise and grind,",sub:"let's get after it!"}:N>=12&&N<17?{main:"Oye",sub:"crack on and make it count!"}:N>=17&&N<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Ps=T?g&&Me&&q&&!X?{label:"NEXT SESSION",message:`Week ${q.week}, Day ${q.dayIdx+1}  ${q.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:L,ringLabel:`${L}%`}:We<k?{label:"DAILY HABITS",message:`${We}/${k} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:xe,ringLabel:`${We}/${k}`}:g&&O.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!Me?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&X?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,an=v.useCallback(async()=>{if(t){se(!0);try{const N=await As(Fs(Ht(pe,"posts"),bs("authorId","==",t.id),Yh("createdAt","desc"),Qh(30)));dt(N.docs.map(Fe=>({id:Fe.id,...Fe.data()})));const K=await As(Fs(Ht(pe,"postLikes"),bs("userId","==",t.id)));Xt(new Set(K.docs.map(Fe=>Fe.data().postId)))}catch(N){console.error("Error loading journey:",N)}finally{se(!1)}}},[t]);v.useEffect(()=>{T&&t&&an()},[T,t,an]);const er=N=>{const K=N.target.files?.[0];if(K){if(!K.type.startsWith("image/")){ze("Please select an image file","error");return}if(K.size>10*1024*1024){ze("Image must be under 10MB","error");return}J(K),qe(URL.createObjectURL(K))}},zn=()=>{J(null),ke&&URL.revokeObjectURL(ke),qe(null),xn.current&&(xn.current.value="")},Nn=async()=>{if(!(!He.trim()&&!Ye||nt||!t)){lt(!0);try{let N=null;if(Ye){const Ze=await TD(Ye),wt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Ot=no(ro,`postImages/${t.id}/${wt}`);await zp(Ot,Ze),N=await Qo(Ot)}await ha(Ht(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:He.trim(),type:N?"image":"text",imageURL:N||null,createdAt:vr(),likeCount:0,commentCount:0});const Fe=He.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Fe){const Ze=new Set;Fe.forEach(wt=>{const Ot=wt.slice(1).trim(),ut=D.find(es=>es.name&&es.name.toLowerCase()===Ot.toLowerCase());ut&&!Ze.has(ut.id)&&(Ze.add(ut.id),rt(ut.id,"mention",{}))})}gt(""),zn(),rn.current&&(rn.current.style.height="auto"),await an(),ze("Posted!","success")}catch(N){console.error("Error posting:",N),ze(N?.message||"Failed to post","error")}finally{lt(!1)}}},Kn=async N=>{if(window.confirm("Delete this post?"))try{await Tr(Ke(pe,"posts",N)),dt(K=>K.filter(Fe=>Fe.id!==N)),ze("Post deleted","info")}catch(K){console.error("Delete error:",K),ze("Failed to delete","error")}},hr=async N=>{if(!t)return;const K=t.id,Fe=`${N}_${K}`,Ze=St.has(N),wt=new Set(St);Ze?wt.delete(N):wt.add(N),Xt(wt),dt(Ot=>Ot.map(ut=>ut.id===N?{...ut,likeCount:Math.max(0,(ut.likeCount||0)+(Ze?-1:1))}:ut));try{if(Ze)await Tr(Ke(pe,"postLikes",Fe)),await ja(Ke(pe,"posts",N),{likeCount:Wo(-1)});else{await Is(Ke(pe,"postLikes",Fe),{postId:N,userId:K,createdAt:vr()}),await ja(Ke(pe,"posts",N),{likeCount:Wo(1)});const Ot=Xe.find(ut=>ut.id===N);Ot&&rt(Ot.authorId,"like",{postId:N})}}catch(Ot){console.error("Like error:",Ot),an()}},Yn=async N=>{try{const K=await As(Fs(Ht(pe,"postComments"),bs("postId","==",N),Yh("createdAt","asc"),Qh(50)));Re(Fe=>({...Fe,[N]:K.docs.map(Ze=>({id:Ze.id,...Ze.data()}))}))}catch(K){console.error("Error loading comments:",K)}},mr=N=>{const K=new Set(Bt);K.has(N)?K.delete(N):(K.add(N),fe[N]||Yn(N)),U(K)},Rr=async N=>{const K=(Te[N]||"").trim(),Fe=It[N];if(!(!K&&!Fe||!t)){Et(Ze=>({...Ze,[N]:!0}));try{let Ze=null;if(Fe){const ns=no(ro,`comment-images/${Date.now()}_${Fe.name}`);await zp(ns,Fe),Ze=await Qo(ns)}const wt={postId:N,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:K||"",createdAt:vr()};Ze&&(wt.imageURL=Ze);const Ot=ot[N];Ot&&(wt.replyToId=Ot.id,wt.replyToName=Ot.authorName),await ha(Ht(pe,"postComments"),wt),await ja(Ke(pe,"posts",N),{commentCount:Wo(1)});const ut=Xe.find(ns=>ns.id===N);ut&&rt(ut.authorId,"comment",{postId:N});const es=K.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(es){const ns=new Set;es.forEach(Ss=>{const hs=Ss.slice(1).trim(),Bs=D.find(qr=>qr.name&&qr.name.toLowerCase()===hs.toLowerCase());Bs&&!ns.has(Bs.id)&&(ns.add(Bs.id),rt(Bs.id,"mention",{postId:N}))})}je(ns=>({...ns,[N]:""})),nn(ns=>({...ns,[N]:null})),mn(ns=>({...ns,[N]:null})),Lt(ns=>({...ns,[N]:null})),ln.current[N]&&(ln.current[N].value=""),dt(ns=>ns.map(Ss=>Ss.id===N?{...Ss,commentCount:(Ss.commentCount||0)+1}:Ss)),await Yn(N)}catch(Ze){console.error("Comment error:",Ze),ze("Failed to comment","error")}finally{Et(Ze=>({...Ze,[N]:!1}))}}},Ws=async(N,K)=>{try{await Tr(Ke(pe,"postComments",K)),await ja(Ke(pe,"posts",N),{commentCount:Wo(-1)}),Re(Fe=>({...Fe,[N]:(Fe[N]||[]).filter(Ze=>Ze.id!==K)})),dt(Fe=>Fe.map(Ze=>Ze.id===N?{...Ze,commentCount:Math.max((Ze.commentCount||1)-1,0)}:Ze))}catch(Fe){console.error("Delete comment error:",Fe),ze("Failed to delete comment","error")}},ta=(N,K)=>{const Fe=K.target.files?.[0];if(!Fe)return;if(Fe.size>5*1024*1024){ze("Image must be under 5MB","error");return}nn(wt=>({...wt,[N]:Fe}));const Ze=new FileReader;Ze.onload=wt=>mn(Ot=>({...Ot,[N]:wt.target.result})),Ze.readAsDataURL(Fe)},wo=N=>{nn(K=>({...K,[N]:null})),mn(K=>({...K,[N]:null})),ln.current[N]&&(ln.current[N].value="")},Xa=N=>{gt(N.target.value),N.target.style.height="auto",N.target.style.height=Math.min(N.target.scrollHeight,120)+"px",mt(N.target.value,"compose")},_o=(N,K)=>{je(Fe=>({...Fe,[N]:K})),mt(K,N)};return r.jsx(Ca,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:E,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{ue(!de),de||_e()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),be>0&&r.jsx("span",{className:"header-notif-badge",children:be>9?"9+":be})]}),de&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ms.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:at,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:ms.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ms.map(N=>r.jsxs("div",{className:`notif-item${N.read?"":" unread"}`,onClick:()=>{if(ue(!1),N.type==="buddy_request"||N.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((N.type==="like"||N.type==="comment")&&N.postId){if(!Bt.has(N.postId)){const K=new Set(Bt);K.add(N.postId),U(K),fe[N.postId]||Yn(N.postId)}setTimeout(()=>{const K=document.getElementById(`post-${N.postId}`);K&&K.scrollIntoView({behavior:"smooth",block:"center"})},150)}else N.type==="like"||N.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):N.type==="mention"&&x(`/client/core-buddy/profile/${N.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:N.fromPhotoURL?r.jsx("img",{src:N.fromPhotoURL,alt:""}):r.jsx("span",{children:(N.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:N.fromName})," ",N.type==="buddy_request"&&"sent you a buddy request",N.type==="buddy_accept"&&"accepted your buddy request",N.type==="like"&&"liked your post",N.type==="comment"&&"commented on your post",N.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Hp(N.createdAt)})]})]},N.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Zy.map((N,K)=>{const Fe=K<W;return r.jsx("line",{x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,className:`ring-tick ${Fe?"elapsed":"remaining"}`,strokeWidth:N.thick?"3":"2"},K)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>tt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:_t||"/Logo.webp",alt:_t?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Tt?" uploading":""}`,children:Tt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:tt,type:"file",accept:"image/*",onChange:Jt,style:{display:"none"}})]}),!_t&&!Tt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>tt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[qp[ye].text," ",r.jsx("strong",{children:qp[ye].bold})]},ye)]}),r.jsx("div",{className:"cb-stats-row",children:Ds.map(N=>{const K=(N.size==="large",38),Fe=2*Math.PI*K,Ze=Fe-N.pct/100*Fe,wt=N.editable;return r.jsxs("div",{className:`cb-stat-item${N.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:`cb-stat-ring${wt?" cb-stat-tappable":""}${wt&&ft?" cb-stat-hint":""}`,onClick:wt?()=>{it(!0),et(!1)}:void 0,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:K}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:K,style:{stroke:N.color},strokeDasharray:Fe,strokeDashoffset:Ze})]}),r.jsx("span",{className:"cb-stat-value",style:{color:N.color},children:N.value})]}),r.jsx("span",{className:"cb-stat-label",children:N.label})]},N.label)})}),Ne&&r.jsx("div",{className:"cb-target-overlay",onClick:()=>it(!1),children:r.jsxs("div",{className:"cb-target-picker",onClick:N=>N.stopPropagation(),children:[r.jsx("h4",{children:"Weekly workout goal"}),r.jsx("p",{children:"How many sessions per week?"}),r.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(N=>r.jsx("button",{className:`cb-target-option${N===Be?" active":""}`,onClick:()=>os(N),children:N},N))})]})}),r.jsxs("p",{className:"cb-coach-msg",children:[Zt.main," ",r.jsx("strong",{children:wn}),"  ",Zt.sub]}),Ps&&r.jsxs("button",{className:"cb-nudge-card",onClick:Ps.action||void 0,style:Ps.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ps.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Ps.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Ps.label}),r.jsx("span",{className:"cb-nudge-title",children:Ps.message}),Ps.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Ps.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:N=>{Es(N),x("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:N=>{Es(N),x("/client/core-buddy/nutrition")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsx("h3",{children:"Today's Nutrition"})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:$s("protein"),color:"var(--color-primary)"},{label:"C",pct:$s("carbs"),color:"var(--color-primary)"},{label:"F",pct:$s("fats"),color:"var(--color-primary)"},{label:"Cal",pct:$s("calories"),color:"var(--color-primary)"}].map(N=>{const Fe=2*Math.PI*38,Ze=Fe-N.pct/100*Fe;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:N.color},strokeDasharray:Fe,strokeDashoffset:Ze})]}),r.jsx("span",{style:{color:N.color},children:N.label})]},N.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:N=>{Es(N),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[re," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[we," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-grid-row${g?"":" cb-grid-single"}`,children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:N=>{Es(N),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:k},(N,K)=>r.jsx("span",{className:`cb-habit-dot${K<We?" done":""}`},K))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[We,"/",k," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:N=>{Es(N),x("/client/personal-bests?mode=corebuddy")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"PBs"}),Pt.length>0?r.jsx("div",{className:"cb-pb-preview",children:Pt.slice(0,2).map(N=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:N.name}),r.jsxs("span",{className:"cb-pb-value",children:[N.weight,"kg"]})]},N.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:N=>{Es(N),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),ie.length>0?r.jsx("div",{className:"cb-lb-preview",children:ie.map((N,K)=>{const Fe=["#FFD700","#A8B4C0","#CD7F32"][K],Ze=N.name?N.name.split(" ").map(Ot=>Ot[0]).join("").slice(0,2).toUpperCase():"?",wt=N.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${wt?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Fe},children:N.photoURL?r.jsx("img",{src:N.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Ze})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Fe},children:["#",K+1]})]},N.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:N=>{Es(N),x("/client/core-buddy/buddies")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Buddies"}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("div",{className:"cb-achievements-section",children:[r.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),r.jsx("div",{className:"cb-badges-scroll",children:Wn.map(N=>{const K=pt.includes(N.id);return r.jsx("button",{className:`cb-badge${K?" unlocked":" locked"}`,onClick:()=>Ft(N),children:r.jsx("img",{src:N.img,alt:N.name,className:"cb-badge-img"})},N.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[pt.length,"/",Wn.length," unlocked"]})]}),g&&r.jsxs("div",{className:"cb-journey-section",children:[r.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:_t?r.jsx("img",{src:_t,alt:""}):r.jsx("span",{children:ru(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:rn,placeholder:"Share your progress... (use @ to mention)",value:He,onChange:Xa,rows:1,maxLength:500}),Ge&&Vt==="compose"&&qt.length>0&&r.jsx("div",{className:"mention-dropdown",children:qt.map(N=>r.jsxs("button",{className:"mention-option",onClick:()=>Gt(N,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:N.photoURL?r.jsx("img",{src:N.photoURL,alt:""}):r.jsx("span",{children:ru(N.name)})}),r.jsx("span",{children:N.name})]},N.id))}),ke&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:ke,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:zn,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>xn.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:xn,type:"file",accept:"image/*",onChange:er,hidden:!0}),(He.trim()||Ye)&&r.jsx("button",{className:"journey-post-btn",onClick:Nn,disabled:nt,children:nt?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Q?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):Xe.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:Xe.map(N=>r.jsxs("div",{id:`post-${N.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:N.authorPhotoURL?r.jsx("img",{src:N.authorPhotoURL,alt:""}):r.jsx("span",{children:ru(N.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:N.authorName}),r.jsx("span",{className:"journey-post-time",children:Hp(N.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>Kn(N.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),N.type==="workout_summary"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.stats.map(K=>`${K.value} ${K.label}`).join("    ")}),!N.metadata.stats?.length&&N.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):N.type==="badge_earned"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(Wn.find(K=>K.name===N.metadata.title)||Wn.find(K=>N.metadata.badges?.includes(K.name)))?.img||"/Logo.webp",alt:N.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),(N.metadata.badgeDesc||(Wn.find(K=>K.name===N.metadata.title)||Wn.find(K=>N.metadata.badges?.includes(K.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.badgeDesc||(Wn.find(K=>K.name===N.metadata.title)||Wn.find(K=>N.metadata.badges?.includes(K.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):N.type==="habits_summary"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.stats.map(K=>`${K.value} ${K.label}`).join("    ")}),N.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[N.content&&r.jsx("p",{className:"journey-post-content",children:Kt(N.content)}),N.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:N.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${St.has(N.id)?" liked":""}`,onClick:()=>hr(N.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:St.has(N.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:N.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Bt.has(N.id)?" active":""}`,onClick:()=>mr(N.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:N.commentCount||0})]})]}),Bt.has(N.id)&&r.jsxs("div",{className:"journey-comments",children:[fe[N.id]?.length>0?fe[N.id].map(K=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:K.authorPhotoURL?r.jsx("img",{src:K.authorPhotoURL,alt:""}):r.jsx("span",{children:ru(K.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:K.authorName}),K.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),K.replyToName]}),K.content&&r.jsx("span",{className:"journey-comment-text",children:Kt(K.content)}),K.imageURL&&r.jsx("img",{className:"journey-comment-image",src:K.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Hp(K.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>Lt(Fe=>({...Fe,[N.id]:{id:K.id,authorName:K.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ws(N.id,K.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},K.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),ot[N.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:ot[N.id].authorName})]}),r.jsx("button",{onClick:()=>Lt(K=>({...K,[N.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),hn[N.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:hn[N.id],alt:"Preview"}),r.jsx("button",{onClick:()=>wo(N.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ln.current[N.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:K=>{ln.current[N.id]=K},type:"file",accept:"image/*",onChange:K=>ta(N.id,K),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Te[N.id]||"",onChange:K=>_o(N.id,K.target.value),onKeyDown:K=>{K.key==="Enter"&&Rr(N.id)},maxLength:300}),Ge&&Vt===N.id&&qt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:qt.map(K=>r.jsxs("button",{className:"mention-option",onClick:()=>Gt(K,N.id),children:[r.jsx("div",{className:"mention-option-avatar",children:K.photoURL?r.jsx("img",{src:K.photoURL,alt:""}):r.jsx("span",{children:ru(K.name)})}),r.jsx("span",{children:K.name})]},K.id))}),r.jsx("button",{onClick:()=>Rr(N.id),disabled:!(Te[N.id]||"").trim()&&!It[N.id]||ht[N.id],children:ht[N.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},N.id))})]})]}),!g&&r.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>x("/upgrade"),children:[r.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),r.jsx("span",{className:"cb-upgrade-cta-sub",children:"Nutrition, buddies, achievements & more"}),r.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),zs&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Ft(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:N=>N.stopPropagation(),children:[r.jsx("img",{src:zs.img,alt:zs.name,className:`cb-badge-overlay-img${pt.includes(zs.id)?"":" cb-badge-overlay-img-locked"}`}),pt.includes(zs.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Ft(null),children:"Tap to close"})]})}),r.jsx(fa,{active:"home"}),Le&&r.jsxs("div",{className:`toast-notification ${Le.type}`,children:[Le.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Le.message]}),r.jsx(wD,{steps:G,active:fs,onFinish:Dn}),At&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>is(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(N,K)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][K%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},K))}),r.jsxs("div",{className:"cb-celebration-content",onClick:N=>N.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:At.img,alt:At.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:At.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>is(null),children:"Tap to continue"})]})]})]})})}const $p=new Map;function Qi(){return new Date().toISOString().split("T")[0]}const T2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],SD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function ND(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function CD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=dr(),[g,y]=v.useState("loading"),[x,k]=v.useState(null),[j,B]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[W,V]=v.useState(null),[L,ee]=v.useState(Qi()),[Y,te]=v.useState({entries:[],water:0}),[we,Ce]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[xe,C]=v.useState(!1),[T,A]=v.useState(!1),[O,M]=v.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[z,I]=v.useState(ND),[We,bt]=v.useState(null),[q,me]=v.useState(null),[Me,Ue]=v.useState(!1),[X,P]=v.useState(null),[re,Pe]=v.useState(""),[Be,De]=v.useState(!1),[Ne,it]=v.useState(""),[ft,et]=v.useState([]),[Yt,Ts]=v.useState(!1),[Pt,vt]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ie,Ct]=v.useState(null),[_t,zt]=v.useState("100"),[Tt,kt]=v.useState(0),[tt,pt]=v.useState("weight"),[Qt,zs]=v.useState(0),[Ft,At]=v.useState(null);v.useRef(null);const is=v.useRef(!1),Cs=v.useRef(null),ss=v.useRef(null),sn=v.useRef(null),Ms=v.useCallback((E,D="info")=>{At({message:E,type:D}),setTimeout(()=>At(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const D=await Ls(Ke(pe,"nutritionTargets",t.id));D.exists()?(k(D.data()),y("dashboard")):y("setup")}catch(D){console.error("Error loading nutrition data:",D),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const D=await Ls(Ke(pe,"nutritionLogs",`${t.id}_${L}`));if(D.exists()){const ne=D.data();te({entries:ne.entries||[],water:ne.water||0})}else te({entries:[],water:0})}catch(D){console.error("Error loading log:",D),te({entries:[],water:0})}})()},[t?.id,L]),v.useEffect(()=>{const E=Y.entries.reduce((D,ne)=>({protein:D.protein+(ne.protein||0),carbs:D.carbs+(ne.carbs||0),fats:D.fats+(ne.fats||0),calories:D.calories+(ne.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ce(E)},[Y.entries]);const Os=async E=>{try{await Is(Ke(pe,"nutritionLogs",`${t.id}_${L}`),{clientId:t.id,date:L,entries:E.entries,water:E.water,updatedAt:Rt.now()})}catch(D){console.error("Error saving nutrition log:",D)}},ls=L===Qi(),ps=(E,D)=>new Date(E,D+1,0).getDate(),ye=(E,D)=>new Date(E,D,1).getDay(),Se=["January","February","March","April","May","June","July","August","September","October","November","December"],Le=["Su","Mo","Tu","We","Th","Fr","Sa"],Qe=()=>{let E=parseFloat(j.weight);j.weightUnit==="lbs"&&(E*=.453592);let D;j.heightUnit==="cm"?D=parseFloat(j.height):D=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const ne=parseInt(j.age);let ae=j.gender==="male"?10*E+6.25*D-5*ne+5:10*E+6.25*D-5*ne-161;const Ge=ae*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],Je={low:100,moderate:200,high:300,daily:400},Vt=Math.round(Ge+Je[j.trainingFrequency]);let xt=Vt,qt,vs;switch(j.goal){case"lose":xt=Vt*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),qt=2.2,vs=.3;break;case"build":xt=Vt*1.1,qt=2,vs=.22;break;default:qt=1.8,vs=.25}xt=Math.max(xt,j.gender==="male"?1400:1100);const yn=Math.round(E*qt),wr=Math.round(xt*vs/9),fs=Math.max(0,Math.round((xt-yn*4-wr*9)/4));V({calories:Math.round(xt),protein:yn,carbs:fs,fats:wr,bmr:Math.round(ae),neat:Math.round(Ge),exerciseAdd:Je[j.trainingFrequency],tdee:Math.round(Vt)})},ze=async()=>{if(W)try{const E={clientId:t.id,calories:W.calories,protein:W.protein,carbs:W.carbs,fats:W.fats,waterGoal:8,goal:j.goal,updatedAt:Rt.now()};await Is(Ke(pe,"nutritionTargets",t.id),E),k(E),y("dashboard"),Ms("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),Ms("Failed to save targets. Please try again.","error")}},Xe=()=>{const E=j.weight&&parseFloat(j.weight)>0,D=j.age&&parseInt(j.age)>0,ne=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return E&&D&&ne},dt="nut_favourite_foods",Q=()=>{try{return JSON.parse(localStorage.getItem(dt)||"[]")}catch{return[]}},se=E=>Q().some(D=>D.name.toLowerCase()===(E||"").toLowerCase()),He=E=>{const D=Q(),ne=D.findIndex(ae=>ae.name.toLowerCase()===E.name.toLowerCase());ne>=0?D.splice(ne,1):D.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(dt,JSON.stringify(D)),zs(ae=>ae+1)},gt=E=>{const D=[...Y.entries,{...E,meal:z,id:Date.now(),addedAt:new Date().toISOString()}],ne={...Y,entries:D};te(ne),Os(ne),me(null),Ct(null),zt("100"),kt(0),pt("weight"),vt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ms("Food added!","success")},Ye=E=>{const D=Y.entries.filter(ae=>ae.id!==E),ne={...Y,entries:D};te(ne),Os(ne)},J=v.useRef(null),ke=v.useRef([]),qe=3,nt=5,lt=async()=>{Ue(!0);const E=document.querySelector("#barcode-reader");if(!E){Ue(!1),Ms("Scanner container not found.","error");return}if(!J.current)try{const ne=await Cr(()=>import("./quagga.min-BbicSfvA.js").then(ae=>ae.q),[]);J.current=ne.default}catch(ne){console.error("Failed to load barcode scanner:",ne),Ue(!1),Ms("Could not load scanner.","error");return}const D=J.current;D.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ne=>{if(ne){console.error("Quagga init error:",ne),Ue(!1),Ms("Could not access camera. Check permissions.","error");return}D.start(),is.current=!0}),ke.current=[],D.onDetected(ne=>{const ae=ne.codeResult.decodedCodes?.filter(Ge=>Ge.error!==void 0)?.map(Ge=>Ge.error)||[];if((ae.length>0?ae.reduce((Ge,Je)=>Ge+Je,0)/ae.length:1)<.15){const Ge=ne.codeResult.code,Je=ke.current;Je.push(Ge),Je.length>nt&&Je.shift(),Je.filter(xt=>xt===Ge).length>=qe&&(D.offDetected(),ke.current=[],P(Ge))}})},St=()=>{const E=J.current;is.current&&E&&(E.stop(),E.offDetected(),is.current=!1),Ue(!1)},Xt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Bt=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),U=E=>{if(!E)return{value:100,unit:"g"};const D=E.toLowerCase().replace(/\s/g,""),ne=D.match(/([\d.]+)/),ae=ne?parseFloat(ne[1]):100;return Bt(E)?/cl/.test(D)?{value:ae*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(D)&&!/ml/.test(D)?{value:ae*1e3,unit:"ml"}:{value:ae,unit:"ml"}:{value:ae,unit:"g"}},fe=E=>{if(Bt(E.serving_size)||Bt(E.quantity))return"ml";const D=E.product_name||E.product_name_en||"";return Xt.test(D)?"ml":"g"},Re=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Te=(E,D)=>{const ne=E||"",ae=ne.match(/\((\d+\.?\d*)\s*g\)/i),$e=ne.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ae&&$e){const Vt=parseFloat(ae[1]);let xt=$e[1].replace(/^\d+\s*/,"").trim();if(xt&&Vt>0)return{label:xt,weight:Vt}}const Ge=ne.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ge){const Vt=parseFloat(Ge[1]);let xt=Ge[2].replace(/^\d+\s*/,"").trim();if(xt&&Vt>0)return{label:xt,weight:Vt}}const Je=D||"";for(const{pattern:Vt,label:xt,weight:qt}of Re)if(Vt.test(Je))return{label:xt,weight:qt};return null},je=E=>{const D=E.nutriments||{},ne=fe(E),ae=U(E.serving_size),$e=ne==="ml"?ae.unit==="ml"?ae.value:100:ae.value,Ge=E.product_name||E.product_name_en||"Unknown Product",Je=Te(E.serving_size,Ge);return{name:Ge,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:$e,servingUnit:ne,portion:Je,protein:Math.round(D.proteins_100g||D.proteins||0),carbs:Math.round(D.carbohydrates_100g||D.carbohydrates||0),fats:Math.round(D.fat_100g||D.fat||0),calories:Math.round(D["energy-kcal_100g"]||D["energy-kcal"]||(D.energy_100g?D.energy_100g/4.184:0)),per100g:!0}},ht=async E=>{De(!0);try{const D=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ne=await fetch(D);if(!ne.ok)throw new Error(`HTTP ${ne.status}`);const ae=await ne.json();if(ae.status==="success"||ae.status===1||ae.product){const $e=je(ae.product);$e.calories===0&&$e.protein===0&&$e.carbs===0?Ms("Product found but no nutrition data available.","error"):(Ct($e),$e.portion?(kt(1),zt(String($e.portion.weight)),pt("portion")):(kt(0),zt(String($e.servingValue||100)),pt("weight")),Pe(""))}else Ms("Product not found. Try search or manual entry.","error")}catch(D){console.error("Barcode lookup error:",D),Ms("Failed to look up product. Check your connection.","error")}De(!1)},Et=(E,D,ne)=>{const ae=E.toLowerCase().trim(),$e=D.toLowerCase().trim(),Ge=ne.toLowerCase().trim();let Je=0;return(ae===Ge||ae===Ge+"s"||ae+"s"===Ge)&&(Je+=100),(ae.endsWith(" "+Ge)||ae.endsWith(" "+Ge+"s"))&&(Je+=40),(ae.startsWith(Ge+" ")||ae.startsWith(Ge+"s "))&&(Je+=15),Ge.split(/\s+/).some(xt=>$e===xt||$e.startsWith(xt))&&(Je+=30),Je+=Math.max(0,30-ae.length),Je},ot=async()=>{if(!Ne.trim())return;Cs.current&&Cs.current.abort();const E=new AbortController;Cs.current=E;const D=Ne.trim().toLowerCase(),ne=D.split(/\s+/).filter(Boolean);if($p.has(D)){et($p.get(D));return}Ts(!0);try{const $e=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ne.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ge=await fetch($e,{signal:E.signal});if(!Ge.ok)throw new Error(`HTTP ${Ge.status}`);const Vt=((await Ge.json()).products||[]).map(xt=>je(xt)).filter(xt=>xt.name!=="Unknown Product"&&(xt.calories>0||xt.protein>0)).filter(xt=>{const qt=(xt.name+" "+xt.brand).toLowerCase();return ne.every(vs=>qt.includes(vs))}).sort((xt,qt)=>Et(qt.name,qt.brand,D)-Et(xt.name,xt.brand,D)).slice(0,10);$p.set(D,Vt),et(Vt),Vt.length===0&&Ms("No results found. Try a different search.","info")}catch(ae){if(ae.name==="AbortError")return;console.error("Search error:",ae),Ms("Search failed. Check your connection.","error")}Ts(!1)};v.useEffect(()=>{if(ss.current&&clearTimeout(ss.current),!(!Ne.trim()||q!=="search"||ie))return ss.current=setTimeout(()=>{ot()},700),()=>clearTimeout(ss.current)},[Ne]);const Lt=()=>{const E={...Y,water:Y.water+1};te(E),Os(E)},It=()=>{if(Y.water<=0)return;const E={...Y,water:Y.water-1};te(E),Os(E)},nn={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},hn=80,mn=2*Math.PI*hn,rn=(E,D,ne,ae,$e)=>{const Ge=ae>0?Math.min(100,Math.round(ne/ae*100)):0,Je=mn-Ge/100*mn,Vt=nn[$e]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:hn}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:hn,style:{stroke:Vt},strokeDasharray:mn,strokeDashoffset:Je})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:Vt},children:Math.round(ne)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",ae,E==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:Vt},children:D})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:Vt},children:[Ge,"%"]})]})};if(v.useEffect(()=>{if(!X)return;const E=setTimeout(()=>{const D=X;St(),P(null),ht(D)},1500);return()=>clearTimeout(E)},[X]),v.useEffect(()=>()=>{const E=J.current;if(is.current&&E){try{E.stop(),E.offDetected()}catch{}is.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{B(E=>({...E,gender:"male"})),V(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{B(E=>({...E,gender:"female"})),V(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:E=>{B(D=>({...D,age:E.target.value})),V(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:E=>{B(D=>({...D,weight:E.target.value})),V(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{B(E=>({...E,weightUnit:"kg"})),V(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{B(E=>({...E,weightUnit:"lbs"})),V(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:E=>{B(D=>({...D,height:E.target.value})),V(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:E=>{B(D=>({...D,heightFeet:E.target.value})),V(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:E=>{B(D=>({...D,heightInches:E.target.value})),V(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{B(E=>({...E,heightUnit:"cm"})),V(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{B(E=>({...E,heightUnit:"ft"})),V(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:E=>{B(D=>({...D,dailyActivity:E.target.value})),V(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:E=>{B(D=>({...D,trainingFrequency:E.target.value})),V(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{B(E=>({...E,goal:"lose"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{B(E=>({...E,goal:"maintain"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{B(E=>({...E,goal:"build"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{B(E=>({...E,deficitLevel:"light"})),V(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{B(E=>({...E,deficitLevel:"moderate"})),V(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{B(E=>({...E,deficitLevel:"harsh"})),V(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Qe,disabled:!Xe(),children:"Calculate Macros"})]}),W&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[rn("Protein","Protein",W.protein,W.protein,"ring-protein"),rn("Carbs","Carbs",W.carbs,W.carbs,"ring-carbs"),rn("Fats","Fats",W.fats,W.fats,"ring-fats"),rn("Calories","Calories",W.calories,W.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[W.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[W.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",W.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[W.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:ze,children:"Set as My Daily Targets"})]})]}),Ft&&r.jsx("div",{className:`toast-notification ${Ft.type}`,children:Ft.message})]});const xn=E=>{const D=new Date(E+"T12:00:00"),ne=D.getDay(),ae=new Date(D);ae.setDate(D.getDate()-(ne+6)%7);const $e=[];for(let Ge=0;Ge<7;Ge++){const Je=new Date(ae);Je.setDate(ae.getDate()+Ge),$e.push(Je.toISOString().split("T")[0])}return $e},ln=["M","T","W","T","F","S","S"],ms=(E,D="search")=>{I(E),D==="scan"?(me("scan"),Ct(null)):D==="manual"?(me("manual"),vt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):D==="favourites"?me("favourites"):(me("search"),et([]),it(""))},$=xn(L),de=new Date(L+"T12:00:00"),ue=`${Se[de.getMonth()]} ${de.getFullYear()}`;return r.jsx(Ca,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),V(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(L+"T12:00:00");E.setDate(E.getDate()-7);const D=E.toISOString().split("T")[0];ee(D)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!xe),M({year:de.getFullYear(),month:de.getMonth()})},children:ue}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(L+"T12:00:00");E.setDate(E.getDate()+7);const D=E.toISOString().split("T")[0];D<=Qi()&&ee(D)},"aria-label":"Next week",disabled:$[6]>=Qi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:$.map((E,D)=>{const ne=new Date(E+"T12:00:00").getDate(),ae=E===L,$e=E>Qi(),Ge=E===Qi();return r.jsxs("button",{className:`nut-week-day${ae?" selected":""}${Ge?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>ee(E),children:[r.jsx("span",{className:"nut-week-day-letter",children:ln[D]}),r.jsx("span",{className:"nut-week-day-num",children:ne})]},E)})})]}),xe&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>M(E=>{let D=E.month-1,ne=E.year;return D<0&&(D=11,ne--),{year:ne,month:D}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[Se[O.month]," ",O.year]}),r.jsx("button",{onClick:()=>M(E=>{let D=E.month+1,ne=E.year;return D>11&&(D=0,ne++),{year:ne,month:D}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Le.map(E=>r.jsx("span",{children:E},E))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ye(O.year,O.month))].map((E,D)=>r.jsx("span",{},`e${D}`)),[...Array(ps(O.year,O.month))].map((E,D)=>{const ne=D+1,ae=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(ne).padStart(2,"0")}`,$e=ae>Qi(),Ge=ae===L,Je=ae===Qi();return r.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${Je?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>{ee(ae),C(!1)},children:ne},ne)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[rn("Protein","Protein",we.protein,x.protein,"ring-protein"),rn("Carbs","Carbs",we.carbs,x.carbs,"ring-carbs"),rn("Fats","Fats",we.fats,x.fats,"ring-fats"),rn("Calories","kCal",we.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[ls&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:T2.map(E=>{const D=Y.entries.filter(ae=>(ae.meal||"snacks")===E.key),ne=D.reduce((ae,$e)=>({protein:ae.protein+($e.protein||0),carbs:ae.carbs+($e.carbs||0),fats:ae.fats+($e.fats||0),calories:ae.calories+($e.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:SD[E.key]}),r.jsx("span",{className:"nut-meal-card-title",children:E.label}),D.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[ne.calories," cal"]}),ls&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>bt(We===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),D.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?ne.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ne.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?ne.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ne.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?ne.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ne.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?ne.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:ne.calories})]})]}),D.length>0&&r.jsx("div",{className:"nut-log-list",children:D.map(ae=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${se(ae.name)?" active":""}`,onClick:()=>He(ae),"aria-label":se(ae.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:se(ae.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:ae.name}),ae.serving&&r.jsx("span",{className:"nut-log-item-serving",children:ae.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ae.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[ae.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[ae.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:ae.calories})]}),ls&&r.jsx("button",{className:"nut-log-delete",onClick:()=>Ye(ae.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))}),D.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:ls?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),We&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>bt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",T2.find(E=>E.key===We)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const E=We;bt(null),ms(E,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const E=We;bt(null),ms(E,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const E=We;bt(null),ms(E,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const E=We;bt(null),ms(E,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((E,D)=>r.jsx("div",{className:`nut-water-glass ${D<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:D<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},D))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:It,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:Lt,children:"+"})]})]})]})}),q&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{St(),P(null),me(null),Ct(null)},children:r.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:q==="scan"?"Scan Barcode":q==="search"?"Search Food":q==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{St(),P(null),me(null),Ct(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),q==="scan"&&!ie&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Me&&!X&&r.jsx("div",{className:"nut-scan-line"}),X&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:X})]})]}),!Me&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:lt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Me&&!X&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:re,onChange:E=>Pe(E.target.value),onKeyDown:E=>E.key==="Enter"&&re.trim()&&ht(re.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>re.trim()&&ht(re.trim()),disabled:!re.trim()||Be,children:Be?"...":"Look Up"})]})]}),q==="scan"&&ie&&(()=>{const E=ie.servingUnit||"g",D=ie.portion,ne=tt==="portion"&&D?Tt*D.weight:parseFloat(_t)||0,ae=ne/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Ge=tt==="portion"&&D?`${Tt} ${D.label}${Tt!==1?"s":""} (${Math.round(ne)}${E})`:`${Math.round(ne)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[ie.image&&r.jsx("img",{src:ie.image,alt:ie.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${se(ie.name)?" active":""}`,onClick:()=>He({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ie.brand&&r.jsx("p",{className:"nut-product-brand",children:ie.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),D&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{pt("portion"),Tt<1&&kt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{pt("weight"),zt(String(Math.round(ne)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&D?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[D.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ne),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:_t,onChange:Je=>zt(Je.target.value),onFocus:Je=>Je.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Je=>r.jsxs("button",{className:`nut-quick-btn${_t===String(Je)?" active":""}`,onClick:()=>zt(String(Je)),children:[Je,E]},Je))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*ae),"p / ",Math.round(ie.carbs*ae),"c / ",Math.round(ie.fats*ae),"f / ",Math.round(ie.calories*ae)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Ct(null),me("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>gt({name:ie.name,protein:Math.round(ie.protein*ae),carbs:Math.round(ie.carbs*ae),fats:Math.round(ie.fats*ae),calories:Math.round(ie.calories*ae),serving:Ge}),children:"Add"})]})]})})(),q==="search"&&!ie&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:sn,value:Ne,onChange:E=>it(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(ss.current),ot())},onFocus:()=>setTimeout(()=>sn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ot,disabled:Yt,children:Yt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[ft.map((E,D)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Ct(E),E.portion?(kt(1),zt(String(E.portion.weight)),pt("portion")):(kt(0),zt(String(E.servingValue||100)),pt("weight"))},children:[E.image&&r.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&r.jsx("span",{className:"nut-search-item-brand",children:E.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},D)),ft.length===0&&Ne&&!Yt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),q==="search"&&ie&&(()=>{const E=ie.servingUnit||"g",D=ie.portion,ne=tt==="portion"&&D?Tt*D.weight:parseFloat(_t)||0,ae=ne/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Ge=tt==="portion"&&D?`${Tt} ${D.label}${Tt!==1?"s":""} (${Math.round(ne)}${E})`:`${Math.round(ne)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[ie.image&&r.jsx("img",{src:ie.image,alt:ie.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${se(ie.name)?" active":""}`,onClick:()=>He({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ie.brand&&r.jsx("p",{className:"nut-product-brand",children:ie.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),D&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{pt("portion"),Tt<1&&kt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{pt("weight"),zt(String(Math.round(ne)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&D?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[D.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ne),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:_t,onChange:Je=>zt(Je.target.value),onFocus:Je=>Je.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Je=>r.jsxs("button",{className:`nut-quick-btn${_t===String(Je)?" active":""}`,onClick:()=>zt(String(Je)),children:[Je,E]},Je))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*ae),"p / ",Math.round(ie.carbs*ae),"c / ",Math.round(ie.fats*ae),"f / ",Math.round(ie.calories*ae)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>gt({name:ie.name,protein:Math.round(ie.protein*ae),carbs:Math.round(ie.carbs*ae),fats:Math.round(ie.fats*ae),calories:Math.round(ie.calories*ae),serving:Ge}),children:"Add"})]})]})})(),q==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:Pt.name,onChange:E=>vt(D=>({...D,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:Pt.serving,onChange:E=>vt(D=>({...D,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:Pt.protein,onChange:E=>vt(D=>({...D,protein:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:Pt.carbs,onChange:E=>vt(D=>({...D,carbs:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:Pt.fats,onChange:E=>vt(D=>({...D,fats:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:Pt.calories,onChange:E=>vt(D=>({...D,calories:E.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!Pt.name.trim(),onClick:()=>gt({name:Pt.name,protein:parseFloat(Pt.protein)||0,carbs:parseFloat(Pt.carbs)||0,fats:parseFloat(Pt.fats)||0,calories:parseFloat(Pt.calories)||0,serving:Pt.serving||""}),children:"Add Food"})]}),q==="favourites"&&!ie&&(()=>{const E=Q(),D=ne=>{if(ne.per100g){const ae=ne.per100g;Ct({name:ne.name,brand:"",image:null,servingSize:ne.serving||"100g",servingValue:100,servingUnit:ne.servingUnit||"g",portion:ne.portion||null,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,per100g:!0}),ne.portion?(kt(1),zt(String(ne.portion.weight)),pt("portion")):(kt(0),zt("100"),pt("weight"))}else gt({name:ne.name,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,serving:ne.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:E.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:E.map((ne,ae)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:$e=>{$e.stopPropagation(),He(ne)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>D(ne),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:ne.name}),r.jsx("span",{className:"nut-recent-item-serving",children:ne.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[ne.calories," cal"]})]})]},ae))})})})(),q==="favourites"&&ie&&(()=>{const E=ie.servingUnit||"g",D=ie.portion,ne=tt==="portion"&&D?Tt*D.weight:parseFloat(_t)||0,ae=ne/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Ge=tt==="portion"&&D?`${Tt} ${D.label}${Tt!==1?"s":""} (${Math.round(ne)}${E})`:`${Math.round(ne)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${se(ie.name)?" active":""}`,onClick:()=>He({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),D&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{pt("portion"),Tt<1&&kt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{pt("weight"),zt(String(Math.round(ne)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&D?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[D.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ne),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:_t,onChange:Je=>zt(Je.target.value),onFocus:Je=>Je.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Je=>r.jsxs("button",{className:`nut-quick-btn${_t===String(Je)?" active":""}`,onClick:()=>zt(String(Je)),children:[Je,E]},Je))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*ae),"p / ",Math.round(ie.carbs*ae),"c / ",Math.round(ie.fats*ae),"f / ",Math.round(ie.calories*ae)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>gt({name:ie.name,protein:Math.round(ie.protein*ae),carbs:Math.round(ie.carbs*ae),fats:Math.round(ie.fats*ae),calories:Math.round(ie.calories*ae),serving:Ge}),children:"Add"})]})]})})()]})}),r.jsx(fa,{active:"nutrition"}),Ft&&r.jsx("div",{className:`toast-notification ${Ft.type}`,children:Ft.message})]})})}async function eb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),k="#2a2a28",j="#ffffff",B="#A12F3A",W="#1a1a1a",V="#555555";x.fillStyle=k,x.fillRect(0,0,p,g);const L=Math.round(p*.82),ee=Math.round(g*.75),Y=Math.round((p-L)/2),te=Math.round((g-ee)/2),we=28,Ce=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,E2(x,Y,te,L,ee,we),x.fillStyle=j,x.fill(),x.restore(),x.save(),E2(x,Y,te,L,ee,we),x.strokeStyle=B,x.lineWidth=Ce,x.stroke(),x.restore();const xe=220,C=50,T=52,A=68,O=10,M=36,z=48,I=30,We=34,bt=46,q=30,me=28;x.font=`bold ${T}px 'Orbitron', sans-serif`;const Me=au(x,t.toUpperCase(),L-100);x.font=`500 ${M}px 'Montserrat', sans-serif`;let Ue=[];e==="badge"&&d?Ue=au(x,d,L-120):e==="badge"&&l.length>0?Ue=au(x,l.join("    "),L-120):i.length>0&&(Ue=au(x,i.map(Ct=>`${Ct.value} ${Ct.label}`).join("    "),L-120));const X=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${We}px 'Montserrat', sans-serif`;const P=au(x,X,L-80);let re=Me.length*A;Ue.length>0&&(re+=O+Ue.length*z),re+=I+P.length*bt,re+=q+me;const Be=te+ee-60-re,Ne=te+40,it=Be-C,ft=p/2,et=(Ne+it)/2,Yt=e==="badge"&&u?u:"/Logo.webp";x.save();const Ts=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Pt=x.createRadialGradient(ft,et,xe*.6,ft,et,xe*1.5);Pt.addColorStop(0,Ts),Pt.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=Pt,x.fillRect(ft-xe*1.5,et-xe*1.5,xe*3,xe*3),x.restore(),x.beginPath(),x.arc(ft,et,xe+6,0,Math.PI*2),x.fillStyle=j,x.fill();const vt=e==="badge"?"#ffc107":B;x.beginPath(),x.arc(ft,et,xe,0,Math.PI*2),x.strokeStyle=vt,x.lineWidth=5,x.stroke();try{const Ct=await RD(Yt);x.save(),x.beginPath(),x.arc(ft,et,xe-6,0,Math.PI*2),x.clip();const _t=(xe-6)*2;x.drawImage(Ct,ft-xe+6,et-xe+6,_t,_t),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=B,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",ft,et)}let ie=Be;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=W,x.font=`bold ${T}px 'Orbitron', sans-serif`;for(const Ct of Me)x.fillText(Ct,p/2,ie),ie+=A;if(Ue.length>0){ie+=O,x.fillStyle=V,x.font=`500 ${M}px 'Montserrat', sans-serif`;for(const Ct of Ue)x.fillText(Ct,p/2,ie),ie+=z}ie+=I,x.fillStyle=W,x.font=`bold ${We}px 'Montserrat', sans-serif`;for(const Ct of P)x.fillText(Ct,p/2,ie),ie+=bt;return ie+=q,x.fillStyle=B,x.font=`600 ${me}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,ie),new Promise(Ct=>{y.toBlob(_t=>Ct(_t),"image/png")})}function E2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function RD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function au(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function AD(){const n=v.useRef(null),e=v.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),k=u.createGain();x.type="sine",x.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),x.connect(k).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return v.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const ID=2e3,Ig=42,Vl=2*Math.PI*Ig,MD=1200,S2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Xh({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:x=!1}){const[k,j]=v.useState("hold"),[B,W]=v.useState(!1),[V,L]=v.useState(0),[ee,Y]=v.useState(!1),[te,we]=v.useState(!1),[Ce,xe]=v.useState(null),C=AD(),T=v.useRef(null),A=v.useRef(null),O=v.useRef(null),M=v.useRef(null),z=v.useRef(!1),I=v.useRef(!1),We=v.useRef(0),bt=v.useRef(S2[Math.floor(Math.random()*S2.length)]),q=v.useRef([...Array(80)].map((De,Ne)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ne%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ne%3}))),me=v.useCallback(()=>{if(z.current)return;z.current=!0,I.current=!1,We.current=0,W(!0),L(0),M.current=performance.now(),C.tap(),T.current&&(T.current.style.strokeDashoffset=Vl);const De=Ne=>{const it=Ne-M.current,ft=Math.min(it/ID,1);if(T.current&&(T.current.style.strokeDashoffset=Vl-ft*Vl),A.current){const et=8*(1-ft),Yt=1-ft,Ts=1+ft*.15;A.current.style.filter=`blur(${et}px) grayscale(${Yt})`,A.current.style.transform=`scale(${Ts})`}L(ft),it-We.current>=MD&&(We.current=it,C.tick()),ft<1?O.current=requestAnimationFrame(De):(z.current=!1,I.current=!0,O.current=null,W(!1),L(1),C.complete(),j("celebrate"))};O.current=requestAnimationFrame(De)},[C]),Me=v.useCallback(()=>{z.current&&(z.current=!1,O.current&&(cancelAnimationFrame(O.current),O.current=null),T.current&&(T.current.style.strokeDashoffset=Vl),A.current&&(A.current.style.filter="",A.current.style.transform=""),W(!1),L(0))},[]),Ue=v.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),X=v.useCallback(()=>{const De=[n||"Workout Complete!"];return e&&De.push(e),t?.length&&De.push(t.map(Ne=>`${Ne.value} ${Ne.label}`).join(" | ")),De.push("#MindCoreFitness"),De.join(`
`)},[n,e,t]),P=v.useCallback(async()=>{if(!(te||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:bt.current}),we(!0),xe("Posted to Journey!"),setTimeout(()=>xe(null),2500)}catch(De){console.error("Journey post failed:",De),xe(De?.message||"Failed to post"),setTimeout(()=>xe(null),3500)}},[te,u,n,e,t]),[re,Pe]=v.useState(!1),Be=v.useCallback(async()=>{Pe(!0);try{const De=await eb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:bt.current,userName:d}),Ne=X();if(navigator.share&&navigator.canShare?.({files:[new File([De],"workout.png",{type:"image/png"})]})){const it=new File([De],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ne,files:[it]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ne}):(await navigator.clipboard.writeText(Ne),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500))}catch{try{await navigator.clipboard.writeText(X()),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500)}catch{}}finally{Pe(!1)}},[n,e,t,d,X]);return k==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${B?"wc-holding":""}`,onPointerDown:De=>{De.preventDefault(),me()},onPointerUp:Me,onPointerLeave:Me,onPointerCancel:Me,onClick:De=>{De.stopPropagation(),I.current&&(I.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:De=>{(De.key==="Enter"||De.key===" ")&&(De.preventDefault(),C.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Ig}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Ig,style:{strokeDasharray:Vl,strokeDashoffset:Vl}})]}),r.jsx("img",{ref:A,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${ee?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:q.current.map((De,Ne)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${De.shape}`,style:{"--x":`${De.x}%`,"--delay":`${De.delay}s`,"--color":De.color,"--drift":`${De.drift}px`,"--spin":`${De.spin}deg`,"--duration":`${De.duration}s`,width:`${De.width}px`,height:`${De.height}px`}},Ne))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:bt.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((De,Ne)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:De.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:De.label})]},Ne))}),!x&&r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${te?"wc-share-done":""}`,onClick:P,disabled:te,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),te?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Be,disabled:re,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),re?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:Ue,children:p}),Ce&&r.jsx("div",{className:"wc-share-toast",children:Ce})]})]})}const N2="/login/assets/randomiser-glq9YJkL.jpg",C2="/login/assets/programme-card-workout-CnNzTYkz.webp",DD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",PD="/login/assets/mg-arms-BeOQU3wx.jpg",LD=60,Wp=5,OD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],BD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},VD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},UD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Gp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Kp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:DD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],iu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:PD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],R2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},A2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Yp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ul=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Qp=[5,10,15,20,30];function FD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function zD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function qD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=pc(),x=dr(),[k,j]=v.useState("menu"),[B,W]=v.useState(["bodyweight"]),[V,L]=v.useState("core"),[ee,Y]=v.useState("intermediate"),[te,we]=v.useState(p?15:5),[Ce,xe]=v.useState([]),[C,T]=v.useState(!1),A=v.useRef(!1),O=v.useRef([]),[M,z]=v.useState([]),[I,We]=v.useState(2),[bt,q]=v.useState(Ul[1]),[me,Me]=v.useState(1),[Ue,X]=v.useState(0),[P,re]=v.useState("work"),[Pe,Be]=v.useState(0),[De,Ne]=v.useState(!1),[it,ft]=v.useState(0),[et,Yt]=v.useState(!1),[Ts,Pt]=v.useState(!1),[vt,ie]=v.useState(null),Ct=v.useRef(null);v.useRef(null),v.useRef(null);const[_t,zt]=v.useState(null),Tt=v.useCallback((G,be="info")=>{zt({message:G,type:be}),setTimeout(()=>zt(null),3e3)},[]),kt=v.useCallback(async G=>{if(!t)throw new Error("Not signed in");const be=G&&typeof G=="object"&&G.type;await ha(Ht(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:be?"":G,type:be?G.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...be?{metadata:{title:G.title||"",subtitle:G.subtitle||"",stats:G.stats||[],quote:G.quote||"",badges:G.badges||[]}}:{}})},[t]),[tt,pt]=v.useState(null),[Qt,zs]=v.useState(null),[Ft,At]=v.useState(0),[is,Cs]=v.useState(0),[ss,sn]=v.useState([]),[Ms,Os]=v.useState(""),[ls,ps]=v.useState(""),[ye,Se]=v.useState(!1),[Le,Qe]=v.useState(0),[ze,Xe]=v.useState(!1),[dt,Q]=v.useState({}),se=v.useRef(null),He=v.useRef(null),[gt,Ye]=v.useState([]),[J,ke]=v.useState(null),[qe,nt]=v.useState(0),[lt,St]=v.useState(0),[Xt,Bt]=v.useState(0),[U,fe]=v.useState(0),[Re,Te]=v.useState(0),[je,ht]=v.useState(0),[Et,ot]=v.useState({beginner:0,intermediate:0,advanced:0}),Lt=p?Qp:Qp.filter(G=>g.includes(G)),It=!p&&qe>=y,[nn,hn]=v.useState(null),[mn,rn]=v.useState(""),[xn,ln]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const be=Ht(pe,"workoutLogs"),_e=Fs(be,bs("clientId","==",t.id)),rt=(await As(_e)).docs.map(Zt=>Zt.data()),mt=rt.filter(Zt=>Zt.type!=="programme");fe(mt.length);const Gt=mt.reduce((Zt,Ps)=>Zt+(Ps.duration||0),0);Te(Gt);const Kt={beginner:0,intermediate:0,advanced:0};mt.forEach(Zt=>{Zt.level&&Kt[Zt.level]!==void 0&&Kt[Zt.level]++}),ot(Kt);const Jt=new Date,Dn=Jt.getDay(),os=Dn===0?-6:1-Dn,Es=new Date(Jt);Es.setDate(Jt.getDate()+os),Es.setHours(0,0,0,0);const wn=Es.getTime(),Zn=rt.filter(Zt=>{const Ps=Zt.completedAt;return Ps?(Ps.toDate?Ps.toDate().getTime():new Date(Ps).getTime())>=wn:!1});nt(Zn.filter(Zt=>Zt.type!=="programme").length);let Ds=0;if(t)try{const Zt=await Ls(Ke(pe,"clientProgrammes",t.id));if(Zt.exists()){const Ps=Zt.data(),an=Ps.templateId;Ds=Zn.filter(Nn=>Nn.type==="programme"&&Nn.programmeId===an).length,hn(an);const er=Kp.find(Nn=>Nn.id===an);er&&rn(er.name);const zn=VD[an];if(zn){const Nn=Object.keys(Ps.completedSessions||{}).length,Kn=zn.duration*zn.daysPerWeek;Bt(Kn>0?Math.round(Nn/Kn*100):0)}}else hn(null),rn(""),Bt(0)}catch{}St(Ds);const $s=mt.map(Zt=>Zt.completedAt).filter(Boolean).map(Zt=>Zt.toDate?Zt.toDate().getTime():new Date(Zt).getTime()).sort((Zt,Ps)=>Ps-Zt);if($s.length===0)ht(0);else{const Zt=new Set;$s.forEach(Kn=>{const hr=new Date(Kn),Yn=hr.getDay(),mr=Yn===0?-6:1-Yn,Rr=new Date(hr);Rr.setDate(hr.getDate()+mr),Rr.setHours(0,0,0,0),Zt.add(Rr.getTime())});const Ps=[...Zt].sort((Kn,hr)=>hr-Kn);let an=0;const er=new Date(Jt),zn=Jt.getDay()===0?-6:1-Jt.getDay();er.setDate(Jt.getDate()+zn),er.setHours(0,0,0,0);let Nn=er.getTime();Ps.includes(Nn)||(Nn-=10080*60*1e3);for(let Kn=0;Kn<200&&Ps.includes(Nn);Kn++)an++,Nn-=10080*60*1e3;ht(an)}}catch(be){console.error("Error loading workout stats:",be)}finally{ln(!0)}})()},[n,t,k]);const ms=()=>{const G=[];let be;V==="mix"?be=["core","upper","lower"]:V==="fullbody"?be=["upper","lower"]:be=[V];for(const _e of B)for(const at of be)G.push(`exercises/${_e}/${at}`);return G},$=async()=>{if(A.current){for(;A.current;)await new Promise(G=>setTimeout(G,200));return O.current}A.current=!0,T(!0);try{const G=ms(),be=[];for(const mt of G)try{const Gt=no(ro,mt),Kt=await _2(Gt);be.push(...Kt.items)}catch{console.warn(`Folder ${mt} not found, skipping.`)}if(be.length===0&&B.includes("bodyweight")&&V==="core")try{const mt=no(ro,"core"),Gt=await _2(mt);be.push(...Gt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(be.length===0){const mt=B.map(Kt=>A2.find(Jt=>Jt.key===Kt)?.label).join(" + "),Gt=Yp.find(Kt=>Kt.key===V)?.label;return Tt(`No exercises found for ${mt} / ${Gt}. Upload videos to Firebase Storage.`,"error"),A.current=!1,T(!1),[]}const _e=new Set,at=be.filter(mt=>{const Gt=mt.name.replace(/\.(mp4|gif)$/i,"");return _e.has(Gt)?!1:(_e.add(Gt),!0)}),rt=await Promise.all(at.map(async mt=>{const Gt=await Qo(mt),Kt=FD(mt.name.replace(/\.(mp4|gif)$/i,"")),Jt=/\.gif$/i.test(mt.name);return{name:Kt,videoUrl:Gt,isGif:Jt}}));return O.current=rt,xe(rt),A.current=!1,T(!1),rt}catch(G){console.error("Error loading exercises:",G);const be=G.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${G.message||G.code||"Unknown error"}`;return Tt(be,"error"),A.current=!1,T(!1),[]}},de=async()=>{if(It)return;j("spinning"),O.current=[];const G=await $();if(G.length===0){j("setup");return}const be=Ul.find(Dn=>Dn.key===ee);q(be);const _e=be.work+be.rest,at=te*60,rt=Math.floor(at/_e);let mt,Gt;rt<=6?(mt=Math.max(3,Math.floor(rt/2)),Gt=Math.floor(rt/mt)):rt<=12?(mt=Math.min(6,Math.floor(rt/2)),Gt=Math.floor(rt/mt)):(mt=Math.min(10,Math.floor(rt/2)),Gt=Math.floor(rt/mt)),Gt=Math.max(2,Gt);const Kt=zD(G),Jt=Kt.slice(0,Math.min(mt,Kt.length));z(Jt),We(Gt),setTimeout(()=>j("preview"),2e3)},ue=()=>{j("countdown"),ft(3)};v.useEffect(()=>{if(k!=="countdown")return;if(it<=0){j("workout"),Me(1),X(0),re("work"),Be(bt.work),Ne(!1),wr();return}yn();const G=setTimeout(()=>ft(be=>be-1),1e3);return()=>clearTimeout(G)},[it,k]),v.useEffect(()=>{if(k!=="workout"||De)return;if(Pe<=0){E();return}Pe<=3&&yn();const G=setTimeout(()=>Be(be=>be-1),1e3);return()=>clearTimeout(G)},[Pe,k,De]);const E=()=>{if(P==="work")re("rest"),Be(bt.rest);else{const G=Ue+1;if(G>=M.length){const be=me+1;if(be>I){Yt(!0),D();return}Me(be),X(0)}else X(G);re("work"),Be(bt.work),wr()}},D=async()=>{if(n)try{await ha(Ht(pe,"workoutLogs"),{clientId:t.id,level:ee,duration:te,equipment:B,focus:V,exerciseCount:M.length,rounds:I,exercises:M.map(G=>G.name),completedAt:Rt.now()}),nt(G=>G+1),fe(G=>G+1),Te(G=>G+te),ot(G=>({...G,[ee]:(G[ee]||0)+1}))}catch(G){console.error("Error saving workout log:",G)}},ne=async(G,be,_e)=>{if(!(!t||!be))try{const at=t.id,rt=await Ls(Ke(pe,"coreBuddyPBs",at)),Gt=(rt.exists()?rt.data():null)?.exercises||{},Kt=Gt[G];let Jt=!1;if(Kt?(be>(Kt.weight||0)||be===(Kt.weight||0)&&_e>(Kt.reps||0))&&(Jt=!0):Jt=!0,Jt){const Dn={...Gt,[G]:{weight:be,reps:_e,achievedAt:Rt.now()}};await Is(Ke(pe,"coreBuddyPBs",at),{clientId:t.id,exercises:Dn,updatedAt:Rt.now()}),Tt(`New PB! ${be}kg  ${_e} reps`,"success"),yn(),await ae(G,be)}}catch(at){console.error("Error checking PB:",at)}},ae=async(G,be)=>{if(t)try{const _e=await Ls(Ke(pe,"coreBuddyTargets",t.id));if(!_e.exists())return;const rt=(_e.data().targets||{})[G];if(!rt||be<rt.targetWeight)return;const mt=await Ls(Ke(pe,"coreBuddyAchievements",t.id)),Gt=mt.exists()?mt.data():{clientId:t.id,badges:[],totalVolume:0};if(Gt.badges.some(os=>os.type==="pb_target"&&os.exercise===G&&os.targetWeight===rt.targetWeight))return;const Jt={type:"pb_target",exercise:G,group:BD[G]||"push",targetWeight:rt.targetWeight,achievedAt:Rt.now()},Dn=[...Gt.badges,Jt];await Is(Ke(pe,"coreBuddyAchievements",t.id),{...Gt,badges:Dn,updatedAt:Rt.now()}),Ye(os=>[...os,Jt])}catch(_e){console.error("Error checking target badge:",_e)}},$e=async G=>{if(!(!t||G<=0))try{const be=await Ls(Ke(pe,"coreBuddyAchievements",t.id)),_e=be.exists()?be.data():{clientId:t.id,badges:[],totalVolume:0},at=_e.totalVolume||0,rt=at+G,mt=[];OD.forEach(Kt=>{rt>=Kt.threshold&&at<Kt.threshold&&(_e.badges.some(Dn=>Dn.type==="volume_milestone"&&Dn.milestone===Kt.threshold)||mt.push({type:"volume_milestone",milestone:Kt.threshold,label:Kt.label,achievedAt:Rt.now()}))});const Gt=[..._e.badges,...mt];await Is(Ke(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Gt,totalVolume:Math.round(rt),updatedAt:Rt.now()}),mt.length>0&&Ye(Kt=>[...Kt,...mt])}catch(be){console.error("Error updating volume:",be)}},Ge=async G=>{if(zs(G),G.interval){const at=[];for(const rt of G.exercises){let mt=null,Gt=!1;if(rt.storagePath)try{const Kt=no(ro,rt.storagePath);mt=await Qo(Kt),Gt=/\.gif$/i.test(rt.storagePath)}catch{}at.push({name:rt.name,videoUrl:mt,isGif:Gt})}z(at),We(G.rounds),q({work:G.work,rest:G.rest}),j("preview");return}const be={};for(const at of G.exercises)if(at.storagePath)try{const rt=no(ro,at.storagePath);be[at.name]={url:await Qo(rt),isGif:/\.gif$/i.test(at.storagePath)}}catch{}Q(be);const _e=G.exercises.map(at=>({name:at.name,type:at.type,targetSets:at.sets,targetReps:at.reps||0,targetTime:at.time||0,sets:[]}));sn(_e),At(0),Cs(0),Os(""),ps(""),Xe(!1),Se(!1),Qe(0),Ye([]),ke(null),j("muscle_workout")},Je=()=>{const G=se.current;G&&(G.paused?(G.play(),Xe(!0)):(G.pause(),Xe(!1)))};v.useEffect(()=>{if(k!=="muscle_workout"||!ye||Le<=0){k==="muscle_workout"&&ye&&Le<=0&&(Se(!1),yn());return}return He.current=setTimeout(()=>Qe(G=>G-1),1e3),()=>clearTimeout(He.current)},[k,ye,Le]);const Vt=async()=>{const G=ss[Ft];let be={};if(G.type==="weighted"){const rt=parseFloat(Ms)||0,mt=parseInt(ls)||0;if(mt===0){Tt("Enter your reps","error");return}be={weight:rt,reps:mt}}else if(G.type==="reps"){const rt=parseInt(ls)||0;if(rt===0){Tt("Enter your reps","error");return}be={reps:rt}}else if(G.type==="timed"){const rt=G.targetTime-Le;be={time:Math.max(rt,1)}}const _e=[...ss];_e[Ft]={...G,sets:[...G.sets,be]},sn(_e),G.type==="weighted"&&be.weight>0&&await ne(G.name,be.weight,be.reps);const at=G.sets.length+1;if(at<G.targetSets)Cs(at),ps(""),Se(!1),Qe(0);else if(Ft+1<ss.length){const rt=Ft+1;At(rt),Cs(0),Os(""),ps(""),Xe(!1),Se(!1),Qe(0)}else await xt(_e),Pt(!0)},xt=async G=>{if(!(!n||!t))try{const be=G.reduce((at,rt)=>at+rt.sets.reduce((mt,Gt)=>mt+(Gt.weight||0)*(Gt.reps||0),0),0),_e=G.reduce((at,rt)=>at+rt.sets.length,0);await ha(Ht(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:tt,sessionId:Qt?.id,sessionName:Qt?.name,exerciseCount:G.length,totalSets:_e,duration:Math.round(_e*1.5),volume:Math.round(be),exercises:G.map(at=>({name:at.name,type:at.type,sets:at.sets})),completedAt:Rt.now()}),be>0&&await $e(be),gt.length>0&&ke({badges:[...gt]})}catch(be){console.error("Error saving muscle group workout log:",be)}},qt=v.useRef(null),vs=()=>(qt.current||(qt.current=new(window.AudioContext||window.webkitAudioContext)),qt.current),yn=()=>{try{const G=vs(),be=G.createOscillator(),_e=G.createGain();be.connect(_e),_e.connect(G.destination),be.frequency.value=880,_e.gain.value=.3,be.start(G.currentTime),be.stop(G.currentTime+.15)}catch{}},wr=()=>{try{const G=vs(),be=G.createOscillator(),_e=G.createGain();be.connect(_e),_e.connect(G.destination),be.frequency.value=1200,_e.gain.value=.4,be.start(G.currentTime),be.stop(G.currentTime+.3)}catch{}};v.useEffect(()=>{if(k!=="workout"||P!=="work"||!M[Ue]?.isGif)return;const be=setInterval(()=>{const _e=Ct.current;if(!_e)return;const at=_e.getAttribute("src");_e.removeAttribute("src"),setTimeout(()=>{Ct.current&&Ct.current.setAttribute("src",at)},0)},4e3);return()=>clearInterval(be)},[k,P,Ue,me,M]);const fs=(G,be,_e)=>{const at=Math.round(G/be*LD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:aD.map((rt,mt)=>r.jsx("line",{x1:rt.x1,y1:rt.y1,x2:rt.x2,y2:rt.y2,className:mt<at?`wk-tick-filled ${_e}`:"wk-tick-empty",strokeWidth:rt.thick?"3":"2"},mt))})},ea=()=>{const G=M.length*I;return((me-1)*M.length+Ue+(P==="rest"?.5:0))/G},Mn=_t&&r.jsx("div",{className:`toast-notification ${_t.type}`,children:_t.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(k==="menu")return r.jsx(Ca,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("setup"),children:r.jsx("img",{src:N2,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&r.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>x("/upgrade"),children:[r.jsx("img",{src:C2,alt:"Programmes",className:"wk-hero-bg"}),r.jsx("div",{className:"wk-free-card-overlay"}),r.jsxs("div",{className:"wk-free-card-content",children:[r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Programmes"}),r.jsxs("span",{className:"wk-section-count",children:[Kp.length," available"]})]}),r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Kp.map((G,be)=>G.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${be*.06}s`},children:[r.jsx("img",{src:G.image,alt:G.name,className:"wk-prog-img"}),be===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${be*.06}s`},children:[r.jsx("img",{src:C2,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:UD[G.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[G.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:G.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:G.name.toUpperCase()}),r.jsxs("p",{children:[G.daysPerWeek,"x per week  ",G.focus==="fullbody"?"Full Body":G.focus.charAt(0).toUpperCase()+G.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),be===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id))})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Muscle Groups"}),r.jsxs("span",{className:"wk-section-count",children:[iu.length," groups"]})]}),r.jsx("div",{className:"wk-muscle-grid",children:iu.map((G,be)=>r.jsx("button",{className:`wk-muscle-hero-card${G.image?" wk-muscle-thumb":""}`,onClick:()=>{pt(G.key),j("muscle_sessions")},style:{animationDelay:`${be*.05}s`},children:G.image?r.jsx("img",{src:G.image,alt:G.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:N2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Gp[G.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:G.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:G.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[R2[G.key]?.length||0," sessions"]})]})]})]})},G.key))})]})]}),r.jsx(fa,{active:"workouts"}),Mn]})});if(k==="setup"){const G=Yp.find(_e=>_e.key===V)?.label||V,be=Ul.find(_e=>_e.key===ee)?.label||ee;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${U}`,pct:U>0?Math.min(Math.round(U/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${qe}/${Wp}`,pct:Math.round(Math.min(qe,Wp)/Wp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${je}`,pct:je>0?Math.min(Math.round(je/12*100),100):0,color:"#38B6FF",size:"normal"}].map(_e=>{const rt=2*Math.PI*38,mt=rt-_e.pct/100*rt;return r.jsxs("div",{className:`wk-stat-item${_e.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:_e.color},strokeDasharray:rt,strokeDashoffset:mt})]}),r.jsx("span",{className:"wk-stat-value",style:{color:_e.color},children:_e.value})]}),r.jsx("span",{className:"wk-stat-label",children:_e.label})]},_e.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Yp.map(_e=>r.jsxs("button",{className:`wk-equip-btn${V===_e.key?" active":""}${_e.key==="mix"?" wk-mix-btn":""}`,onClick:()=>L(_e.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:_e.icon})}),r.jsx("span",{children:_e.label})]},_e.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ul.map(_e=>r.jsxs("button",{className:`wk-level-card wk-level-${_e.key}${ee===_e.key?" active":""}`,onClick:()=>Y(_e.key),children:[r.jsx("span",{className:"wk-level-name",children:_e.label}),r.jsx("span",{className:"wk-level-desc",children:_e.desc})]},_e.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Qp.map(_e=>{const at=!Lt.includes(_e);return r.jsxs("button",{className:`wk-time-btn${te===_e?" active":""}${at?" locked":""}`,onClick:()=>!at&&we(_e),disabled:at,children:[r.jsx("span",{className:"wk-time-num",children:_e}),r.jsx("span",{className:"wk-time-unit",children:at?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},_e)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:A2.map(_e=>{const at=B.includes(_e.key);return r.jsxs("button",{className:`wk-equip-btn${at?" active":""}`,onClick:()=>{W(rt=>at&&rt.length===1?rt:at?rt.filter(mt=>mt!==_e.key):[...rt,_e.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:_e.icon})}),r.jsx("span",{children:_e.label})]},_e.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[G,"  ",be,"  ",te," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[It&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:de,disabled:C||It,children:C?"Loading exercises...":It?"Limit Reached":"Randomise Workout"})]}),Mn]})}if(k==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:$k.map((G,be)=>r.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:"wk-spin-tick",strokeWidth:G.thick?"3.5":"2",style:{animationDelay:`${be*.03}s`}},be))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Mn]});if(k==="preview"){const G=Qt?.interval?{work:Qt.work,rest:Qt.rest}:Ul.find(_e=>_e.key===ee),be=M.length*I*(G.work+G.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(Qt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Qt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Qt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(be/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[G.work,"/",G.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:M.map((_e,at)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${at*.06}s`},onClick:()=>ie(_e),children:[r.jsx("span",{className:"wk-preview-num",children:at+1}),r.jsx("div",{className:"wk-preview-thumb",children:_e.isGif?r.jsx("img",{src:_e.videoUrl,alt:_e.name,loading:"lazy"}):r.jsx("video",{src:`${_e.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:_e.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},at))}),vt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>ie(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:_e=>_e.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>ie(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:vt.isGif?r.jsx("img",{src:vt.videoUrl,alt:vt.name}):r.jsx("video",{src:vt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:vt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Qt?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>de(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:ue,children:"Start Workout"})]})]})]})}if(k==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:it}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(k==="workout"){const G=M[Ue],be=P==="work"?bt.work:bt.rest,_e=P==="rest"?Ue+1<M.length?M[Ue+1]:me<I?M[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?G.isGif?r.jsx("img",{ref:Ct,className:"wk-video",src:G.videoUrl,alt:G.name},G.videoUrl):r.jsx("video",{className:"wk-video",src:G.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},G.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),_e&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",_e.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Ue+1," / ",M.length]}),r.jsx("h2",{className:"wk-exercise-name",children:G.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",me," of ",I]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[fs(Pe,be,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Pe}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ne(!De),children:De?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Be(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${ea()*100}%`}})}),et&&(()=>{const at=Ul.find(mt=>mt.key===ee),rt=M.length*I*(at.work+at.rest);return r.jsx(Xh,{title:"Workout Complete!",stats:[{value:Math.ceil(rt/60),label:"Minutes"},{value:M.length*I,label:"Intervals"},{value:I,label:"Rounds"}],hideShare:!p,onShareJourney:t?kt:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Yt(!1),zs(null),pt(null)}})})()]})}if(k==="muscle_sessions"){const G=iu.find(_e=>_e.key===tt),be=R2[tt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Gp[tt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:G?.icon})})}),r.jsxs("h2",{children:[G?.label," Workouts"]}),r.jsxs("p",{children:[be.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:be.map((_e,at)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{zs(_e),j("muscle_overview")},style:{animationDelay:`${at*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:_e.name}),r.jsx("p",{children:_e.desc}),r.jsx("div",{className:"mg-session-meta",children:_e.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[_e.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[_e.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[_e.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const rt=_e.exercises.map(Kt=>Kt.sets||0),mt=Math.min(...rt),Gt=Math.max(...rt);return mt===Gt?`${mt} sets each`:`${mt}-${Gt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},_e.id))})]}),Mn]})}if(k==="muscle_overview"){const G=Qt;if(!G)return null;const be=iu.find(_e=>_e.key===tt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Gp[tt]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:be?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:G.name}),G.level&&r.jsx("span",{className:"mg-overview-level",children:G.level})]}),r.jsx("p",{className:"mg-overview-desc",children:G.desc})]}),G.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:G.overview})]}),G.tips&&G.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:G.tips.map((_e,at)=>r.jsx("li",{children:_e},at))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",G.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:G.exercises.map((_e,at)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:at+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:_e.name}),G.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[G.work,"s work / ",G.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[_e.sets," sets  ",_e.reps?`${_e.reps} reps`:`${_e.time}s`,_e.type==="weighted"&&"  weighted"]})]})]},at))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Ge(G),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Mn]})}if(k==="muscle_workout"){const G=Qt;if(!G)return null;const be=G.exercises[Ft],_e=ss[Ft];if(!be||!_e)return null;const at=_e.sets.length,rt=G.exercises.length,mt=G.exercises.reduce((os,Es)=>os+(Es.sets||0),0),Kt=ss.reduce((os,Es)=>os+Es.sets.length,0)/mt*100,Jt=dt[be.name];be.type==="timed"&&Le===0&&!ye&&at===is&&setTimeout(()=>Qe(be.time),0);const Dn=at+1<be.sets?"Log Set":Ft+1<rt?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Kt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ft+1,"/",rt]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[Jt?r.jsxs("div",{className:"mg-video-container",onClick:Je,children:[Jt.isGif?r.jsx("img",{className:"mg-video",src:Jt.url,alt:be.name}):r.jsx("video",{ref:se,className:"mg-video",src:Jt.url,loop:!0,muted:!0,playsInline:!0},be.name),!ze&&!Jt.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:be.name}),r.jsx("span",{className:`mg-ex-type-badge ${be.type}`,children:be.type==="weighted"?"Weight + Reps":be.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",at+1," of ",be.sets]}),be.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",be.reps," reps"]}),be.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",be.time,"s"]})]}),be.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ms,onChange:os=>Os(os.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ls,onChange:os=>ps(os.target.value),placeholder:"0"})]})]}),be.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ls,onChange:os=>ps(os.target.value),placeholder:"0"})]})}),be.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Le,"s"]})}),ye?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Se(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Le===0&&Qe(be.time),Se(!0)},children:Le<be.time&&Le>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Vt,children:Dn}),_e.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:_e.sets.map((os,Es)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Es+1,": ",os.weight!=null?`${os.weight}kg  ${os.reps}`:os.reps!=null?`${os.reps} reps`:`${os.time}s`]})]},Es))})]})]}),Mn,Ts&&(()=>{const os=ss.reduce((Ds,$s)=>Ds+$s.sets.length,0),Es=ss.reduce((Ds,$s)=>Ds+$s.sets.reduce((Zt,Ps)=>Zt+(Ps.weight||0)*(Ps.reps||0),0),0),wn=iu.find(Ds=>Ds.key===tt)?.label||"",Zn=[{value:ss.length,label:"Exercises"},{value:os,label:"Sets"}];return Es>0&&Zn.push({value:Math.round(Es).toLocaleString(),label:"Volume (kg)"}),r.jsx(Xh,{title:`${wn} Complete!`,subtitle:Qt?.name,stats:Zn,hideShare:!p,onShareJourney:t?kt:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Pt(!1),zs(null),pt(null),ke(null)}})})(),J&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>ke(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:J.badges.length===1?"Badge Earned!":`${J.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:J.badges.map((os,Es)=>r.jsx("div",{className:"mg-badge-celebration-item",children:os.type==="pb_target"?`${os.exercise}  ${os.targetWeight}kg`:os.label},Es))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async os=>{os.stopPropagation();const Es=J.badges[0],wn=J.badges.map(Ds=>Ds.type==="pb_target"?`PB Target Hit: ${Ds.exercise}  ${Ds.targetWeight}kg`:Ds.label),Zn=Wn.find(Ds=>Ds.id===Es?.id)||Wn.find(Ds=>Ds.name===Es?.label);await kt({type:"badge_earned",title:wn.length===1?wn[0]:`${wn.length} Badges Earned!`,badges:wn,badgeDesc:Zn?.desc}),Tt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async os=>{os.stopPropagation();const Es=J.badges[0],wn=J.badges.map($s=>$s.type==="pb_target"?`PB Target Hit: ${$s.exercise}  ${$s.targetWeight}kg`:$s.label),Zn=Wn.find($s=>$s.id===Es?.id)||Wn.find($s=>$s.name===Es?.label),Ds=`Badge Earned! ${wn.join(", ")}
#MindCoreFitness`;try{const $s=await eb({type:"badge",title:wn.length===1?wn[0]:"Badges Earned!",badges:wn,badgeImage:Zn?.img,badgeDesc:Zn?.desc});navigator.share&&navigator.canShare?.({files:[new File([$s],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Ds,files:[new File([$s],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ds}):(await navigator.clipboard.writeText(Ds),Tt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Ds),Tt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const HD=60,$D={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},WD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],I2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function uh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const GD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function KD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isPremium:l}=pc(),{isDark:u,toggleTheme:d,accent:p}=Ia(),g=dr(),y=Aa(),[x,k]=v.useState("loading"),[j,B]=v.useState(null),W=v.useRef(!1),[V,L]=v.useState(null),[ee,Y]=v.useState(!1),[te,we]=v.useState(1),[Ce,xe]=v.useState(0),[C,T]=v.useState(0),[A,O]=v.useState(0),[M,z]=v.useState([]),[I,We]=v.useState(""),[bt,q]=v.useState(""),[me,Me]=v.useState(!1),[Ue,X]=v.useState(0),P=v.useRef(null),[re,Pe]=v.useState({}),[Be,De]=v.useState(!1),Ne=v.useRef(null),[it,ft]=v.useState(null),[et,Yt]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[x]);const[Ts,Pt]=v.useState(null),vt=v.useCallback((ye,Se="info")=>{Pt({message:ye,type:Se}),setTimeout(()=>Pt(null),4e3)},[]),ie=v.useCallback(async ye=>{if(!t)throw new Error("Not signed in");const Se=ye&&typeof ye=="object"&&ye.type;await ha(Ht(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Se?"":ye,type:Se?ye.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...Se?{metadata:{title:ye.title||"",subtitle:ye.subtitle||"",stats:ye.stats||[],quote:ye.quote||"",badges:ye.badges||[]}}:{}})},[t]),Ct=v.useRef(null),_t=()=>(Ct.current||(Ct.current=new(window.AudioContext||window.webkitAudioContext)),Ct.current),zt=()=>{try{const ye=_t(),Se=ye.createOscillator(),Le=ye.createGain();Se.connect(Le),Le.connect(ye.destination),Se.frequency.value=1200,Le.gain.value=.4,Se.start(ye.currentTime),Se.stop(ye.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&g("/")},[n,e,i,g]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Se=Ke(pe,"clientProgrammes",t.id),Le=await Ls(Se);Le.exists()&&L(Le.data());const Qe=y.state?.templateId;if(Qe&&!W.current){const ze=I2.find(Xe=>Xe.id===Qe);if(ze){W.current=!0,B(ze),k("overview");return}}Le.exists()?k("dashboard"):g("/client/core-buddy/workouts",{replace:!0})}catch(Se){console.error("Error loading programme:",Se),g("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!me||Ue<=0){me&&Ue<=0&&(Me(!1),zt());return}return P.current=setTimeout(()=>X(ye=>ye-1),1e3),()=>clearTimeout(P.current)},[me,Ue]);const Tt=async ye=>{if(t)try{await Is(Ke(pe,"clientProgrammes",t.id),ye),L(ye)}catch(Se){console.error("Error saving programme:",Se),vt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},kt=async ye=>{const Se={templateId:ye.id,startDate:Rt.now(),completedSessions:{}};await Tt(Se),k("dashboard")},tt=async()=>{if(t)try{await Tr(Ke(pe,"clientProgrammes",t.id)),L(null),k("browse")}catch(ye){console.error("Error quitting programme:",ye)}},pt=()=>V?I2.find(ye=>ye.id===V.templateId):null,Qt=()=>{if(!V?.startDate)return 1;const ye=V.startDate.toDate?V.startDate.toDate():new Date(V.startDate),Le=new Date-ye,Qe=Math.floor(Le/(1e3*60*60*24));return Math.floor(Qe/7)+1},zs=()=>{if(!V)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ye=V.completedSessions||{},Se=Object.keys(ye).length,Le=pt();if(!Le)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Qe=Le.duration*Le.daysPerWeek,ze=Qt(),Xe=Math.min(ze,Le.duration);let dt=0;for(let se=0;se<Le.daysPerWeek;se++)ye[`w${Xe}d${se}`]&&dt++;if(Se>=Qe)return{currentWeek:Le.duration,completedThisWeek:Le.daysPerWeek,nextDay:-1,totalCompleted:Se,totalSessions:Qe,complete:!0};if(ze>Le.duration)return{currentWeek:Le.duration,completedThisWeek:dt,nextDay:-1,totalCompleted:Se,totalSessions:Qe,complete:!0};let Q=-1;for(let se=0;se<Le.daysPerWeek;se++)if(!ye[`w${Xe}d${se}`]){Q=se;break}return{currentWeek:Xe,completedThisWeek:dt,nextDay:Q,nextWeek:Xe,totalCompleted:Se,totalSessions:Qe}},Ft=ye=>{const Se=Qt();return ye<Se},At=(ye,Se,Le)=>{if(!V||ye<=1)return null;const Qe=`w${ye-1}d${Se}`,ze=V.completedSessions?.[Qe];if(!ze)return null;const Xe=ze.exercises?.find(dt=>dt.name===Le);return Xe?.sets?.length?Xe.sets[Xe.sets.length-1]:null},is=(ye,Se)=>{const Le=pt();if(!Le)return;we(ye),xe(Se),T(0),O(0),z([]),q(""),Me(!1),X(0),De(!1),Pe({});const Qe=Le.days[Se],ze=Qe.exercises.map(se=>{const He=uh(se,ye,Le);return{name:se.name,type:se.type,pbKey:se.pbKey,targetSets:He.sets,targetReps:He.reps,targetTime:He.time,sets:[]}});z(ze);const Xe=Qe.exercises[0],dt=At(ye,Se,Xe.name);dt?.weight&&Xe.type==="weighted"?We(String(dt.weight)):We(""),(async()=>{const se={};for(const He of Qe.exercises)if(He.storagePath)try{const gt=no(ro,He.storagePath),Ye=await Qo(gt);se[He.name]={url:Ye,isGif:/\.gif$/i.test(He.storagePath)}}catch(gt){console.warn(`Video not found for ${He.name}:`,gt)}Pe(se)})(),k("session")},Cs=async()=>{pt();const ye=M[C];if(!ye)return;let Se={};if(ye.type==="weighted"){const ze=parseFloat(I)||0,Xe=parseInt(bt)||0;if(Xe===0){vt("Enter your reps","error");return}Se={weight:ze,reps:Xe}}else if(ye.type==="reps"){const ze=parseInt(bt)||0;if(ze===0){vt("Enter your reps","error");return}Se={reps:ze}}else if(ye.type==="timed"){const ze=ye.targetTime-Ue;Se={time:Math.max(ze,1)}}const Le=[...M];Le[C]={...ye,sets:[...ye.sets,Se]},z(Le),ye.type==="weighted"&&Se.weight>0&&await Ms(ye.name,Se.weight,Se.reps);const Qe=ye.sets.length+1;if(Qe<ye.targetSets)O(Qe),We(Se.weight?String(Se.weight):""),q(""),Me(!1),X(0);else if(C+1<M.length){const ze=C+1;T(ze),O(0),De(!1);const dt=pt()?.days[Ce]?.exercises[ze],Q=At(te,Ce,dt?.name);Q?.weight&&dt?.type==="weighted"?We(String(Q.weight)):We(""),q(""),Me(!1),X(0)}else await ss(Le)},ss=async ye=>{if(!V||!t)return;const Se=`w${te}d${Ce}`,Le={...V.completedSessions,[Se]:{completedAt:new Date().toISOString(),exercises:ye.map(Xe=>({name:Xe.name,type:Xe.type,sets:Xe.sets}))}},Qe={...V,completedSessions:Le};await Tt(Qe);const ze=ye.reduce((Xe,dt)=>Xe+dt.sets.reduce((Q,se)=>Q+(se.weight||0)*(se.reps||0),0),0);ze>0&&await sn(ze);try{const Xe=pt();await ha(Ht(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Xe?.id,programmeName:Xe?.name,week:te,day:Ce+1,exerciseCount:ye.length,duration:Math.round(ye.reduce((dt,Q)=>dt+Q.sets.length*1.5,0)),volume:Math.round(ze),completedAt:Rt.now()})}catch(Xe){console.error("Error saving workout log:",Xe)}et.length>0&&(ft({badges:[...et]}),Yt([])),Y(!0)},sn=async ye=>{if(t)try{const Se=await Ls(Ke(pe,"coreBuddyAchievements",t.id)),Le=Se.exists()?Se.data():{clientId:t.id,badges:[],totalVolume:0},Qe=Le.totalVolume||0,ze=Qe+ye,Xe=[];WD.forEach(Q=>{ze>=Q.threshold&&Qe<Q.threshold&&(Le.badges.some(He=>He.type==="volume_milestone"&&He.milestone===Q.threshold)||Xe.push({type:"volume_milestone",milestone:Q.threshold,label:Q.label,achievedAt:Rt.now()}))});const dt=[...Le.badges,...Xe];await Is(Ke(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:dt,totalVolume:Math.round(ze),updatedAt:Rt.now()}),Xe.length>0&&Yt(Q=>[...Q,...Xe])}catch(Se){console.error("Error updating volume:",Se)}},Ms=async(ye,Se,Le)=>{if(t)try{const Qe=t.id,ze=await Ls(Ke(pe,"coreBuddyPBs",Qe)),dt=(ze.exists()?ze.data():null)?.exercises||{},Q=dt[ye];let se=!1;if(Q?(Se>(Q.weight||0)||Se===(Q.weight||0)&&Le>(Q.reps||0))&&(se=!0):se=!0,se){const He={...dt,[ye]:{weight:Se,reps:Le,achievedAt:Rt.now()}};await Is(Ke(pe,"coreBuddyPBs",Qe),{clientId:t.id,exercises:He,updatedAt:Rt.now()}),vt(`New PB! ${Se}kg  ${Le} reps`,"success"),zt(),await Os(ye,Se)}}catch(Qe){console.error("Error checking PB:",Qe)}},Os=async(ye,Se)=>{if(t)try{const Le=await Ls(Ke(pe,"coreBuddyTargets",t.id));if(!Le.exists())return;const ze=(Le.data().targets||{})[ye];if(!ze||Se<ze.targetWeight)return;const Xe=await Ls(Ke(pe,"coreBuddyAchievements",t.id)),dt=Xe.exists()?Xe.data():{clientId:t.id,badges:[],totalVolume:0};if(dt.badges.some(gt=>gt.type==="pb_target"&&gt.exercise===ye&&gt.targetWeight===ze.targetWeight))return;const se={type:"pb_target",exercise:ye,group:$D[ye]||"push",targetWeight:ze.targetWeight,achievedAt:Rt.now()},He=[...dt.badges,se];await Is(Ke(pe,"coreBuddyAchievements",t.id),{...dt,badges:He,updatedAt:Rt.now()}),Yt(gt=>[...gt,se])}catch(Le){console.error("Error checking target badge:",Le)}},ls=Ts&&r.jsxs("div",{className:`toast-notification ${Ts.type}`,children:[Ts.type==="success"&&r.jsx("span",{children:" "}),Ts.message]}),ps=(ye,Se)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Se,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||x==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(x==="browse")return g("/client/core-buddy/workouts",{replace:!0}),null;if(x==="overview"&&j){const ye=j;return r.jsx(Ca,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[ps(ye.name,()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:GD[ye.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ye.name}),r.jsx("p",{className:"pg-overview-desc",children:ye.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.duration*ye.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ye.days.map((Se,Le)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Se.name}),r.jsx("span",{className:"pg-day-label",children:Se.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Se.exercises.map((Qe,ze)=>{const Xe=uh(Qe,1,ye);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Qe.name}),r.jsx("span",{className:"pg-day-ex-target",children:Qe.type==="timed"?`${Xe.sets}${Xe.time}s`:`${Xe.sets}${Xe.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Qe.type}`,children:Qe.type==="weighted"?"WT":Qe.type==="timed"?"TMR":"BW"})]},ze)})})]},Le))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ye.repProg," reps/week",ye.timeProg?`, +${ye.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>kt(ye),children:"Start Programme"})]}),ls]})})}if(x==="dashboard"){const ye=pt();if(!ye)return k("browse"),null;const Se=zs(),Le=V?.completedSessions||{},Qe=Se.totalSessions?Math.round(Se.totalCompleted/Se.totalSessions*100):0;return Math.round(Se.totalCompleted/(Se.totalSessions||1)*HD),r.jsx(Ca,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[ps("Programme",()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Qe/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Qe,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ye.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Qe,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Se.currentWeek," of ",ye.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ye.duration},(ze,Xe)=>{const dt=Xe+1,Q=Ft(dt);return r.jsxs("div",{className:`pg-week-row${dt===Se.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",dt]}),r.jsx("div",{className:"pg-week-days",children:ye.days.map((se,He)=>{const gt=`w${dt}d${He}`,Ye=!!Le[gt],J=!Ye&&Q,ke=!Ye&&!J&&dt===Se.currentWeek&&!Se.complete;return r.jsx("button",{className:`pg-day-dot${Ye?" done":""}${J?" missed":""}${ke?" next":""}`,disabled:!ke,onClick:()=>{ke&&is(dt,He)},children:Ye?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):J?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:se.name.replace("Day ","")})},He)})})]},Xe)})}),!Se.complete&&(()=>{const ze=ye.days.map((Xe,dt)=>({day:Xe,d:dt})).filter(({d:Xe})=>!Le[`w${Se.currentWeek}d${Xe}`]);return ze.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:ze.length===ye.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Se.currentWeek,"  ",ze.length," session",ze.length!==1?"s":""," left this week"]}),ze.map(({day:Xe,d:dt})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[Xe.name,": ",Xe.label]}),Xe.exercises.map((Q,se)=>{const He=uh(Q,Se.currentWeek,ye);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:Q.name}),r.jsx("span",{className:"pg-next-ex-target",children:Q.type==="timed"?`${He.sets}${He.time}s`:`${He.sets}${He.reps}`})]},se)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>is(Se.currentWeek,dt),children:["Start ",Xe.name]})]},dt))]})})(),Se.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Se.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:tt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&tt()},children:"Quit Programme"})]}),r.jsx(fa,{active:"workouts"}),ls]})})}if(x==="session"){const ye=pt();if(!ye)return null;const Se=ye.days[Ce],Le=Se.exercises[C],Qe=uh(Le,te,ye),ze=M[C],Xe=ze?.sets?.length||0,dt=Se.exercises.length,Q=(C+Xe/Qe.sets)/dt,se=re[Le.name],He=At(te,Ce,Le.name);Le.type==="timed"&&Ue===0&&!me&&Xe===A&&setTimeout(()=>X(Qe.time),0);const gt=()=>{se?.isGif?De(!Be):Ne.current&&(Be?Ne.current.pause():Ne.current.play(),De(!Be))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":u?"dark":"light","data-accent":p,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${Q*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&k("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[C+1," / ",dt]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",te,"  ",Se.name]})]})]}),se&&r.jsxs("div",{className:"pg-video-container",onClick:gt,children:[se.isGif?r.jsx("img",{className:"pg-video",src:se.url,alt:Le.name}):r.jsx("video",{ref:Ne,className:"pg-video",src:se.url,loop:!0,muted:!0,playsInline:!0},Le.name),!Be&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Le.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Le.type}`,children:Le.type==="weighted"?"Weight + Reps":Le.type==="timed"?"Timed":"Reps Only"}),Le.type==="weighted"&&He&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[He.weight,"kg x ",He.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Xe+1," of ",Qe.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Le.type==="timed"?`${Qe.time}s hold`:`${Qe.reps} reps`]})]}),Le.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:I,onChange:Ye=>We(Ye.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:bt,onChange:Ye=>q(Ye.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})]}),Le.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:bt,onChange:Ye=>q(Ye.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})}),Le.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Ue,"s"]})}),me?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>Me(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Ue===0&&X(Qe.time),Me(!0)},children:Ue<Qe.time&&Ue>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:Cs,disabled:Le.type==="timed"&&me,children:Xe+1<Qe.sets?"Log Set":C+1<dt?"Log Set  Next Exercise":"Log Set  Complete"}),ze?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:ze.sets.map((Ye,J)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",J+1,": ",Ye.weight!==void 0?`${Ye.weight}kg  ${Ye.reps}`:Ye.time!==void 0?`${Ye.time}s`:`${Ye.reps} reps`]})]},J))})]}),ee&&(()=>{const J=pt()?.days[Ce],ke=M.reduce((lt,St)=>lt+St.sets.length,0),qe=M.reduce((lt,St)=>lt+St.sets.reduce((Xt,Bt)=>Xt+(Bt.weight||0)*(Bt.reps||0),0),0),nt=[{value:M.length,label:"Exercises"},{value:ke,label:"Sets"}];return qe>0&&nt.push({value:Math.round(qe).toLocaleString(),label:"Volume (kg)"}),r.jsx(Xh,{title:"Session Complete!",subtitle:`Week ${te}  ${J?.name}: ${J?.label}`,stats:nt,buttonLabel:"Back to Programme",hideShare:!l,onShareJourney:t?ie:null,userName:t?.name,onDismissStart:()=>k("dashboard"),onDone:()=>{Y(!1)}})})(),it&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>ft(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ye=>Ye.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:it.badges.length===1?"Badge Earned!":`${it.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:it.badges.map((Ye,J)=>r.jsx("div",{className:"pg-badge-celebration-item",children:Ye.type==="pb_target"?`${Ye.exercise}  ${Ye.targetWeight}kg`:Ye.label},J))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ye=>{Ye.stopPropagation();const J=it.badges[0],ke=it.badges.map(nt=>nt.type==="pb_target"?`PB Target Hit: ${nt.exercise}  ${nt.targetWeight}kg`:nt.label),qe=Wn.find(nt=>nt.id===J?.id)||Wn.find(nt=>nt.name===J?.label);await ie({type:"badge_earned",title:ke.length===1?ke[0]:`${ke.length} Badges Earned!`,badges:ke,badgeDesc:qe?.desc}),vt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ye=>{Ye.stopPropagation();const J=it.badges[0],ke=it.badges.map(lt=>lt.type==="pb_target"?`PB Target Hit: ${lt.exercise}  ${lt.targetWeight}kg`:lt.label),qe=Wn.find(lt=>lt.id===J?.id)||Wn.find(lt=>lt.name===J?.label),nt=`Badge Earned! ${ke.join(", ")}
#MindCoreFitness`;try{const lt=await eb({type:"badge",title:ke.length===1?ke[0]:"Badges Earned!",badges:ke,badgeImage:qe?.img,badgeDesc:qe?.desc});navigator.share&&navigator.canShare?.({files:[new File([lt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:nt,files:[new File([lt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:nt}):(await navigator.clipboard.writeText(nt),vt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(nt),vt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>ft(null),children:"Tap to dismiss"})]})}),ls]})}return null}const YD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},QD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Xp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function XD(n){return YD[n]||"push"}function JD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function ZD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function eP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=dr(),[g,y]=v.useState(!0),[x,k]=v.useState(null),[j,B]=v.useState({}),[W,V]=v.useState([]),[L,ee]=v.useState(null),[Y,te]=v.useState(0),[we,Ce]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[me,Me,Ue,X]=await Promise.all([Ls(Ke(pe,"coreBuddyAchievements",t.id)),Ls(Ke(pe,"coreBuddyPBs",t.id)),Ls(Ke(pe,"achievements",t.id)),As(Fs(Ht(pe,"workoutLogs"),bs("clientId","==",t.id)))]);me.exists()&&k(me.data()),Me.exists()&&B(Me.data().exercises||{}),Ue.exists()&&(V(Object.keys(Ue.data().badges||{})),Ce(Ue.data().progress||{})),te(X.docs.length)}catch(me){console.error("Error loading achievements:",me)}y(!1)})()},[t]);const xe=x?.badges||[],C=x?.totalVolume||0,T=xe.filter(q=>q.type==="pb_target"),A=xe.filter(q=>q.type==="volume_milestone"),O={push:[],pull:[],lower:[],core:[]};T.forEach(q=>{const me=q.group||XD(q.exercise);O[me]&&O[me].push(q)});const M=Xp.find(q=>C<q.threshold),z=Xp.filter(q=>C>=q.threshold).pop()?.threshold||0,I=M?(C-z)/(M.threshold-z):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const We=xe.length+W.length,bt=We>0||C>0||Y>0;return r.jsx(Ca,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:We}),r.jsx("span",{className:"ach-stat-label",children:We===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:JD(C)}),r.jsxs("span",{className:"ach-stat-label",children:[ZD(C)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!bt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(q=>{const me=Wn.filter(X=>X.category===q.key);if(me.length===0)return null;const Me=(()=>{switch(q.key){case"workouts":return Y;case"streaks":return we.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return we.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return we.habitStreak||0;default:return 0}})(),Ue=me.filter(X=>W.includes(X.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:q.iconPath})}),q.title]}),r.jsx("div",{className:"ach-workout-carousel",children:me.map(X=>{const P=W.includes(X.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>ee(X),children:[r.jsx("img",{src:X.img,alt:X.name,className:"ach-workout-badge-img"}),!P&&X.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Me/X.threshold*100,100)}%`}})})]},X.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Ue,"/",me.length," unlocked"]})]},q.key)}),L&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>ee(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:q=>q.stopPropagation(),children:[r.jsx("img",{src:L.img,alt:L.name,className:`ach-badge-overlay-img${W.includes(L.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:L.desc}),W.includes(L.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>ee(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:$k.map((q,me)=>{const Me=me<Math.round(I*60);return r.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:Me?"ach-tick-filled":"ach-tick-empty",strokeWidth:q.thick?"3":"2"},me)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),M&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:M.label})," (",(M.threshold-C).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Xp.map((q,me)=>{const Me=C>=q.threshold,Ue=A.find(X=>X.milestone===q.threshold);return r.jsxs("div",{className:`ach-milestone ${Me?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:q.icon})}),r.jsx("span",{className:"ach-milestone-label",children:q.label}),Ue?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Ue.achievedAt.toDate?Ue.achievedAt.toDate():new Date(Ue.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},me)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(O).map(([q,me])=>{if(me.length===0)return null;const Me=QD[q];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Me.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Me.color},children:Me.label}),r.jsx("span",{className:"ach-group-count",children:me.length})]}),r.jsx("div",{className:"ach-badge-grid",children:me.map((Ue,X)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${X*.06}s`,"--group-color":Me.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Me.color,boxShadow:`0 0 12px ${Me.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Me.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Me.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Ue.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Me.color},children:[Ue.targetWeight,"kg"]}),Ue.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Ue.achievedAt.toDate?Ue.achievedAt.toDate():new Date(Ue.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},X))})]},q)})]})]}),r.jsx(fa,{active:"home"})]})})}const tP=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],sP="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",nP="#e91e63",rP=700,Mg=42,Fl=2*Math.PI*Mg,dh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function aP(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Fo(n){return n.toISOString().split("T")[0]}function iP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function oP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_HABIT_LIMIT:g}=pc(),y=dr(),[x,k]=v.useState({}),[j,B]=v.useState([]),[W,V]=v.useState(!0),[L,ee]=v.useState(!1),[Y,te]=v.useState(0),[we,Ce]=v.useState(null),[xe,C]=v.useState(null),[T,A]=v.useState(!1),[O,M]=v.useState(!1),[z,I]=v.useState(!1),[We,bt]=v.useState(!1),[q,me]=v.useState(""),[Me,Ue]=v.useState(null),[X,P]=v.useState([]),[re,Pe]=v.useState(null),Be=v.useRef(null),De=v.useRef(null),Ne=v.useRef(null),it=v.useRef(null),ft=v.useRef(!1),et=v.useRef({}),Yt=v.useRef([]),Ts=v.useRef([]),Pt=v.useRef(null),vt=v.useRef(dh[Math.floor(Math.random()*dh.length)]),ie=v.useCallback((J,ke="info")=>{Ce({message:J,type:ke}),setTimeout(()=>Ce(null),3e3)},[]),Ct=new Date,_t=Fo(Ct),zt=aP(Ct),Tt=iP(zt),kt=["M","T","W","T","F","S","S"],tt=[...tP.filter(J=>!X.includes(J.key)),...j.map(J=>({key:`custom_${J.id}`,label:J.label,icon:sP,color:nP,isCustom:!0,id:J.id}))],pt=p?tt:tt.slice(0,g);v.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ke=Ht(pe,"habitLogs"),qe=Fs(ke,bs("clientId","==",t.id)),nt=await As(qe),lt={};nt.docs.forEach(U=>{const fe=U.data();lt[fe.date]={...fe,_id:U.id}}),k(lt);const St=await Ls(Ke(pe,"customHabits",t.id));if(St.exists()){const U=St.data();B(U.habits||[]),P(U.hiddenDefaults||[])}let Xt=0;const Bt=new Date(Ct);for(;;){const U=Fo(Bt),fe=lt[U];if(fe)if(Object.values(fe.habits||{}).filter(Boolean).length>=3)Xt++,Bt.setDate(Bt.getDate()-1);else break;else if(U===_t)Bt.setDate(Bt.getDate()-1);else break}te(Xt)}catch(ke){console.error("Error loading habit logs:",ke)}finally{V(!1)}})()},[n,t]);const Qt=x[_t]||{habits:{}};v.useEffect(()=>{Object.values(Qt.habits||{}).filter(Boolean).length<pt.length&&z&&I(!1)},[pt.length,Qt.habits]);const zs=async J=>{if(!(!n||L||Qt.habits?.[J])){Yt.current=[...Array(10)].map((qe,nt)=>{const lt=nt/10*2*Math.PI,St=18+Math.random()*20;return{tx:Math.cos(lt)*St,ty:Math.sin(lt)*St,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),C(J),setTimeout(()=>C(null),700),navigator.vibrate&&navigator.vibrate(50),ee(!0);try{const nt={...Qt.habits||{},[J]:!0},lt=Qt._id||`${t.id}_${_t}`;k(Xt=>({...Xt,[_t]:{clientId:t.id,date:_t,habits:nt,_id:lt}})),await Is(Ke(pe,"habitLogs",lt),{clientId:t.id,date:_t,habits:nt}),Object.values(nt).filter(Boolean).length===pt.length&&!z&&(vt.current=dh[Math.floor(Math.random()*dh.length)],Ts.current=[...Array(80)].map((Xt,Bt)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Bt%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Bt%3})),setTimeout(()=>{A(!0),I(!0),setTimeout(()=>Pt.current?.focus(),1100)},400))}catch(qe){console.error("Error saving habit:",qe),ie("Failed to save. Try again.","error"),k(nt=>({...nt,[_t]:{...nt[_t],habits:{...nt[_t]?.habits||{},[J]:!1}}}))}finally{ee(!1)}}},Ft=async J=>{if(!(!n||L)){ee(!0);try{const qe={...Qt.habits||{},[J]:!1},nt=Qt._id||`${t.id}_${_t}`;await Is(Ke(pe,"habitLogs",nt),{clientId:t.id,date:_t,habits:qe}),k(lt=>({...lt,[_t]:{clientId:t.id,date:_t,habits:qe,_id:nt}}))}catch(ke){console.error("Error undoing habit:",ke),ie("Failed to undo. Try again.","error")}finally{ee(!1)}}},At=J=>{if(Qt.habits?.[J]||!1||L||it.current)return;it.current=J,Pe(J),De.current=performance.now();const qe=et.current[J];qe&&(qe.style.strokeDashoffset=Fl);const nt=lt=>{const St=lt-De.current,Xt=Math.min(St/rP,1),Bt=et.current[J];Bt&&(Bt.style.strokeDashoffset=Fl-Xt*Fl),Xt<1?Ne.current=requestAnimationFrame(nt):(it.current=null,ft.current=!0,Ne.current=null,Pe(null),zs(J))};Ne.current=requestAnimationFrame(nt)},is=()=>{if(!it.current)return;const J=it.current;it.current=null,Ne.current&&(cancelAnimationFrame(Ne.current),Ne.current=null),Be.current&&(clearTimeout(Be.current),Be.current=null),et.current[J]&&(et.current[J].style.strokeDashoffset=Fl),Pe(null),De.current=null};v.useEffect(()=>()=>{Ne.current&&cancelAnimationFrame(Ne.current),Be.current&&clearTimeout(Be.current)},[]);const Cs=v.useCallback(async J=>{if(!t)throw new Error("Not signed in");const ke=J&&typeof J=="object"&&J.type;await ha(Ht(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ke?"":J,type:ke?J.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...ke?{metadata:{title:J.title||"",subtitle:J.subtitle||"",stats:J.stats||[],quote:J.quote||"",badges:J.badges||[]}}:{}})},[t]),ss=async()=>{const J=q.trim();if(!J)return;if(!t?.id){ie("Still loading, try again","error");return}const ke=Date.now().toString(36),qe=[...j,{id:ke,label:J}];try{await Is(Ke(pe,"customHabits",t.id),{clientId:t.id,habits:qe,hiddenDefaults:X},{merge:!0}),B(qe),me(""),bt(!1),ie(`Added "${J}"`,"success")}catch(nt){console.error("Error adding custom habit:",nt),ie(nt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${nt?.message||"Unknown error"}`,"error")}},sn=async J=>{if(!t?.id)return;const ke=j.filter(qe=>qe.id!==J);try{await Is(Ke(pe,"customHabits",t.id),{clientId:t.id,habits:ke,hiddenDefaults:X},{merge:!0}),B(ke),Ue(null),ie("Habit removed","success")}catch(qe){console.error("Error deleting habit:",qe),ie("Failed to remove","error")}},Ms=async J=>{if(!t?.id)return;const ke=[...X,J];try{await Is(Ke(pe,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:ke},{merge:!0}),P(ke),Ue(null),ie("Habit removed","success")}catch(qe){console.error("Error hiding default habit:",qe),ie("Failed to remove","error")}},Os=Tt.map(J=>{const ke=Fo(J),qe=x[ke],nt=qe?Object.values(qe.habits||{}).filter(Boolean).length:0;return{date:J,dateStr:ke,completed:nt,total:pt.length}}),ls=Os.reduce((J,ke)=>J+ke.completed,0),ps=Os.reduce((J,ke)=>J+ke.total,0),ye=ps>0?Math.round(ls/ps*100):0,Se=Object.values(Qt.habits||{}).filter(Boolean).length,Le=pt.length>0?Math.round(Se/pt.length*100):0,Qe=Se===pt.length&&pt.length>0,ze=(()=>{const J=Object.keys(x).sort();let ke=0,qe=0,nt=null;for(const lt of J){const St=x[lt];if(Object.values(St.habits||{}).filter(Boolean).length>=3){if(nt){const Bt=new Date(nt);qe=(new Date(lt)-Bt)/(1e3*60*60*24)===1?qe+1:1}else qe=1;qe>ke&&(ke=qe),nt=lt}else qe=0,nt=null}return Math.max(ke,Y)})(),Xe=new Date(Ct.getFullYear(),Ct.getMonth(),1),dt=Xe.toLocaleString("default",{month:"long"}),Q=new Date(Ct.getFullYear(),Ct.getMonth()+1,0).getDate(),se=(Xe.getDay()+6)%7,He=Array.from({length:Q},(J,ke)=>{const qe=new Date(Ct.getFullYear(),Ct.getMonth(),ke+1),nt=Fo(qe),lt=x[nt],St=lt?Object.values(lt.habits||{}).filter(Boolean).length:0,Xt=qe>Ct;return{day:ke+1,dateStr:nt,completed:St,total:pt.length,isFuture:Xt,isToday:nt===_t}}),gt=pt.map(J=>({...J,days:Tt.map(ke=>{const qe=Fo(ke);return x[qe]?.habits?.[J.key]||!1})})),Ye=Os.filter(J=>J.completed===J.total&&J.total>0).length;return r.jsx(Ca,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||W?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-hero anim-fade-up",children:[r.jsxs("div",{className:`cbc-progress-ring${Qe?" cbc-ring-complete":""}`,children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Le/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-count",children:[Se,r.jsx("span",{className:"cbc-ring-divider",children:"/"}),pt.length]}),r.jsx("span",{className:"cbc-ring-label",children:Qe?"complete":"today"})]})]}),r.jsx("p",{className:"cbc-hero-tagline",children:Qe?"You showed up for yourself today.":Se===0?"Start your day strong.":`${pt.length-Se} to go  keep pushing.`})]}),r.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[r.jsx("div",{className:"cbc-streak-icon",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),r.jsxs("div",{className:"cbc-streak-info",children:[r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),r.jsxs("div",{className:"cbc-streak-best",children:[r.jsx("span",{className:"cbc-streak-best-val",children:ze}),r.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[pt.map(J=>{const ke=Qt.habits?.[J.key]||!1,qe=xe===J.key,nt=re===J.key;return r.jsxs("div",{className:`cbc-habit-tile ${ke?"cbc-habit-done":""} ${qe?"cbc-habit-just-checked":""}`,style:{"--habit-color":J.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:lt=>{lt.stopPropagation(),Ue(J.isCustom?{type:"custom",id:J.id,label:J.label}:{type:"default",key:J.key,label:J.label})},"aria-label":`Remove ${J.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${nt?"cbc-holding":""} ${ke?"cbc-ring-completed":""}`,onPointerDown:lt=>{ke||(lt.preventDefault(),At(J.key))},onPointerUp:is,onPointerLeave:is,onPointerCancel:is,onClick:lt=>{if(lt.stopPropagation(),ft.current){ft.current=!1;return}ke&&Ft(J.key)},role:"button",tabIndex:0,"aria-label":ke?`Undo ${J.label}`:`Press and hold to complete ${J.label}`,onKeyDown:lt=>{(lt.key==="Enter"||lt.key===" ")&&(lt.preventDefault(),ke?Ft(J.key):zs(J.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Mg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:lt=>{lt&&(et.current[J.key]=lt)},cx:"50",cy:"50",r:Mg,style:{stroke:J.color,strokeDasharray:Fl,strokeDashoffset:ke?0:Fl}})]}),ke&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":J.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:J.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:J.icon})})}),qe&&r.jsx("div",{className:"cbc-particles",children:Yt.current.map((lt,St)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${lt.tx}px`,"--ty":`${lt.ty}px`,"--size":`${lt.size}px`,"--particle-color":J.color,animationDuration:`${lt.duration}s`}},St))})]}),r.jsx("span",{className:"cbc-habit-label",children:J.label}),ke?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},J.key)}),p?r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>bt(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):r.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-unlock-ring",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[r.jsxs("div",{className:"cbc-section-header",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsxs("span",{className:"cbc-section-badge",children:[Ye,"/7 perfect"]})]}),r.jsxs("div",{className:"cbc-weekly-card",children:[r.jsxs("div",{className:"cbc-weekly-header",children:[r.jsx("span",{className:"cbc-weekly-habit-name"}),kt.map((J,ke)=>r.jsx("span",{className:`cbc-weekly-day-label${Tt[ke]&&Fo(Tt[ke])===_t?" cbc-today-label":""}`,children:J},ke))]}),gt.map(J=>(J.days.filter(Boolean).length,r.jsxs("div",{className:"cbc-weekly-row",children:[r.jsx("span",{className:"cbc-weekly-habit-name",style:{color:J.color},children:J.label}),J.days.map((ke,qe)=>r.jsx("span",{className:`cbc-weekly-dot${ke?" cbc-dot-done":""}${Tt[qe]&&Fo(Tt[qe])===_t?" cbc-dot-today":""}`,style:ke?{background:J.color,borderColor:J.color,boxShadow:`0 0 6px ${J.color}40`}:void 0},qe))]},J.key))),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${ye}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[ls,"/",ps," completed (",ye,"%)"]})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:dt}),r.jsxs("div",{className:"cbc-calendar-card",children:[r.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((J,ke)=>r.jsx("span",{className:"cbc-cal-day-label",children:J},ke))}),r.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:se},(J,ke)=>r.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${ke}`)),He.map(J=>{const ke=J.total>0?J.completed/J.total:0,qe=J.isFuture?-1:ke===0?0:ke<.4?1:ke<.75?2:ke<1?3:4;return r.jsx("span",{className:`cbc-cal-cell${J.isToday?" cbc-cal-today":""}${qe===4?" cbc-cal-perfect":""} cbc-cal-heat-${qe<0?"future":qe}`,children:J.day},J.day)})]}),r.jsxs("div",{className:"cbc-cal-legend",children:[r.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),r.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),r.jsx(fa,{active:"home"}),We&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>bt(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:J=>J.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:q,onChange:J=>me(J.target.value),maxLength:30,autoFocus:!0,onKeyDown:J=>J.key==="Enter"&&ss()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{bt(!1),me("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:ss,disabled:!q.trim(),children:"Add"})]})]})}),Me&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ue(null),children:r.jsxs("div",{className:"cbc-modal",onClick:J=>J.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Me.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Ue(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>Me.type==="custom"?sn(Me.id):Ms(Me.key),children:"Remove"})]})]})}),T&&r.jsx(Xh,{title:"All Habits Complete!",subtitle:vt.current,stats:[{value:`${Se}/${pt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Cs:null,userName:t?.name,onDone:()=>{A(!1),M(!1)}}),we&&r.jsx("div",{className:`toast-notification ${we.type}`,children:we.message})]})})}function hh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function M2(n,e){return[n,e].sort().join("_")}function lP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=zr(),{isDark:l,toggleTheme:u}=Ia(),d=dr(),[p,g]=v.useState("buddies"),[y,x]=v.useState([]),[k,j]=v.useState([]),[B,W]=v.useState([]),[V,L]=v.useState(""),[ee,Y]=v.useState([]),[te,we]=v.useState([]),[Ce,xe]=v.useState(!0),[C,T]=v.useState(null),[A,O]=v.useState(null),M=v.useCallback((X,P="info")=>{O({message:X,type:P}),setTimeout(()=>O(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const z=v.useCallback(async()=>{if(t){xe(!0);try{const X=t.id,re=(await As(Ht(pe,"clients"))).docs.map(et=>({id:et.id,...et.data()}));we(re);const Pe=Object.fromEntries(re.map(et=>[et.id,et])),Be=await As(Fs(Ht(pe,"buddies"),bs("user1","==",X))),De=await As(Fs(Ht(pe,"buddies"),bs("user2","==",X))),Ne=new Set;[...Be.docs,...De.docs].forEach(et=>{const Yt=et.data(),Ts=Yt.user1===X?Yt.user2:Yt.user1;Ne.add(Ts)}),x(Array.from(Ne).map(et=>Pe[et]).filter(Boolean));const it=await As(Fs(Ht(pe,"buddyRequests"),bs("toId","==",X),bs("status","==","pending")));j(it.docs.map(et=>({reqId:et.id,...et.data(),fromClient:Pe[et.data().fromId]})).filter(et=>et.fromClient));const ft=await As(Fs(Ht(pe,"buddyRequests"),bs("fromId","==",X),bs("status","==","pending")));W(ft.docs.map(et=>({reqId:et.id,...et.data(),toClient:Pe[et.data().toId]})).filter(et=>et.toClient))}catch(X){console.error("Error fetching buddy data:",X),M("Failed to load buddies","error")}finally{xe(!1)}}},[t,M]);v.useEffect(()=>{z()},[z]),v.useEffect(()=>{if(!V.trim()||!t){Y([]);return}const X=V.toLowerCase(),P=t.id,re=new Set(y.map(Ne=>Ne.id)),Pe=new Set(B.map(Ne=>Ne.toId)),Be=new Set(k.map(Ne=>Ne.fromId)),De=te.filter(Ne=>Ne.id===P||!Ne.name||!Ne.coreBuddyAccess&&Ne.clientType!=="core_buddy"?!1:Ne.name.toLowerCase().includes(X)).map(Ne=>({...Ne,isBuddy:re.has(Ne.id),isPendingOut:Pe.has(Ne.id),isPendingIn:Be.has(Ne.id)})).slice(0,20);Y(De)},[V,te,y,B,k,t]);const I=async(X,P)=>{if(!(!t||X===t.id))try{await ha(Ht(pe,"notifications"),{toId:X,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:vr()})}catch(re){console.error("Notification error:",re),re.code==="permission-denied"&&M("Notifications blocked  check Firestore rules","error")}},We=async X=>{T(X);try{const P=`${t.id}_${X}`;await Is(Ke(pe,"buddyRequests",P),{fromId:t.id,toId:X,status:"pending",createdAt:vr()}),await I(X,"buddy_request"),M("Buddy request sent!","success"),await z()}catch(P){console.error("Error sending request:",P),M("Failed to send request","error")}finally{T(null)}},bt=async X=>{T(X.reqId);try{const P=M2(X.fromId,t.id);await Is(Ke(pe,"buddies",P),{user1:[X.fromId,t.id].sort()[0],user2:[X.fromId,t.id].sort()[1],connectedAt:vr()}),await Tr(Ke(pe,"buddyRequests",X.reqId)),await I(X.fromId,"buddy_accept"),M("Buddy added!","success"),await z()}catch(P){console.error("Error accepting request:",P),M("Failed to accept","error")}finally{T(null)}},q=async X=>{T(X.reqId);try{await Tr(Ke(pe,"buddyRequests",X.reqId)),M("Request declined","info"),await z()}catch(P){console.error("Error declining:",P),M("Failed to decline","error")}finally{T(null)}},me=async X=>{T(X.reqId);try{await Tr(Ke(pe,"buddyRequests",X.reqId)),M("Request cancelled","info"),await z()}catch(P){console.error("Error cancelling:",P),M("Failed to cancel","error")}finally{T(null)}},Me=async X=>{T(X);try{const P=M2(t.id,X);await Tr(Ke(pe,"buddies",P)),M("Buddy removed","info"),await z()}catch(P){console.error("Error removing buddy:",P),M("Failed to remove buddy","error")}finally{T(null)}},Ue=k.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Ca,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Ue>0&&r.jsx("span",{className:"bdy-tab-badge",children:Ue})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Ce?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:hh(X.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:X.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Me(X.id)},disabled:C===X.id,"aria-label":"Remove buddy",children:C===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},X.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[k.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:k.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.fromClient.photoURL?r.jsx("img",{src:X.fromClient.photoURL,alt:X.fromClient.name}):r.jsx("span",{children:hh(X.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>bt(X),disabled:C===X.reqId,children:C===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>q(X),disabled:C===X.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},X.reqId))})]}),B.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:B.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.toClient?.photoURL?r.jsx("img",{src:X.toClient.photoURL,alt:X.toClient.name}):r.jsx("span",{children:hh(X.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>me(X),disabled:C===X.reqId,children:C===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},X.reqId))})]}),k.length===0&&B.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:V,onChange:X=>L(X.target.value),autoFocus:!0}),V&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>L(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),V.trim()&&ee.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',V,'"']})}),ee.length>0&&r.jsx("div",{className:"bdy-list",children:ee.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:hh(X.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.name}),X.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),X.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):X.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):X.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const re=k.find(Pe=>Pe.fromId===X.id);re&&bt(re)},disabled:!!C,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),We(X.id)},disabled:C===X.id,children:C===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},X.id))})]})]})]}),r.jsx(fa,{}),A&&r.jsxs("div",{className:`toast-notification ${A.type}`,children:[r.jsx("span",{className:"toast-icon",children:A.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:A.message})]})]})})}function mh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Jp(n,e){return[n,e].sort().join("_")}const cP=5;function Zp(n){return n.toISOString().split("T")[0]}function uP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const dP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function D2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function hP(){const{userId:n}=bE(),{currentUser:e,isClient:t,clientData:i,loading:l}=zr(),{isDark:u,toggleTheme:d}=Ia(),p=dr(),[g,y]=v.useState(null),[x,k]=v.useState("none"),[j,B]=v.useState(null),[W,V]=v.useState(!0),[L,ee]=v.useState(!1),[Y,te]=v.useState(null),[we,Ce]=v.useState([]),[xe,C]=v.useState(!1),[T,A]=v.useState(new Set),[O,M]=v.useState(new Set),[z,I]=v.useState({}),[We,bt]=v.useState({}),[q,me]=v.useState({}),[Me,Ue]=v.useState(!0),[X,P]=v.useState(0),[re,Pe]=v.useState(0),[Be,De]=v.useState(0),[Ne,it]=v.useState(0),[ft,et]=v.useState([]),[Yt,Ts]=v.useState([]),[Pt,vt]=v.useState(null),[ie,Ct]=v.useState(null),[_t,zt]=v.useState(0),[Tt,kt]=v.useState([]),[tt,pt]=v.useState(!1),[Qt,zs]=v.useState(null),[Ft,At]=v.useState([]),is=v.useCallback((Q,se="info")=>{te({message:Q,type:se}),setTimeout(()=>te(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Q=!1;return(async()=>{V(!0);try{const gt=(await As(Ht(pe,"clients"))).docs.map(qe=>({id:qe.id,...qe.data()})).find(qe=>qe.id===n);if(!gt){Q||V(!1);return}Q||y(gt);const Ye=i.id,J=Jp(Ye,n);if((await Ls(Ke(pe,"buddies",J))).exists())Q||k("buddy");else{const qe=`${Ye}_${n}`,nt=await Ls(Ke(pe,"buddyRequests",qe));if(nt.exists()&&nt.data().status==="pending")Q||(k("pending_out"),B(qe));else{const lt=`${n}_${Ye}`,St=await Ls(Ke(pe,"buddyRequests",lt));St.exists()&&St.data().status==="pending"?Q||(k("pending_in"),B(lt)):Q||k("none")}}}catch(se){console.error("Error loading profile:",se)}finally{Q||V(!1)}})(),()=>{Q=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Q=!1;return(async()=>{Ue(!0);try{const[se,He,gt,Ye]=await Promise.all([As(Fs(Ht(pe,"workoutLogs"),bs("clientId","==",n))),Ls(Ke(pe,"coreBuddyAchievements",n)),Ls(Ke(pe,"coreBuddyPBs",n)),Ls(Ke(pe,"clientProgrammes",n))]);if(Q)return;const J=se.docs.length;P(J),He.exists()&&Pe(He.data().totalVolume||0);let ke=0;const qe=se.docs.map(St=>St.data().date).filter(Boolean).sort().reverse();if(qe.length>0){const St=new Date;let Xt=new Date(St);for(let Bt=0;Bt<52;Bt++){const U=new Date(Xt),fe=U.getDay(),Re=fe===0?6:fe-1;U.setDate(U.getDate()-Re),U.setHours(0,0,0,0);const Te=new Date(U);Te.setDate(Te.getDate()+7);const je=Zp(U),ht=Zp(Te);if(qe.some(ot=>ot>=je&&ot<ht))ke++;else{if(Bt>0)break;break}Xt.setDate(Xt.getDate()-7)}}if(Q||De(ke),gt.exists()){const St=gt.data().exercises||{},Xt=Object.entries(St).sort(([,Bt],[,U])=>(U.weight||0)-(Bt.weight||0)).slice(0,3).map(([Bt,U])=>({name:Bt,weight:U.weight,reps:U.reps}));Q||et(Xt)}if(Ye.exists()){const St=Ye.data(),Xt=dP[St.templateId];if(Xt){const Bt=Object.keys(St.completedSessions||{}).length,U=Xt.duration*Xt.daysPerWeek;Q||(Ct(St.templateId.replace(/_/g," ").replace(/\b\w/g,fe=>fe.toUpperCase())),zt(U>0?Math.round(Bt/U*100):0))}}const nt=await Ls(Ke(pe,"achievements",n));if(!Q&&nt.exists()){const St=nt.data().badges||{};Ts(Object.keys(St))}let lt=0;for(let St=0;St<30;St++){const Xt=new Date;Xt.setDate(Xt.getDate()-St);const Bt=Zp(Xt);try{const U=await As(Fs(Ht(pe,"habitLogs"),bs("clientId","==",n),bs("date","==",Bt)));if(U.empty)break;{const fe=U.docs[0].data().habits||{};if(Object.values(fe).filter(Boolean).length>=cP)lt++;else break}}catch{break}}Q||it(lt)}catch(se){console.error("Error loading buddy stats:",se)}finally{Q||Ue(!1)}})(),()=>{Q=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[se,He,gt]=await Promise.all([As(Fs(Ht(pe,"buddies"),bs("user1","==",Q))),As(Fs(Ht(pe,"buddies"),bs("user2","==",Q))),As(Ht(pe,"clients"))]),Ye=new Set;[...se.docs,...He.docs].forEach(ke=>{const qe=ke.data();Ye.add(qe.user1===Q?qe.user2:qe.user1)});const J={};gt.docs.forEach(ke=>{J[ke.id]=ke.data()}),kt(Array.from(Ye).filter(ke=>J[ke]).map(ke=>({id:ke,name:J[ke].name,photoURL:J[ke].photoURL||null})))}catch(se){console.error("Error loading buddies for mentions:",se)}})()},[i]);const Cs=async(Q,se,He={})=>{if(!(!i||Q===i.id))try{await ha(Ht(pe,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:se,read:!1,createdAt:vr(),...He})}catch(gt){console.error("Notification error:",gt),gt.code==="permission-denied"&&is("Notifications blocked  check Firestore rules","error")}},ss=async()=>{ee(!0);try{const Q=`${i.id}_${n}`;await Is(Ke(pe,"buddyRequests",Q),{fromId:i.id,toId:n,status:"pending",createdAt:vr()}),await Cs(n,"buddy_request"),k("pending_out"),B(Q),is("Buddy request sent!","success")}catch(Q){console.error(Q),is("Failed to send request","error")}finally{ee(!1)}},sn=async()=>{if(j){ee(!0);try{const Q=Jp(i.id,n);await Is(Ke(pe,"buddies",Q),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:vr()}),await Tr(Ke(pe,"buddyRequests",j)),await Cs(n,"buddy_accept"),k("buddy"),is("Buddy added!","success")}catch(Q){console.error(Q),is("Failed to accept","error")}finally{ee(!1)}}},Ms=async()=>{if(j){ee(!0);try{await Tr(Ke(pe,"buddyRequests",j)),k("none"),is(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),is("Failed","error")}finally{ee(!1)}}},Os=async()=>{ee(!0);try{const Q=Jp(i.id,n);await Tr(Ke(pe,"buddies",Q)),k("none"),is("Buddy removed","info")}catch(Q){console.error(Q),is("Failed to remove","error")}finally{ee(!1)}},ls=v.useCallback(async()=>{if(n){C(!0);try{const Q=await As(Fs(Ht(pe,"posts"),bs("authorId","==",n),Yh("createdAt","desc"),Qh(30)));if(Ce(Q.docs.map(se=>({id:se.id,...se.data()}))),i){const se=await As(Fs(Ht(pe,"postLikes"),bs("userId","==",i.id)));A(new Set(se.docs.map(He=>He.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{C(!1)}}},[n,i]);v.useEffect(()=>{!W&&g&&ls()},[W,g,ls]);const ps=async Q=>{if(window.confirm("Delete this post?"))try{await Tr(Ke(pe,"posts",Q)),Ce(se=>se.filter(He=>He.id!==Q)),is("Post deleted","info")}catch(se){console.error("Delete error:",se),is("Failed to delete","error")}},ye=async Q=>{if(!i)return;const se=i.id,He=`${Q}_${se}`,gt=T.has(Q),Ye=new Set(T);gt?Ye.delete(Q):Ye.add(Q),A(Ye),Ce(J=>J.map(ke=>ke.id===Q?{...ke,likeCount:Math.max(0,(ke.likeCount||0)+(gt?-1:1))}:ke));try{if(gt)await Tr(Ke(pe,"postLikes",He)),await ja(Ke(pe,"posts",Q),{likeCount:Wo(-1)});else{await Is(Ke(pe,"postLikes",He),{postId:Q,userId:se,createdAt:vr()}),await ja(Ke(pe,"posts",Q),{likeCount:Wo(1)});const J=we.find(ke=>ke.id===Q);J&&Cs(J.authorId,"like",{postId:Q})}}catch(J){console.error("Like error:",J),ls()}},Se=async Q=>{try{const se=await As(Fs(Ht(pe,"postComments"),bs("postId","==",Q),Yh("createdAt","asc"),Qh(50)));I(He=>({...He,[Q]:se.docs.map(gt=>({id:gt.id,...gt.data()}))}))}catch(se){console.error("Error loading comments:",se)}},Le=Q=>{const se=new Set(O);se.has(Q)?se.delete(Q):(se.add(Q),z[Q]||Se(Q)),M(se)},Qe=(Q,se)=>{const He=Q.match(/@(\w*)$/);if(He){pt(!0),zs(se);const gt=Tt.filter(Ye=>Ye.name&&Ye.name.toLowerCase().includes(He[1].toLowerCase())).slice(0,5);At(gt)}else pt(!1),At([])},ze=(Q,se)=>{const gt=(We[se]||"").replace(/@\w*$/,`@${Q.name} `);bt(Ye=>({...Ye,[se]:gt})),pt(!1),At([])},Xe=(Q,se)=>{bt(He=>({...He,[Q]:se})),Qe(se,Q)},dt=async Q=>{const se=(We[Q]||"").trim();if(!(!se||!i)){me(He=>({...He,[Q]:!0}));try{await ha(Ht(pe,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:se,createdAt:vr()}),await ja(Ke(pe,"posts",Q),{commentCount:Wo(1)});const He=we.find(Ye=>Ye.id===Q);He&&Cs(He.authorId,"comment",{postId:Q});const gt=se.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(gt){const Ye=new Set;gt.forEach(J=>{const ke=J.slice(1).trim(),qe=Tt.find(nt=>nt.name&&nt.name.toLowerCase()===ke.toLowerCase());qe&&!Ye.has(qe.id)&&(Ye.add(qe.id),Cs(qe.id,"mention",{postId:Q}))})}bt(Ye=>({...Ye,[Q]:""})),Ce(Ye=>Ye.map(J=>J.id===Q?{...J,commentCount:(J.commentCount||0)+1}:J)),await Se(Q)}catch(He){console.error("Comment error:",He),is("Failed to comment","error")}finally{me(He=>({...He,[Q]:!1}))}}};return l||W||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Ca,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:mh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ss,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ms,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:sn,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ms,disabled:L,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Os,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Me?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:X}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[uP(re),r.jsx("span",{className:"prf-stat-unit",children:re>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[re>=1e6?"Million kg":re>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Be,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ie||Ne>0)&&r.jsxs("div",{className:"prf-info-row",children:[ie&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ie}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(_t,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[_t,"% complete"]})]})]}),Ne>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Ne," day",Ne!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),ft.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:ft.map((Q,se)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:se===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${se+1}`}),r.jsx("span",{className:"prf-pb-name",children:Q.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},se))})]}),Yt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Yt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Yt.map(Q=>{const se=Wn.find(He=>He.id===Q);return se?r.jsx("button",{className:"prf-badge-chip",onClick:()=>vt(se),children:r.jsx("img",{src:se.img,alt:se.name,className:"prf-badge-chip-img"})},Q):null})})]}),Pt&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>vt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Q=>Q.stopPropagation(),children:[r.jsx("img",{src:Pt.img,alt:Pt.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:Pt.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>vt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),xe?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):we.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:we.map(Q=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?r.jsx("img",{src:Q.authorPhotoURL,alt:""}):r.jsx("span",{children:mh(Q.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Q.authorName}),r.jsx("span",{className:"journey-post-time",children:D2(Q.createdAt)})]}),Q.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>ps(Q.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&r.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(Q.id)?" liked":""}`,onClick:()=>ye(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Q.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${O.has(Q.id)?" active":""}`,onClick:()=>Le(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Q.commentCount||0})]})]}),O.has(Q.id)&&r.jsxs("div",{className:"journey-comments",children:[z[Q.id]?.length>0?z[Q.id].map(se=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${se.authorId}`),children:se.authorPhotoURL?r.jsx("img",{src:se.authorPhotoURL,alt:""}):r.jsx("span",{children:mh(se.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:se.authorName}),r.jsx("span",{className:"journey-comment-text",children:se.content})]}),r.jsx("span",{className:"journey-comment-time",children:D2(se.createdAt)})]})]},se.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:We[Q.id]||"",onChange:se=>Xe(Q.id,se.target.value),onKeyDown:se=>{se.key==="Enter"&&dt(Q.id)},maxLength:300}),tt&&Qt===Q.id&&Ft.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ft.map(se=>r.jsxs("button",{className:"mention-option",onClick:()=>ze(se,Q.id),children:[r.jsx("div",{className:"mention-option-avatar",children:se.photoURL?r.jsx("img",{src:se.photoURL,alt:""}):r.jsx("span",{children:mh(se.name)})}),r.jsx("span",{children:se.name})]},se.id))}),r.jsx("button",{onClick:()=>dt(Q.id),disabled:!(We[Q.id]||"").trim()||q[Q.id],children:q[Q.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),r.jsx(fa,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(fa,{})]})}function mP(){const n=dr(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=zr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,x]=v.useState(!1),[k,j]=v.useState(null),[B,W]=v.useState(!1),[V,L]=v.useState(null),ee=v.useRef(null),Y=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(fa,{active:"home"})]});v.useEffect(()=>{ee.current&&ee.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&te([])},[]);const te=async T=>{x(!0),j(null);try{const O=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:T,clientName:e?.name||t?.displayName||"there"})})).json();if(O.error){j(O.error);return}const M={role:"assistant",content:O.reply};d(z=>[...z,M]),O.profileData&&(await C(O.profileData),L(O.profileData),W(!0))}catch(A){console.error("Buddy chat error:",A),j("Something went wrong  try sending again.")}finally{x(!1)}},we=()=>{const T=p.trim();if(!T||y)return;const A={role:"user",content:T},O=[...u,A];d(O),g(""),Y.current&&Y.current.focus(),te(O)},Ce=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),we())},xe=T=>{const A=T?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},C=async T=>{try{const A=await i();if(!A)return;await Is(Ke(pe,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:T.dob||null,gender:T.gender||null,goals:T.goals||[],experience:T.experience||null,injuries:T.injuries||null,activityLevel:T.activityLevel||null,exerciseHistory:T.exerciseHistory||null,sleepHours:T.sleepHours||null,stressLevel:T.stressLevel||null,dietaryInfo:T.dietaryInfo||null,availability:T.availability||null,additionalInfo:T.additionalInfo||null},submittedAt:vr()});const O=T.goals||[];await ja(Ke(pe,"clients",A.id),{fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:T.experience||null,dob:T.dob||null,injuries:T.injuries||null}),l({fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:T.experience,dob:T.dob})}catch(A){console.error("Save profile error:",A)}};return r.jsx(Ca,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((T,A)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${T.role}`,children:[T.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:T.content})]},A)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),k&&r.jsxs("div",{className:"buddy-chat-error",children:[k,r.jsx("button",{onClick:()=>te(u),children:"Retry"})]}),r.jsx("div",{ref:ee})]}),B?r.jsx("div",{className:"buddy-chat-done",children:V?(()=>{const T=xe(V);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:T.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:T.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[T.duration," weeks  ",T.daysPerWeek," days/week  ",T.level]}),r.jsx("div",{className:"buddy-rec-desc",children:T.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:Y,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:T=>g(T.target.value),onKeyDown:Ce,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:we,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(fa,{active:"home"})]})})}const wa=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],zo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function fP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function _a(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function pP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function gP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function fh(n,e){if(!e)return"-";switch(n.unit){case"weight":return gP(e.weight,e.reps);case"time":return pP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function zl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function eg(n,e){return!e||e===0?null:(n-e)/e*100}function yP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(V=>{const L=V.benchmarks?.[e];if(!L)return 0;switch(t){case"weight":return(L.weight||0)*(L.reps||0);case"time":return L.time||0;case"reps":return L.reps||0;case"distance":return L.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,j=i.map((V,L)=>{const ee=y+L/(i.length-1)*x,Y=y+k-(V-u)/d*k;return{x:ee,y:Y,value:V}}),B=j.map((V,L)=>`${L===0?"M":"L"} ${V.x} ${V.y}`).join(" "),W=B+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:B,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((V,L)=>r.jsx("circle",{cx:V.x,cy:V.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((V,L)=>r.jsxs("span",{className:"pb-trend-label",children:[V.month.split("-")[1],"/",V.month.split("-")[0].slice(2)]},L))})]})}function bP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,k]=v.useState(!1),[j,B]=v.useState(!1),[W,V]=v.useState(!1),[L,ee]=v.useState({}),[Y,te]=v.useState({}),[we,Ce]=v.useState({}),[xe,C]=v.useState({}),[T,A]=v.useState({}),[O,M]=v.useState(!1),[z,I]=v.useState({}),[We,bt]=v.useState([]),[q,me]=v.useState(null),[Me,Ue]=v.useState(null),[X,P]=v.useState(!1),[re,Pe]=v.useState(""),[Be,De]=v.useState(""),Ne=v.useRef(null),it=v.useRef(0),ft=v.useRef(0),et=v.useRef("right"),Yt=v.useCallback(U=>{y(fe=>{const Re=Math.max(0,Math.min(wa.length-1,U));return Re===fe?fe:(et.current=Re>fe?"right":"left",Re)})},[]),{currentUser:Ts,isClient:Pt,clientData:vt,loading:ie}=zr(),{isDark:Ct}=Ia(),_t=dr(),zt=v.useCallback((U,fe="info")=>{Ue({message:U,type:fe}),setTimeout(()=>Ue(null),4e3)},[]);v.useEffect(()=>{!ie&&(!Ts||!Pt)&&_t("/")},[Ts,Pt,ie,_t]),v.useEffect(()=>{vt&&Tt()},[vt]);const Tt=async()=>{try{const U=Fs(Ht(pe,"juniorPBs"),bs("clientId","==",vt.id)),Re=(await As(U)).docs.map(ot=>({id:ot.id,...ot.data()}));Re.sort((ot,Lt)=>ot.month.localeCompare(Lt.month)),i(Re);const Te=Fs(Ht(pe,"juniorPBTargets"),bs("clientId","==",vt.id)),je=await As(Te);if(!je.empty){const ot=je.docs[0].data();Ce(ot.targets||{}),C(ot.metricTargets||{}),A(ot.targets||{}),I(ot.metricTargets||{})}const ht=Fs(Ht(pe,"juniorAchievements"),bs("clientId","==",vt.id)),Et=await As(ht);Et.empty||bt(Et.docs[0].data().badges||[])}catch(U){console.error("Error fetching junior personal bests:",U)}u(!1)},kt=fP(),tt=t.find(U=>U.month===kt),pt=t.filter(U=>U.month<kt),Qt=pt.length>0?pt[pt.length-1]:null;v.useEffect(()=>{tt?(ee(tt.benchmarks||{}),te(tt.bodyMetrics||{})):(ee({}),te({}))},[tt?.id]);const zs=async(U,fe)=>{const Re=[];if(U==="strength"?wa.forEach(Te=>{const je=we[Te.key];if(!je)return;const ht=fe[Te.key];if(!ht)return;let Et;if(je.targetType==="time"){if(!je.targetValue)return;const ot=je.startValue||0,Lt=ht.time||0,It=je.targetValue-ot;Et=It===0?Lt>=je.targetValue?1:0:Math.max(0,(Lt-ot)/It)}else if(je.targetType==="reps"){if(!je.targetReps)return;const ot=je.startReps||0,Lt=ht.reps||0,It=je.targetReps-ot;Et=It===0?Lt>=je.targetReps?1:0:Math.max(0,(Lt-ot)/It)}else if(je.targetType==="distance"){if(!je.targetDistance)return;const ot=je.startDistance||0,Lt=ht.distance||0,It=je.targetDistance-ot;Et=It===0?Lt>=je.targetDistance?1:0:Math.max(0,(Lt-ot)/It)}else{if(!je.targetWeight&&!je.targetReps)return;const ot=(je.startWeight||0)*(je.startReps||0),Lt=(je.targetWeight||0)*(je.targetReps||0),It=(ht.weight||0)*(ht.reps||0),nn=Lt-ot;Et=nn===0?It>=Lt?1:0:Math.max(0,(It-ot)/nn)}if(Et>=1){let ot,Lt;je.targetType==="time"?(ot=We.some(It=>It.type==="strength"&&It.key===Te.key&&It.targetValue===je.targetValue),Lt=`${Te.name} ${je.targetValue}s`):je.targetType==="reps"?(ot=We.some(It=>It.type==="strength"&&It.key===Te.key&&It.targetReps===je.targetReps),Lt=`${Te.name} ${je.targetReps} reps`):je.targetType==="distance"?(ot=We.some(It=>It.type==="strength"&&It.key===Te.key&&It.targetDistance===je.targetDistance),Lt=`${Te.name} ${je.targetDistance}cm`):(ot=We.some(It=>It.type==="strength"&&It.key===Te.key&&It.targetWeight===je.targetWeight&&It.targetReps===je.targetReps),Lt=`${Te.name} ${je.targetWeight}kg  ${je.targetReps}`),ot||Re.push({type:"strength",key:Te.key,...je.targetType==="time"?{targetType:"time",targetValue:je.targetValue}:je.targetType==="reps"?{targetType:"reps",targetReps:je.targetReps}:je.targetType==="distance"?{targetType:"distance",targetDistance:je.targetDistance}:{targetWeight:je.targetWeight,targetReps:je.targetReps},achievedMonth:kt,label:Lt})}}):zo.forEach(Te=>{const je=xe[Te.key];if(!je||!je.targetValue)return;const ht=fe[Te.key];if(ht==null)return;const Et=je.startValue||0,ot=je.targetValue,Lt=ot-Et;(Lt===0?ht===ot?1:0:Math.max(0,(ht-Et)/Lt))>=1&&(We.some(hn=>hn.type==="metric"&&hn.key===Te.key&&hn.targetValue===ot)||Re.push({type:"metric",key:Te.key,targetValue:ot,achievedMonth:kt,label:`${Te.name} ${ot}${Te.suffix}`}))}),Re.length>0){const Te=[...We,...Re];await Is(Ke(pe,"juniorAchievements",vt.id),{clientId:vt.id,badges:Te,updatedAt:Rt.now()}),bt(Te),me(Re),setTimeout(()=>me(null),5e3)}},Ft=(U,fe)=>{if(U==="strength"){const Re=we[fe];if(!Re)return!1;switch(wa.find(je=>je.key===fe)?.unit){case"time":return We.some(je=>je.type==="strength"&&je.key===fe&&je.targetValue===Re.targetValue);case"reps":return We.some(je=>je.type==="strength"&&je.key===fe&&je.targetReps===Re.targetReps);case"distance":return We.some(je=>je.type==="strength"&&je.key===fe&&je.targetDistance===Re.targetDistance);default:return!Re.targetWeight&&!Re.targetReps?!1:We.some(je=>je.type==="strength"&&je.key===fe&&je.targetWeight===Re.targetWeight&&je.targetReps===Re.targetReps)}}else{const Re=xe[fe];return!Re||!Re.targetValue?!1:We.some(Te=>Te.type==="metric"&&Te.key===fe&&Te.targetValue===Re.targetValue)}},At=async()=>{p(!0);try{const U=`${vt.id}_${kt}`,fe=tt||{};await Is(Ke(pe,"juniorPBs",U),{clientId:vt.id,month:kt,benchmarks:L,bodyMetrics:fe.bodyMetrics||Y||{},createdAt:fe.createdAt||Rt.now(),updatedAt:Rt.now()}),await zs("strength",L),zt("Benchmarks saved!","success"),k(!1),await Tt()}catch(U){console.error("Error saving benchmarks:",U),zt("Failed to save. Please try again.","error")}p(!1)},is=async()=>{p(!0);try{const U=`${vt.id}_${kt}`,fe=tt||{};await Is(Ke(pe,"juniorPBs",U),{clientId:vt.id,month:kt,benchmarks:fe.benchmarks||L||{},bodyMetrics:Y,createdAt:fe.createdAt||Rt.now(),updatedAt:Rt.now()}),await zs("metric",Y),zt("Body metrics saved!","success"),B(!1),await Tt()}catch(U){console.error("Error saving metrics:",U),zt("Failed to save. Please try again.","error")}p(!1)},Cs=(U,fe,Re)=>{ee(Te=>({...Te,[U]:{...Te[U],[fe]:Re===""?"":parseFloat(Re)}}))},ss=(U,fe)=>{te(Re=>({...Re,[U]:fe===""?"":parseFloat(fe)}))},sn=(U,fe,Re)=>{A(Te=>({...Te,[U]:{...Te[U],[fe]:Re===""?"":parseFloat(Re)}}))},Ms=async()=>{p(!0);try{const U=`targets_${vt.id}`,fe=tt?.benchmarks||{},Re={};wa.forEach(Te=>{const je=fe[Te.key];switch(Te.unit){case"time":T[Te.key]?.targetValue&&(Re[Te.key]={targetType:"time",targetValue:T[Te.key].targetValue,startValue:je?.time||0});break;case"reps":T[Te.key]?.targetReps&&(Re[Te.key]={targetType:"reps",targetReps:T[Te.key].targetReps,startReps:je?.reps||0});break;case"distance":T[Te.key]?.targetDistance&&(Re[Te.key]={targetType:"distance",targetDistance:T[Te.key].targetDistance,startDistance:je?.distance||0});break;default:(T[Te.key]?.targetWeight||T[Te.key]?.targetReps)&&(Re[Te.key]={targetWeight:T[Te.key].targetWeight||0,targetReps:T[Te.key].targetReps||0,startWeight:je?.weight||0,startReps:je?.reps||0})}}),await Is(Ke(pe,"juniorPBTargets",U),{clientId:vt.id,targets:Re,metricTargets:xe,updatedAt:Rt.now()}),Ce(Re),A(Re),zt("Targets saved!","success"),V(!1)}catch(U){console.error("Error saving targets:",U),zt("Failed to save targets.","error")}p(!1)},Os=(U,fe)=>{I(Re=>({...Re,[U]:{...Re[U],targetValue:fe===""?"":parseFloat(fe)}}))},ls=async()=>{p(!0);try{const U=`targets_${vt.id}`,fe={};zo.forEach(Re=>{if(z[Re.key]?.targetValue){const Te=tt?.bodyMetrics?.[Re.key]||0;fe[Re.key]={targetValue:z[Re.key].targetValue,startValue:Te}}}),await Is(Ke(pe,"juniorPBTargets",U),{clientId:vt.id,targets:we,metricTargets:fe,updatedAt:Rt.now()}),C(fe),I(fe),zt("Metric targets saved!","success"),M(!1)}catch(U){console.error("Error saving metric targets:",U),zt("Failed to save targets.","error")}p(!1)},ps=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const U=Ke(pe,"juniorPBTargets",`targets_${vt.id}`);await Tr(U),Ce({}),C({}),A({}),I({}),zt("All goals have been reset","success")}catch(U){console.error("Error resetting targets:",U),zt("Failed to reset goals","error")}p(!1)}},ye=(U,fe)=>{const Re=we[U];if(!Re||!fe)return null;if(Re.targetType==="time"){if(!Re.targetValue)return null;const ot=Re.startValue||0,Lt=Re.targetValue,It=fe.time||0,nn=Lt-ot;return nn<=0?It>=Lt?1:0:Math.max(0,Math.min((It-ot)/nn,1))}if(Re.targetType==="reps"){if(!Re.targetReps)return null;const ot=Re.startReps||0,Lt=Re.targetReps,It=fe.reps||0,nn=Lt-ot;return nn<=0?It>=Lt?1:0:Math.max(0,Math.min((It-ot)/nn,1))}if(Re.targetType==="distance"){if(!Re.targetDistance)return null;const ot=Re.startDistance||0,Lt=Re.targetDistance,It=fe.distance||0,nn=Lt-ot;return nn<=0?It>=Lt?1:0:Math.max(0,Math.min((It-ot)/nn,1))}if(!Re.targetWeight&&!Re.targetReps)return null;const Te=(Re.startWeight||0)*(Re.startReps||0),je=(Re.targetWeight||0)*(Re.targetReps||0),ht=(fe.weight||0)*(fe.reps||0),Et=je-Te;return Et<=0?ht>=je?1:0:Math.max(0,Math.min((ht-Te)/Et,1))},Se=U=>{const fe=xe[U];if(!fe||!fe.targetValue)return null;const Re=tt?.bodyMetrics?.[U];if(Re==null)return null;const Te=fe.startValue||0,je=fe.targetValue,ht=je-Te;return ht===0?Re===je?1:0:Math.max(0,Math.min((Re-Te)/ht,1))},Le=U=>{it.current=U.touches[0].clientX,ft.current=0},Qe=U=>{ft.current=U.touches[0].clientX-it.current},ze=()=>{ft.current<-50?Yt(g+1):ft.current>50&&Yt(g-1),ft.current=0},Xe=U=>{const fe=tt?.bodyMetrics?.[U],Re=Qt?.bodyMetrics?.[U];return fe==null||Re==null?null:parseFloat((fe-Re).toFixed(2))},dt=t.find(U=>U.month===re),Q=t.find(U=>U.month===Be);if(ie||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ts||!Pt||!vt)return null;const se=wa[g],He=tt?.benchmarks?.[se.key],gt=Qt?.benchmarks?.[se.key],Ye=zl(se,He),J=zl(se,gt),ke=eg(Ye,J),qe=ye(se.key,He),nt=qe!==null,lt=qe!==null&&qe>=1,St=nt?Math.round(qe*60):Ye>0?15:0,Xt=we[se.key],Bt=U=>U?U.targetType==="time"?`${U.startValue||0}s  ${U.targetValue}s`:U.targetType==="reps"?`${U.startReps||0}  ${U.targetReps} reps`:U.targetType==="distance"?`${U.startDistance||0}  ${U.targetDistance}cm`:`${U.startWeight||0}kg${U.startReps||0}  ${U.targetWeight}kg${U.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>_t("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Ne,onTouchStart:Le,onTouchMove:Qe,onTouchEnd:ze,children:[r.jsx("div",{className:`pb-ring-container slide-from-${et.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Zy.map((U,fe)=>{const Re=fe<Math.round(St);return r.jsx("line",{x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,className:`pb-ring-tick ${Re?lt?"hit":"filled":"empty"}`,strokeWidth:U.thick?"3":"2"},fe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:se.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[se.name,Ft("strength",se.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:He?fh(se,He):"-"}),ke!==null&&r.jsxs("div",{className:`pb-ring-change ${ke>=0?"positive":"negative"}`,children:[ke>=0?"+":"",ke.toFixed(1),"%"]}),ke===null&&He&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Xt&&r.jsx("div",{className:`pb-ring-target ${lt?"hit":""}`,children:lt?"Target hit!":Bt(Xt)}),!Xt&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:wa.map((U,fe)=>r.jsx("button",{className:`pb-dot ${fe===g?"active":""}`,onClick:()=>Yt(fe)},fe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Yt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Yt(g+1),disabled:g===wa.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(yP,{data:t,exerciseKey:se.key,unit:se.unit})]})]}),!x&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:tt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(we).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ps,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",_a(kt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ee(tt?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:wa.map(U=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),U.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:L[U.key]?.weight??"",onChange:fe=>Cs(U.key,"weight",fe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:L[U.key]?.reps??"",onChange:fe=>Cs(U.key,"reps",fe.target.value),placeholder:"0"})]})]}):U.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:L[U.key]?.reps??"",onChange:fe=>Cs(U.key,"reps",fe.target.value),placeholder:"0"})]})}):U.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:L[U.key]?.distance??"",onChange:fe=>Cs(U.key,"distance",fe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:L[U.key]?.time??"",onChange:fe=>Cs(U.key,"time",fe.target.value),placeholder:"0"})]})})]},U.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ee(tt?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:At,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),A(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),wa.map(U=>{const fe=tt?.benchmarks?.[U.key];let Re="-";if(fe)switch(U.unit){case"weight":(fe.weight||fe.reps)&&(Re=`${fe.weight||0}kg  ${fe.reps||0}`);break;case"time":fe.time&&(Re=`${fe.time}s`);break;case"reps":fe.reps&&(Re=`${fe.reps} reps`);break;case"distance":fe.distance&&(Re=`${fe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Re]})]}),U.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[U.key]?.targetWeight??"",onChange:Te=>sn(U.key,"targetWeight",Te.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[U.key]?.targetReps??"",onChange:Te=>sn(U.key,"targetReps",Te.target.value),placeholder:"0"})]})]}):U.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[U.key]?.targetReps??"",onChange:Te=>sn(U.key,"targetReps",Te.target.value),placeholder:"0"})]})}):U.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[U.key]?.targetDistance??"",onChange:Te=>sn(U.key,"targetDistance",Te.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[U.key]?.targetValue??"",onChange:Te=>sn(U.key,"targetValue",Te.target.value),placeholder:"0"})]})})]},U.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),A(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ms,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:_a(kt)}),r.jsx("div",{className:"pb-metrics-list",children:zo.map(U=>{const fe=tt?.bodyMetrics?.[U.key],Re=Xe(U.key),Te=xe[U.key],je=Se(U.key),ht=je!==null&&je>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[U.name,Ft("metric",U.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Te&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Te.targetValue," ",U.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:fe!=null?`${fe} ${U.suffix}`:"-"}),Re!==null&&r.jsxs("span",{className:`pb-metric-change ${Re>0?"up":Re<0?"down":"same"}`,children:[Re>0?"+":"",Re," ",U.suffix]})]})]}),je!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ht?"hit":""}`,style:{width:`${Math.round(je*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ht?"hit":""}`,children:ht?"Hit!":`${Math.round(je*100)}%`})]})]},U.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>B(!0),children:tt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(xe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(we).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ps,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",_a(kt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),te(tt?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:zo.map(U=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[U.name," (",U.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[U.key]??"",onChange:fe=>ss(U.key,fe.target.value),placeholder:"0"})]})},U.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),te(tt?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:is,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),I(xe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),zo.map(U=>{const fe=tt?.bodyMetrics?.[U.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",fe!=null?`${fe} ${U.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",U.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:z[U.key]?.targetValue??"",onChange:Re=>Os(U.key,Re.target.value),placeholder:"0"})]})})]},U.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),I(xe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ls,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[We.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((U,fe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${fe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:U.label}),r.jsx("span",{className:"pb-achievement-date",children:_a(U.achievedMonth)})]})]},fe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(Pe(t[0].month),De(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:U=>Pe(U.target.value),children:t.map(U=>r.jsx("option",{value:U.month,children:_a(U.month)},U.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Be,onChange:U=>De(U.target.value),children:t.map(U=>r.jsx("option",{value:U.month,children:_a(U.month)},U.month))})]})]}),dt&&Q&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:_a(re).split(" ")[0]}),r.jsx("span",{children:_a(Be).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),wa.map(U=>{const fe=dt.benchmarks?.[U.key],Re=Q.benchmarks?.[U.key],Te=zl(U,fe),je=zl(U,Re),ht=eg(je,Te);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:U.name}),r.jsx("span",{className:"pb-compare-val",children:fe?fh(U,fe):"-"}),r.jsx("span",{className:"pb-compare-val",children:Re?fh(U,Re):"-"}),r.jsx("span",{className:`pb-compare-change ${ht!==null?ht>=0?"positive":"negative":""}`,children:ht!==null?`${ht>=0?"+":""}${ht.toFixed(1)}%`:"-"})]},U.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:_a(re).split(" ")[0]}),r.jsx("span",{children:_a(Be).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),zo.map(U=>{const fe=dt.bodyMetrics?.[U.key],Re=Q.bodyMetrics?.[U.key],Te=fe!=null&&Re!=null?parseFloat((Re-fe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:U.name}),r.jsx("span",{className:"pb-compare-val",children:fe!=null?`${fe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Re!=null?`${Re}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Te!==null?Te>0?"positive":Te<0?"negative":"neutral":""}`,children:Te!==null?`${Te>0?"+":""}${Te} ${U.suffix}`:"-"})]},U.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((U,fe)=>{const Re=t.filter(Te=>Te.month<U.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${fe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:_a(U.month)}),U.benchmarks&&Object.keys(U.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),wa.map(Te=>{const je=U.benchmarks[Te.key];if(!je)return null;const ht=Re?.benchmarks?.[Te.key],Et=zl(Te,je),ot=zl(Te,ht),Lt=eg(Et,ot);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:fh(Te,je)}),Lt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Lt>=0?"positive":"negative"}`,children:[Lt>=0?"+":"",Lt.toFixed(1),"%"]})]})]},Te.key)})]}),U.bodyMetrics&&Object.keys(U.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),zo.map(Te=>{const je=U.bodyMetrics[Te.key];if(je==null)return null;const ht=Re?.bodyMetrics?.[Te.key],Et=ht!=null?parseFloat((je-ht).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[je," ",Te.suffix]}),Et!==null&&r.jsxs("span",{className:`pb-timeline-change ${Et>0?"positive":Et<0?"negative":"neutral"}`,children:[Et>0?"+":"",Et," ",Te.suffix]})]})]},Te.key)})]})]})]},U.id)})})]})})]}),q&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>me(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:q.length===1?"Target Achieved!":`${q.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:q.map((U,fe)=>r.jsx("div",{className:"pb-celebration-badge",children:U.label},fe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&r.jsxs("div",{className:`toast-notification ${Me.type}`,children:[r.jsx("span",{className:"toast-icon",children:Me.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Me.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ue(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>_t("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>_t("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>_t("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),vt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>_t("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Wk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Wk.filter(n=>n.storagePath!==null);const vP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Gk={};Wk.forEach(n=>{Gk[n.name]=n.group});function xP(n){return Gk[n]||null}const Va=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],qo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function wP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ka(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function ph(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function P2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function ql(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function _P({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(V=>{const L=V.benchmarks?.[e];return L?t==="time"?L.time||0:(L.weight||0)*(L.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,j=i.map((V,L)=>{const ee=y+L/(i.length-1)*x,Y=y+k-(V-u)/d*k;return{x:ee,y:Y,value:V}}),B=j.map((V,L)=>`${L===0?"M":"L"} ${V.x} ${V.y}`).join(" "),W=B+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradient)"}),r.jsx("path",{d:B,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((V,L)=>r.jsx("circle",{cx:V.x,cy:V.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((V,L)=>r.jsxs("span",{className:"pb-trend-label",children:[V.month.split("-")[1],"/",V.month.split("-")[0].slice(2)]},L))})]})}function kP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,k]=v.useState(!1),[j,B]=v.useState(!1),[W,V]=v.useState(!1),[L,ee]=v.useState({}),[Y,te]=v.useState({}),[we,Ce]=v.useState({}),[xe,C]=v.useState({}),[T,A]=v.useState({}),[O,M]=v.useState(!1),[z,I]=v.useState({}),[We,bt]=v.useState([]),[q,me]=v.useState(null),[Me,Ue]=v.useState(null),[X,P]=v.useState(!1),[re,Pe]=v.useState(""),[Be,De]=v.useState(""),[Ne,it]=v.useState({}),[ft,et]=v.useState({}),[Yt,Ts]=v.useState(null),[Pt,vt]=v.useState(null),[ie,Ct]=v.useState(""),[_t,zt]=v.useState({}),Tt=v.useRef(null),kt=v.useRef(0),tt=v.useRef(0),pt=v.useRef("right"),Qt=v.useCallback($=>{y(de=>{const ue=Math.max(0,Math.min(Va.length-1,$));return ue===de?de:(pt.current=ue>de?"right":"left",ue)})},[]),{currentUser:zs,isClient:Ft,clientData:At,loading:is}=zr(),{isDark:Cs}=Ia(),ss=dr(),[sn]=cS(),Ms=sn.get("mode")==="corebuddy",Os=!Ms&&(!At?.clientType||At.clientType==="block"),ls=v.useCallback(($,de="info")=>{Ue({message:$,type:de}),setTimeout(()=>Ue(null),4e3)},[]);v.useEffect(()=>{!is&&(!zs||!Ft)&&ss("/")},[zs,Ft,is,ss]),v.useEffect(()=>{At&&(Os?ps():(async()=>{try{const[de,ue,E]=await Promise.all([Ls(Ke(pe,"coreBuddyPBs",At.id)),Ls(Ke(pe,"coreBuddyTargets",At.id)),Ls(Ke(pe,"coreBuddyAchievements",At.id))]);de.exists()&&it(de.data().exercises||{}),ue.exists()&&et(ue.data().targets||{}),E.exists()&&Ts(E.data())}catch(de){console.error("Error loading Core Buddy PBs:",de)}u(!1)})())},[At]);const ps=async()=>{try{const $=Fs(Ht(pe,"personalBests"),bs("clientId","==",At.id)),ue=(await As($)).docs.map($e=>({id:$e.id,...$e.data()}));ue.sort(($e,Ge)=>$e.month.localeCompare(Ge.month)),i(ue);const E=Fs(Ht(pe,"personalBestTargets"),bs("clientId","==",At.id)),D=await As(E);if(!D.empty){const $e=D.docs[0].data();Ce($e.targets||{}),C($e.metricTargets||{}),A($e.targets||{}),I($e.metricTargets||{})}const ne=Fs(Ht(pe,"achievements"),bs("clientId","==",At.id)),ae=await As(ne);ae.empty||bt(ae.docs[0].data().badges||[])}catch($){console.error("Error fetching personal bests:",$)}u(!1)},ye=async()=>{if(!Pt||!ie||!At)return;const $=parseFloat(ie),de=Ne[Pt];if(!de||$<=de.weight){ls("Target must be higher than current PB","error");return}p(!0);try{const ue={...ft,[Pt]:{targetWeight:$,setAt:Rt.now(),currentPBWhenSet:de.weight}};await Is(Ke(pe,"coreBuddyTargets",At.id),{clientId:At.id,targets:ue,updatedAt:Rt.now()}),et(ue),vt(null),Ct(""),ls("Target set!","success")}catch(ue){console.error("Error saving target:",ue),ls("Failed to save target","error")}p(!1)},Se=$=>{if(!Yt?.badges)return!1;const de=ft[$];return de?Yt.badges.some(ue=>ue.type==="pb_target"&&ue.exercise===$&&ue.targetWeight===de.targetWeight):!1},Le=$=>{const de=ft[$];if(!de)return null;const ue=Ne[$];if(!ue)return 0;const E=de.currentPBWhenSet||0,D=de.targetWeight,ne=D-E;return ne<=0?ue.weight>=D?1:0:Math.max(0,Math.min((ue.weight-E)/ne,1))},Qe=wP(),ze=t.find($=>$.month===Qe),Xe=t.filter($=>$.month<Qe),dt=Xe.length>0?Xe[Xe.length-1]:null;v.useEffect(()=>{ze?(ee(ze.benchmarks||{}),te(ze.bodyMetrics||{})):(ee({}),te({}))},[ze?.id]);const Q=async($,de)=>{const ue=[];if($==="strength"?Va.forEach(E=>{const D=we[E.key];if(!D)return;const ne=de[E.key];if(!ne)return;let ae;if(D.targetType==="time"){if(!D.targetValue)return;const $e=D.startValue||0,Ge=ne.time||0,Je=D.targetValue-$e;ae=Je===0?Ge>=D.targetValue?1:0:Math.max(0,(Ge-$e)/Je)}else{if(!D.targetWeight&&!D.targetReps)return;const $e=(D.startWeight||0)*(D.startReps||0),Ge=(D.targetWeight||0)*(D.targetReps||0),Je=(ne.weight||0)*(ne.reps||0),Vt=Ge-$e;ae=Vt===0?Je>=Ge?1:0:Math.max(0,(Je-$e)/Vt)}if(ae>=1&&!(D.targetType==="time"?We.some(Ge=>Ge.type==="strength"&&Ge.key===E.key&&Ge.targetValue===D.targetValue):We.some(Ge=>Ge.type==="strength"&&Ge.key===E.key&&Ge.targetWeight===D.targetWeight&&Ge.targetReps===D.targetReps))){const Ge=D.targetType==="time"?`${E.name} ${D.targetValue}s`:`${E.name} ${D.targetWeight}kg  ${D.targetReps}`;ue.push({type:"strength",key:E.key,...D.targetType==="time"?{targetType:"time",targetValue:D.targetValue}:{targetWeight:D.targetWeight,targetReps:D.targetReps},achievedMonth:Qe,label:Ge})}}):qo.forEach(E=>{const D=xe[E.key];if(!D||!D.targetValue)return;const ne=de[E.key];if(ne==null)return;const ae=D.startValue||0,$e=D.targetValue,Ge=$e-ae;(Ge===0?ne===$e?1:0:Math.max(0,(ne-ae)/Ge))>=1&&(We.some(xt=>xt.type==="metric"&&xt.key===E.key&&xt.targetValue===$e)||ue.push({type:"metric",key:E.key,targetValue:$e,achievedMonth:Qe,label:`${E.name} ${$e}${E.suffix}`}))}),ue.length>0){const E=[...We,...ue];await Is(Ke(pe,"achievements",At.id),{clientId:At.id,badges:E,updatedAt:Rt.now()}),bt(E),me(ue),setTimeout(()=>me(null),5e3)}},se=($,de)=>{if($==="strength"){const ue=we[de];return ue?ue.targetType==="time"?We.some(E=>E.type==="strength"&&E.key===de&&E.targetValue===ue.targetValue):!ue.targetWeight&&!ue.targetReps?!1:We.some(E=>E.type==="strength"&&E.key===de&&E.targetWeight===ue.targetWeight&&E.targetReps===ue.targetReps):!1}else{const ue=xe[de];return!ue||!ue.targetValue?!1:We.some(E=>E.type==="metric"&&E.key===de&&E.targetValue===ue.targetValue)}},He=async()=>{p(!0);try{const $=`${At.id}_${Qe}`,de=ze||{};await Is(Ke(pe,"personalBests",$),{clientId:At.id,month:Qe,benchmarks:L,bodyMetrics:de.bodyMetrics||Y||{},createdAt:de.createdAt||Rt.now(),updatedAt:Rt.now()}),await Q("strength",L),ls("Benchmarks saved!","success"),k(!1),await ps()}catch($){console.error("Error saving benchmarks:",$),ls("Failed to save. Please try again.","error")}p(!1)},gt=async()=>{p(!0);try{const $=`${At.id}_${Qe}`,de=ze||{};await Is(Ke(pe,"personalBests",$),{clientId:At.id,month:Qe,benchmarks:de.benchmarks||L||{},bodyMetrics:Y,createdAt:de.createdAt||Rt.now(),updatedAt:Rt.now()}),await Q("metric",Y),ls("Body metrics saved!","success"),B(!1),await ps()}catch($){console.error("Error saving metrics:",$),ls("Failed to save. Please try again.","error")}p(!1)},Ye=($,de,ue)=>{ee(E=>({...E,[$]:{...E[$],[de]:ue===""?"":parseFloat(ue)}}))},J=($,de)=>{te(ue=>({...ue,[$]:de===""?"":parseFloat(de)}))},ke=($,de,ue)=>{A(E=>({...E,[$]:{...E[$],[de]:ue===""?"":parseFloat(ue)}}))},qe=async()=>{p(!0);try{const $=`targets_${At.id}`,de=ze?.benchmarks||{},ue={};Va.forEach(E=>{const D=de[E.key];E.unit==="time"?T[E.key]?.targetValue&&(ue[E.key]={targetType:"time",targetValue:T[E.key].targetValue,startValue:D?.time||0}):(T[E.key]?.targetWeight||T[E.key]?.targetReps)&&(ue[E.key]={targetWeight:T[E.key].targetWeight||0,targetReps:T[E.key].targetReps||0,startWeight:D?.weight||0,startReps:D?.reps||0})}),await Is(Ke(pe,"personalBestTargets",$),{clientId:At.id,targets:ue,metricTargets:xe,updatedAt:Rt.now()}),Ce(ue),A(ue),ls("Targets saved!","success"),V(!1)}catch($){console.error("Error saving targets:",$),ls("Failed to save targets.","error")}p(!1)},nt=($,de)=>{I(ue=>({...ue,[$]:{...ue[$],targetValue:de===""?"":parseFloat(de)}}))},lt=async()=>{p(!0);try{const $=`targets_${At.id}`,de={};qo.forEach(ue=>{if(z[ue.key]?.targetValue){const E=ze?.bodyMetrics?.[ue.key]||0;de[ue.key]={targetValue:z[ue.key].targetValue,startValue:E}}}),await Is(Ke(pe,"personalBestTargets",$),{clientId:At.id,targets:we,metricTargets:de,updatedAt:Rt.now()}),C(de),I(de),ls("Metric targets saved!","success"),M(!1)}catch($){console.error("Error saving metric targets:",$),ls("Failed to save targets.","error")}p(!1)},St=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const $=Ke(pe,"personalBestTargets",`targets_${At.id}`);await Tr($),Ce({}),C({}),A({}),I({}),ls("All goals have been reset","success")}catch($){console.error("Error resetting targets:",$),ls("Failed to reset goals","error")}p(!1)}},Xt=($,de)=>{const ue=we[$];if(!ue||!de)return null;if(ue.targetType==="time"){if(!ue.targetValue)return null;const $e=ue.startValue||0,Ge=ue.targetValue,Je=de.time||0,Vt=Ge-$e;return Vt<=0?Je>=Ge?1:0:Math.max(0,Math.min((Je-$e)/Vt,1))}if(!ue.targetWeight&&!ue.targetReps)return null;const E=(ue.startWeight||0)*(ue.startReps||0),D=(ue.targetWeight||0)*(ue.targetReps||0),ne=(de.weight||0)*(de.reps||0),ae=D-E;return ae<=0?ne>=D?1:0:Math.max(0,Math.min((ne-E)/ae,1))},Bt=$=>{const de=xe[$];if(!de||!de.targetValue)return null;const ue=ze?.bodyMetrics?.[$];if(ue==null)return null;const E=de.startValue||0,D=de.targetValue,ne=D-E;return ne===0?ue===D?1:0:Math.max(0,Math.min((ue-E)/ne,1))},U=$=>{kt.current=$.touches[0].clientX,tt.current=0},fe=$=>{tt.current=$.touches[0].clientX-kt.current},Re=()=>{tt.current<-50?Qt(g+1):tt.current>50&&Qt(g-1),tt.current=0},Te=$=>{const de=ze?.bodyMetrics?.[$],ue=dt?.bodyMetrics?.[$];return de==null||ue==null?null:parseFloat((de-ue).toFixed(2))},je=t.find($=>$.month===re),ht=t.find($=>$.month===Be);if(is||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!zs||!Ft||!At)return null;if(Os&&At?.isJunior)return r.jsx(bP,{});const Et=Va[g],ot=ze?.benchmarks?.[Et.key],Lt=dt?.benchmarks?.[Et.key],It=ql(Et,ot),nn=ql(Et,Lt),hn=tg(It,nn),mn=Xt(Et.key,ot),rn=mn!==null,xn=mn!==null&&mn>=1,ln=rn?Math.round(mn*60):It>0?15:0,ms=we[Et.key];return r.jsx(Ca,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>ss(Ms?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Os?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Os&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Ne).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const $={},de=[];return Object.entries(Ne).forEach(([ue,E])=>{const D=xP(ue);D?($[D]||($[D]=[]),$[D].push([ue,E])):de.push([ue,E])}),Object.values($).forEach(ue=>ue.sort(([E],[D])=>E.localeCompare(D))),de.sort(([ue],[E])=>ue.localeCompare(E)),r.jsxs(r.Fragment,{children:[vP.map(ue=>{const E=$[ue.key];if(!E||E.length===0)return null;const D=!!_t[ue.key],ne=E.reduce((ae,[,$e])=>!ae||$e.weight>ae.weight?$e:ae,null);return r.jsxs("div",{className:`pb-cb-group ${D?"open":""}`,style:{"--group-color":ue.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>zt(ae=>({...ae,[ue.key]:!ae[ue.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ue.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:ue.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:ue.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[E.length," PB",E.length!==1?"s":""]}),ne&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",ne.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${D?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:D?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:E.map(([ae,$e],Ge)=>{const Je=ft[ae],Vt=Le(ae),xt=Vt!==null&&Vt>=1,qt=Se(ae),vs=Vt!==null?Math.round(Vt*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":ue.color,animationDelay:`${Ge*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((yn,wr)=>{const fs=wr<vs;return r.jsx("line",{x1:yn.x1,y1:yn.y1,x2:yn.x2,y2:yn.y2,className:`pb-ring-tick ${fs?xt?"hit":"filled":"empty"}`,style:fs&&!xt?{stroke:ue.color}:void 0,strokeWidth:yn.thick?"2":"1.5"},wr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:ue.color},children:qt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ue.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ae}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:ue.color},children:[$e.weight,"kg  ",$e.reps]}),$e.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:($e.achievedAt.toDate?$e.achievedAt.toDate():new Date($e.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Je&&xt&&!qt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),qt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:ue.color,background:`color-mix(in srgb, ${ue.color} 10%, transparent)`,color:ue.color},onClick:()=>{vt(ae),Ct("")},children:Je?xt&&qt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Je&&!xt&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[$e.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:ue.color},children:["Target: ",Je.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Vt||0)*100)}%`,background:ue.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:ue.color},children:[Math.round((Vt||0)*100),"%"]})]}),Je&&xt&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ae)})})})]},ue.key)}),de.length>0&&(()=>{const ue=!!_t.other;return r.jsxs("div",{className:`pb-cb-group ${ue?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>zt(E=>({...E,other:!E.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[de.length," PB",de.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${ue?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ue?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:de.map(([E,D],ne)=>{const ae=ft[E],$e=Le(E),Ge=$e!==null&&$e>=1,Je=Se(E),Vt=$e!==null?Math.round($e*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${ne*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((xt,qt)=>{const vs=qt<Vt;return r.jsx("line",{x1:xt.x1,y1:xt.y1,x2:xt.x2,y2:xt.y2,className:`pb-ring-tick ${vs?Ge?"hit":"filled":"empty"}`,strokeWidth:xt.thick?"2":"1.5"},qt)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:Je?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:E}),r.jsxs("div",{className:"pb-cb-card-value",children:[D.weight,"kg  ",D.reps]}),D.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(D.achievedAt.toDate?D.achievedAt.toDate():new Date(D.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ae&&Ge&&!Je&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Je&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{vt(E),Ct("")},children:ae?Ge&&Je?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ae&&!Ge&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[D.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ae.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round(($e||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round(($e||0)*100),"%"]})]}),ae&&Ge&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},E)})})})]})})()]})})()}),Object.keys(Ne).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>ss("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Pt&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>vt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:$=>$.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:Pt}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Ne[Pt]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ie,onChange:$=>Ct($.target.value),placeholder:String((Ne[Pt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>vt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ye,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Os&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Tt,onTouchStart:U,onTouchMove:fe,onTouchEnd:Re,children:[r.jsx("div",{className:`pb-ring-container slide-from-${pt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Zy.map(($,de)=>{const ue=de<Math.round(ln);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:`pb-ring-tick ${ue?xn?"hit":"filled":"empty"}`,strokeWidth:$.thick?"3":"2"},de)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:Et.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[Et.name,se("strength",Et.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:ot?Et.unit==="time"?ph(ot.time):P2(ot.weight,ot.reps):"-"}),hn!==null&&r.jsxs("div",{className:`pb-ring-change ${hn>=0?"positive":"negative"}`,children:[hn>=0?"+":"",hn.toFixed(1),"%"]}),hn===null&&ot&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ms&&r.jsx("div",{className:`pb-ring-target ${xn?"hit":""}`,children:xn?"Target hit!":ms.targetType==="time"?`${ms.startValue||0}s  ${ms.targetValue}s`:`${ms.startWeight||0}kg${ms.startReps||0}  ${ms.targetWeight}kg${ms.targetReps}`}),!ms&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Va.map(($,de)=>r.jsx("button",{className:`pb-dot ${de===g?"active":""}`,onClick:()=>Qt(de)},de))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Qt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Qt(g+1),disabled:g===Va.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(_P,{data:t,exerciseKey:Et.key,unit:Et.unit})]})]}),!x&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:ze?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(we).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:St,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ka(Qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ee(ze?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Va.map($=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:L[$.key]?.weight??"",onChange:de=>Ye($.key,"weight",de.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:L[$.key]?.reps??"",onChange:de=>Ye($.key,"reps",de.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:L[$.key]?.time??"",onChange:de=>Ye($.key,"time",de.target.value),placeholder:"0"})]})})]},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ee(ze?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:He,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),A(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Va.map($=>{const de=ze?.benchmarks?.[$.key];let ue="-";return de&&($.unit==="time"&&de.time?ue=`${de.time}s`:(de.weight||de.reps)&&(ue=`${de.weight||0}kg  ${de.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ue]})]}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[$.key]?.targetWeight??"",onChange:E=>ke($.key,"targetWeight",E.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[$.key]?.targetReps??"",onChange:E=>ke($.key,"targetReps",E.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[$.key]?.targetValue??"",onChange:E=>ke($.key,"targetValue",E.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),A(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:qe,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ka(Qe)}),r.jsx("div",{className:"pb-metrics-list",children:qo.map($=>{const de=ze?.bodyMetrics?.[$.key],ue=Te($.key),E=xe[$.key],D=Bt($.key),ne=D!==null&&D>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[$.name,se("metric",$.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),E&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",E.targetValue," ",$.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:de!=null?`${de} ${$.suffix}`:"-"}),ue!==null&&r.jsxs("span",{className:`pb-metric-change ${ue>0?"up":ue<0?"down":"same"}`,children:[ue>0?"+":"",ue," ",$.suffix]})]})]}),D!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ne?"hit":""}`,style:{width:`${Math.round(D*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ne?"hit":""}`,children:ne?"Hit!":`${Math.round(D*100)}%`})]})]},$.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>B(!0),children:ze?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>M(!0),children:Object.keys(xe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(we).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:St,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ka(Qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),te(ze?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:qo.map($=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[$.name," (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[$.key]??"",onChange:de=>J($.key,de.target.value),placeholder:"0"})]})},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),te(ze?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:gt,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),I(xe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),qo.map($=>{const de=ze?.bodyMetrics?.[$.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",de!=null?`${de} ${$.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:z[$.key]?.targetValue??"",onChange:ue=>nt($.key,ue.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),I(xe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:lt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[We.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map(($,de)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${de*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:$.label}),r.jsx("span",{className:"pb-achievement-date",children:ka($.achievedMonth)})]})]},de))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(Pe(t[0].month),De(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:$=>Pe($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:ka($.month)},$.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Be,onChange:$=>De($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:ka($.month)},$.month))})]})]}),je&&ht&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ka(re).split(" ")[0]}),r.jsx("span",{children:ka(Be).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Va.map($=>{const de=je.benchmarks?.[$.key],ue=ht.benchmarks?.[$.key],E=ql($,de),D=ql($,ue),ne=tg(D,E);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:de?$.unit==="time"?ph(de.time):`${de.weight}x${de.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ue?$.unit==="time"?ph(ue.time):`${ue.weight}x${ue.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${ne!==null?ne>=0?"positive":"negative":""}`,children:ne!==null?`${ne>=0?"+":""}${ne.toFixed(1)}%`:"-"})]},$.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ka(re).split(" ")[0]}),r.jsx("span",{children:ka(Be).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),qo.map($=>{const de=je.bodyMetrics?.[$.key],ue=ht.bodyMetrics?.[$.key],E=de!=null&&ue!=null?parseFloat((ue-de).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:de!=null?`${de}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ue!=null?`${ue}`:"-"}),r.jsx("span",{className:`pb-compare-change ${E!==null?E>0?"positive":E<0?"negative":"neutral":""}`,children:E!==null?`${E>0?"+":""}${E} ${$.suffix}`:"-"})]},$.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map(($,de)=>{const ue=t.find(E=>E.month<$.month&&t.indexOf(E)===t.indexOf($)-1)||t.filter(E=>E.month<$.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${de*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ka($.month)}),$.benchmarks&&Object.keys($.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Va.map(E=>{const D=$.benchmarks[E.key];if(!D)return null;const ne=ue?.benchmarks?.[E.key],ae=ql(E,D),$e=ql(E,ne),Ge=tg(ae,$e);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:E.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:E.unit==="time"?ph(D.time):P2(D.weight,D.reps)}),Ge!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ge>=0?"positive":"negative"}`,children:[Ge>=0?"+":"",Ge.toFixed(1),"%"]})]})]},E.key)})]}),$.bodyMetrics&&Object.keys($.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),qo.map(E=>{const D=$.bodyMetrics[E.key];if(D==null)return null;const ne=ue?.bodyMetrics?.[E.key],ae=ne!=null?parseFloat((D-ne).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:E.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[D," ",E.suffix]}),ae!==null&&r.jsxs("span",{className:`pb-timeline-change ${ae>0?"positive":ae<0?"negative":"neutral"}`,children:[ae>0?"+":"",ae," ",E.suffix]})]})]},E.key)})]})]})]},$.id)})})]})})]})]}),q&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>me(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:q.length===1?"Target Achieved!":`${q.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:q.map(($,de)=>r.jsx("div",{className:"pb-celebration-badge",children:$.label},de))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&r.jsxs("div",{className:`toast-notification ${Me.type}`,children:[r.jsx("span",{className:"toast-icon",children:Me.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Me.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ue(null),children:""})]}),Os&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>ss("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>ss("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>ss("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),At?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>ss("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Ms&&r.jsx(fa,{active:"progress"})]})})}const jP=v.lazy(()=>Cr(()=>import("./Dashboard--1eBSnU9.js"),__vite__mapDeps([0,1,2]))),TP=v.lazy(()=>Cr(()=>import("./AddClient-sxpbjvlw.js"),__vite__mapDeps([3,4]))),EP=v.lazy(()=>Cr(()=>import("./ClientDashboard-YNpyW40b.js"),__vite__mapDeps([5,1]))),SP=v.lazy(()=>Cr(()=>import("./ClientForms-BM39Da_t.js"),__vite__mapDeps([6,7]))),NP=v.lazy(()=>Cr(()=>import("./ClientTools-Hwo9J3X2.js"),__vite__mapDeps([8,9]))),CP=v.lazy(()=>Cr(()=>import("./MacroCalculator-BHUTkPPi.js"),__vite__mapDeps([10,9]))),RP=v.lazy(()=>Cr(()=>import("./ProteinSnacks-BKGA_Sy7.js"),__vite__mapDeps([11,9]))),AP=v.lazy(()=>Cr(()=>import("./DailyMotivation-DKUOvT1M.js"),__vite__mapDeps([12,9]))),IP=v.lazy(()=>Cr(()=>import("./CircuitDashboard-uxrDo-_g.js"),__vite__mapDeps([13,14]))),MP=v.lazy(()=>Cr(()=>import("./CircuitBooking-CfRWy1XP.js"),__vite__mapDeps([15,16,14]))),DP=v.lazy(()=>Cr(()=>import("./Leaderboard-BxItv3mI.js"),__vite__mapDeps([17,18]))),PP=v.lazy(()=>Cr(()=>import("./UpgradePage-DbHmhBUG.js"),__vite__mapDeps([19,20]))),LP=v.lazy(()=>Cr(()=>import("./SignUp-C-K8CumY.js"),[])),OP=v.lazy(()=>Cr(()=>import("./Onboarding-DV7FLw_2.js"),__vite__mapDeps([21,22])));function BP({children:n}){const{pathname:e}=Aa();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function VP(){const n=dr();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function UP(){return r.jsx(Q3,{children:r.jsx(Y3,{children:r.jsx(tD,{children:r.jsxs(rS,{basename:"/login",children:[r.jsx(VP,{}),r.jsx(BP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(ME,{children:[r.jsx(tn,{path:"/",element:r.jsx(rD,{})}),r.jsx(tn,{path:"/dashboard",element:r.jsx(jP,{})}),r.jsx(tn,{path:"/add-client",element:r.jsx(TP,{})}),r.jsx(tn,{path:"/client",element:r.jsx(EP,{})}),r.jsx(tn,{path:"/client/forms",element:r.jsx(SP,{})}),r.jsx(tn,{path:"/client/tools",element:r.jsx(NP,{})}),r.jsx(tn,{path:"/client/tools/macros",element:r.jsx(CP,{})}),r.jsx(tn,{path:"/client/tools/snacks",element:r.jsx(RP,{})}),r.jsx(tn,{path:"/client/tools/motivation",element:r.jsx(AP,{})}),r.jsx(tn,{path:"/client/personal-bests",element:r.jsx(kP,{})}),r.jsx(tn,{path:"/client/circuit",element:r.jsx(IP,{})}),r.jsx(tn,{path:"/client/circuit/booking",element:r.jsx(MP,{})}),r.jsx(tn,{path:"/client/core-buddy",element:r.jsx(ED,{})}),r.jsx(tn,{path:"/client/core-buddy/nutrition",element:r.jsx(Bl,{feature:"nutrition",children:r.jsx(CD,{})})}),r.jsx(tn,{path:"/client/core-buddy/workouts",element:r.jsx(qD,{})}),r.jsx(tn,{path:"/client/core-buddy/programmes",element:r.jsx(Bl,{feature:"programmes",children:r.jsx(KD,{})})}),r.jsx(tn,{path:"/client/core-buddy/achievements",element:r.jsx(Bl,{feature:"achievements",children:r.jsx(eP,{})})}),r.jsx(tn,{path:"/client/core-buddy/consistency",element:r.jsx(Bl,{feature:"consistency",children:r.jsx(oP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddies",element:r.jsx(Bl,{feature:"buddies",children:r.jsx(lP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddy",element:r.jsx(mP,{})}),r.jsx(tn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(hP,{})}),r.jsx(tn,{path:"/client/leaderboard",element:r.jsx(Bl,{feature:"leaderboard",children:r.jsx(DP,{})})}),r.jsx(tn,{path:"/signup",element:r.jsx(LP,{})}),r.jsx(tn,{path:"/onboarding",element:r.jsx(OP,{})}),r.jsx(tn,{path:"/upgrade",element:r.jsx(PP,{})}),r.jsx(tn,{path:"*",element:r.jsx(Y2,{to:"/",replace:!0})})]})})})]})})})})}MT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(UP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{vr as A,fa as C,Ca as P,Rt as T,ha as a,Tr as b,Ht as c,pe as d,Ke as e,QC as f,As as g,t4 as h,Is as i,r as j,Ls as k,zr as l,Ia as m,dr as n,Yh as o,Zy as p,Fs as q,v as r,qP as s,pc as t,ja as u,nD as v,bs as w,sD as x,FP as y,cS as z};
