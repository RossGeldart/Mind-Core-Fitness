const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CJRAfT5W.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-CiteS8CF.css","assets/AddClient-BCLqqoLO.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-BOQf86iB.js","assets/ClientDashboard-CSizO3dZ.css","assets/ClientForms-Bsv41HYl.js","assets/ClientForms-QNtUjQJR.css","assets/ClientTools-CEKwz9dW.js","assets/ClientTools-Bezn5TAX.css","assets/MacroCalculator-BNXVFpab.js","assets/ProteinSnacks-BEkUQl9w.js","assets/DailyMotivation-DoWN_xLN.js","assets/CircuitDashboard-Be0OWpSk.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-7AIordHO.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-zZZ3oIJK.js","assets/PersonalBests-C2b_TGFz.css","assets/Leaderboard-BI5ZDAd5.js","assets/Leaderboard-Bul59-ui.css","assets/UpgradePage-DLW9N_ce.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-COYPjotf.css","assets/Onboarding-DCbgIRL3.js","assets/Onboarding-Cu4GeezY.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var jg={exports:{}},Kc={};var Fb;function TT(){if(Fb)return Kc;Fb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var g in l)g!=="key"&&(u[g]=l[g])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Kc.Fragment=e,Kc.jsx=t,Kc.jsxs=t,Kc}var Hb;function ST(){return Hb||(Hb=1,jg.exports=TT()),jg.exports}var a=ST(),Eg={exports:{}},Lt={};var qb;function CT(){if(qb)return Lt;qb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),T=Symbol.iterator;function I(V){return V===null||typeof V!="object"?null:(V=T&&V[T]||V["@@iterator"],typeof V=="function"?V:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,B={};function Y(V,ce,je){this.props=V,this.context=ce,this.refs=B,this.updater=je||H}Y.prototype.isReactComponent={},Y.prototype.setState=function(V,ce){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ce,"setState")},Y.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function te(){}te.prototype=Y.prototype;function Q(V,ce,je){this.props=V,this.context=ce,this.refs=B,this.updater=je||H}var pe=Q.prototype=new te;pe.constructor=Q,K(pe,Y.prototype),pe.isPureReactComponent=!0;var we=Array.isArray;function ye(){}var M={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function L(V,ce,je){var Se=je.ref;return{$$typeof:s,type:V,key:ce,ref:Se!==void 0?Se:null,props:je}}function U(V,ce){return L(V.type,ce,V.props)}function P(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function D(V){var ce={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(je){return ce[je]})}var A=/\/+/g;function Pe(V,ce){return typeof V=="object"&&V!==null&&V.key!=null?D(""+V.key):ce.toString(36)}function st(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ye,ye):(V.status="pending",V.then(function(ce){V.status==="pending"&&(V.status="fulfilled",V.value=ce)},function(ce){V.status==="pending"&&(V.status="rejected",V.reason=ce)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,ce,je,Se,ke){var Ve=typeof V;(Ve==="undefined"||Ve==="boolean")&&(V=null);var He=!1;if(V===null)He=!0;else switch(Ve){case"bigint":case"string":case"number":He=!0;break;case"object":switch(V.$$typeof){case s:case e:He=!0;break;case b:return He=V._init,Z(He(V._payload),ce,je,Se,ke)}}if(He)return ke=ke(V),He=Se===""?"."+Pe(V,0):Se,we(ke)?(je="",He!=null&&(je=He.replace(A,"$&/")+"/"),Z(ke,ce,je,"",function($t){return $t})):ke!=null&&(P(ke)&&(ke=U(ke,je+(ke.key==null||V&&V.key===ke.key?"":(""+ke.key).replace(A,"$&/")+"/")+He)),ce.push(ke)),1;He=0;var Qe=Se===""?".":Se+":";if(we(V))for(var Je=0;Je<V.length;Je++)Se=V[Je],Ve=Qe+Pe(Se,Je),He+=Z(Se,ce,je,Ve,ke);else if(Je=I(V),typeof Je=="function")for(V=Je.call(V),Je=0;!(Se=V.next()).done;)Se=Se.value,Ve=Qe+Pe(Se,Je++),He+=Z(Se,ce,je,Ve,ke);else if(Ve==="object"){if(typeof V.then=="function")return Z(st(V),ce,je,Se,ke);throw ce=String(V),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return He}function Te(V,ce,je){if(V==null)return V;var Se=[],ke=0;return Z(V,Se,"","",function(Ve){return ce.call(je,Ve,ke++)}),Se}function qe(V){if(V._status===-1){var ce=V._result;ce=ce(),ce.then(function(je){(V._status===0||V._status===-1)&&(V._status=1,V._result=je)},function(je){(V._status===0||V._status===-1)&&(V._status=2,V._result=je)}),V._status===-1&&(V._status=0,V._result=ce)}if(V._status===1)return V._result.default;throw V._result}var Ne=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},We={map:Te,forEach:function(V,ce,je){Te(V,function(){ce.apply(this,arguments)},je)},count:function(V){var ce=0;return Te(V,function(){ce++}),ce},toArray:function(V){return Te(V,function(ce){return ce})||[]},only:function(V){if(!P(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Lt.Activity=k,Lt.Children=We,Lt.Component=Y,Lt.Fragment=t,Lt.Profiler=l,Lt.PureComponent=Q,Lt.StrictMode=i,Lt.Suspense=y,Lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Lt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return M.H.useMemoCache(V)}},Lt.cache=function(V){return function(){return V.apply(null,arguments)}},Lt.cacheSignal=function(){return null},Lt.cloneElement=function(V,ce,je){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Se=K({},V.props),ke=V.key;if(ce!=null)for(Ve in ce.key!==void 0&&(ke=""+ce.key),ce)!E.call(ce,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&ce.ref===void 0||(Se[Ve]=ce[Ve]);var Ve=arguments.length-2;if(Ve===1)Se.children=je;else if(1<Ve){for(var He=Array(Ve),Qe=0;Qe<Ve;Qe++)He[Qe]=arguments[Qe+2];Se.children=He}return L(V.type,ke,Se)},Lt.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:u,_context:V},V},Lt.createElement=function(V,ce,je){var Se,ke={},Ve=null;if(ce!=null)for(Se in ce.key!==void 0&&(Ve=""+ce.key),ce)E.call(ce,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(ke[Se]=ce[Se]);var He=arguments.length-2;if(He===1)ke.children=je;else if(1<He){for(var Qe=Array(He),Je=0;Je<He;Je++)Qe[Je]=arguments[Je+2];ke.children=Qe}if(V&&V.defaultProps)for(Se in He=V.defaultProps,He)ke[Se]===void 0&&(ke[Se]=He[Se]);return L(V,Ve,ke)},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(V){return{$$typeof:g,render:V}},Lt.isValidElement=P,Lt.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:qe}},Lt.memo=function(V,ce){return{$$typeof:p,type:V,compare:ce===void 0?null:ce}},Lt.startTransition=function(V){var ce=M.T,je={};M.T=je;try{var Se=V(),ke=M.S;ke!==null&&ke(je,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(ye,Ne)}catch(Ve){Ne(Ve)}finally{ce!==null&&je.types!==null&&(ce.types=je.types),M.T=ce}},Lt.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Lt.use=function(V){return M.H.use(V)},Lt.useActionState=function(V,ce,je){return M.H.useActionState(V,ce,je)},Lt.useCallback=function(V,ce){return M.H.useCallback(V,ce)},Lt.useContext=function(V){return M.H.useContext(V)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(V,ce){return M.H.useDeferredValue(V,ce)},Lt.useEffect=function(V,ce){return M.H.useEffect(V,ce)},Lt.useEffectEvent=function(V){return M.H.useEffectEvent(V)},Lt.useId=function(){return M.H.useId()},Lt.useImperativeHandle=function(V,ce,je){return M.H.useImperativeHandle(V,ce,je)},Lt.useInsertionEffect=function(V,ce){return M.H.useInsertionEffect(V,ce)},Lt.useLayoutEffect=function(V,ce){return M.H.useLayoutEffect(V,ce)},Lt.useMemo=function(V,ce){return M.H.useMemo(V,ce)},Lt.useOptimistic=function(V,ce){return M.H.useOptimistic(V,ce)},Lt.useReducer=function(V,ce,je){return M.H.useReducer(V,ce,je)},Lt.useRef=function(V){return M.H.useRef(V)},Lt.useState=function(V){return M.H.useState(V)},Lt.useSyncExternalStore=function(V,ce,je){return M.H.useSyncExternalStore(V,ce,je)},Lt.useTransition=function(){return M.H.useTransition()},Lt.version="19.2.4",Lt}var $b;function Qp(){return $b||($b=1,Eg.exports=CT()),Eg.exports}var w=Qp(),Tg={exports:{}},Yc={},Sg={exports:{}},Cg={};var Wb;function NT(){return Wb||(Wb=1,(function(s){function e(Z,Te){var qe=Z.length;Z.push(Te);e:for(;0<qe;){var Ne=qe-1>>>1,We=Z[Ne];if(0<l(We,Te))Z[Ne]=Te,Z[qe]=We,qe=Ne;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var Te=Z[0],qe=Z.pop();if(qe!==Te){Z[0]=qe;e:for(var Ne=0,We=Z.length,V=We>>>1;Ne<V;){var ce=2*(Ne+1)-1,je=Z[ce],Se=ce+1,ke=Z[Se];if(0>l(je,qe))Se<We&&0>l(ke,je)?(Z[Ne]=ke,Z[Se]=qe,Ne=Se):(Z[Ne]=je,Z[ce]=qe,Ne=ce);else if(Se<We&&0>l(ke,qe))Z[Ne]=ke,Z[Se]=qe,Ne=Se;else break e}}return Te}function l(Z,Te){var qe=Z.sortIndex-Te.sortIndex;return qe!==0?qe:Z.id-Te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var y=[],p=[],b=1,k=null,T=3,I=!1,H=!1,K=!1,B=!1,Y=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function pe(Z){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=Z)i(p),Te.sortIndex=Te.expirationTime,e(y,Te);else break;Te=t(p)}}function we(Z){if(K=!1,pe(Z),!H)if(t(y)!==null)H=!0,ye||(ye=!0,D());else{var Te=t(p);Te!==null&&st(we,Te.startTime-Z)}}var ye=!1,M=-1,E=5,L=-1;function U(){return B?!0:!(s.unstable_now()-L<E)}function P(){if(B=!1,ye){var Z=s.unstable_now();L=Z;var Te=!0;try{e:{H=!1,K&&(K=!1,te(M),M=-1),I=!0;var qe=T;try{t:{for(pe(Z),k=t(y);k!==null&&!(k.expirationTime>Z&&U());){var Ne=k.callback;if(typeof Ne=="function"){k.callback=null,T=k.priorityLevel;var We=Ne(k.expirationTime<=Z);if(Z=s.unstable_now(),typeof We=="function"){k.callback=We,pe(Z),Te=!0;break t}k===t(y)&&i(y),pe(Z)}else i(y);k=t(y)}if(k!==null)Te=!0;else{var V=t(p);V!==null&&st(we,V.startTime-Z),Te=!1}}break e}finally{k=null,T=qe,I=!1}Te=void 0}}finally{Te?D():ye=!1}}}var D;if(typeof Q=="function")D=function(){Q(P)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Pe=A.port2;A.port1.onmessage=P,D=function(){Pe.postMessage(null)}}else D=function(){Y(P,0)};function st(Z,Te){M=Y(function(){Z(s.unstable_now())},Te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var Te=3;break;default:Te=T}var qe=T;T=Te;try{return Z()}finally{T=qe}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(Z,Te){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var qe=T;T=Z;try{return Te()}finally{T=qe}},s.unstable_scheduleCallback=function(Z,Te,qe){var Ne=s.unstable_now();switch(typeof qe=="object"&&qe!==null?(qe=qe.delay,qe=typeof qe=="number"&&0<qe?Ne+qe:Ne):qe=Ne,Z){case 1:var We=-1;break;case 2:We=250;break;case 5:We=1073741823;break;case 4:We=1e4;break;default:We=5e3}return We=qe+We,Z={id:b++,callback:Te,priorityLevel:Z,startTime:qe,expirationTime:We,sortIndex:-1},qe>Ne?(Z.sortIndex=qe,e(p,Z),t(y)===null&&Z===t(p)&&(K?(te(M),M=-1):K=!0,st(we,qe-Ne))):(Z.sortIndex=We,e(y,Z),H||I||(H=!0,ye||(ye=!0,D()))),Z},s.unstable_shouldYield=U,s.unstable_wrapCallback=function(Z){var Te=T;return function(){var qe=T;T=Te;try{return Z.apply(this,arguments)}finally{T=qe}}}})(Cg)),Cg}var Gb;function AT(){return Gb||(Gb=1,Sg.exports=NT()),Sg.exports}var Ng={exports:{}},Gs={};var Kb;function RT(){if(Kb)return Gs;Kb=1;var s=Qp();function e(y){var p="https://react.dev/errors/"+y;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(y,p,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:y,containerInfo:p,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(y,p){if(y==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Gs.createPortal=function(y,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(y,p,null,b)},Gs.flushSync=function(y){var p=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=p,i.p=b,i.d.f()}},Gs.preconnect=function(y,p){typeof y=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(y,p))},Gs.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},Gs.preinit=function(y,p){if(typeof y=="string"&&p&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,I=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?i.d.S(y,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:k,integrity:T,fetchPriority:I}):b==="script"&&i.d.X(y,{crossOrigin:k,integrity:T,fetchPriority:I,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Gs.preinitModule=function(y,p){if(typeof y=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=g(p.as,p.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(y)},Gs.preload=function(y,p){if(typeof y=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin);i.d.L(y,b,{crossOrigin:k,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Gs.preloadModule=function(y,p){if(typeof y=="string")if(p){var b=g(p.as,p.crossOrigin);i.d.m(y,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(y)},Gs.requestFormReset=function(y){i.d.r(y)},Gs.unstable_batchedUpdates=function(y,p){return y(p)},Gs.useFormState=function(y,p,b){return d.H.useFormState(y,p,b)},Gs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Gs.version="19.2.4",Gs}var Yb;function IT(){if(Yb)return Ng.exports;Yb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ng.exports=RT(),Ng.exports}var Qb;function DT(){if(Qb)return Yc;Qb=1;var s=AT(),e=Qp(),t=IT();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(u(n)!==n)throw Error(i(188))}function p(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===c)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,j=f.child;j;){if(j===o){x=!0,o=f,c=m;break}if(j===c){x=!0,c=f,o=m;break}j=j.sibling}if(!x){for(j=m.child;j;){if(j===o){x=!0,o=m,c=f;break}if(j===c){x=!0,c=m,o=f;break}j=j.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,T=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),te=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function D(n){return n===null||typeof n!="object"?null:(n=P&&n[P]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Pe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case K:return"Fragment";case Y:return"Profiler";case B:return"StrictMode";case we:return"Suspense";case ye:return"SuspenseList";case L:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case Q:return n.displayName||"Context";case te:return(n._context.displayName||"Context")+".Consumer";case pe:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case M:return r=n.displayName||null,r!==null?r:Pe(n.type)||"Memo";case E:r=n._payload,n=n._init;try{return Pe(n(r))}catch{}}return null}var st=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,qe={pending:!1,data:null,method:null,action:null},Ne=[],We=-1;function V(n){return{current:n}}function ce(n){0>We||(n.current=Ne[We],Ne[We]=null,We--)}function je(n,r){We++,Ne[We]=n.current,n.current=r}var Se=V(null),ke=V(null),Ve=V(null),He=V(null);function Qe(n,r){switch(je(Ve,r),je(ke,n),je(Se,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?db(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=db(r),n=hb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ce(Se),je(Se,n)}function Je(){ce(Se),ce(ke),ce(Ve)}function $t(n){n.memoizedState!==null&&je(He,n);var r=Se.current,o=hb(r,n.type);r!==o&&(je(ke,n),je(Se,o))}function Rt(n){ke.current===n&&(ce(Se),ce(ke)),He.current===n&&(ce(He),qc._currentValue=qe)}var Sn,ln;function qt(n){if(Sn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Sn=r&&r[1]||"",ln=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sn+n+ln}var Et=!1;function pn(n,r){if(!n||Et)return"";Et=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(me){var de=me}Reflect.construct(n,[],Ee)}else{try{Ee.call()}catch(me){de=me}n.call(Ee.prototype)}}else{try{throw Error()}catch(me){de=me}(Ee=n())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(me){if(me&&de&&typeof me.stack=="string")return[me.stack,de.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],j=m[1];if(x&&j){var z=x.split(`
`),ae=j.split(`
`);for(f=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ae.length&&!ae[f].includes("DetermineComponentFrameRoot");)f++;if(c===z.length||f===ae.length)for(c=z.length-1,f=ae.length-1;1<=c&&0<=f&&z[c]!==ae[f];)f--;for(;1<=c&&0<=f;c--,f--)if(z[c]!==ae[f]){if(c!==1||f!==1)do if(c--,f--,0>f||z[c]!==ae[f]){var be=`
`+z[c].replace(" at new "," at ");return n.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",n.displayName)),be}while(1<=c&&0<=f);break}}}finally{Et=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?qt(o):""}function Tt(n,r){switch(n.tag){case 26:case 27:case 5:return qt(n.type);case 16:return qt("Lazy");case 13:return n.child!==r&&r!==null?qt("Suspense Fallback"):qt("Suspense");case 19:return qt("SuspenseList");case 0:case 15:return pn(n.type,!1);case 11:return pn(n.type.render,!1);case 1:return pn(n.type,!0);case 31:return qt("Activity");default:return""}}function ut(n){try{var r="",o=null;do r+=Tt(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var le=Object.prototype.hasOwnProperty,pt=s.unstable_scheduleCallback,Ht=s.unstable_cancelCallback,it=s.unstable_shouldYield,yt=s.unstable_requestPaint,gt=s.unstable_now,wt=s.unstable_getCurrentPriorityLevel,Bt=s.unstable_ImmediatePriority,fs=s.unstable_UserBlockingPriority,sn=s.unstable_NormalPriority,Zn=s.unstable_LowPriority,Fn=s.unstable_IdlePriority,Ln=s.log,Pn=s.unstable_setDisableYieldValue,un=null,Wt=null;function Ct(n){if(typeof Ln=="function"&&Pn(n),Wt&&typeof Wt.setStrictMode=="function")try{Wt.setStrictMode(un,n)}catch{}}var It=Math.clz32?Math.clz32:ne,ee=Math.log,C=Math.LN2;function ne(n){return n>>>=0,n===0?32:31-(ee(n)/C|0)|0}var Re=256,Ie=262144,De=4194304;function Be(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Le(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var j=c&134217727;return j!==0?(c=j&~m,c!==0?f=Be(c):(x&=j,x!==0?f=Be(x):o||(o=j&~n,o!==0&&(f=Be(o))))):(j=c&~m,j!==0?f=Be(j):x!==0?f=Be(x):o||(o=c&~n,o!==0&&(f=Be(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Dt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function xt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=De;return De<<=1,(De&62914560)===0&&(De=4194304),n}function dn(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function hn(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function On(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var j=n.entanglements,z=n.expirationTimes,ae=n.hiddenUpdates;for(o=x&~o;0<o;){var be=31-It(o),Ee=1<<be;j[be]=0,z[be]=-1;var de=ae[be];if(de!==null)for(ae[be]=null,be=0;be<de.length;be++){var me=de[be];me!==null&&(me.lane&=-536870913)}o&=~Ee}c!==0&&ms(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function ms(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-It(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function ue(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-It(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Me(n,r){var o=r&-r;return o=(o&42)!==0?1:Ke(o),(o&(n.suspendedLanes|r))!==0?0:o}function Ke(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ct(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function rt(){var n=Te.p;return n!==0?n:(n=window.event,n===void 0?32:Lb(n.type))}function Gt(n,r){var o=Te.p;try{return Te.p=n,r()}finally{Te.p=o}}var fn=Math.random().toString(36).slice(2),Nt="__reactFiber$"+fn,St="__reactProps$"+fn,bn="__reactContainer$"+fn,Ss="__reactEvents$"+fn,si="__reactListeners$"+fn,wi="__reactHandles$"+fn,Or="__reactResources$"+fn,js="__reactMarker$"+fn;function hr(n){delete n[Nt],delete n[St],delete n[Ss],delete n[si],delete n[wi]}function Gn(n){var r=n[Nt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[bn]||o[Nt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=bb(n);n!==null;){if(o=n[Nt])return o;n=bb(n)}return r}n=o,o=n.parentNode}return null}function os(n){if(n=n[Nt]||n[bn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ls(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Vn(n){var r=n[Or];return r||(r=n[Or]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function wn(n){n[js]=!0}var es=new Set,_r={};function Hs(n,r){Kn(n,r),Kn(n+"Capture",r)}function Kn(n,r){for(_r[n]=r,n=0;n<r.length;n++)es.add(r[n])}var kr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ts={},Vr={};function O(n){return le.call(Vr,n)?!0:le.call(ts,n)?!1:kr.test(n)?Vr[n]=!0:(ts[n]=!0,!1)}function q(n,r,o){if(O(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function oe(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function se(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Ye(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ge(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Fe(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function ot(n){if(!n._valueTracker){var r=Ge(n)?"checked":"value";n._valueTracker=Fe(n,r,""+n[r])}}function At(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=Ge(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function Cn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Cs=/[\n"\\]/g;function Yn(n){return n.replace(Cs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ds(n,r,o,c,f,m,x,j){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Ye(r)):n.value!==""+Ye(r)&&(n.value=""+Ye(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Ms(n,x,Ye(r)):o!=null?Ms(n,x,Ye(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?n.name=""+Ye(j):n.removeAttribute("name")}function ri(n,r,o,c,f,m,x,j){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ot(n);return}o=o!=null?""+Ye(o):"",r=r!=null?""+Ye(r):o,j||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=j?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),ot(n)}function Ms(n,r,o){r==="number"&&Cn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function er(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Ye(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function xi(n,r,o){if(r!=null&&(r=""+Ye(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Ye(o):""}function jr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(st(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Ye(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ot(n)}function Ns(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var ja=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bi(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||ja.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function ii(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Bi(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Bi(n,m,r[m])}function _i(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ur=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Er(n){return Ur.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function qs(){}var $s=null;function Ls(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var S=null,X=null;function Ae(n){var r=os(n);if(r&&(n=r.stateNode)){var o=n[St]||null;e:switch(n=r.stateNode,r.type){case"input":if(Ds(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[St]||null;if(!f)throw Error(i(90));Ds(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&At(c)}break e;case"textarea":xi(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&er(n,!!o.multiple,r,!1)}}}var R=!1;function F(n,r,o){if(R)return n(r,o);R=!0;try{var c=n(r);return c}finally{if(R=!1,(S!==null||X!==null)&&(Od(),S&&(r=S,n=X,X=S=null,Ae(r),n)))for(r=0;r<n.length;r++)Ae(n[r])}}function $(n,r){var o=n.stateNode;if(o===null)return null;var c=o[St]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var G=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fe=!1;if(G)try{var ve={};Object.defineProperty(ve,"passive",{get:function(){fe=!0}}),window.addEventListener("test",ve,ve),window.removeEventListener("test",ve,ve)}catch{fe=!1}var Oe=null,tt=null,nt=null;function vt(){if(nt)return nt;var n,r=tt,o=r.length,c,f="value"in Oe?Oe.value:Oe.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return nt=f.slice(n,1<c?1-c:void 0)}function _t(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Xt(){return!0}function Hn(){return!1}function et(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var j in n)n.hasOwnProperty(j)&&(o=n[j],this[j]=o?o(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Xt:Hn,this.isPropagationStopped=Hn,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),r}var mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rn=et(mn),mt=k({},mn,{view:0,detail:0}),gn=et(mt),Qn,tr,Ws,As=k({},mt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ea,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ws&&(Ws&&n.type==="mousemove"?(Qn=n.screenX-Ws.screenX,tr=n.screenY-Ws.screenY):tr=Qn=0,Ws=n),Qn)},movementY:function(n){return"movementY"in n?n.movementY:tr}}),nr=et(As),Tr=k({},As,{dataTransfer:0}),po=et(Tr),sl=k({},mt,{relatedTarget:0}),ai=et(sl),dc=k({},mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Gu=et(dc),rl=k({},mn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ku=et(rl),Yu=k({},mn,{data:0}),ki=et(Yu),Qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ju={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Ju[n])?!!r[n]:!1}function Ea(){return Zu}var sr=k({},mt,{key:function(n){if(n.key){var r=Qu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=_t(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Xu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ea,charCode:function(n){return n.type==="keypress"?_t(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?_t(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ed=et(sr),td=k({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fi=et(td),h=k({},mt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ea}),v=et(h),_=k({},mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=et(_),re=k({},As,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),he=et(re),Ue=k({},mn,{newState:0,oldState:0}),Ot=et(Ue),cs=[9,13,27,32],xn=G&&"CompositionEvent"in window,qn=null;G&&"documentMode"in document&&(qn=document.documentMode);var Br=G&&"TextEvent"in window&&!qn,ji=G&&(!xn||qn&&8<qn&&11>=qn),oi=" ",li=!1;function yo(n,r){switch(n){case"keyup":return cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function il(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var al=!1;function Qj(n,r){switch(n){case"compositionend":return il(r);case"keypress":return r.which!==32?null:(li=!0,oi);case"textInput":return n=r.data,n===oi&&li?null:n;default:return null}}function Xj(n,r){if(al)return n==="compositionend"||!xn&&yo(n,r)?(n=vt(),nt=tt=Oe=null,al=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ji&&r.locale!=="ko"?null:r.data;default:return null}}var Jj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Jj[n.type]:r==="textarea"}function k0(n,r,o,c){S?X?X.push(c):X=[c]:S=c,r=qd(r,"onChange"),0<r.length&&(o=new rn("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var hc=null,fc=null;function Zj(n){ib(n,0)}function nd(n){var r=ls(n);if(At(r))return n}function j0(n,r){if(n==="change")return r}var E0=!1;if(G){var Rf;if(G){var If="oninput"in document;if(!If){var T0=document.createElement("div");T0.setAttribute("oninput","return;"),If=typeof T0.oninput=="function"}Rf=If}else Rf=!1;E0=Rf&&(!document.documentMode||9<document.documentMode)}function S0(){hc&&(hc.detachEvent("onpropertychange",C0),fc=hc=null)}function C0(n){if(n.propertyName==="value"&&nd(fc)){var r=[];k0(r,fc,n,Ls(n)),F(Zj,r)}}function eE(n,r,o){n==="focusin"?(S0(),hc=r,fc=o,hc.attachEvent("onpropertychange",C0)):n==="focusout"&&S0()}function tE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nd(fc)}function nE(n,r){if(n==="click")return nd(r)}function sE(n,r){if(n==="input"||n==="change")return nd(r)}function rE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Sr=typeof Object.is=="function"?Object.is:rE;function mc(n,r){if(Sr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!le.call(r,f)||!Sr(n[f],r[f]))return!1}return!0}function N0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function A0(n,r){var o=N0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=N0(o)}}function R0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?R0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function I0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Cn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Cn(n.document)}return r}function Df(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var iE=G&&"documentMode"in document&&11>=document.documentMode,ol=null,Mf=null,gc=null,Lf=!1;function D0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Lf||ol==null||ol!==Cn(c)||(c=ol,"selectionStart"in c&&Df(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),gc&&mc(gc,c)||(gc=c,c=qd(Mf,"onSelect"),0<c.length&&(r=new rn("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=ol)))}function vo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var ll={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Pf={},M0={};G&&(M0=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function bo(n){if(Pf[n])return Pf[n];if(!ll[n])return n;var r=ll[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in M0)return Pf[n]=r[o];return n}var L0=bo("animationend"),P0=bo("animationiteration"),O0=bo("animationstart"),aE=bo("transitionrun"),oE=bo("transitionstart"),lE=bo("transitioncancel"),V0=bo("transitionend"),U0=new Map,Of="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Of.push("scrollEnd");function ci(n,r){U0.set(n,r),Hs(r,[n])}var sd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},zr=[],cl=0,Vf=0;function rd(){for(var n=cl,r=Vf=cl=0;r<n;){var o=zr[r];zr[r++]=null;var c=zr[r];zr[r++]=null;var f=zr[r];zr[r++]=null;var m=zr[r];if(zr[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&B0(o,f,m)}}function id(n,r,o,c){zr[cl++]=n,zr[cl++]=r,zr[cl++]=o,zr[cl++]=c,Vf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Uf(n,r,o,c){return id(n,r,o,c),ad(n)}function wo(n,r){return id(n,null,null,r),ad(n)}function B0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-It(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ad(n){if(50<Oc)throw Oc=0,Km=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var ul={};function cE(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cr(n,r,o,c){return new cE(n,r,o,c)}function Bf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Hi(n,r){var o=n.alternate;return o===null?(o=Cr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function z0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function od(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")Bf(n)&&(x=1);else if(typeof n=="string")x=mT(n,o,Se.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case L:return n=Cr(31,o,r,f),n.elementType=L,n.lanes=m,n;case K:return xo(o.children,f,m,r);case B:x=8,f|=24;break;case Y:return n=Cr(12,o,r,f|2),n.elementType=Y,n.lanes=m,n;case we:return n=Cr(13,o,r,f),n.elementType=we,n.lanes=m,n;case ye:return n=Cr(19,o,r,f),n.elementType=ye,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Q:x=10;break e;case te:x=9;break e;case pe:x=11;break e;case M:x=14;break e;case E:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Cr(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function xo(n,r,o,c){return n=Cr(7,n,c,r),n.lanes=o,n}function zf(n,r,o){return n=Cr(6,n,null,r),n.lanes=o,n}function F0(n){var r=Cr(18,null,null,0);return r.stateNode=n,r}function Ff(n,r,o){return r=Cr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var H0=new WeakMap;function Fr(n,r){if(typeof n=="object"&&n!==null){var o=H0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:ut(r)},H0.set(n,r),r)}return{value:n,source:r,stack:ut(r)}}var dl=[],hl=0,ld=null,pc=0,Hr=[],qr=0,Ta=null,Ei=1,Ti="";function qi(n,r){dl[hl++]=pc,dl[hl++]=ld,ld=n,pc=r}function q0(n,r,o){Hr[qr++]=Ei,Hr[qr++]=Ti,Hr[qr++]=Ta,Ta=n;var c=Ei;n=Ti;var f=32-It(c)-1;c&=~(1<<f),o+=1;var m=32-It(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,Ei=1<<32-It(r)+f|o<<f|c,Ti=m+n}else Ei=1<<m|o<<f|c,Ti=n}function Hf(n){n.return!==null&&(qi(n,1),q0(n,1,0))}function qf(n){for(;n===ld;)ld=dl[--hl],dl[hl]=null,pc=dl[--hl],dl[hl]=null;for(;n===Ta;)Ta=Hr[--qr],Hr[qr]=null,Ti=Hr[--qr],Hr[qr]=null,Ei=Hr[--qr],Hr[qr]=null}function $0(n,r){Hr[qr++]=Ei,Hr[qr++]=Ti,Hr[qr++]=Ta,Ei=r.id,Ti=r.overflow,Ta=n}var Ps=null,Un=null,an=!1,Sa=null,$r=!1,$f=Error(i(519));function Ca(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yc(Fr(r,n)),$f}function W0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Nt]=n,r[St]=c,o){case"dialog":Yt("cancel",r),Yt("close",r);break;case"iframe":case"object":case"embed":Yt("load",r);break;case"video":case"audio":for(o=0;o<Uc.length;o++)Yt(Uc[o],r);break;case"source":Yt("error",r);break;case"img":case"image":case"link":Yt("error",r),Yt("load",r);break;case"details":Yt("toggle",r);break;case"input":Yt("invalid",r),ri(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Yt("invalid",r);break;case"textarea":Yt("invalid",r),jr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||cb(r.textContent,o)?(c.popover!=null&&(Yt("beforetoggle",r),Yt("toggle",r)),c.onScroll!=null&&Yt("scroll",r),c.onScrollEnd!=null&&Yt("scrollend",r),c.onClick!=null&&(r.onclick=qs),r=!0):r=!1,r||Ca(n,!0)}function G0(n){for(Ps=n.return;Ps;)switch(Ps.tag){case 5:case 31:case 13:$r=!1;return;case 27:case 3:$r=!0;return;default:Ps=Ps.return}}function fl(n){if(n!==Ps)return!1;if(!an)return G0(n),an=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||cg(n.type,n.memoizedProps)),o=!o),o&&Un&&Ca(n),G0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=vb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=vb(n)}else r===27?(r=Un,Fa(n.type)?(n=mg,mg=null,Un=n):Un=r):Un=Ps?Gr(n.stateNode.nextSibling):null;return!0}function _o(){Un=Ps=null,an=!1}function Wf(){var n=Sa;return n!==null&&(pr===null?pr=n:pr.push.apply(pr,n),Sa=null),n}function yc(n){Sa===null?Sa=[n]:Sa.push(n)}var Gf=V(null),ko=null,$i=null;function Na(n,r,o){je(Gf,r._currentValue),r._currentValue=o}function Wi(n){n._currentValue=Gf.current,ce(Gf)}function Kf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Yf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var j=m;m=f;for(var z=0;z<r.length;z++)if(j.context===r[z]){m.lanes|=o,j=m.alternate,j!==null&&(j.lanes|=o),Kf(m.return,o,n),c||(x=null);break e}m=j.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Kf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function ml(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var j=f.type;Sr(f.pendingProps.value,x.value)||(n!==null?n.push(j):n=[j])}}else if(f===He.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(qc):n=[qc])}f=f.return}n!==null&&Yf(r,n,o,c),r.flags|=262144}function cd(n){for(n=n.firstContext;n!==null;){if(!Sr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function jo(n){ko=n,$i=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Os(n){return K0(ko,n)}function ud(n,r){return ko===null&&jo(n),K0(n,r)}function K0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},$i===null){if(n===null)throw Error(i(308));$i=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else $i=$i.next=r;return o}var uE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},dE=s.unstable_scheduleCallback,hE=s.unstable_NormalPriority,gs={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qf(){return{controller:new uE,data:new Map,refCount:0}}function vc(n){n.refCount--,n.refCount===0&&dE(hE,function(){n.controller.abort()})}var bc=null,Xf=0,gl=0,pl=null;function fE(n,r){if(bc===null){var o=bc=[];Xf=0,gl=eg(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Xf++,r.then(Y0,Y0),r}function Y0(){if(--Xf===0&&bc!==null){pl!==null&&(pl.status="fulfilled");var n=bc;bc=null,gl=0,pl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function mE(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Q0=Z.S;Z.S=function(n,r){D1=gt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&fE(n,r),Q0!==null&&Q0(n,r)};var Eo=V(null);function Jf(){var n=Eo.current;return n!==null?n:Dn.pooledCache}function dd(n,r){r===null?je(Eo,Eo.current):je(Eo,r.pool)}function X0(){var n=Jf();return n===null?null:{parent:gs._currentValue,pool:n}}var yl=Error(i(460)),Zf=Error(i(474)),hd=Error(i(542)),fd={then:function(){}};function J0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Z0(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(qs,qs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,tv(n),n;default:if(typeof r.status=="string")r.then(qs,qs);else{if(n=Dn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,tv(n),n}throw So=r,yl}}function To(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(So=o,yl):o}}var So=null;function ev(){if(So===null)throw Error(i(459));var n=So;return So=null,n}function tv(n){if(n===yl||n===hd)throw Error(i(483))}var vl=null,wc=0;function md(n){var r=wc;return wc+=1,vl===null&&(vl=[]),Z0(vl,n,r)}function xc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function gd(n,r){throw r.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function nv(n){function r(J,W){if(n){var ie=J.deletions;ie===null?(J.deletions=[W],J.flags|=16):ie.push(W)}}function o(J,W){if(!n)return null;for(;W!==null;)r(J,W),W=W.sibling;return null}function c(J){for(var W=new Map;J!==null;)J.key!==null?W.set(J.key,J):W.set(J.index,J),J=J.sibling;return W}function f(J,W){return J=Hi(J,W),J.index=0,J.sibling=null,J}function m(J,W,ie){return J.index=ie,n?(ie=J.alternate,ie!==null?(ie=ie.index,ie<W?(J.flags|=67108866,W):ie):(J.flags|=67108866,W)):(J.flags|=1048576,W)}function x(J){return n&&J.alternate===null&&(J.flags|=67108866),J}function j(J,W,ie,xe){return W===null||W.tag!==6?(W=zf(ie,J.mode,xe),W.return=J,W):(W=f(W,ie),W.return=J,W)}function z(J,W,ie,xe){var ht=ie.type;return ht===K?be(J,W,ie.props.children,xe,ie.key):W!==null&&(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&To(ht)===W.type)?(W=f(W,ie.props),xc(W,ie),W.return=J,W):(W=od(ie.type,ie.key,ie.props,null,J.mode,xe),xc(W,ie),W.return=J,W)}function ae(J,W,ie,xe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=Ff(ie,J.mode,xe),W.return=J,W):(W=f(W,ie.children||[]),W.return=J,W)}function be(J,W,ie,xe,ht){return W===null||W.tag!==7?(W=xo(ie,J.mode,xe,ht),W.return=J,W):(W=f(W,ie),W.return=J,W)}function Ee(J,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=zf(""+W,J.mode,ie),W.return=J,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case I:return ie=od(W.type,W.key,W.props,null,J.mode,ie),xc(ie,W),ie.return=J,ie;case H:return W=Ff(W,J.mode,ie),W.return=J,W;case E:return W=To(W),Ee(J,W,ie)}if(st(W)||D(W))return W=xo(W,J.mode,ie,null),W.return=J,W;if(typeof W.then=="function")return Ee(J,md(W),ie);if(W.$$typeof===Q)return Ee(J,ud(J,W),ie);gd(J,W)}return null}function de(J,W,ie,xe){var ht=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ht!==null?null:j(J,W,""+ie,xe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:return ie.key===ht?z(J,W,ie,xe):null;case H:return ie.key===ht?ae(J,W,ie,xe):null;case E:return ie=To(ie),de(J,W,ie,xe)}if(st(ie)||D(ie))return ht!==null?null:be(J,W,ie,xe,null);if(typeof ie.then=="function")return de(J,W,md(ie),xe);if(ie.$$typeof===Q)return de(J,W,ud(J,ie),xe);gd(J,ie)}return null}function me(J,W,ie,xe,ht){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return J=J.get(ie)||null,j(W,J,""+xe,ht);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case I:return J=J.get(xe.key===null?ie:xe.key)||null,z(W,J,xe,ht);case H:return J=J.get(xe.key===null?ie:xe.key)||null,ae(W,J,xe,ht);case E:return xe=To(xe),me(J,W,ie,xe,ht)}if(st(xe)||D(xe))return J=J.get(ie)||null,be(W,J,xe,ht,null);if(typeof xe.then=="function")return me(J,W,ie,md(xe),ht);if(xe.$$typeof===Q)return me(J,W,ie,ud(W,xe),ht);gd(W,xe)}return null}function Ze(J,W,ie,xe){for(var ht=null,yn=null,at=W,zt=W=0,Zt=null;at!==null&&zt<ie.length;zt++){at.index>zt?(Zt=at,at=null):Zt=at.sibling;var vn=de(J,at,ie[zt],xe);if(vn===null){at===null&&(at=Zt);break}n&&at&&vn.alternate===null&&r(J,at),W=m(vn,W,zt),yn===null?ht=vn:yn.sibling=vn,yn=vn,at=Zt}if(zt===ie.length)return o(J,at),an&&qi(J,zt),ht;if(at===null){for(;zt<ie.length;zt++)at=Ee(J,ie[zt],xe),at!==null&&(W=m(at,W,zt),yn===null?ht=at:yn.sibling=at,yn=at);return an&&qi(J,zt),ht}for(at=c(at);zt<ie.length;zt++)Zt=me(at,J,zt,ie[zt],xe),Zt!==null&&(n&&Zt.alternate!==null&&at.delete(Zt.key===null?zt:Zt.key),W=m(Zt,W,zt),yn===null?ht=Zt:yn.sibling=Zt,yn=Zt);return n&&at.forEach(function(Ga){return r(J,Ga)}),an&&qi(J,zt),ht}function bt(J,W,ie,xe){if(ie==null)throw Error(i(151));for(var ht=null,yn=null,at=W,zt=W=0,Zt=null,vn=ie.next();at!==null&&!vn.done;zt++,vn=ie.next()){at.index>zt?(Zt=at,at=null):Zt=at.sibling;var Ga=de(J,at,vn.value,xe);if(Ga===null){at===null&&(at=Zt);break}n&&at&&Ga.alternate===null&&r(J,at),W=m(Ga,W,zt),yn===null?ht=Ga:yn.sibling=Ga,yn=Ga,at=Zt}if(vn.done)return o(J,at),an&&qi(J,zt),ht;if(at===null){for(;!vn.done;zt++,vn=ie.next())vn=Ee(J,vn.value,xe),vn!==null&&(W=m(vn,W,zt),yn===null?ht=vn:yn.sibling=vn,yn=vn);return an&&qi(J,zt),ht}for(at=c(at);!vn.done;zt++,vn=ie.next())vn=me(at,J,zt,vn.value,xe),vn!==null&&(n&&vn.alternate!==null&&at.delete(vn.key===null?zt:vn.key),W=m(vn,W,zt),yn===null?ht=vn:yn.sibling=vn,yn=vn);return n&&at.forEach(function(ET){return r(J,ET)}),an&&qi(J,zt),ht}function Rn(J,W,ie,xe){if(typeof ie=="object"&&ie!==null&&ie.type===K&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:e:{for(var ht=ie.key;W!==null;){if(W.key===ht){if(ht=ie.type,ht===K){if(W.tag===7){o(J,W.sibling),xe=f(W,ie.props.children),xe.return=J,J=xe;break e}}else if(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&To(ht)===W.type){o(J,W.sibling),xe=f(W,ie.props),xc(xe,ie),xe.return=J,J=xe;break e}o(J,W);break}else r(J,W);W=W.sibling}ie.type===K?(xe=xo(ie.props.children,J.mode,xe,ie.key),xe.return=J,J=xe):(xe=od(ie.type,ie.key,ie.props,null,J.mode,xe),xc(xe,ie),xe.return=J,J=xe)}return x(J);case H:e:{for(ht=ie.key;W!==null;){if(W.key===ht)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(J,W.sibling),xe=f(W,ie.children||[]),xe.return=J,J=xe;break e}else{o(J,W);break}else r(J,W);W=W.sibling}xe=Ff(ie,J.mode,xe),xe.return=J,J=xe}return x(J);case E:return ie=To(ie),Rn(J,W,ie,xe)}if(st(ie))return Ze(J,W,ie,xe);if(D(ie)){if(ht=D(ie),typeof ht!="function")throw Error(i(150));return ie=ht.call(ie),bt(J,W,ie,xe)}if(typeof ie.then=="function")return Rn(J,W,md(ie),xe);if(ie.$$typeof===Q)return Rn(J,W,ud(J,ie),xe);gd(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(J,W.sibling),xe=f(W,ie),xe.return=J,J=xe):(o(J,W),xe=zf(ie,J.mode,xe),xe.return=J,J=xe),x(J)):o(J,W)}return function(J,W,ie,xe){try{wc=0;var ht=Rn(J,W,ie,xe);return vl=null,ht}catch(at){if(at===yl||at===hd)throw at;var yn=Cr(29,at,null,J.mode);return yn.lanes=xe,yn.return=J,yn}}}var Co=nv(!0),sv=nv(!1),Aa=!1;function em(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ra(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ia(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(_n&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ad(n),B0(n,null,o),r}return id(n,c,r,o),ad(n)}function _c(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}function nm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var sm=!1;function kc(){if(sm){var n=pl;if(n!==null)throw n}}function jc(n,r,o,c){sm=!1;var f=n.updateQueue;Aa=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,j=f.shared.pending;if(j!==null){f.shared.pending=null;var z=j,ae=z.next;z.next=null,x===null?m=ae:x.next=ae,x=z;var be=n.alternate;be!==null&&(be=be.updateQueue,j=be.lastBaseUpdate,j!==x&&(j===null?be.firstBaseUpdate=ae:j.next=ae,be.lastBaseUpdate=z))}if(m!==null){var Ee=f.baseState;x=0,be=ae=z=null,j=m;do{var de=j.lane&-536870913,me=de!==j.lane;if(me?(Jt&de)===de:(c&de)===de){de!==0&&de===gl&&(sm=!0),be!==null&&(be=be.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Ze=n,bt=j;de=r;var Rn=o;switch(bt.tag){case 1:if(Ze=bt.payload,typeof Ze=="function"){Ee=Ze.call(Rn,Ee,de);break e}Ee=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=bt.payload,de=typeof Ze=="function"?Ze.call(Rn,Ee,de):Ze,de==null)break e;Ee=k({},Ee,de);break e;case 2:Aa=!0}}de=j.callback,de!==null&&(n.flags|=64,me&&(n.flags|=8192),me=f.callbacks,me===null?f.callbacks=[de]:me.push(de))}else me={lane:de,tag:j.tag,payload:j.payload,callback:j.callback,next:null},be===null?(ae=be=me,z=Ee):be=be.next=me,x|=de;if(j=j.next,j===null){if(j=f.shared.pending,j===null)break;me=j,j=me.next,me.next=null,f.lastBaseUpdate=me,f.shared.pending=null}}while(!0);be===null&&(z=Ee),f.baseState=z,f.firstBaseUpdate=ae,f.lastBaseUpdate=be,m===null&&(f.shared.lanes=0),Oa|=x,n.lanes=x,n.memoizedState=Ee}}function rv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function iv(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)rv(o[n],r)}var bl=V(null),pd=V(0);function av(n,r){n=ta,je(pd,n),je(bl,r),ta=n|r.baseLanes}function rm(){je(pd,ta),je(bl,bl.current)}function im(){ta=pd.current,ce(bl),ce(pd)}var Nr=V(null),Wr=null;function Da(n){var r=n.alternate;je(us,us.current&1),je(Nr,n),Wr===null&&(r===null||bl.current!==null||r.memoizedState!==null)&&(Wr=n)}function am(n){je(us,us.current),je(Nr,n),Wr===null&&(Wr=n)}function ov(n){n.tag===22?(je(us,us.current),je(Nr,n),Wr===null&&(Wr=n)):Ma()}function Ma(){je(us,us.current),je(Nr,Nr.current)}function Ar(n){ce(Nr),Wr===n&&(Wr=null),ce(us)}var us=V(0);function yd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||hg(o)||fg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Gi=0,Vt=null,Nn=null,ps=null,vd=!1,wl=!1,No=!1,bd=0,Ec=0,xl=null,gE=0;function ns(){throw Error(i(321))}function om(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Sr(n[o],r[o]))return!1;return!0}function lm(n,r,o,c,f,m){return Gi=m,Vt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z.H=n===null||n.memoizedState===null?qv:km,No=!1,m=o(c,f),No=!1,wl&&(m=cv(r,o,c,f)),lv(n),m}function lv(n){Z.H=Cc;var r=Nn!==null&&Nn.next!==null;if(Gi=0,ps=Nn=Vt=null,vd=!1,Ec=0,xl=null,r)throw Error(i(300));n===null||ys||(n=n.dependencies,n!==null&&cd(n)&&(ys=!0))}function cv(n,r,o,c){Vt=n;var f=0;do{if(wl&&(xl=null),Ec=0,wl=!1,25<=f)throw Error(i(301));if(f+=1,ps=Nn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}Z.H=$v,m=r(o,c)}while(wl);return m}function pE(){var n=Z.H,r=n.useState()[0];return r=typeof r.then=="function"?Tc(r):r,n=n.useState()[0],(Nn!==null?Nn.memoizedState:null)!==n&&(Vt.flags|=1024),r}function cm(){var n=bd!==0;return bd=0,n}function um(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function dm(n){if(vd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}vd=!1}Gi=0,ps=Nn=Vt=null,wl=!1,Ec=bd=0,xl=null}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Vt.memoizedState=ps=n:ps=ps.next=n,ps}function ds(){if(Nn===null){var n=Vt.alternate;n=n!==null?n.memoizedState:null}else n=Nn.next;var r=ps===null?Vt.memoizedState:ps.next;if(r!==null)ps=r,Nn=n;else{if(n===null)throw Vt.alternate===null?Error(i(467)):Error(i(310));Nn=n,n={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},ps===null?Vt.memoizedState=ps=n:ps=ps.next=n}return ps}function wd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(n){var r=Ec;return Ec+=1,xl===null&&(xl=[]),n=Z0(xl,n,r),r=Vt,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,Z.H=r===null||r.memoizedState===null?qv:km),n}function xd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Tc(n);if(n.$$typeof===Q)return Os(n)}throw Error(i(438,String(n)))}function hm(n){var r=null,o=Vt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Vt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=wd(),Vt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=U;return r.index++,o}function Ki(n,r){return typeof r=="function"?r(n):r}function _d(n){var r=ds();return fm(r,Nn,n)}function fm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var j=x=null,z=null,ae=r,be=!1;do{var Ee=ae.lane&-536870913;if(Ee!==ae.lane?(Jt&Ee)===Ee:(Gi&Ee)===Ee){var de=ae.revertLane;if(de===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),Ee===gl&&(be=!0);else if((Gi&de)===de){ae=ae.next,de===gl&&(be=!0);continue}else Ee={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},z===null?(j=z=Ee,x=m):z=z.next=Ee,Vt.lanes|=de,Oa|=de;Ee=ae.action,No&&o(m,Ee),m=ae.hasEagerState?ae.eagerState:o(m,Ee)}else de={lane:Ee,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},z===null?(j=z=de,x=m):z=z.next=de,Vt.lanes|=Ee,Oa|=Ee;ae=ae.next}while(ae!==null&&ae!==r);if(z===null?x=m:z.next=j,!Sr(m,n.memoizedState)&&(ys=!0,be&&(o=pl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=z,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function mm(n){var r=ds(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);Sr(m,r.memoizedState)||(ys=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function uv(n,r,o){var c=Vt,f=ds(),m=an;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!Sr((Nn||f).memoizedState,o);if(x&&(f.memoizedState=o,ys=!0),f=f.queue,ym(fv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,_l(9,{destroy:void 0},hv.bind(null,c,f,o,r),null),Dn===null)throw Error(i(349));m||(Gi&127)!==0||dv(c,r,o)}return o}function dv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Vt.updateQueue,r===null?(r=wd(),Vt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function hv(n,r,o,c){r.value=o,r.getSnapshot=c,mv(r)&&gv(n)}function fv(n,r,o){return o(function(){mv(r)&&gv(n)})}function mv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Sr(n,o)}catch{return!0}}function gv(n){var r=wo(n,2);r!==null&&yr(r,n,2)}function gm(n){var r=rr();if(typeof n=="function"){var o=n;if(n=o(),No){Ct(!0);try{o()}finally{Ct(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:n},r}function pv(n,r,o,c){return n.baseState=o,fm(n,Nn,typeof c=="function"?c:Ki)}function yE(n,r,o,c,f){if(Ed(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};Z.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,yv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function yv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=Z.T,x={};Z.T=x;try{var j=o(f,c),z=Z.S;z!==null&&z(x,j),vv(n,r,j)}catch(ae){pm(n,r,ae)}finally{m!==null&&x.types!==null&&(m.types=x.types),Z.T=m}}else try{m=o(f,c),vv(n,r,m)}catch(ae){pm(n,r,ae)}}function vv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){bv(n,r,c)},function(c){return pm(n,r,c)}):bv(n,r,o)}function bv(n,r,o){r.status="fulfilled",r.value=o,wv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,yv(n,o)))}function pm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,wv(r),r=r.next;while(r!==c)}n.action=null}function wv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function xv(n,r){return r}function _v(n,r){if(an){var o=Dn.formState;if(o!==null){e:{var c=Vt;if(an){if(Un){t:{for(var f=Un,m=$r;f.nodeType!==8;){if(!m){f=null;break t}if(f=Gr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Un=Gr(f.nextSibling),c=f.data==="F!";break e}}Ca(c)}c=!1}c&&(r=o[0])}}return o=rr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xv,lastRenderedState:r},o.queue=c,o=zv.bind(null,Vt,c),c.dispatch=o,c=gm(!1),m=_m.bind(null,Vt,!1,c.queue),c=rr(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=yE.bind(null,Vt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function kv(n){var r=ds();return jv(r,Nn,n)}function jv(n,r,o){if(r=fm(n,r,xv)[0],n=_d(Ki)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Tc(r)}catch(x){throw x===yl?hd:x}else c=r;r=ds();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Vt.flags|=2048,_l(9,{destroy:void 0},vE.bind(null,f,o),null)),[c,m,n]}function vE(n,r){n.action=r}function Ev(n){var r=ds(),o=Nn;if(o!==null)return jv(r,o,n);ds(),r=r.memoizedState,o=ds();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function _l(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Vt.updateQueue,r===null&&(r=wd(),Vt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Tv(){return ds().memoizedState}function kd(n,r,o,c){var f=rr();Vt.flags|=n,f.memoizedState=_l(1|r,{destroy:void 0},o,c===void 0?null:c)}function jd(n,r,o,c){var f=ds();c=c===void 0?null:c;var m=f.memoizedState.inst;Nn!==null&&c!==null&&om(c,Nn.memoizedState.deps)?f.memoizedState=_l(r,m,o,c):(Vt.flags|=n,f.memoizedState=_l(1|r,m,o,c))}function Sv(n,r){kd(8390656,8,n,r)}function ym(n,r){jd(2048,8,n,r)}function bE(n){Vt.flags|=4;var r=Vt.updateQueue;if(r===null)r=wd(),Vt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Cv(n){var r=ds().memoizedState;return bE({ref:r,nextImpl:n}),function(){if((_n&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Nv(n,r){return jd(4,2,n,r)}function Av(n,r){return jd(4,4,n,r)}function Rv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Iv(n,r,o){o=o!=null?o.concat([n]):null,jd(4,4,Rv.bind(null,r,n),o)}function vm(){}function Dv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&om(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Mv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&om(r,c[1]))return c[0];if(c=n(),No){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[c,r],c}function bm(n,r,o){return o===void 0||(Gi&1073741824)!==0&&(Jt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=L1(),Vt.lanes|=n,Oa|=n,o)}function Lv(n,r,o,c){return Sr(o,r)?o:bl.current!==null?(n=bm(n,o,c),Sr(n,r)||(ys=!0),n):(Gi&42)===0||(Gi&1073741824)!==0&&(Jt&261930)===0?(ys=!0,n.memoizedState=o):(n=L1(),Vt.lanes|=n,Oa|=n,r)}function Pv(n,r,o,c,f){var m=Te.p;Te.p=m!==0&&8>m?m:8;var x=Z.T,j={};Z.T=j,_m(n,!1,r,o);try{var z=f(),ae=Z.S;if(ae!==null&&ae(j,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var be=mE(z,c);Sc(n,r,be,Dr(n))}else Sc(n,r,c,Dr(n))}catch(Ee){Sc(n,r,{then:function(){},status:"rejected",reason:Ee},Dr())}finally{Te.p=m,x!==null&&j.types!==null&&(x.types=j.types),Z.T=x}}function wE(){}function wm(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Ov(n).queue;Pv(n,f,r,qe,o===null?wE:function(){return Vv(n),o(c)})}function Ov(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:qe,baseState:qe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:qe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Vv(n){var r=Ov(n);r.next===null&&(r=n.alternate.memoizedState),Sc(n,r.next.queue,{},Dr())}function xm(){return Os(qc)}function Uv(){return ds().memoizedState}function Bv(){return ds().memoizedState}function xE(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Dr();n=Ra(o);var c=Ia(r,n,o);c!==null&&(yr(c,r,o),_c(c,r,o)),r={cache:Qf()},n.payload=r;return}r=r.return}}function _E(n,r,o){var c=Dr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Ed(n)?Fv(r,o):(o=Uf(n,r,o,c),o!==null&&(yr(o,n,c),Hv(o,r,c)))}function zv(n,r,o){var c=Dr();Sc(n,r,o,c)}function Sc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Ed(n))Fv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,j=m(x,o);if(f.hasEagerState=!0,f.eagerState=j,Sr(j,x))return id(n,r,f,0),Dn===null&&rd(),!1}catch{}if(o=Uf(n,r,f,c),o!==null)return yr(o,n,c),Hv(o,r,c),!0}return!1}function _m(n,r,o,c){if(c={lane:2,revertLane:eg(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ed(n)){if(r)throw Error(i(479))}else r=Uf(n,o,c,2),r!==null&&yr(r,n,2)}function Ed(n){var r=n.alternate;return n===Vt||r!==null&&r===Vt}function Fv(n,r){wl=vd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function Hv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}var Cc={readContext:Os,use:xd,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useLayoutEffect:ns,useInsertionEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useSyncExternalStore:ns,useId:ns,useHostTransitionStatus:ns,useFormState:ns,useActionState:ns,useOptimistic:ns,useMemoCache:ns,useCacheRefresh:ns};Cc.useEffectEvent=ns;var qv={readContext:Os,use:xd,useCallback:function(n,r){return rr().memoizedState=[n,r===void 0?null:r],n},useContext:Os,useEffect:Sv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,kd(4194308,4,Rv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return kd(4194308,4,n,r)},useInsertionEffect:function(n,r){kd(4,2,n,r)},useMemo:function(n,r){var o=rr();r=r===void 0?null:r;var c=n();if(No){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=rr();if(o!==void 0){var f=o(r);if(No){Ct(!0);try{o(r)}finally{Ct(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=_E.bind(null,Vt,n),[c.memoizedState,n]},useRef:function(n){var r=rr();return n={current:n},r.memoizedState=n},useState:function(n){n=gm(n);var r=n.queue,o=zv.bind(null,Vt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:vm,useDeferredValue:function(n,r){var o=rr();return bm(o,n,r)},useTransition:function(){var n=gm(!1);return n=Pv.bind(null,Vt,n.queue,!0,!1),rr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Vt,f=rr();if(an){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Dn===null)throw Error(i(349));(Jt&127)!==0||dv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Sv(fv.bind(null,c,m,n),[n]),c.flags|=2048,_l(9,{destroy:void 0},hv.bind(null,c,m,o,r),null),o},useId:function(){var n=rr(),r=Dn.identifierPrefix;if(an){var o=Ti,c=Ei;o=(c&~(1<<32-It(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=bd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=gE++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:xm,useFormState:_v,useActionState:_v,useOptimistic:function(n){var r=rr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=_m.bind(null,Vt,!0,o),o.dispatch=r,[n,r]},useMemoCache:hm,useCacheRefresh:function(){return rr().memoizedState=xE.bind(null,Vt)},useEffectEvent:function(n){var r=rr(),o={impl:n};return r.memoizedState=o,function(){if((_n&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},km={readContext:Os,use:xd,useCallback:Dv,useContext:Os,useEffect:ym,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Av,useMemo:Mv,useReducer:_d,useRef:Tv,useState:function(){return _d(Ki)},useDebugValue:vm,useDeferredValue:function(n,r){var o=ds();return Lv(o,Nn.memoizedState,n,r)},useTransition:function(){var n=_d(Ki)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Tc(n),r]},useSyncExternalStore:uv,useId:Uv,useHostTransitionStatus:xm,useFormState:kv,useActionState:kv,useOptimistic:function(n,r){var o=ds();return pv(o,Nn,n,r)},useMemoCache:hm,useCacheRefresh:Bv};km.useEffectEvent=Cv;var $v={readContext:Os,use:xd,useCallback:Dv,useContext:Os,useEffect:ym,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Av,useMemo:Mv,useReducer:mm,useRef:Tv,useState:function(){return mm(Ki)},useDebugValue:vm,useDeferredValue:function(n,r){var o=ds();return Nn===null?bm(o,n,r):Lv(o,Nn.memoizedState,n,r)},useTransition:function(){var n=mm(Ki)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Tc(n),r]},useSyncExternalStore:uv,useId:Uv,useHostTransitionStatus:xm,useFormState:Ev,useActionState:Ev,useOptimistic:function(n,r){var o=ds();return Nn!==null?pv(o,Nn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:hm,useCacheRefresh:Bv};$v.useEffectEvent=Cv;function jm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Em={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Dr(),f=Ra(c);f.payload=r,o!=null&&(f.callback=o),r=Ia(n,f,c),r!==null&&(yr(r,n,c),_c(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Dr(),f=Ra(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ia(n,f,c),r!==null&&(yr(r,n,c),_c(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Dr(),c=Ra(o);c.tag=2,r!=null&&(c.callback=r),r=Ia(n,c,o),r!==null&&(yr(r,n,o),_c(r,n,o))}};function Wv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!mc(o,c)||!mc(f,m):!0}function Gv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Em.enqueueReplaceState(r,r.state,null)}function Ao(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Kv(n){sd(n)}function Yv(n){console.error(n)}function Qv(n){sd(n)}function Td(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Xv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Tm(n,r,o){return o=Ra(o),o.tag=3,o.payload={element:null},o.callback=function(){Td(n,r)},o}function Jv(n){return n=Ra(n),n.tag=3,n}function Zv(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Xv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Xv(r,o,c),typeof f!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function kE(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ml(r,o,f,!0),o=Nr.current,o!==null){switch(o.tag){case 31:case 13:return Wr===null?Vd():o.alternate===null&&ss===0&&(ss=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Xm(n,c,f)),!1;case 22:return o.flags|=65536,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Xm(n,c,f)),!1}throw Error(i(435,o.tag))}return Xm(n,c,f),Vd(),!1}if(an)return r=Nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==$f&&(n=Error(i(422),{cause:c}),yc(Fr(n,o)))):(c!==$f&&(r=Error(i(423),{cause:c}),yc(Fr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Fr(c,o),f=Tm(n.stateNode,c,f),nm(n,f),ss!==4&&(ss=2)),!1;var m=Error(i(520),{cause:c});if(m=Fr(m,o),Pc===null?Pc=[m]:Pc.push(m),ss!==4&&(ss=2),r===null)return!0;c=Fr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Tm(o.stateNode,c,n),nm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Va===null||!Va.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Jv(f),Zv(f,n,o,c),nm(o,f),!1}o=o.return}while(o!==null);return!1}var Sm=Error(i(461)),ys=!1;function Vs(n,r,o,c){r.child=n===null?sv(r,null,o,c):Co(r,n.child,o,c)}function e1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var j in c)j!=="ref"&&(x[j]=c[j])}else x=c;return jo(r),c=lm(n,r,o,x,m,f),j=cm(),n!==null&&!ys?(um(n,r,f),Yi(n,r,f)):(an&&j&&Hf(r),r.flags|=1,Vs(n,r,c,f),r.child)}function t1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Bf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,n1(n,r,m,c,f)):(n=od(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Lm(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:mc,o(x,c)&&n.ref===r.ref)return Yi(n,r,f)}return r.flags|=1,n=Hi(m,c),n.ref=r.ref,n.return=r,r.child=n}function n1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(mc(m,c)&&n.ref===r.ref)if(ys=!1,r.pendingProps=c=m,Lm(n,f))(n.flags&131072)!==0&&(ys=!0);else return r.lanes=n.lanes,Yi(n,r,f)}return Cm(n,r,o,c,f)}function s1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return r1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&dd(r,m!==null?m.cachePool:null),m!==null?av(r,m):rm(),ov(r);else return c=r.lanes=536870912,r1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(dd(r,m.cachePool),av(r,m),Ma(),r.memoizedState=null):(n!==null&&dd(r,null),rm(),Ma());return Vs(n,r,f,o),r.child}function Nc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function r1(n,r,o,c,f){var m=Jf();return m=m===null?null:{parent:gs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&dd(r,null),rm(),ov(r),n!==null&&ml(n,r,c,!0),r.childLanes=f,null}function Sd(n,r){return r=Nd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function i1(n,r,o){return Co(r,n.child,null,o),n=Sd(r,r.pendingProps),n.flags|=2,Ar(r),r.memoizedState=null,n}function jE(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(an){if(c.mode==="hidden")return n=Sd(r,c),r.lanes=536870912,Nc(null,n);if(am(r),(n=Un)?(n=yb(n,$r),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Ta!==null?{id:Ei,overflow:Ti}:null,retryLane:536870912,hydrationErrors:null},o=F0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Ca(r);return r.lanes=536870912,null}return Sd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(am(r),f)if(r.flags&256)r.flags&=-257,r=i1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ys||ml(n,r,o,!1),f=(o&n.childLanes)!==0,ys||f){if(c=Dn,c!==null&&(x=Me(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,wo(n,x),yr(c,n,x),Sm;Vd(),r=i1(n,r,o)}else n=m.treeContext,Un=Gr(x.nextSibling),Ps=r,an=!0,Sa=null,$r=!1,n!==null&&$0(r,n),r=Sd(r,c),r.flags|=4096;return r}return n=Hi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Cd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Cm(n,r,o,c,f){return jo(r),o=lm(n,r,o,c,void 0,f),c=cm(),n!==null&&!ys?(um(n,r,f),Yi(n,r,f)):(an&&c&&Hf(r),r.flags|=1,Vs(n,r,o,f),r.child)}function a1(n,r,o,c,f,m){return jo(r),r.updateQueue=null,o=cv(r,c,o,f),lv(n),c=cm(),n!==null&&!ys?(um(n,r,m),Yi(n,r,m)):(an&&c&&Hf(r),r.flags|=1,Vs(n,r,o,m),r.child)}function o1(n,r,o,c,f){if(jo(r),r.stateNode===null){var m=ul,x=o.contextType;typeof x=="object"&&x!==null&&(m=Os(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Em,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},em(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Os(x):ul,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(jm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Em.enqueueReplaceState(m,m.state,null),jc(r,c,m,f),kc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var j=r.memoizedProps,z=Ao(o,j);m.props=z;var ae=m.context,be=o.contextType;x=ul,typeof be=="object"&&be!==null&&(x=Os(be));var Ee=o.getDerivedStateFromProps;be=typeof Ee=="function"||typeof m.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,be||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j||ae!==x)&&Gv(r,m,c,x),Aa=!1;var de=r.memoizedState;m.state=de,jc(r,c,m,f),kc(),ae=r.memoizedState,j||de!==ae||Aa?(typeof Ee=="function"&&(jm(r,o,Ee,c),ae=r.memoizedState),(z=Aa||Wv(r,o,z,c,de,ae,x))?(be||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ae),m.props=c,m.state=ae,m.context=x,c=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,tm(n,r),x=r.memoizedProps,be=Ao(o,x),m.props=be,Ee=r.pendingProps,de=m.context,ae=o.contextType,z=ul,typeof ae=="object"&&ae!==null&&(z=Os(ae)),j=o.getDerivedStateFromProps,(ae=typeof j=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==Ee||de!==z)&&Gv(r,m,c,z),Aa=!1,de=r.memoizedState,m.state=de,jc(r,c,m,f),kc();var me=r.memoizedState;x!==Ee||de!==me||Aa||n!==null&&n.dependencies!==null&&cd(n.dependencies)?(typeof j=="function"&&(jm(r,o,j,c),me=r.memoizedState),(be=Aa||Wv(r,o,be,c,de,me,z)||n!==null&&n.dependencies!==null&&cd(n.dependencies))?(ae||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,me,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,me,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=me),m.props=c,m.state=me,m.context=z,c=be):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Cd(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=Co(r,n.child,null,f),r.child=Co(r,null,o,f)):Vs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Yi(n,r,f),n}function l1(n,r,o,c){return _o(),r.flags|=256,Vs(n,r,o,c),r.child}var Nm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Am(n){return{baseLanes:n,cachePool:X0()}}function Rm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Ir),n}function c1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(us.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(an){if(f?Da(r):Ma(),(n=Un)?(n=yb(n,$r),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Ta!==null?{id:Ei,overflow:Ti}:null,retryLane:536870912,hydrationErrors:null},o=F0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Ca(r);return fg(n)?r.lanes=32:r.lanes=536870912,null}var j=c.children;return c=c.fallback,f?(Ma(),f=r.mode,j=Nd({mode:"hidden",children:j},f),c=xo(c,f,o,null),j.return=r,c.return=r,j.sibling=c,r.child=j,c=r.child,c.memoizedState=Am(o),c.childLanes=Rm(n,x,o),r.memoizedState=Nm,Nc(null,c)):(Da(r),Im(r,j))}var z=n.memoizedState;if(z!==null&&(j=z.dehydrated,j!==null)){if(m)r.flags&256?(Da(r),r.flags&=-257,r=Dm(n,r,o)):r.memoizedState!==null?(Ma(),r.child=n.child,r.flags|=128,r=null):(Ma(),j=c.fallback,f=r.mode,c=Nd({mode:"visible",children:c.children},f),j=xo(j,f,o,null),j.flags|=2,c.return=r,j.return=r,c.sibling=j,r.child=c,Co(r,n.child,null,o),c=r.child,c.memoizedState=Am(o),c.childLanes=Rm(n,x,o),r.memoizedState=Nm,r=Nc(null,c));else if(Da(r),fg(j)){if(x=j.nextSibling&&j.nextSibling.dataset,x)var ae=x.dgst;x=ae,c=Error(i(419)),c.stack="",c.digest=x,yc({value:c,source:null,stack:null}),r=Dm(n,r,o)}else if(ys||ml(n,r,o,!1),x=(o&n.childLanes)!==0,ys||x){if(x=Dn,x!==null&&(c=Me(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,wo(n,c),yr(x,n,c),Sm;hg(j)||Vd(),r=Dm(n,r,o)}else hg(j)?(r.flags|=192,r.child=n.child,r=null):(n=z.treeContext,Un=Gr(j.nextSibling),Ps=r,an=!0,Sa=null,$r=!1,n!==null&&$0(r,n),r=Im(r,c.children),r.flags|=4096);return r}return f?(Ma(),j=c.fallback,f=r.mode,z=n.child,ae=z.sibling,c=Hi(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,ae!==null?j=Hi(ae,j):(j=xo(j,f,o,null),j.flags|=2),j.return=r,c.return=r,c.sibling=j,r.child=c,Nc(null,c),c=r.child,j=n.child.memoizedState,j===null?j=Am(o):(f=j.cachePool,f!==null?(z=gs._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=X0(),j={baseLanes:j.baseLanes|o,cachePool:f}),c.memoizedState=j,c.childLanes=Rm(n,x,o),r.memoizedState=Nm,Nc(n.child,c)):(Da(r),o=n.child,n=o.sibling,o=Hi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Im(n,r){return r=Nd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Nd(n,r){return n=Cr(22,n,null,r),n.lanes=0,n}function Dm(n,r,o){return Co(r,n.child,null,o),n=Im(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function u1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Kf(n.return,r,o)}function Mm(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function d1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=us.current,j=(x&2)!==0;if(j?(x=x&1|2,r.flags|=128):x&=1,je(us,x),Vs(n,r,c,o),c=an?pc:0,!j&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&u1(n,o,r);else if(n.tag===19)u1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&yd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Mm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&yd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Mm(r,!0,o,null,m,c);break;case"together":Mm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Yi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Oa|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ml(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Hi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Hi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Lm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&cd(n)))}function EE(n,r,o){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),Na(r,gs,n.memoizedState.cache),_o();break;case 27:case 5:$t(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:Na(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,am(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Da(r),r.flags|=128,null):(o&r.child.childLanes)!==0?c1(n,r,o):(Da(r),n=Yi(n,r,o),n!==null?n.sibling:null);Da(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ml(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return d1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),je(us,us.current),c)break;return null;case 22:return r.lanes=0,s1(n,r,o,r.pendingProps);case 24:Na(r,gs,n.memoizedState.cache)}return Yi(n,r,o)}function h1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ys=!0;else{if(!Lm(n,o)&&(r.flags&128)===0)return ys=!1,EE(n,r,o);ys=(n.flags&131072)!==0}else ys=!1,an&&(r.flags&1048576)!==0&&q0(r,pc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=To(r.elementType),r.type=n,typeof n=="function")Bf(n)?(c=Ao(n,c),r.tag=1,r=o1(null,r,n,c,o)):(r.tag=0,r=Cm(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===pe){r.tag=11,r=e1(null,r,n,c,o);break e}else if(f===M){r.tag=14,r=t1(null,r,n,c,o);break e}}throw r=Pe(n)||n,Error(i(306,r,""))}}return r;case 0:return Cm(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Ao(c,r.pendingProps),o1(n,r,c,f,o);case 3:e:{if(Qe(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,tm(n,r),jc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,Na(r,gs,c),c!==m.cache&&Yf(r,[gs],o,!0),kc(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=l1(n,r,c,o);break e}else if(c!==f){f=Fr(Error(i(424)),r),yc(f),r=l1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Un=Gr(n.firstChild),Ps=r,an=!0,Sa=null,$r=!0,o=sv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(_o(),c===f){r=Yi(n,r,o);break e}Vs(n,r,c,o)}r=r.child}return r;case 26:return Cd(n,r),n===null?(o=kb(r.type,null,r.pendingProps,null))?r.memoizedState=o:an||(o=r.type,n=r.pendingProps,c=$d(Ve.current).createElement(o),c[Nt]=r,c[St]=n,Us(c,o,n),wn(c),r.stateNode=c):r.memoizedState=kb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return $t(r),n===null&&an&&(c=r.stateNode=wb(r.type,r.pendingProps,Ve.current),Ps=r,$r=!0,f=Un,Fa(r.type)?(mg=f,Un=Gr(c.firstChild)):Un=f),Vs(n,r,r.pendingProps.children,o),Cd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&an&&((f=c=Un)&&(c=tT(c,r.type,r.pendingProps,$r),c!==null?(r.stateNode=c,Ps=r,Un=Gr(c.firstChild),$r=!1,f=!0):f=!1),f||Ca(r)),$t(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,cg(f,m)?c=null:x!==null&&cg(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=lm(n,r,pE,null,null,o),qc._currentValue=f),Cd(n,r),Vs(n,r,c,o),r.child;case 6:return n===null&&an&&((n=o=Un)&&(o=nT(o,r.pendingProps,$r),o!==null?(r.stateNode=o,Ps=r,Un=null,n=!0):n=!1),n||Ca(r)),null;case 13:return c1(n,r,o);case 4:return Qe(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=Co(r,null,c,o):Vs(n,r,c,o),r.child;case 11:return e1(n,r,r.type,r.pendingProps,o);case 7:return Vs(n,r,r.pendingProps,o),r.child;case 8:return Vs(n,r,r.pendingProps.children,o),r.child;case 12:return Vs(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Na(r,r.type,c.value),Vs(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,jo(r),f=Os(f),c=c(f),r.flags|=1,Vs(n,r,c,o),r.child;case 14:return t1(n,r,r.type,r.pendingProps,o);case 15:return n1(n,r,r.type,r.pendingProps,o);case 19:return d1(n,r,o);case 31:return jE(n,r,o);case 22:return s1(n,r,o,r.pendingProps);case 24:return jo(r),c=Os(gs),n===null?(f=Jf(),f===null&&(f=Dn,m=Qf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},em(r),Na(r,gs,f)):((n.lanes&o)!==0&&(tm(n,r),jc(r,null,null,o),kc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Na(r,gs,c)):(c=m.cache,Na(r,gs,c),c!==f.cache&&Yf(r,[gs],o,!0))),Vs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Qi(n){n.flags|=4}function Pm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(U1())n.flags|=8192;else throw So=fd,Zf}else n.flags&=-16777217}function f1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Cb(r))if(U1())n.flags|=8192;else throw So=fd,Zf}function Ad(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?lt():536870912,n.lanes|=r,Tl|=r)}function Ac(n,r){if(!an)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Bn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function TE(n,r,o){var c=r.pendingProps;switch(qf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(r),null;case 1:return Bn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Wi(gs),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(fl(r)?Qi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Wf())),Bn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Qi(r),m!==null?(Bn(r),f1(r,m)):(Bn(r),Pm(r,f,null,c,o))):m?m!==n.memoizedState?(Qi(r),Bn(r),f1(r,m)):(Bn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Qi(r),Bn(r),Pm(r,f,n,c,o)),null;case 27:if(Rt(r),o=Ve.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}n=Se.current,fl(r)?W0(r):(n=wb(f,c,o),r.stateNode=n,Qi(r))}return Bn(r),null;case 5:if(Rt(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}if(m=Se.current,fl(r))W0(r);else{var x=$d(Ve.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[Nt]=r,m[St]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Us(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Qi(r)}}return Bn(r),Pm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ve.current,fl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Ps,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Nt]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||cb(n.nodeValue,o)),n||Ca(r,!0)}else n=$d(n).createTextNode(c),n[Nt]=r,r.stateNode=n}return Bn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=fl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Nt]=r}else _o(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),n=!1}else o=Wf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Ar(r),r):(Ar(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Bn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=fl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Nt]=r}else _o(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),f=!1}else f=Wf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Ar(r),r):(Ar(r),null)}return Ar(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Ad(r,r.updateQueue),Bn(r),null);case 4:return Je(),n===null&&rg(r.stateNode.containerInfo),Bn(r),null;case 10:return Wi(r.type),Bn(r),null;case 19:if(ce(us),c=r.memoizedState,c===null)return Bn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Ac(c,!1);else{if(ss!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=yd(n),m!==null){for(r.flags|=128,Ac(c,!1),n=m.updateQueue,r.updateQueue=n,Ad(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)z0(o,n),o=o.sibling;return je(us,us.current&1|2),an&&qi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&gt()>Ld&&(r.flags|=128,f=!0,Ac(c,!1),r.lanes=4194304)}else{if(!f)if(n=yd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Ad(r,n),Ac(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!an)return Bn(r),null}else 2*gt()-c.renderingStartTime>Ld&&o!==536870912&&(r.flags|=128,f=!0,Ac(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=gt(),n.sibling=null,o=us.current,je(us,f?o&1|2:o&1),an&&qi(r,c.treeForkCount),n):(Bn(r),null);case 22:case 23:return Ar(r),im(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Bn(r),r.subtreeFlags&6&&(r.flags|=8192)):Bn(r),o=r.updateQueue,o!==null&&Ad(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&ce(Eo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Wi(gs),Bn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function SE(n,r){switch(qf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Wi(gs),Je(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Rt(r),null;case 31:if(r.memoizedState!==null){if(Ar(r),r.alternate===null)throw Error(i(340));_o()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Ar(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));_o()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ce(us),null;case 4:return Je(),null;case 10:return Wi(r.type),null;case 22:case 23:return Ar(r),im(),n!==null&&ce(Eo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Wi(gs),null;case 25:return null;default:return null}}function m1(n,r){switch(qf(r),r.tag){case 3:Wi(gs),Je();break;case 26:case 27:case 5:Rt(r);break;case 4:Je();break;case 31:r.memoizedState!==null&&Ar(r);break;case 13:Ar(r);break;case 19:ce(us);break;case 10:Wi(r.type);break;case 22:case 23:Ar(r),im(),n!==null&&ce(Eo);break;case 24:Wi(gs)}}function Rc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(j){Tn(r,r.return,j)}}function La(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,j=x.destroy;if(j!==void 0){x.destroy=void 0,f=r;var z=o,ae=j;try{ae()}catch(be){Tn(f,z,be)}}}c=c.next}while(c!==m)}}catch(be){Tn(r,r.return,be)}}function g1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{iv(r,o)}catch(c){Tn(n,n.return,c)}}}function p1(n,r,o){o.props=Ao(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){Tn(n,r,c)}}function Ic(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){Tn(n,r,f)}}function Si(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Tn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Tn(n,r,f)}else o.current=null}function y1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Tn(n,n.return,f)}}function Om(n,r,o){try{var c=n.stateNode;YE(c,n.type,o,r),c[St]=r}catch(f){Tn(n,n.return,f)}}function v1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Fa(n.type)||n.tag===4}function Vm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||v1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Fa(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Um(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=qs));else if(c!==4&&(c===27&&Fa(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Um(n,r,o),n=n.sibling;n!==null;)Um(n,r,o),n=n.sibling}function Rd(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Fa(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Rd(n,r,o),n=n.sibling;n!==null;)Rd(n,r,o),n=n.sibling}function b1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Us(r,c,o),r[Nt]=n,r[St]=o}catch(m){Tn(n,n.return,m)}}var Xi=!1,vs=!1,Bm=!1,w1=typeof WeakSet=="function"?WeakSet:Set,Rs=null;function CE(n,r){if(n=n.containerInfo,og=Jd,n=I0(n),Df(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,j=-1,z=-1,ae=0,be=0,Ee=n,de=null;t:for(;;){for(var me;Ee!==o||f!==0&&Ee.nodeType!==3||(j=x+f),Ee!==m||c!==0&&Ee.nodeType!==3||(z=x+c),Ee.nodeType===3&&(x+=Ee.nodeValue.length),(me=Ee.firstChild)!==null;)de=Ee,Ee=me;for(;;){if(Ee===n)break t;if(de===o&&++ae===f&&(j=x),de===m&&++be===c&&(z=x),(me=Ee.nextSibling)!==null)break;Ee=de,de=Ee.parentNode}Ee=me}o=j===-1||z===-1?null:{start:j,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(lg={focusedElem:n,selectionRange:o},Jd=!1,Rs=r;Rs!==null;)if(r=Rs,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rs=n;else for(;Rs!==null;){switch(r=Rs,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Ze=Ao(o.type,f);n=c.getSnapshotBeforeUpdate(Ze,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(bt){Tn(o,o.return,bt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)dg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":dg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Rs=n;break}Rs=r.return}}function x1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Zi(n,o),c&4&&Rc(5,o);break;case 1:if(Zi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){Tn(o,o.return,x)}else{var f=Ao(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){Tn(o,o.return,x)}}c&64&&g1(o),c&512&&Ic(o,o.return);break;case 3:if(Zi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{iv(n,r)}catch(x){Tn(o,o.return,x)}}break;case 27:r===null&&c&4&&b1(o);case 26:case 5:Zi(n,o),r===null&&c&4&&y1(o),c&512&&Ic(o,o.return);break;case 12:Zi(n,o);break;case 31:Zi(n,o),c&4&&j1(n,o);break;case 13:Zi(n,o),c&4&&E1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=OE.bind(null,o),sT(n,o))));break;case 22:if(c=o.memoizedState!==null||Xi,!c){r=r!==null&&r.memoizedState!==null||vs,f=Xi;var m=vs;Xi=c,(vs=r)&&!m?ea(n,o,(o.subtreeFlags&8772)!==0):Zi(n,o),Xi=f,vs=m}break;case 30:break;default:Zi(n,o)}}function _1(n){var r=n.alternate;r!==null&&(n.alternate=null,_1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&hr(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $n=null,fr=!1;function Ji(n,r,o){for(o=o.child;o!==null;)k1(n,r,o),o=o.sibling}function k1(n,r,o){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(un,o)}catch{}switch(o.tag){case 26:vs||Si(o,r),Ji(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:vs||Si(o,r);var c=$n,f=fr;Fa(o.type)&&($n=o.stateNode,fr=!1),Ji(n,r,o),zc(o.stateNode),$n=c,fr=f;break;case 5:vs||Si(o,r);case 6:if(c=$n,f=fr,$n=null,Ji(n,r,o),$n=c,fr=f,$n!==null)if(fr)try{($n.nodeType===9?$n.body:$n.nodeName==="HTML"?$n.ownerDocument.body:$n).removeChild(o.stateNode)}catch(m){Tn(o,r,m)}else try{$n.removeChild(o.stateNode)}catch(m){Tn(o,r,m)}break;case 18:$n!==null&&(fr?(n=$n,gb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Ml(n)):gb($n,o.stateNode));break;case 4:c=$n,f=fr,$n=o.stateNode.containerInfo,fr=!0,Ji(n,r,o),$n=c,fr=f;break;case 0:case 11:case 14:case 15:La(2,o,r),vs||La(4,o,r),Ji(n,r,o);break;case 1:vs||(Si(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&p1(o,r,c)),Ji(n,r,o);break;case 21:Ji(n,r,o);break;case 22:vs=(c=vs)||o.memoizedState!==null,Ji(n,r,o),vs=c;break;default:Ji(n,r,o)}}function j1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ml(n)}catch(o){Tn(r,r.return,o)}}}function E1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ml(n)}catch(o){Tn(r,r.return,o)}}function NE(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new w1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new w1),r;default:throw Error(i(435,n.tag))}}function Id(n,r){var o=NE(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=VE.bind(null,n,c);c.then(f,f)}})}function mr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,j=x;e:for(;j!==null;){switch(j.tag){case 27:if(Fa(j.type)){$n=j.stateNode,fr=!1;break e}break;case 5:$n=j.stateNode,fr=!1;break e;case 3:case 4:$n=j.stateNode.containerInfo,fr=!0;break e}j=j.return}if($n===null)throw Error(i(160));k1(m,x,f),$n=null,fr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)T1(r,n),r=r.sibling}var ui=null;function T1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:mr(r,n),gr(n),c&4&&(La(3,n,n.return),Rc(3,n),La(5,n,n.return));break;case 1:mr(r,n),gr(n),c&512&&(vs||o===null||Si(o,o.return)),c&64&&Xi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ui;if(mr(r,n),gr(n),c&512&&(vs||o===null||Si(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[js]||m[Nt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,c,o),m[Nt]=n,wn(m),c=m;break e;case"link":var x=Tb("link","href",f).get(c+(o.href||""));if(x){for(var j=0;j<x.length;j++)if(m=x[j],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;case"meta":if(x=Tb("meta","content",f).get(c+(o.content||""))){for(j=0;j<x.length;j++)if(m=x[j],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Nt]=n,wn(m),c=m}n.stateNode=c}else Sb(f,n.type,n.stateNode);else n.stateNode=Eb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Sb(f,n.type,n.stateNode):Eb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Om(n,n.memoizedProps,o.memoizedProps)}break;case 27:mr(r,n),gr(n),c&512&&(vs||o===null||Si(o,o.return)),o!==null&&c&4&&Om(n,n.memoizedProps,o.memoizedProps);break;case 5:if(mr(r,n),gr(n),c&512&&(vs||o===null||Si(o,o.return)),n.flags&32){f=n.stateNode;try{Ns(f,"")}catch(Ze){Tn(n,n.return,Ze)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Om(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Bm=!0);break;case 6:if(mr(r,n),gr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Ze){Tn(n,n.return,Ze)}}break;case 3:if(Kd=null,f=ui,ui=Wd(r.containerInfo),mr(r,n),ui=f,gr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ml(r.containerInfo)}catch(Ze){Tn(n,n.return,Ze)}Bm&&(Bm=!1,S1(n));break;case 4:c=ui,ui=Wd(n.stateNode.containerInfo),mr(r,n),gr(n),ui=c;break;case 12:mr(r,n),gr(n);break;case 31:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 13:mr(r,n),gr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Md=gt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 22:f=n.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ae=Xi,be=vs;if(Xi=ae||f,vs=be||z,mr(r,n),vs=be,Xi=ae,gr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||Xi||vs||Ro(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{j=z.stateNode;var Ee=z.memoizedProps.style,de=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;j.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Ze){Tn(z,z.return,Ze)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(Ze){Tn(z,z.return,Ze)}}}else if(r.tag===18){if(o===null){z=r;try{var me=z.stateNode;f?pb(me,!0):pb(z.stateNode,!1)}catch(Ze){Tn(z,z.return,Ze)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Id(n,o))));break;case 19:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 30:break;case 21:break;default:mr(r,n),gr(n)}}function gr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(v1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Vm(n);Rd(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Ns(x,""),o.flags&=-33);var j=Vm(n);Rd(n,j,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ae=Vm(n);Um(n,ae,z);break;default:throw Error(i(161))}}catch(be){Tn(n,n.return,be)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function S1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;S1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Zi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)x1(n,r.alternate,r),r=r.sibling}function Ro(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:La(4,r,r.return),Ro(r);break;case 1:Si(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&p1(r,r.return,o),Ro(r);break;case 27:zc(r.stateNode);case 26:case 5:Si(r,r.return),Ro(r);break;case 22:r.memoizedState===null&&Ro(r);break;case 30:Ro(r);break;default:Ro(r)}n=n.sibling}}function ea(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:ea(f,m,o),Rc(4,m);break;case 1:if(ea(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ae){Tn(c,c.return,ae)}if(c=m,f=c.updateQueue,f!==null){var j=c.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)rv(z[f],j)}catch(ae){Tn(c,c.return,ae)}}o&&x&64&&g1(m),Ic(m,m.return);break;case 27:b1(m);case 26:case 5:ea(f,m,o),o&&c===null&&x&4&&y1(m),Ic(m,m.return);break;case 12:ea(f,m,o);break;case 31:ea(f,m,o),o&&x&4&&j1(f,m);break;case 13:ea(f,m,o),o&&x&4&&E1(f,m);break;case 22:m.memoizedState===null&&ea(f,m,o),Ic(m,m.return);break;case 30:break;default:ea(f,m,o)}r=r.sibling}}function zm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&vc(o))}function Fm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n))}function di(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)C1(n,r,o,c),r=r.sibling}function C1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:di(n,r,o,c),f&2048&&Rc(9,r);break;case 1:di(n,r,o,c);break;case 3:di(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n)));break;case 12:if(f&2048){di(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,j=m.onPostCommit;typeof j=="function"&&j(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(z){Tn(r,r.return,z)}}else di(n,r,o,c);break;case 31:di(n,r,o,c);break;case 13:di(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?di(n,r,o,c):Dc(n,r):m._visibility&2?di(n,r,o,c):(m._visibility|=2,kl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&zm(x,r);break;case 24:di(n,r,o,c),f&2048&&Fm(r.alternate,r);break;default:di(n,r,o,c)}}function kl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,j=o,z=c,ae=x.flags;switch(x.tag){case 0:case 11:case 15:kl(m,x,j,z,f),Rc(8,x);break;case 23:break;case 22:var be=x.stateNode;x.memoizedState!==null?be._visibility&2?kl(m,x,j,z,f):Dc(m,x):(be._visibility|=2,kl(m,x,j,z,f)),f&&ae&2048&&zm(x.alternate,x);break;case 24:kl(m,x,j,z,f),f&&ae&2048&&Fm(x.alternate,x);break;default:kl(m,x,j,z,f)}r=r.sibling}}function Dc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Dc(o,c),f&2048&&zm(c.alternate,c);break;case 24:Dc(o,c),f&2048&&Fm(c.alternate,c);break;default:Dc(o,c)}r=r.sibling}}var Mc=8192;function jl(n,r,o){if(n.subtreeFlags&Mc)for(n=n.child;n!==null;)N1(n,r,o),n=n.sibling}function N1(n,r,o){switch(n.tag){case 26:jl(n,r,o),n.flags&Mc&&n.memoizedState!==null&&gT(o,ui,n.memoizedState,n.memoizedProps);break;case 5:jl(n,r,o);break;case 3:case 4:var c=ui;ui=Wd(n.stateNode.containerInfo),jl(n,r,o),ui=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Mc,Mc=16777216,jl(n,r,o),Mc=c):jl(n,r,o));break;default:jl(n,r,o)}}function A1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Lc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,I1(c,n)}A1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)R1(n),n=n.sibling}function R1(n){switch(n.tag){case 0:case 11:case 15:Lc(n),n.flags&2048&&La(9,n,n.return);break;case 3:Lc(n);break;case 12:Lc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Dd(n)):Lc(n);break;default:Lc(n)}}function Dd(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,I1(c,n)}A1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:La(8,r,r.return),Dd(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Dd(r));break;default:Dd(r)}n=n.sibling}}function I1(n,r){for(;Rs!==null;){var o=Rs;switch(o.tag){case 0:case 11:case 15:La(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:vc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Rs=c;else e:for(o=n;Rs!==null;){c=Rs;var f=c.sibling,m=c.return;if(_1(c),c===o){Rs=null;break e}if(f!==null){f.return=m,Rs=f;break e}Rs=m}}}var AE={getCacheForType:function(n){var r=Os(gs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Os(gs).controller.signal}},RE=typeof WeakMap=="function"?WeakMap:Map,_n=0,Dn=null,Kt=null,Jt=0,En=0,Rr=null,Pa=!1,El=!1,Hm=!1,ta=0,ss=0,Oa=0,Io=0,qm=0,Ir=0,Tl=0,Pc=null,pr=null,$m=!1,Md=0,D1=0,Ld=1/0,Pd=null,Va=null,Es=0,Ua=null,Sl=null,na=0,Wm=0,Gm=null,M1=null,Oc=0,Km=null;function Dr(){return(_n&2)!==0&&Jt!==0?Jt&-Jt:Z.T!==null?eg():rt()}function L1(){if(Ir===0)if((Jt&536870912)===0||an){var n=Ie;Ie<<=1,(Ie&3932160)===0&&(Ie=262144),Ir=n}else Ir=536870912;return n=Nr.current,n!==null&&(n.flags|=32),Ir}function yr(n,r,o){(n===Dn&&(En===2||En===9)||n.cancelPendingCommit!==null)&&(Cl(n,0),Ba(n,Jt,Ir,!1)),hn(n,o),((_n&2)===0||n!==Dn)&&(n===Dn&&((_n&2)===0&&(Io|=o),ss===4&&Ba(n,Jt,Ir,!1)),Ci(n))}function P1(n,r,o){if((_n&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Dt(n,r),f=c?ME(n,r):Qm(n,r,!0),m=c;do{if(f===0){El&&!c&&Ba(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!IE(o)){f=Qm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var j=n;f=Pc;var z=j.current.memoizedState.isDehydrated;if(z&&(Cl(j,x).flags|=256),x=Qm(j,x,!1),x!==2){if(Hm&&!z){j.errorRecoveryDisabledLanes|=m,Io|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Cl(n,0),Ba(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ba(c,r,Ir,!Pa);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Md+300-gt(),10<f)){if(Ba(c,r,Ir,!Pa),Le(c,0,!0)!==0)break e;na=r,c.timeoutHandle=fb(O1.bind(null,c,o,pr,Pd,$m,r,Ir,Io,Tl,Pa,m,"Throttled",-0,0),f);break e}O1(c,o,pr,Pd,$m,r,Ir,Io,Tl,Pa,m,null,-0,0)}}break}while(!0);Ci(n)}function O1(n,r,o,c,f,m,x,j,z,ae,be,Ee,de,me){if(n.timeoutHandle=-1,Ee=r.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qs},N1(r,m,Ee);var Ze=(m&62914560)===m?Md-gt():(m&4194048)===m?D1-gt():0;if(Ze=pT(Ee,Ze),Ze!==null){na=m,n.cancelPendingCommit=Ze($1.bind(null,n,r,m,o,c,f,x,j,z,be,Ee,null,de,me)),Ba(n,m,x,!ae);return}}$1(n,r,m,o,c,f,x,j,z)}function IE(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Sr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ba(n,r,o,c){r&=~qm,r&=~Io,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-It(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&ms(n,o,r)}function Od(){return(_n&6)===0?(Vc(0),!1):!0}function Ym(){if(Kt!==null){if(En===0)var n=Kt.return;else n=Kt,$i=ko=null,dm(n),vl=null,wc=0,n=Kt;for(;n!==null;)m1(n.alternate,n),n=n.return;Kt=null}}function Cl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,JE(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),na=0,Ym(),Dn=n,Kt=o=Hi(n.current,null),Jt=r,En=0,Rr=null,Pa=!1,El=Dt(n,r),Hm=!1,Tl=Ir=qm=Io=Oa=ss=0,pr=Pc=null,$m=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-It(c),m=1<<f;r|=n[f],c&=~m}return ta=r,rd(),o}function V1(n,r){Vt=null,Z.H=Cc,r===yl||r===hd?(r=ev(),En=3):r===Zf?(r=ev(),En=4):En=r===Sm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Rr=r,Kt===null&&(ss=1,Td(n,Fr(r,n.current)))}function U1(){var n=Nr.current;return n===null?!0:(Jt&4194048)===Jt?Wr===null:(Jt&62914560)===Jt||(Jt&536870912)!==0?n===Wr:!1}function B1(){var n=Z.H;return Z.H=Cc,n===null?Cc:n}function z1(){var n=Z.A;return Z.A=AE,n}function Vd(){ss=4,Pa||(Jt&4194048)!==Jt&&Nr.current!==null||(El=!0),(Oa&134217727)===0&&(Io&134217727)===0||Dn===null||Ba(Dn,Jt,Ir,!1)}function Qm(n,r,o){var c=_n;_n|=2;var f=B1(),m=z1();(Dn!==n||Jt!==r)&&(Pd=null,Cl(n,r)),r=!1;var x=ss;e:do try{if(En!==0&&Kt!==null){var j=Kt,z=Rr;switch(En){case 8:Ym(),x=6;break e;case 3:case 2:case 9:case 6:Nr.current===null&&(r=!0);var ae=En;if(En=0,Rr=null,Nl(n,j,z,ae),o&&El){x=0;break e}break;default:ae=En,En=0,Rr=null,Nl(n,j,z,ae)}}DE(),x=ss;break}catch(be){V1(n,be)}while(!0);return r&&n.shellSuspendCounter++,$i=ko=null,_n=c,Z.H=f,Z.A=m,Kt===null&&(Dn=null,Jt=0,rd()),x}function DE(){for(;Kt!==null;)F1(Kt)}function ME(n,r){var o=_n;_n|=2;var c=B1(),f=z1();Dn!==n||Jt!==r?(Pd=null,Ld=gt()+500,Cl(n,r)):El=Dt(n,r);e:do try{if(En!==0&&Kt!==null){r=Kt;var m=Rr;t:switch(En){case 1:En=0,Rr=null,Nl(n,r,m,1);break;case 2:case 9:if(J0(m)){En=0,Rr=null,H1(r);break}r=function(){En!==2&&En!==9||Dn!==n||(En=7),Ci(n)},m.then(r,r);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:J0(m)?(En=0,Rr=null,H1(r)):(En=0,Rr=null,Nl(n,r,m,7));break;case 5:var x=null;switch(Kt.tag){case 26:x=Kt.memoizedState;case 5:case 27:var j=Kt;if(x?Cb(x):j.stateNode.complete){En=0,Rr=null;var z=j.sibling;if(z!==null)Kt=z;else{var ae=j.return;ae!==null?(Kt=ae,Ud(ae)):Kt=null}break t}}En=0,Rr=null,Nl(n,r,m,5);break;case 6:En=0,Rr=null,Nl(n,r,m,6);break;case 8:Ym(),ss=6;break e;default:throw Error(i(462))}}LE();break}catch(be){V1(n,be)}while(!0);return $i=ko=null,Z.H=c,Z.A=f,_n=o,Kt!==null?0:(Dn=null,Jt=0,rd(),ss)}function LE(){for(;Kt!==null&&!it();)F1(Kt)}function F1(n){var r=h1(n.alternate,n,ta);n.memoizedProps=n.pendingProps,r===null?Ud(n):Kt=r}function H1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=a1(o,r,r.pendingProps,r.type,void 0,Jt);break;case 11:r=a1(o,r,r.pendingProps,r.type.render,r.ref,Jt);break;case 5:dm(r);default:m1(o,r),r=Kt=z0(r,ta),r=h1(o,r,ta)}n.memoizedProps=n.pendingProps,r===null?Ud(n):Kt=r}function Nl(n,r,o,c){$i=ko=null,dm(r),vl=null,wc=0;var f=r.return;try{if(kE(n,f,r,o,Jt)){ss=1,Td(n,Fr(o,n.current)),Kt=null;return}}catch(m){if(f!==null)throw Kt=f,m;ss=1,Td(n,Fr(o,n.current)),Kt=null;return}r.flags&32768?(an||c===1?n=!0:El||(Jt&536870912)!==0?n=!1:(Pa=n=!0,(c===2||c===9||c===3||c===6)&&(c=Nr.current,c!==null&&c.tag===13&&(c.flags|=16384))),q1(r,n)):Ud(r)}function Ud(n){var r=n;do{if((r.flags&32768)!==0){q1(r,Pa);return}n=r.return;var o=TE(r.alternate,r,ta);if(o!==null){Kt=o;return}if(r=r.sibling,r!==null){Kt=r;return}Kt=r=n}while(r!==null);ss===0&&(ss=5)}function q1(n,r){do{var o=SE(n.alternate,n);if(o!==null){o.flags&=32767,Kt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Kt=n;return}Kt=n=o}while(n!==null);ss=6,Kt=null}function $1(n,r,o,c,f,m,x,j,z){n.cancelPendingCommit=null;do Bd();while(Es!==0);if((_n&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Vf,On(n,o,m,x,j,z),n===Dn&&(Kt=Dn=null,Jt=0),Sl=r,Ua=n,na=o,Wm=m,Gm=f,M1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,UE(sn,function(){return Q1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,f=Te.p,Te.p=2,x=_n,_n|=4;try{CE(n,r,o)}finally{_n=x,Te.p=f,Z.T=c}}Es=1,W1(),G1(),K1()}}function W1(){if(Es===1){Es=0;var n=Ua,r=Sl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=Z.T,Z.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{T1(r,n);var m=lg,x=I0(n.containerInfo),j=m.focusedElem,z=m.selectionRange;if(x!==j&&j&&j.ownerDocument&&R0(j.ownerDocument.documentElement,j)){if(z!==null&&Df(j)){var ae=z.start,be=z.end;if(be===void 0&&(be=ae),"selectionStart"in j)j.selectionStart=ae,j.selectionEnd=Math.min(be,j.value.length);else{var Ee=j.ownerDocument||document,de=Ee&&Ee.defaultView||window;if(de.getSelection){var me=de.getSelection(),Ze=j.textContent.length,bt=Math.min(z.start,Ze),Rn=z.end===void 0?bt:Math.min(z.end,Ze);!me.extend&&bt>Rn&&(x=Rn,Rn=bt,bt=x);var J=A0(j,bt),W=A0(j,Rn);if(J&&W&&(me.rangeCount!==1||me.anchorNode!==J.node||me.anchorOffset!==J.offset||me.focusNode!==W.node||me.focusOffset!==W.offset)){var ie=Ee.createRange();ie.setStart(J.node,J.offset),me.removeAllRanges(),bt>Rn?(me.addRange(ie),me.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),me.addRange(ie))}}}}for(Ee=[],me=j;me=me.parentNode;)me.nodeType===1&&Ee.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Ee.length;j++){var xe=Ee[j];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}Jd=!!og,lg=og=null}finally{_n=f,Te.p=c,Z.T=o}}n.current=r,Es=2}}function G1(){if(Es===2){Es=0;var n=Ua,r=Sl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=Z.T,Z.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{x1(n,r.alternate,r)}finally{_n=f,Te.p=c,Z.T=o}}Es=3}}function K1(){if(Es===4||Es===3){Es=0,yt();var n=Ua,r=Sl,o=na,c=M1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,Sl=Ua=null,Y1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Va=null),ct(o),r=r.stateNode,Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(un,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Z.T,f=Te.p,Te.p=2,Z.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var j=c[x];m(j.value,{componentStack:j.stack})}}finally{Z.T=r,Te.p=f}}(na&3)!==0&&Bd(),Ci(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Km?Oc++:(Oc=0,Km=n):Oc=0,Vc(0)}}function Y1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,vc(r)))}function Bd(){return W1(),G1(),K1(),Q1()}function Q1(){if(Es!==5)return!1;var n=Ua,r=Wm;Wm=0;var o=ct(na),c=Z.T,f=Te.p;try{Te.p=32>o?32:o,Z.T=null,o=Gm,Gm=null;var m=Ua,x=na;if(Es=0,Sl=Ua=null,na=0,(_n&6)!==0)throw Error(i(331));var j=_n;if(_n|=4,R1(m.current),C1(m,m.current,x,o),_n=j,Vc(0,!1),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(un,m)}catch{}return!0}finally{Te.p=f,Z.T=c,Y1(n,r)}}function X1(n,r,o){r=Fr(o,r),r=Tm(n.stateNode,r,2),n=Ia(n,r,2),n!==null&&(hn(n,2),Ci(n))}function Tn(n,r,o){if(n.tag===3)X1(n,n,o);else for(;r!==null;){if(r.tag===3){X1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Va===null||!Va.has(c))){n=Fr(o,n),o=Jv(2),c=Ia(r,o,2),c!==null&&(Zv(o,c,r,n),hn(c,2),Ci(c));break}}r=r.return}}function Xm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new RE;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Hm=!0,f.add(o),n=PE.bind(null,n,r,o),r.then(n,n))}function PE(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Dn===n&&(Jt&o)===o&&(ss===4||ss===3&&(Jt&62914560)===Jt&&300>gt()-Md?(_n&2)===0&&Cl(n,0):qm|=o,Tl===Jt&&(Tl=0)),Ci(n)}function J1(n,r){r===0&&(r=lt()),n=wo(n,r),n!==null&&(hn(n,r),Ci(n))}function OE(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),J1(n,o)}function VE(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),J1(n,o)}function UE(n,r){return pt(n,r)}var zd=null,Al=null,Jm=!1,Fd=!1,Zm=!1,za=0;function Ci(n){n!==Al&&n.next===null&&(Al===null?zd=Al=n:Al=Al.next=n),Fd=!0,Jm||(Jm=!0,zE())}function Vc(n,r){if(!Zm&&Fd){Zm=!0;do for(var o=!1,c=zd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,j=c.pingedLanes;m=(1<<31-It(42|n)+1)-1,m&=f&~(x&~j),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,nb(c,m))}else m=Jt,m=Le(c,c===Dn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Dt(c,m)||(o=!0,nb(c,m));c=c.next}while(o);Zm=!1}}function BE(){Z1()}function Z1(){Fd=Jm=!1;var n=0;za!==0&&XE()&&(n=za);for(var r=gt(),o=null,c=zd;c!==null;){var f=c.next,m=eb(c,r);m===0?(c.next=null,o===null?zd=f:o.next=f,f===null&&(Al=o)):(o=c,(n!==0||(m&3)!==0)&&(Fd=!0)),c=f}Es!==0&&Es!==5||Vc(n),za!==0&&(za=0)}function eb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-It(m),j=1<<x,z=f[x];z===-1?((j&o)===0||(j&c)!==0)&&(f[x]=xt(j,r)):z<=r&&(n.expiredLanes|=j),m&=~j}if(r=Dn,o=Jt,o=Le(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(En===2||En===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Ht(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Dt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Ht(c),ct(o)){case 2:case 8:o=fs;break;case 32:o=sn;break;case 268435456:o=Fn;break;default:o=sn}return c=tb.bind(null,n),o=pt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Ht(c),n.callbackPriority=2,n.callbackNode=null,2}function tb(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Bd()&&n.callbackNode!==o)return null;var c=Jt;return c=Le(n,n===Dn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(P1(n,c,r),eb(n,gt()),n.callbackNode!=null&&n.callbackNode===o?tb.bind(null,n):null)}function nb(n,r){if(Bd())return null;P1(n,r,!0)}function zE(){ZE(function(){(_n&6)!==0?pt(Bt,BE):Z1()})}function eg(){if(za===0){var n=gl;n===0&&(n=Re,Re<<=1,(Re&261888)===0&&(Re=256)),za=n}return za}function sb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Er(""+n)}function rb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function FE(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=sb((f[St]||null).action),x=c.submitter;x&&(r=(r=x[St]||null)?sb(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var j=new rn("action","action",null,c,f);n.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(za!==0){var z=x?rb(f,x):new FormData(f);wm(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(j.preventDefault(),z=x?rb(f,x):new FormData(f),wm(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var tg=0;tg<Of.length;tg++){var ng=Of[tg],HE=ng.toLowerCase(),qE=ng[0].toUpperCase()+ng.slice(1);ci(HE,"on"+qE)}ci(L0,"onAnimationEnd"),ci(P0,"onAnimationIteration"),ci(O0,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(aE,"onTransitionRun"),ci(oE,"onTransitionStart"),ci(lE,"onTransitionCancel"),ci(V0,"onTransitionEnd"),Kn("onMouseEnter",["mouseout","mouseover"]),Kn("onMouseLeave",["mouseout","mouseover"]),Kn("onPointerEnter",["pointerout","pointerover"]),Kn("onPointerLeave",["pointerout","pointerover"]),Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$E=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uc));function ib(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var j=c[x],z=j.instance,ae=j.currentTarget;if(j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ae;try{m(f)}catch(be){sd(be)}f.currentTarget=null,m=z}else for(x=0;x<c.length;x++){if(j=c[x],z=j.instance,ae=j.currentTarget,j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=ae;try{m(f)}catch(be){sd(be)}f.currentTarget=null,m=z}}}}function Yt(n,r){var o=r[Ss];o===void 0&&(o=r[Ss]=new Set);var c=n+"__bubble";o.has(c)||(ab(r,n,2,!1),o.add(c))}function sg(n,r,o){var c=0;r&&(c|=4),ab(o,n,c,r)}var Hd="_reactListening"+Math.random().toString(36).slice(2);function rg(n){if(!n[Hd]){n[Hd]=!0,es.forEach(function(o){o!=="selectionchange"&&($E.has(o)||sg(o,!1,n),sg(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Hd]||(r[Hd]=!0,sg("selectionchange",!1,r))}}function ab(n,r,o,c){switch(Lb(r)){case 2:var f=bT;break;case 8:f=wT;break;default:f=bg}o=f.bind(null,r,o,n),f=void 0,!fe||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function ig(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var j=c.stateNode.containerInfo;if(j===f)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;j!==null;){if(x=Gn(j),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=m=x;continue e}j=j.parentNode}}c=c.return}F(function(){var ae=m,be=Ls(o),Ee=[];e:{var de=U0.get(n);if(de!==void 0){var me=rn,Ze=n;switch(n){case"keypress":if(_t(o)===0)break e;case"keydown":case"keyup":me=ed;break;case"focusin":Ze="focus",me=ai;break;case"focusout":Ze="blur",me=ai;break;case"beforeblur":case"afterblur":me=ai;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=po;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=v;break;case L0:case P0:case O0:me=Gu;break;case V0:me=N;break;case"scroll":case"scrollend":me=gn;break;case"wheel":me=he;break;case"copy":case"cut":case"paste":me=Ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Fi;break;case"toggle":case"beforetoggle":me=Ot}var bt=(r&4)!==0,Rn=!bt&&(n==="scroll"||n==="scrollend"),J=bt?de!==null?de+"Capture":null:de;bt=[];for(var W=ae,ie;W!==null;){var xe=W;if(ie=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ie===null||J===null||(xe=$(W,J),xe!=null&&bt.push(Bc(W,xe,ie))),Rn)break;W=W.return}0<bt.length&&(de=new me(de,Ze,null,o,be),Ee.push({event:de,listeners:bt}))}}if((r&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",me=n==="mouseout"||n==="pointerout",de&&o!==$s&&(Ze=o.relatedTarget||o.fromElement)&&(Gn(Ze)||Ze[bn]))break e;if((me||de)&&(de=be.window===be?be:(de=be.ownerDocument)?de.defaultView||de.parentWindow:window,me?(Ze=o.relatedTarget||o.toElement,me=ae,Ze=Ze?Gn(Ze):null,Ze!==null&&(Rn=u(Ze),bt=Ze.tag,Ze!==Rn||bt!==5&&bt!==27&&bt!==6)&&(Ze=null)):(me=null,Ze=ae),me!==Ze)){if(bt=nr,xe="onMouseLeave",J="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(bt=Fi,xe="onPointerLeave",J="onPointerEnter",W="pointer"),Rn=me==null?de:ls(me),ie=Ze==null?de:ls(Ze),de=new bt(xe,W+"leave",me,o,be),de.target=Rn,de.relatedTarget=ie,xe=null,Gn(be)===ae&&(bt=new bt(J,W+"enter",Ze,o,be),bt.target=ie,bt.relatedTarget=Rn,xe=bt),Rn=xe,me&&Ze)t:{for(bt=WE,J=me,W=Ze,ie=0,xe=J;xe;xe=bt(xe))ie++;xe=0;for(var ht=W;ht;ht=bt(ht))xe++;for(;0<ie-xe;)J=bt(J),ie--;for(;0<xe-ie;)W=bt(W),xe--;for(;ie--;){if(J===W||W!==null&&J===W.alternate){bt=J;break t}J=bt(J),W=bt(W)}bt=null}else bt=null;me!==null&&ob(Ee,de,me,bt,!1),Ze!==null&&Rn!==null&&ob(Ee,Rn,Ze,bt,!0)}}e:{if(de=ae?ls(ae):window,me=de.nodeName&&de.nodeName.toLowerCase(),me==="select"||me==="input"&&de.type==="file")var yn=j0;else if(_0(de))if(E0)yn=sE;else{yn=tE;var at=eE}else me=de.nodeName,!me||me.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ae&&_i(ae.elementType)&&(yn=j0):yn=nE;if(yn&&(yn=yn(n,ae))){k0(Ee,yn,o,be);break e}at&&at(n,de,ae),n==="focusout"&&ae&&de.type==="number"&&ae.memoizedProps.value!=null&&Ms(de,"number",de.value)}switch(at=ae?ls(ae):window,n){case"focusin":(_0(at)||at.contentEditable==="true")&&(ol=at,Mf=ae,gc=null);break;case"focusout":gc=Mf=ol=null;break;case"mousedown":Lf=!0;break;case"contextmenu":case"mouseup":case"dragend":Lf=!1,D0(Ee,o,be);break;case"selectionchange":if(iE)break;case"keydown":case"keyup":D0(Ee,o,be)}var zt;if(xn)e:{switch(n){case"compositionstart":var Zt="onCompositionStart";break e;case"compositionend":Zt="onCompositionEnd";break e;case"compositionupdate":Zt="onCompositionUpdate";break e}Zt=void 0}else al?yo(n,o)&&(Zt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Zt="onCompositionStart");Zt&&(ji&&o.locale!=="ko"&&(al||Zt!=="onCompositionStart"?Zt==="onCompositionEnd"&&al&&(zt=vt()):(Oe=be,tt="value"in Oe?Oe.value:Oe.textContent,al=!0)),at=qd(ae,Zt),0<at.length&&(Zt=new ki(Zt,n,null,o,be),Ee.push({event:Zt,listeners:at}),zt?Zt.data=zt:(zt=il(o),zt!==null&&(Zt.data=zt)))),(zt=Br?Qj(n,o):Xj(n,o))&&(Zt=qd(ae,"onBeforeInput"),0<Zt.length&&(at=new ki("onBeforeInput","beforeinput",null,o,be),Ee.push({event:at,listeners:Zt}),at.data=zt)),FE(Ee,n,ae,o,be)}ib(Ee,r)})}function Bc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function qd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=$(n,o),f!=null&&c.unshift(Bc(n,f,m)),f=$(n,r),f!=null&&c.push(Bc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function WE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function ob(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var j=o,z=j.alternate,ae=j.stateNode;if(j=j.tag,z!==null&&z===c)break;j!==5&&j!==26&&j!==27||ae===null||(z=ae,f?(ae=$(o,m),ae!=null&&x.unshift(Bc(o,ae,z))):f||(ae=$(o,m),ae!=null&&x.push(Bc(o,ae,z)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var GE=/\r\n?/g,KE=/\u0000|\uFFFD/g;function lb(n){return(typeof n=="string"?n:""+n).replace(GE,`
`).replace(KE,"")}function cb(n,r){return r=lb(r),lb(n)===r}function An(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ns(n,""+c);break;case"className":oe(n,"class",c);break;case"tabIndex":oe(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":oe(n,o,c);break;case"style":ii(n,c,m);break;case"data":if(r!=="object"){oe(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Er(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&An(n,r,"name",f.name,f,null),An(n,r,"formEncType",f.formEncType,f,null),An(n,r,"formMethod",f.formMethod,f,null),An(n,r,"formTarget",f.formTarget,f,null)):(An(n,r,"encType",f.encType,f,null),An(n,r,"method",f.method,f,null),An(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Er(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=qs);break;case"onScroll":c!=null&&Yt("scroll",n);break;case"onScrollEnd":c!=null&&Yt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Er(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Yt("beforetoggle",n),Yt("toggle",n),q(n,"popover",c);break;case"xlinkActuate":se(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":se(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":se(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":se(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":se(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":se(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":se(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":se(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":se(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":q(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=zi.get(o)||o,q(n,o,c))}}function ag(n,r,o,c,f,m){switch(o){case"style":ii(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&Ns(n,""+c);break;case"onScroll":c!=null&&Yt("scroll",n);break;case"onScrollEnd":c!=null&&Yt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=qs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_r.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[St]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):q(n,o,c)}}}function Us(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yt("error",n),Yt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:An(n,r,m,x,o,null)}}f&&An(n,r,"srcSet",o.srcSet,o,null),c&&An(n,r,"src",o.src,o,null);return;case"input":Yt("invalid",n);var j=m=x=f=null,z=null,ae=null;for(c in o)if(o.hasOwnProperty(c)){var be=o[c];if(be!=null)switch(c){case"name":f=be;break;case"type":x=be;break;case"checked":z=be;break;case"defaultChecked":ae=be;break;case"value":m=be;break;case"defaultValue":j=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(i(137,r));break;default:An(n,r,c,be,o,null)}}ri(n,m,j,z,ae,x,f,!1);return;case"select":Yt("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(j=o[f],j!=null))switch(f){case"value":m=j;break;case"defaultValue":x=j;break;case"multiple":c=j;default:An(n,r,f,j,o,null)}r=m,o=x,n.multiple=!!c,r!=null?er(n,!!c,r,!1):o!=null&&er(n,!!c,o,!0);return;case"textarea":Yt("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(j=o[x],j!=null))switch(x){case"value":c=j;break;case"defaultValue":f=j;break;case"children":m=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(91));break;default:An(n,r,x,j,o,null)}jr(n,c,f,m);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":An(n,r,z,c,o,null));return;case"dialog":Yt("beforetoggle",n),Yt("toggle",n),Yt("cancel",n),Yt("close",n);break;case"iframe":case"object":Yt("load",n);break;case"video":case"audio":for(c=0;c<Uc.length;c++)Yt(Uc[c],n);break;case"image":Yt("error",n),Yt("load",n);break;case"details":Yt("toggle",n);break;case"embed":case"source":case"link":Yt("error",n),Yt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(c=o[ae],c!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:An(n,r,ae,c,o,null)}return;default:if(_i(r)){for(be in o)o.hasOwnProperty(be)&&(c=o[be],c!==void 0&&ag(n,r,be,c,o,void 0));return}}for(j in o)o.hasOwnProperty(j)&&(c=o[j],c!=null&&An(n,r,j,c,o,null))}function YE(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,j=null,z=null,ae=null,be=null;for(me in o){var Ee=o[me];if(o.hasOwnProperty(me)&&Ee!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":z=Ee;default:c.hasOwnProperty(me)||An(n,r,me,null,c,Ee)}}for(var de in c){var me=c[de];if(Ee=o[de],c.hasOwnProperty(de)&&(me!=null||Ee!=null))switch(de){case"type":m=me;break;case"name":f=me;break;case"checked":ae=me;break;case"defaultChecked":be=me;break;case"value":x=me;break;case"defaultValue":j=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:me!==Ee&&An(n,r,de,me,c,Ee)}}Ds(n,x,j,z,ae,be,m,f);return;case"select":me=x=j=de=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":me=z;default:c.hasOwnProperty(m)||An(n,r,m,null,c,z)}for(f in c)if(m=c[f],z=o[f],c.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":de=m;break;case"defaultValue":j=m;break;case"multiple":x=m;default:m!==z&&An(n,r,f,m,c,z)}r=j,o=x,c=me,de!=null?er(n,!!o,de,!1):!!c!=!!o&&(r!=null?er(n,!!o,r,!0):er(n,!!o,o?[]:"",!1));return;case"textarea":me=de=null;for(j in o)if(f=o[j],o.hasOwnProperty(j)&&f!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:An(n,r,j,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":de=f;break;case"defaultValue":me=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&An(n,r,x,f,c,m)}xi(n,de,me);return;case"option":for(var Ze in o)de=o[Ze],o.hasOwnProperty(Ze)&&de!=null&&!c.hasOwnProperty(Ze)&&(Ze==="selected"?n.selected=!1:An(n,r,Ze,null,c,de));for(z in c)de=c[z],me=o[z],c.hasOwnProperty(z)&&de!==me&&(de!=null||me!=null)&&(z==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":An(n,r,z,de,c,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in o)de=o[bt],o.hasOwnProperty(bt)&&de!=null&&!c.hasOwnProperty(bt)&&An(n,r,bt,null,c,de);for(ae in c)if(de=c[ae],me=o[ae],c.hasOwnProperty(ae)&&de!==me&&(de!=null||me!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:An(n,r,ae,de,c,me)}return;default:if(_i(r)){for(var Rn in o)de=o[Rn],o.hasOwnProperty(Rn)&&de!==void 0&&!c.hasOwnProperty(Rn)&&ag(n,r,Rn,void 0,c,de);for(be in c)de=c[be],me=o[be],!c.hasOwnProperty(be)||de===me||de===void 0&&me===void 0||ag(n,r,be,de,c,me);return}}for(var J in o)de=o[J],o.hasOwnProperty(J)&&de!=null&&!c.hasOwnProperty(J)&&An(n,r,J,null,c,de);for(Ee in c)de=c[Ee],me=o[Ee],!c.hasOwnProperty(Ee)||de===me||de==null&&me==null||An(n,r,Ee,de,c,me)}function ub(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function QE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,j=f.duration;if(m&&j&&ub(x)){for(x=0,j=f.responseEnd,c+=1;c<o.length;c++){var z=o[c],ae=z.startTime;if(ae>j)break;var be=z.transferSize,Ee=z.initiatorType;be&&ub(Ee)&&(z=z.responseEnd,x+=be*(z<j?1:(j-ae)/(z-ae)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var og=null,lg=null;function $d(n){return n.nodeType===9?n:n.ownerDocument}function db(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function cg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var ug=null;function XE(){var n=window.event;return n&&n.type==="popstate"?n===ug?!1:(ug=n,!0):(ug=null,!1)}var fb=typeof setTimeout=="function"?setTimeout:void 0,JE=typeof clearTimeout=="function"?clearTimeout:void 0,mb=typeof Promise=="function"?Promise:void 0,ZE=typeof queueMicrotask=="function"?queueMicrotask:typeof mb<"u"?function(n){return mb.resolve(null).then(n).catch(eT)}:fb;function eT(n){setTimeout(function(){throw n})}function Fa(n){return n==="head"}function gb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Ml(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")zc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,zc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,j=m.nodeName;m[js]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&zc(n.ownerDocument.body);o=f}while(o);Ml(r)}function pb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function dg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":dg(o),hr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function tT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[js])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Gr(n.nextSibling),n===null)break}return null}function nT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Gr(n.nextSibling),n===null))return null;return n}function yb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Gr(n.nextSibling),n===null))return null;return n}function hg(n){return n.data==="$?"||n.data==="$~"}function fg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function sT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Gr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var mg=null;function vb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Gr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function bb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function wb(n,r,o){switch(r=$d(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function zc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);hr(n)}var Kr=new Map,xb=new Set;function Wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var sa=Te.d;Te.d={f:rT,r:iT,D:aT,C:oT,L:lT,m:cT,X:dT,S:uT,M:hT};function rT(){var n=sa.f(),r=Od();return n||r}function iT(n){var r=os(n);r!==null&&r.tag===5&&r.type==="form"?Vv(r):sa.r(n)}var Rl=typeof document>"u"?null:document;function _b(n,r,o){var c=Rl;if(c&&typeof r=="string"&&r){var f=Yn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),xb.has(f)||(xb.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Us(r,"link",n),wn(r),c.head.appendChild(r)))}}function aT(n){sa.D(n),_b("dns-prefetch",n,null)}function oT(n,r){sa.C(n,r),_b("preconnect",n,r)}function lT(n,r,o){sa.L(n,r,o);var c=Rl;if(c&&n&&r){var f='link[rel="preload"][as="'+Yn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Yn(o.imageSizes)+'"]')):f+='[href="'+Yn(n)+'"]';var m=f;switch(r){case"style":m=Il(n);break;case"script":m=Dl(n)}Kr.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),Kr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Fc(m))||r==="script"&&c.querySelector(Hc(m))||(r=c.createElement("link"),Us(r,"link",n),wn(r),c.head.appendChild(r)))}}function cT(n,r){sa.m(n,r);var o=Rl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Dl(n)}if(!Kr.has(m)&&(n=k({rel:"modulepreload",href:n},r),Kr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Hc(m)))return}c=o.createElement("link"),Us(c,"link",n),wn(c),o.head.appendChild(c)}}}function uT(n,r,o){sa.S(n,r,o);var c=Rl;if(c&&n){var f=Vn(c).hoistableStyles,m=Il(n);r=r||"default";var x=f.get(m);if(!x){var j={loading:0,preload:null};if(x=c.querySelector(Fc(m)))j.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=Kr.get(m))&&gg(n,o);var z=x=c.createElement("link");wn(z),Us(z,"link",n),z._p=new Promise(function(ae,be){z.onload=ae,z.onerror=be}),z.addEventListener("load",function(){j.loading|=1}),z.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Gd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:j},f.set(m,x)}}}function dT(n,r){sa.X(n,r);var o=Rl;if(o&&n){var c=Vn(o).hoistableScripts,f=Dl(n),m=c.get(f);m||(m=o.querySelector(Hc(f)),m||(n=k({src:n,async:!0},r),(r=Kr.get(f))&&pg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function hT(n,r){sa.M(n,r);var o=Rl;if(o&&n){var c=Vn(o).hoistableScripts,f=Dl(n),m=c.get(f);m||(m=o.querySelector(Hc(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=Kr.get(f))&&pg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function kb(n,r,o,c){var f=(f=Ve.current)?Wd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Il(o.href),o=Vn(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Il(o.href);var m=Vn(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(Fc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),Kr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Kr.set(n,o),m||fT(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Dl(o),o=Vn(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Il(n){return'href="'+Yn(n)+'"'}function Fc(n){return'link[rel="stylesheet"]['+n+"]"}function jb(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function fT(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Us(r,"link",o),wn(r),n.head.appendChild(r))}function Dl(n){return'[src="'+Yn(n)+'"]'}function Hc(n){return"script[async]"+n}function Eb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(c)return r.instance=c,wn(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),wn(c),Us(c,"style",f),Gd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Il(o.href);var m=n.querySelector(Fc(f));if(m)return r.state.loading|=4,r.instance=m,wn(m),m;c=jb(o),(f=Kr.get(f))&&gg(c,f),m=(n.ownerDocument||n).createElement("link"),wn(m);var x=m;return x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),r.state.loading|=4,Gd(m,o.precedence,n),r.instance=m;case"script":return m=Dl(o.src),(f=n.querySelector(Hc(m)))?(r.instance=f,wn(f),f):(c=o,(f=Kr.get(m))&&(c=k({},o),pg(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),wn(f),Us(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Gd(c,o.precedence,n));return r.instance}function Gd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var j=c[x];if(j.dataset.precedence===r)m=j;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function gg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function pg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Kd=null;function Tb(n,r,o){if(Kd===null){var c=new Map,f=Kd=new Map;f.set(o,c)}else f=Kd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[js]||m[Nt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var j=c.get(x);j?j.push(m):c.set(x,[m])}}return c}function Sb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function mT(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Cb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function gT(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Il(c.href),m=r.querySelector(Fc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Yd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,wn(m);return}m=r.ownerDocument||r,c=jb(c),(f=Kr.get(f))&&gg(c,f),m=m.createElement("link"),wn(m);var x=m;x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Yd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var yg=0;function pT(n,r){return n.stylesheets&&n.count===0&&Xd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&yg===0&&(yg=62500*QE());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>yg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Yd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Qd=null;function Xd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Qd=new Map,r.forEach(yT,n),Qd=null,Yd.call(n))}function yT(n,r){if(!(r.state.loading&4)){var o=Qd.get(n);if(o)var c=o.get(null);else{o=new Map,Qd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Yd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var qc={$$typeof:Q,Provider:null,Consumer:null,_currentValue:qe,_currentValue2:qe,_threadCount:0};function vT(n,r,o,c,f,m,x,j,z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.hiddenUpdates=dn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Nb(n,r,o,c,f,m,x,j,z,ae,be,Ee){return n=new vT(n,r,o,x,z,ae,be,Ee,j),r=1,m===!0&&(r|=24),m=Cr(3,null,null,r),n.current=m,m.stateNode=n,r=Qf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},em(m),n}function Ab(n){return n?(n=ul,n):ul}function Rb(n,r,o,c,f,m){f=Ab(f),c.context===null?c.context=f:c.pendingContext=f,c=Ra(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ia(n,c,r),o!==null&&(yr(o,n,r),_c(o,n,r))}function Ib(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function vg(n,r){Ib(n,r),(n=n.alternate)&&Ib(n,r)}function Db(n){if(n.tag===13||n.tag===31){var r=wo(n,67108864);r!==null&&yr(r,n,67108864),vg(n,67108864)}}function Mb(n){if(n.tag===13||n.tag===31){var r=Dr();r=Ke(r);var o=wo(n,r);o!==null&&yr(o,n,r),vg(n,r)}}var Jd=!0;function bT(n,r,o,c){var f=Z.T;Z.T=null;var m=Te.p;try{Te.p=2,bg(n,r,o,c)}finally{Te.p=m,Z.T=f}}function wT(n,r,o,c){var f=Z.T;Z.T=null;var m=Te.p;try{Te.p=8,bg(n,r,o,c)}finally{Te.p=m,Z.T=f}}function bg(n,r,o,c){if(Jd){var f=wg(c);if(f===null)ig(n,r,c,Zd,o),Pb(n,c);else if(_T(f,n,r,o,c))c.stopPropagation();else if(Pb(n,c),r&4&&-1<xT.indexOf(n)){for(;f!==null;){var m=os(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Be(m.pendingLanes);if(x!==0){var j=m;for(j.pendingLanes|=2,j.entangledLanes|=2;x;){var z=1<<31-It(x);j.entanglements[1]|=z,x&=~z}Ci(m),(_n&6)===0&&(Ld=gt()+500,Vc(0))}}break;case 31:case 13:j=wo(m,2),j!==null&&yr(j,m,2),Od(),vg(m,2)}if(m=wg(c),m===null&&ig(n,r,c,Zd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else ig(n,r,c,null,o)}}function wg(n){return n=Ls(n),xg(n)}var Zd=null;function xg(n){if(Zd=null,n=Gn(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=g(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Zd=n,null}function Lb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wt()){case Bt:return 2;case fs:return 8;case sn:case Zn:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var _g=!1,Ha=null,qa=null,$a=null,$c=new Map,Wc=new Map,Wa=[],xT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(n,r){switch(n){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":$a=null;break;case"pointerover":case"pointerout":$c.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wc.delete(r.pointerId)}}function Gc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=os(r),r!==null&&Db(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function _T(n,r,o,c,f){switch(r){case"focusin":return Ha=Gc(Ha,n,r,o,c,f),!0;case"dragenter":return qa=Gc(qa,n,r,o,c,f),!0;case"mouseover":return $a=Gc($a,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return $c.set(m,Gc($c.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Wc.set(m,Gc(Wc.get(m)||null,n,r,o,c,f)),!0}return!1}function Ob(n){var r=Gn(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Gt(n.priority,function(){Mb(o)});return}}else if(r===31){if(r=g(o),r!==null){n.blockedOn=r,Gt(n.priority,function(){Mb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function eh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=wg(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);$s=c,o.target.dispatchEvent(c),$s=null}else return r=os(o),r!==null&&Db(r),n.blockedOn=o,!1;r.shift()}return!0}function Vb(n,r,o){eh(n)&&o.delete(r)}function kT(){_g=!1,Ha!==null&&eh(Ha)&&(Ha=null),qa!==null&&eh(qa)&&(qa=null),$a!==null&&eh($a)&&($a=null),$c.forEach(Vb),Wc.forEach(Vb)}function th(n,r){n.blockedOn===r&&(n.blockedOn=null,_g||(_g=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,kT)))}var nh=null;function Ub(n){nh!==n&&(nh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){nh===n&&(nh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(xg(c||o)===null)continue;break}var m=os(o);m!==null&&(n.splice(r,3),r-=3,wm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Ml(n){function r(z){return th(z,n)}Ha!==null&&th(Ha,n),qa!==null&&th(qa,n),$a!==null&&th($a,n),$c.forEach(r),Wc.forEach(r);for(var o=0;o<Wa.length;o++){var c=Wa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Wa.length&&(o=Wa[0],o.blockedOn===null);)Ob(o),o.blockedOn===null&&Wa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[St]||null;if(typeof m=="function")x||Ub(o);else if(x){var j=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[St]||null)j=x.formAction;else if(xg(f)!==null)continue}else j=x.action;typeof j=="function"?o[c+1]=j:(o.splice(c,3),c-=3),Ub(o)}}}function Bb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function kg(n){this._internalRoot=n}sh.prototype.render=kg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Dr();Rb(o,c,n,r,null,null)},sh.prototype.unmount=kg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Rb(n.current,2,null,n,null,null),Od(),r[bn]=null}};function sh(n){this._internalRoot=n}sh.prototype.unstable_scheduleHydration=function(n){if(n){var r=rt();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Wa.length&&r!==0&&r<Wa[o].priority;o++);Wa.splice(o,0,n),o===0&&Ob(n)}};var zb=e.version;if(zb!=="19.2.4")throw Error(i(527,zb,"19.2.4"));Te.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var jT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{un=rh.inject(jT),Wt=rh}catch{}}return Yc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Kv,m=Yv,x=Qv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Nb(n,1,!1,null,null,o,c,null,f,m,x,Bb),n[bn]=r.current,rg(n),new kg(r)},Yc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Kv,x=Yv,j=Qv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Nb(n,1,!0,r,o??null,c,f,z,m,x,j,Bb),r.context=Ab(null),o=r.current,c=Dr(),c=Ke(c),f=Ra(c),f.callback=null,Ia(o,f,c),o=c,r.current.lanes=o,hn(r,o),Ci(r),n[bn]=r.current,rg(n),new sh(r)},Yc.version="19.2.4",Yc}var Xb;function MT(){if(Xb)return Tg.exports;Xb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Tg.exports=DT(),Tg.exports}var LT=MT();const PT="modulepreload",OT=function(s){return"/login/"+s},Jb={},Js=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=y(t.map(p=>{if(p=OT(p),p in Jb)return;Jb[p]=!0;const b=p.endsWith(".css"),k=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${k}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":PT,b||(T.as="script"),T.crossOrigin="",T.href=p,g&&T.setAttribute("nonce",g),document.head.appendChild(T),b)return new Promise((I,H)=>{T.addEventListener("load",I),T.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&u(g.reason);return e().catch(u)})};var Zb="popstate";function VT(s={}){function e(i,l){let{pathname:u,search:d,hash:g}=i.location;return gp("",{pathname:u,search:d,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:yu(l)}return BT(e,t,null,s)}function Wn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Zr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UT(){return Math.random().toString(36).substring(2,10)}function e2(s,e){return{usr:s.state,key:s.key,idx:e}}function gp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?tc(e):e,state:t,key:e&&e.key||i||UT()}}function yu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function tc(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function BT(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,g="POP",y=null,p=b();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function b(){return(d.state||{idx:null}).idx}function k(){g="POP";let B=b(),Y=B==null?null:B-p;p=B,y&&y({action:g,location:K.location,delta:Y})}function T(B,Y){g="PUSH";let te=gp(K.location,B,Y);p=b()+1;let Q=e2(te,p),pe=K.createHref(te);try{d.pushState(Q,"",pe)}catch(we){if(we instanceof DOMException&&we.name==="DataCloneError")throw we;l.location.assign(pe)}u&&y&&y({action:g,location:K.location,delta:1})}function I(B,Y){g="REPLACE";let te=gp(K.location,B,Y);p=b();let Q=e2(te,p),pe=K.createHref(te);d.replaceState(Q,"",pe),u&&y&&y({action:g,location:K.location,delta:0})}function H(B){return zT(B)}let K={get action(){return g},get location(){return s(l,d)},listen(B){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(Zb,k),y=B,()=>{l.removeEventListener(Zb,k),y=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let Y=H(B);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:T,replace:I,go(B){return d.go(B)}};return K}function zT(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Wn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:yu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function mx(s,e,t="/"){return FT(s,e,t,!1)}function FT(s,e,t,i){let l=typeof e=="string"?tc(e):e,u=ga(l.pathname||"/",t);if(u==null)return null;let d=gx(s);HT(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let p=eS(u);g=JT(d[y],p,i)}return g}function gx(s,e=[],t=[],i="",l=!1){let u=(d,g,y=l,p)=>{let b={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;Wn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let k=da([i,b.relativePath]),T=t.concat(b);d.children&&d.children.length>0&&(Wn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),gx(d.children,e,T,k,y)),!(d.path==null&&!d.index)&&e.push({path:k,score:QT(k,d.index),routesMeta:T})};return s.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))u(d,g);else for(let y of px(d.path))u(d,g,!0,y)}),e}function px(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=px(i.join("/")),g=[];return g.push(...d.map(y=>y===""?u:[u,y].join("/"))),l&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function HT(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:XT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var qT=/^:[\w-]+$/,$T=3,WT=2,GT=1,KT=10,YT=-2,t2=s=>s==="*";function QT(s,e){let t=s.split("/"),i=t.length;return t.some(t2)&&(i+=YT),e&&(i+=WT),t.filter(l=>!t2(l)).reduce((l,u)=>l+(qT.test(u)?$T:u===""?GT:KT),i)}function XT(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function JT(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let g=0;g<i.length;++g){let y=i[g],p=g===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",k=Ih({path:y.relativePath,caseSensitive:y.caseSensitive,end:p},b),T=y.route;if(!k&&p&&t&&!i[i.length-1].route.index&&(k=Ih({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:da([u,k.pathname]),pathnameBase:rS(da([u,k.pathnameBase])),route:T}),k.pathnameBase!=="/"&&(u=da([u,k.pathnameBase]))}return d}function Ih(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=ZT(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:i.reduce((p,{paramName:b,isOptional:k},T)=>{if(b==="*"){let H=g[T]||"";d=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const I=g[T];return k&&!I?p[b]=void 0:p[b]=(I||"").replace(/%2F/g,"/"),p},{}),pathname:u,pathnameBase:d,pattern:s}}function ZT(s,e=!1,t=!0){Zr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(i.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function eS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ga(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var tS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function nS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?tc(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=n2(t.substring(1),"/"):u=n2(t,e)):u=e,{pathname:u,search:iS(i),hash:aS(l)}}function n2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ag(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Xp(s){let e=sS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Jp(s,e,t,i=!1){let l;typeof s=="string"?l=tc(s):(l={...s},Wn(!l.pathname||!l.pathname.includes("?"),Ag("?","pathname","search",l)),Wn(!l.pathname||!l.pathname.includes("#"),Ag("#","pathname","hash",l)),Wn(!l.search||!l.search.includes("#"),Ag("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,g;if(d==null)g=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),k-=1;l.pathname=T.join("/")}g=k>=0?e[k]:"/"}let y=nS(l,g),p=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(p||b)&&(y.pathname+="/"),y}var da=s=>s.join("/").replace(/\/\/+/g,"/"),rS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),iS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,aS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,oS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function lS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function cS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var yx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vx(s,e){let t=s;if(typeof t!="string"||!tS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(yx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),g=ga(d.pathname,e);d.origin===u.origin&&g!=null?t=g+d.search+d.hash:l=!0}catch{Zr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bx=["POST","PUT","PATCH","DELETE"];new Set(bx);var uS=["GET",...bx];new Set(uS);var nc=w.createContext(null);nc.displayName="DataRouter";var ef=w.createContext(null);ef.displayName="DataRouterState";var dS=w.createContext(!1),wx=w.createContext({isTransitioning:!1});wx.displayName="ViewTransition";var hS=w.createContext(new Map);hS.displayName="Fetchers";var fS=w.createContext(null);fS.displayName="Await";var Lr=w.createContext(null);Lr.displayName="Navigation";var Au=w.createContext(null);Au.displayName="Location";var vi=w.createContext({outlet:null,matches:[],isDataRoute:!1});vi.displayName="Route";var Zp=w.createContext(null);Zp.displayName="RouteError";var xx="REACT_ROUTER_ERROR",mS="REDIRECT",gS="ROUTE_ERROR_RESPONSE";function pS(s){if(s.startsWith(`${xx}:${mS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function yS(s){if(s.startsWith(`${xx}:${gS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new oS(e.status,e.statusText,e.data)}catch{}}function vS(s,{relative:e}={}){Wn(sc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Lr),{hash:l,pathname:u,search:d}=Ru(s,{relative:e}),g=u;return t!=="/"&&(g=u==="/"?t:da([t,u])),i.createHref({pathname:g,search:d,hash:l})}function sc(){return w.useContext(Au)!=null}function Vi(){return Wn(sc(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Au).location}var _x="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kx(s){w.useContext(Lr).static||w.useLayoutEffect(s)}function Zs(){let{isDataRoute:s}=w.useContext(vi);return s?IS():bS()}function bS(){Wn(sc(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(nc),{basename:e,navigator:t}=w.useContext(Lr),{matches:i}=w.useContext(vi),{pathname:l}=Vi(),u=JSON.stringify(Xp(i)),d=w.useRef(!1);return kx(()=>{d.current=!0}),w.useCallback((y,p={})=>{if(Zr(d.current,_x),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=Jp(y,JSON.parse(u),l,p.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:da([e,b.pathname])),(p.replace?t.replace:t.push)(b,p.state,p)},[e,t,u,l,s])}w.createContext(null);function wS(){let{matches:s}=w.useContext(vi),e=s[s.length-1];return e?e.params:{}}function Ru(s,{relative:e}={}){let{matches:t}=w.useContext(vi),{pathname:i}=Vi(),l=JSON.stringify(Xp(t));return w.useMemo(()=>Jp(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function xS(s,e){return jx(s,e)}function jx(s,e,t,i,l){Wn(sc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Lr),{matches:d}=w.useContext(vi),g=d[d.length-1],y=g?g.params:{},p=g?g.pathname:"/",b=g?g.pathnameBase:"/",k=g&&g.route;{let te=k&&k.path||"";Tx(p,!k||te.endsWith("*")||te.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${te}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${te}"> to <Route path="${te==="/"?"*":`${te}/*`}">.`)}let T=Vi(),I;if(e){let te=typeof e=="string"?tc(e):e;Wn(b==="/"||te.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${te.pathname}" was given in the \`location\` prop.`),I=te}else I=T;let H=I.pathname||"/",K=H;if(b!=="/"){let te=b.replace(/^\//,"").split("/");K="/"+H.replace(/^\//,"").split("/").slice(te.length).join("/")}let B=mx(s,{pathname:K});Zr(k||B!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),Zr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=TS(B&&B.map(te=>Object.assign({},te,{params:Object.assign({},y,te.params),pathname:da([b,u.encodeLocation?u.encodeLocation(te.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathname]),pathnameBase:te.pathnameBase==="/"?b:da([b,u.encodeLocation?u.encodeLocation(te.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathnameBase])})),d,t,i,l);return e&&Y?w.createElement(Au.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},Y):Y}function _S(){let s=RS(),e=lS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var kS=w.createElement(_S,null),Ex=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=yS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(vi.Provider,{value:this.props.routeContext},w.createElement(Zp.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(jS,{error:s},e):e}};Ex.contextType=dS;var Rg=new WeakMap;function jS({children:s,error:e}){let{basename:t}=w.useContext(Lr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=pS(e.digest);if(i){let l=Rg.get(e);if(l)throw l;let u=vx(i.location,t);if(yx&&!Rg.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Rg.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function ES({routeContext:s,match:e,children:t}){let i=w.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(vi.Provider,{value:s},t)}function TS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);Wn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let g=!1,y=-1;if(t)for(let b=0;b<u.length;b++){let k=u[b];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(y=b),k.route.id){let{loaderData:T,errors:I}=t,H=k.route.loader&&!T.hasOwnProperty(k.route.id)&&(!I||I[k.route.id]===void 0);if(k.route.lazy||H){g=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}let p=t&&i?(b,k)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:cS(t.matches),errorInfo:k})}:void 0;return u.reduceRight((b,k,T)=>{let I,H=!1,K=null,B=null;t&&(I=d&&k.route.id?d[k.route.id]:void 0,K=k.route.errorElement||kS,g&&(y<0&&T===0?(Tx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):y===T&&(H=!0,B=k.route.hydrateFallbackElement||null)));let Y=e.concat(u.slice(0,T+1)),te=()=>{let Q;return I?Q=K:H?Q=B:k.route.Component?Q=w.createElement(k.route.Component,null):k.route.element?Q=k.route.element:Q=b,w.createElement(ES,{match:k,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:Q})};return t&&(k.route.ErrorBoundary||k.route.errorElement||T===0)?w.createElement(Ex,{location:t.location,revalidation:t.revalidation,component:K,error:I,children:te(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:p}):te()},null)}function ey(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function SS(s){let e=w.useContext(nc);return Wn(e,ey(s)),e}function CS(s){let e=w.useContext(ef);return Wn(e,ey(s)),e}function NS(s){let e=w.useContext(vi);return Wn(e,ey(s)),e}function ty(s){let e=NS(s),t=e.matches[e.matches.length-1];return Wn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function AS(){return ty("useRouteId")}function RS(){let s=w.useContext(Zp),e=CS("useRouteError"),t=ty("useRouteError");return s!==void 0?s:e.errors?.[t]}function IS(){let{router:s}=SS("useNavigate"),e=ty("useNavigate"),t=w.useRef(!1);return kx(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Zr(t.current,_x),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var s2={};function Tx(s,e,t){!e&&!s2[s]&&(s2[s]=!0,Zr(!1,t))}w.memo(DS);function DS({routes:s,future:e,state:t,onError:i}){return jx(s,void 0,t,i,e)}function Sx({to:s,replace:e,state:t,relative:i}){Wn(sc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Lr);Zr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(vi),{pathname:d}=Vi(),g=Zs(),y=Jp(s,Xp(u),d,i==="path"),p=JSON.stringify(y);return w.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:i})},[g,p,i,e,t]),null}function In(s){Wn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function MS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Wn(!sc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:g,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[g,l,u,d]);typeof t=="string"&&(t=tc(t));let{pathname:p="/",search:b="",hash:k="",state:T=null,key:I="default"}=t,H=w.useMemo(()=>{let K=ga(p,g);return K==null?null:{location:{pathname:K,search:b,hash:k,state:T,key:I},navigationType:i}},[g,p,b,k,T,I,i]);return Zr(H!=null,`<Router basename="${g}"> is not able to match the URL "${p}${b}${k}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:w.createElement(Lr.Provider,{value:y},w.createElement(Au.Provider,{children:e,value:H}))}function LS({children:s,location:e}){return xS(pp(s),e)}function pp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,pp(i.props.children,u));return}Wn(i.type===In,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Wn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=pp(i.props.children,u)),t.push(d)}),t}var bh="get",wh="application/x-www-form-urlencoded";function tf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function PS(s){return tf(s)&&s.tagName.toLowerCase()==="button"}function OS(s){return tf(s)&&s.tagName.toLowerCase()==="form"}function VS(s){return tf(s)&&s.tagName.toLowerCase()==="input"}function US(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function BS(s,e){return s.button===0&&(!e||e==="_self")&&!US(s)}function yp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function zS(s,e){let t=yp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var ih=null;function FS(){if(ih===null)try{new FormData(document.createElement("form"),0),ih=!1}catch{ih=!0}return ih}var HS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ig(s){return s!=null&&!HS.has(s)?(Zr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wh}"`),null):s}function qS(s,e){let t,i,l,u,d;if(OS(s)){let g=s.getAttribute("action");i=g?ga(g,e):null,t=s.getAttribute("method")||bh,l=Ig(s.getAttribute("enctype"))||wh,u=new FormData(s)}else if(PS(s)||VS(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||g.getAttribute("action");if(i=y?ga(y,e):null,t=s.getAttribute("formmethod")||g.getAttribute("method")||bh,l=Ig(s.getAttribute("formenctype"))||Ig(g.getAttribute("enctype"))||wh,u=new FormData(g,s),!FS()){let{name:p,type:b,value:k}=s;if(b==="image"){let T=p?`${p}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else p&&u.append(p,k)}}else{if(tf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=bh,i=null,l=wh,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ny(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function $S(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ga(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function WS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function KS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await WS(u,t);return d.links?d.links():[]}return[]}));return JS(i.flat(1).filter(GS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function r2(s,e,t,i,l,u){let d=(y,p)=>t[p]?y.route.id!==t[p].route.id:!0,g=(y,p)=>t[p].pathname!==y.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==y.params["*"];return u==="assets"?e.filter((y,p)=>d(y,p)||g(y,p)):u==="data"?e.filter((y,p)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,p)||g(y,p))return!0;if(y.route.shouldRevalidate){let k=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function YS(s,e,{includeHydrateFallback:t}={}){return QS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function QS(s){return[...new Set(s)]}function XS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function JS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(XS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Cx(){let s=w.useContext(nc);return ny(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function ZS(){let s=w.useContext(ef);return ny(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var sy=w.createContext(void 0);sy.displayName="FrameworkContext";function Nx(){let s=w.useContext(sy);return ny(s,"You must render this element inside a <HydratedRouter> element"),s}function eC(s,e){let t=w.useContext(sy),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:g,onBlur:y,onMouseEnter:p,onMouseLeave:b,onTouchStart:k}=e,T=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let K=Y=>{Y.forEach(te=>{d(te.isIntersecting)})},B=new IntersectionObserver(K,{threshold:.5});return T.current&&B.observe(T.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let K=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(K)}}},[i]);let I=()=>{l(!0)},H=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,T,{}]:[u,T,{onFocus:Qc(g,I),onBlur:Qc(y,H),onMouseEnter:Qc(p,I),onMouseLeave:Qc(b,H),onTouchStart:Qc(k,I)}]:[!1,T,{}]}function Qc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function tC({page:s,...e}){let{router:t}=Cx(),i=w.useMemo(()=>mx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(sC,{page:s,matches:i,...e}):null}function nC(s){let{manifest:e,routeModules:t}=Nx(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return KS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function sC({page:s,matches:e,...t}){let i=Vi(),{future:l,manifest:u,routeModules:d}=Nx(),{basename:g}=Cx(),{loaderData:y,matches:p}=ZS(),b=w.useMemo(()=>r2(s,e,p,u,i,"data"),[s,e,p,u,i]),k=w.useMemo(()=>r2(s,e,p,u,i,"assets"),[s,e,p,u,i]),T=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let K=new Set,B=!1;if(e.forEach(te=>{let Q=u.routes[te.route.id];!Q||!Q.hasLoader||(!b.some(pe=>pe.route.id===te.route.id)&&te.route.id in y&&d[te.route.id]?.shouldRevalidate||Q.hasClientLoader?B=!0:K.add(te.route.id))}),K.size===0)return[];let Y=$S(s,g,l.unstable_trailingSlashAwareDataRequests,"data");return B&&K.size>0&&Y.searchParams.set("_routes",e.filter(te=>K.has(te.route.id)).map(te=>te.route.id).join(",")),[Y.pathname+Y.search]},[g,l.unstable_trailingSlashAwareDataRequests,y,i,u,b,e,s,d]),I=w.useMemo(()=>YS(k,u),[k,u]),H=nC(k);return w.createElement(w.Fragment,null,T.map(K=>w.createElement("link",{key:K,rel:"prefetch",as:"fetch",href:K,...t})),I.map(K=>w.createElement("link",{key:K,rel:"modulepreload",href:K,...t})),H.map(({key:K,link:B})=>w.createElement("link",{key:K,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function rC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iC&&(window.__reactRouterVersion="7.13.0")}catch{}function aC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=VT({window:i,v5Compat:!0}));let u=l.current,[d,g]=w.useState({action:u.action,location:u.location}),y=w.useCallback(p=>{t===!1?g(p):w.startTransition(()=>g(p))},[t]);return w.useLayoutEffect(()=>u.listen(y),[u,y]),w.createElement(MS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Ax=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rx=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:g,target:y,to:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T,...I},H){let{basename:K,unstable_useTransitions:B}=w.useContext(Lr),Y=typeof p=="string"&&Ax.test(p),te=vx(p,K);p=te.to;let Q=vS(p,{relative:l}),[pe,we,ye]=eC(i,I),M=uC(p,{replace:d,state:g,target:y,preventScrollReset:b,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:T,unstable_useTransitions:B});function E(U){e&&e(U),U.defaultPrevented||M(U)}let L=w.createElement("a",{...I,...ye,href:te.absoluteURL||Q,onClick:te.isExternal||u?e:E,ref:rC(H,we),target:y,"data-discover":!Y&&t==="render"?"true":void 0});return pe&&!Y?w.createElement(w.Fragment,null,L,w.createElement(tC,{page:Q})):L});Rx.displayName="Link";var oC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:g,children:y,...p},b){let k=Ru(d,{relative:p.relative}),T=Vi(),I=w.useContext(ef),{navigator:H,basename:K}=w.useContext(Lr),B=I!=null&&gC(k)&&g===!0,Y=H.encodeLocation?H.encodeLocation(k).pathname:k.pathname,te=T.pathname,Q=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;t||(te=te.toLowerCase(),Q=Q?Q.toLowerCase():null,Y=Y.toLowerCase()),Q&&K&&(Q=ga(Q,K)||Q);const pe=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let we=te===Y||!l&&te.startsWith(Y)&&te.charAt(pe)==="/",ye=Q!=null&&(Q===Y||!l&&Q.startsWith(Y)&&Q.charAt(Y.length)==="/"),M={isActive:we,isPending:ye,isTransitioning:B},E=we?e:void 0,L;typeof i=="function"?L=i(M):L=[i,we?"active":null,ye?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let U=typeof u=="function"?u(M):u;return w.createElement(Rx,{...p,"aria-current":E,className:L,ref:b,style:U,to:d,viewTransition:g},typeof y=="function"?y(M):y)});oC.displayName="NavLink";var lC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=bh,action:g,onSubmit:y,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T,...I},H)=>{let{unstable_useTransitions:K}=w.useContext(Lr),B=fC(),Y=mC(g,{relative:p}),te=d.toLowerCase()==="get"?"get":"post",Q=typeof g=="string"&&Ax.test(g),pe=we=>{if(y&&y(we),we.defaultPrevented)return;we.preventDefault();let ye=we.nativeEvent.submitter,M=ye?.getAttribute("formmethod")||d,E=()=>B(ye||we.currentTarget,{fetcherKey:e,method:M,navigate:t,replace:l,state:u,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T});K&&t!==!1?w.startTransition(()=>E()):E()};return w.createElement("form",{ref:H,method:te,action:Y,onSubmit:i?y:pe,...I,"data-discover":!Q&&s==="render"?"true":void 0})});lC.displayName="Form";function cC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ix(s){let e=w.useContext(nc);return Wn(e,cC(s)),e}function uC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:y}={}){let p=Zs(),b=Vi(),k=Ru(s,{relative:u});return w.useCallback(T=>{if(BS(T,e)){T.preventDefault();let I=t!==void 0?t:yu(b)===yu(k),H=()=>p(s,{replace:I,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g});y?w.startTransition(()=>H()):H()}},[b,p,k,t,i,e,s,l,u,d,g,y])}function RP(s){Zr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(yp(s)),t=w.useRef(!1),i=Vi(),l=w.useMemo(()=>zS(i.search,t.current?null:e.current),[i.search]),u=Zs(),d=w.useCallback((g,y)=>{const p=yp(typeof g=="function"?g(new URLSearchParams(l)):g);t.current=!0,u("?"+p,y)},[u,l]);return[l,d]}var dC=0,hC=()=>`__${String(++dC)}__`;function fC(){let{router:s}=Ix("useSubmit"),{basename:e}=w.useContext(Lr),t=AS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:g,method:y,encType:p,formData:b,body:k}=qS(u,e);if(d.navigate===!1){let T=d.fetcherKey||hC();await i(T,t,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,flushSync:d.flushSync})}else await l(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function mC(s,{relative:e}={}){let{basename:t}=w.useContext(Lr),i=w.useContext(vi);Wn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ru(s||".",{relative:e})},d=Vi();if(s==null){u.search=d.search;let g=new URLSearchParams(u.search),y=g.getAll("index");if(y.some(b=>b==="")){g.delete("index"),y.filter(k=>k).forEach(k=>g.append("index",k));let b=g.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:da([t,u.pathname])),yu(u)}function gC(s,{relative:e}={}){let t=w.useContext(wx);Wn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Ix("useViewTransitionState"),l=Ru(s,{relative:e});if(!t.isTransitioning)return!1;let u=ga(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ga(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ih(l.pathname,d)!=null||Ih(l.pathname,u)!=null}const pC=()=>{};var i2={};const Dx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},yC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],g=s[t++],y=((l&7)<<18|(u&63)<<12|(d&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Mx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,g=d?s[l+1]:0,y=l+2<s.length,p=y?s[l+2]:0,b=u>>2,k=(u&3)<<4|g>>4;let T=(g&15)<<2|p>>6,I=p&63;y||(I=64,d||(T=64)),i.push(t[b],t[k],t[T],t[I])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Dx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):yC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],g=l<s.length?t[s.charAt(l)]:0;++l;const p=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||g==null||p==null||k==null)throw new vC;const T=u<<2|g>>4;if(i.push(T),p!==64){const I=g<<4&240|p>>2;if(i.push(I),k!==64){const H=p<<6&192|k;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class vC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bC=function(s){const e=Dx(s);return Mx.encodeByteArray(e,!0)},Dh=function(s){return bC(s).replace(/\./g,"")},Lx=function(s){try{return Mx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function wC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const xC=()=>wC().__FIREBASE_DEFAULTS__,_C=()=>{if(typeof process>"u"||typeof i2>"u")return;const s=i2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},kC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Lx(s[1]);return e&&JSON.parse(e)},nf=()=>{try{return pC()||xC()||_C()||kC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Px=s=>nf()?.emulatorHosts?.[s],Ox=s=>{const e=Px(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Vx=()=>nf()?.config,Ux=s=>nf()?.[`_${s}`];class jC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function ho(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ry(s){return(await fetch(s,{credentials:"include"})).ok}function Bx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const cu={};function EC(){const s={prod:[],emulator:[]};for(const e of Object.keys(cu))cu[e]?s.emulator.push(e):s.prod.push(e);return s}function TC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let a2=!1;function iy(s,e){if(typeof window>"u"||typeof document>"u"||!ho(window.location.host)||cu[s]===e||cu[s]||a2)return;cu[s]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=EC().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function g(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function y(T,I){T.setAttribute("width","24"),T.setAttribute("id",I),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{a2=!0,d()},T}function b(T,I){T.setAttribute("id",I),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function k(){const T=TC(i),I=t("text"),H=document.getElementById(I)||document.createElement("span"),K=t("learnmore"),B=document.getElementById(K)||document.createElement("a"),Y=t("preprendIcon"),te=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Q=T.element;g(Q),b(B,K);const pe=p();y(te,Y),Q.append(te,H,B,pe),document.body.appendChild(Q)}u?(H.innerText="Preview backend disconnected.",te.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(te.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function SC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function CC(){const s=nf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function AC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function RC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IC(){const s=Xs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function DC(){return!CC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zx(){try{return typeof indexedDB=="object"}catch{return!1}}function Fx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function MC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const LC="FirebaseError";class bi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=LC,Object.setPrototypeOf(this,bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yo.prototype.create)}}class Yo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PC(u,i):"Error",g=`${this.serviceName}: ${d} (${l}).`;return new bi(l,g,i)}}function PC(s,e){return s.replace(OC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const OC=/\{\$([^}]+)}/g;function VC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(o2(u)&&o2(d)){if(!pa(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function o2(s){return s!==null&&typeof s=="object"}function Iu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function su(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function ru(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function UC(s,e){const t=new BC(s,e);return t.subscribe.bind(t)}class BC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");zC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Dg),l.error===void 0&&(l.error=Dg),l.complete===void 0&&(l.complete=Dg);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Dg(){}function jn(s){return s&&s._delegate?s._delegate:s}class ei{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mo="[DEFAULT]";class FC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new jC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qC(e))try{this.getOrInitializeService({instanceIdentifier:Mo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mo){return this.instances.has(e)}getOptions(e=Mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(u);i===g&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:HC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Mo){return this.component?this.component.multipleInstances?e:Mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(s){return s===Mo?void 0:s}function qC(s){return s.instantiationMode==="EAGER"}class $C{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var en;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(en||(en={}));const WC={debug:en.DEBUG,verbose:en.VERBOSE,info:en.INFO,warn:en.WARN,error:en.ERROR,silent:en.SILENT},GC=en.INFO,KC={[en.DEBUG]:"log",[en.VERBOSE]:"log",[en.INFO]:"info",[en.WARN]:"warn",[en.ERROR]:"error"},YC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=KC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ay{constructor(e){this.name=e,this._logLevel=GC,this._logHandler=YC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in en))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,en.DEBUG,...e),this._logHandler(this,en.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,en.VERBOSE,...e),this._logHandler(this,en.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,en.INFO,...e),this._logHandler(this,en.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,en.WARN,...e),this._logHandler(this,en.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,en.ERROR,...e),this._logHandler(this,en.ERROR,...e)}}const QC=(s,e)=>e.some(t=>s instanceof t);let l2,c2;function XC(){return l2||(l2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JC(){return c2||(c2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hx=new WeakMap,vp=new WeakMap,qx=new WeakMap,Mg=new WeakMap,oy=new WeakMap;function ZC(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ha(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Hx.set(t,s)}).catch(()=>{}),oy.set(e,s),e}function eN(s){if(vp.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});vp.set(s,e)}let bp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return vp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||qx.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ha(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function tN(s){bp=s(bp)}function nN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Lg(this),e,...t);return qx.set(i,e.sort?e.sort():[e]),ha(i)}:JC().includes(s)?function(...e){return s.apply(Lg(this),e),ha(Hx.get(this))}:function(...e){return ha(s.apply(Lg(this),e))}}function sN(s){return typeof s=="function"?nN(s):(s instanceof IDBTransaction&&eN(s),QC(s,XC())?new Proxy(s,bp):s)}function ha(s){if(s instanceof IDBRequest)return ZC(s);if(Mg.has(s))return Mg.get(s);const e=sN(s);return e!==s&&(Mg.set(s,e),oy.set(e,s)),e}const Lg=s=>oy.get(s);function sf(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),g=ha(d);return i&&d.addEventListener("upgradeneeded",y=>{i(ha(d.result),y.oldVersion,y.newVersion,ha(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{u&&y.addEventListener("close",()=>u()),l&&y.addEventListener("versionchange",p=>l(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}function Pg(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ha(t).then(()=>{})}const rN=["get","getKey","getAll","getAllKeys","count"],iN=["put","add","delete","clear"],Og=new Map;function u2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Og.get(e))return Og.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=iN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||rN.includes(t)))return;const u=async function(d,...g){const y=this.transaction(d,l?"readwrite":"readonly");let p=y.store;return i&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),l&&y.done]))[0]};return Og.set(e,u),u}tN(s=>({...s,get:(e,t,i)=>u2(e,t)||s.get(e,t,i),has:(e,t)=>!!u2(e,t)||s.has(e,t)}));class aN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function oN(s){return s.getComponent()?.type==="VERSION"}const wp="@firebase/app",d2="0.14.7";const ya=new ay("@firebase/app"),lN="@firebase/app-compat",cN="@firebase/analytics-compat",uN="@firebase/analytics",dN="@firebase/app-check-compat",hN="@firebase/app-check",fN="@firebase/auth",mN="@firebase/auth-compat",gN="@firebase/database",pN="@firebase/data-connect",yN="@firebase/database-compat",vN="@firebase/functions",bN="@firebase/functions-compat",wN="@firebase/installations",xN="@firebase/installations-compat",_N="@firebase/messaging",kN="@firebase/messaging-compat",jN="@firebase/performance",EN="@firebase/performance-compat",TN="@firebase/remote-config",SN="@firebase/remote-config-compat",CN="@firebase/storage",NN="@firebase/storage-compat",AN="@firebase/firestore",RN="@firebase/ai",IN="@firebase/firestore-compat",DN="firebase",MN="12.8.0";const xp="[DEFAULT]",LN={[wp]:"fire-core",[lN]:"fire-core-compat",[uN]:"fire-analytics",[cN]:"fire-analytics-compat",[hN]:"fire-app-check",[dN]:"fire-app-check-compat",[fN]:"fire-auth",[mN]:"fire-auth-compat",[gN]:"fire-rtdb",[pN]:"fire-data-connect",[yN]:"fire-rtdb-compat",[vN]:"fire-fn",[bN]:"fire-fn-compat",[wN]:"fire-iid",[xN]:"fire-iid-compat",[_N]:"fire-fcm",[kN]:"fire-fcm-compat",[jN]:"fire-perf",[EN]:"fire-perf-compat",[TN]:"fire-rc",[SN]:"fire-rc-compat",[CN]:"fire-gcs",[NN]:"fire-gcs-compat",[AN]:"fire-fst",[IN]:"fire-fst-compat",[RN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Mh=new Map,PN=new Map,_p=new Map;function h2(s,e){try{s.container.addComponent(e)}catch(t){ya.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function pi(s){const e=s.name;if(_p.has(e))return ya.debug(`There were multiple attempts to register component ${e}.`),!1;_p.set(e,s);for(const t of Mh.values())h2(t,s);for(const t of PN.values())h2(t,s);return!0}function Qo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function br(s){return s==null?!1:s.settings!==void 0}const ON={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},to=new Yo("app","Firebase",ON);class VN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw to.create("app-deleted",{appName:this._name})}}const Xo=MN;function ly(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:xp,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw to.create("bad-app-name",{appName:String(l)});if(t||(t=Vx()),!t)throw to.create("no-options");const u=Mh.get(l);if(u){if(pa(t,u.options)&&pa(i,u.config))return u;throw to.create("duplicate-app",{appName:l})}const d=new $C(l);for(const y of _p.values())d.addComponent(y);const g=new VN(t,i,d);return Mh.set(l,g),g}function Du(s=xp){const e=Mh.get(s);if(!e&&s===xp&&Vx())return ly();if(!e)throw to.create("no-app",{appName:s});return e}function xr(s,e,t){let i=LN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ya.warn(d.join(" "));return}pi(new ei(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UN="firebase-heartbeat-database",BN=1,vu="firebase-heartbeat-store";let Vg=null;function $x(){return Vg||(Vg=sf(UN,BN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(vu)}catch(t){console.warn(t)}}}}).catch(s=>{throw to.create("idb-open",{originalErrorMessage:s.message})})),Vg}async function zN(s){try{const t=(await $x()).transaction(vu),i=await t.objectStore(vu).get(Wx(s));return await t.done,i}catch(e){if(e instanceof bi)ya.warn(e.message);else{const t=to.create("idb-get",{originalErrorMessage:e?.message});ya.warn(t.message)}}}async function f2(s,e){try{const i=(await $x()).transaction(vu,"readwrite");await i.objectStore(vu).put(e,Wx(s)),await i.done}catch(t){if(t instanceof bi)ya.warn(t.message);else{const i=to.create("idb-set",{originalErrorMessage:t?.message});ya.warn(i.message)}}}function Wx(s){return`${s.name}!${s.options.appId}`}const FN=1024,HN=30;class qN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=m2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>HN){const l=GN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ya.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=m2(),{heartbeatsToSend:t,unsentEntries:i}=$N(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ya.warn(e),""}}}function m2(){return new Date().toISOString().substring(0,10)}function $N(s,e=FN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),g2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),g2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class WN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zx()?Fx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return f2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return f2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function g2(s){return Dh(JSON.stringify({version:2,heartbeats:s})).length}function GN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function KN(s){pi(new ei("platform-logger",e=>new aN(e),"PRIVATE")),pi(new ei("heartbeat",e=>new qN(e),"PRIVATE")),xr(wp,d2,s),xr(wp,d2,"esm2020"),xr("fire-js","")}KN("");function Gx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YN=Gx,Kx=new Yo("auth","Firebase",Gx());const Lh=new ay("@firebase/auth");function QN(s,...e){Lh.logLevel<=en.WARN&&Lh.warn(`Auth (${Xo}): ${s}`,...e)}function xh(s,...e){Lh.logLevel<=en.ERROR&&Lh.error(`Auth (${Xo}): ${s}`,...e)}function ti(s,...e){throw uy(s,...e)}function mi(s,...e){return uy(s,...e)}function cy(s,e,t){const i={...YN(),[e]:t};return new Yo("auth","Firebase",i).create(e,{appName:s.name})}function fa(s){return cy(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XN(s,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ti(s,"argument-error"),cy(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function uy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Kx.create(s,...e)}function kt(s,e,...t){if(!s)throw uy(e,...t)}function oa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw xh(e),new Error(e)}function va(s,e){s||oa(e)}function kp(){return typeof self<"u"&&self.location?.href||""}function JN(){return p2()==="http:"||p2()==="https:"}function p2(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||AC()||"connection"in navigator)?navigator.onLine:!0}function eA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Mu{constructor(e,t){this.shortDelay=e,this.longDelay=t,va(t>e,"Short delay should be less than long delay!"),this.isMobile=SC()||RC()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dy(s,e){va(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Yx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const nA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sA=new Mu(3e4,6e4);function xa(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function _a(s,e,t,i,l={}){return Qx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const g=Iu({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:y,...u};return NC()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&ho(s.emulatorConfig.host)&&(p.credentials="include"),Yx.fetch()(await Xx(s,s.config.apiHost,t,g),p)})}async function Qx(s,e,t){s._canInitEmulator=!1;const i={...tA,...e};try{const l=new iA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const g=u.ok?d.errorMessage:d.error.message,[y,p]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw ah(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw ah(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw cy(s,b,p);ti(s,b)}}catch(l){if(l instanceof bi)throw l;ti(s,"network-request-failed",{message:String(l)})}}async function Lu(s,e,t,i,l={}){const u=await _a(s,e,t,i,l);return"mfaPendingCredential"in u&&ti(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Xx(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?dy(s.config,l):`${s.config.apiScheme}://${l}`;return nA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(mi(this.auth,"network-request-failed")),sA.get())})}}function ah(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=mi(s,e,i);return l.customData._tokenResponse=t,l}function y2(s){return s!==void 0&&s.enterprise!==void 0}class aA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oA(s,e){return _a(s,"GET","/v2/recaptchaConfig",xa(s,e))}async function lA(s,e){return _a(s,"POST","/v1/accounts:delete",e)}async function Ph(s,e){return _a(s,"POST","/v1/accounts:lookup",e)}function uu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cA(s,e=!1){const t=jn(s),i=await t.getIdToken(e),l=hy(i);kt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:uu(Ug(l.auth_time)),issuedAtTime:uu(Ug(l.iat)),expirationTime:uu(Ug(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ug(s){return Number(s)*1e3}function hy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Lx(t);return l?JSON.parse(l):(xh("Failed to decode base64 JWT payload"),null)}catch(l){return xh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function v2(s){const e=hy(s);return kt(e,"internal-error"),kt(typeof e.exp<"u","internal-error"),kt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function bu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof bi&&uA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function uA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class dA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class jp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=uu(this.lastLoginAt),this.creationTime=uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oh(s){const e=s.auth,t=await s.getIdToken(),i=await bu(s,Ph(e,{idToken:t}));kt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?Jx(l.providerUserInfo):[],d=fA(s.providerData,u),g=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,p=g?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new jp(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(s,b)}async function hA(s){const e=jn(s);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function Jx(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mA(s,e){const t=await Qx(s,{},async()=>{const i=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await Xx(s,l,"/v1/token",`key=${u}`),g=await s._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:i};return s.emulatorConfig&&ho(s.emulatorConfig.host)&&(y.credentials="include"),Yx.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function gA(s,e){return _a(s,"POST","/v2/accounts:revokeToken",xa(s,e))}class zl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kt(e.idToken,"internal-error"),kt(typeof e.idToken<"u","internal-error"),kt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):v2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){kt(e.length!==0,"internal-error");const t=v2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new zl;return i&&(kt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(kt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(kt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zl,this.toJSON())}_performRefresh(){return oa("not implemented")}}function Ka(s,e){kt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class hi{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new jp(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await bu(this,this.stsTokenManager.getToken(this.auth,e));return kt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cA(this,e)}reload(){return hA(this)}_assign(e){this!==e&&(kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Oh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(fa(this.auth));const e=await this.getIdToken();return await bu(this,lA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,p=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:k,emailVerified:T,isAnonymous:I,providerData:H,stsTokenManager:K}=t;kt(k&&K,e,"internal-error");const B=zl.fromJSON(this.name,K);kt(typeof k=="string",e,"internal-error"),Ka(i,e.name),Ka(l,e.name),kt(typeof T=="boolean",e,"internal-error"),kt(typeof I=="boolean",e,"internal-error"),Ka(u,e.name),Ka(d,e.name),Ka(g,e.name),Ka(y,e.name),Ka(p,e.name),Ka(b,e.name);const Y=new hi({uid:k,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:I,photoURL:d,phoneNumber:u,tenantId:g,stsTokenManager:B,createdAt:p,lastLoginAt:b});return H&&Array.isArray(H)&&(Y.providerData=H.map(te=>({...te}))),y&&(Y._redirectEventId=y),Y}static async _fromIdTokenResponse(e,t,i=!1){const l=new zl;l.updateFromServerResponse(t);const u=new hi({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Oh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];kt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?Jx(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,g=new zl;g.updateFromIdToken(i);const y=new hi({uid:l.localId,auth:e,stsTokenManager:g,isAnonymous:d}),p={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new jp(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(y,p),y}}const b2=new Map;function la(s){va(s instanceof Function,"Expected a class definition");let e=b2.get(s);return e?(va(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,b2.set(s,e),e)}class Zx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Zx.type="NONE";const w2=Zx;function _h(s,e,t){return`firebase:${s}:${e}:${t}`}class Fl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=_h(this.userKey,l.apiKey,u),this.fullPersistenceKey=_h("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?hi._fromGetAccountInfoResponse(this.auth,t,e):null}return hi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Fl(la(w2),e,i);const l=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=l[0]||la(w2);const d=_h(i,e.config.apiKey,e.name);let g=null;for(const p of t)try{const b=await p._get(d);if(b){let k;if(typeof b=="string"){const T=await Ph(e,{idToken:b}).catch(()=>{});if(!T)break;k=await hi._fromGetAccountInfoResponse(e,T,b)}else k=hi._fromJSON(e,b);p!==u&&(g=k),u=p;break}}catch{}const y=l.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!y.length?new Fl(u,e,i):(u=y[0],g&&await u._set(d,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(d)}catch{}})),new Fl(u,e,i))}}function x2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(s_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(e_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(i_(e))return"Blackberry";if(a_(e))return"Webos";if(t_(e))return"Safari";if((e.includes("chrome/")||n_(e))&&!e.includes("edge/"))return"Chrome";if(r_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function e_(s=Xs()){return/firefox\//i.test(s)}function t_(s=Xs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function n_(s=Xs()){return/crios\//i.test(s)}function s_(s=Xs()){return/iemobile/i.test(s)}function r_(s=Xs()){return/android/i.test(s)}function i_(s=Xs()){return/blackberry/i.test(s)}function a_(s=Xs()){return/webos/i.test(s)}function fy(s=Xs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function pA(s=Xs()){return fy(s)&&!!window.navigator?.standalone}function yA(){return IC()&&document.documentMode===10}function o_(s=Xs()){return fy(s)||r_(s)||a_(s)||i_(s)||/windows phone/i.test(s)||s_(s)}function l_(s,e=[]){let t;switch(s){case"Browser":t=x2(Xs());break;case"Worker":t=`${x2(Xs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${i}`}class vA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,g)=>{try{const y=e(u);d(y)}catch(y){g(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bA(s,e={}){return _a(s,"GET","/v2/passwordPolicy",xa(s,e))}const wA=6;class xA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??wA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _A{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _2(this),this.idTokenSubscription=new _2(this),this.beforeStateQueue=new vA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=la(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await hi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(br(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&g?.user&&(i=g.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(fa(this));const t=e?jn(e):null;return t&&kt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(fa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(fa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(la(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bA(this),t=new xA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await gA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&la(e)||this._popupRedirectResolver;kt(t,this,"argument-error"),this.redirectPersistenceManager=await Fl.create(this,[la(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(kt(g,this,"internal-error"),g.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=l_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&QN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ka(s){return jn(s)}class _2{constructor(e){this.auth=e,this.observer=null,this.addObserver=UC(t=>this.observer=t)}get next(){return kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let rf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kA(s){rf=s}function c_(s){return rf.loadJS(s)}function jA(){return rf.recaptchaEnterpriseScript}function EA(){return rf.gapiScript}function TA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class SA{constructor(){this.enterprise=new CA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NA="recaptcha-enterprise",u_="NO_RECAPTCHA";class AA{constructor(e){this.type=NA,this.auth=ka(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,g)=>{oA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const p=new aA(y);return u.tenantId==null?u._agentRecaptchaConfig=p:u._tenantRecaptchaConfigs[u.tenantId]=p,d(p.siteKey)}}).catch(y=>{g(y)})})}function l(u,d,g){const y=window.grecaptcha;y2(y)?y.enterprise.ready(()=>{y.enterprise.execute(u,{action:e}).then(p=>{d(p)}).catch(()=>{d(u_)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(g=>{if(!t&&y2(window.grecaptcha))l(g,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=jA();y.length!==0&&(y+=g),c_(y).then(()=>{l(g,u,d)}).catch(p=>{d(p)})}}).catch(g=>{d(g)})})}}async function k2(s,e,t,i=!1,l=!1){const u=new AA(s);let d;if(l)d=u_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,p=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return i?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function Vh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await k2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await k2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function RA(s,e){const t=Qo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(pa(u,e??{}))return l;ti(l,"already-initialized")}return t.initialize({options:e})}function IA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(la);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function DA(s,e,t){const i=ka(s);kt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=d_(e),{host:d,port:g}=MA(e),y=g===null?"":`:${g}`,p={url:`${u}//${d}${y}/`},b=Object.freeze({host:d,port:g,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){kt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),kt(pa(p,i.config.emulator)&&pa(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,ho(d)?(ry(`${u}//${d}${y}`),iy("Auth",!0)):LA()}function d_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function MA(s){const e=d_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:j2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:j2(d)}}}function j2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function LA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class my{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oa("not implemented")}_getIdTokenResponse(e){return oa("not implemented")}_linkToIdToken(e,t){return oa("not implemented")}_getReauthenticationResolver(e){return oa("not implemented")}}async function PA(s,e){return _a(s,"POST","/v1/accounts:signUp",e)}async function OA(s,e){return Lu(s,"POST","/v1/accounts:signInWithPassword",xa(s,e))}async function h_(s,e){return _a(s,"POST","/v1/accounts:sendOobCode",xa(s,e))}async function VA(s,e){return h_(s,e)}async function UA(s,e){return h_(s,e)}async function BA(s,e){return Lu(s,"POST","/v1/accounts:signInWithEmailLink",xa(s,e))}async function zA(s,e){return Lu(s,"POST","/v1/accounts:signInWithEmailLink",xa(s,e))}class wu extends my{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new wu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,t,"signInWithPassword",OA);case"emailLink":return BA(e,{email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,i,"signUpPassword",PA);case"emailLink":return zA(e,{idToken:t,email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hl(s,e){return Lu(s,"POST","/v1/accounts:signInWithIdp",xa(s,e))}const FA="http://localhost";class zo extends my{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ti("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new zo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:FA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}function HA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qA(s){const e=su(ru(s)).link,t=e?su(ru(e)).deep_link_id:null,i=su(ru(s)).deep_link_id;return(i?su(ru(i)).link:null)||i||t||e||s}class gy{constructor(e){const t=su(ru(e)),i=t.apiKey??null,l=t.oobCode??null,u=HA(t.mode??null);kt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qA(e);try{return new gy(t)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=gy.parseLink(t);return kt(i,"argument-error"),wu._fromEmailAndCode(e,i.code,i.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class py{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pu extends py{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qa extends Pu{constructor(){super("facebook.com")}static credential(e){return zo._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qa.credential(e.oauthAccessToken)}catch{return null}}}Qa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qa.PROVIDER_ID="facebook.com";class aa extends Pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zo._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return aa.credential(t,i)}catch{return null}}}aa.GOOGLE_SIGN_IN_METHOD="google.com";aa.PROVIDER_ID="google.com";class Xa extends Pu{constructor(){super("github.com")}static credential(e){return zo._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xa.credential(e.oauthAccessToken)}catch{return null}}}Xa.GITHUB_SIGN_IN_METHOD="github.com";Xa.PROVIDER_ID="github.com";class Ja extends Pu{constructor(){super("twitter.com")}static credential(e,t){return zo._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ja.credential(t,i)}catch{return null}}}Ja.TWITTER_SIGN_IN_METHOD="twitter.com";Ja.PROVIDER_ID="twitter.com";async function $A(s,e){return Lu(s,"POST","/v1/accounts:signUp",xa(s,e))}class Fo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await hi._fromIdTokenResponse(e,i,l),d=E2(i);return new Fo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=E2(i);return new Fo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function E2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Uh extends bi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Uh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Uh(e,t,i,l)}}function f_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Uh._fromErrorAndOperation(s,u,e,i):u})}async function WA(s,e,t=!1){const i=await bu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Fo._forOperation(s,"link",i)}async function GA(s,e,t=!1){const{auth:i}=s;if(br(i.app))return Promise.reject(fa(i));const l="reauthenticate";try{const u=await bu(s,f_(i,l,e,s),t);kt(u.idToken,i,"internal-error");const d=hy(u.idToken);kt(d,i,"internal-error");const{sub:g}=d;return kt(s.uid===g,i,"user-mismatch"),Fo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ti(i,"user-mismatch"),u}}async function m_(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i="signIn",l=await f_(s,i,e),u=await Fo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function KA(s,e){return m_(ka(s),e)}async function g_(s){const e=ka(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YA(s,e,t){const i=ka(s);await Vh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",UA)}async function QA(s,e,t){if(br(s.app))return Promise.reject(fa(s));const i=ka(s),d=await Vh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$A).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&g_(s),y}),g=await Fo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(g.user),g}function XA(s,e,t){return br(s.app)?Promise.reject(fa(s)):KA(jn(s),rc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&g_(s),i})}async function IP(s,e){const t=jn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await VA(t.auth,l);u!==s.email&&await s.reload()}function Bg(s,e){return jn(s).setPersistence(e)}function JA(s,e,t,i){return jn(s).onIdTokenChanged(e,t,i)}function ZA(s,e,t){return jn(s).beforeAuthStateChanged(e,t)}function e4(s,e,t,i){return jn(s).onAuthStateChanged(e,t,i)}function t4(s){return jn(s).signOut()}const Bh="__sak";class p_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bh,"1"),this.storage.removeItem(Bh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const n4=1e3,s4=10;class y_ extends p_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=o_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,g,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},n4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}y_.type="LOCAL";const kh=y_;class v_ extends p_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}v_.type="SESSION";const yy=v_;function r4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new af(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const g=Array.from(d).map(async p=>p(t.origin,u)),y=await r4(g);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}af.receivers=[];function vy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class i4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((g,y)=>{const p=vy("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const T=k;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),g(T.data.response);break;default:clearTimeout(b),clearTimeout(u),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ii(){return window}function a4(s){Ii().location.href=s}function b_(){return typeof Ii().WorkerGlobalScope<"u"&&typeof Ii().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return b_()?self:null}const w_="firebaseLocalStorageDb",u4=1,zh="firebaseLocalStorage",x_="fbase_key";class Ou{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function of(s,e){return s.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function d4(){const s=indexedDB.deleteDatabase(w_);return new Ou(s).toPromise()}function Ep(){const s=indexedDB.open(w_,u4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(zh,{keyPath:x_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(zh)?e(i):(i.close(),await d4(),e(await Ep()))})})}async function T2(s,e,t){const i=of(s,!0).put({[x_]:e,value:t});return new Ou(i).toPromise()}async function h4(s,e){const t=of(s,!1).get(e),i=await new Ou(t).toPromise();return i===void 0?null:i.value}function S2(s,e){const t=of(s,!0).delete(e);return new Ou(t).toPromise()}const f4=800,m4=3;class __{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ep(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return b_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=af._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new i4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ep();return await T2(e,Bh,"1"),await S2(e,Bh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>T2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>S2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=of(l,!1).getAll();return new Ou(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}__.type="LOCAL";const g4=__;new Mu(3e4,6e4);function k_(s,e){return e?la(e):(kt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class by extends my{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function p4(s){return m_(s.auth,new by(s),s.bypassAuthState)}function y4(s){const{auth:e,user:t}=s;return kt(t,e,"internal-error"),GA(t,new by(s),s.bypassAuthState)}async function v4(s){const{auth:e,user:t}=s;return kt(t,e,"internal-error"),WA(t,new by(s),s.bypassAuthState)}class j_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:g}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return p4;case"linkViaPopup":case"linkViaRedirect":return v4;case"reauthViaPopup":case"reauthViaRedirect":return y4;default:ti(this.auth,"internal-error")}}resolve(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const b4=new Mu(2e3,1e4);async function w4(s,e,t){if(br(s.app))return Promise.reject(mi(s,"operation-not-supported-in-this-environment"));const i=ka(s);XN(s,e,py);const l=k_(i,t);return new Lo(i,"signInViaPopup",e,l).executeNotNull()}class Lo extends j_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Lo.currentPopupAction&&Lo.currentPopupAction.cancel(),Lo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kt(e,this.auth,"internal-error"),e}async onExecution(){va(this.filter.length===1,"Popup operations only handle one event");const e=vy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,b4.get())};e()}}Lo.currentPopupAction=null;const x4="pendingRedirect",jh=new Map;class _4 extends j_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=jh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}jh.set(this.auth._key(),e)}return this.bypassAuthState||jh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(s,e){const t=T4(e),i=E4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function j4(s,e){jh.set(s._key(),e)}function E4(s){return la(s._redirectPersistence)}function T4(s){return _h(x4,s.config.apiKey,s.name)}async function S4(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i=ka(s),l=k_(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const C4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!E_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(mi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C4&&this.cachedEventUids.clear(),this.cachedEventUids.has(C2(e))}saveEventToCache(e){this.cachedEventUids.add(C2(e)),this.lastProcessedEventTime=Date.now()}}function C2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function E_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function A4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return E_(s);default:return!1}}async function R4(s,e={}){return _a(s,"GET","/v1/projects",e)}const I4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,D4=/^https?/;async function M4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await R4(s);for(const t of e)try{if(L4(t))return}catch{}ti(s,"unauthorized-domain")}function L4(s){const e=kp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!D4.test(t))return!1;if(I4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const P4=new Mu(3e4,6e4);function N2(){const s=Ii().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function O4(s){return new Promise((e,t)=>{function i(){N2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{N2(),t(mi(s,"network-request-failed"))},timeout:P4.get()})}if(Ii().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ii().gapi?.load)i();else{const l=TA("iframefcb");return Ii()[l]=()=>{gapi.load?i():t(mi(s,"network-request-failed"))},c_(`${EA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Eh=null,e})}let Eh=null;function V4(s){return Eh=Eh||O4(s),Eh}const U4=new Mu(5e3,15e3),B4="__/auth/iframe",z4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},H4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q4(s){const e=s.config;kt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dy(e,z4):`https://${s.config.authDomain}/${B4}`,i={apiKey:e.apiKey,appName:s.name,v:Xo},l=H4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Iu(i).slice(1)}`}async function $4(s){const e=await V4(s),t=Ii().gapi;return kt(t,s,"internal-error"),e.open({where:document.body,url:q4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=mi(s,"network-request-failed"),g=Ii().setTimeout(()=>{u(d)},U4.get());function y(){Ii().clearTimeout(g),l(i)}i.ping(y).then(y,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class A2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(s,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let g="";const y={...W4,width:i.toString(),height:l.toString(),top:u,left:d},p=Xs().toLowerCase();t&&(g=n_(p)?Y4:t),e_(p)&&(e=e||Q4,y.scrollbars="yes");const b=Object.entries(y).reduce((T,[I,H])=>`${T}${I}=${H},`,"");if(pA(p)&&g!=="_self")return J4(e||"",g),new A2(null);const k=window.open(e||"",g,b);kt(k,s,"popup-blocked");try{k.focus()}catch{}return new A2(k)}function J4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function R2(s,e,t,i,l,u){kt(s.config.authDomain,s,"auth-domain-config-required"),kt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Xo,eventId:l};if(e instanceof py){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",VC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,k]of Object.entries({}))d[b]=k}if(e instanceof Pu){const b=e.getScopes().filter(k=>k!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const y=await s._getAppCheckToken(),p=y?`#${tR}=${encodeURIComponent(y)}`:"";return`${nR(s)}?${Iu(g).slice(1)}${p}`}function nR({config:s}){return s.emulator?dy(s,eR):`https://${s.authDomain}/${Z4}`}const zg="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yy,this._completeRedirectFn=S4,this._overrideRedirectResult=j4}async _openPopup(e,t,i,l){va(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await R2(e,t,i,kp(),l);return X4(e,u,vy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await R2(e,t,i,kp(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(va(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new N4(e);return t.register("authEvent",l=>(kt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zg,{type:zg},l=>{const u=l?.[0]?.[zg];u!==void 0&&t(!!u),ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=M4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return o_()||t_()||fy()}}const rR=sR;var I2="@firebase/auth",D2="1.12.0";class iR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(s){pi(new ei("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=i.options;kt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:g,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:l_(s)},p=new _A(i,l,u,y);return IA(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),pi(new ei("auth-internal",e=>{const t=ka(e.getProvider("auth").getImmediate());return(i=>new iR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xr(I2,D2,aR(s)),xr(I2,D2,"esm2020")}const lR=300,cR=Ux("authIdTokenMaxAge")||lR;let M2=null;const uR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;M2!==l&&(M2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function T_(s=Du()){const e=Qo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=RA(s,{popupRedirectResolver:rR,persistence:[g4,kh,yy]}),i=Ux("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZA(t,d,()=>d(t.currentUser)),JA(t,g=>d(g))}}const l=Px("auth");return l&&DA(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=mi("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var L2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var no,S_;(function(){var s;function e(M,E){function L(){}L.prototype=E.prototype,M.F=E.prototype,M.prototype=new L,M.prototype.constructor=M,M.D=function(U,P,D){for(var A=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)A[Pe-2]=arguments[Pe];return E.prototype[P].apply(U,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(M,E,L){L||(L=0);const U=Array(16);if(typeof E=="string")for(var P=0;P<16;++P)U[P]=E.charCodeAt(L++)|E.charCodeAt(L++)<<8|E.charCodeAt(L++)<<16|E.charCodeAt(L++)<<24;else for(P=0;P<16;++P)U[P]=E[L++]|E[L++]<<8|E[L++]<<16|E[L++]<<24;E=M.g[0],L=M.g[1],P=M.g[2];let D=M.g[3],A;A=E+(D^L&(P^D))+U[0]+3614090360&4294967295,E=L+(A<<7&4294967295|A>>>25),A=D+(P^E&(L^P))+U[1]+3905402710&4294967295,D=E+(A<<12&4294967295|A>>>20),A=P+(L^D&(E^L))+U[2]+606105819&4294967295,P=D+(A<<17&4294967295|A>>>15),A=L+(E^P&(D^E))+U[3]+3250441966&4294967295,L=P+(A<<22&4294967295|A>>>10),A=E+(D^L&(P^D))+U[4]+4118548399&4294967295,E=L+(A<<7&4294967295|A>>>25),A=D+(P^E&(L^P))+U[5]+1200080426&4294967295,D=E+(A<<12&4294967295|A>>>20),A=P+(L^D&(E^L))+U[6]+2821735955&4294967295,P=D+(A<<17&4294967295|A>>>15),A=L+(E^P&(D^E))+U[7]+4249261313&4294967295,L=P+(A<<22&4294967295|A>>>10),A=E+(D^L&(P^D))+U[8]+1770035416&4294967295,E=L+(A<<7&4294967295|A>>>25),A=D+(P^E&(L^P))+U[9]+2336552879&4294967295,D=E+(A<<12&4294967295|A>>>20),A=P+(L^D&(E^L))+U[10]+4294925233&4294967295,P=D+(A<<17&4294967295|A>>>15),A=L+(E^P&(D^E))+U[11]+2304563134&4294967295,L=P+(A<<22&4294967295|A>>>10),A=E+(D^L&(P^D))+U[12]+1804603682&4294967295,E=L+(A<<7&4294967295|A>>>25),A=D+(P^E&(L^P))+U[13]+4254626195&4294967295,D=E+(A<<12&4294967295|A>>>20),A=P+(L^D&(E^L))+U[14]+2792965006&4294967295,P=D+(A<<17&4294967295|A>>>15),A=L+(E^P&(D^E))+U[15]+1236535329&4294967295,L=P+(A<<22&4294967295|A>>>10),A=E+(P^D&(L^P))+U[1]+4129170786&4294967295,E=L+(A<<5&4294967295|A>>>27),A=D+(L^P&(E^L))+U[6]+3225465664&4294967295,D=E+(A<<9&4294967295|A>>>23),A=P+(E^L&(D^E))+U[11]+643717713&4294967295,P=D+(A<<14&4294967295|A>>>18),A=L+(D^E&(P^D))+U[0]+3921069994&4294967295,L=P+(A<<20&4294967295|A>>>12),A=E+(P^D&(L^P))+U[5]+3593408605&4294967295,E=L+(A<<5&4294967295|A>>>27),A=D+(L^P&(E^L))+U[10]+38016083&4294967295,D=E+(A<<9&4294967295|A>>>23),A=P+(E^L&(D^E))+U[15]+3634488961&4294967295,P=D+(A<<14&4294967295|A>>>18),A=L+(D^E&(P^D))+U[4]+3889429448&4294967295,L=P+(A<<20&4294967295|A>>>12),A=E+(P^D&(L^P))+U[9]+568446438&4294967295,E=L+(A<<5&4294967295|A>>>27),A=D+(L^P&(E^L))+U[14]+3275163606&4294967295,D=E+(A<<9&4294967295|A>>>23),A=P+(E^L&(D^E))+U[3]+4107603335&4294967295,P=D+(A<<14&4294967295|A>>>18),A=L+(D^E&(P^D))+U[8]+1163531501&4294967295,L=P+(A<<20&4294967295|A>>>12),A=E+(P^D&(L^P))+U[13]+2850285829&4294967295,E=L+(A<<5&4294967295|A>>>27),A=D+(L^P&(E^L))+U[2]+4243563512&4294967295,D=E+(A<<9&4294967295|A>>>23),A=P+(E^L&(D^E))+U[7]+1735328473&4294967295,P=D+(A<<14&4294967295|A>>>18),A=L+(D^E&(P^D))+U[12]+2368359562&4294967295,L=P+(A<<20&4294967295|A>>>12),A=E+(L^P^D)+U[5]+4294588738&4294967295,E=L+(A<<4&4294967295|A>>>28),A=D+(E^L^P)+U[8]+2272392833&4294967295,D=E+(A<<11&4294967295|A>>>21),A=P+(D^E^L)+U[11]+1839030562&4294967295,P=D+(A<<16&4294967295|A>>>16),A=L+(P^D^E)+U[14]+4259657740&4294967295,L=P+(A<<23&4294967295|A>>>9),A=E+(L^P^D)+U[1]+2763975236&4294967295,E=L+(A<<4&4294967295|A>>>28),A=D+(E^L^P)+U[4]+1272893353&4294967295,D=E+(A<<11&4294967295|A>>>21),A=P+(D^E^L)+U[7]+4139469664&4294967295,P=D+(A<<16&4294967295|A>>>16),A=L+(P^D^E)+U[10]+3200236656&4294967295,L=P+(A<<23&4294967295|A>>>9),A=E+(L^P^D)+U[13]+681279174&4294967295,E=L+(A<<4&4294967295|A>>>28),A=D+(E^L^P)+U[0]+3936430074&4294967295,D=E+(A<<11&4294967295|A>>>21),A=P+(D^E^L)+U[3]+3572445317&4294967295,P=D+(A<<16&4294967295|A>>>16),A=L+(P^D^E)+U[6]+76029189&4294967295,L=P+(A<<23&4294967295|A>>>9),A=E+(L^P^D)+U[9]+3654602809&4294967295,E=L+(A<<4&4294967295|A>>>28),A=D+(E^L^P)+U[12]+3873151461&4294967295,D=E+(A<<11&4294967295|A>>>21),A=P+(D^E^L)+U[15]+530742520&4294967295,P=D+(A<<16&4294967295|A>>>16),A=L+(P^D^E)+U[2]+3299628645&4294967295,L=P+(A<<23&4294967295|A>>>9),A=E+(P^(L|~D))+U[0]+4096336452&4294967295,E=L+(A<<6&4294967295|A>>>26),A=D+(L^(E|~P))+U[7]+1126891415&4294967295,D=E+(A<<10&4294967295|A>>>22),A=P+(E^(D|~L))+U[14]+2878612391&4294967295,P=D+(A<<15&4294967295|A>>>17),A=L+(D^(P|~E))+U[5]+4237533241&4294967295,L=P+(A<<21&4294967295|A>>>11),A=E+(P^(L|~D))+U[12]+1700485571&4294967295,E=L+(A<<6&4294967295|A>>>26),A=D+(L^(E|~P))+U[3]+2399980690&4294967295,D=E+(A<<10&4294967295|A>>>22),A=P+(E^(D|~L))+U[10]+4293915773&4294967295,P=D+(A<<15&4294967295|A>>>17),A=L+(D^(P|~E))+U[1]+2240044497&4294967295,L=P+(A<<21&4294967295|A>>>11),A=E+(P^(L|~D))+U[8]+1873313359&4294967295,E=L+(A<<6&4294967295|A>>>26),A=D+(L^(E|~P))+U[15]+4264355552&4294967295,D=E+(A<<10&4294967295|A>>>22),A=P+(E^(D|~L))+U[6]+2734768916&4294967295,P=D+(A<<15&4294967295|A>>>17),A=L+(D^(P|~E))+U[13]+1309151649&4294967295,L=P+(A<<21&4294967295|A>>>11),A=E+(P^(L|~D))+U[4]+4149444226&4294967295,E=L+(A<<6&4294967295|A>>>26),A=D+(L^(E|~P))+U[11]+3174756917&4294967295,D=E+(A<<10&4294967295|A>>>22),A=P+(E^(D|~L))+U[2]+718787259&4294967295,P=D+(A<<15&4294967295|A>>>17),A=L+(D^(P|~E))+U[9]+3951481745&4294967295,M.g[0]=M.g[0]+E&4294967295,M.g[1]=M.g[1]+(P+(A<<21&4294967295|A>>>11))&4294967295,M.g[2]=M.g[2]+P&4294967295,M.g[3]=M.g[3]+D&4294967295}i.prototype.v=function(M,E){E===void 0&&(E=M.length);const L=E-this.blockSize,U=this.C;let P=this.h,D=0;for(;D<E;){if(P==0)for(;D<=L;)l(this,M,D),D+=this.blockSize;if(typeof M=="string"){for(;D<E;)if(U[P++]=M.charCodeAt(D++),P==this.blockSize){l(this,U),P=0;break}}else for(;D<E;)if(U[P++]=M[D++],P==this.blockSize){l(this,U),P=0;break}}this.h=P,this.o+=E},i.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var E=1;E<M.length-8;++E)M[E]=0;E=this.o*8;for(var L=M.length-8;L<M.length;++L)M[L]=E&255,E/=256;for(this.v(M),M=Array(16),E=0,L=0;L<4;++L)for(let U=0;U<32;U+=8)M[E++]=this.g[L]>>>U&255;return M};function u(M,E){var L=g;return Object.prototype.hasOwnProperty.call(L,M)?L[M]:L[M]=E(M)}function d(M,E){this.h=E;const L=[];let U=!0;for(let P=M.length-1;P>=0;P--){const D=M[P]|0;U&&D==E||(L[P]=D,U=!1)}this.g=L}var g={};function y(M){return-128<=M&&M<128?u(M,function(E){return new d([E|0],E<0?-1:0)}):new d([M|0],M<0?-1:0)}function p(M){if(isNaN(M)||!isFinite(M))return k;if(M<0)return B(p(-M));const E=[];let L=1;for(let U=0;M>=L;U++)E[U]=M/L|0,L*=4294967296;return new d(E,0)}function b(M,E){if(M.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(M.charAt(0)=="-")return B(b(M.substring(1),E));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=p(Math.pow(E,8));let U=k;for(let D=0;D<M.length;D+=8){var P=Math.min(8,M.length-D);const A=parseInt(M.substring(D,D+P),E);P<8?(P=p(Math.pow(E,P)),U=U.j(P).add(p(A))):(U=U.j(L),U=U.add(p(A)))}return U}var k=y(0),T=y(1),I=y(16777216);s=d.prototype,s.m=function(){if(K(this))return-B(this).m();let M=0,E=1;for(let L=0;L<this.g.length;L++){const U=this.i(L);M+=(U>=0?U:4294967296+U)*E,E*=4294967296}return M},s.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(H(this))return"0";if(K(this))return"-"+B(this).toString(M);const E=p(Math.pow(M,6));var L=this;let U="";for(;;){const P=pe(L,E).g;L=Y(L,P.j(E));let D=((L.g.length>0?L.g[0]:L.h)>>>0).toString(M);if(L=P,H(L))return D+U;for(;D.length<6;)D="0"+D;U=D+U}},s.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function H(M){if(M.h!=0)return!1;for(let E=0;E<M.g.length;E++)if(M.g[E]!=0)return!1;return!0}function K(M){return M.h==-1}s.l=function(M){return M=Y(this,M),K(M)?-1:H(M)?0:1};function B(M){const E=M.g.length,L=[];for(let U=0;U<E;U++)L[U]=~M.g[U];return new d(L,~M.h).add(T)}s.abs=function(){return K(this)?B(this):this},s.add=function(M){const E=Math.max(this.g.length,M.g.length),L=[];let U=0;for(let P=0;P<=E;P++){let D=U+(this.i(P)&65535)+(M.i(P)&65535),A=(D>>>16)+(this.i(P)>>>16)+(M.i(P)>>>16);U=A>>>16,D&=65535,A&=65535,L[P]=A<<16|D}return new d(L,L[L.length-1]&-2147483648?-1:0)};function Y(M,E){return M.add(B(E))}s.j=function(M){if(H(this)||H(M))return k;if(K(this))return K(M)?B(this).j(B(M)):B(B(this).j(M));if(K(M))return B(this.j(B(M)));if(this.l(I)<0&&M.l(I)<0)return p(this.m()*M.m());const E=this.g.length+M.g.length,L=[];for(var U=0;U<2*E;U++)L[U]=0;for(U=0;U<this.g.length;U++)for(let P=0;P<M.g.length;P++){const D=this.i(U)>>>16,A=this.i(U)&65535,Pe=M.i(P)>>>16,st=M.i(P)&65535;L[2*U+2*P]+=A*st,te(L,2*U+2*P),L[2*U+2*P+1]+=D*st,te(L,2*U+2*P+1),L[2*U+2*P+1]+=A*Pe,te(L,2*U+2*P+1),L[2*U+2*P+2]+=D*Pe,te(L,2*U+2*P+2)}for(M=0;M<E;M++)L[M]=L[2*M+1]<<16|L[2*M];for(M=E;M<2*E;M++)L[M]=0;return new d(L,0)};function te(M,E){for(;(M[E]&65535)!=M[E];)M[E+1]+=M[E]>>>16,M[E]&=65535,E++}function Q(M,E){this.g=M,this.h=E}function pe(M,E){if(H(E))throw Error("division by zero");if(H(M))return new Q(k,k);if(K(M))return E=pe(B(M),E),new Q(B(E.g),B(E.h));if(K(E))return E=pe(M,B(E)),new Q(B(E.g),E.h);if(M.g.length>30){if(K(M)||K(E))throw Error("slowDivide_ only works with positive integers.");for(var L=T,U=E;U.l(M)<=0;)L=we(L),U=we(U);var P=ye(L,1),D=ye(U,1);for(U=ye(U,2),L=ye(L,2);!H(U);){var A=D.add(U);A.l(M)<=0&&(P=P.add(L),D=A),U=ye(U,1),L=ye(L,1)}return E=Y(M,P.j(E)),new Q(P,E)}for(P=k;M.l(E)>=0;){for(L=Math.max(1,Math.floor(M.m()/E.m())),U=Math.ceil(Math.log(L)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),D=p(L),A=D.j(E);K(A)||A.l(M)>0;)L-=U,D=p(L),A=D.j(E);H(D)&&(D=T),P=P.add(D),M=Y(M,A)}return new Q(P,M)}s.B=function(M){return pe(this,M).h},s.and=function(M){const E=Math.max(this.g.length,M.g.length),L=[];for(let U=0;U<E;U++)L[U]=this.i(U)&M.i(U);return new d(L,this.h&M.h)},s.or=function(M){const E=Math.max(this.g.length,M.g.length),L=[];for(let U=0;U<E;U++)L[U]=this.i(U)|M.i(U);return new d(L,this.h|M.h)},s.xor=function(M){const E=Math.max(this.g.length,M.g.length),L=[];for(let U=0;U<E;U++)L[U]=this.i(U)^M.i(U);return new d(L,this.h^M.h)};function we(M){const E=M.g.length+1,L=[];for(let U=0;U<E;U++)L[U]=M.i(U)<<1|M.i(U-1)>>>31;return new d(L,M.h)}function ye(M,E){const L=E>>5;E%=32;const U=M.g.length-L,P=[];for(let D=0;D<U;D++)P[D]=E>0?M.i(D+L)>>>E|M.i(D+L+1)<<32-E:M.i(D+L);return new d(P,M.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,S_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=p,d.fromString=b,no=d}).apply(typeof L2<"u"?L2:typeof self<"u"?self:typeof window<"u"?window:{});var oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var C_,iu,N_,Th,Tp,A_,R_,I_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof oh=="object"&&oh];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var N=0;N<h.length-1;N++){var re=h[N];if(!(re in _))break e;_=_[re]}h=h[h.length-1],N=_[h],v=v(N),v!=N&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},d=this||self;function g(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,_){return h.call.apply(h.bind,arguments)}function p(h,v,_){return p=y,p.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function k(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(N,re,he){for(var Ue=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)Ue[Ot-2]=arguments[Ot];return v.prototype[re].apply(N,Ue)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function I(h){const v=h.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=h[N];return _}return[]}function H(h,v){for(let N=1;N<arguments.length;N++){const re=arguments[N];var _=typeof re;if(_=_!="object"?_:re?Array.isArray(re)?"array":_:"null",_=="array"||_=="object"&&typeof re.length=="number"){_=h.length||0;const he=re.length||0;h.length=_+he;for(let Ue=0;Ue<he;Ue++)h[_+Ue]=re[Ue]}else h.push(re)}}class K{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(h){d.setTimeout(()=>{throw h},0)}function Y(){var h=M;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class te{constructor(){this.h=this.g=null}add(v,_){const N=Q.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var Q=new K(()=>new pe,h=>h.reset());class pe{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let we,ye=!1,M=new te,E=()=>{const h=Promise.resolve(void 0);we=()=>{h.then(L)}};function L(){for(var h;h=Y();){try{h.h.call(h.g)}catch(_){B(_)}var v=Q;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}ye=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Pe(h,v){P.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}k(Pe,P),Pe.prototype.init=function(h,v){const _=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Pe.Z.h.call(this)},Pe.prototype.h=function(){Pe.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var st="closure_listenable_"+(Math.random()*1e6|0),Z=0;function Te(h,v,_,N,re){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=re,this.key=++Z,this.da=this.fa=!1}function qe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ne(h,v,_){for(const N in h)v.call(_,h[N],N,h)}function We(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function V(h){const v={};for(const _ in h)v[_]=h[_];return v}const ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(h,v){let _,N;for(let re=1;re<arguments.length;re++){N=arguments[re];for(_ in N)h[_]=N[_];for(let he=0;he<ce.length;he++)_=ce[he],Object.prototype.hasOwnProperty.call(N,_)&&(h[_]=N[_])}}function Se(h){this.src=h,this.g={},this.h=0}Se.prototype.add=function(h,v,_,N,re){const he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);const Ue=Ve(h,v,N,re);return Ue>-1?(v=h[Ue],_||(v.fa=!1)):(v=new Te(v,this.src,he,!!N,re),v.fa=_,h.push(v)),v};function ke(h,v){const _=v.type;if(_ in h.g){var N=h.g[_],re=Array.prototype.indexOf.call(N,v,void 0),he;(he=re>=0)&&Array.prototype.splice.call(N,re,1),he&&(qe(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ve(h,v,_,N){for(let re=0;re<h.length;++re){const he=h[re];if(!he.da&&he.listener==v&&he.capture==!!_&&he.ha==N)return re}return-1}var He="closure_lm_"+(Math.random()*1e6|0),Qe={};function Je(h,v,_,N,re){if(Array.isArray(v)){for(let he=0;he<v.length;he++)Je(h,v[he],_,N,re);return null}return _=ut(_),h&&h[st]?h.J(v,_,g(N)?!!N.capture:!1,re):$t(h,v,_,!1,N,re)}function $t(h,v,_,N,re,he){if(!v)throw Error("Invalid event type");const Ue=g(re)?!!re.capture:!!re;let Ot=pn(h);if(Ot||(h[He]=Ot=new Se(h)),_=Ot.add(v,_,N,Ue,he),_.proxy)return _;if(N=Rt(),_.proxy=N,N.src=h,N.listener=_,h.addEventListener)D||(re=Ue),re===void 0&&(re=!1),h.addEventListener(v.toString(),N,re);else if(h.attachEvent)h.attachEvent(qt(v.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Rt(){function h(_){return v.call(h.src,h.listener,_)}const v=Et;return h}function Sn(h,v,_,N,re){if(Array.isArray(v))for(var he=0;he<v.length;he++)Sn(h,v[he],_,N,re);else N=g(N)?!!N.capture:!!N,_=ut(_),h&&h[st]?(h=h.i,he=String(v).toString(),he in h.g&&(v=h.g[he],_=Ve(v,_,N,re),_>-1&&(qe(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[he],h.h--)))):h&&(h=pn(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ve(v,_,N,re)),(_=h>-1?v[h]:null)&&ln(_))}function ln(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[st])ke(v.i,h);else{var _=h.type,N=h.proxy;v.removeEventListener?v.removeEventListener(_,N,h.capture):v.detachEvent?v.detachEvent(qt(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=pn(v))?(ke(_,h),_.h==0&&(_.src=null,v[He]=null)):qe(h)}}}function qt(h){return h in Qe?Qe[h]:Qe[h]="on"+h}function Et(h,v){if(h.da)h=!0;else{v=new Pe(v,this);const _=h.listener,N=h.ha||h.src;h.fa&&ln(h),h=_.call(N,v)}return h}function pn(h){return h=h[He],h instanceof Se?h:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function ut(h){return typeof h=="function"?h:(h[Tt]||(h[Tt]=function(v){return h.handleEvent(v)}),h[Tt])}function le(){U.call(this),this.i=new Se(this),this.M=this,this.G=null}k(le,U),le.prototype[st]=!0,le.prototype.removeEventListener=function(h,v,_,N){Sn(this,h,v,_,N)};function pt(h,v){var _,N=h.G;if(N)for(_=[];N;N=N.G)_.push(N);if(h=h.M,N=v.type||v,typeof v=="string")v=new P(v,h);else if(v instanceof P)v.target=v.target||h;else{var re=v;v=new P(N,h),je(v,re)}re=!0;let he,Ue;if(_)for(Ue=_.length-1;Ue>=0;Ue--)he=v.g=_[Ue],re=Ht(he,N,!0,v)&&re;if(he=v.g=h,re=Ht(he,N,!0,v)&&re,re=Ht(he,N,!1,v)&&re,_)for(Ue=0;Ue<_.length;Ue++)he=v.g=_[Ue],re=Ht(he,N,!1,v)&&re}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let N=0;N<_.length;N++)qe(_[N]);delete h.g[v],h.h--}}this.G=null},le.prototype.J=function(h,v,_,N){return this.i.add(String(h),v,!1,_,N)},le.prototype.K=function(h,v,_,N){return this.i.add(String(h),v,!0,_,N)};function Ht(h,v,_,N){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let re=!0;for(let he=0;he<v.length;++he){const Ue=v[he];if(Ue&&!Ue.da&&Ue.capture==_){const Ot=Ue.listener,cs=Ue.ha||Ue.src;Ue.fa&&ke(h.i,Ue),re=Ot.call(cs,N)!==!1&&re}}return re&&!N.defaultPrevented}function it(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function yt(h){h.g=it(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class gt extends U{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wt(h){U.call(this),this.h=h,this.g={}}k(wt,U);var Bt=[];function fs(h){Ne(h.g,function(v,_){this.g.hasOwnProperty(_)&&ln(v)},h),h.g={}}wt.prototype.N=function(){wt.Z.N.call(this),fs(this)},wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sn=d.JSON.stringify,Zn=d.JSON.parse,Fn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ln(){}function Pn(){}var un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wt(){P.call(this,"d")}k(Wt,P);function Ct(){P.call(this,"c")}k(Ct,P);var It={},ee=null;function C(){return ee=ee||new le}It.Ia="serverreachability";function ne(h){P.call(this,It.Ia,h)}k(ne,P);function Re(h){const v=C();pt(v,new ne(v))}It.STAT_EVENT="statevent";function Ie(h,v){P.call(this,It.STAT_EVENT,h),this.stat=v}k(Ie,P);function De(h){const v=C();pt(v,new Ie(v,h))}It.Ja="timingevent";function Be(h,v){P.call(this,It.Ja,h),this.size=v}k(Be,P);function Le(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Dt(){this.g=!0}Dt.prototype.ua=function(){this.g=!1};function xt(h,v,_,N,re,he){h.info(function(){if(h.g)if(he){var Ue="",Ot=he.split("&");for(let xn=0;xn<Ot.length;xn++){var cs=Ot[xn].split("=");if(cs.length>1){const qn=cs[0];cs=cs[1];const Br=qn.split("_");Ue=Br.length>=2&&Br[1]=="type"?Ue+(qn+"="+cs+"&"):Ue+(qn+"=redacted&")}}}else Ue=null;else Ue=he;return"XMLHTTP REQ ("+N+") [attempt "+re+"]: "+v+`
`+_+`
`+Ue})}function lt(h,v,_,N,re,he,Ue){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+re+"]: "+v+`
`+_+`
`+he+" "+Ue})}function dn(h,v,_,N){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+On(h,_)+(N?" "+N:"")})}function hn(h,v){h.info(function(){return"TIMEOUT: "+v})}Dt.prototype.info=function(){};function On(h,v){if(!h.g)return v;if(!v)return null;try{const he=JSON.parse(v);if(he){for(h=0;h<he.length;h++)if(Array.isArray(he[h])){var _=he[h];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var re=N[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Ue=1;Ue<N.length;Ue++)N[Ue]=""}}}}return sn(he)}catch{return v}}var ms={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Me;function Ke(){}k(Ke,Ln),Ke.prototype.g=function(){return new XMLHttpRequest},Me=new Ke;function ct(h){return encodeURIComponent(String(h))}function rt(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function Gt(h,v,_,N){this.j=h,this.i=v,this.l=_,this.S=N||1,this.V=new wt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fn}function fn(){this.i=null,this.g="",this.h=!1}var Nt={},St={};function bn(h,v,_){h.M=1,h.A=At(se(v)),h.u=_,h.R=!0,Ss(h,null)}function Ss(h,v){h.F=Date.now(),js(h),h.B=se(h.A);var _=h.B,N=h.S;Array.isArray(N)||(N=[String(N)]),_i(_.i,"t",N),h.C=0,_=h.j.L,h.h=new fn,h.g=Ju(h.j,_?v:null,!h.u),h.P>0&&(h.O=new gt(p(h.Y,h,h.g),h.P)),v=h.V,_=h.g,N=h.ba;var re="readystatechange";Array.isArray(re)||(re&&(Bt[0]=re.toString()),re=Bt);for(let he=0;he<re.length;he++){const Ue=Je(_,re[he],N||v.handleEvent,!1,v.h||v);if(!Ue)break;v.g[Ue.key]=Ue}v=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Re(),xt(h.i,h.v,h.B,h.l,h.S,h.u)}Gt.prototype.ba=function(h){h=h.target;const v=this.O;v&&Hn(h)==3?v.j():this.Y(h)},Gt.prototype.Y=function(h){try{if(h==this.g)e:{const Ot=Hn(this.g),cs=this.g.ya(),xn=this.g.ca();if(!(Ot<3)&&(Ot!=3||this.g&&(this.h.h||this.g.la()||et(this.g)))){this.K||Ot!=4||cs==7||(cs==8||xn<=0?Re(3):Re(2)),Gn(this);var v=this.g.ca();this.X=v;var _=si(this);if(this.o=v==200,lt(this.i,this.v,this.B,this.l,this.S,Ot,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,re=this.g;if((N=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var he=N;break t}}he=null}if(h=he)dn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vn(this,h);else{this.o=!1,this.m=3,De(12),ls(this),os(this);break e}}if(this.R){h=!0;let qn;for(;!this.K&&this.C<_.length;)if(qn=Or(this,_),qn==St){Ot==4&&(this.m=4,De(14),h=!1),dn(this.i,this.l,null,"[Incomplete Response]");break}else if(qn==Nt){this.m=4,De(15),dn(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else dn(this.i,this.l,qn,null),Vn(this,qn);if(wi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ot!=4||_.length!=0||this.h.h||(this.m=1,De(16),h=!1),this.o=this.o&&h,!h)dn(this.i,this.l,_,"[Invalid Chunked Response]"),ls(this),os(this);else if(_.length>0&&!this.W){this.W=!0;var Ue=this.j;Ue.g==this&&Ue.aa&&!Ue.P&&(Ue.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),dc(Ue),Ue.P=!0,De(11))}}else dn(this.i,this.l,_,null),Vn(this,_);Ot==4&&ls(this),this.o&&!this.K&&(Ot==4?Ku(this.j,this):(this.o=!1,js(this)))}else mn(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,De(12)):(this.m=0,De(13)),ls(this),os(this)}}}catch{}};function si(h){if(!wi(h))return h.g.la();const v=et(h.g);if(v==="")return"";let _="";const N=v.length,re=Hn(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ls(h),os(h),"";h.h.i=new d.TextDecoder}for(let he=0;he<N;he++)h.h.h=!0,_+=h.h.i.decode(v[he],{stream:!(re&&he==N-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function wi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Or(h,v){var _=h.C,N=v.indexOf(`
`,_);return N==-1?St:(_=Number(v.substring(_,N)),isNaN(_)?Nt:(N+=1,N+_>v.length?St:(v=v.slice(N,N+_),h.C=N+_,v)))}Gt.prototype.cancel=function(){this.K=!0,ls(this)};function js(h){h.T=Date.now()+h.H,hr(h,h.H)}function hr(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Le(p(h.aa,h),v)}function Gn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Gt.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(hn(this.i,this.B),this.M!=2&&(Re(),De(17)),ls(this),this.m=2,os(this)):hr(this,this.T-h)};function os(h){h.j.I==0||h.K||Ku(h.j,h)}function ls(h){Gn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,fs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Vn(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||Kn(_.h,h))){if(!h.L&&Kn(_.h,h)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var re=N;if(re[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)rl(_),Qn(_);else break e;ai(_),De(18)}}else _.xa=re[1],0<_.xa-_.K&&re[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Le(p(_.Va,_),6e3));Hs(_.h)<=1&&_.ta&&(_.ta=void 0)}else ki(_,11)}else if((h.L||_.g==h)&&rl(_),!A(v))for(re=_.Ba.g.parse(v),v=0;v<re.length;v++){let xn=re[v];const qn=xn[0];if(!(qn<=_.K))if(_.K=qn,xn=xn[1],_.I==2)if(xn[0]=="c"){_.M=xn[1],_.ba=xn[2];const Br=xn[3];Br!=null&&(_.ka=Br,_.j.info("VER="+_.ka));const ji=xn[4];ji!=null&&(_.za=ji,_.j.info("SVER="+_.za));const oi=xn[5];oi!=null&&typeof oi=="number"&&oi>0&&(N=1.5*oi,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const li=h.g;if(li){const yo=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yo){var he=N.h;he.g||yo.indexOf("spdy")==-1&&yo.indexOf("quic")==-1&&yo.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(kr(he,he.h),he.h=null))}if(N.G){const il=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;il&&(N.wa=il,ot(N.J,N.G,il))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Ue=h;if(N.na=Xu(N,N.L?N.ba:null,N.W),Ue.L){ts(N.h,Ue);var Ot=Ue,cs=N.O;cs&&(Ot.H=cs),Ot.D&&(Gn(Ot),js(Ot)),N.g=Ue}else sl(N);_.i.length>0&&Ws(_)}else xn[0]!="stop"&&xn[0]!="close"||ki(_,7);else _.I==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?ki(_,7):gn(_):xn[0]!="noop"&&_.l&&_.l.qa(xn),_.A=0)}}Re(4)}catch{}}var wn=class{constructor(h,v){this.g=h,this.map=v}};function es(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function _r(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Hs(h){return h.h?1:h.g?h.g.size:0}function Kn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function kr(h,v){h.g?h.g.add(v):h.h=v}function ts(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}es.prototype.cancel=function(){if(this.i=Vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Vr(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return I(h.i)}var O=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function q(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const N=h[_].indexOf("=");let re,he=null;N>=0?(re=h[_].substring(0,N),he=h[_].substring(N+1)):re=h[_],v(re,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function oe(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof oe?(this.l=h.l,Ye(this,h.j),this.o=h.o,this.g=h.g,Ge(this,h.u),this.h=h.h,Fe(this,zi(h.i)),this.m=h.m):h&&(v=String(h).match(O))?(this.l=!1,Ye(this,v[1]||"",!0),this.o=Cn(v[2]||""),this.g=Cn(v[3]||"",!0),Ge(this,v[4]),this.h=Cn(v[5]||"",!0),Fe(this,v[6]||"",!0),this.m=Cn(v[7]||"")):(this.l=!1,this.i=new jr(null,this.l))}oe.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Cs(v,Ds,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Cs(v,Ds,!0),"@"),h.push(ct(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(Cs(_,_.charAt(0)=="/"?Ms:ri,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",Cs(_,xi)),h.join("")},oe.prototype.resolve=function(h){const v=se(this);let _=!!h.j;_?Ye(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var N=h.h;if(_)Ge(v,h.u);else if(_=!!h.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var re=v.h.lastIndexOf("/");re!=-1&&(N=v.h.slice(0,re+1)+N)}if(re=N,re==".."||re==".")N="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){N=re.lastIndexOf("/",0)==0,re=re.split("/");const he=[];for(let Ue=0;Ue<re.length;){const Ot=re[Ue++];Ot=="."?N&&Ue==re.length&&he.push(""):Ot==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),N&&Ue==re.length&&he.push("")):(he.push(Ot),N=!0)}N=he.join("/")}else N=re}return _?v.h=N:_=h.i.toString()!=="",_?Fe(v,zi(h.i)):_=!!h.m,_&&(v.m=h.m),v};function se(h){return new oe(h)}function Ye(h,v,_){h.j=_?Cn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Ge(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Fe(h,v,_){v instanceof jr?(h.i=v,Er(h.i,h.l)):(_||(v=Cs(v,er)),h.i=new jr(v,h.l))}function ot(h,v,_){h.i.set(v,_)}function At(h){return ot(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Cn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Cs(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,Yn),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Yn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ds=/[#\/\?@]/g,ri=/[#\?:]/g,Ms=/[#\?]/g,er=/[#\?@]/g,xi=/#/g;function jr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Ns(h){h.g||(h.g=new Map,h.h=0,h.i&&q(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=jr.prototype,s.add=function(h,v){Ns(this),this.i=null,h=Ur(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function ja(h,v){Ns(h),v=Ur(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Bi(h,v){return Ns(h),v=Ur(h,v),h.g.has(v)}s.forEach=function(h,v){Ns(this),this.g.forEach(function(_,N){_.forEach(function(re){h.call(v,re,N,this)},this)},this)};function ii(h,v){Ns(h);let _=[];if(typeof v=="string")Bi(h,v)&&(_=_.concat(h.g.get(Ur(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Ns(this),this.i=null,h=Ur(this,h),Bi(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=ii(this,h),h.length>0?String(h[0]):v):v};function _i(h,v,_){ja(h,v),_.length>0&&(h.i=null,h.g.set(Ur(h,v),I(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const re=ct(_);_=ii(this,_);for(let he=0;he<_.length;he++){let Ue=re;_[he]!==""&&(Ue+="="+ct(_[he])),h.push(Ue)}}return this.i=h.join("&")};function zi(h){const v=new jr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Ur(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Er(h,v){v&&!h.j&&(Ns(h),h.i=null,h.g.forEach(function(_,N){const re=N.toLowerCase();N!=re&&(ja(this,N),_i(this,re,_))},h)),h.j=v}function qs(h,v){const _=new Dt;if(d.Image){const N=new Image;N.onload=b(Ls,_,"TestLoadImage: loaded",!0,v,N),N.onerror=b(Ls,_,"TestLoadImage: error",!1,v,N),N.onabort=b(Ls,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(Ls,_,"TestLoadImage: timeout",!1,v,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else v(!1)}function $s(h,v){const _=new Dt,N=new AbortController,re=setTimeout(()=>{N.abort(),Ls(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:N.signal}).then(he=>{clearTimeout(re),he.ok?Ls(_,"TestPingServer: ok",!0,v):Ls(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(re),Ls(_,"TestPingServer: error",!1,v)})}function Ls(h,v,_,N,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),N(_)}catch{}}function S(){this.g=new Fn}function X(h){this.i=h.Sb||null,this.h=h.ab||!1}k(X,Ln),X.prototype.g=function(){return new Ae(this.i,this.h)};function Ae(h,v){le.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Ae,le),s=Ae.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,$(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,F(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,$(this)),this.g&&(this.readyState=3,$(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;R(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function R(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?F(this):$(this),this.readyState==3&&R(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,F(this))},s.Na=function(h){this.g&&(this.response=h,F(this))},s.ga=function(){this.g&&F(this)};function F(h){h.readyState=4,h.l=null,h.j=null,h.B=null,$(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function $(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ae.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function G(h){let v="";return Ne(h,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function fe(h,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=G(_),typeof h=="string"?_!=null&&ct(_):ot(h,v,_))}function ve(h){le.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(ve,le);var Oe=/^https?$/i,tt=["POST","PUT"];s=ve.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Me.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(he){nt(this,he);return}if(h=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var re in N)_.set(re,N[re]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const he of N.keys())_.set(he,N.get(he));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(he=>he.toLowerCase()=="content-type"),re=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(tt,v,void 0)>=0)||N||re||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ue]of _)this.g.setRequestHeader(he,Ue);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(he){nt(this,he)}};function nt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,vt(h),Xt(h)}function vt(h){h.A||(h.A=!0,pt(h,"complete"),pt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,pt(this,"complete"),pt(this,"abort"),Xt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),ve.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?_t(this):this.Xa())},s.Xa=function(){_t(this)};function _t(h){if(h.h&&typeof u<"u"){if(h.v&&Hn(h)==4)setTimeout(h.Ca.bind(h),0);else if(pt(h,"readystatechange"),Hn(h)==4){h.h=!1;try{const he=h.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=he===0){let Ue=String(h.D).match(O)[1]||null;!Ue&&d.self&&d.self.location&&(Ue=d.self.location.protocol.slice(0,-1)),N=!Oe.test(Ue?Ue.toLowerCase():"")}_=N}if(_)pt(h,"complete"),pt(h,"success");else{h.o=6;try{var re=Hn(h)>2?h.g.statusText:""}catch{re=""}h.l=re+" ["+h.ca()+"]",vt(h)}}finally{Xt(h)}}}}function Xt(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||pt(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hn(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Hn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Zn(v)}};function et(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function mn(h){const v={};h=(h.g&&Hn(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(A(h[N]))continue;var _=rt(h[N]);const re=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const he=v[re]||[];v[re]=he,he.push(_)}We(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function rn(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function mt(h){this.za=0,this.i=[],this.j=new Dt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=rn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=rn("baseRetryDelayMs",5e3,h),this.Za=rn("retryDelaySeedMs",1e4,h),this.Ta=rn("forwardChannelMaxRetries",2,h),this.va=rn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new es(h&&h.concurrentRequestLimit),this.Ba=new S,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=mt.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,N){De(0),this.W=h,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Xu(this,null,this.W),Ws(this)};function gn(h){if(tr(h),h.I==3){var v=h.V++,_=se(h.J);if(ot(_,"SID",h.M),ot(_,"RID",v),ot(_,"TYPE","terminate"),Tr(h,_),v=new Gt(h,h.j,v),v.M=2,v.A=At(se(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=Ju(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}Qu(h)}function Qn(h){h.g&&(dc(h),h.g.cancel(),h.g=null)}function tr(h){Qn(h),h.v&&(d.clearTimeout(h.v),h.v=null),rl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Ws(h){if(!_r(h.h)&&!h.m){h.m=!0;var v=h.Ea;we||E(),ye||(we(),ye=!0),M.add(v,h),h.D=0}}function As(h,v){return Hs(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Le(p(h.Ea,h,v),Yu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const re=new Gt(this,this.j,h);let he=this.o;if(this.U&&(he?(he=V(he),je(he,this.U)):he=this.U),this.u!==null||this.R||(re.J=he,he=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=po(this,re,v),_=se(this.J),ot(_,"RID",h),ot(_,"CVER",22),this.G&&ot(_,"X-HTTP-Session-Id",this.G),Tr(this,_),he&&(this.R?v="headers="+ct(G(he))+"&"+v:this.u&&fe(_,this.u,he)),kr(this.h,re),this.Ra&&ot(_,"TYPE","init"),this.S?(ot(_,"$req",v),ot(_,"SID","null"),re.U=!0,bn(re,_,null)):bn(re,_,v),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||_r(this.h)||nr(this))};function nr(h,v){var _;v?_=v.l:_=h.V++;const N=se(h.J);ot(N,"SID",h.M),ot(N,"RID",_),ot(N,"AID",h.K),Tr(h,N),h.u&&h.o&&fe(N,h.u,h.o),_=new Gt(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=po(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),kr(h.h,_),bn(_,N,v)}function Tr(h,v){h.H&&Ne(h.H,function(_,N){ot(v,N,_)}),h.l&&Ne({},function(_,N){ot(v,N,_)})}function po(h,v,_){_=Math.min(h.i.length,_);const N=h.l?p(h.l.Ka,h.l,h):null;e:{var re=h.i;let Ot=-1;for(;;){const cs=["count="+_];Ot==-1?_>0?(Ot=re[0].g,cs.push("ofs="+Ot)):Ot=0:cs.push("ofs="+Ot);let xn=!0;for(let qn=0;qn<_;qn++){var he=re[qn].g;const Br=re[qn].map;if(he-=Ot,he<0)Ot=Math.max(0,re[qn].g-100),xn=!1;else try{he="req"+he+"_"||"";try{var Ue=Br instanceof Map?Br:Object.entries(Br);for(const[ji,oi]of Ue){let li=oi;g(oi)&&(li=sn(oi)),cs.push(he+ji+"="+encodeURIComponent(li))}}catch(ji){throw cs.push(he+"type="+encodeURIComponent("_badmap")),ji}}catch{N&&N(Br)}}if(xn){Ue=cs.join("&");break e}}Ue=void 0}return h=h.i.splice(0,_),v.G=h,Ue}function sl(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;we||E(),ye||(we(),ye=!0),M.add(v,h),h.A=0}}function ai(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Le(p(h.Da,h),Yu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Gu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Le(p(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,De(10),Qn(this),Gu(this))};function dc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Gu(h){h.g=new Gt(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=se(h.na);ot(v,"RID","rpc"),ot(v,"SID",h.M),ot(v,"AID",h.K),ot(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ot(v,"TO",h.ia),ot(v,"TYPE","xmlhttp"),Tr(h,v),h.u&&h.o&&fe(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=At(se(v)),_.u=null,_.R=!0,Ss(_,h)}s.Va=function(){this.C!=null&&(this.C=null,Qn(this),ai(this),De(19))};function rl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Ku(h,v){var _=null;if(h.g==v){rl(h),dc(h),h.g=null;var N=2}else if(Kn(h.h,v))_=v.G,ts(h.h,v),N=1;else return;if(h.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var re=h.D;N=C(),pt(N,new Be(N,_)),Ws(h)}else sl(h);else if(re=v.m,re==3||re==0&&v.X>0||!(N==1&&As(h,v)||N==2&&ai(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),re){case 1:ki(h,5);break;case 4:ki(h,10);break;case 3:ki(h,6);break;default:ki(h,2)}}}function Yu(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function ki(h,v){if(h.j.info("Error code "+v),v==2){var _=p(h.bb,h),N=h.Ua;const re=!N;N=new oe(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ye(N,"https"),At(N),re?qs(N.toString(),_):$s(N.toString(),_)}else De(2);h.I=0,h.l&&h.l.pa(v),Qu(h),tr(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function Qu(h){if(h.I=0,h.ja=[],h.l){const v=Vr(h.h);(v.length!=0||h.i.length!=0)&&(H(h.ja,v),H(h.ja,h.i),h.h.i.length=0,I(h.i),h.i.length=0),h.l.oa()}}function Xu(h,v,_){var N=_ instanceof oe?se(_):new oe(_);if(N.g!="")v&&(N.g=v+"."+N.g),Ge(N,N.u);else{var re=d.location;N=re.protocol,v=v?v+"."+re.hostname:re.hostname,re=+re.port;const he=new oe(null);N&&Ye(he,N),v&&(he.g=v),re&&Ge(he,re),_&&(he.h=_),N=he}return _=h.G,v=h.wa,_&&v&&ot(N,_,v),ot(N,"VER",h.ka),Tr(h,N),N}function Ju(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new ve(new X({ab:_})):new ve(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}s=Zu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ea(){}Ea.prototype.g=function(h,v){return new sr(h,v)};function sr(h,v){le.call(this),this.g=new mt(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Fi(this)}k(sr,le),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){gn(this.g)},sr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=sn(h),h=_);v.i.push(new wn(v.Ya++,h)),v.I==3&&Ws(v)},sr.prototype.N=function(){this.g.l=null,delete this.j,gn(this.g),delete this.g,sr.Z.N.call(this)};function ed(h){Wt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}k(ed,Wt);function td(){Ct.call(this),this.status=1}k(td,Ct);function Fi(h){this.g=h}k(Fi,Zu),Fi.prototype.ra=function(){pt(this.g,"a")},Fi.prototype.qa=function(h){pt(this.g,new ed(h))},Fi.prototype.pa=function(h){pt(this.g,new td)},Fi.prototype.oa=function(){pt(this.g,"b")},Ea.prototype.createWebChannel=Ea.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,I_=function(){return new Ea},R_=function(){return C()},A_=It,Tp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Th=ms,ue.COMPLETE="complete",N_=ue,Pn.EventType=un,un.OPEN="a",un.CLOSE="b",un.ERROR="c",un.MESSAGE="d",le.prototype.listen=le.prototype.J,iu=Pn,ve.prototype.listenOnce=ve.prototype.K,ve.prototype.getLastError=ve.prototype.Ha,ve.prototype.getLastErrorCode=ve.prototype.ya,ve.prototype.getStatus=ve.prototype.ca,ve.prototype.getResponseJson=ve.prototype.La,ve.prototype.getResponseText=ve.prototype.la,ve.prototype.send=ve.prototype.ea,ve.prototype.setWithCredentials=ve.prototype.Fa,C_=ve}).apply(typeof oh<"u"?oh:typeof self<"u"?self:typeof window<"u"?window:{});class Ys{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ys.UNAUTHENTICATED=new Ys(null),Ys.GOOGLE_CREDENTIALS=new Ys("google-credentials-uid"),Ys.FIRST_PARTY=new Ys("first-party-uid"),Ys.MOCK_USER=new Ys("mock-user");let ic="12.8.0";function hR(s){ic=s}const Ho=new ay("@firebase/firestore");function Ol(){return Ho.logLevel}function Xe(s,...e){if(Ho.logLevel<=en.DEBUG){const t=e.map(wy);Ho.debug(`Firestore (${ic}): ${s}`,...t)}}function ba(s,...e){if(Ho.logLevel<=en.ERROR){const t=e.map(wy);Ho.error(`Firestore (${ic}): ${s}`,...t)}}function Gl(s,...e){if(Ho.logLevel<=en.WARN){const t=e.map(wy);Ho.warn(`Firestore (${ic}): ${s}`,...t)}}function wy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function jt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,D_(s,i,t)}function D_(s,e,t){let i=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ba(i),new Error(i)}function kn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||D_(e,l,i)}function Pt(s,e){return s}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends bi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ma{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class M_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ys.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class gR{constructor(e){this.t=e,this.currentUser=Ys.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let u=new ma;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ma,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=u;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},g=y=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>g(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?g(y):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ma)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(kn(typeof i.accessToken=="string",31837,{l:i}),new M_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kn(e===null||typeof e=="string",2055,{h:e}),new Ys(e)}}class pR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ys.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new pR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ys.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class P2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,br(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){kn(this.o===void 0,3512);const i=u=>{u.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Xe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new P2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(kn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new P2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class xy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function tn(s,e){return s<e?-1:s>e?1:0}function Sp(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Fg(l)===Fg(u)?tn(l,u):Fg(l)?1:-1}return tn(s.length,e.length)}const wR=55296,xR=57343;function Fg(s){const e=s.charCodeAt(0);return e>=wR&&e<=xR}function Kl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const O2="__name__";class Ai{constructor(e,t,i){t===void 0?t=0:t>e.length&&jt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&jt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ai.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ai?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ai.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return tn(e.length,t.length)}static compareSegments(e,t){const i=Ai.isNumericId(e),l=Ai.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ai.extractNumericId(e).compare(Ai.extractNumericId(t)):Sp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return no.fromString(e.substring(4,e.length-2))}}class Mn extends Ai{construct(e,t,i){return new Mn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new $e(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Mn(t)}static emptyPath(){return new Mn([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Ai{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===O2}static keyField(){return new zs([O2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new $e(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const g=e[l];if(g==="\\"){if(l+1===e.length)throw new $e(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new $e(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else g==="`"?(d=!d,l++):g!=="."||d?(i+=g,l++):(u(),l++)}if(u(),d)throw new $e(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Mn.fromString(e))}static fromName(e){return new ft(Mn.fromString(e).popFirst(5))}static empty(){return new ft(Mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Mn(e.slice()))}}function L_(s,e,t){if(!t)throw new $e(_e.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function kR(s,e,t,i){if(e===!0&&i===!0)throw new $e(_e.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function V2(s){if(!ft.isDocumentKey(s))throw new $e(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function U2(s){if(ft.isDocumentKey(s))throw new $e(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function P_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function lf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":jt(12329,{type:typeof s})}function cr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new $e(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lf(s);throw new $e(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function Vu(s,e){if(!P_(s))throw new $e(_e.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new $e(_e.INVALID_ARGUMENT,t);return!0}const B2=-62135596800,z2=1e6;class Ft{static now(){return Ft.fromMillis(Date.now())}static fromDate(e){return Ft.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*z2);return new Ft(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $e(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $e(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<B2)throw new $e(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/z2}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ft._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vu(e,Ft._jsonSchema))return new Ft(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-B2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ft._jsonSchemaVersion="firestore/timestamp/1.0",Ft._jsonSchema={type:ks("string",Ft._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};class Mt{static fromTimestamp(e){return new Mt(e)}static min(){return new Mt(new Ft(0,0))}static max(){return new Mt(new Ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xu=-1;function jR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Mt.fromTimestamp(i===1e9?new Ft(t+1,0):new Ft(t,i));return new io(l,ft.empty(),e)}function ER(s){return new io(s.readTime,s.key,xu)}class io{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new io(Mt.min(),ft.empty(),xu)}static max(){return new io(Mt.max(),ft.empty(),xu)}}function TR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(s.documentKey,e.documentKey),t!==0?t:tn(s.largestBatchId,e.largestBatchId))}const SR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ac(s){if(s.code!==_e.FAILED_PRECONDITION||s.message!==SR)throw s;Xe("LocalStore","Unexpectedly lost primary lease")}class Ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&jt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ce(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ce?t:Ce.resolve(t)}catch(t){return Ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ce.reject(t)}static resolve(e){return new Ce(((t,i)=>{t(e)}))}static reject(e){return new Ce(((t,i)=>{i(e)}))}static waitFor(e){return new Ce(((t,i)=>{let l=0,u=0,d=!1;e.forEach((g=>{++l,g.next((()=>{++u,d&&u===l&&t()}),(y=>i(y)))})),d=!0,u===l&&t()}))}static or(e){let t=Ce.resolve(!1);for(const i of e)t=t.next((l=>l?Ce.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ce(((i,l)=>{const u=e.length,d=new Array(u);let g=0;for(let y=0;y<u;y++){const p=y;t(e[p]).next((b=>{d[p]=b,++g,g===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Ce(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function NR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oc(s){return s.name==="IndexedDbTransactionError"}class cf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cf.ce=-1;const _y=-1;function uf(s){return s==null}function Fh(s){return s===0&&1/s==-1/0}function AR(s){return typeof s=="number"&&Number.isInteger(s)&&!Fh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const O_="";function RR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=F2(e)),e=IR(s.get(t),e);return F2(e)}function IR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case O_:t+="";break;default:t+=u}}return t}function F2(s){return s+O_+""}function H2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function fo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function V_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Jn{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new Jn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new Jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lh(this.root,e,this.comparator,!1)}getReverseIterator(){return new lh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lh(this.root,e,this.comparator,!0)}}class lh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=l??Bs.EMPTY,this.right=u??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Bs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Bs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw jt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw jt(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw jt(57766)}get value(){throw jt(16141)}get color(){throw jt(16727)}get left(){throw jt(29726)}get right(){throw jt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Jn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new q2(this.data.getIterator())}getIteratorFrom(e){return new q2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class q2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Mr{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Mr([])}unionWith(e){let t=new Ts(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Mr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class U_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new U_("Invalid base64 string: "+u):u}})(e);return new Fs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ao(s){if(kn(!!s,39018),typeof s=="string"){let e=0;const t=DR.exec(s);if(kn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function oo(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}const B_="server_timestamp",z_="__type__",F_="__previous_value__",H_="__local_write_time__";function ky(s){return(s?.mapValue?.fields||{})[z_]?.stringValue===B_}function df(s){const e=s.mapValue.fields[F_];return ky(e)?df(e):e}function _u(s){const e=ao(s.mapValue.fields[H_].timestampValue);return new Ft(e.seconds,e.nanos)}class MR{constructor(e,t,i,l,u,d,g,y,p,b,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=y,this.useFetchStreams=p,this.isUsingEmulator=b,this.apiKey=k}}const Hh="(default)";class ku{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new ku("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof ku&&e.projectId===this.projectId&&e.database===this.database}}function LR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new $e(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ku(s.options.projectId,e)}const q_="__type__",PR="__max__",ch={mapValue:{}},$_="__vector__",qh="value";function lo(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?ky(s)?4:VR(s)?9007199254740991:OR(s)?10:11:jt(28295,{value:s})}function Pi(s,e){if(s===e)return!0;const t=lo(s);if(t!==lo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return _u(s).isEqual(_u(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=ao(l.timestampValue),g=ao(u.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return oo(l.bytesValue).isEqual(oo(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=hs(l.doubleValue),g=hs(u.doubleValue);return d===g?Fh(d)===Fh(g):isNaN(d)&&isNaN(g)}return!1})(s,e);case 9:return Kl(s.arrayValue.values||[],e.arrayValue.values||[],Pi);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},g=u.mapValue.fields||{};if(H2(d)!==H2(g))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(g[y]===void 0||!Pi(d[y],g[y])))return!1;return!0})(s,e);default:return jt(52216,{left:s})}}function ju(s,e){return(s.values||[]).find((t=>Pi(t,e)))!==void 0}function Yl(s,e){if(s===e)return 0;const t=lo(s),i=lo(e);if(t!==i)return tn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return tn(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const g=hs(u.integerValue||u.doubleValue),y=hs(d.integerValue||d.doubleValue);return g<y?-1:g>y?1:g===y?0:isNaN(g)?isNaN(y)?0:-1:1})(s,e);case 3:return $2(s.timestampValue,e.timestampValue);case 4:return $2(_u(s),_u(e));case 5:return Sp(s.stringValue,e.stringValue);case 6:return(function(u,d){const g=oo(u),y=oo(d);return g.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const g=u.split("/"),y=d.split("/");for(let p=0;p<g.length&&p<y.length;p++){const b=tn(g[p],y[p]);if(b!==0)return b}return tn(g.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const g=tn(hs(u.latitude),hs(d.latitude));return g!==0?g:tn(hs(u.longitude),hs(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return W2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const g=u.fields||{},y=d.fields||{},p=g[qh]?.arrayValue,b=y[qh]?.arrayValue,k=tn(p?.values?.length||0,b?.values?.length||0);return k!==0?k:W2(p,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===ch.mapValue&&d===ch.mapValue)return 0;if(u===ch.mapValue)return 1;if(d===ch.mapValue)return-1;const g=u.fields||{},y=Object.keys(g),p=d.fields||{},b=Object.keys(p);y.sort(),b.sort();for(let k=0;k<y.length&&k<b.length;++k){const T=Sp(y[k],b[k]);if(T!==0)return T;const I=Yl(g[y[k]],p[b[k]]);if(I!==0)return I}return tn(y.length,b.length)})(s.mapValue,e.mapValue);default:throw jt(23264,{he:t})}}function $2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return tn(s,e);const t=ao(s),i=ao(e),l=tn(t.seconds,i.seconds);return l!==0?l:tn(t.nanos,i.nanos)}function W2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Yl(t[l],i[l]);if(u)return u}return tn(t.length,i.length)}function Ql(s){return Cp(s)}function Cp(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=ao(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return oo(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ft.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Cp(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Cp(t.fields[d])}`;return l+"}"})(s.mapValue):jt(61005,{value:s})}function Sh(s){switch(lo(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=df(s);return e?16+Sh(e):16;case 5:return 2*s.stringValue.length;case 6:return oo(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Sh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return fo(i.fields,((u,d)=>{l+=u.length+Sh(d)})),l})(s.mapValue);default:throw jt(13486,{value:s})}}function G2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Np(s){return!!s&&"integerValue"in s}function jy(s){return!!s&&"arrayValue"in s}function K2(s){return!!s&&"nullValue"in s}function Y2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ch(s){return!!s&&"mapValue"in s}function OR(s){return(s?.mapValue?.fields||{})[q_]?.stringValue===$_}function du(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return fo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=du(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(s.arrayValue.values[t]);return e}return{...s}}function VR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===PR}class wr{constructor(e){this.value=e}static empty(){return new wr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ch(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=zs.emptyPath(),i={},l=[];e.forEach(((d,g)=>{if(!t.isImmediateParentOf(g)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=g.popLast()}d?i[g.lastSegment()]=du(d):l.push(g.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Ch(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Ch(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){fo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new wr(du(this.value))}}function W_(s){const e=[];return fo(s.fields,((t,i)=>{const l=new zs([t]);if(Ch(i)){const u=W_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Mr(e)}class Qs{constructor(e,t,i,l,u,d,g){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=g}static newInvalidDocument(e){return new Qs(e,0,Mt.min(),Mt.min(),Mt.min(),wr.empty(),0)}static newFoundDocument(e,t,i,l){return new Qs(e,1,t,Mt.min(),i,l,0)}static newNoDocument(e,t){return new Qs(e,2,t,Mt.min(),Mt.min(),wr.empty(),0)}static newUnknownDocument(e,t){return new Qs(e,3,t,Mt.min(),Mt.min(),wr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=wr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=wr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $h{constructor(e,t){this.position=e,this.inclusive=t}}function Q2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=ft.comparator(ft.fromName(d.referenceValue),t.key):i=Yl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function X2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Pi(s.position[t],e.position[t]))return!1;return!0}class Eu{constructor(e,t="asc"){this.field=e,this.dir=t}}function UR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class G_{}class ws extends G_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new zR(e,t,i):t==="array-contains"?new qR(e,i):t==="in"?new $R(e,i):t==="not-in"?new WR(e,i):t==="array-contains-any"?new GR(e,i):new ws(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new FR(e,i):new HR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yl(t,this.value)):t!==null&&lo(this.value)===lo(t)&&this.matchesComparison(Yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return jt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yi extends G_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new yi(e,t)}matches(e){return K_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function K_(s){return s.op==="and"}function Y_(s){return BR(s)&&K_(s)}function BR(s){for(const e of s.filters)if(e instanceof yi)return!1;return!0}function Ap(s){if(s instanceof ws)return s.field.canonicalString()+s.op.toString()+Ql(s.value);if(Y_(s))return s.filters.map((e=>Ap(e))).join(",");{const e=s.filters.map((t=>Ap(t))).join(",");return`${s.op}(${e})`}}function Q_(s,e){return s instanceof ws?(function(i,l){return l instanceof ws&&i.op===l.op&&i.field.isEqual(l.field)&&Pi(i.value,l.value)})(s,e):s instanceof yi?(function(i,l){return l instanceof yi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,g)=>u&&Q_(d,l.filters[g])),!0):!1})(s,e):void jt(19439)}function X_(s){return s instanceof ws?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ql(t.value)}`})(s):s instanceof yi?(function(t){return t.op.toString()+" {"+t.getFilters().map(X_).join(" ,")+"}"})(s):"Filter"}class zR extends ws{constructor(e,t,i){super(e,t,i),this.key=ft.fromName(i.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class FR extends ws{constructor(e,t){super(e,"in",t),this.keys=J_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class HR extends ws{constructor(e,t){super(e,"not-in",t),this.keys=J_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function J_(s,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class qR extends ws{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return jy(t)&&ju(t.arrayValue,this.value)}}class $R extends ws{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ju(this.value.arrayValue,t)}}class WR extends ws{constructor(e,t){super(e,"not-in",t)}matches(e){if(ju(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ju(this.value.arrayValue,t)}}class GR extends ws{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!jy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>ju(this.value.arrayValue,i)))}}class KR{constructor(e,t=null,i=[],l=[],u=null,d=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=g,this.Te=null}}function J2(s,e=null,t=[],i=[],l=null,u=null,d=null){return new KR(s,e,t,i,l,u,d)}function Ey(s){const e=Pt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ap(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),uf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ql(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ql(i))).join(",")),e.Te=t}return e.Te}function Ty(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!UR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Q_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!X2(s.startAt,e.startAt)&&X2(s.endAt,e.endAt)}function Rp(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class lc{constructor(e,t=null,i=[],l=[],u=null,d="F",g=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=g,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function YR(s,e,t,i,l,u,d,g){return new lc(s,e,t,i,l,u,d,g)}function hf(s){return new lc(s)}function Z2(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function QR(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Z_(s){return s.collectionGroup!==null}function hu(s){const e=Pt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Ts(zs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Eu(u,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Eu(zs.keyField(),i))}return e.Ie}function Di(s){const e=Pt(s);return e.Ee||(e.Ee=XR(e,hu(s))),e.Ee}function XR(s,e){if(s.limitType==="F")return J2(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Eu(l.field,u)}));const t=s.endAt?new $h(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new $h(s.startAt.position,s.startAt.inclusive):null;return J2(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Ip(s,e){const t=s.filters.concat([e]);return new lc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function JR(s,e){const t=s.explicitOrderBy.concat([e]);return new lc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Dp(s,e,t){return new lc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function ff(s,e){return Ty(Di(s),Di(e))&&s.limitType===e.limitType}function ek(s){return`${Ey(Di(s))}|lt:${s.limitType}`}function Vl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>X_(l))).join(", ")}]`),uf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ql(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ql(l))).join(",")),`Target(${i})`})(Di(s))}; limitType=${s.limitType})`}function mf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ft.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of hu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,g,y){const p=Q2(d,g,y);return d.inclusive?p<=0:p<0})(i.startAt,hu(i),l)||i.endAt&&!(function(d,g,y){const p=Q2(d,g,y);return d.inclusive?p>=0:p>0})(i.endAt,hu(i),l))})(s,e)}function ZR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function tk(s){return(e,t)=>{let i=!1;for(const l of hu(s)){const u=eI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function eI(s,e,t){const i=s.field.isKeyField()?ft.comparator(e.key,t.key):(function(u,d,g){const y=d.data.field(u),p=g.data.field(u);return y!==null&&p!==null?Yl(y,p):jt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return jt(19790,{direction:s.dir})}}class Jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){fo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return V_(this.inner)}size(){return this.innerSize}}const tI=new Jn(ft.comparator);function wa(){return tI}const nk=new Jn(ft.comparator);function au(...s){let e=nk;for(const t of s)e=e.insert(t.key,t);return e}function sk(s){let e=nk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Po(){return fu()}function rk(){return fu()}function fu(){return new Jo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const nI=new Jn(ft.comparator),sI=new Ts(ft.comparator);function nn(...s){let e=sI;for(const t of s)e=e.add(t);return e}const rI=new Ts(tn);function iI(){return rI}function Sy(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fh(e)?"-0":e}}function ik(s){return{integerValue:""+s}}function ak(s,e){return AR(e)?ik(e):Sy(s,e)}class gf{constructor(){this._=void 0}}function aI(s,e,t){return s instanceof Tu?(function(l,u){const d={fields:{[z_]:{stringValue:B_},[H_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ky(u)&&(u=df(u)),u&&(d.fields[F_]=u),{mapValue:d}})(t,e):s instanceof Xl?lk(s,e):s instanceof Jl?ck(s,e):(function(l,u){const d=ok(l,u),g=ew(d)+ew(l.Ae);return Np(d)&&Np(l.Ae)?ik(g):Sy(l.serializer,g)})(s,e)}function oI(s,e,t){return s instanceof Xl?lk(s,e):s instanceof Jl?ck(s,e):t}function ok(s,e){return s instanceof Su?(function(i){return Np(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Tu extends gf{}class Xl extends gf{constructor(e){super(),this.elements=e}}function lk(s,e){const t=uk(e);for(const i of s.elements)t.some((l=>Pi(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Jl extends gf{constructor(e){super(),this.elements=e}}function ck(s,e){let t=uk(e);for(const i of s.elements)t=t.filter((l=>!Pi(l,i)));return{arrayValue:{values:t}}}class Su extends gf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ew(s){return hs(s.integerValue||s.doubleValue)}function uk(s){return jy(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class pf{constructor(e,t){this.field=e,this.transform=t}}function lI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Xl&&l instanceof Xl||i instanceof Jl&&l instanceof Jl?Kl(i.elements,l.elements,Pi):i instanceof Su&&l instanceof Su?Pi(i.Ae,l.Ae):i instanceof Tu&&l instanceof Tu})(s.transform,e.transform)}class cI{constructor(e,t){this.version=e,this.transformResults=t}}class ur{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class yf{}function dk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new vf(s.key,ur.none()):new Uu(s.key,s.data,ur.none());{const t=s.data,i=wr.empty();let l=new Ts(zs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new mo(s.key,i,new Mr(l.toArray()),ur.none())}}function uI(s,e,t){s instanceof Uu?(function(l,u,d){const g=l.value.clone(),y=nw(l.fieldTransforms,u,d.transformResults);g.setAll(y),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):s instanceof mo?(function(l,u,d){if(!Nh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const g=nw(l.fieldTransforms,u,d.transformResults),y=u.data;y.setAll(hk(l)),y.setAll(g),u.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function mu(s,e,t,i){return s instanceof Uu?(function(u,d,g,y){if(!Nh(u.precondition,d))return g;const p=u.value.clone(),b=sw(u.fieldTransforms,y,d);return p.setAll(b),d.convertToFoundDocument(d.version,p).setHasLocalMutations(),null})(s,e,t,i):s instanceof mo?(function(u,d,g,y){if(!Nh(u.precondition,d))return g;const p=sw(u.fieldTransforms,y,d),b=d.data;return b.setAll(hk(u)),b.setAll(p),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,d,g){return Nh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(s,e,t)}function dI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=ok(i.transform,l||null);u!=null&&(t===null&&(t=wr.empty()),t.set(i.field,u))}return t||null}function tw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Kl(i,l,((u,d)=>lI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Uu extends yf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class mo extends yf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function hk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function nw(s,e,t){const i=new Map;kn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,g=e.data.field(u.field);i.set(u.field,oI(d,g,t[l]))}return i}function sw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,aI(u,d,e))}return i}class vf extends yf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hI extends yf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&uI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=rk();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let g=this.applyToLocalView(d,u.mutatedFields);g=t.has(l.key)?null:g;const y=dk(d,g);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(Mt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),nn())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,((t,i)=>tw(t,i)))&&Kl(this.baseMutations,e.baseMutations,((t,i)=>tw(t,i)))}}class Cy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){kn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return nI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Cy(e,t,i,l)}}class mI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gI{constructor(e,t){this.count=e,this.unchangedNames=t}}var bs,cn;function pI(s){switch(s){case _e.OK:return jt(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return jt(15467,{code:s})}}function fk(s){if(s===void 0)return ba("GRPC error has no .code"),_e.UNKNOWN;switch(s){case bs.OK:return _e.OK;case bs.CANCELLED:return _e.CANCELLED;case bs.UNKNOWN:return _e.UNKNOWN;case bs.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case bs.INTERNAL:return _e.INTERNAL;case bs.UNAVAILABLE:return _e.UNAVAILABLE;case bs.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case bs.NOT_FOUND:return _e.NOT_FOUND;case bs.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case bs.ABORTED:return _e.ABORTED;case bs.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case bs.DATA_LOSS:return _e.DATA_LOSS;default:return jt(39323,{code:s})}}(cn=bs||(bs={}))[cn.OK=0]="OK",cn[cn.CANCELLED=1]="CANCELLED",cn[cn.UNKNOWN=2]="UNKNOWN",cn[cn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cn[cn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cn[cn.NOT_FOUND=5]="NOT_FOUND",cn[cn.ALREADY_EXISTS=6]="ALREADY_EXISTS",cn[cn.PERMISSION_DENIED=7]="PERMISSION_DENIED",cn[cn.UNAUTHENTICATED=16]="UNAUTHENTICATED",cn[cn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cn[cn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cn[cn.ABORTED=10]="ABORTED",cn[cn.OUT_OF_RANGE=11]="OUT_OF_RANGE",cn[cn.UNIMPLEMENTED=12]="UNIMPLEMENTED",cn[cn.INTERNAL=13]="INTERNAL",cn[cn.UNAVAILABLE=14]="UNAVAILABLE",cn[cn.DATA_LOSS=15]="DATA_LOSS";function yI(){return new TextEncoder}const vI=new no([4294967295,4294967295],0);function rw(s){const e=yI().encode(s),t=new S_;return t.update(e),new Uint8Array(t.digest())}function iw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new no([t,i],0),new no([l,u],0)]}class Ny{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ou(`Invalid padding: ${t}`);if(i<0)throw new ou(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ou(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=no.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(no.fromNumber(i)));return l.compare(vI)===1&&(l=new no([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=rw(e),[i,l]=iw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Ny(u,l,t);return i.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const t=rw(e),[i,l]=iw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new bf(Mt.min(),l,new Jn(tn),wa(),nn())}}class Bu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Bu(i,t,nn(),nn(),nn())}}class Ah{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class mk{constructor(e,t){this.targetId=e,this.Ce=t}}class gk{constructor(e,t,i=Fs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class aw{constructor(){this.ve=0,this.Fe=ow(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nn(),t=nn(),i=nn();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:jt(38017,{changeType:u})}})),new Bu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=ow()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,kn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class bI{constructor(e){this.Ge=e,this.ze=new Map,this.je=wa(),this.He=uh(),this.Je=uh(),this.Ze=new Jn(tn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:jt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Rp(u))if(i===0){const d=new ft(u.path);this.et(t,d,Qs.newNoDocument(d,Mt.min()))}else kn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const g=this.ut(e),y=g?this.ct(g,e,d):1;if(y!==0){this.it(t);const p=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,g;try{d=oo(i).toUint8Array()}catch(y){if(y instanceof U_)return Gl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{g=new Ny(d,l,u)}catch(y){return Gl(y instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return g.ge===0?null:g}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(g)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const g=this.ot(d);if(g){if(u.current&&Rp(g.target)){const y=new ft(g.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Qs.newNoDocument(y,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=nn();this.Je.forEach(((u,d)=>{let g=!0;d.forEachWhile((y=>{const p=this.ot(y);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new bf(e,t,this.Ze,this.je,i);return this.je=wa(),this.He=uh(),this.Je=uh(),this.Ze=new Jn(tn),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new aw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(tn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(tn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Xe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new aw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function uh(){return new Jn(ft.comparator)}function ow(){return new Jn(ft.comparator)}const wI={asc:"ASCENDING",desc:"DESCENDING"},xI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_I={and:"AND",or:"OR"};class kI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mp(s,e){return s.useProto3Json||uf(e)?e:{value:e}}function Wh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function jI(s,e){return Wh(s,e.toTimestamp())}function Mi(s){return kn(!!s,49232),Mt.fromTimestamp((function(t){const i=ao(t);return new Ft(i.seconds,i.nanos)})(s))}function Ay(s,e){return Lp(s,e).canonicalString()}function Lp(s,e){const t=(function(l){return new Mn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function yk(s){const e=Mn.fromString(s);return kn(_k(e),10190,{key:e.toString()}),e}function Pp(s,e){return Ay(s.databaseId,e.path)}function Hg(s,e){const t=yk(e);if(t.get(1)!==s.databaseId.projectId)throw new $e(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new $e(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ft(bk(t))}function vk(s,e){return Ay(s.databaseId,e)}function EI(s){const e=yk(s);return e.length===4?Mn.emptyPath():bk(e)}function Op(s){return new Mn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function bk(s){return kn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function lw(s,e,t){return{name:Pp(s,e),fields:t.value.mapValue.fields}}function TI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:jt(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(p,b){return p.useProto3Json?(kn(b===void 0||typeof b=="string",58123),Fs.fromBase64String(b||"")):(kn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Fs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(p){const b=p.code===void 0?_e.UNKNOWN:fk(p.code);return new $e(b,p.message||"")})(d);t=new gk(i,l,u,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Hg(s,i.document.name),u=Mi(i.document.updateTime),d=i.document.createTime?Mi(i.document.createTime):Mt.min(),g=new wr({mapValue:{fields:i.document.fields}}),y=Qs.newFoundDocument(l,u,d,g),p=i.targetIds||[],b=i.removedTargetIds||[];t=new Ah(p,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Hg(s,i.document),u=i.readTime?Mi(i.readTime):Mt.min(),d=Qs.newNoDocument(l,u),g=i.removedTargetIds||[];t=new Ah([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Hg(s,i.document),u=i.removedTargetIds||[];t=new Ah([],u,l,null)}else{if(!("filter"in e))return jt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new gI(l,u),g=i.targetId;t=new mk(g,d)}}return t}function SI(s,e){let t;if(e instanceof Uu)t={update:lw(s,e.key,e.value)};else if(e instanceof vf)t={delete:Pp(s,e.key)};else if(e instanceof mo)t={update:lw(s,e.key,e.data),updateMask:PI(e.fieldMask)};else{if(!(e instanceof hI))return jt(16599,{dt:e.type});t={verify:Pp(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const g=d.transform;if(g instanceof Tu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Xl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Jl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof Su)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw jt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:jI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:jt(27497)})(s,e.precondition)),t}function CI(s,e){return s&&s.length>0?(kn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Mi(l.updateTime):Mi(u);return d.isEqual(Mt.min())&&(d=Mi(u)),new cI(d,l.transformResults||[])})(t,e)))):[]}function NI(s,e){return{documents:[vk(s,e.path)]}}function AI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=vk(s,l);const u=(function(p){if(p.length!==0)return xk(yi.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(p){if(p.length!==0)return p.map((b=>(function(T){return{field:Ul(T.field),direction:DI(T.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const g=Mp(s,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:l}}function RI(s){let e=EI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){kn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(k){const T=wk(k);return T instanceof yi&&Y_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((T=>(function(H){return new Eu(Bl(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(T)))})(t.orderBy));let g=null;t.limit&&(g=(function(k){let T;return T=typeof k=="object"?k.value:k,uf(T)?null:T})(t.limit));let y=null;t.startAt&&(y=(function(k){const T=!!k.before,I=k.values||[];return new $h(I,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(k){const T=!k.before,I=k.values||[];return new $h(I,T)})(t.endAt)),YR(e,l,d,u,g,"F",y,p)}function II(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wk(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Bl(t.unaryFilter.field);return ws.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Bl(t.unaryFilter.field);return ws.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Bl(t.unaryFilter.field);return ws.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Bl(t.unaryFilter.field);return ws.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return jt(61313);default:return jt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ws.create(Bl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return jt(58110);default:return jt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return yi.create(t.compositeFilter.filters.map((i=>wk(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return jt(1026)}})(t.compositeFilter.op))})(s):jt(30097,{filter:s})}function DI(s){return wI[s]}function MI(s){return xI[s]}function LI(s){return _I[s]}function Ul(s){return{fieldPath:s.canonicalString()}}function Bl(s){return zs.fromServerFormat(s.fieldPath)}function xk(s){return s instanceof ws?(function(t){if(t.op==="=="){if(Y2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NAN"}};if(K2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Y2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NAN"}};if(K2(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(t.field),op:MI(t.op),value:t.value}}})(s):s instanceof yi?(function(t){const i=t.getFilters().map((l=>xk(l)));return i.length===1?i[0]:{compositeFilter:{op:LI(t.op),filters:i}}})(s):jt(54877,{filter:s})}function PI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function _k(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function kk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class eo{constructor(e,t,i,l,u=Mt.min(),d=Mt.min(),g=Fs.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=y}withSequenceNumber(e){return new eo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class OI{constructor(e){this.yt=e}}function VI(s){const e=RI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Dp(e,e.limit,"L"):e}class UI{constructor(){this.Sn=new BI}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ce.resolve()}getCollectionParents(e,t){return Ce.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ce.resolve()}deleteFieldIndex(e,t){return Ce.resolve()}deleteAllFieldIndexes(e){return Ce.resolve()}createTargetIndexes(e,t){return Ce.resolve()}getDocumentsMatchingTarget(e,t){return Ce.resolve(null)}getIndexType(e,t){return Ce.resolve(0)}getFieldIndexes(e,t){return Ce.resolve([])}getNextCollectionGroupToUpdate(e){return Ce.resolve(null)}getMinOffset(e,t){return Ce.resolve(io.min())}getMinOffsetFromCollectionGroup(e,t){return Ce.resolve(io.min())}updateCollectionGroup(e,t,i){return Ce.resolve()}updateIndexEntries(e,t){return Ce.resolve()}}class BI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Mn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Mn.comparator)).toArray()}}const cw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jk=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(jk,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const uw="LruGarbageCollector",zI=1048576;function dw([s,e],[t,i]){const l=tn(s,t);return l===0?tn(e,i):l}class FI{constructor(e){this.Pr=e,this.buffer=new Ts(dw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();dw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Xe(uw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oc(t)?Xe(uw,"Ignoring IndexedDB error during garbage collection: ",t):await ac(t)}await this.Ar(3e5)}))}}class qI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ce.resolve(cf.ce);const i=new FI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),Ce.resolve(cw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,g,y,p;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,g=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(p=Date.now(),Ol()<=en.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(g-d)+`ms
	Removed ${u} targets in `+(y-g)+`ms
	Removed ${k} documents in `+(p-y)+`ms
Total Duration: ${p-b}ms`),Ce.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function $I(s,e){return new qI(s,e)}class WI{constructor(){this.changes=new Jo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ce.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class KI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&mu(i.mutation,l,Mr.empty(),Ft.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,nn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=nn()){const l=Po();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=au();return u.forEach(((g,y)=>{d=d.insert(g,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Po();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,nn())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,g)=>{t.set(d,g)}))}))}computeViews(e,t,i,l){let u=wa();const d=fu(),g=(function(){return fu()})();return t.forEach(((y,p)=>{const b=i.get(p.key);l.has(p.key)&&(b===void 0||b.mutation instanceof mo)?u=u.insert(p.key,p):b!==void 0?(d.set(p.key,b.mutation.getFieldMask()),mu(b.mutation,p,b.mutation.getFieldMask(),Ft.now())):d.set(p.key,Mr.empty())})),this.recalculateAndSaveOverlays(e,u).next((y=>(y.forEach(((p,b)=>d.set(p,b))),t.forEach(((p,b)=>g.set(p,new GI(b,d.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const i=fu();let l=new Jn(((d,g)=>d-g)),u=nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const g of d)g.keys().forEach((y=>{const p=t.get(y);if(p===null)return;let b=i.get(y)||Mr.empty();b=g.applyToLocalView(p,b),i.set(y,b);const k=(l.get(g.batchId)||nn()).add(y);l=l.insert(g.batchId,k)}))})).next((()=>{const d=[],g=l.getReverseIterator();for(;g.hasNext();){const y=g.getNext(),p=y.key,b=y.value,k=rk();b.forEach((T=>{if(!u.has(T)){const I=dk(t.get(T),i.get(T));I!==null&&k.set(T,I),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,p,k))}return Ce.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return QR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Z_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ce.resolve(Po());let g=xu,y=u;return d.next((p=>Ce.forEach(p,((b,k)=>(g<k.largestBatchId&&(g=k.largestBatchId),u.get(b)?Ce.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{y=y.insert(b,T)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,y,p,nn()))).next((b=>({batchId:g,changes:sk(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((i=>{let l=au();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=au();return this.indexManager.getCollectionParents(e,u).next((g=>Ce.forEach(g,(y=>{const p=(function(k,T){return new lc(T,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,y.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,l).next((b=>{b.forEach(((k,T)=>{d=d.insert(k,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((y,p)=>{const b=p.getKey();d.get(b)===null&&(d=d.insert(b,Qs.newInvalidDocument(b)))}));let g=au();return d.forEach(((y,p)=>{const b=u.get(y);b!==void 0&&mu(b.mutation,p,Mr.empty(),Ft.now()),mf(t,p)&&(g=g.insert(y,p))})),g}))}}class YI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ce.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Mi(l.createTime)}})(t)),Ce.resolve()}getNamedQuery(e,t){return Ce.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:VI(l.bundledQuery),readTime:Mi(l.readTime)}})(t)),Ce.resolve()}}class QI{constructor(){this.overlays=new Jn(ft.comparator),this.Lr=new Map}getOverlay(e,t){return Ce.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Po();return Ce.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ce.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ce.resolve()}getOverlaysForCollection(e,t,i){const l=Po(),u=t.length+1,d=new ft(t.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const y=g.getNext().value,p=y.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&y.largestBatchId>i&&l.set(y.getKey(),y)}return Ce.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Jn(((p,b)=>p-b));const d=this.overlays.getIterator();for(;d.hasNext();){const p=d.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let b=u.get(p.largestBatchId);b===null&&(b=Po(),u=u.insert(p.largestBatchId,b)),b.set(p.getKey(),p)}}const g=Po(),y=u.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((p,b)=>g.set(p,b))),!(g.size()>=l)););return Ce.resolve(g)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new mI(t,i));let u=this.Lr.get(t);u===void 0&&(u=nn(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class XI{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return Ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ce.resolve()}}class Ry{constructor(){this.kr=new Ts(Is.Kr),this.qr=new Ts(Is.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Is(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Is(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ft(new Mn([])),i=new Is(t,e),l=new Is(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ft(new Mn([])),i=new Is(t,e),l=new Is(t,e+1);let u=nn();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Is(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Is{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ft.comparator(e.key,t.key)||tn(e.Hr,t.Hr)}static Ur(e,t){return tn(e.Hr,t.Hr)||ft.comparator(e.key,t.key)}}class JI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Is.Kr)}checkEmpty(e){return Ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new fI(u,t,i,l);this.mutationQueue.push(d);for(const g of l)this.Jr=this.Jr.add(new Is(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return Ce.resolve(d)}lookupMutationBatch(e,t){return Ce.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ce.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(this.mutationQueue.length===0?_y:this.Yn-1)}getAllMutationBatches(e){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Is(t,0),l=new Is(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const g=this.Zr(d.Hr);u.push(g)})),Ce.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(tn);return t.forEach((l=>{const u=new Is(l,0),d=new Is(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(g=>{i=i.add(g.Hr)}))})),Ce.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ft.isDocumentKey(u)||(u=u.child(""));const d=new Is(new ft(u),0);let g=new Ts(tn);return this.Jr.forEachWhile((y=>{const p=y.key.path;return!!i.isPrefixOf(p)&&(p.length===l&&(g=g.add(y.Hr)),!0)}),d),Ce.resolve(this.Yr(g))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){kn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ce.forEach(t.mutations,(l=>{const u=new Is(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Is(t,0),l=this.Jr.firstAfterOrEqual(i);return Ce.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ce.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ZI{constructor(e){this.ti=e,this.docs=(function(){return new Jn(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ce.resolve(i?i.document.mutableCopy():Qs.newInvalidDocument(t))}getEntries(e,t){let i=wa();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Qs.newInvalidDocument(l))})),Ce.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=wa();const d=t.path,g=new ft(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(g);for(;y.hasNext();){const{key:p,value:{document:b}}=y.getNext();if(!d.isPrefixOf(p.path))break;p.path.length>d.length+1||TR(ER(b),i)<=0||(l.has(b.key)||mf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return Ce.resolve(u)}getAllFromCollectionGroup(e,t,i,l){jt(9500)}ni(e,t){return Ce.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new e6(this)}getSize(e){return Ce.resolve(this.size)}}class e6 extends WI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ce.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class t6{constructor(e){this.persistence=e,this.ri=new Jo((t=>Ey(t)),Ty),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.ii=0,this.si=new Ry,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ce.resolve()}getLastRemoteSnapshotVersion(e){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ce.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ce.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ce.resolve()}updateTargetData(e,t){return this.lr(t),Ce.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),l++)})),Ce.waitFor(u).next((()=>l))}getTargetCount(e){return Ce.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ce.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ce.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ce.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ce.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ce.resolve(i)}containsKey(e,t){return Ce.resolve(this.si.containsKey(t))}}class Ek{constructor(e,t){this._i={},this.overlays={},this.ai=new cf(0),this.ui=!1,this.ui=!0,this.ci=new XI,this.referenceDelegate=e(this),this.li=new t6(this),this.indexManager=new UI,this.remoteDocumentCache=(function(l){return new ZI(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new OI(t),this.Pi=new YI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new JI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Xe("MemoryPersistence","Starting transaction:",e);const l=new n6(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ce.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class n6 extends CR{constructor(e){super(),this.currentSequenceNumber=e}}class Iy{constructor(e){this.persistence=e,this.Ri=new Ry,this.Ai=null}static Vi(e){return new Iy(e)}get di(){if(this.Ai)return this.Ai;throw jt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ce.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ce.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ce.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.di,(i=>{const l=ft.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Mt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ce.or([()=>Ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Gh{constructor(e,t){this.persistence=e,this.fi=new Jo((i=>RR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=$I(this,t)}static Vi(e,t){return new Gh(e,t)}Ti(){}Ii(e){return Ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ce.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ce.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((g=>{g||(i++,u.removeEntry(d,Mt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ce.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ce.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ce.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ce.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sh(e.data.value)),t}wr(e,t,i){return Ce.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ce.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=nn(),l=nn();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Dy(e,t.fromCache,i,l)}}class s6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class r6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DC()?8:NR(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new s6;return this.ys(e,t,d).next((g=>{if(u.result=g,this.As)return this.ws(e,t,d,g.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ol()<=en.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Vl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ce.resolve()):(Ol()<=en.DEBUG&&Xe("QueryEngine","Query:",Vl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ol()<=en.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Vl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Di(t))):Ce.resolve())}gs(e,t){if(Z2(t))return Ce.resolve(null);let i=Di(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Dp(t,null,"F"),i=Di(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=nn(...u);return this.fs.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,i).next((y=>{const p=this.bs(t,g);return this.Ss(t,p,d,y.readTime)?this.gs(e,Dp(t,null,"F")):this.Ds(e,p,t,y)}))))})))))}ps(e,t,i,l){return Z2(t)||l.isEqual(Mt.min())?Ce.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ce.resolve(null):(Ol()<=en.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Vl(t)),this.Ds(e,d,t,jR(l,xu)).next((g=>g)))}))}bs(e,t){let i=new Ts(tk(e));return t.forEach(((l,u)=>{mf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ol()<=en.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Vl(t)),this.fs.getDocumentsMatchingQuery(e,t,io.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const My="LocalStore",i6=3e8;class a6{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Jn(tn),this.Fs=new Jo((u=>Ey(u)),Ty),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function o6(s,e,t,i){return new a6(s,e,t,i)}async function Tk(s,e){const t=Pt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],g=[];let y=nn();for(const p of l){d.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}for(const p of u){g.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((p=>({Ns:p,removedBatchIds:d,addedBatchIds:g})))}))}))}function l6(s,e){const t=Pt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(g,y,p,b){const k=p.batch,T=k.keys();let I=Ce.resolve();return T.forEach((H=>{I=I.next((()=>b.getEntry(y,H))).next((K=>{const B=p.docVersions.get(H);kn(B!==null,48541),K.version.compareTo(B)<0&&(k.applyToRemoteDocument(K,p),K.isValidDocument()&&(K.setReadTime(p.commitVersion),b.addEntry(K)))}))})),I.next((()=>g.mutationQueue.removeMutationBatch(y,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(g){let y=nn();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(y=y.add(g.batch.mutations[p].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Sk(s){const e=Pt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function c6(s,e){const t=Pt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const g=[];e.targetChanges.forEach(((b,k)=>{const T=l.get(k);if(!T)return;g.push(t.li.removeMatchingKeys(u,b.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,k))));let I=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?I=I.withResumeToken(Fs.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):b.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(b.resumeToken,i)),l=l.insert(k,I),(function(K,B,Y){return K.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=i6?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(T,I,b)&&g.push(t.li.updateTargetData(u,I))}));let y=wa(),p=nn();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),g.push(u6(u,d,e.documentUpdates).next((b=>{y=b.Bs,p=b.Ls}))),!i.isEqual(Mt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));g.push(b)}return Ce.waitFor(g).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,y,p))).next((()=>y))})).then((u=>(t.vs=l,u)))}function u6(s,e,t){let i=nn(),l=nn();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=wa();return t.forEach(((g,y)=>{const p=u.get(g);y.isFoundDocument()!==p.isFoundDocument()&&(l=l.add(g)),y.isNoDocument()&&y.version.isEqual(Mt.min())?(e.removeEntry(g,y.readTime),d=d.insert(g,y)):!p.isValidDocument()||y.version.compareTo(p.version)>0||y.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(y),d=d.insert(g,y)):Xe(My,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function d6(s,e){const t=Pt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=_y),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function h6(s,e){const t=Pt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ce.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new eo(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Vp(s,e,t){const i=Pt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!oc(d))throw d;Xe(My,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function hw(s,e,t){const i=Pt(s);let l=Mt.min(),u=nn();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,p,b){const k=Pt(y),T=k.Fs.get(b);return T!==void 0?Ce.resolve(k.vs.get(T)):k.li.getTargetData(p,b)})(i,d,Di(e)).next((g=>{if(g)return l=g.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,g.targetId).next((y=>{u=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Mt.min(),t?u:nn()))).next((g=>(f6(i,ZR(e),g),{documents:g,ks:u})))))}function f6(s,e,t){let i=s.Ms.get(e)||Mt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class fw{constructor(){this.activeTargetIds=iI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class m6{constructor(){this.vo=new fw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new fw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class g6{Mo(e){}shutdown(){}}const mw="ConnectivityMonitor";class gw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Xe(mw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Xe(mw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let dh=null;function Up(){return dh===null?dh=(function(){return 268435456+Math.round(2147483648*Math.random())})():dh++,"0x"+dh.toString(16)}const qg="RestConnection",p6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class y6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Hh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Up(),g=this.Qo(e,t.toUriEncodedString());Xe(qg,`Sending RPC '${e}' ${d}:`,g,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,u);const{host:p}=new URL(g),b=ho(p);return this.zo(e,g,y,i,b).then((k=>(Xe(qg,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Gl(qg,`RPC '${e}' ${d} failed with error: `,k,"url: ",g,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ic})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=p6[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class v6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ks="WebChannelConnection",Xc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class ql extends y6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ql.c_){const e=R_();Xc(e,A_.STAT_EVENT,(t=>{t.stat===Tp.PROXY?Xe(Ks,"STAT_EVENT: detected buffering proxy"):t.stat===Tp.NOPROXY&&Xe(Ks,"STAT_EVENT: detected no buffering proxy")})),ql.c_=!0}}zo(e,t,i,l,u){const d=Up();return new Promise(((g,y)=>{const p=new C_;p.setWithCredentials(!0),p.listenOnce(N_.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Th.NO_ERROR:const k=p.getResponseJson();Xe(Ks,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),g(k);break;case Th.TIMEOUT:Xe(Ks,`RPC '${e}' ${d} timed out`),y(new $e(_e.DEADLINE_EXCEEDED,"Request time out"));break;case Th.HTTP_ERROR:const T=p.getStatus();if(Xe(Ks,`RPC '${e}' ${d} failed with status:`,T,"response text:",p.getResponseText()),T>0){let I=p.getResponseJson();Array.isArray(I)&&(I=I[0]);const H=I?.error;if(H&&H.status&&H.message){const K=(function(Y){const te=Y.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(te)>=0?te:_e.UNKNOWN})(H.status);y(new $e(K,H.message))}else y(new $e(_e.UNKNOWN,"Server responded with status "+p.getStatus()))}else y(new $e(_e.UNAVAILABLE,"Connection failed."));break;default:jt(9055,{l_:e,streamId:d,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Xe(Ks,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Xe(Ks,`RPC '${e}' ${d} sending request:`,l),p.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Up(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Go(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const p=u.join("");Xe(Ks,`Creating RPC '${e}' stream ${l}: ${p}`,g);const b=d.createWebChannel(p,g);this.I_(b);let k=!1,T=!1;const I=new v6({Ho:H=>{T?Xe(Ks,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(k||(Xe(Ks,`Opening RPC '${e}' stream ${l} transport.`),b.open(),k=!0),Xe(Ks,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return Xc(b,iu.EventType.OPEN,(()=>{T||(Xe(Ks,`RPC '${e}' stream ${l} transport opened.`),I.i_())})),Xc(b,iu.EventType.CLOSE,(()=>{T||(T=!0,Xe(Ks,`RPC '${e}' stream ${l} transport closed`),I.o_(),this.E_(b))})),Xc(b,iu.EventType.ERROR,(H=>{T||(T=!0,Gl(Ks,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),I.o_(new $e(_e.UNAVAILABLE,"The operation could not be completed")))})),Xc(b,iu.EventType.MESSAGE,(H=>{if(!T){const K=H.data[0];kn(!!K,16349);const B=K,Y=B?.error||B[0]?.error;if(Y){Xe(Ks,`RPC '${e}' stream ${l} received error:`,Y);const te=Y.status;let Q=(function(ye){const M=bs[ye];if(M!==void 0)return fk(M)})(te),pe=Y.message;Q===void 0&&(Q=_e.INTERNAL,pe="Unknown error status: "+te+" with message "+Y.message),T=!0,I.o_(new $e(Q,pe)),b.close()}else Xe(Ks,`RPC '${e}' stream ${l} received:`,K),I.__(K)}})),ql.u_(),setTimeout((()=>{I.s_()}),0),I}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return I_()}}function b6(s){return new ql(s)}function $g(){return typeof document<"u"?document:null}function wf(s){return new kI(s,!0)}ql.c_=!1;class Ck{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Xe("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const pw="PersistentStream";class Nk{constructor(e,t,i,l,u,d,g,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ck(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===_e.RESOURCE_EXHAUSTED?(ba(t.toString()),ba("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new $e(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Xe(pw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Xe(pw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class w6 extends Nk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=TI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Mt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Mt.min():d.readTime?Mi(d.readTime):Mt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Op(this.serializer),t.addTarget=(function(u,d){let g;const y=d.target;if(g=Rp(y)?{documents:NI(u,y)}:{query:AI(u,y).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=pk(u,d.resumeToken);const p=Mp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}else if(d.snapshotVersion.compareTo(Mt.min())>0){g.readTime=Wh(u,d.snapshotVersion.toTimestamp());const p=Mp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const i=II(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Op(this.serializer),t.removeTarget=e,this.K_(t)}}class x6 extends Nk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return kn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,kn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){kn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CI(e.writeResults,e.commitTime),i=Mi(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Op(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>SI(this.serializer,i)))};this.K_(t)}}class _6{}class k6 extends _6{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new $e(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Lp(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new $e(_e.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.jo(e,Lp(t,i),l,d,g,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new $e(_e.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function j6(s,e,t,i){return new k6(s,e,t,i)}class E6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ba(t),this.aa=!1):Xe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const qo="RemoteStore";class T6{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Zo(this)&&(Xe(qo,"Restarting streams for network reachability change."),await(async function(y){const p=Pt(y);p.Ea.add(4),await zu(p),p.Va.set("Unknown"),p.Ea.delete(4),await xf(p)})(this))}))})),this.Va=new E6(i,l)}}async function xf(s){if(Zo(s))for(const e of s.Ra)await e(!0)}async function zu(s){for(const e of s.Ra)await e(!1)}function Ak(s,e){const t=Pt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Vy(t)?Oy(t):cc(t).O_()&&Py(t,e))}function Ly(s,e){const t=Pt(s),i=cc(t);t.Ia.delete(e),i.O_()&&Rk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Zo(t)&&t.Va.set("Unknown"))}function Py(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Mt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cc(s).Z_(e)}function Rk(s,e){s.da.$e(e),cc(s).X_(e)}function Oy(s){s.da=new bI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),cc(s).start(),s.Va.ua()}function Vy(s){return Zo(s)&&!cc(s).x_()&&s.Ia.size>0}function Zo(s){return Pt(s).Ea.size===0}function Ik(s){s.da=void 0}async function S6(s){s.Va.set("Online")}async function C6(s){s.Ia.forEach(((e,t)=>{Py(s,e)}))}async function N6(s,e){Ik(s),Vy(s)?(s.Va.ha(e),Oy(s)):s.Va.set("Unknown")}async function A6(s,e,t){if(s.Va.set("Online"),e instanceof gk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const g of u.targetIds)l.Ia.has(g)&&(await l.remoteSyncer.rejectListen(g,d),l.Ia.delete(g),l.da.removeTarget(g))})(s,e)}catch(i){Xe(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Kh(s,i)}else if(e instanceof Ah?s.da.Xe(e):e instanceof mk?s.da.st(e):s.da.tt(e),!t.isEqual(Mt.min()))try{const i=await Sk(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const g=u.da.Tt(d);return g.targetChanges.forEach(((y,p)=>{if(y.resumeToken.approximateByteSize()>0){const b=u.Ia.get(p);b&&u.Ia.set(p,b.withResumeToken(y.resumeToken,d))}})),g.targetMismatches.forEach(((y,p)=>{const b=u.Ia.get(y);if(!b)return;u.Ia.set(y,b.withResumeToken(Fs.EMPTY_BYTE_STRING,b.snapshotVersion)),Rk(u,y);const k=new eo(b.target,y,p,b.sequenceNumber);Py(u,k)})),u.remoteSyncer.applyRemoteEvent(g)})(s,t)}catch(i){Xe(qo,"Failed to raise snapshot:",i),await Kh(s,i)}}async function Kh(s,e,t){if(!oc(e))throw e;s.Ea.add(1),await zu(s),s.Va.set("Offline"),t||(t=()=>Sk(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Xe(qo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await xf(s)}))}function Dk(s,e){return e().catch((t=>Kh(s,t,e)))}async function _f(s){const e=Pt(s),t=co(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:_y;for(;R6(e);)try{const l=await d6(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,I6(e,l)}catch(l){await Kh(e,l)}Mk(e)&&Lk(e)}function R6(s){return Zo(s)&&s.Ta.length<10}function I6(s,e){s.Ta.push(e);const t=co(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Mk(s){return Zo(s)&&!co(s).x_()&&s.Ta.length>0}function Lk(s){co(s).start()}async function D6(s){co(s).ra()}async function M6(s){const e=co(s);for(const t of s.Ta)e.ea(t.mutations)}async function L6(s,e,t){const i=s.Ta.shift(),l=Cy.from(i,e,t);await Dk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await _f(s)}async function P6(s,e){e&&co(s).Y_&&await(async function(i,l){if((function(d){return pI(d)&&d!==_e.ABORTED})(l.code)){const u=i.Ta.shift();co(i).B_(),await Dk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await _f(i)}})(s,e),Mk(s)&&Lk(s)}async function yw(s,e){const t=Pt(s);t.asyncQueue.verifyOperationInProgress(),Xe(qo,"RemoteStore received new credentials");const i=Zo(t);t.Ea.add(3),await zu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xf(t)}async function O6(s,e){const t=Pt(s);e?(t.Ea.delete(2),await xf(t)):e||(t.Ea.add(2),await zu(t),t.Va.set("Unknown"))}function cc(s){return s.ma||(s.ma=(function(t,i,l){const u=Pt(t);return u.sa(),new w6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:S6.bind(null,s),Yo:C6.bind(null,s),t_:N6.bind(null,s),J_:A6.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Vy(s)?Oy(s):s.Va.set("Unknown")):(await s.ma.stop(),Ik(s))}))),s.ma}function co(s){return s.fa||(s.fa=(function(t,i,l){const u=Pt(t);return u.sa(),new x6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:D6.bind(null,s),t_:P6.bind(null,s),ta:M6.bind(null,s),na:L6.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await _f(s)):(await s.fa.stop(),s.Ta.length>0&&(Xe(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Uy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,g=new Uy(e,t,d,l,u);return g.start(i),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function By(s,e){if(ba("AsyncQueue",`${e}: ${s}`),oc(s))return new $e(_e.UNAVAILABLE,`${e}: ${s}`);throw s}class $l{static emptySet(e){return new $l(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ft.comparator(t.key,i.key):(t,i)=>ft.comparator(t.key,i.key),this.keyedMap=au(),this.sortedSet=new Jn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new $l;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class vw{constructor(){this.ga=new Jn(ft.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):jt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,u,d,g,y,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=y,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((g=>{d.push({type:0,doc:g})})),new ec(e,t,$l.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ff(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class V6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class U6{constructor(){this.queries=bw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Pt(t),u=l.queries;l.queries=bw(),u.forEach(((d,g)=>{for(const y of g.ba)y.onError(i)}))})(this,new $e(_e.ABORTED,"Firestore shutting down"))}}function bw(){return new Jo((s=>ek(s)),ff)}async function zy(s,e){const t=Pt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new V6,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const g=By(d,`Initialization of query '${Vl(e.query)}' failed`);return void e.onError(g)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Hy(t)}async function Fy(s,e){const t=Pt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function B6(s,e){const t=Pt(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const g of d.ba)g.Fa(l)&&(i=!0);d.wa=l}}i&&Hy(t)}function z6(s,e,t){const i=Pt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Hy(s){s.Ca.forEach((e=>{e.next()}))}var Bp,ww;(ww=Bp||(Bp={})).Ma="default",ww.Cache="cache";class qy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Bp.Cache}}class Pk{constructor(e){this.key=e}}class Ok{constructor(e){this.key=e}}class F6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=nn(),this.mutatedKeys=nn(),this.eu=tk(e),this.tu=new $l(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new vw,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,g=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,p=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,k)=>{const T=l.get(b),I=mf(this.query,k)?k:null,H=!!T&&this.mutatedKeys.has(T.key),K=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let B=!1;T&&I?T.data.isEqual(I.data)?H!==K&&(i.track({type:3,doc:I}),B=!0):this.su(T,I)||(i.track({type:2,doc:I}),B=!0,(y&&this.eu(I,y)>0||p&&this.eu(I,p)<0)&&(g=!0)):!T&&I?(i.track({type:0,doc:I}),B=!0):T&&!I&&(i.track({type:1,doc:T}),B=!0,(y||p)&&(g=!0)),B&&(I?(d=d.add(I),u=K?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:g,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,k)=>(function(I,H){const K=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jt(20277,{Vt:B})}};return K(I)-K(H)})(b.type,k.type)||this.eu(b.doc,k.doc))),this.ou(i),l=l??!1;const g=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,p=y!==this.Xa;return this.Xa=y,d.length!==0||p?{snapshot:new ec(this.query,e.tu,u,d,e.mutatedKeys,y===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=nn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Ok(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Pk(i))})),t}cu(e){this.Za=e.ks,this.Ya=nn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const $y="SyncEngine";class H6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class q6{constructor(e){this.key=e,this.hu=!1}}class $6{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Jo((g=>ek(g)),ff),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jn(ft.comparator),this.Au=new Map,this.Vu=new Ry,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function W6(s,e,t=!0){const i=Hk(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Vk(i,e,t,!0),l}async function G6(s,e){const t=Hk(s);await Vk(t,e,!0,!1)}async function Vk(s,e,t,i){const l=await h6(s.localStore,Di(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let g;return i&&(g=await K6(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Ak(s.remoteStore,l),g}async function K6(s,e,t,i,l){s.pu=(k,T,I)=>(async function(K,B,Y,te){let Q=B.view.ru(Y);Q.Ss&&(Q=await hw(K.localStore,B.query,!1).then((({documents:M})=>B.view.ru(M,Q))));const pe=te&&te.targetChanges.get(B.targetId),we=te&&te.targetMismatches.get(B.targetId)!=null,ye=B.view.applyChanges(Q,K.isPrimaryClient,pe,we);return _w(K,B.targetId,ye.au),ye.snapshot})(s,k,T,I);const u=await hw(s.localStore,e,!0),d=new F6(e,u.ks),g=d.ru(u.documents),y=Bu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),p=d.applyChanges(g,s.isPrimaryClient,y);_w(s,t,p.au);const b=new H6(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function Y6(s,e,t){const i=Pt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!ff(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Vp(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Ly(i.remoteStore,l.targetId),zp(i,l.targetId)})).catch(ac)):(zp(i,l.targetId),await Vp(i.localStore,l.targetId,!0))}async function Q6(s,e){const t=Pt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ly(t.remoteStore,i.targetId))}async function X6(s,e,t){const i=rD(s);try{const l=await(function(d,g){const y=Pt(d),p=Ft.now(),b=g.reduce(((I,H)=>I.add(H.key)),nn());let k,T;return y.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let H=wa(),K=nn();return y.xs.getEntries(I,b).next((B=>{H=B,H.forEach(((Y,te)=>{te.isValidDocument()||(K=K.add(Y))}))})).next((()=>y.localDocuments.getOverlayedDocuments(I,H))).next((B=>{k=B;const Y=[];for(const te of g){const Q=dI(te,k.get(te.key).overlayedDocument);Q!=null&&Y.push(new mo(te.key,Q,W_(Q.value.mapValue),ur.exists(!0)))}return y.mutationQueue.addMutationBatch(I,p,Y,g)})).next((B=>{T=B;const Y=B.applyToLocalDocumentSet(k,K);return y.documentOverlayCache.saveOverlays(I,B.batchId,Y)}))})).then((()=>({batchId:T.batchId,changes:sk(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,g,y){let p=d.du[d.currentUser.toKey()];p||(p=new Jn(tn)),p=p.insert(g,y),d.du[d.currentUser.toKey()]=p})(i,l.batchId,t),await Fu(i,l.changes),await _f(i.remoteStore)}catch(l){const u=By(l,"Failed to persist write");t.reject(u)}}async function Uk(s,e){const t=Pt(s);try{const i=await c6(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(kn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?kn(d.hu,14607):l.removedDocuments.size>0&&(kn(d.hu,42227),d.hu=!1))})),await Fu(t,i,e)}catch(i){await ac(i)}}function xw(s,e,t){const i=Pt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const g=d.view.va(e);g.snapshot&&l.push(g.snapshot)})),(function(d,g){const y=Pt(d);y.onlineState=g;let p=!1;y.queries.forEach(((b,k)=>{for(const T of k.ba)T.va(g)&&(p=!0)})),p&&Hy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function J6(s,e,t){const i=Pt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Jn(ft.comparator);d=d.insert(u,Qs.newNoDocument(u,Mt.min()));const g=nn().add(u),y=new bf(Mt.min(),new Map,new Jn(tn),d,g);await Uk(i,y),i.Ru=i.Ru.remove(u),i.Au.delete(e),Wy(i)}else await Vp(i.localStore,e,!1).then((()=>zp(i,e,t))).catch(ac)}async function Z6(s,e){const t=Pt(s),i=e.batch.batchId;try{const l=await l6(t.localStore,e);zk(t,i,null),Bk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Fu(t,l)}catch(l){await ac(l)}}async function eD(s,e,t){const i=Pt(s);try{const l=await(function(d,g){const y=Pt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let b;return y.mutationQueue.lookupMutationBatch(p,g).next((k=>(kn(k!==null,37113),b=k.keys(),y.mutationQueue.removeMutationBatch(p,k)))).next((()=>y.mutationQueue.performConsistencyCheck(p))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(p,b,g))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,b))).next((()=>y.localDocuments.getDocuments(p,b)))}))})(i.localStore,e);zk(i,e,t),Bk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Fu(i,l)}catch(l){await ac(l)}}function Bk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function zk(s,e,t){const i=Pt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function zp(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Fk(s,i)}))}function Fk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Ly(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Wy(s))}function _w(s,e,t){for(const i of t)i instanceof Pk?(s.Vu.addReference(i.key,e),tD(s,i)):i instanceof Ok?(Xe($y,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Fk(s,i.key)):jt(19791,{wu:i})}function tD(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Xe($y,"New document in limbo: "+t),s.Eu.add(i),Wy(s))}function Wy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ft(Mn.fromString(e)),i=s.fu.next();s.Au.set(i,new q6(t)),s.Ru=s.Ru.insert(t,i),Ak(s.remoteStore,new eo(Di(hf(t.path)),i,"TargetPurposeLimboResolution",cf.ce))}}async function Fu(s,e,t){const i=Pt(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((g,y)=>{d.push(i.pu(y,e,t).then((p=>{if((p||t)&&i.isPrimaryClient){const b=p?!p.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(p){l.push(p);const b=Dy.Es(y.targetId,p);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,p){const b=Pt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ce.forEach(p,(T=>Ce.forEach(T.Ts,(I=>b.persistence.referenceDelegate.addReference(k,T.targetId,I))).next((()=>Ce.forEach(T.Is,(I=>b.persistence.referenceDelegate.removeReference(k,T.targetId,I)))))))))}catch(k){if(!oc(k))throw k;Xe(My,"Failed to update sequence numbers: "+k)}for(const k of p){const T=k.targetId;if(!k.fromCache){const I=b.vs.get(T),H=I.snapshotVersion,K=I.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(T,K)}}})(i.localStore,u))}async function nD(s,e){const t=Pt(s);if(!t.currentUser.isEqual(e)){Xe($y,"User change. New user:",e.toKey());const i=await Tk(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((g=>{g.forEach((y=>{y.reject(new $e(_e.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Fu(t,i.Ns)}}function sD(s,e){const t=Pt(s),i=t.Au.get(e);if(i&&i.hu)return nn().add(i.key);{let l=nn();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const g=t.Tu.get(d);l=l.unionWith(g.view.nu)}return l}}function Hk(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Uk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=J6.bind(null,e),e.Pu.J_=B6.bind(null,e.eventManager),e.Pu.yu=z6.bind(null,e.eventManager),e}function rD(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eD.bind(null,e),e}class Yh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return o6(this.persistence,new r6,e.initialUser,this.serializer)}Cu(e){return new Ek(Iy.Vi,this.serializer)}Du(e){return new m6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yh.provider={build:()=>new Yh};class iD extends Yh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){kn(this.persistence.referenceDelegate instanceof Gh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new HI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new Ek((i=>Gh.Vi(i,t)),this.serializer)}}class Fp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>xw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nD.bind(null,this.syncEngine),await O6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new U6})()}createDatastore(e){const t=wf(e.databaseInfo.databaseId),i=b6(e.databaseInfo);return j6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,g){return new T6(i,l,u,d,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>xw(this.syncEngine,t,0)),(function(){return gw.v()?new gw:new g6})())}createSyncEngine(e,t){return(function(l,u,d,g,y,p,b){const k=new $6(l,u,d,g,y,p);return b&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Pt(t);Xe(qo,"RemoteStore shutting down."),i.Ea.add(5),await zu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fp.provider={build:()=>new Fp};class Gy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ba("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const uo="FirestoreClient";class aD{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Ys.UNAUTHENTICATED,this.clientId=xy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Xe(uo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Xe(uo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=By(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Wg(s,e){s.asyncQueue.verifyOperationInProgress(),Xe(uo,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Tk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function kw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await oD(s);Xe(uo,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>yw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>yw(e.remoteStore,l))),s._onlineComponents=e}async function oD(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Xe(uo,"Using user provided OfflineComponentProvider");try{await Wg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===_e.FAILED_PRECONDITION||l.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await Wg(s,new Yh)}}else Xe(uo,"Using default OfflineComponentProvider"),await Wg(s,new iD(void 0));return s._offlineComponents}async function qk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Xe(uo,"Using user provided OnlineComponentProvider"),await kw(s,s._uninitializedComponentsProvider._online)):(Xe(uo,"Using default OnlineComponentProvider"),await kw(s,new Fp))),s._onlineComponents}function lD(s){return qk(s).then((e=>e.syncEngine))}async function Qh(s){const e=await qk(s),t=e.eventManager;return t.onListen=W6.bind(null,e.syncEngine),t.onUnlisten=Y6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=G6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Q6.bind(null,e.syncEngine),t}function cD(s,e,t,i){const l=new Gy(i),u=new qy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>zy(await Qh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>Fy(await Qh(s),u)))}}function uD(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Gy({next:T=>{b.Nu(),d.enqueueAndForget((()=>Fy(u,k)));const I=T.docs.has(g);!I&&T.fromCache?p.reject(new $e(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&T.fromCache&&y&&y.source==="server"?p.reject(new $e(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),k=new qy(hf(g.path),b,{includeMetadataChanges:!0,Ka:!0});return zy(u,k)})(await Qh(s),s.asyncQueue,e,t,i))),i.promise}function dD(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Gy({next:T=>{b.Nu(),d.enqueueAndForget((()=>Fy(u,k))),T.fromCache&&y.source==="server"?p.reject(new $e(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),k=new qy(g,b,{includeMetadataChanges:!0,Ka:!0});return zy(u,k)})(await Qh(s),s.asyncQueue,e,t,i))),i.promise}function hD(s,e){const t=new ma;return s.asyncQueue.enqueueAndForget((async()=>X6(await lD(s),e,t))),t.promise}function $k(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const fD="ComponentProvider",jw=new Map;function mD(s,e,t,i,l){return new MR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,$k(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Wk="firestore.googleapis.com",Ew=!0;class Tw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $e(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wk,this.ssl=Ew}else this.host=e.host,this.ssl=e.ssl??Ew;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zI)throw new $e(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$k(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new $e(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new $e(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new $e(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new fR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new $e(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=jw.get(t);i&&(Xe(fD,"Removing Datastore"),jw.delete(t),i.terminate())})(this),Promise.resolve()}}function gD(s,e,t,i={}){s=cr(s,kf);const l=ho(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},g=`${e}:${t}`;l&&(ry(`https://${g}`),iy("Firestore",!0)),u.host!==Wk&&u.host!==g&&Gl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...u,host:g,ssl:l,emulatorOptions:i};if(!pa(y,d)&&(s._setSettings(y),i.mockUserToken)){let p,b;if(typeof i.mockUserToken=="string")p=i.mockUserToken,b=Ys.MOCK_USER;else{p=Bx(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new $e(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ys(k)}s._authCredentials=new mR(new M_(p,b))}}class go{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new go(this.firestore,e,this._query)}}class rs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new so(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Vu(t,rs._jsonSchema))return new rs(e,i||null,new ft(Mn.fromString(t.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:ks("string",rs._jsonSchemaVersion),referencePath:ks("string")};class so extends go{constructor(e,t,i){super(e,t,hf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new ft(e))}withConverter(e){return new so(this.firestore,e,this._path)}}function dt(s,e,...t){if(s=jn(s),L_("collection","path",e),s instanceof kf){const i=Mn.fromString(e,...t);return U2(i),new so(s,null,i)}{if(!(s instanceof rs||s instanceof so))throw new $e(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return U2(i),new so(s.firestore,null,i)}}function ze(s,e,...t){if(s=jn(s),arguments.length===1&&(e=xy.newId()),L_("doc","path",e),s instanceof kf){const i=Mn.fromString(e,...t);return V2(i),new rs(s,null,new ft(i))}{if(!(s instanceof rs||s instanceof so))throw new $e(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return V2(i),new rs(s.firestore,s instanceof so?s.converter:null,new ft(i))}}const Sw="AsyncQueue";class Cw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ck(this,"async_queue_retry"),this._c=()=>{const i=$g();i&&Xe(Sw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=$g();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=$g();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ma;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!oc(e))throw e;Xe(Sw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ba("INTERNAL UNHANDLED ERROR: ",Nw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Uy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&jt(47125,{Pc:Nw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Nw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Oi extends kf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Cw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Cw(e),this._firestoreClient=void 0,await e}}}function pD(s,e){const t=typeof s=="object"?s:Du(),i=typeof s=="string"?s:Hh,l=Qo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Ox("firestore");u&&gD(l,...u)}return l}function Hu(s){if(s._terminated)throw new $e(_e.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||yD(s),s._firestoreClient}function yD(s){const e=s._freezeSettings(),t=mD(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new aD(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xr(Fs.fromBase64String(e))}catch(t){throw new $e(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Xr(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Xr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vu(e,Xr._jsonSchema))return Xr.fromBase64String(e.bytes)}}Xr._jsonSchemaVersion="firestore/bytes/1.0",Xr._jsonSchema={type:ks("string",Xr._jsonSchemaVersion),bytes:ks("string")};class jf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $e(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class el{constructor(e){this._methodName=e}}class Li{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $e(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $e(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Li._jsonSchemaVersion}}static fromJSON(e){if(Vu(e,Li._jsonSchema))return new Li(e.latitude,e.longitude)}}Li._jsonSchemaVersion="firestore/geoPoint/1.0",Li._jsonSchema={type:ks("string",Li._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};class gi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:gi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vu(e,gi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new gi(e.vectorValues);throw new $e(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}gi._jsonSchemaVersion="firestore/vectorValue/1.0",gi._jsonSchema={type:ks("string",gi._jsonSchemaVersion),vectorValues:ks("object")};const vD=/^__.*__$/;class bD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new mo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Uu(e,this.data,t,this.fieldTransforms)}}class Gk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new mo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Kk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jt(40011,{dataSource:s})}}class Ef{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ef({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Xh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Kk(this.dataSource)&&vD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class wD{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||wf(e)}createContext(e,t,i,l=!1){return new Ef({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(s){const e=s._freezeSettings(),t=wf(s._databaseId);return new wD(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Ky(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Zy("Data must be an object, but it was:",d,i);const g=Jk(i,d);let y,p;if(u.merge)y=new Mr(d.fieldMask),p=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const k of u.mergeFields){const T=$o(e,k,t);if(!d.contains(T))throw new $e(_e.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);tj(b,T)||b.push(T)}y=new Mr(b),p=d.fieldTransforms.filter((k=>y.covers(k.field)))}else y=null,p=d.fieldTransforms;return new bD(new wr(g),y,p)}class Tf extends el{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tf}}function Yk(s,e,t){return new Ef({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Yy extends el{_toFieldTransform(e){return new pf(e.path,new Tu)}isEqual(e){return e instanceof Yy}}class Qy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Yk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Xl(i);return new pf(e.path,l)}isEqual(e){return e instanceof Qy&&pa(this.Ac,e.Ac)}}class Xy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Yk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Jl(i);return new pf(e.path,l)}isEqual(e){return e instanceof Xy&&pa(this.Ac,e.Ac)}}class Jy extends el{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Su(e.serializer,ak(e.serializer,this.Vc));return new pf(e.path,t)}isEqual(e){return e instanceof Jy&&this.Vc===e.Vc}}function Qk(s,e,t,i){const l=s.createContext(1,e,t);Zy("Data must be an object, but it was:",l,i);const u=[],d=wr.empty();fo(i,((y,p)=>{const b=ej(e,y,t);p=jn(p);const k=l.childContextForFieldPath(b);if(p instanceof Tf)u.push(b);else{const T=tl(p,k);T!=null&&(u.push(b),d.set(b,T))}}));const g=new Mr(u);return new Gk(d,g,l.fieldTransforms)}function Xk(s,e,t,i,l,u){const d=s.createContext(1,e,t),g=[$o(e,i,t)],y=[l];if(u.length%2!=0)throw new $e(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)g.push($o(e,u[T])),y.push(u[T+1]);const p=[],b=wr.empty();for(let T=g.length-1;T>=0;--T)if(!tj(p,g[T])){const I=g[T];let H=y[T];H=jn(H);const K=d.childContextForFieldPath(I);if(H instanceof Tf)p.push(I);else{const B=tl(H,K);B!=null&&(p.push(I),b.set(I,B))}}const k=new Mr(p);return new Gk(b,k,d.fieldTransforms)}function xD(s,e,t,i=!1){return tl(t,s.createContext(i?4:3,e))}function tl(s,e){if(Zk(s=jn(s)))return Zy("Unsupported field value:",e,s),Jk(s,e);if(s instanceof el)return(function(i,l){if(!Kk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const g of i){let y=tl(g,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),u.push(y),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=jn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ak(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Ft.fromDate(i);return{timestampValue:Wh(l.serializer,u)}}if(i instanceof Ft){const u=new Ft(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Wh(l.serializer,u)}}if(i instanceof Li)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Xr)return{bytesValue:pk(l.serializer,i._byteString)};if(i instanceof rs){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ay(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof gi)return(function(d,g){const y=d instanceof gi?d.toArray():d;return{mapValue:{fields:{[q_]:{stringValue:$_},[qh]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw g.createError("VectorValues must only contain numeric values.");return Sy(g.serializer,b)}))}}}}}})(i,l);if(kk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${lf(i)}`)})(s,e)}function Jk(s,e){const t={};return V_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fo(s,((i,l)=>{const u=tl(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function Zk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Ft||s instanceof Li||s instanceof Xr||s instanceof rs||s instanceof el||s instanceof gi||kk(s))}function Zy(s,e,t){if(!Zk(t)||!P_(t)){const i=lf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function $o(s,e,t){if((e=jn(e))instanceof jf)return e._internalPath;if(typeof e=="string")return ej(s,e);throw Xh("Field path arguments must be of type string or ",s,!1,void 0,t)}const _D=new RegExp("[~\\*/\\[\\]]");function ej(s,e,t){if(e.search(_D)>=0)throw Xh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new jf(...e.split("."))._internalPath}catch{throw Xh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Xh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let y="";return(u||d)&&(y+=" (found",u&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new $e(_e.INVALID_ARGUMENT,g+s+y)}function tj(s,e){return s.some((t=>t.isEqual(e)))}class kD{convertValue(e,t="none"){switch(lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw jt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return fo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[qh].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new gi(t)}convertGeoPoint(e){return new Li(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=df(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(_u(e));default:return null}}convertTimestamp(e){const t=ao(e);return new Ft(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Mn.fromString(e);kn(_k(i),9688,{name:e});const l=new ku(i.get(1),i.get(3)),u=new ft(i.popFirst(5));return l.isEqual(t)||ba(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class e0 extends kD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rs(this.firestore,null,t)}}function xs(){return new Yy("serverTimestamp")}function jD(...s){return new Qy("arrayUnion",s)}function ED(...s){return new Xy("arrayRemove",s)}function fi(s){return new Jy("increment",s)}const Aw="@firebase/firestore",Rw="4.10.0";function Iw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class nj{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field($o("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class TD extends nj{data(){return super.data()}}function sj(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new $e(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class t0{}class rj extends t0{}function on(s,e,...t){let i=[];e instanceof t0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((y=>y instanceof n0)).length,g=u.filter((y=>y instanceof Sf)).length;if(d>1||d>0&&g>0)throw new $e(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Sf extends rj{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Sf(e,t,i)}_apply(e){const t=this._parse(e);return ij(e._query,t),new go(e.firestore,e.converter,Ip(e._query,t))}_parse(e){const t=qu(e.firestore);return(function(u,d,g,y,p,b,k){let T;if(p.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new $e(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Mw(k,b);const H=[];for(const K of k)H.push(Dw(y,u,K));T={arrayValue:{values:H}}}else T=Dw(y,u,k)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Mw(k,b),T=xD(g,d,k,b==="in"||b==="not-in");return ws.create(p,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ut(s,e,t){const i=e,l=$o("where",s);return Sf._create(l,i,t)}class n0 extends t0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:yi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const g=u.getFlattenedFilters();for(const y of g)ij(d,y),d=Ip(d,y)})(e._query,t),new go(e.firestore,e.converter,Ip(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class s0 extends rj{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new s0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new $e(_e.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new $e(_e.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Eu(u,d)})(e._query,this._field,this._direction);return new go(e.firestore,e.converter,JR(e._query,t))}}function MP(s,e="asc"){const t=e,i=$o("orderBy",s);return s0._create(i,t)}function Dw(s,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new $e(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z_(e)&&t.indexOf("/")!==-1)throw new $e(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Mn.fromString(t));if(!ft.isDocumentKey(i))throw new $e(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return G2(s,new ft(i))}if(t instanceof rs)return G2(s,t._key);throw new $e(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lf(t)}.`)}function Mw(s,e){if(!Array.isArray(s)||s.length===0)throw new $e(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ij(s,e){const t=(function(l,u){for(const d of l)for(const g of d.getFlattenedFilters())if(u.indexOf(g.op)>=0)return g.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new $e(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function r0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class lu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vo extends nj{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field($o("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Vo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vo._jsonSchema={type:ks("string",Vo._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class Rh extends Vo{data(e={}){return super.data(e)}}class Uo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new lu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Rh(this._firestore,this._userDataWriter,i.key,i,new lu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $e(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((g=>{const y=new Rh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new lu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);return g.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((g=>u||g.type!==3)).map((g=>{const y=new Rh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new lu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);let p=-1,b=-1;return g.type!==0&&(p=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:SD(g.type),doc:y,oldIndex:p,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Uo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function SD(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jt(61501,{type:s})}}Uo._jsonSchemaVersion="firestore/querySnapshot/1.0",Uo._jsonSchema={type:ks("string",Uo._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class CD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,t,i){this._verifyNotCommitted();const l=Gg(e,this._firestore),u=r0(l.converter,t,i),d=Ky(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,ur.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Gg(e,this._firestore);let d;return d=typeof(t=jn(t))=="string"||t instanceof jf?Xk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Qk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,ur.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Gg(e,this._firestore);return this._mutations=this._mutations.concat(new vf(t._key,ur.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(_e.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gg(s,e){if((s=jn(s)).firestore!==e)throw new $e(_e.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function _s(s){s=cr(s,rs);const e=cr(s.firestore,Oi),t=Hu(e);return uD(t,s._key).then((i=>oj(e,s,i)))}function Qt(s){s=cr(s,go);const e=cr(s.firestore,Oi),t=Hu(e),i=new e0(e);return sj(s._query),dD(t,s._query).then((l=>new Uo(e,i,s,l)))}function Xn(s,e,t){s=cr(s,rs);const i=cr(s.firestore,Oi),l=r0(s.converter,e,t),u=qu(i);return $u(i,[Ky(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,ur.none())])}function zn(s,e,t,...i){s=cr(s,rs);const l=cr(s.firestore,Oi),u=qu(l);let d;return d=typeof(e=jn(e))=="string"||e instanceof jf?Xk(u,"updateDoc",s._key,e,t,i):Qk(u,"updateDoc",s._key,e),$u(l,[d.toMutation(s._key,ur.exists(!0))])}function ar(s){return $u(cr(s.firestore,Oi),[new vf(s._key,ur.none())])}function or(s,e){const t=cr(s.firestore,Oi),i=ze(s),l=r0(s.converter,e),u=qu(s.firestore);return $u(t,[Ky(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,ur.exists(!1))]).then((()=>i))}function aj(s,...e){s=jn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Iw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Iw(e[i])){const p=e[i];e[i]=p.next?.bind(p),e[i+1]=p.error?.bind(p),e[i+2]=p.complete?.bind(p)}let u,d,g;if(s instanceof rs)d=cr(s.firestore,Oi),g=hf(s._key.path),u={next:p=>{e[i]&&e[i](oj(d,s,p))},error:e[i+1],complete:e[i+2]};else{const p=cr(s,go);d=cr(p.firestore,Oi),g=p._query;const b=new e0(d);u={next:k=>{e[i]&&e[i](new Uo(d,b,p,k))},error:e[i+1],complete:e[i+2]},sj(s._query)}const y=Hu(d);return cD(y,g,l,u)}function $u(s,e){const t=Hu(s);return hD(t,e)}function oj(s,e,t){const i=t.docs.get(e._key),l=new e0(s);return new Vo(s,l,e._key,i,new lu(t.hasPendingWrites,t.fromCache),e.converter)}function Lw(s){return s=cr(s,Oi),Hu(s),new CD(s,(e=>$u(s,e)))}(function(e,t=!0){hR(Xo),pi(new ei("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),g=new Oi(new gR(i.getProvider("auth-internal")),new vR(d,i.getProvider("app-check-internal")),LR(d,l),d);return u={useFetchStreams:t,...u},g._setSettings(u),g}),"PUBLIC").setMultipleInstances(!0)),xr(Aw,Rw,e),xr(Aw,Rw,"esm2020")})();var ND="firebase",AD="12.8.0";xr(ND,AD,"app");const lj="firebasestorage.googleapis.com",cj="storageBucket",RD=120*1e3,ID=600*1e3;class as extends bi{constructor(e,t,i=0){super(Kg(e),`Firebase Storage: ${t} (${Kg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,as.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Kg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var is;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(is||(is={}));function Kg(s){return"storage/"+s}function i0(){const s="An unknown error occurred, please check the error payload for server response.";return new as(is.UNKNOWN,s)}function DD(s){return new as(is.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function MD(s){return new as(is.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function LD(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new as(is.UNAUTHENTICATED,s)}function PD(){return new as(is.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function OD(s){return new as(is.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function VD(){return new as(is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function UD(){return new as(is.CANCELED,"User canceled the upload/download.")}function BD(s){return new as(is.INVALID_URL,"Invalid URL '"+s+"'.")}function zD(s){return new as(is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function FD(){return new as(is.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cj+"' property when initializing the app?")}function HD(){return new as(is.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qD(){return new as(is.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function $D(s){return new as(is.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Hp(s){return new as(is.INVALID_ARGUMENT,s)}function uj(){return new as(is.APP_DELETED,"The Firebase app was deleted.")}function WD(s){return new as(is.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gu(s,e){return new as(is.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Jc(s){throw new as(is.INTERNAL_ERROR,"Internal error: "+s)}class lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=lr.makeFromUrl(e,t)}catch{return new lr(e,"")}if(i.path==="")return i;throw zD(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(pe){pe.path.charAt(pe.path.length-1)==="/"&&(pe.path_=pe.path_.slice(0,-1))}const d="(/(.*))?$",g=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function p(pe){pe.path_=decodeURIComponent(pe.path)}const b="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",I=new RegExp(`^https?://${k}/${b}/b/${l}/o${T}`,"i"),H={bucket:1,path:3},K=t===lj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",Y=new RegExp(`^https?://${K}/${l}/${B}`,"i"),Q=[{regex:g,indices:y,postModify:u},{regex:I,indices:H,postModify:p},{regex:Y,indices:{bucket:1,path:2},postModify:p}];for(let pe=0;pe<Q.length;pe++){const we=Q[pe],ye=we.regex.exec(e);if(ye){const M=ye[we.indices.bucket];let E=ye[we.indices.path];E||(E=""),i=new lr(M,E),we.postModify(i);break}}if(i==null)throw BD(e);return i}}class GD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function KD(s,e,t){let i=1,l=null,u=null,d=!1,g=0;function y(){return g===2}let p=!1;function b(...B){p||(p=!0,e.apply(null,B))}function k(B){l=setTimeout(()=>{l=null,s(I,y())},B)}function T(){u&&clearTimeout(u)}function I(B,...Y){if(p){T();return}if(B){T(),b.call(null,B,...Y);return}if(y()||d){T(),b.call(null,B,...Y);return}i<64&&(i*=2);let Q;g===1?(g=2,Q=0):Q=(i+Math.random())*1e3,k(Q)}let H=!1;function K(B){H||(H=!0,T(),!p&&(l!==null?(B||(g=2),clearTimeout(l),k(0)):B||(g=1)))}return k(0),u=setTimeout(()=>{d=!0,K(!0)},t),K}function YD(s){s(!1)}function QD(s){return s!==void 0}function XD(s){return typeof s=="object"&&!Array.isArray(s)}function a0(s){return typeof s=="string"||s instanceof String}function Pw(s){return o0()&&s instanceof Blob}function o0(){return typeof Blob<"u"}function qp(s,e,t,i){if(i<e)throw Hp(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Hp(`Invalid value for '${s}'. Expected ${t} or less.`)}function Cf(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function dj(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Bo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Bo||(Bo={}));function JD(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class ZD{constructor(e,t,i,l,u,d,g,y,p,b,k,T=!0,I=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=g,this.errorCallback_=y,this.timeout_=p,this.progressCallback_=b,this.connectionFactory_=k,this.retry=T,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,K)=>{this.resolve_=H,this.reject_=K,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new hh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=g=>{const y=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,p)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const g=u.getErrorCode()===Bo.NO_ERROR,y=u.getStatus();if(!g||JD(y,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Bo.ABORT;i(!1,new hh(!1,null,b));return}const p=this.successCodes_.indexOf(y)!==-1;i(!0,new hh(p,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,g=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(g,g.getResponse());QD(y)?u(y):u()}catch(y){d(y)}else if(g!==null){const y=i0();y.serverResponse=g.getErrorText(),this.errorCallback_?d(this.errorCallback_(g,y)):d(y)}else if(l.canceled){const y=this.appDelete_?uj():UD();d(y)}else{const y=VD();d(y)}};this.canceled_?t(!1,new hh(!1,null,!0)):this.backoffId_=KD(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&YD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function eM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function tM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function sM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function rM(s,e,t,i,l,u,d=!0,g=!1){const y=dj(s.urlParams),p=s.url+y,b=Object.assign({},s.headers);return nM(b,e),eM(b,t),tM(b,u),sM(b,i),new ZD(p,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,g)}function iM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function aM(...s){const e=iM();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(o0())return new Blob(s);throw new as(is.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oM(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function lM(s){if(typeof atob>"u")throw $D("base-64");return atob(s)}const Ri={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Yg{constructor(e,t){this.data=e,this.contentType=t||null}}function cM(s,e){switch(s){case Ri.RAW:return new Yg(hj(e));case Ri.BASE64:case Ri.BASE64URL:return new Yg(fj(s,e));case Ri.DATA_URL:return new Yg(dM(e),hM(e))}throw i0()}function hj(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function uM(s){let e;try{e=decodeURIComponent(s)}catch{throw gu(Ri.DATA_URL,"Malformed data URL.")}return hj(e)}function fj(s,e){switch(s){case Ri.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw gu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ri.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw gu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=lM(e)}catch(l){throw l.message.includes("polyfill")?l:gu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class mj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw gu(Ri.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=fM(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function dM(s){const e=new mj(s);return e.base64?fj(Ri.BASE64,e.rest):uM(e.rest)}function hM(s){return new mj(s).contentType}function fM(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Za{constructor(e,t){let i=0,l="";Pw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Pw(this.data_)){const i=this.data_,l=oM(i,e,t);return l===null?null:new Za(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Za(i,!0)}}static getBlob(...e){if(o0()){const t=e.map(i=>i instanceof Za?i.data_:i);return new Za(aM.apply(null,t))}else{const t=e.map(d=>a0(d)?cM(Ri.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let g=0;g<d.length;g++)l[u++]=d[g]}),new Za(l,!0)}}uploadData(){return this.data_}}function l0(s){let e;try{e=JSON.parse(s)}catch{return null}return XD(e)?e:null}function mM(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function gM(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function gj(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function pM(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||pM}}let fh=null;function yM(s){return!a0(s)||s.length<2?s:gj(s)}function pj(){if(fh)return fh;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(u,d){return yM(d)}const t=new ir("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),fh=s,fh}function vM(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new lr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function bM(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return vM(i,s),i}function yj(s,e,t){const i=l0(e);return i===null?null:bM(s,i,t)}function wM(s,e,t,i){const l=l0(e);if(l===null||!a0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(p=>{const b=s.bucket,k=s.fullPath,T="/b/"+d(b)+"/o/"+d(k),I=Cf(T,t,i),H=dj({alt:"media",token:p});return I+H})[0]}function xM(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Ow="prefixes",Vw="items";function _M(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Ow])for(const l of t[Ow]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new lr(e,u));i.prefixes.push(d)}if(t[Vw])for(const l of t[Vw]){const u=s._makeStorageReference(new lr(e,l.name));i.items.push(u)}return i}function kM(s,e,t){const i=l0(t);return i===null?null:_M(s,e,i)}class c0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function u0(s){if(!s)throw i0()}function jM(s,e){function t(i,l){const u=yj(s,l,e);return u0(u!==null),u}return t}function EM(s,e){function t(i,l){const u=kM(s,e,l);return u0(u!==null),u}return t}function TM(s,e){function t(i,l){const u=yj(s,l,e);return u0(u!==null),wM(u,l,s.host,s._protocol)}return t}function d0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=PD():l=LD():t.getStatus()===402?l=MD(s.bucket):t.getStatus()===403?l=OD(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function SM(s){const e=d0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=DD(s.path)),u.serverResponse=l.serverResponse,u}return t}function CM(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),g=Cf(d,s.host,s._protocol),y="GET",p=s.maxOperationRetryTime,b=new c0(g,y,EM(s,e.bucket),p);return b.urlParams=u,b.errorHandler=d0(e),b}function NM(s,e,t){const i=e.fullServerUrl(),l=Cf(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,g=new c0(l,u,TM(s,t),d);return g.errorHandler=SM(e),g}function AM(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function RM(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=AM(null,e)),i}function IM(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function g(){let Q="";for(let pe=0;pe<2;pe++)Q=Q+Math.random().toString().slice(2);return Q}const y=g();d["Content-Type"]="multipart/related; boundary="+y;const p=RM(e,i,l),b=xM(p,t),k="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+p.contentType+`\r
\r
`,T=`\r
--`+y+"--",I=Za.getBlob(k,i,T);if(I===null)throw HD();const H={name:p.fullPath},K=Cf(u,s.host,s._protocol),B="POST",Y=s.maxUploadRetryTime,te=new c0(K,B,jM(s,t),Y);return te.urlParams=H,te.headers=d,te.body=I.uploadData(),te.errorHandler=d0(e),te}class DM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Bo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Bo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Bo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Jc("cannot .send() more than once");if(ho(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Jc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Jc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Jc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Jc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class MM extends DM{initXhr(){this.xhr_.responseType="text"}}function h0(){return new MM}class Wo{constructor(e,t){this._service=e,t instanceof lr?this._location=t:this._location=lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Wo(e,t)}get root(){const e=new lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gj(this._location.path)}get storage(){return this._service}get parent(){const e=mM(this._location.path);if(e===null)return null;const t=new lr(this._location.bucket,e);return new Wo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WD(e)}}function LM(s,e,t){s._throwIfRoot("uploadBytes");const i=IM(s.storage,s._location,pj(),new Za(e,!0),t);return s.storage.makeRequestWithTokens(i,h0).then(l=>({metadata:l,ref:s}))}function PM(s){const e={prefixes:[],items:[]};return vj(s,e).then(()=>e)}async function vj(s,e,t){const l=await OM(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await vj(s,e,l.nextPageToken)}function OM(s,e){e!=null&&typeof e.maxResults=="number"&&qp("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=CM(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,h0)}function VM(s){s._throwIfRoot("getDownloadURL");const e=NM(s.storage,s._location,pj());return s.storage.makeRequestWithTokens(e,h0).then(t=>{if(t===null)throw qD();return t})}function UM(s,e){const t=gM(s._location.path,e),i=new lr(s._location.bucket,t);return new Wo(s.storage,i)}function BM(s){return/^[A-Za-z]+:\/\//.test(s)}function zM(s,e){return new Wo(s,e)}function bj(s,e){if(s instanceof f0){const t=s;if(t._bucket==null)throw FD();const i=new Wo(t,t._bucket);return e!=null?bj(i,e):i}else return e!==void 0?UM(s,e):s}function FM(s,e){if(e&&BM(e)){if(s instanceof f0)return zM(s,e);throw Hp("To use ref(service, url), the first argument must be a Storage instance.")}else return bj(s,e)}function Uw(s,e){const t=e?.[cj];return t==null?null:lr.makeFromBucketSpec(t,s)}function HM(s,e,t,i={}){s.host=`${e}:${t}`;const l=ho(e);l&&(ry(`https://${s.host}/b`),iy("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:Bx(u,s.app.options.projectId))}class f0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=lj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RD,this._maxUploadRetryTime=ID,this._requests=new Set,l!=null?this._bucket=lr.makeFromBucketSpec(l,this._host):this._bucket=Uw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=lr.makeFromBucketSpec(this._url,e):this._bucket=Uw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new GD(uj());{const d=rM(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Bw="@firebase/storage",zw="0.14.0";const wj="storage";function pu(s,e,t){return s=jn(s),LM(s,e,t)}function Fw(s){return s=jn(s),PM(s)}function ro(s){return s=jn(s),VM(s)}function ca(s,e){return s=jn(s),FM(s,e)}function qM(s=Du(),e){s=jn(s);const i=Qo(s,wj).getImmediate({identifier:e}),l=Ox("storage");return l&&$M(i,...l),i}function $M(s,e,t,i={}){HM(s,e,t,i)}function WM(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new f0(t,i,l,e,Xo)}function GM(){pi(new ei(wj,WM,"PUBLIC").setMultipleInstances(!0)),xr(Bw,zw,""),xr(Bw,zw,"esm2020")}GM();const xj={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},m0=ly(xj),ra=T_(m0),ge=pD(m0),ua=qM(m0),KM=new aa,YM=ly(xj,"secondary"),LP=T_(YM),QM="EYdciKDOi3UYBLk1u8hHams5tmO2",_j=w.createContext();function Pr(){return w.useContext(_j)}function XM({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[g,y]=w.useState(null),[p,b]=w.useState(!0);w.useEffect(()=>{let Q=null;const pe=e4(ra,we=>{if(t(we),Q&&(Q(),Q=null),we)if(we.uid===QM)l(!0),d(!1),y(null),b(!1);else{l(!1);const ye=on(dt(ge,"clients"),Ut("uid","==",we.uid)),M=async()=>{const E=localStorage.getItem("mcf_clientId");if(E)try{const L=await _s(ze(ge,"clients",E));L.exists()&&(d(!0),y({id:L.id,...L.data()}))}catch(L){console.error("Direct client read failed:",L)}};Q=aj(ye,async E=>{if(E.empty)await M();else{const L=E.docs[0];d(!0),y({id:L.id,...L.data()});try{localStorage.setItem("mcf_clientId",L.id)}catch{}}b(!1)},async E=>{console.error("Error listening to client data:",E),await M(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{pe(),Q&&Q()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:g,updateClientData:Q=>{y(pe=>pe?{...pe,...Q}:Q)},resolveClient:async()=>{if(g)return g;const Q=localStorage.getItem("mcf_clientId");if(Q)try{const pe=await _s(ze(ge,"clients",Q));if(pe.exists()){const we={id:pe.id,...pe.data()};return d(!0),y(we),we}}catch(pe){console.error("resolveClient direct read failed:",pe)}if(e){const pe=on(dt(ge,"clients"),Ut("uid","==",e.uid)),we=await Qt(pe);if(!we.empty){const ye={id:we.docs[0].id,...we.docs[0].data()};return d(!0),y(ye),ye}}return null},login:async(Q,pe,we=!0)=>(await Bg(ra,we?kh:yy),await XA(ra,Q,pe)),loginWithGoogle:async()=>{await Bg(ra,kh);const Q=await w4(ra,KM),pe=Q.user,we=on(dt(ge,"clients"),Ut("uid","==",pe.uid));if((await Qt(we)).empty){const M=ze(dt(ge,"clients")),E={uid:pe.uid,name:pe.displayName||"",email:pe.email.toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"google",createdAt:Ft.now()};await Xn(M,E),d(!0),y({id:M.id,...E});try{localStorage.setItem("mcf_clientId",M.id)}catch{}}return Q},signup:async(Q,pe,we)=>{await Bg(ra,kh);const ye=await QA(ra,pe.trim().toLowerCase(),we),M=ye.user,E=ze(dt(ge,"clients")),L={uid:M.uid,name:Q.trim(),email:pe.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Ft.now()};await Xn(E,L),d(!0),y({id:E.id,...L});try{localStorage.setItem("mcf_clientId",E.id)}catch{}return ye},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(ra)},resetPassword:Q=>YA(ra,Q),loading:p};return a.jsx(_j.Provider,{value:te,children:s})}const kj=w.createContext();function Ui(){return w.useContext(kj)}function JM({children:s}){const[e,t]=w.useState(()=>{const k=localStorage.getItem("theme");return k?k==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red"),[u,d]=w.useState(()=>localStorage.getItem("mono")==="true");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]),w.useEffect(()=>{document.documentElement.setAttribute("data-mono",u?"true":"false"),localStorage.setItem("mono",u?"true":"false")},[u]);const b={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:k=>l(k),isMono:u,toggleMono:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),d(!u),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)}};return a.jsx(kj.Provider,{value:b,children:s})}const jj=w.createContext();function uc(){return w.useContext(jj)}const ZM=["nutrition","buddies"],e3=[5,10],t3=2,n3=1;function s3({children:s}){const{clientData:e,loading:t}=Pr(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",g=l==="premium"||!!d;function y(p){return g?!0:!ZM.includes(p)}return{tier:l,subscriptionStatus:u,isPremium:g,canAccess:y,loading:t,FREE_RANDOMISER_DURATIONS:e3,FREE_RANDOMISER_WEEKLY_LIMIT:t3,FREE_HABIT_LIMIT:n3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(jj.Provider,{value:i,children:s})}function r3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function i3({className:s=""}){const{isDark:e,toggleTheme:t}=Ui();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function a3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,g]=w.useState(""),[y,p]=w.useState(!1),[b,k]=w.useState(!1),[T,I]=w.useState(!1),[H,K]=w.useState(!1),{login:B,loginWithGoogle:Y,resetPassword:te,currentUser:Q,isAdmin:pe,isClient:we,clientData:ye,loading:M}=Pr(),E=Zs();if(w.useEffect(()=>{if(!M&&Q){if(!Q.emailVerified&&ye?.signupSource==="self_signup"){E("/signup");return}pe?E("/dashboard"):we?E(r3(ye)):(p(!1),g("No account found. Please sign up or contact your trainer."))}},[M,Q,pe,we,ye,E]),M||Q)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const L=async D=>{D.preventDefault(),g(""),p(!0);try{await B(s,t,l)}catch(A){g(A.message||"Failed to log in"),p(!1)}},U=async()=>{g(""),K(!0);try{await Y()}catch(D){D.code!=="auth/popup-closed-by-user"&&g(D.message||"Failed to sign in with Google"),K(!1)}},P=async D=>{if(D.preventDefault(),g(""),!s.trim()){g("Please enter your email address");return}p(!0);try{await te(s.trim()),I(!0)}catch(A){A.code==="auth/user-not-found"?g("No account found with this email"):g(A.message||"Failed to send reset email")}p(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(i3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),I(!1),g("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:P,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:D=>e(D.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),g("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:L,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:D=>e(D.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:D=>i(D.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:D=>u(D.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),a.jsx("div",{className:"login-divider",children:a.jsx("span",{children:"or"})}),a.jsxs("button",{type:"button",className:"google-btn",onClick:U,disabled:H,children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",children:[a.jsx("path",{fill:"#4285F4",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),a.jsx("path",{fill:"#34A853",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),a.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),a.jsx("path",{fill:"#EA4335",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.96 2.35-8.16 2.35-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"})]}),H?"Signing in...":"Continue with Google"]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),g("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>E("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function mh({feature:s,children:e}){const{canAccess:t,loading:i}=uc();return i||t(s)?e:a.jsx(Sx,{to:"/upgrade",replace:!0})}function ni({active:s}){const e=Zs(),{clientData:t}=Pr(),{isPremium:i}=uc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function nl({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),g=w.useRef(0),y=w.useRef(!1),p=w.useCallback(T=>{window.scrollY<=0&&(g.current=T.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(T=>{if(!y.current||l)return;const I=T.touches[0].clientY-g.current;I>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((I-20)*.35,80)))},[l]),k=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:p,onTouchMove:b,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Wu(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const g=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(g),y1:t+i*Math.sin(g),x2:e+l*Math.cos(g),y2:t+l*Math.sin(g),thick:d%5===0})}return u}const Ej=Wu(60,100,100,85,96),o3=Wu(60,100,100,78,94),l3=Wu(60,100,100,82,94);Wu(60,50,50,38,46);const PP=Wu(60,40,40,30,37);function c3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[g,y]=w.useState("below"),[p,b]=w.useState(!1),k=w.useRef(null),T=w.useRef(t);T.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const we=ye=>ye.preventDefault();return document.addEventListener("touchmove",we,{passive:!1}),document.addEventListener("wheel",we,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",we),document.removeEventListener("wheel",we),document.body.style.overflow=""}},[t]);const I=w.useMemo(()=>t?s.filter(we=>document.querySelector(we.selector)):[],[t]),H=I[i],K=i===I.length-1,B=H?.selector,Y=w.useCallback(()=>{if(!B)return;const we=document.querySelector(B);if(!we){d(null);return}const ye=we.getBoundingClientRect(),M=8;d({top:ye.top-M,left:ye.left-M,width:ye.width+M*2,height:ye.height+M*2});const E=window.innerHeight-ye.bottom;y(E<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const we=document.querySelector(B);if(we){document.body.style.overflow="",we.scrollIntoView({behavior:"smooth",block:"center"});let ye=null,M=0,E=0;const L=60,U=()=>{E++;const A=we.getBoundingClientRect(),Pe=Math.round(A.top);if(ye!==null&&Pe===ye?M++:M=0,ye=Pe,M>=3||E>=L){T.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}P=requestAnimationFrame(U)};let P;const D=setTimeout(()=>{P=requestAnimationFrame(U)},120);return()=>{clearTimeout(D),P&&cancelAnimationFrame(P),T.current&&(document.body.style.overflow="hidden")}}},[t,i,B,Y]),w.useEffect(()=>{if(!t)return;const we=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",we,!0),window.addEventListener("resize",we),()=>{window.removeEventListener("scroll",we,!0),window.removeEventListener("resize",we),k.current&&cancelAnimationFrame(k.current)}},[t,Y]),!t||!H||I.length===0)return null;const te=()=>{K?e():l(i+1)},Q=()=>{i>0&&l(i-1)},pe=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:we=>{we.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:te}),u&&a.jsx("div",{className:`st-spotlight${p?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${g}${p?" st-transitioning":""}`,style:{top:g==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:g==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:I.map((we,ye)=>a.jsx("span",{className:`st-dot${ye===i?" active":""}${ye<i?" done":""}`},ye))}),a.jsx("h3",{className:"st-title",children:H.title}),a.jsx("p",{className:"st-body",children:H.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:Q,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:te,children:H.cta||(K?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:pe,children:"Skip tour"})]})]})}const u3="/login/assets/first_workout-B8SFkzJX.PNG",d3="/login/assets/workouts_10-Z5R3u0xH.PNG",h3="/login/assets/workouts_25-CzxSlcAj.PNG",f3="/login/assets/workouts_50-BpzWup3V.PNG",m3="/login/assets/workouts_100-D7_r6tn1.PNG",g3="/login/assets/streak_2-CsRr-XA9.PNG",p3="/login/assets/streak_4-BHO09tbw.PNG",y3="/login/assets/streak_8-DX2UWMko.PNG",v3="/login/assets/nutrition_7-CHVV11fj.PNG",b3="/login/assets/leaderboard_join-BLoId4Hz.PNG",w3="/login/assets/habits_7-Dvki70KO.PNG",x3="/login/assets/starter_streak-CCltAfrC.PNG",_3="/login/assets/consistency_king-Cho2jxBt.PNG",k3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",j3="/login/assets/minute_master-hA2RLkIL.PNG",E3="/login/assets/habit_machine--nFXaIUW.PNG",T3="/login/assets/iron_will-Dh2dTaie.PNG",Jr=[{id:"first_workout",img:u3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:d3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:h3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:f3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:m3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:g3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:p3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:y3,name:"8 Week Warrior",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:v3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:b3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:w3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:x3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:_3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:k3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:j3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:E3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:T3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],Hw=3,qw=5,S3=["trained","protein","steps","sleep","water"];function Qg(s){return s.toISOString().split("T")[0]}const Xg=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],Zc={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Jg(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function eu(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function C3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(g=>t(g),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function N3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Pr(),{isDark:d,toggleTheme:g}=Ui(),{isPremium:y,FREE_HABIT_LIMIT:p}=uc(),b=Zs(),[k,T]=w.useState(y?qw:p),I=k,[H,K]=w.useState({hours:0,minutes:0,seconds:0}),[B,Y]=w.useState(0),[te,Q]=w.useState(0),[pe,we]=w.useState(0),[ye,M]=w.useState(!1),[E,L]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[U,P]=w.useState(null),[D,A]=w.useState(0),[Pe,st]=w.useState(0),[Z,Te]=w.useState(Hw),[qe,Ne]=w.useState(!1),[We,V]=w.useState(!1),[ce,je]=w.useState([]),[Se,ke]=w.useState(null),[Ve,He]=w.useState(!1),Qe=w.useRef(null),[Je,$t]=w.useState(0),[Rt,Sn]=w.useState(0),[ln,qt]=w.useState(null),Et=w.useCallback((S,X="info")=>{qt({message:S,type:X}),setTimeout(()=>qt(null),4e3)},[]),[pn,Tt]=w.useState([]),[ut,le]=w.useState(!1),[pt,Ht]=w.useState(""),[it,yt]=w.useState(null),[gt,wt]=w.useState(null),[Bt,fs]=w.useState(!1),[sn,Zn]=w.useState(new Set),[Fn,Ln]=w.useState(new Set),[Pn,un]=w.useState({}),[Wt,Ct]=w.useState({}),[It,ee]=w.useState({}),[C,ne]=w.useState({}),[Re,Ie]=w.useState({}),[De,Be]=w.useState({}),Le=w.useRef(null),Dt=w.useRef(null),xt=w.useRef({}),[lt,dn]=w.useState([]),[hn,On]=w.useState(!1),ms=w.useRef(null),[ue,Me]=w.useState([]),[Ke,ct]=w.useState(""),[rt,Gt]=w.useState(!1),[fn,Nt]=w.useState(null),[St,bn]=w.useState([]),[Ss,si]=w.useState(null),[wi,Or]=w.useState(!1),js=w.useRef(!1),[hr,Gn]=w.useState(null),[os,ls]=w.useState(!1),Vn=w.useRef(!1),wn=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return y&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let S=t?.tourComplete||Vn.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(ye&&t&&!S){const X=setTimeout(()=>ls(!0),600);return()=>clearTimeout(X)}},[ye,t]),w.useEffect(()=>{if(!(!ye||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>V(!0),1500);return()=>clearTimeout(S)}}},[ye,t]),w.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const X=JSON.parse(S);Q(X.totalWorkouts??0),we(X.habitWeekPct??0),L(X.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),P(X.nutritionTargetData??null),A(X.todayHabitsCount??0),X.realHabitCount&&T(X.realHabitCount),st(X.weeklyWorkouts??0),Te(X.weeklyWorkoutTarget??Hw),je(X.leaderboardTop3??[]),$t(X.streakWeeks??0),M(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&ke(t.photoURL),t?.weeklyWorkoutTarget&&Te(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const S=on(dt(ge,"notifications"),Ut("toId","==",t.id)),X=aj(S,Ae=>{const R=Ae.docs.map(F=>({id:F.id,...F.data()}));R.sort((F,$)=>{const G=F.createdAt?.toMillis?.()||0;return($.createdAt?.toMillis?.()||0)-G}),dn(R.slice(0,50))},Ae=>{console.error("Notification listener error:",Ae),Ae.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>X()},[t]),w.useEffect(()=>{const S=X=>{ms.current&&!ms.current.contains(X.target)&&On(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),w.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[X,Ae,R]=await Promise.all([Qt(on(dt(ge,"buddies"),Ut("user1","==",S))),Qt(on(dt(ge,"buddies"),Ut("user2","==",S))),Qt(dt(ge,"clients"))]),F=new Set;[...X.docs,...Ae.docs].forEach(G=>{const fe=G.data();F.add(fe.user1===S?fe.user2:fe.user1)});const $={};R.docs.forEach(G=>{$[G.id]=G.data()}),Me(Array.from(F).filter(G=>$[G]).map(G=>({id:G,name:$[G].name,photoURL:$[G].photoURL||null})))}catch(X){console.error("Error loading buddies for mentions:",X)}})()},[t]);const es=lt.filter(S=>!S.read).length,_r=async()=>{const S=lt.filter(Ae=>!Ae.read);if(!S.length)return;const X=Lw(ge);S.forEach(Ae=>X.update(ze(ge,"notifications",Ae.id),{read:!0})),await X.commit()},Hs=async()=>{if(!lt.length)return;const S=Lw(ge);lt.forEach(X=>S.delete(ze(ge,"notifications",X.id))),await S.commit()},Kn=async(S,X,Ae={})=>{if(!(!t||S===t.id))try{await or(dt(ge,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:X,read:!1,createdAt:xs(),...Ae})}catch(R){console.error("Notification create error:",R),R.code==="permission-denied"&&Et("Notifications blocked  check Firestore rules","error")}},kr=(S,X)=>{const Ae=X==="compose"?Le.current?.selectionStart:null,F=(Ae!=null?S.slice(0,Ae):S).match(/@(\w*)$/);if(F){Gt(!0),Nt(X),ct(F[1].toLowerCase());const $=ue.filter(G=>G.name&&G.name.toLowerCase().includes(F[1].toLowerCase())).slice(0,5);bn($)}else Gt(!1),bn([])},ts=(S,X)=>{if(X==="compose"){const Ae=Le.current,R=pt,F=Ae?.selectionStart??R.length,$=R.slice(0,F),G=R.slice(F),fe=$.replace(/@\w*$/,`@${S.name} `);Ht(fe+G),setTimeout(()=>{Ae?.focus(),Ae.selectionStart=Ae.selectionEnd=fe.length},0)}else{const R=(Wt[X]||"").replace(/@\w*$/,`@${S.name} `);Ct(F=>({...F,[X]:R}))}Gt(!1),bn([])},Vr=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((Ae,R)=>Ae.startsWith("@")&&ue.some(F=>Ae.trim()===`@${F.name}`)?a.jsx("span",{className:"mention-highlight",children:Ae.trim()},R):Ae),O=async S=>{const X=S.target.files?.[0];if(!(!X||!t)){if(!X.type.startsWith("image/")){Et("Please select an image file","error");return}if(X.size>5*1024*1024){Et("Image must be under 5MB","error");return}He(!0);try{const Ae=await new Promise($=>{const G=new Image;G.onload=()=>{const fe=document.createElement("canvas"),ve=400;let Oe=G.width,tt=G.height;Oe>tt?(tt=tt/Oe*ve,Oe=ve):(Oe=Oe/tt*ve,tt=ve),fe.width=Oe,fe.height=tt,fe.getContext("2d").drawImage(G,0,0,Oe,tt),fe.toBlob(nt=>$(nt),"image/jpeg",.75)},G.src=URL.createObjectURL(X)}),R=ca(ua,`profilePhotos/${t.id}`);await pu(R,Ae);const F=await ro(R);await zn(ze(ge,"clients",t.id),{photoURL:F}),ke(F),l({photoURL:F}),Et("Profile photo updated!","success")}catch(Ae){console.error("Photo upload error:",Ae),Et("Failed to upload photo","error")}He(!1),Qe.current&&(Qe.current.value="")}};w.useEffect(()=>{const S=()=>{const Ae=new Date,R=new Date(Ae);R.setHours(23,59,59,999);const F=R-Ae,$=Math.floor(F/(1e3*60*60)),G=Math.floor(F%(1e3*60*60)/(1e3*60)),fe=Math.floor(F%(1e3*60)/1e3);K({hours:$,minutes:G,seconds:fe}),Y(60-fe)};S();const X=setInterval(S,1e3);return()=>clearInterval(X)},[]),w.useEffect(()=>{const S=setInterval(()=>{Sn(X=>(X+1)%Xg.length)},8e3);return()=>clearInterval(S)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let X=null,Ae=null;try{const R=Qg(new Date),F=dt(ge,"workoutLogs"),$=on(F,Ut("clientId","==",t.id));X=await Qt($),Q(X.docs.length);const G=new Date,fe=G.getDay(),ve=fe===0?6:fe-1,Oe=new Date(G);Oe.setDate(G.getDate()-ve),Oe.setHours(0,0,0,0);const tt=Oe.getTime(),nt=X.docs.filter(rn=>{const mt=rn.data().completedAt;return mt?(mt.toDate?mt.toDate().getTime():new Date(mt).getTime())>=tt:!1}).length;st(nt);const[vt,_t]=await Promise.all([Qt(on(dt(ge,"habitLogs"),Ut("clientId","==",t.id),Ut("date","==",R))),_s(ze(ge,"customHabits",t.id))]);let Xt=qw;if(_t.exists()){const rn=_t.data(),mt=rn.habits||[],gn=rn.hiddenDefaults||[];Xt=S3.filter(tr=>!gn.includes(tr)).length+mt.length}y||(Xt=Math.min(Xt,p)),T(Xt);let Hn=0;if(!vt.empty){const rn=vt.docs[0].data().habits||{};Hn=Object.values(rn).filter(Boolean).length}we(Math.round(Hn/Xt*100)),A(Hn);const et=await _s(ze(ge,"nutritionTargets",t.id));et.exists()&&(P(et.data()),Ae=et.data());const mn=await _s(ze(ge,"nutritionLogs",`${t.id}_${R}`));if(mn.exists()){const mt=(mn.data().entries||[]).reduce((gn,Qn)=>({protein:gn.protein+(Qn.protein||0),carbs:gn.carbs+(Qn.carbs||0),fats:gn.fats+(Qn.fats||0),calories:gn.calories+(Qn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});L(mt)}}catch(R){console.error("Error loading dashboard stats:",R)}try{const R=dt(ge,"clients"),F=on(R,Ut("leaderboardOptIn","==",!0)),G=(await Qt(F)).docs.map(fe=>({id:fe.id,name:fe.data().name,photoURL:fe.data().photoURL||null}));if(je(G.slice(0,3)),t?.id){const fe=G.findIndex(Oe=>Oe.id===t.id),ve=fe>=0?fe+1:null;try{const Oe=`lbRank_${t.id}`,tt=sessionStorage.getItem(Oe);tt&&Gn(parseInt(tt,10)),ve&&sessionStorage.setItem(Oe,String(ve))}catch{}}}catch(R){console.error("Leaderboard preview error:",R)}try{let R=0;if(X){const F=X.docs.map($=>$.data().date).filter(Boolean).sort().reverse();if(F.length>0){const $=new Date;let G=new Date($);e:for(let fe=0;fe<52;fe++){const ve=new Date(G),Oe=ve.getDay(),tt=Oe===0?6:Oe-1;ve.setDate(ve.getDate()-tt),ve.setHours(0,0,0,0);const nt=new Date(ve);nt.setDate(nt.getDate()+7);const vt=Qg(ve),_t=Qg(nt);if(F.some(Hn=>Hn>=vt&&Hn<_t))R++;else{if(fe>0)break e;break}G.setDate(G.getDate()-7)}}}$t(R)}catch(R){console.error("Streak computation error:",R)}M(!0)})()},[s,t,I]),w.useEffect(()=>{if(!(!ye||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:te,habitWeekPct:pe,nutritionTotals:E,nutritionTargetData:U,todayHabitsCount:D,realHabitCount:k,weeklyWorkouts:Pe,weeklyWorkoutTarget:Z,leaderboardTop3:ce,streakWeeks:Je}))}catch{}},[ye,te,pe,E,U,D,Pe,Z,ce,Je,t]),w.useEffect(()=>{if(!(!ye||js.current)&&Pe>=Z&&Z>0){const S=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(S))return;sessionStorage.setItem(S,"1")}catch{}js.current=!0,Or(!0),setTimeout(()=>Or(!1),3500)}},[ye,Pe,Z,t]);const q=w.useCallback(async()=>{if(Vn.current=!0,ls(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await zn(ze(ge,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),oe=w.useCallback(async S=>{if(Te(S),Ne(!1),V(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await zn(ze(ge,"clients",t.id),{weeklyWorkoutTarget:S})}catch(X){console.error("Failed to save weekly target:",X)}}},[t]),se=S=>{const X=S.currentTarget,Ae=X.querySelector(".ripple");Ae&&Ae.remove();const R=X.getBoundingClientRect(),F=Math.max(R.width,R.height),$=S.clientX-R.left-F/2,G=S.clientY-R.top-F/2,fe=document.createElement("span");fe.className="ripple",fe.style.cssText=`width:${F}px;height:${F}px;left:${$}px;top:${G}px;`,X.appendChild(fe),setTimeout(()=>fe.remove(),600)},Ye=t?.name?.split(" ")[0]||"there",Ge=Math.min(Math.round(Pe/Z*100),100),Fe=Je>0?Math.min(Math.round(Je/12*100),100):0,ot=[{label:"Wk Streak",value:`${Je}`,pct:Fe,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Pe}/${Z}`,pct:Ge,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${pe}%`,pct:pe,color:"var(--color-primary)",size:"normal"}],At=E.calories>0&&U?.calories&&E.calories>=U.calories*.8,Cn=Pe>=Z&&Z>0,Cs=D>=I,Yn=(()=>{if(!ye)return null;const S=Z-Pe;return S===1?"1 more workout to hit your weekly goal":S===2?"2 more workouts to hit your weekly goal":I-D===1?"1 habit left to complete today":null})(),Ds=S=>!U||!U[S]?0:Math.min(Math.round(E[S]/U[S]*100),100),ri=(()=>{const S=new Date().getHours(),X=ye&&D>=I&&E.calories>0,Ae=R=>R[Math.floor(Date.now()/6e4%R.length)];return X?Ae(Zc.allDone):S>=5&&S<12?Ae(Zc.morning):S>=12&&S<17?Ae(Zc.afternoon):S>=17&&S<21?Ae(Zc.evening):Ae(Zc.night)})(),Ms=ye?Pe===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:D<I?{label:"DAILY HABITS",message:`${D}/${I} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:pe,ringLabel:`${D}/${I}`}:y&&E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,er=w.useCallback(async()=>{if(t){le(!0);try{const X=(await Qt(on(dt(ge,"posts"),Ut("authorId","==",t.id)))).docs.map(R=>({id:R.id,...R.data()})).sort((R,F)=>{const $=R.createdAt?.toDate?.()||new Date(0);return(F.createdAt?.toDate?.()||new Date(0))-$}).slice(0,30);Tt(X);const Ae=await Qt(on(dt(ge,"postLikes"),Ut("userId","==",t.id)));Zn(new Set(Ae.docs.map(R=>R.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{le(!1)}}},[t]);w.useEffect(()=>{ye&&t&&er()},[ye,t,er]);const xi=S=>{const X=S.target.files?.[0];if(X){if(!X.type.startsWith("image/")){Et("Please select an image file","error");return}if(X.size>10*1024*1024){Et("Image must be under 10MB","error");return}yt(X),wt(URL.createObjectURL(X))}},jr=()=>{yt(null),gt&&URL.revokeObjectURL(gt),wt(null),Dt.current&&(Dt.current.value="")},Ns=async()=>{if(!(!pt.trim()&&!it||Bt||!t)){fs(!0);try{let S=null;if(it){const F=await C3(it),$=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,G=ca(ua,`postImages/${t.id}/${$}`);await pu(G,F),S=await ro(G)}await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:pt.trim(),type:S?"image":"text",imageURL:S||null,createdAt:xs(),likeCount:0,commentCount:0});const Ae=pt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ae){const F=new Set;Ae.forEach($=>{const G=$.slice(1).trim(),fe=ue.find(ve=>ve.name&&ve.name.toLowerCase()===G.toLowerCase());fe&&!F.has(fe.id)&&(F.add(fe.id),Kn(fe.id,"mention",{}))})}Ht(""),jr(),Le.current&&(Le.current.style.height="auto"),await er();const R=ue.length;Et(R>0?`Shared with ${R} ${R===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(S){console.error("Error posting:",S),Et(S?.message||"Failed to post","error")}finally{fs(!1)}}},ja=async S=>{if(window.confirm("Delete this post?"))try{await ar(ze(ge,"posts",S)),Tt(X=>X.filter(Ae=>Ae.id!==S)),Et("Post deleted","info")}catch(X){console.error("Delete error:",X),Et("Failed to delete","error")}},Bi=async S=>{if(!t)return;const X=t.id,Ae=`${S}_${X}`,R=sn.has(S),F=new Set(sn);R?F.delete(S):F.add(S),Zn(F),Tt($=>$.map(G=>G.id===S?{...G,likeCount:Math.max(0,(G.likeCount||0)+(R?-1:1))}:G));try{if(R)await ar(ze(ge,"postLikes",Ae)),await zn(ze(ge,"posts",S),{likeCount:fi(-1)});else{await Xn(ze(ge,"postLikes",Ae),{postId:S,userId:X,createdAt:xs()}),await zn(ze(ge,"posts",S),{likeCount:fi(1)});const $=pn.find(G=>G.id===S);$&&Kn($.authorId,"like",{postId:S})}}catch($){console.error("Like error:",$),er()}},ii=async S=>{try{const Ae=(await Qt(on(dt(ge,"postComments"),Ut("postId","==",S)))).docs.map(R=>({id:R.id,...R.data()})).sort((R,F)=>{const $=R.createdAt?.toDate?.()||new Date(0),G=F.createdAt?.toDate?.()||new Date(0);return $-G}).slice(0,50);un(R=>({...R,[S]:Ae}))}catch(X){console.error("Error loading comments:",X)}},_i=S=>{const X=new Set(Fn);X.has(S)?X.delete(S):(X.add(S),Pn[S]||ii(S)),Ln(X)},zi=async S=>{const X=(Wt[S]||"").trim(),Ae=Re[S];if(!(!X&&!Ae||!t)){ee(R=>({...R,[S]:!0}));try{let R=null;if(Ae){const ve=ca(ua,`comment-images/${Date.now()}_${Ae.name}`);await pu(ve,Ae),R=await ro(ve)}const F={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:X||"",createdAt:xs()};R&&(F.imageURL=R);const $=C[S];$&&(F.replyToId=$.id,F.replyToName=$.authorName),await or(dt(ge,"postComments"),F),await zn(ze(ge,"posts",S),{commentCount:fi(1)});const G=pn.find(ve=>ve.id===S);G&&Kn(G.authorId,"comment",{postId:S});const fe=X.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(fe){const ve=new Set;fe.forEach(Oe=>{const tt=Oe.slice(1).trim(),nt=ue.find(vt=>vt.name&&vt.name.toLowerCase()===tt.toLowerCase());nt&&!ve.has(nt.id)&&(ve.add(nt.id),Kn(nt.id,"mention",{postId:S}))})}Ct(ve=>({...ve,[S]:""})),Ie(ve=>({...ve,[S]:null})),Be(ve=>({...ve,[S]:null})),ne(ve=>({...ve,[S]:null})),xt.current[S]&&(xt.current[S].value=""),Tt(ve=>ve.map(Oe=>Oe.id===S?{...Oe,commentCount:(Oe.commentCount||0)+1}:Oe)),await ii(S)}catch(R){console.error("Comment error:",R),Et("Failed to comment","error")}finally{ee(R=>({...R,[S]:!1}))}}},Ur=async(S,X)=>{try{await ar(ze(ge,"postComments",X)),await zn(ze(ge,"posts",S),{commentCount:fi(-1)}),un(Ae=>({...Ae,[S]:(Ae[S]||[]).filter(R=>R.id!==X)})),Tt(Ae=>Ae.map(R=>R.id===S?{...R,commentCount:Math.max((R.commentCount||1)-1,0)}:R))}catch(Ae){console.error("Delete comment error:",Ae),Et("Failed to delete comment","error")}},Er=(S,X)=>{const Ae=X.target.files?.[0];if(!Ae)return;if(Ae.size>5*1024*1024){Et("Image must be under 5MB","error");return}Ie(F=>({...F,[S]:Ae}));const R=new FileReader;R.onload=F=>Be($=>({...$,[S]:F.target.result})),R.readAsDataURL(Ae)},qs=S=>{Ie(X=>({...X,[S]:null})),Be(X=>({...X,[S]:null})),xt.current[S]&&(xt.current[S].value="")},$s=S=>{Ht(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",kr(S.target.value,"compose")},Ls=(S,X)=>{Ct(Ae=>({...Ae,[S]:X})),kr(X,S)};return a.jsx(nl,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:ms,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{On(!hn),hn||_r()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),es>0&&a.jsx("span",{className:"header-notif-badge",children:es>9?"9+":es})]}),hn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),lt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Hs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:lt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):lt.map(S=>a.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(On(!1),S.type==="buddy_request"||S.type==="buddy_accept")b(y?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!Fn.has(S.postId)){const X=new Set(Fn);X.add(S.postId),Ln(X),Pn[S.postId]||ii(S.postId)}setTimeout(()=>{const X=document.getElementById(`post-${S.postId}`);X&&X.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&b(`/client/core-buddy/profile/${S.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?a.jsx("img",{src:S.fromPhotoURL,alt:""}):a.jsx("span",{children:(S.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Jg(S.createdAt)})]})]},S.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:g,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Ej.map((S,X)=>{const Ae=X<B;return a.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${Ae?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},X)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Qe.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Se||"/Logo.webp",alt:Se?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ve?" uploading":""}`,children:Ve?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Qe,type:"file",accept:"image/*",onChange:O,style:{display:"none"}})]}),!Se&&!Ve&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Qe.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(H.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(H.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(H.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Xg[Rt].text," ",a.jsx("strong",{children:Xg[Rt].bold})]},Rt)]}),a.jsx("div",{className:"cb-stats-row",children:ot.map(S=>{const X=(S.size==="large",38),Ae=2*Math.PI*X,R=Ae-S.pct/100*Ae,F=S.editable,$=S.pct>=75&&S.pct<100,G=S.pct>=100;return a.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${F?" cb-stat-tappable":""}${F&&We?" cb-stat-hint":""}${$?" cb-stat-near":""}${G?" cb-stat-complete":""}`,onClick:F?()=>{Ne(!0),V(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:X}),a.jsx("circle",{className:`cb-stat-fill${$?" cb-fill-near":""}${G?" cb-fill-complete":""}`,cx:"50",cy:"50",r:X,strokeDasharray:Ae,strokeDashoffset:R})]}),a.jsx("span",{className:`cb-stat-value${G?" cb-val-complete":""}`,children:S.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[S.label==="Wk Streak"&&Je>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),S.label]})]},S.label)})}),qe&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Ne(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>a.jsx("button",{className:`cb-target-option${S===Z?" active":""}`,onClick:()=>oe(S),children:S},S))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[ri.main," ",a.jsx("strong",{children:Ye}),"  ",ri.sub]}),Yn&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Yn})]}),Ms&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ms.action||void 0,style:Ms.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ms.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ms.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ms.label}),a.jsx("span",{className:"cb-nudge-title",children:Ms.message}),Ms.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ms.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[y&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${At?" cb-card-done":""}`,onClick:S=>{se(S),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ds("protein"),color:"var(--color-primary)"},{label:"C",pct:Ds("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ds("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Ds("calories"),color:"var(--color-primary)"}].map(S=>{const Ae=2*Math.PI*38,R=Ae-S.pct/100*Ae;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:Ae,strokeDashoffset:R})]}),a.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${Cn?" cb-card-done":""}`,onClick:S=>{se(S),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Pe," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[te," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Cs?" cb-card-done":""}`,onClick:S=>{se(S),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${D>=I?" cb-habits-all-done":""}`,children:Array.from({length:I},(S,X)=>a.jsx("span",{className:`cb-habit-dot${X<D?" done":""}${!X&&D>0&&X>=D?" cb-dot-warming":""}`,style:X>=D&&D>0?{"--glow-intensity":Math.min(D/I,.9)}:void 0},X))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[D,"/",I," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{se(S),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),ce.length>0?a.jsx("div",{className:"cb-lb-preview",children:ce.map((S,X)=>{const Ae=["#FFD700","#A8B4C0","#CD7F32"][X],R=S.name?S.name.split(" ").map(fe=>fe[0]).join("").slice(0,2).toUpperCase():"?",F=S.id===t?.id,$=X+1,G=F&&hr?hr-$:0;return a.jsxs("div",{className:`cb-lb-entry${F?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ae},children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:R})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ae},children:["#",$,F&&G>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",G]}),F&&G<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:G})]})]},S.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:S=>{se(S),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Jr.find(S=>S.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:S=>{se(S),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:Jr.find(S=>S.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),y&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{se(S),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Se?a.jsx("img",{src:Se,alt:""}):a.jsx("span",{children:eu(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Le,placeholder:"Share your progress... (use @ to mention)",value:pt,onChange:$s,rows:1,maxLength:500}),rt&&fn==="compose"&&St.length>0&&a.jsx("div",{className:"mention-dropdown",children:St.map(S=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(S,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:""}):a.jsx("span",{children:eu(S.name)})}),a.jsx("span",{children:S.name})]},S.id))}),gt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:gt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:jr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Dt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Dt,type:"file",accept:"image/*",onChange:xi,hidden:!0}),(pt.trim()||it)&&a.jsx("button",{className:"journey-post-btn",onClick:Ns,disabled:Bt,children:Bt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ut?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):pn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:pn.map(S=>a.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?a.jsx("img",{src:S.authorPhotoURL,alt:""}):a.jsx("span",{children:eu(S.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:S.authorName}),a.jsx("span",{className:"journey-post-time",children:Jg(S.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>ja(S.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(X=>`${X.value} ${X.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const X=Jr.find(Ae=>Ae.id===S.metadata.badgeId);return X?.img?a.jsx("img",{src:X.img,alt:S.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(X=>`${X.value} ${X.label}`).join("    ")}),S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[S.content&&a.jsx("p",{className:"journey-post-content",children:Vr(S.content)}),S.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${sn.has(S.id)?" liked":""}`,onClick:()=>Bi(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:sn.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:S.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(S.id)?" active":""}`,onClick:()=>_i(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:S.commentCount||0})]})]}),Fn.has(S.id)&&a.jsxs("div",{className:"journey-comments",children:[Pn[S.id]?.length>0?Pn[S.id].map(X=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:X.authorPhotoURL?a.jsx("img",{src:X.authorPhotoURL,alt:""}):a.jsx("span",{children:eu(X.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:X.authorName}),X.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),X.replyToName]}),X.content&&a.jsx("span",{className:"journey-comment-text",children:Vr(X.content)}),X.imageURL&&a.jsx("img",{className:"journey-comment-image",src:X.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Jg(X.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>ne(Ae=>({...Ae,[S.id]:{id:X.id,authorName:X.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ur(S.id,X.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},X.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),C[S.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:C[S.id].authorName})]}),a.jsx("button",{onClick:()=>ne(X=>({...X,[S.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),De[S.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:De[S.id],alt:"Preview"}),a.jsx("button",{onClick:()=>qs(S.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>xt.current[S.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:X=>{xt.current[S.id]=X},type:"file",accept:"image/*",onChange:X=>Er(S.id,X),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Wt[S.id]||"",onChange:X=>Ls(S.id,X.target.value),onKeyDown:X=>{X.key==="Enter"&&zi(S.id)},maxLength:300}),rt&&fn===S.id&&St.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:St.map(X=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(X,S.id),children:[a.jsx("div",{className:"mention-option-avatar",children:X.photoURL?a.jsx("img",{src:X.photoURL,alt:""}):a.jsx("span",{children:eu(X.name)})}),a.jsx("span",{children:X.name})]},X.id))}),a.jsx("button",{onClick:()=>zi(S.id),disabled:!(Wt[S.id]||"").trim()&&!Re[S.id]||It[S.id],children:It[S.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!y&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(ni,{active:"home"}),wi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Pe,"/",Z," sessions complete"]})]})}),ln&&a.jsxs("div",{className:`toast-notification ${ln.type}`,children:[ln.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),ln.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),ln.message]}),a.jsx(c3,{steps:wn,active:os,onFinish:q})]})})}async function Jh(s,e){const t=Jr.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=ze(ge,"coreBuddyBadges",e.id),l=await _s(i),u=l.exists()?l.data().earned||[]:[];if(u.some(g=>g.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await zn(i,{earned:[...u,d]}):await Xn(i,{earned:[d]}),await or(dt(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:xs(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function Wl({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const Zg=new Map;function Yr(){return new Date().toISOString().split("T")[0]}const $w=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],A3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function R3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function I3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState("loading"),[p,b]=w.useState(null),[k,T]=w.useState(null),[I,H]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[K,B]=w.useState(null),[Y,te]=w.useState(Yr()),[Q,pe]=w.useState({entries:[]}),[we,ye]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[M,E]=w.useState(!1),[L,U]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[P,D]=w.useState(!1),[A,Pe]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[st,Z]=w.useState(!1),[Te,qe]=w.useState(R3),[Ne,We]=w.useState(null),[V,ce]=w.useState(null),[je,Se]=w.useState(!1),[ke,Ve]=w.useState(null),[He,Qe]=w.useState(""),[Je,$t]=w.useState(!1),[Rt,Sn]=w.useState(""),[ln,qt]=w.useState([]),[Et,pn]=w.useState(!1),[Tt,ut]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,pt]=w.useState(null),[Ht,it]=w.useState("100"),[yt,gt]=w.useState(0),[wt,Bt]=w.useState("weight"),[fs,sn]=w.useState(0),[Zn,Fn]=w.useState(null);w.useRef(null);const Ln=w.useRef(!1),Pn=w.useRef(null),un=w.useRef(null),Wt=w.useRef(null),Ct=w.useCallback((O,q="info")=>{Fn({message:O,type:q}),setTimeout(()=>Fn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ge,"nutritionTargets",t.id));q.exists()?(b(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ge,"nutritionLogs",`${t.id}_${Y}`));if(q.exists()){const oe=q.data();pe({entries:oe.entries||[]})}else pe({entries:[]})}catch(q){console.error("Error loading log:",q),pe({entries:[]})}})()},[t?.id,Y]),w.useEffect(()=>{const O=Q.entries.reduce((q,oe)=>({protein:q.protein+(oe.protein||0),carbs:q.carbs+(oe.carbs||0),fats:q.fats+(oe.fats||0),calories:q.calories+(oe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ye(O)},[Q.entries]);const It=async O=>{try{if(await Xn(ze(ge,"nutritionLogs",`${t.id}_${Y}`),{clientId:t.id,date:Y,entries:O.entries,updatedAt:Ft.now()}),p?.protein&&Y===Yr()&&O.entries.reduce((oe,se)=>oe+(se.protein||0),0)>=p.protein){let oe=1;for(let se=1;se<7;se++){const Ye=new Date;Ye.setDate(Ye.getDate()-se);const Ge=Ye.toISOString().split("T")[0];try{const Fe=await _s(ze(ge,"nutritionLogs",`${t.id}_${Ge}`));if(Fe.exists())if((Fe.data().entries||[]).reduce((At,Cn)=>At+(Cn.protein||0),0)>=p.protein)oe++;else break;else break}catch{break}}if(oe>=7){const se=await Jh("nutrition_7",t);se&&T(se)}}}catch(q){console.error("Error saving nutrition log:",q)}},ee=Y===Yr(),C=(O,q)=>new Date(O,q+1,0).getDate(),ne=(O,q)=>new Date(O,q,1).getDay(),Re=O=>{if(O===Yr())return"Today";const q=new Date(O+"T12:00:00"),oe=new Date;return oe.setDate(oe.getDate()-1),O===oe.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},Ie=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],Be=()=>{let O=parseFloat(I.weight);I.weightUnit==="lbs"&&(O*=.453592);let q;I.heightUnit==="cm"?q=parseFloat(I.height):q=(parseFloat(I.heightFeet)||0)*30.48+(parseFloat(I.heightInches)||0)*2.54;const oe=parseInt(I.age);let se=I.gender==="male"?10*O+6.25*q-5*oe+5:10*O+6.25*q-5*oe-161;const Ge=se*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[I.dailyActivity],Fe={low:100,moderate:200,high:300,daily:400},ot=Math.round(Ge+Fe[I.trainingFrequency]);let At=ot,Cn,Cs;switch(I.goal){case"lose":At=ot*(1-{light:.15,moderate:.2,harsh:.25}[I.deficitLevel]),Cn=2.2,Cs=.3;break;case"build":At=ot*1.1,Cn=2,Cs=.22;break;default:Cn=1.8,Cs=.25}At=Math.max(At,I.gender==="male"?1400:1100);const Yn=Math.round(O*Cn),Ds=Math.round(At*Cs/9),ri=Math.max(0,Math.round((At-Yn*4-Ds*9)/4));B({calories:Math.round(At),protein:Yn,carbs:ri,fats:Ds,bmr:Math.round(se),neat:Math.round(Ge),exerciseAdd:Fe[I.trainingFrequency],tdee:Math.round(ot)}),setTimeout(()=>{document.querySelector(".nut-calc-results")?.scrollIntoView({behavior:"smooth",block:"start"})},100)},Le=async()=>{if(K)try{const O={clientId:t.id,calories:K.calories,protein:K.protein,carbs:K.carbs,fats:K.fats,goal:I.goal,updatedAt:Ft.now()};await Xn(ze(ge,"nutritionTargets",t.id),O),b(O),y("dashboard"),Ct("Macro targets saved!","success")}catch(O){console.error("Error saving targets:",O),Ct("Failed to save targets. Please try again.","error")}},Dt=()=>{const O=I.weight&&parseFloat(I.weight)>0,q=I.age&&parseInt(I.age)>0,oe=I.heightUnit==="cm"?I.height&&parseFloat(I.height)>0:I.heightFeet&&parseFloat(I.heightFeet)>0||I.heightInches&&parseFloat(I.heightInches)>0;return O&&q&&oe},xt="nut_favourite_foods",lt=()=>{try{return JSON.parse(localStorage.getItem(xt)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ge,"favouriteFoods",t.id));if(q.exists()){const oe=q.data().items||[];localStorage.setItem(xt,JSON.stringify(oe)),sn(se=>se+1)}else{const oe=lt();oe.length>0&&await Xn(ze(ge,"favouriteFoods",t.id),{items:oe,updatedAt:Ft.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const dn=O=>lt().some(q=>q.name.toLowerCase()===(O||"").toLowerCase()),hn=O=>{const q=lt(),oe=q.findIndex(se=>se.name.toLowerCase()===O.name.toLowerCase());oe>=0?q.splice(oe,1):q.unshift({name:O.name,protein:O.protein,carbs:O.carbs,fats:O.fats,calories:O.calories,serving:O.serving,per100g:O.per100g||null,servingUnit:O.servingUnit||"g",portion:O.portion||null}),localStorage.setItem(xt,JSON.stringify(q)),t?.id&&Xn(ze(ge,"favouriteFoods",t.id),{items:q,updatedAt:Ft.now()}).catch(se=>console.error("Error saving favourites:",se)),sn(se=>se+1)},On=O=>{const q=[...Q.entries,{...O,meal:Te,id:Date.now(),addedAt:new Date().toISOString()}],oe={...Q,entries:q};pe(oe),It(oe),ce(null),pt(null),it("100"),gt(0),Bt("weight"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ct("Food added!","success")},ms=O=>{const q=Q.entries.filter(se=>se.id!==O),oe={...Q,entries:q};pe(oe),It(oe)},ue=async O=>{if(!(!t?.id||O===Y)){Z(!0);try{const q=await _s(ze(ge,"nutritionLogs",`${t.id}_${O}`));if(!q.exists()||!q.data().entries?.length){Ct("No food logged on that day","error");return}const oe=q.data().entries.map(Ge=>({...Ge,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),se=[...Q.entries,...oe],Ye={...Q,entries:se};pe(Ye),It(Ye),D(!1),Ct(`Copied ${oe.length} items from ${Re(O)}`,"success")}catch(q){console.error("Error copying day:",q),Ct("Failed to copy day","error")}finally{Z(!1)}}},Me=w.useRef(null),Ke=w.useRef([]),ct=3,rt=5,Gt=async()=>{Se(!0);const O=document.querySelector("#barcode-reader");if(!O){Se(!1),Ct("Scanner container not found.","error");return}if(!Me.current)try{const oe=await Js(()=>import("./quagga.min-BbicSfvA.js").then(se=>se.q),[]);Me.current=oe.default}catch(oe){console.error("Failed to load barcode scanner:",oe),Se(!1),Ct("Could not load scanner.","error");return}const q=Me.current;q.init({inputStream:{type:"LiveStream",target:O,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},oe=>{if(oe){console.error("Quagga init error:",oe),Se(!1),Ct("Could not access camera. Check permissions.","error");return}q.start(),Ln.current=!0}),Ke.current=[],q.onDetected(oe=>{const se=oe.codeResult.decodedCodes?.filter(Ge=>Ge.error!==void 0)?.map(Ge=>Ge.error)||[];if((se.length>0?se.reduce((Ge,Fe)=>Ge+Fe,0)/se.length:1)<.15){const Ge=oe.codeResult.code,Fe=Ke.current;Fe.push(Ge),Fe.length>rt&&Fe.shift(),Fe.filter(At=>At===Ge).length>=ct&&(q.offDetected(),Ke.current=[],Ve(Ge))}})},fn=()=>{const O=Me.current;Ln.current&&O&&(O.stop(),O.offDetected(),Ln.current=!1),Se(!1)},Nt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,St=O=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((O||"").replace(/\s/g,"")),bn=O=>{if(!O)return{value:100,unit:"g"};const q=O.toLowerCase().replace(/\s/g,""),oe=q.match(/([\d.]+)/),se=oe?parseFloat(oe[1]):100;return St(O)?/cl/.test(q)?{value:se*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:se*1e3,unit:"ml"}:{value:se,unit:"ml"}:{value:se,unit:"g"}},Ss=O=>{if(St(O.serving_size)||St(O.quantity))return"ml";const q=O.product_name||O.product_name_en||"";return Nt.test(q)?"ml":"g"},si=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],wi=(O,q)=>{const oe=O||"",se=oe.match(/\((\d+\.?\d*)\s*g\)/i),Ye=oe.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(se&&Ye){const ot=parseFloat(se[1]);let At=Ye[1].replace(/^\d+\s*/,"").trim();if(At&&ot>0)return{label:At,weight:ot}}const Ge=oe.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ge){const ot=parseFloat(Ge[1]);let At=Ge[2].replace(/^\d+\s*/,"").trim();if(At&&ot>0)return{label:At,weight:ot}}const Fe=q||"";for(const{pattern:ot,label:At,weight:Cn}of si)if(ot.test(Fe))return{label:At,weight:Cn};return null},Or=O=>{const q=O.nutriments||{},oe=Ss(O),se=bn(O.serving_size),Ye=oe==="ml"?se.unit==="ml"?se.value:100:se.value,Ge=O.product_name||O.product_name_en||"Unknown Product",Fe=wi(O.serving_size,Ge);return{name:Ge,brand:O.brands||"",image:O.image_small_url||O.image_url||null,servingSize:O.serving_size||"100g",servingValue:Ye,servingUnit:oe,portion:Fe,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},js=async O=>{$t(!0);try{const q=new AbortController,oe=setTimeout(()=>q.abort(),1e4),se=`https://world.openfoodfacts.org/api/v2/product/${O}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ye=await fetch(se,{signal:q.signal});if(clearTimeout(oe),Ye.status===404){Ct("Product not found. Try search or manual entry.","error"),$t(!1);return}if(!Ye.ok)throw new Error(`HTTP ${Ye.status}`);const Ge=await Ye.json();if(Ge.status==="success"||Ge.status===1||Ge.product){const Fe=Or(Ge.product);Fe.calories===0&&Fe.protein===0&&Fe.carbs===0?Ct("Product found but no nutrition data available.","error"):(pt(Fe),Fe.portion?(gt(1),it(String(Fe.portion.weight)),Bt("portion")):(gt(0),it(String(Fe.servingValue||100)),Bt("weight")),Qe(""))}else Ct("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),q.name==="AbortError"?Ct("Lookup timed out. Check your connection and try again.","error"):Ct("Failed to look up product. Check your connection.","error")}$t(!1)},hr=(O,q,oe)=>{const se=O.toLowerCase().trim(),Ye=q.toLowerCase().trim(),Ge=oe.toLowerCase().trim();let Fe=0;return(se===Ge||se===Ge+"s"||se+"s"===Ge)&&(Fe+=100),(se.endsWith(" "+Ge)||se.endsWith(" "+Ge+"s"))&&(Fe+=40),(se.startsWith(Ge+" ")||se.startsWith(Ge+"s "))&&(Fe+=15),Ge.split(/\s+/).some(At=>Ye===At||Ye.startsWith(At))&&(Fe+=30),Fe+=Math.max(0,30-se.length),Fe},Gn=async()=>{if(!Rt.trim())return;Pn.current&&Pn.current.abort();const O=new AbortController;Pn.current=O;const q=Rt.trim().toLowerCase(),oe=q.split(/\s+/).filter(Boolean);if(Zg.has(q)){qt(Zg.get(q));return}pn(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Rt.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ge=await fetch(Ye,{signal:O.signal});if(!Ge.ok)throw new Error(`HTTP ${Ge.status}`);const ot=((await Ge.json()).products||[]).map(At=>Or(At)).filter(At=>At.name!=="Unknown Product"&&(At.calories>0||At.protein>0)).filter(At=>{const Cn=(At.name+" "+At.brand).toLowerCase();return oe.every(Cs=>Cn.includes(Cs))}).sort((At,Cn)=>hr(Cn.name,Cn.brand,q)-hr(At.name,At.brand,q)).slice(0,10);Zg.set(q,ot),qt(ot),ot.length===0&&Ct("No results found. Try a different search.","info")}catch(se){if(se.name==="AbortError")return;console.error("Search error:",se),Ct("Search failed. Check your connection.","error")}pn(!1)};w.useEffect(()=>{if(un.current&&clearTimeout(un.current),!(!Rt.trim()||V!=="search"||le))return un.current=setTimeout(()=>{Gn()},700),()=>clearTimeout(un.current)},[Rt]);const os=l,ls={"ring-protein":os?"#2dd4bf":"#14b8a6","ring-carbs":os?"#fbbf24":"#f59e0b","ring-fats":os?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Vn=80,wn=2*Math.PI*Vn,es=(O,q,oe,se,Ye)=>{const Ge=se>0?Math.min(100,Math.round(oe/se*100)):0,Fe=wn-Ge/100*wn,ot=ls[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Vn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Vn,style:{stroke:ot},strokeDasharray:wn,strokeDashoffset:Fe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:ot},children:Math.round(oe)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",se,O==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:ot},children:q})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:ot},children:[Ge,"%"]})]})};if(w.useEffect(()=>{if(!ke)return;const O=setTimeout(()=>{const q=ke;fn(),Ve(null),js(q)},1500);return()=>clearTimeout(O)},[ke]),w.useEffect(()=>()=>{const O=Me.current;if(Ln.current&&O){try{O.stop(),O.offDetected()}catch{}Ln.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:I.gender==="male"?"active":"",onClick:()=>{H(O=>({...O,gender:"male"})),B(null)},children:"Male"}),a.jsx("button",{className:I.gender==="female"?"active":"",onClick:()=>{H(O=>({...O,gender:"female"})),B(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:I.age,onChange:O=>{H(q=>({...q,age:O.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:I.weight,onChange:O=>{H(q=>({...q,weight:O.target.value})),B(null)},placeholder:I.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:I.weightUnit==="kg"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"kg"})),B(null)},children:"kg"}),a.jsx("button",{className:I.weightUnit==="lbs"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[I.heightUnit==="cm"?a.jsx("input",{type:"number",value:I.height,onChange:O=>{H(q=>({...q,height:O.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:I.heightFeet,onChange:O=>{H(q=>({...q,heightFeet:O.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:I.heightInches,onChange:O=>{H(q=>({...q,heightInches:O.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:I.heightUnit==="cm"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"cm"})),B(null)},children:"cm"}),a.jsx("button",{className:I.heightUnit==="ft"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:I.dailyActivity,onChange:O=>{H(q=>({...q,dailyActivity:O.target.value})),B(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:I.trainingFrequency,onChange:O=>{H(q=>({...q,trainingFrequency:O.target.value})),B(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:I.goal==="lose"?"active":"",onClick:()=>{H(O=>({...O,goal:"lose"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:I.goal==="maintain"?"active":"",onClick:()=>{H(O=>({...O,goal:"maintain"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:I.goal==="build"?"active":"",onClick:()=>{H(O=>({...O,goal:"build"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),I.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:I.deficitLevel==="light"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"light"})),B(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:I.deficitLevel==="moderate"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"moderate"})),B(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:I.deficitLevel==="harsh"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"harsh"})),B(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Be,disabled:!Dt(),children:"Calculate Macros"})]}),K&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[es("Protein","Protein",K.protein,K.protein,"ring-protein"),es("Carbs","Carbs",K.carbs,K.carbs,"ring-carbs"),es("Fats","Fats",K.fats,K.fats,"ring-fats"),es("Calories","Calories",K.calories,K.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[K.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[K.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",K.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[K.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Le,children:"Set as My Daily Targets"})]})]}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message})]});const _r=O=>{const q=new Date(O+"T12:00:00"),oe=q.getDay(),se=new Date(q);se.setDate(q.getDate()-(oe+6)%7);const Ye=[];for(let Ge=0;Ge<7;Ge++){const Fe=new Date(se);Fe.setDate(se.getDate()+Ge),Ye.push(Fe.toISOString().split("T")[0])}return Ye},Hs=["M","T","W","T","F","S","S"],Kn=(O,q="search")=>{qe(O),q==="scan"?(ce("scan"),pt(null)):q==="manual"?(ce("manual"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?ce("favourites"):(ce("search"),qt([]),Sn(""))},kr=_r(Y),ts=new Date(Y+"T12:00:00"),Vr=`${Ie[ts.getMonth()]} ${ts.getFullYear()}`;return a.jsx(nl,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()-7);const q=O.toISOString().split("T")[0];te(q)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{E(!M),U({year:ts.getFullYear(),month:ts.getMonth()})},children:Vr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()+7);const q=O.toISOString().split("T")[0];q<=Yr()&&te(q)},"aria-label":"Next week",disabled:kr[6]>=Yr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:kr.map((O,q)=>{const oe=new Date(O+"T12:00:00").getDate(),se=O===Y,Ye=O>Yr(),Ge=O===Yr();return a.jsxs("button",{className:`nut-week-day${se?" selected":""}${Ge?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>te(O),children:[a.jsx("span",{className:"nut-week-day-letter",children:Hs[q]}),a.jsx("span",{className:"nut-week-day-num",children:oe})]},O)})})]}),M&&a.jsxs("div",{className:"nut-calendar",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>U(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[L.month]," ",L.year]}),a.jsx("button",{onClick:()=>U(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ne(L.year,L.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(L.year,L.month))].map((O,q)=>{const oe=q+1,se=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=se>Yr(),Ge=se===Y,Fe=se===Yr();return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${Fe?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{te(se),E(!1)},children:oe},oe)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[es("Protein","Protein",we.protein,p.protein,"ring-protein"),es("Carbs","Carbs",we.carbs,p.carbs,"ring-carbs"),es("Fats","Fats",we.fats,p.fats,"ring-fats"),es("Calories","kCal",we.calories,p.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[ee&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{D(!0),Pe({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:$w.map(O=>{const q=Q.entries.filter(se=>(se.meal||"snacks")===O.key),oe=q.reduce((se,Ye)=>({protein:se.protein+(Ye.protein||0),carbs:se.carbs+(Ye.carbs||0),fats:se.fats+(Ye.fats||0),calories:se.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${O.key}`,children:A3[O.key]}),a.jsx("span",{className:"nut-meal-card-title",children:O.label}),q.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[oe.calories," cal"]}),ee&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>We(Ne===O.key?null:O.key),"aria-label":`Add to ${O.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,p.protein>0?oe.protein/p.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,p.carbs>0?oe.carbs/p.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,p.fats>0?oe.fats/p.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,p.calories>0?oe.calories/p.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:oe.calories})]})]}),q.length>0&&a.jsx("div",{className:"nut-log-list",children:q.map(se=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${dn(se.name)?" active":""}`,onClick:()=>hn(se),"aria-label":dn(se.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:dn(se.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:se.name}),se.serving&&a.jsx("span",{className:"nut-log-item-serving",children:se.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[se.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[se.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[se.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:se.calories})]}),ee&&a.jsx("button",{className:"nut-log-delete",onClick:()=>ms(se.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},se.id))}),q.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:ee?"Tap + to add food":"No entries"})})]},O.key)})})})]})}),Ne&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>We(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",$w.find(O=>O.key===Ne)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const O=Ne;We(null),Kn(O,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;We(null),Kn(O,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;We(null),Kn(O,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;We(null),Kn(O,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),P&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Pe(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[A.month]," ",A.year]}),a.jsx("button",{onClick:()=>Pe(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:A.year===new Date().getFullYear()&&A.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ne(A.year,A.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(A.year,A.month))].map((O,q)=>{const oe=q+1,se=`${A.year}-${String(A.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=se>Yr(),Ge=se===Y,Fe=se===Yr(),ot=Ye||Ge;return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${Fe?" today":""}${Ye?" future":""}`,disabled:ot,onClick:()=>ue(se),children:oe},oe)})]}),st&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{fn(),Ve(null),ce(null),pt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:V==="scan"?"Scan Barcode":V==="search"?"Search Food":V==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{fn(),Ve(null),ce(null),pt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),V==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),je&&!ke&&a.jsx("div",{className:"nut-scan-line"}),ke&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ke})]})]}),!je&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Gt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),je&&!ke&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:He,onChange:O=>Qe(O.target.value),onKeyDown:O=>O.key==="Enter"&&He.trim()&&js(He.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>He.trim()&&js(He.trim()),disabled:!He.trim()||Je,children:Je?"...":"Look Up"})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="scan"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=wt==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,se=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=wt==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>it(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>it(String(Fe)),children:[Fe,O]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{pt(null),ce("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:Ge}),children:"Add"})]})]})})(),V==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Wt,value:Rt,onChange:O=>Sn(O.target.value),onKeyDown:O=>{O.key==="Enter"&&(clearTimeout(un.current),Gn())},onFocus:()=>setTimeout(()=>Wt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Gn,disabled:Et,children:Et?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[ln.map((O,q)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{pt(O),O.portion?(gt(1),it(String(O.portion.weight)),Bt("portion")):(gt(0),it(String(O.servingValue||100)),Bt("weight"))},children:[O.image&&a.jsx("img",{src:O.image,alt:O.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:O.name}),O.brand&&a.jsx("span",{className:"nut-search-item-brand",children:O.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[O.calories," cal  ",O.protein,"p  ",O.carbs,"c  ",O.fats,"f per 100",O.servingUnit||"g"]})]})]},q)),ln.length===0&&Rt&&!Et&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="search"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=wt==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,se=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=wt==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>it(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>it(String(Fe)),children:[Fe,O]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:Ge}),children:"Add"})]})]})})(),V==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Tt.name,onChange:O=>ut(q=>({...q,name:O.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Tt.serving,onChange:O=>ut(q=>({...q,serving:O.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Tt.protein,onChange:O=>ut(q=>({...q,protein:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Tt.carbs,onChange:O=>ut(q=>({...q,carbs:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Tt.fats,onChange:O=>ut(q=>({...q,fats:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Tt.calories,onChange:O=>ut(q=>({...q,calories:O.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Tt.name.trim(),onClick:()=>On({name:Tt.name,protein:parseFloat(Tt.protein)||0,carbs:parseFloat(Tt.carbs)||0,fats:parseFloat(Tt.fats)||0,calories:parseFloat(Tt.calories)||0,serving:Tt.serving||""}),children:"Add Food"})]}),V==="favourites"&&!le&&(()=>{const O=lt(),q=oe=>{if(oe.per100g){const se=oe.per100g;pt({name:oe.name,brand:"",image:null,servingSize:oe.serving||"100g",servingValue:100,servingUnit:oe.servingUnit||"g",portion:oe.portion||null,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,per100g:!0}),oe.portion?(gt(1),it(String(oe.portion.weight)),Bt("portion")):(gt(0),it("100"),Bt("weight"))}else On({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:O.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:O.map((oe,se)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),hn(oe)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>q(oe),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:oe.name}),a.jsx("span",{className:"nut-recent-item-serving",children:oe.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[oe.calories," cal"]})]})]},se))})})})(),V==="favourites"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=wt==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,se=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=wt==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>it(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>it(String(Fe)),children:[Fe,O]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:Ge}),children:"Add"})]})]})})()]})}),a.jsx(ni,{active:"nutrition"}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message}),a.jsx(Wl,{badge:k,onDismiss:()=>T(null)})]})})}async function D3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,g=1080,y=1920,p=document.createElement("canvas");p.width=g,p.height=y;const b=p.getContext("2d"),k="#2a2a28",T="#ffffff",I="#A12F3A",H="#1a1a1a",K="#555555";b.fillStyle=k,b.fillRect(0,0,g,y);const B=Math.round(g*.82),Y=Math.round(y*.75),te=Math.round((g-B)/2),Q=Math.round((y-Y)/2),pe=28,we=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Ww(b,te,Q,B,Y,pe),b.fillStyle=T,b.fill(),b.restore(),b.save(),Ww(b,te,Q,B,Y,pe),b.strokeStyle=I,b.lineWidth=we,b.stroke(),b.restore();const ye=220,M=50,E=52,L=68,U=10,P=36,D=48,A=30,Pe=34,st=46,Z=30,Te=28;b.font=`bold ${E}px 'Orbitron', sans-serif`;const qe=tu(b,t.toUpperCase(),B-100);b.font=`500 ${P}px 'Montserrat', sans-serif`;let Ne=[];e==="badge"&&d?Ne=tu(b,d,B-120):e==="badge"&&l.length>0?Ne=tu(b,l.join("    "),B-120):i.length>0&&(Ne=tu(b,i.map(Et=>`${Et.value} ${Et.label}`).join("    "),B-120));const We=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Pe}px 'Montserrat', sans-serif`;const V=tu(b,We,B-80);let ce=qe.length*L;Ne.length>0&&(ce+=U+Ne.length*D),ce+=A+V.length*st,ce+=Z+Te;const Se=Q+Y-60-ce,Ve=Q+40,He=Se-M,Qe=g/2,Je=(Ve+He)/2,$t=e==="badge"&&u?u:"/Logo.webp";b.save();const Rt=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Sn=b.createRadialGradient(Qe,Je,ye*.6,Qe,Je,ye*1.5);Sn.addColorStop(0,Rt),Sn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Sn,b.fillRect(Qe-ye*1.5,Je-ye*1.5,ye*3,ye*3),b.restore(),b.beginPath(),b.arc(Qe,Je,ye+6,0,Math.PI*2),b.fillStyle=T,b.fill();const ln=e==="badge"?"#ffc107":I;b.beginPath(),b.arc(Qe,Je,ye,0,Math.PI*2),b.strokeStyle=ln,b.lineWidth=5,b.stroke();try{const Et=await M3($t);b.save(),b.beginPath(),b.arc(Qe,Je,ye-6,0,Math.PI*2),b.clip();const pn=(ye-6)*2;b.drawImage(Et,Qe-ye+6,Je-ye+6,pn,pn),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=I,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Qe,Je)}let qt=Se;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${E}px 'Orbitron', sans-serif`;for(const Et of qe)b.fillText(Et,g/2,qt),qt+=L;if(Ne.length>0){qt+=U,b.fillStyle=K,b.font=`500 ${P}px 'Montserrat', sans-serif`;for(const Et of Ne)b.fillText(Et,g/2,qt),qt+=D}qt+=A,b.fillStyle=H,b.font=`bold ${Pe}px 'Montserrat', sans-serif`;for(const Et of V)b.fillText(Et,g/2,qt),qt+=st;return qt+=Z,b.fillStyle=I,b.font=`600 ${Te}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",g/2,qt),new Promise(Et=>{p.toBlob(pn=>Et(pn),"image/png")})}function Ww(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function M3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function tu(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const g=u?`${u} ${d}`:d;s.measureText(g).width>t&&u?(l.push(u),u=d):u=g}return u&&l.push(u),l}function L3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=50,p.gain.value=.3,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2);const b=u.createOscillator(),k=u.createGain();b.type="sine",b.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),b.connect(k).connect(g),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=55,p.gain.value=.35,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,g)=>{const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=g===0?523:784,p.gain.value=.12,p.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),y.connect(p).connect(u.destination),y.start(u.currentTime+d),y.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const P3=2e3,$p=42,Ll=2*Math.PI*$p,O3=1200,Gw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Wp({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:g="Done",holdLabel:y="Hold To Complete Session",shareType:p="workout",hideShare:b=!1}){const[k,T]=w.useState("hold"),[I,H]=w.useState(!1),[K,B]=w.useState(0),[Y,te]=w.useState(!1),[Q,pe]=w.useState(!1),[we,ye]=w.useState(null),M=L3(),E=w.useRef(null),L=w.useRef(null),U=w.useRef(null),P=w.useRef(null),D=w.useRef(!1),A=w.useRef(!1),Pe=w.useRef(0),st=w.useRef(Gw[Math.floor(Math.random()*Gw.length)]),Z=w.useRef([...Array(80)].map((ke,Ve)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ve%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ve%3}))),Te=w.useCallback(()=>{if(D.current)return;D.current=!0,A.current=!1,Pe.current=0,H(!0),B(0),P.current=performance.now(),M.tap(),E.current&&(E.current.style.strokeDashoffset=Ll);const ke=Ve=>{const He=Ve-P.current,Qe=Math.min(He/P3,1);if(E.current&&(E.current.style.strokeDashoffset=Ll-Qe*Ll),L.current){const Je=8*(1-Qe),$t=1-Qe,Rt=1+Qe*.15;L.current.style.filter=`blur(${Je}px) grayscale(${$t})`,L.current.style.transform=`scale(${Rt})`}B(Qe),He-Pe.current>=O3&&(Pe.current=He,M.tick()),Qe<1?U.current=requestAnimationFrame(ke):(D.current=!1,A.current=!0,U.current=null,H(!1),B(1),M.complete(),T("celebrate"))};U.current=requestAnimationFrame(ke)},[M]),qe=w.useCallback(()=>{D.current&&(D.current=!1,U.current&&(cancelAnimationFrame(U.current),U.current=null),E.current&&(E.current.style.strokeDashoffset=Ll),L.current&&(L.current.style.filter="",L.current.style.transform=""),H(!1),B(0))},[]),Ne=w.useCallback(()=>{te(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),We=w.useCallback(()=>{const ke=[s||"Workout Complete!"];return e&&ke.push(e),t?.length&&ke.push(t.map(Ve=>`${Ve.value} ${Ve.label}`).join(" | ")),ke.push("#MindCoreFitness"),ke.join(`
`)},[s,e,t]),V=w.useCallback(async()=>{if(!(Q||!u))try{await u({type:p==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current}),pe(!0),ye("Posted to Journey!"),setTimeout(()=>ye(null),2500)}catch(ke){console.error("Journey post failed:",ke),ye(ke?.message||"Failed to post"),setTimeout(()=>ye(null),3500)}},[Q,u,s,e,t]),[ce,je]=w.useState(!1),Se=w.useCallback(async()=>{je(!0);try{const ke=await D3({type:p||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current,userName:d}),Ve=We();if(navigator.share&&navigator.canShare?.({files:[new File([ke],"workout.png",{type:"image/png"})]})){const He=new File([ke],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ve,files:[He]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ve}):(await navigator.clipboard.writeText(Ve),ye("Copied to clipboard!"),setTimeout(()=>ye(null),2500))}catch{try{await navigator.clipboard.writeText(We()),ye("Copied to clipboard!"),setTimeout(()=>ye(null),2500)}catch{}}finally{je(!1)}},[s,e,t,d,We]);return k==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${I?"wc-holding":""}`,onPointerDown:ke=>{ke.preventDefault(),Te()},onPointerUp:qe,onPointerLeave:qe,onPointerCancel:qe,onClick:ke=>{ke.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ke=>{(ke.key==="Enter"||ke.key===" ")&&(ke.preventDefault(),M.complete(),T("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:$p}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:E,cx:"50",cy:"50",r:$p,style:{strokeDasharray:Ll,strokeDashoffset:Ll}})]}),a.jsx("img",{ref:L,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${Y?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:Z.current.map((ke,Ve)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ke.shape}`,style:{"--x":`${ke.x}%`,"--delay":`${ke.delay}s`,"--color":ke.color,"--drift":`${ke.drift}px`,"--spin":`${ke.spin}deg`,"--duration":`${ke.duration}s`,width:`${ke.width}px`,height:`${ke.height}px`}},Ve))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:st.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ke,Ve)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:ke.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:ke.label})]},Ve))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${Q?"wc-share-done":""}`,onClick:V,disabled:Q,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Q?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Se,disabled:ce,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ce?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Ne,children:g}),we&&a.jsx("div",{className:"wc-share-toast",children:we})]})]})}const Kw="/login/assets/randomiser-glq9YJkL.jpg",Yw="/login/assets/programme-card-workout-CnNzTYkz.webp",V3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",U3="/login/assets/muscle-group-arms-C9AdZL4-.png",B3="/login/assets/arms-bicep-BUrmT1o-.png",z3="/login/assets/arms-tricep-D9tAnFnS.png",F3="/login/assets/arms-full-arms-BY3TvpJm.png",H3="/login/assets/muscle-group-chest-Cxfuc7XI.png",q3="/login/assets/chest-strength-BR4BAFTH.png",$3="/login/assets/chest-hypertrophy-B8yNrvjB.png",W3="/login/assets/chest-endurance-e-OSWtWO.png",G3="/login/assets/muscle-group-shoulders-DibNtCLF.png",K3="/login/assets/shoulders-strength-CKlZBF5A.png",Y3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",Q3="/login/assets/shoulders-endurance-HuqNG5rD.png",X3="/login/assets/muscle-group-core-CPR-bdRg.png",J3="/login/assets/core-lower-abs-TVcqGMFJ.png",Z3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e5="/login/assets/core-weighted-core-4Kwh9mTv.png",t5="/login/assets/muscle-group-back-8JPV-YUo.png",n5="/login/assets/back-strength-BmSRxnwo.png",s5="/login/assets/back-hypertrophy-CXHmsnCz.png",r5="/login/assets/back-endurance-C8qJ8l5I.png",i5="/login/assets/muscle-group-legs-B8jcbdov.png",a5="/login/assets/legs-quads-DbnfsebI.png",o5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l5="/login/assets/legs-power-plyo-D2qBXeUR.png",c5=60,ep=5,u5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},d5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},tp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},np=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:V3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],nu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:U3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:H3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:G3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:i5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:X3}],Qw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:q3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:W3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:n5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:s5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:K3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:Y3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:Q3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:B3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:z3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:F3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:a5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:J3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:Z3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},sp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Qr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ni=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],rp=[5,10,15,20,30],h5=new Set(["single leg v-up","hollow hold to v-sit","reverse crunch to leg raise","side plank rotation","hip dips plank","alternating cross body v-up","alternating cross body v up","bent hollow hold","heels elevated glute bridge","hollow body hold","hollow body rock","star side plank","straddle leg lift","leg raise to hip lift","scorpion kicks","seated v hold"]),gh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Xw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function f5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function m5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function g5({src:s,...e}){const t=w.useRef(null),[i,l]=w.useState(!1);return w.useEffect(()=>{const u=t.current;if(!u)return;const d=new IntersectionObserver(([g])=>{g.isIntersecting&&(l(!0),d.disconnect())},{rootMargin:"200px"});return d.observe(u),()=>d.disconnect()},[]),a.jsx("video",{ref:t,src:i?s:void 0,...e})}function p5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=Ui(),{isPremium:d,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=uc(),p=Zs(),[b,k]=w.useState("randomiser_hub"),[T,I]=w.useState(["bodyweight"]),[H,K]=w.useState("core"),[B,Y]=w.useState("intermediate"),[te,Q]=w.useState(d?15:5),[pe,we]=w.useState([]),[ye,M]=w.useState(!1),E=w.useRef(!1),L=w.useRef([]),U=w.useRef(""),[P,D]=w.useState([]),[A,Pe]=w.useState(2),[st,Z]=w.useState(Ni[1]),[Te,qe]=w.useState(1),[Ne,We]=w.useState(0),[V,ce]=w.useState("work"),[je,Se]=w.useState(0),[ke,Ve]=w.useState(!1),[He,Qe]=w.useState(0),[Je,$t]=w.useState(!1),[Rt,Sn]=w.useState(!1),[ln,qt]=w.useState(null),Et=w.useRef(null);w.useRef(null),w.useRef(null);const[pn,Tt]=w.useState(null),ut=w.useCallback((R,F="info")=>{Tt({message:R,type:F}),setTimeout(()=>Tt(null),3e3)},[]),le=w.useCallback(async R=>{if(!t)throw new Error("Not signed in");const F=R&&typeof R=="object"&&R.type;await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:F?"":R,type:F?R.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...F?{metadata:{title:R.title||"",subtitle:R.subtitle||"",stats:R.stats||[],quote:R.quote||"",badges:R.badges||[]}}:{}})},[t]),[pt,Ht]=w.useState(null),[it,yt]=w.useState(null),[gt,wt]=w.useState(0),[Bt,fs]=w.useState(0),[sn,Zn]=w.useState([]),[Fn,Ln]=w.useState(""),[Pn,un]=w.useState(""),[Wt,Ct]=w.useState(!1),[It,ee]=w.useState(0),[C,ne]=w.useState(!1),[Re,Ie]=w.useState({}),De=w.useRef(null),Be=w.useRef(null),[Le,Dt]=w.useState(0),[xt,lt]=w.useState(0),[dn,hn]=w.useState(0),[On,ms]=w.useState(0),[ue,Me]=w.useState(0),[Ke,ct]=w.useState(0),[rt,Gt]=w.useState(null),[fn,Nt]=w.useState({beginner:0,intermediate:0,advanced:0}),St=d?rp:rp.filter(R=>g.includes(R)),bn=!d&&Le>=y,[Ss,si]=w.useState([]),[wi,Or]=w.useState(!1),[js,hr]=w.useState({}),[Gn,os]=w.useState(!1),[ls,Vn]=w.useState(!1),[wn,es]=w.useState(""),[_r,Hs]=w.useState(null),[Kn,kr]=w.useState([]),[ts,Vr]=w.useState({total:0,favouriteFocus:null,streak:0}),[O,q]=w.useState(null),[oe,se]=w.useState(""),[Ye,Ge]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=dt(ge,"workoutLogs"),$=on(F,Ut("clientId","==",t.id)),fe=(await Qt($)).docs.map(mt=>mt.data()),ve=fe.filter(mt=>mt.type!=="programme");ms(ve.length);const Oe=ve.reduce((mt,gn)=>mt+(gn.duration||0),0);Me(Oe);const tt={beginner:0,intermediate:0,advanced:0};ve.forEach(mt=>{mt.level&&tt[mt.level]!==void 0&&tt[mt.level]++}),Nt(tt);const nt=new Date,vt=nt.getDay(),_t=vt===0?-6:1-vt,Xt=new Date(nt);Xt.setDate(nt.getDate()+_t),Xt.setHours(0,0,0,0);const Hn=Xt.getTime(),et=fe.filter(mt=>{const gn=mt.completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=Hn:!1});Dt(et.filter(mt=>mt.type!=="programme").length);let mn=0;if(t)try{const mt=await _s(ze(ge,"clientProgrammes",t.id));if(mt.exists()){const gn=mt.data(),Qn=gn.templateId;mn=et.filter(As=>As.type==="programme"&&As.programmeId===Qn).length,q(Qn);const tr=np.find(As=>As.id===Qn);tr&&se(tr.name);const Ws=u5[Qn];if(Ws){const As=Object.keys(gn.completedSessions||{}).length,nr=Ws.duration*Ws.daysPerWeek;hn(nr>0?Math.round(As/nr*100):0)}}else q(null),se(""),hn(0)}catch{}lt(mn);const rn=ve.map(mt=>mt.completedAt).filter(Boolean).map(mt=>mt.toDate?mt.toDate().getTime():new Date(mt).getTime()).sort((mt,gn)=>gn-mt);if(rn.length===0)ct(0);else{const mt=new Set;rn.forEach(nr=>{const Tr=new Date(nr),po=Tr.getDay(),sl=po===0?-6:1-po,ai=new Date(Tr);ai.setDate(Tr.getDate()+sl),ai.setHours(0,0,0,0),mt.add(ai.getTime())});const gn=[...mt].sort((nr,Tr)=>Tr-nr);let Qn=0;const tr=new Date(nt),Ws=nt.getDay()===0?-6:1-nt.getDay();tr.setDate(nt.getDate()+Ws),tr.setHours(0,0,0,0);let As=tr.getTime();gn.includes(As)||(As-=10080*60*1e3);for(let nr=0;nr<200&&gn.includes(As);nr++)Qn++,As-=10080*60*1e3;ct(Qn)}}catch(F){console.error("Error loading workout stats:",F)}finally{Ge(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=on(dt(ge,"savedWorkouts"),Ut("clientId","==",t.id)),G=(await Qt(F)).docs.map(fe=>({id:fe.id,...fe.data()}));G.sort((fe,ve)=>{const Oe=fe.savedAt?.toMillis?.()||fe.savedAt?.seconds*1e3||0;return(ve.savedAt?.toMillis?.()||ve.savedAt?.seconds*1e3||0)-Oe}),si(G)}catch(F){console.error("Error loading saved workouts:",F)}finally{Or(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=on(dt(ge,"workoutLogs"),Ut("clientId","==",t.id)),fe=(await Qt(F)).docs.map(et=>et.data()).sort((et,mn)=>{const rn=et.completedAt?.toDate?.()||new Date(0);return(mn.completedAt?.toDate?.()||new Date(0))-rn}).slice(0,20).filter(et=>et.type!=="programme"&&et.type!=="muscle_group");kr(fe.slice(0,3));const ve=fe.length,Oe={};fe.forEach(et=>{et.focus&&(Oe[et.focus]=(Oe[et.focus]||0)+1)});const tt=Object.keys(Oe).sort((et,mn)=>Oe[mn]-Oe[et])[0]||null;let nt=0;if(fe.length>0){const et=new Set;fe.forEach(mt=>{const gn=mt.completedAt?.toDate?mt.completedAt.toDate():mt.completedAt?new Date(mt.completedAt):null;gn&&et.add(new Date(gn.getFullYear(),gn.getMonth(),gn.getDate()).toDateString())});const mn=new Date;mn.setHours(0,0,0,0);let rn=new Date(mn);for(et.has(rn.toDateString())||rn.setDate(rn.getDate()-1);et.has(rn.toDateString());)nt++,rn.setDate(rn.getDate()-1)}Vr({total:ve,favouriteFocus:tt,streak:nt});const vt={core:null,upper:null,lower:null,fullbody:null};fe.forEach(et=>{if(et.focus&&vt[et.focus]===null&&et.completedAt){const mn=et.completedAt.toDate?et.completedAt.toDate():new Date(et.completedAt);vt[et.focus]=mn}});let _t=null,Xt=new Date;const Hn=["core","upper","lower","fullbody"];for(const et of Hn){if(vt[et]===null){const mn=Qr.find(rn=>rn.key===et)?.label||et;_t={focus:et,label:mn,daysAgo:null,message:`You haven't tried ${mn} yet`};break}if(vt[et]<Xt){Xt=vt[et];const mn=Math.floor((Date.now()-vt[et].getTime())/864e5);if(mn>=5){const rn=Qr.find(mt=>mt.key===et)?.label||et;_t={focus:et,label:rn,daysAgo:mn,message:`${rn}  ${mn} days ago`}}}}Hs(_t)}catch(F){console.error("Error loading recent workouts:",F)}})()},[s,t,b]);const Fe=async R=>{if(!(!s||!t||P.length===0)){os(!0);try{const F=Qr.find(fe=>fe.key===H)?.label||H,$=R||`${F} ${te}min`,G=await or(dt(ge,"savedWorkouts"),{clientId:t.id,name:$,equipment:T,focus:H,level:B,duration:te,exercises:P.map(fe=>({name:fe.name,videoUrl:fe.videoUrl,isGif:fe.isGif||!1})),rounds:A,savedAt:Ft.now()});si(fe=>[{id:G.id,clientId:t.id,name:$,equipment:T,focus:H,level:B,duration:te,exercises:P.map(ve=>({name:ve.name,videoUrl:ve.videoUrl,isGif:ve.isGif||!1})),rounds:A,savedAt:Ft.now()},...fe]),ut("Workout saved!","success")}catch(F){console.error("Error saving workout:",F),ut("Failed to save workout","error")}finally{os(!1),Vn(!1),es("")}}},ot=async R=>{try{await ar(ze(ge,"savedWorkouts",R)),si(F=>F.filter($=>$.id!==R)),ut("Workout removed","info")}catch(F){console.error("Error deleting saved workout:",F),ut("Failed to remove workout","error")}},At=R=>{I(R.equipment||["bodyweight"]),K(R.focus||"core"),Y(R.level||"intermediate"),Q(R.duration||15);const F=Ni.find($=>$.key===(R.level||"intermediate"));Z(F),D(R.exercises||[]),Pe(R.rounds||2),k("preview")},Cn=async()=>{const R=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");I(R?.equipment||["bodyweight"]),K(R?.focus||"core"),Y(R?.level||"intermediate"),Q(R?.duration||15),setTimeout(()=>xi(),50)},Cs=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:T,focus:H,level:B,duration:te}))};localStorage.getItem("mcf_last_randomiser");const Yn=()=>{const R=[];let F;H==="mix"?F=["core","upper","lower"]:H==="fullbody"?F=["upper","lower"]:F=[H];for(const $ of T)for(const G of F)R.push(`exercises/${$}/${G}`);return R},Ds="mcf_exercise_urls",ri=()=>{try{return JSON.parse(sessionStorage.getItem(Ds)||"{}")}catch{return{}}},Ms=R=>{try{sessionStorage.setItem(Ds,JSON.stringify(R))}catch{}},er=async()=>{if(E.current){for(;E.current;)await new Promise(F=>setTimeout(F,200));return L.current}const R=Yn().sort().join("|");if(L.current.length>0&&U.current===R)return L.current;E.current=!0,M(!0);try{const F=Yn(),$=[];for(const tt of F)try{const nt=ca(ua,tt),vt=await Fw(nt);$.push(...vt.items)}catch{console.warn(`Folder ${tt} not found, skipping.`)}if($.length===0&&T.includes("bodyweight")&&H==="core")try{const tt=ca(ua,"core"),nt=await Fw(tt);$.push(...nt.items)}catch{console.warn("Legacy core/ folder not found either.")}if($.length===0){const tt=T.map(vt=>sp.find(_t=>_t.key===vt)?.label).join(" + "),nt=Qr.find(vt=>vt.key===H)?.label;return ut(`No exercises found for ${tt} / ${nt}. Upload videos to Firebase Storage.`,"error"),E.current=!1,M(!1),[]}const G=new Set,fe=$.filter(tt=>{const nt=tt.name.replace(/\.(mp4|gif)$/i,"");return G.has(nt)?!1:(G.add(nt),!0)}),ve=ri(),Oe=await Promise.all(fe.map(async tt=>{const nt=tt.fullPath;let vt=ve[nt];vt||(vt=await ro(tt),ve[nt]=vt);const _t=f5(tt.name.replace(/\.(mp4|gif)$/i,"")),Xt=/\.gif$/i.test(tt.name);return{name:_t,videoUrl:vt,isGif:Xt}}));return Ms(ve),L.current=Oe,U.current=R,we(Oe),E.current=!1,M(!1),Oe}catch(F){console.error("Error loading exercises:",F);const $=F.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${F.message||F.code||"Unknown error"}`;return ut($,"error"),E.current=!1,M(!1),[]}},xi=async()=>{if(bn)return;Cs(),k("spinning");const R=await er();if(R.length===0){k("setup");return}const F=Ni.find(_t=>_t.key===B);Z(F);const $=F.work+F.rest,G=te*60,fe=Math.floor(G/$);let ve,Oe;fe<=6?(ve=Math.max(3,Math.floor(fe/2)),Oe=Math.floor(fe/ve)):fe<=12?(ve=Math.min(6,Math.floor(fe/2)),Oe=Math.floor(fe/ve)):(ve=Math.min(10,Math.floor(fe/2)),Oe=Math.floor(fe/ve)),Oe=Math.max(2,Oe);const tt=B==="beginner"?R.filter(_t=>!h5.has(_t.name.toLowerCase())):R,nt=m5(tt),vt=nt.slice(0,Math.min(ve,nt.length));D(vt),Pe(Oe),setTimeout(()=>k("preview"),2e3)},jr=()=>{k("countdown"),Qe(3)};w.useEffect(()=>{if(b!=="countdown")return;if(He<=0){k("workout"),qe(1),We(0),ce("work"),Se(st.work),Ve(!1),Ls();return}$s();const R=setTimeout(()=>Qe(F=>F-1),1e3);return()=>clearTimeout(R)},[He,b]),w.useEffect(()=>{if(b!=="workout"||ke)return;if(je<=0){Ns();return}je<=3&&$s();const R=setTimeout(()=>Se(F=>F-1),1e3);return()=>clearTimeout(R)},[je,b,ke]);const Ns=()=>{if(V==="work")ce("rest"),Se(st.rest);else{const R=Ne+1;if(R>=P.length){const F=Te+1;if(F>A){$t(!0),ja();return}qe(F),We(0)}else We(R);ce("work"),Se(st.work),Ls()}},ja=async()=>{if(s)try{await or(dt(ge,"workoutLogs"),{clientId:t.id,level:B,duration:te,equipment:T,focus:H,exerciseCount:P.length,rounds:A,exercises:P.map(G=>G.name),completedAt:Ft.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:te,level:B,focus_area:H,exercise_count:P.length}),Dt(G=>G+1);const R=On+1;ms(R),Me(G=>G+te),Nt(G=>({...G,[B]:(G[B]||0)+1}));let F=null;const $=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const G of $)if(R>=G.count){const fe=await Jh(G.id,t);if(fe){F=fe;break}}if(!F){const G=Ke+(Le===0?1:0),fe=[{weeks:8,id:"streak_8"},{weeks:4,id:"streak_4"},{weeks:2,id:"streak_2"}];for(const ve of fe)if(G>=ve.weeks){const Oe=await Jh(ve.id,t);if(Oe){F=Oe;break}}}F&&Gt(F)}catch(R){console.error("Error saving workout log:",R)}},Bi=async(R,F,$)=>{if(!(!t||!F))try{const G=t.id,fe=await _s(ze(ge,"coreBuddyPBs",G)),Oe=(fe.exists()?fe.data():null)?.exercises||{},tt=Oe[R];let nt=!1;if(tt?(F>(tt.weight||0)||F===(tt.weight||0)&&$>(tt.reps||0))&&(nt=!0):nt=!0,nt){const vt={...Oe,[R]:{weight:F,reps:$,achievedAt:Ft.now()}};await Xn(ze(ge,"coreBuddyPBs",G),{clientId:t.id,exercises:vt,updatedAt:Ft.now()}),ut(`New PB! ${F}kg  ${$} reps`,"success"),$s()}}catch(G){console.error("Error checking PB:",G)}},ii=async R=>{if(yt(R),R.interval){const G=[];for(const fe of R.exercises){let ve=null,Oe=!1;if(fe.storagePath)try{const tt=ca(ua,fe.storagePath);ve=await ro(tt),Oe=/\.gif$/i.test(fe.storagePath)}catch{}G.push({name:fe.name,videoUrl:ve,isGif:Oe})}D(G),Pe(R.rounds),Z({work:R.work,rest:R.rest}),k("preview");return}const F={};for(const G of R.exercises)if(G.storagePath)try{const fe=ca(ua,G.storagePath);F[G.name]={url:await ro(fe),isGif:/\.gif$/i.test(G.storagePath)}}catch{}Ie(F);const $=R.exercises.map(G=>({name:G.name,type:G.type,targetSets:G.sets,targetReps:G.reps||0,targetTime:G.time||0,sets:[]}));Zn($),wt(0),fs(0),Ln(""),un(""),ne(!1),Ct(!1),ee(0),setMgSessionBadges([]),setMgBadgeCelebration(null),k("muscle_workout")},_i=()=>{const R=De.current;R&&(R.paused?(R.play(),ne(!0)):(R.pause(),ne(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!Wt||It<=0){b==="muscle_workout"&&Wt&&It<=0&&(Ct(!1),$s());return}return Be.current=setTimeout(()=>ee(R=>R-1),1e3),()=>clearTimeout(Be.current)},[b,Wt,It]);const zi=async()=>{const R=sn[gt];let F={};if(R.type==="weighted"){const fe=parseFloat(Fn)||0,ve=parseInt(Pn)||0;if(ve===0){ut("Enter your reps","error");return}F={weight:fe,reps:ve}}else if(R.type==="reps"){const fe=parseInt(Pn)||0;if(fe===0){ut("Enter your reps","error");return}F={reps:fe}}else if(R.type==="timed"){const fe=R.targetTime-It;F={time:Math.max(fe,1)}}const $=[...sn];$[gt]={...R,sets:[...R.sets,F]},Zn($),R.type==="weighted"&&F.weight>0&&await Bi(R.name,F.weight,F.reps);const G=R.sets.length+1;if(G<R.targetSets)fs(G),un(""),Ct(!1),ee(0);else if(gt+1<sn.length){const fe=gt+1;wt(fe),fs(0),Ln(""),un(""),ne(!1),Ct(!1),ee(0)}else await Ur($),Sn(!0)},Ur=async R=>{if(!(!s||!t))try{const F=R.reduce(($,G)=>$+G.sets.length,0);await or(dt(ge,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:pt,sessionId:it?.id,sessionName:it?.name,exerciseCount:R.length,totalSets:F,duration:Math.round(F*1.5),exercises:R.map($=>({name:$.name,type:$.type,sets:$.sets})),completedAt:Ft.now()})}catch(F){console.error("Error saving muscle group workout log:",F)}},Er=w.useRef(null),qs=()=>{(!Er.current||Er.current.state==="closed")&&(Er.current=new(window.AudioContext||window.webkitAudioContext));const R=Er.current;return R.state==="suspended"&&R.resume(),R},$s=()=>{try{const R=qs(),F=R.createOscillator(),$=R.createGain();F.connect($),$.connect(R.destination),F.frequency.value=880,$.gain.value=.3,F.start(R.currentTime),F.stop(R.currentTime+.15)}catch{}},Ls=()=>{try{const R=qs(),F=R.createOscillator(),$=R.createGain();F.connect($),$.connect(R.destination),F.frequency.value=1200,$.gain.value=.4,F.start(R.currentTime),F.stop(R.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||V!=="work"||!P[Ne]?.isGif)return;const F=setInterval(()=>{const $=Et.current;if(!$)return;const G=$.getAttribute("src");$.removeAttribute("src"),setTimeout(()=>{Et.current&&Et.current.setAttribute("src",G)},0)},4e3);return()=>clearInterval(F)},[b,V,Ne,Te,P]);const S=(R,F,$)=>{const G=Math.round(R/F*c5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:l3.map((fe,ve)=>a.jsx("line",{x1:fe.x1,y1:fe.y1,x2:fe.x2,y2:fe.y2,className:ve<G?`wk-tick-filled ${$}`:"wk-tick-empty",strokeWidth:fe.thick?"3":"2"},ve))})},X=()=>{const R=P.length*A;return((Te-1)*P.length+Ne+(V==="rest"?.5:0))/R},Ae=pn&&a.jsx("div",{className:`toast-notification ${pn.type}`,children:pn.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(nl,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>k("randomiser_hub"),children:a.jsx("img",{src:Kw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>p("/upgrade"),children:[a.jsx("img",{src:Yw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[np.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:np.map((R,F)=>R.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:R.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:R.image,alt:R.name,className:"wk-prog-img"}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},R.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:R.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:Yw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:d5[R.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[R.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:R.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:R.name.toUpperCase()}),a.jsxs("p",{children:[R.daysPerWeek,"x per week  ",R.focus==="fullbody"?"Full Body":R.focus.charAt(0).toUpperCase()+R.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},R.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[nu.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:nu.map((R,F)=>a.jsx("button",{className:`wk-muscle-hero-card${R.image?" wk-muscle-thumb":""}`,onClick:()=>{Ht(R.key),k("muscle_sessions")},style:{animationDelay:`${F*.05}s`},children:R.image?a.jsx("img",{src:R.image,alt:R.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Kw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:tp[R.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:R.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:R.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Qw[R.key]?.length||0," sessions"]})]})]})]})},R.key))})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Gt(null)})]})});if(b==="randomiser_hub"){const R=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},F=Qr.find(G=>G.key===R.focus)?.label||R.focus,$=Ni.find(G=>G.key===R.level)?.label||R.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[ts.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:ts.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),ts.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[ts.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),ts.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:gh[ts.favouriteFocus]||"var(--color-primary)"},children:Qr.find(G=>G.key===ts.favouriteFocus)?.label||ts.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>k("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Cn,disabled:bn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[F,"  ",$,"  ",R.duration,"min"]})]})]}),_r&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{K(_r.focus),k("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:_r.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Xw[Math.floor(Date.now()/864e5)%Xw.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Ss.length>0&&a.jsx("span",{className:"wk-hub-count",children:Ss.length})]}),wi?Ss.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Qr.map(G=>{const fe=Ss.filter(Oe=>Oe.focus===G.key);if(fe.length===0)return null;const ve=js[G.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${ve?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":gh[G.key]||"var(--color-primary)"},onClick:()=>hr(Oe=>({...Oe,[G.key]:!Oe[G.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":gh[G.key]||"var(--color-primary)"},children:G.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:fe.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${ve?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),ve&&a.jsx("div",{className:"wk-hub-saved-list",children:fe.map((Oe,tt)=>{const nt=(Oe.equipment||[]).map(_t=>sp.find(Xt=>Xt.key===_t)?.label||_t).join(", "),vt=Ni.find(_t=>_t.key===Oe.level)?.label||Oe.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${tt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>At(Oe),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:Oe.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[vt,"  ",Oe.duration,"min  ",(Oe.exercises||[]).length," ex"]})}),nt&&a.jsx("span",{className:"wk-hub-saved-equip",children:nt})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>ot(Oe.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},Oe.id)})})]},G.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Kn.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Kn.map((G,fe)=>{const ve=Qr.find(vt=>vt.key===G.focus)?.label||G.focus||"",Oe=Ni.find(vt=>vt.key===G.level)?.label||G.level||"",tt=G.completedAt?.toDate?G.completedAt.toDate():G.completedAt?new Date(G.completedAt):null,nt=tt?(()=>{const vt=Math.floor((Date.now()-tt.getTime())/1e3);return vt<3600?`${Math.floor(vt/60)}m ago`:vt<86400?`${Math.floor(vt/3600)}h ago`:`${Math.floor(vt/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${fe*.05}s`},onClick:()=>{K(G.focus||"core"),Y(G.level||"intermediate"),Q(G.duration||15),G.equipment&&I(G.equipment),k("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":gh[G.focus]||"var(--color-primary)"},children:ve}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[Oe,"  ",G.duration||"?","min  ",G.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:nt}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},fe)})})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Gt(null)})]})}if(b==="setup"){const R=Qr.find($=>$.key===H)?.label||H,F=Ni.find($=>$.key===B)?.label||B;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${On}`,pct:On>0?Math.min(Math.round(On/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Le}/${ep}`,pct:Math.round(Math.min(Le,ep)/ep*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ke}`,pct:Ke>0?Math.min(Math.round(Ke/12*100),100):0,color:"#38B6FF",size:"normal"}].map($=>{const fe=2*Math.PI*38,ve=fe-$.pct/100*fe;return a.jsxs("div",{className:`wk-stat-item${$.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:$.color},strokeDasharray:fe,strokeDashoffset:ve})]}),a.jsx("span",{className:"wk-stat-value",style:{color:$.color},children:$.value})]}),a.jsx("span",{className:"wk-stat-label",children:$.label})]},$.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Qr.map($=>a.jsxs("button",{className:`wk-equip-btn${H===$.key?" active":""}${$.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{$s(),K($.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ni.map($=>a.jsxs("button",{className:`wk-level-card wk-level-${$.key}${B===$.key?" active":""}`,onClick:()=>{$s(),Y($.key)},children:[a.jsx("span",{className:"wk-level-name",children:$.label}),a.jsx("span",{className:"wk-level-desc",children:$.desc})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:rp.map($=>{const G=!St.includes($);return a.jsxs("button",{className:`wk-time-btn${te===$?" active":""}${G?" locked":""}`,onClick:()=>{G||($s(),Q($))},disabled:G,children:[a.jsx("span",{className:"wk-time-num",children:$}),a.jsx("span",{className:"wk-time-unit",children:G?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},$)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:sp.map($=>{const G=T.includes($.key);return a.jsxs("button",{className:`wk-equip-btn${G?" active":""}`,onClick:()=>{G&&T.length===1||($s(),I(fe=>G&&fe.length===1?fe:G?fe.filter(ve=>ve!==$.key):[...fe,$.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[R,"  ",F,"  ",te," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[bn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:xi,disabled:ye||bn,children:ye?"Loading exercises...":bn?"Limit Reached":"Randomise Workout"})]}),Ae]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:o3.map((R,F)=>a.jsx("line",{x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,className:"wk-spin-tick",strokeWidth:R.thick?"3.5":"2",style:{animationDelay:`${F*.03}s`}},F))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Ae]});if(b==="preview"){const R=it?.interval?{work:it.work,rest:it.rest}:Ni.find($=>$.key===B),F=P.length*A*(R.work+R.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k(it?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[it?.interval&&a.jsx("h2",{className:"mg-preview-title",children:it.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:P.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(F/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[R.work,"/",R.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:P.map(($,G)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${G*.06}s`},onClick:()=>qt($),children:[a.jsx("span",{className:"wk-preview-num",children:G+1}),a.jsx("div",{className:"wk-preview-thumb",children:$.isGif?a.jsx("img",{src:$.videoUrl,alt:$.name,loading:"lazy"}):a.jsx(g5,{src:`${$.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"metadata"})}),a.jsx("span",{className:"wk-preview-name",children:$.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},G))}),ln&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>qt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>qt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:ln.isGif?a.jsx("img",{src:ln.videoUrl,alt:ln.name}):a.jsx("video",{src:ln.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:ln.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!it?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>xi(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Vn(!0),disabled:Gn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:jr,children:"Start Workout"})]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:$=>es($.target.value),placeholder:`${Qr.find($=>$.key===H)?.label||H} ${te}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Fe(wn),disabled:Gn,children:Gn?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:He}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const R=P[Ne],F=V==="work"?st.work:st.rest,$=V==="rest"?Ne+1<P.length?P[Ne+1]:Te<A?P[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:V==="work"?R.isGif?a.jsx("img",{ref:Et,className:"wk-video",src:R.videoUrl,alt:R.name},R.videoUrl):a.jsx("video",{className:"wk-video",src:R.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},R.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[$&&($.isGif?a.jsx("img",{className:"wk-rest-preview",src:$.videoUrl,alt:$.name}):a.jsx("video",{className:"wk-rest-preview",src:$.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})),a.jsx("div",{className:"wk-rest-overlay"}),a.jsxs("div",{className:"wk-rest-text",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),$&&a.jsxs("div",{className:"wk-rest-next",children:[a.jsx("span",{className:"wk-rest-next-tag",children:"UP NEXT"}),a.jsx("span",{className:"wk-rest-next-name",children:$.name})]})]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&k("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ne+1," / ",P.length]}),a.jsx("h2",{className:"wk-exercise-name",children:R.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Te," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[S(je,F,V==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:je}),a.jsx("span",{className:`wk-timer-phase ${V}`,children:V==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&k("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ve(!ke),children:ke?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Se(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${X()*100}%`}})}),Je&&(()=>{const G=Ni.find(ve=>ve.key===B),fe=P.length*A*(G.work+G.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Wp,{title:"Workout Complete!",stats:[{value:Math.ceil(fe/60),label:"Minutes"},{value:P.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{$t(!1),yt(null),Ht(null)}}),!it?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Vn(!0),disabled:Gn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:ve=>ve.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:ve=>es(ve.target.value),placeholder:`${Qr.find(ve=>ve.key===H)?.label||H} ${te}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Fe(wn),disabled:Gn,children:Gn?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const R=nu.find($=>$.key===pt),F=Qw[pt]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:tp[pt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:R?.icon})})}),a.jsxs("h2",{children:[R?.label," Workouts"]}),a.jsxs("p",{children:[F.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:F.map(($,G)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{yt($),k("muscle_overview")},style:{animationDelay:`${G*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:$.name}),a.jsx("p",{children:$.desc}),a.jsx("div",{className:"mg-session-meta",children:$.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[$.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const fe=$.exercises.map(tt=>tt.sets||0),ve=Math.min(...fe),Oe=Math.max(...fe);return ve===Oe?`${ve} sets each`:`${ve}-${Oe} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id))})]}),Ae]})}if(b==="muscle_overview"){const R=it;if(!R)return null;const F=nu.find($=>$.key===pt);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:R.image?void 0:{background:tp[pt]},children:R.image?a.jsx("img",{src:R.image,alt:R.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:F?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:R.name}),R.level&&a.jsx("span",{className:"mg-overview-level",children:R.level})]}),a.jsx("p",{className:"mg-overview-desc",children:R.desc})]}),R.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:R.overview})]}),R.tips&&R.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:R.tips.map(($,G)=>a.jsx("li",{children:$},G))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",R.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:R.exercises.map(($,G)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:G+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:$.name}),R.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[R.work,"s work / ",R.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[$.sets," sets  ",$.reps?`${$.reps} reps`:`${$.time}s`,$.type==="weighted"&&"  weighted"]})]})]},G))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ii(R),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Ae]})}if(b==="muscle_workout"){const R=it;if(!R)return null;const F=R.exercises[gt],$=sn[gt];if(!F||!$)return null;const G=$.sets.length,fe=R.exercises.length,ve=R.exercises.reduce((_t,Xt)=>_t+(Xt.sets||0),0),tt=sn.reduce((_t,Xt)=>_t+Xt.sets.length,0)/ve*100,nt=Re[F.name];F.type==="timed"&&It===0&&!Wt&&G===Bt&&setTimeout(()=>ee(F.time),0);const vt=G+1<F.sets?"Log Set":gt+1<fe?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${tt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&k("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",gt+1,"/",fe]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[nt?a.jsxs("div",{className:"mg-video-container",onClick:_i,children:[nt.isGif?a.jsx("img",{className:"mg-video",src:nt.url,alt:F.name}):a.jsx("video",{ref:De,className:"mg-video",src:nt.url,loop:!0,muted:!0,playsInline:!0},F.name),!C&&!nt.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:F.name}),a.jsx("span",{className:`mg-ex-type-badge ${F.type}`,children:F.type==="weighted"?"Weight + Reps":F.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",G+1," of ",F.sets]}),F.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.reps," reps"]}),F.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.time,"s"]})]}),F.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Fn,onChange:_t=>Ln(_t.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:_t=>un(_t.target.value),placeholder:"0"})]})]}),F.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:_t=>un(_t.target.value),placeholder:"0"})]})}),F.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[It,"s"]})}),Wt?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Ct(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{It===0&&ee(F.time),Ct(!0)},children:It<F.time&&It>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:zi,children:vt}),$.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:$.sets.map((_t,Xt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Xt+1,": ",_t.weight!=null?`${_t.weight}kg  ${_t.reps}`:_t.reps!=null?`${_t.reps} reps`:`${_t.time}s`]})]},Xt))})]})]}),Ae,Rt&&(()=>{const _t=sn.reduce((et,mn)=>et+mn.sets.length,0),Xt=nu.find(et=>et.key===pt)?.label||"",Hn=[{value:sn.length,label:"Exercises"},{value:_t,label:"Sets"}];return a.jsx(Wp,{title:`${Xt} Complete!`,subtitle:it?.name,stats:Hn,hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Sn(!1),yt(null),Ht(null)}})})()]})}return a.jsx(Wl,{badge:rt,onDismiss:()=>Gt(null)})}const y5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],v5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",Jw=[{color:"#e91e63",darkColor:"#FF4D88"},{color:"#00bcd4",darkColor:"#26D9EC"},{color:"#ff5722",darkColor:"#FF7A50"},{color:"#009688",darkColor:"#26B8A8"},{color:"#ffc107",darkColor:"#FFD54F"},{color:"#673ab7",darkColor:"#9575CD"},{color:"#8bc34a",darkColor:"#AED581"},{color:"#f44336",darkColor:"#EF5350"},{color:"#3f51b5",darkColor:"#7986CB"},{color:"#795548",darkColor:"#A1887F"}],b5=700,Gp=42,Pl=2*Math.PI*Gp,ph=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function w5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ya(s){return s.toISOString().split("T")[0]}function x5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=Ui(),{isPremium:d,FREE_HABIT_LIMIT:g}=uc(),y=Zs(),[p,b]=w.useState({}),[k,T]=w.useState([]),[I,H]=w.useState(!0),[K,B]=w.useState(!1),[Y,te]=w.useState(0),[Q,pe]=w.useState(null),[we,ye]=w.useState(null),[M,E]=w.useState(!1),[L,U]=w.useState(null),[P,D]=w.useState(!1),[A,Pe]=w.useState(!1),[st,Z]=w.useState(!1),[Te,qe]=w.useState(""),[Ne,We]=w.useState(null),[V,ce]=w.useState([]),[je,Se]=w.useState([]),[ke,Ve]=w.useState(null),He=w.useRef(null),Qe=w.useRef(null),Je=w.useRef(null),$t=w.useRef(null),Rt=w.useRef(!1),Sn=w.useRef({}),ln=w.useRef([]),qt=w.useRef([]),Et=w.useRef(null),pn=w.useRef(ph[Math.floor(Math.random()*ph.length)]),Tt=w.useCallback((ue,Me="info")=>{pe({message:ue,type:Me}),setTimeout(()=>pe(null),3e3)},[]),ut=new Date,le=Ya(ut),pt=w5(ut),Ht=x5(pt),it=["M","T","W","T","F","S","S"],yt=(ue,Me)=>l&&Me?Me:ue,gt=[...y5.filter(ue=>!V.includes(ue.key)).map(ue=>({...ue,color:yt(ue.color,ue.darkColor)})),...k.map((ue,Me)=>{const Ke=Jw[Me%Jw.length];return{key:`custom_${ue.id}`,label:ue.label,icon:v5,color:yt(Ke.color,Ke.darkColor),isCustom:!0,id:ue.id}})],wt=d?gt:gt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Me=dt(ge,"habitLogs"),Ke=on(Me,Ut("clientId","==",t.id)),ct=await Qt(Ke),rt={};ct.docs.forEach(St=>{const bn=St.data();rt[bn.date]={...bn,_id:St.id}}),b(rt);const Gt=await _s(ze(ge,"customHabits",t.id));if(Gt.exists()){const St=Gt.data();T(St.habits||[]),ce(St.hiddenDefaults||[]),Se(St.savedHabits||[])}let fn=0;const Nt=new Date(ut);for(;;){const St=Ya(Nt),bn=rt[St];if(bn)if(Object.values(bn.habits||{}).filter(Boolean).length>=3)fn++,Nt.setDate(Nt.getDate()-1);else break;else if(St===le)Nt.setDate(Nt.getDate()-1);else break}te(fn)}catch(Me){console.error("Error loading habit logs:",Me)}finally{H(!1)}})()},[s,t]);const Bt=p[le]||{habits:{}};w.useEffect(()=>{Object.values(Bt.habits||{}).filter(Boolean).length<wt.length&&A&&Pe(!1)},[wt.length,Bt.habits]);const fs=async ue=>{if(!(!s||K||Bt.habits?.[ue])){ln.current=[...Array(10)].map((Ke,ct)=>{const rt=ct/10*2*Math.PI,Gt=18+Math.random()*20;return{tx:Math.cos(rt)*Gt,ty:Math.sin(rt)*Gt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),ye(ue),setTimeout(()=>ye(null),700),navigator.vibrate&&navigator.vibrate(50),B(!0);try{const ct={...Bt.habits||{},[ue]:!0},rt=Bt._id||`${t.id}_${le}`;if(b(fn=>({...fn,[le]:{clientId:t.id,date:le,habits:ct,_id:rt}})),await Xn(ze(ge,"habitLogs",rt),{clientId:t.id,date:le,habits:ct}),Object.values(ct).filter(Boolean).length===wt.length&&!A){pn.current=ph[Math.floor(Math.random()*ph.length)],qt.current=[...Array(80)].map((Nt,St)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][St%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:St%3})),setTimeout(()=>{E(!0),Pe(!0),setTimeout(()=>Et.current?.focus(),1100)},400);let fn=1;for(let Nt=1;Nt<7;Nt++){const St=new Date;St.setDate(St.getDate()-Nt);const bn=Ya(St),Ss=p[bn];if(Ss)if(Object.values(Ss.habits||{}).filter(Boolean).length>=wt.length)fn++;else break;else break}fn>=7&&Jh("habits_7",t).then(Nt=>{Nt&&U(Nt)})}}catch(Ke){console.error("Error saving habit:",Ke),Tt("Failed to save. Try again.","error"),b(ct=>({...ct,[le]:{...ct[le],habits:{...ct[le]?.habits||{},[ue]:!1}}}))}finally{B(!1)}}},sn=async ue=>{if(!(!s||K)){B(!0);try{const Ke={...Bt.habits||{},[ue]:!1},ct=Bt._id||`${t.id}_${le}`;await Xn(ze(ge,"habitLogs",ct),{clientId:t.id,date:le,habits:Ke}),b(rt=>({...rt,[le]:{clientId:t.id,date:le,habits:Ke,_id:ct}}))}catch(Me){console.error("Error undoing habit:",Me),Tt("Failed to undo. Try again.","error")}finally{B(!1)}}},Zn=ue=>{if(Bt.habits?.[ue]||!1||K||$t.current)return;$t.current=ue,Ve(ue),Qe.current=performance.now();const Ke=Sn.current[ue];Ke&&(Ke.style.strokeDashoffset=Pl);const ct=rt=>{const Gt=rt-Qe.current,fn=Math.min(Gt/b5,1),Nt=Sn.current[ue];Nt&&(Nt.style.strokeDashoffset=Pl-fn*Pl),fn<1?Je.current=requestAnimationFrame(ct):($t.current=null,Rt.current=!0,Je.current=null,Ve(null),fs(ue))};Je.current=requestAnimationFrame(ct)},Fn=()=>{if(!$t.current)return;const ue=$t.current;$t.current=null,Je.current&&(cancelAnimationFrame(Je.current),Je.current=null),He.current&&(clearTimeout(He.current),He.current=null),Sn.current[ue]&&(Sn.current[ue].style.strokeDashoffset=Pl),Ve(null),Qe.current=null};w.useEffect(()=>()=>{Je.current&&cancelAnimationFrame(Je.current),He.current&&clearTimeout(He.current)},[]);const Ln=w.useCallback(async ue=>{if(!t)throw new Error("Not signed in");const Me=ue&&typeof ue=="object"&&ue.type;await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me?"":ue,type:Me?ue.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...Me?{metadata:{title:ue.title||"",subtitle:ue.subtitle||"",stats:ue.stats||[],quote:ue.quote||"",badges:ue.badges||[]}}:{}})},[t]),Pn=async()=>{const ue=Te.trim();if(!ue)return;if(!t?.id){Tt("Still loading, try again","error");return}const Me=Date.now().toString(36),Ke=[...k,{id:Me,label:ue}];try{await Xn(ze(ge,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:je},{merge:!0}),T(Ke),qe(""),Z(!1),Tt(`Added "${ue}"`,"success")}catch(ct){console.error("Error adding custom habit:",ct),Tt(ct?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ct?.message||"Unknown error"}`,"error")}},un=async ue=>{if(!t?.id)return;const Me=k.find(rt=>rt.id===ue),Ke=k.filter(rt=>rt.id!==ue),ct=Me&&!je.includes(Me.label)?[...je,Me.label]:je;try{await Xn(ze(ge,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:ct},{merge:!0}),T(Ke),Se(ct),We(null),Tt("Habit saved for later","success")}catch(rt){console.error("Error deleting habit:",rt),Tt("Failed to remove","error")}},Wt=async ue=>{if(!t?.id)return;const Me=Date.now().toString(36),Ke=[...k,{id:Me,label:ue}],ct=je.filter(rt=>rt!==ue);try{await Xn(ze(ge,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:V,savedHabits:ct},{merge:!0}),T(Ke),Se(ct),Z(!1),Tt(`Added "${ue}"`,"success")}catch(rt){console.error("Error re-adding habit:",rt),Tt("Failed to add","error")}},Ct=async ue=>{if(!t?.id)return;const Me=je.filter(Ke=>Ke!==ue);try{await Xn(ze(ge,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:V,savedHabits:Me},{merge:!0}),Se(Me)}catch(Ke){console.error("Error removing saved habit:",Ke)}},It=async ue=>{if(!t?.id)return;const Me=[...V,ue];try{await Xn(ze(ge,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:Me,savedHabits:je},{merge:!0}),ce(Me),We(null),Tt("Habit removed","success")}catch(Ke){console.error("Error hiding default habit:",Ke),Tt("Failed to remove","error")}},ee=Ht.map(ue=>{const Me=Ya(ue),Ke=p[Me],ct=Ke?Object.values(Ke.habits||{}).filter(Boolean).length:0;return{date:ue,dateStr:Me,completed:ct,total:wt.length}}),C=ee.reduce((ue,Me)=>ue+Me.completed,0),ne=ee.reduce((ue,Me)=>ue+Me.total,0),Re=ne>0?Math.round(C/ne*100):0,Ie=Object.values(Bt.habits||{}).filter(Boolean).length,De=wt.length>0?Math.round(Ie/wt.length*100):0,Be=Ie===wt.length&&wt.length>0,Le=(()=>{const ue=Object.keys(p).sort();let Me=0,Ke=0,ct=null;for(const rt of ue){const Gt=p[rt];if(Object.values(Gt.habits||{}).filter(Boolean).length>=3){if(ct){const Nt=new Date(ct);Ke=(new Date(rt)-Nt)/(1e3*60*60*24)===1?Ke+1:1}else Ke=1;Ke>Me&&(Me=Ke),ct=rt}else Ke=0,ct=null}return Math.max(Me,Y)})(),Dt=new Date(ut.getFullYear(),ut.getMonth(),1),xt=Dt.toLocaleString("default",{month:"long"}),lt=new Date(ut.getFullYear(),ut.getMonth()+1,0).getDate(),dn=(Dt.getDay()+6)%7,hn=Array.from({length:lt},(ue,Me)=>{const Ke=new Date(ut.getFullYear(),ut.getMonth(),Me+1),ct=Ya(Ke),rt=p[ct],Gt=rt?Object.values(rt.habits||{}).filter(Boolean).length:0,fn=Ke>ut;return{day:Me+1,dateStr:ct,completed:Gt,total:wt.length,isFuture:fn,isToday:ct===le}}),On=wt.map(ue=>({...ue,days:Ht.map(Me=>{const Ke=Ya(Me);return p[Ke]?.habits?.[ue.key]||!1})})),ms=ee.filter(ue=>ue.completed===ue.total&&ue.total>0).length;return a.jsx(nl,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||I?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${Be?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-De/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Ie,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),wt.length]}),a.jsx("span",{className:"cbc-ring-label",children:Be?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:Be?"You showed up for yourself today.":Ie===0?"Start your day strong.":`${wt.length-Ie} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:Y}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Le}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[wt.map(ue=>{const Me=Bt.habits?.[ue.key]||!1,Ke=we===ue.key,ct=ke===ue.key;return a.jsxs("div",{className:`cbc-habit-tile ${Me?"cbc-habit-done":""} ${Ke?"cbc-habit-just-checked":""}`,style:{"--habit-color":ue.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:rt=>{rt.stopPropagation(),We(ue.isCustom?{type:"custom",id:ue.id,label:ue.label}:{type:"default",key:ue.key,label:ue.label})},"aria-label":`Remove ${ue.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${ct?"cbc-holding":""} ${Me?"cbc-ring-completed":""}`,onPointerDown:rt=>{Me||(rt.preventDefault(),Zn(ue.key))},onPointerUp:Fn,onPointerLeave:Fn,onPointerCancel:Fn,onClick:rt=>{if(rt.stopPropagation(),Rt.current){Rt.current=!1;return}Me&&sn(ue.key)},role:"button",tabIndex:0,"aria-label":Me?`Undo ${ue.label}`:`Press and hold to complete ${ue.label}`,onKeyDown:rt=>{(rt.key==="Enter"||rt.key===" ")&&(rt.preventDefault(),Me?sn(ue.key):fs(ue.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Gp}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:rt=>{rt&&(Sn.current[ue.key]=rt)},cx:"50",cy:"50",r:Gp,style:{stroke:ue.color,strokeDasharray:Pl,strokeDashoffset:Me?0:Pl}})]}),Me&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":ue.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:ue.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:ue.icon})})}),Ke&&a.jsx("div",{className:"cbc-particles",children:ln.current.map((rt,Gt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${rt.tx}px`,"--ty":`${rt.ty}px`,"--size":`${rt.size}px`,"--particle-color":ue.color,animationDuration:`${rt.duration}s`}},Gt))})]}),a.jsx("span",{className:"cbc-habit-label",children:ue.label}),Me?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ue.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Z(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[ms,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),it.map((ue,Me)=>a.jsx("span",{className:`cbc-weekly-day-label${Ht[Me]&&Ya(Ht[Me])===le?" cbc-today-label":""}`,children:ue},Me))]}),On.map(ue=>(ue.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:ue.color},children:ue.label}),ue.days.map((Me,Ke)=>a.jsx("span",{className:`cbc-weekly-dot${Me?" cbc-dot-done":""}${Ht[Ke]&&Ya(Ht[Ke])===le?" cbc-dot-today":""}`,style:Me?{background:ue.color,borderColor:ue.color,boxShadow:`0 0 6px ${ue.color}40`}:void 0},Ke))]},ue.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Re}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[C,"/",ne," completed (",Re,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:xt}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((ue,Me)=>a.jsx("span",{className:"cbc-cal-day-label",children:ue},Me))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:dn},(ue,Me)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Me}`)),hn.map(ue=>{const Me=ue.total>0?ue.completed/ue.total:0,Ke=ue.isFuture?-1:Me===0?0:Me<.4?1:Me<.75?2:Me<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${ue.isToday?" cbc-cal-today":""}${Ke===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ke<0?"future":Ke}`,children:ue.day},ue.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(ni,{active:"home"}),st&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Z(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),je.length>0&&a.jsxs("div",{className:"cbc-saved-habits",children:[a.jsx("span",{className:"cbc-saved-label",children:"Quick add"}),a.jsx("div",{className:"cbc-saved-chips",children:je.map(ue=>a.jsxs("div",{className:"cbc-saved-chip",children:[a.jsx("button",{className:"cbc-saved-chip-add",onClick:()=>Wt(ue),children:ue}),a.jsx("button",{className:"cbc-saved-chip-remove",onClick:()=>Ct(ue),"aria-label":`Remove ${ue}`,children:""})]},ue))})]}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Te,onChange:ue=>qe(ue.target.value),maxLength:30,autoFocus:!0,onKeyDown:ue=>ue.key==="Enter"&&Pn()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Z(!1),qe("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:Pn,disabled:!Te.trim(),children:"Add"})]})]})}),Ne&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>We(null),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ne.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>We(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ne.type==="custom"?un(Ne.id):It(Ne.key),children:"Remove"})]})]})}),M&&a.jsx(Wp,{title:"All Habits Complete!",subtitle:pn.current,stats:[{value:`${Ie}/${wt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?Ln:null,userName:t?.name,onDone:()=>{E(!1),D(!1)}}),Q&&a.jsx("div",{className:`toast-notification ${Q.type}`,children:Q.message}),a.jsx(Wl,{badge:L,onDismiss:()=>U(null)})]})})}function Do(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function k5(s,e){return[s,e].sort().join("_")}function Zw(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function j5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState("feed"),[p,b]=w.useState([]),[k,T]=w.useState([]),[I,H]=w.useState([]),[K,B]=w.useState(""),[Y,te]=w.useState([]),[Q,pe]=w.useState([]),[we,ye]=w.useState(!0),[M,E]=w.useState(null),[L,U]=w.useState(null),[P,D]=w.useState([]),[A,Pe]=w.useState(!1),[st,Z]=w.useState(new Set),[Te,qe]=w.useState(new Set),[Ne,We]=w.useState({}),[V,ce]=w.useState({}),[je,Se]=w.useState({}),[ke,Ve]=w.useState({}),[He,Qe]=w.useState({}),[Je,$t]=w.useState({}),Rt=w.useRef({}),[Sn,ln]=w.useState(!1),[qt,Et]=w.useState(null),[pn,Tt]=w.useState([]),ut=w.useCallback((C,ne="info")=>{U({message:C,type:ne}),setTimeout(()=>U(null),3500)},[]),le=(C,ne)=>{const Re=C.match(/@(\w*)$/);if(Re){ln(!0),Et(ne);const Ie=p.filter(De=>De.name&&De.name.toLowerCase().includes(Re[1].toLowerCase())).slice(0,5);Tt(Ie)}else ln(!1),Tt([])},pt=(C,ne)=>{const Ie=(V[ne]||"").replace(/@\w*$/,`@${C.name} `);ce(De=>({...De,[ne]:Ie})),ln(!1),Tt([])},Ht=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Re,Ie)=>Re.startsWith("@")&&p.some(De=>Re.trim()===`@${De.name}`)?a.jsx("span",{className:"mention-highlight",children:Re.trim()},Ie):Re);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const it=w.useCallback(async()=>{if(t){ye(!0);try{const C=t.id,Re=(await Qt(dt(ge,"clients"))).docs.map(lt=>({id:lt.id,...lt.data()}));pe(Re);const Ie=Object.fromEntries(Re.map(lt=>[lt.id,lt])),De=await Qt(on(dt(ge,"buddies"),Ut("user1","==",C))),Be=await Qt(on(dt(ge,"buddies"),Ut("user2","==",C))),Le=new Set;[...De.docs,...Be.docs].forEach(lt=>{const dn=lt.data(),hn=dn.user1===C?dn.user2:dn.user1;Le.add(hn)}),b(Array.from(Le).map(lt=>Ie[lt]).filter(Boolean));const Dt=await Qt(on(dt(ge,"buddyRequests"),Ut("toId","==",C),Ut("status","==","pending")));T(Dt.docs.map(lt=>({reqId:lt.id,...lt.data(),fromClient:Ie[lt.data().fromId]})).filter(lt=>lt.fromClient));const xt=await Qt(on(dt(ge,"buddyRequests"),Ut("fromId","==",C),Ut("status","==","pending")));H(xt.docs.map(lt=>({reqId:lt.id,...lt.data(),toClient:Ie[lt.data().toId]})).filter(lt=>lt.toClient))}catch(C){console.error("Error fetching buddy data:",C),ut("Failed to load buddies","error")}finally{ye(!1)}}},[t,ut]);w.useEffect(()=>{it()},[it]),w.useEffect(()=>{if(!K.trim()||!t){te([]);return}const C=K.toLowerCase(),ne=t.id,Re=new Set(p.map(Le=>Le.id)),Ie=new Set(I.map(Le=>Le.toId)),De=new Set(k.map(Le=>Le.fromId)),Be=Q.filter(Le=>Le.id===ne||!Le.name||!Le.coreBuddyAccess&&Le.clientType!=="core_buddy"||!(Le.tier==="premium"||Le.signupSource!=="self_signup")?!1:Le.name.toLowerCase().includes(C)).map(Le=>({...Le,isBuddy:Re.has(Le.id),isPendingOut:Ie.has(Le.id),isPendingIn:De.has(Le.id)})).slice(0,20);te(Be)},[K,Q,p,I,k,t]);const yt=async(C,ne)=>{if(!(!t||C===t.id))try{await or(dt(ge,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:ne,read:!1,createdAt:xs()})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&ut("Notifications blocked  check Firestore rules","error")}},gt=async C=>{E(C);try{const ne=`${t.id}_${C}`;await Xn(ze(ge,"buddyRequests",ne),{fromId:t.id,toId:C,status:"pending",createdAt:xs()}),await yt(C,"buddy_request"),ut("Buddy request sent!","success"),await it()}catch(ne){console.error("Error sending request:",ne),ut("Failed to send request","error")}finally{E(null)}},wt=async C=>{E(C.reqId);try{const ne=k5(C.fromId,t.id);await Xn(ze(ge,"buddies",ne),{user1:[C.fromId,t.id].sort()[0],user2:[C.fromId,t.id].sort()[1],connectedAt:xs()}),await ar(ze(ge,"buddyRequests",C.reqId)),await yt(C.fromId,"buddy_accept"),ut("Buddy added!","success"),await it()}catch(ne){console.error("Error accepting request:",ne),ut("Failed to accept","error")}finally{E(null)}},Bt=async C=>{E(C.reqId);try{await ar(ze(ge,"buddyRequests",C.reqId)),ut("Request declined","info"),await it()}catch(ne){console.error("Error declining:",ne),ut("Failed to decline","error")}finally{E(null)}},fs=async C=>{E(C.reqId);try{await ar(ze(ge,"buddyRequests",C.reqId)),ut("Request cancelled","info"),await it()}catch(ne){console.error("Error cancelling:",ne),ut("Failed to cancel","error")}finally{E(null)}},sn=w.useCallback(async()=>{if(!t||p.length===0){D([]);return}Pe(!0);try{const C=[t.id,...p.map(De=>De.id)],ne=[];for(let De=0;De<C.length;De+=30)ne.push(C.slice(De,De+30));let Re=[];for(const De of ne){const Be=await Qt(on(dt(ge,"posts"),Ut("authorId","in",De)));Re.push(...Be.docs.map(Le=>({id:Le.id,...Le.data()})))}Re.sort((De,Be)=>{const Le=De.createdAt?.toDate?.()||new Date(0);return(Be.createdAt?.toDate?.()||new Date(0))-Le}),D(Re.slice(0,50));const Ie=await Qt(on(dt(ge,"postLikes"),Ut("userId","==",t.id)));Z(new Set(Ie.docs.map(De=>De.data().postId)))}catch(C){console.error("Error loading feed:",C)}finally{Pe(!1)}},[t,p]);w.useEffect(()=>{p.length>0&&g==="feed"&&sn()},[p,g,sn]);const Zn=async C=>{if(!t)return;const ne=t.id,Re=`${C}_${ne}`,Ie=st.has(C),De=new Set(st);Ie?De.delete(C):De.add(C),Z(De),D(Be=>Be.map(Le=>Le.id===C?{...Le,likeCount:Math.max(0,(Le.likeCount||0)+(Ie?-1:1))}:Le));try{if(Ie)await ar(ze(ge,"postLikes",Re)),await zn(ze(ge,"posts",C),{likeCount:fi(-1)});else{await Xn(ze(ge,"postLikes",Re),{postId:C,userId:ne,createdAt:xs()}),await zn(ze(ge,"posts",C),{likeCount:fi(1)});const Be=P.find(Le=>Le.id===C);Be&&yt(Be.authorId,"like")}}catch(Be){console.error("Like error:",Be),sn()}},Fn=async C=>{if(window.confirm("Delete this post?"))try{await ar(ze(ge,"posts",C)),D(ne=>ne.filter(Re=>Re.id!==C)),ut("Post deleted","info")}catch(ne){console.error("Delete error:",ne),ut("Failed to delete","error")}},Ln=async C=>{try{const Re=(await Qt(on(dt(ge,"postComments"),Ut("postId","==",C)))).docs.map(Ie=>({id:Ie.id,...Ie.data()})).sort((Ie,De)=>{const Be=Ie.createdAt?.toDate?.()||new Date(0),Le=De.createdAt?.toDate?.()||new Date(0);return Be-Le}).slice(0,50);We(Ie=>({...Ie,[C]:Re}))}catch(ne){console.error("Error loading comments:",ne)}},Pn=C=>{const ne=new Set(Te);ne.has(C)?ne.delete(C):(ne.add(C),Ne[C]||Ln(C)),qe(ne)},un=async C=>{const ne=(V[C]||"").trim(),Re=He[C];if(!(!ne&&!Re||!t)){Se(Ie=>({...Ie,[C]:!0}));try{let Ie=null;if(Re){const xt=ca(ua,`comment-images/${Date.now()}_${Re.name}`);await pu(xt,Re),Ie=await ro(xt)}const De={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ne||"",createdAt:xs()};Ie&&(De.imageURL=Ie);const Be=ke[C];Be&&(De.replyToId=Be.id,De.replyToName=Be.authorName),await or(dt(ge,"postComments"),De),await zn(ze(ge,"posts",C),{commentCount:fi(1)});const Le=P.find(xt=>xt.id===C);Le&&yt(Le.authorId,"comment");const Dt=ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Dt){const xt=new Set;Dt.forEach(lt=>{const dn=lt.slice(1).trim(),hn=p.find(On=>On.name&&On.name.toLowerCase()===dn.toLowerCase());hn&&!xt.has(hn.id)&&(xt.add(hn.id),yt(hn.id,"mention"))})}ce(xt=>({...xt,[C]:""})),Qe(xt=>({...xt,[C]:null})),$t(xt=>({...xt,[C]:null})),Ve(xt=>({...xt,[C]:null})),Rt.current[C]&&(Rt.current[C].value=""),D(xt=>xt.map(lt=>lt.id===C?{...lt,commentCount:(lt.commentCount||0)+1}:lt)),await Ln(C)}catch(Ie){console.error("Comment error:",Ie),ut("Failed to comment","error")}finally{Se(Ie=>({...Ie,[C]:!1}))}}},Wt=async(C,ne)=>{try{await ar(ze(ge,"postComments",ne)),await zn(ze(ge,"posts",C),{commentCount:fi(-1)}),We(Re=>({...Re,[C]:(Re[C]||[]).filter(Ie=>Ie.id!==ne)})),D(Re=>Re.map(Ie=>Ie.id===C?{...Ie,commentCount:Math.max((Ie.commentCount||1)-1,0)}:Ie))}catch(Re){console.error("Delete comment error:",Re),ut("Failed to delete comment","error")}},Ct=(C,ne)=>{const Re=ne.target.files?.[0];if(!Re)return;if(Re.size>5*1024*1024){ut("Image must be under 5MB","error");return}Qe(De=>({...De,[C]:Re}));const Ie=new FileReader;Ie.onload=De=>$t(Be=>({...Be,[C]:De.target.result})),Ie.readAsDataURL(Re)},It=C=>{Qe(ne=>({...ne,[C]:null})),$t(ne=>({...ne,[C]:null})),Rt.current[C]&&(Rt.current[C].value="")},ee=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(nl,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${g==="feed"?" active":""}`,onClick:()=>y("feed"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("span",{children:"Feed"})]}),a.jsxs("button",{className:`bdy-tab${g==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`bdy-tab${g==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),ee>0&&a.jsx("span",{className:"bdy-tab-badge",children:ee})]}),a.jsxs("button",{className:`bdy-tab${g==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),we?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[g==="feed"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Add buddies to see their posts here!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):A?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):P.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("h3",{children:"No posts yet"}),a.jsx("p",{children:"Your buddies haven't posted anything yet"})]}):a.jsx("div",{className:"bdy-feed-list",children:P.map(C=>a.jsxs("div",{className:"bdy-feed-post",children:[a.jsxs("div",{className:"bdy-feed-post-header",children:[a.jsx("div",{className:"bdy-feed-avatar",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(C.authorName)})}),a.jsxs("div",{className:"bdy-feed-meta",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:[a.jsx("span",{className:"bdy-feed-name",children:C.authorName}),a.jsx("span",{className:"bdy-feed-time",children:Zw(C.createdAt)})]}),C.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-delete-btn",onClick:()=>Fn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(ne=>`${ne.value} ${ne.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed a workout using Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo bdy-feed-card-badge",children:(()=>{const ne=Jr.find(Re=>Re.id===C.metadata.badgeId);return ne?.img?a.jsx("img",{src:ne.img,alt:C.metadata.title,loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title})})()}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.badgeDesc}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Earned a badge on Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(ne=>`${ne.value} ${ne.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed daily habits with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"bdy-feed-content",children:Ht(C.content)}),C.imageURL&&a.jsx("div",{className:"bdy-feed-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"bdy-feed-actions",children:[a.jsxs("button",{className:`bdy-feed-action-btn${st.has(C.id)?" liked":""}`,onClick:()=>Zn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:st.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`bdy-feed-action-btn${Te.has(C.id)?" active":""}`,onClick:()=>Pn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Te.has(C.id)&&a.jsxs("div",{className:"bdy-feed-comments",children:[Ne[C.id]?.length>0?Ne[C.id].map(ne=>a.jsxs("div",{className:"bdy-feed-comment",children:[a.jsx("div",{className:"bdy-feed-comment-avatar",children:ne.authorPhotoURL?a.jsx("img",{src:ne.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(ne.authorName)})}),a.jsxs("div",{className:"bdy-feed-comment-body",children:[a.jsxs("div",{className:"bdy-feed-comment-bubble",children:[a.jsx("span",{className:"bdy-feed-comment-name",children:ne.authorName}),ne.replyToName&&a.jsxs("span",{className:"bdy-feed-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),ne.replyToName]}),ne.content&&a.jsx("span",{className:"bdy-feed-comment-text",children:Ht(ne.content)}),ne.imageURL&&a.jsx("img",{className:"bdy-feed-comment-img",src:ne.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"bdy-feed-comment-row",children:[a.jsx("span",{className:"bdy-feed-comment-time",children:Zw(ne.createdAt)}),a.jsx("button",{className:"bdy-feed-comment-reply-btn",onClick:()=>Ve(Re=>({...Re,[C.id]:{id:ne.id,authorName:ne.authorName}})),children:"Reply"}),ne.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-comment-del-btn",onClick:()=>Wt(C.id,ne.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},ne.id)):a.jsx("p",{className:"bdy-feed-no-comments",children:"No comments yet"}),ke[C.id]&&a.jsxs("div",{className:"bdy-feed-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:ke[C.id].authorName})]}),a.jsx("button",{onClick:()=>Ve(ne=>({...ne,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Je[C.id]&&a.jsxs("div",{className:"bdy-feed-comment-img-preview",children:[a.jsx("img",{src:Je[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>It(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"bdy-feed-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"bdy-feed-comment-img-btn",onClick:()=>Rt.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:ne=>{Rt.current[C.id]=ne},type:"file",accept:"image/*",onChange:ne=>Ct(C.id,ne),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:V[C.id]||"",onChange:ne=>{ce(Re=>({...Re,[C.id]:ne.target.value})),le(ne.target.value,C.id)},onKeyDown:ne=>{ne.key==="Enter"&&un(C.id)},maxLength:300}),Sn&&qt===C.id&&pn.length>0&&a.jsx("div",{className:"bdy-feed-mention-dropdown",children:pn.map(ne=>a.jsxs("button",{className:"bdy-feed-mention-option",onClick:()=>pt(ne,C.id),children:[a.jsx("div",{className:"bdy-feed-mention-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:""}):a.jsx("span",{children:Do(ne.name)})}),a.jsx("span",{children:ne.name})]},ne.id))}),a.jsx("button",{onClick:()=>un(C.id),disabled:!(V[C.id]||"").trim()&&!He[C.id]||je[C.id],children:je[C.id]?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})})]})]})]},C.id))})}),g==="buddies"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:p.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Do(C.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:C.name})}),a.jsx("button",{className:"bdy-view-btn",onClick:ne=>{ne.stopPropagation(),d(`/client/core-buddy/profile/${C.id}`)},"aria-label":"View profile",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]},C.id))})}),g==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.fromClient.photoURL?a.jsx("img",{src:C.fromClient.photoURL,alt:C.fromClient.name}):a.jsx("span",{children:Do(C.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>wt(C),disabled:M===C.reqId,children:M===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>Bt(C),disabled:M===C.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},C.reqId))})]}),I.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:I.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.toClient?.photoURL?a.jsx("img",{src:C.toClient.photoURL,alt:C.toClient.name}):a.jsx("span",{children:Do(C.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fs(C),disabled:M===C.reqId,children:M===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},C.reqId))})]}),k.length===0&&I.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),g==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:K,onChange:C=>B(C.target.value),autoFocus:!0}),K&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),K.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',K,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Do(C.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.name}),C.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),C.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):C.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):C.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:ne=>{ne.stopPropagation();const Re=k.find(Ie=>Ie.fromId===C.id);Re&&wt(Re)},disabled:!!M,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:ne=>{ne.stopPropagation(),gt(C.id)},disabled:M===C.id,children:M===C.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},C.id))})]})]})]}),a.jsx(ni,{active:"buddies"}),L&&a.jsxs("div",{className:`toast-notification ${L.type}`,children:[a.jsx("span",{className:"toast-icon",children:L.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):L.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:L.message})]})]})})}function yh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ip(s,e){return[s,e].sort().join("_")}const E5=5;function ap(s){return s.toISOString().split("T")[0]}function ex(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function T5(){const{userId:s}=wS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Pr(),{isDark:u,toggleTheme:d}=Ui(),g=Zs(),[y,p]=w.useState(null),[b,k]=w.useState("none"),[T,I]=w.useState(null),[H,K]=w.useState(!0),[B,Y]=w.useState(!1),[te,Q]=w.useState(null),[pe,we]=w.useState([]),[ye,M]=w.useState(!1),[E,L]=w.useState(new Set),[U,P]=w.useState(new Set),[D,A]=w.useState({}),[Pe,st]=w.useState({}),[Z,Te]=w.useState({}),[qe,Ne]=w.useState(!0),[We,V]=w.useState(0),[ce,je]=w.useState(0),[Se,ke]=w.useState(0),[Ve,He]=w.useState(new Set),[Qe,Je]=w.useState(null),[$t,Rt]=w.useState(!1),[Sn,ln]=w.useState(!1),[qt,Et]=w.useState([]),[pn,Tt]=w.useState(!1),[ut,le]=w.useState(null),[pt,Ht]=w.useState([]),it=w.useCallback((ee,C="info")=>{Q({message:ee,type:C}),setTimeout(()=>Q(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&g("/")},[e,t,l,g]),w.useEffect(()=>{i&&s&&i.id===s&&g("/client/core-buddy",{replace:!0})},[i,s,g]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let ee=!1;return(async()=>{K(!0);try{const Re=(await Qt(dt(ge,"clients"))).docs.map(Le=>({id:Le.id,...Le.data()})).find(Le=>Le.id===s);if(!Re){ee||K(!1);return}ee||p(Re);const Ie=i.id,De=ip(Ie,s);if((await _s(ze(ge,"buddies",De))).exists())ee||k("buddy");else{const Le=`${Ie}_${s}`,Dt=await _s(ze(ge,"buddyRequests",Le));if(Dt.exists()&&Dt.data().status==="pending")ee||(k("pending_out"),I(Le));else{const xt=`${s}_${Ie}`,lt=await _s(ze(ge,"buddyRequests",xt));lt.exists()&&lt.data().status==="pending"?ee||(k("pending_in"),I(xt)):ee||k("none")}}}catch(C){console.error("Error loading profile:",C)}finally{ee||K(!1)}})(),()=>{ee=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let ee=!1;return(async()=>{Ne(!0);try{const C=await Qt(on(dt(ge,"workoutLogs"),Ut("clientId","==",s)));if(ee)return;const ne=C.docs.length;V(ne);let Re=0;const Ie=C.docs.map(Be=>Be.data().date).filter(Boolean).sort().reverse();if(Ie.length>0){const Be=new Date;let Le=new Date(Be);for(let Dt=0;Dt<52;Dt++){const xt=new Date(Le),lt=xt.getDay(),dn=lt===0?6:lt-1;xt.setDate(xt.getDate()-dn),xt.setHours(0,0,0,0);const hn=new Date(xt);hn.setDate(hn.getDate()+7);const On=ap(xt),ms=ap(hn);if(Ie.some(Me=>Me>=On&&Me<ms))Re++;else{if(Dt>0)break;break}Le.setDate(Le.getDate()-7)}}ee||je(Re);let De=0;for(let Be=0;Be<30;Be++){const Le=new Date;Le.setDate(Le.getDate()-Be);const Dt=ap(Le);try{const xt=await Qt(on(dt(ge,"habitLogs"),Ut("clientId","==",s),Ut("date","==",Dt)));if(xt.empty)break;{const lt=xt.docs[0].data().habits||{};if(Object.values(lt).filter(Boolean).length>=E5)De++;else break}}catch{break}}ee||ke(De);try{const Be=await _s(ze(ge,"coreBuddyBadges",s));if(!ee&&Be.exists()){const Le=Be.data().earned||[];He(new Set(Le.map(Dt=>Dt.id)))}}catch(Be){console.error("Error loading buddy badges:",Be)}}catch(C){console.error("Error loading buddy stats:",C)}finally{ee||Ne(!1)}})(),()=>{ee=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const ee=i.id;(async()=>{try{const[C,ne,Re]=await Promise.all([Qt(on(dt(ge,"buddies"),Ut("user1","==",ee))),Qt(on(dt(ge,"buddies"),Ut("user2","==",ee))),Qt(dt(ge,"clients"))]),Ie=new Set;[...C.docs,...ne.docs].forEach(Be=>{const Le=Be.data();Ie.add(Le.user1===ee?Le.user2:Le.user1)});const De={};Re.docs.forEach(Be=>{De[Be.id]=Be.data()}),Et(Array.from(Ie).filter(Be=>De[Be]).map(Be=>({id:Be,name:De[Be].name,photoURL:De[Be].photoURL||null})))}catch(C){console.error("Error loading buddies for mentions:",C)}})()},[i]);const yt=async(ee,C,ne={})=>{if(!(!i||ee===i.id))try{await or(dt(ge,"notifications"),{toId:ee,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:C,read:!1,createdAt:xs(),...ne})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&it("Notifications blocked  check Firestore rules","error")}},gt=async()=>{Y(!0);try{const ee=`${i.id}_${s}`;await Xn(ze(ge,"buddyRequests",ee),{fromId:i.id,toId:s,status:"pending",createdAt:xs()}),await yt(s,"buddy_request"),k("pending_out"),I(ee),it("Buddy request sent!","success")}catch(ee){console.error(ee),it("Failed to send request","error")}finally{Y(!1)}},wt=async()=>{if(T){Y(!0);try{const ee=ip(i.id,s);await Xn(ze(ge,"buddies",ee),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:xs()}),await ar(ze(ge,"buddyRequests",T)),await yt(s,"buddy_accept"),k("buddy"),it("Buddy added!","success")}catch(ee){console.error(ee),it("Failed to accept","error")}finally{Y(!1)}}},Bt=async()=>{if(T){Y(!0);try{await ar(ze(ge,"buddyRequests",T)),k("none"),it(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ee){console.error(ee),it("Failed","error")}finally{Y(!1)}}},fs=async()=>{Y(!0);try{const ee=ip(i.id,s);await ar(ze(ge,"buddies",ee)),k("none"),Rt(!1),it("Buddy removed","info")}catch(ee){console.error(ee),it("Failed to remove","error")}finally{Y(!1)}},sn=w.useCallback(async()=>{if(s){M(!0);try{const C=(await Qt(on(dt(ge,"posts"),Ut("authorId","==",s)))).docs.map(ne=>({id:ne.id,...ne.data()})).sort((ne,Re)=>{const Ie=ne.createdAt?.toDate?.()||new Date(0);return(Re.createdAt?.toDate?.()||new Date(0))-Ie}).slice(0,30);if(we(C),i){const ne=await Qt(on(dt(ge,"postLikes"),Ut("userId","==",i.id)));L(new Set(ne.docs.map(Re=>Re.data().postId)))}}catch(ee){console.error("Error loading journey:",ee)}finally{M(!1)}}},[s,i]);w.useEffect(()=>{!H&&y&&sn()},[H,y,sn]);const Zn=async ee=>{if(window.confirm("Delete this post?"))try{await ar(ze(ge,"posts",ee)),we(C=>C.filter(ne=>ne.id!==ee)),it("Post deleted","info")}catch(C){console.error("Delete error:",C),it("Failed to delete","error")}},Fn=async ee=>{if(!i)return;const C=i.id,ne=`${ee}_${C}`,Re=E.has(ee),Ie=new Set(E);Re?Ie.delete(ee):Ie.add(ee),L(Ie),we(De=>De.map(Be=>Be.id===ee?{...Be,likeCount:Math.max(0,(Be.likeCount||0)+(Re?-1:1))}:Be));try{if(Re)await ar(ze(ge,"postLikes",ne)),await zn(ze(ge,"posts",ee),{likeCount:fi(-1)});else{await Xn(ze(ge,"postLikes",ne),{postId:ee,userId:C,createdAt:xs()}),await zn(ze(ge,"posts",ee),{likeCount:fi(1)});const De=pe.find(Be=>Be.id===ee);De&&yt(De.authorId,"like",{postId:ee})}}catch(De){console.error("Like error:",De),sn()}},Ln=async ee=>{try{const ne=(await Qt(on(dt(ge,"postComments"),Ut("postId","==",ee)))).docs.map(Re=>({id:Re.id,...Re.data()})).sort((Re,Ie)=>{const De=Re.createdAt?.toDate?.()||new Date(0),Be=Ie.createdAt?.toDate?.()||new Date(0);return De-Be}).slice(0,50);A(Re=>({...Re,[ee]:ne}))}catch(C){console.error("Error loading comments:",C)}},Pn=ee=>{const C=new Set(U);C.has(ee)?C.delete(ee):(C.add(ee),D[ee]||Ln(ee)),P(C)},un=(ee,C)=>{const ne=ee.match(/@(\w*)$/);if(ne){Tt(!0),le(C);const Re=qt.filter(Ie=>Ie.name&&Ie.name.toLowerCase().includes(ne[1].toLowerCase())).slice(0,5);Ht(Re)}else Tt(!1),Ht([])},Wt=(ee,C)=>{const Re=(Pe[C]||"").replace(/@\w*$/,`@${ee.name} `);st(Ie=>({...Ie,[C]:Re})),Tt(!1),Ht([])},Ct=(ee,C)=>{st(ne=>({...ne,[ee]:C})),un(C,ee)},It=async ee=>{const C=(Pe[ee]||"").trim();if(!(!C||!i)){Te(ne=>({...ne,[ee]:!0}));try{await or(dt(ge,"postComments"),{postId:ee,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:C,createdAt:xs()}),await zn(ze(ge,"posts",ee),{commentCount:fi(1)});const ne=pe.find(Ie=>Ie.id===ee);ne&&yt(ne.authorId,"comment",{postId:ee});const Re=C.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Re){const Ie=new Set;Re.forEach(De=>{const Be=De.slice(1).trim(),Le=qt.find(Dt=>Dt.name&&Dt.name.toLowerCase()===Be.toLowerCase());Le&&!Ie.has(Le.id)&&(Ie.add(Le.id),yt(Le.id,"mention",{postId:ee}))})}st(Ie=>({...Ie,[ee]:""})),we(Ie=>Ie.map(De=>De.id===ee?{...De,commentCount:(De.commentCount||0)+1}:De)),await Ln(ee)}catch(ne){console.error("Comment error:",ne),it("Failed to comment","error")}finally{Te(ne=>({...ne,[ee]:!1}))}}};return l||H||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(nl,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>Rt(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&ln(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:yh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:gt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Bt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:wt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Bt,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),qe?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:We}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ce,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Se>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Se," day",Se!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const ee=Jr.filter(C=>Ve.has(C.id));return ee.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[ee.length,"/",Jr.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:ee.map(C=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Je(C),children:[a.jsx("img",{src:C.img,alt:C.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:C.name})]},C.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),ye?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):pe.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:pe.map(ee=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:ee.authorPhotoURL?a.jsx("img",{src:ee.authorPhotoURL,alt:""}):a.jsx("span",{children:yh(ee.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:ee.authorName}),a.jsx("span",{className:"journey-post-time",children:ex(ee.createdAt)})]}),ee.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Zn(ee.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ee.type==="workout_summary"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),!ee.metadata.stats?.length&&ee.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ee.type==="badge_earned"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const C=Jr.find(ne=>ne.id===ee.metadata.badgeId);return C?.img?a.jsx("img",{src:C.img,alt:ee.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:ee.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ee.type==="habits_summary"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),ee.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[ee.content&&a.jsx("p",{className:"journey-post-content",children:ee.content}),ee.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:ee.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${E.has(ee.id)?" liked":""}`,onClick:()=>Fn(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(ee.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:ee.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${U.has(ee.id)?" active":""}`,onClick:()=>Pn(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:ee.commentCount||0})]})]}),U.has(ee.id)&&a.jsxs("div",{className:"journey-comments",children:[D[ee.id]?.length>0?D[ee.id].map(C=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>g(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:yh(C.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:C.authorName}),a.jsx("span",{className:"journey-comment-text",children:C.content})]}),a.jsx("span",{className:"journey-comment-time",children:ex(C.createdAt)})]})]},C.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Pe[ee.id]||"",onChange:C=>Ct(ee.id,C.target.value),onKeyDown:C=>{C.key==="Enter"&&It(ee.id)},maxLength:300}),pn&&ut===ee.id&&pt.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:pt.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>Wt(C,ee.id),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:yh(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),a.jsx("button",{onClick:()=>It(ee.id),disabled:!(Pe[ee.id]||"").trim()||Z[ee.id],children:Z[ee.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ee.id))})]})]}),a.jsx(ni,{active:"buddies"}),Sn&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>ln(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),Qe&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Je(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:ee=>ee.stopPropagation(),children:[a.jsx("img",{src:Qe.img,alt:Qe.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Qe.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Qe.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Je(null),children:"Close"})]})}),$t&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>Rt(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:ee=>ee.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>Rt(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:fs,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),te&&a.jsxs("div",{className:`toast-notification ${te.type}`,children:[a.jsx("span",{className:"toast-icon",children:te.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):te.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:te.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ni,{active:"buddies"})]})}const op=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],tx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function S5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function C5(){const s=Zs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Pr(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[g,y]=w.useState(0),[p,b]=w.useState(0),[k,T]=w.useState(null),[I,H]=w.useState(!1),K=w.useRef(null),[B,Y]=w.useState(()=>{const D=e?.dashboardWidgets;return D&&Array.isArray(D)?D:tx.filter(A=>A.defaultOn).map(A=>A.id)}),[te,Q]=w.useState(!1),[pe,we]=w.useState(!1),[ye,M]=w.useState(null);w.useEffect(()=>{e?.photoURL&&T(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const D=()=>{const Pe=new Date,st=new Date(Pe);st.setHours(23,59,59,999);const Z=st-Pe;d({hours:Math.floor(Z/36e5),minutes:Math.floor(Z%36e5/6e4),seconds:Math.floor(Z%6e4/1e3)}),y(60-Math.floor(Z%6e4/1e3))};D();const A=setInterval(D,1e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{const D=setInterval(()=>b(A=>(A+1)%op.length),8e3);return()=>clearInterval(D)},[]);const E=async D=>{const A=D.target.files?.[0];if(!(!A||!e?.id)){H(!0);try{const Pe=ca(ua,`profilePhotos/${e.id}`);await pu(Pe,A);const st=await ro(Pe);await zn(ze(ge,"clients",e.id),{photoURL:st}),T(st),i({photoURL:st})}catch(Pe){console.error("Photo upload error:",Pe)}finally{H(!1)}}},L=D=>{we(!1),Y(A=>A.includes(D)?A.filter(Pe=>Pe!==D):[...A,D])},U=(D,A)=>{we(!1),Y(Pe=>{const st=Pe.indexOf(D);if(st<0)return Pe;const Z=st+A;if(Z<0||Z>=Pe.length)return Pe;const Te=[...Pe];return[Te[st],Te[Z]]=[Te[Z],Te[st]],Te})},P=async()=>{Q(!0),M(null);try{const D=e||await l();if(!D?.id){M("Could not find your profile. Try refreshing."),Q(!1);return}await zn(ze(ge,"clients",D.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),we(!0)}catch(D){console.error("Save config error:",D),M("Save failed  please try again.")}finally{Q(!1)}};return a.jsx(nl,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Ej.map((D,A)=>a.jsx("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,className:`bldr-tick ${A<g?"elapsed":"remaining"}`,strokeWidth:D.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>K.current?.click(),children:[a.jsx("img",{src:k||"/Logo.webp",alt:k?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${I?" uploading":""}`,children:I?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:K,type:"file",accept:"image/*",onChange:E,style:{display:"none"}})]}),!k&&!I&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>K.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[op[p].text," ",a.jsx("strong",{children:op[p].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:tx.map(D=>{const A=B.includes(D.id),Pe=B.indexOf(D.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:S5(D.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:D.label}),a.jsx("div",{className:"bldr-widget-desc",children:D.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>U(D.id,-1),disabled:Pe===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Pe+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>U(D.id,1),disabled:Pe===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>L(D.id),"aria-label":A?`Remove ${D.label}`:`Add ${D.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},D.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${pe?" saved":""}`,onClick:P,disabled:te||pe,children:te?"Saving...":pe?"Saved":"Save Dashboard"}),ye&&a.jsx("p",{className:"bldr-save-error",children:ye}),pe&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(ni,{active:"home"})]})})}const Tj="@firebase/installations",g0="0.6.19";const Sj=1e4,Cj=`w:${g0}`,Nj="FIS_v2",N5="https://firebaseinstallations.googleapis.com/v1",A5=3600*1e3,R5="installations",I5="Installations";const D5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Go=new Yo(R5,I5,D5);function Aj(s){return s instanceof bi&&s.code.includes("request-failed")}function Rj({projectId:s}){return`${N5}/projects/${s}/installations`}function Ij(s){return{token:s.token,requestStatus:2,expiresIn:L5(s.expiresIn),creationTime:Date.now()}}async function Dj(s,e){const i=(await e.json()).error;return Go.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Mj({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function M5(s,{refreshToken:e}){const t=Mj(s);return t.append("Authorization",P5(e)),t}async function Lj(s){const e=await s();return e.status>=500&&e.status<600?s():e}function L5(s){return Number(s.replace("s","000"))}function P5(s){return`${Nj} ${s}`}async function O5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Rj(s),l=Mj(s),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={fid:t,authVersion:Nj,appId:s.appId,sdkVersion:Cj},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Lj(()=>fetch(i,g));if(y.ok){const p=await y.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:Ij(p.authToken)}}else throw await Dj("Create Installation",y)}function Pj(s){return new Promise(e=>{setTimeout(e,s)})}function V5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const U5=/^[cdef][\w-]{21}$/,Kp="";function B5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=z5(s);return U5.test(t)?t:Kp}catch{return Kp}}function z5(s){return V5(s).substr(0,22)}function Nf(s){return`${s.appName}!${s.appId}`}const Oj=new Map;function Vj(s,e){const t=Nf(s);Uj(t,e),F5(t,e)}function Uj(s,e){const t=Oj.get(s);if(t)for(const i of t)i(e)}function F5(s,e){const t=H5();t&&t.postMessage({key:s,fid:e}),q5()}let Oo=null;function H5(){return!Oo&&"BroadcastChannel"in self&&(Oo=new BroadcastChannel("[Firebase] FID Change"),Oo.onmessage=s=>{Uj(s.data.key,s.data.fid)}),Oo}function q5(){Oj.size===0&&Oo&&(Oo.close(),Oo=null)}const $5="firebase-installations-database",W5=1,Ko="firebase-installations-store";let lp=null;function p0(){return lp||(lp=sf($5,W5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ko)}})),lp}async function Zh(s,e){const t=Nf(s),l=(await p0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&Vj(s,e.fid),e}async function Bj(s){const e=Nf(s),i=(await p0()).transaction(Ko,"readwrite");await i.objectStore(Ko).delete(e),await i.done}async function Af(s,e){const t=Nf(s),l=(await p0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t),g=e(d);return g===void 0?await u.delete(t):await u.put(g,t),await l.done,g&&(!d||d.fid!==g.fid)&&Vj(s,g.fid),g}async function y0(s){let e;const t=await Af(s.appConfig,i=>{const l=G5(i),u=K5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Kp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function G5(s){const e=s||{fid:B5(),registrationStatus:0};return zj(e)}function K5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Go.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Y5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Q5(s)}:{installationEntry:e}}async function Y5(s,e){try{const t=await O5(s,e);return Zh(s.appConfig,t)}catch(t){throw Aj(t)&&t.customData.serverCode===409?await Bj(s.appConfig):await Zh(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Q5(s){let e=await nx(s.appConfig);for(;e.registrationStatus===1;)await Pj(100),e=await nx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await y0(s);return i||t}return e}function nx(s){return Af(s,e=>{if(!e)throw Go.create("installation-not-found");return zj(e)})}function zj(s){return X5(s)?{fid:s.fid,registrationStatus:0}:s}function X5(s){return s.registrationStatus===1&&s.registrationTime+Sj<Date.now()}async function J5({appConfig:s,heartbeatServiceProvider:e},t){const i=Z5(s,t),l=M5(s,t),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={installation:{sdkVersion:Cj,appId:s.appId}},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Lj(()=>fetch(i,g));if(y.ok){const p=await y.json();return Ij(p)}else throw await Dj("Generate Auth Token",y)}function Z5(s,{fid:e}){return`${Rj(s)}/${e}/authTokens:generate`}async function v0(s,e=!1){let t;const i=await Af(s.appConfig,u=>{if(!Fj(u))throw Go.create("not-registered");const d=u.authToken;if(!e&&nL(d))return u;if(d.requestStatus===1)return t=eL(s,e),u;{if(!navigator.onLine)throw Go.create("app-offline");const g=rL(u);return t=tL(s,g),g}});return t?await t:i.authToken}async function eL(s,e){let t=await sx(s.appConfig);for(;t.authToken.requestStatus===1;)await Pj(100),t=await sx(s.appConfig);const i=t.authToken;return i.requestStatus===0?v0(s,e):i}function sx(s){return Af(s,e=>{if(!Fj(e))throw Go.create("not-registered");const t=e.authToken;return iL(t)?{...e,authToken:{requestStatus:0}}:e})}async function tL(s,e){try{const t=await J5(s,e),i={...e,authToken:t};return await Zh(s.appConfig,i),t}catch(t){if(Aj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Bj(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await Zh(s.appConfig,i)}throw t}}function Fj(s){return s!==void 0&&s.registrationStatus===2}function nL(s){return s.requestStatus===2&&!sL(s)}function sL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+A5}function rL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function iL(s){return s.requestStatus===1&&s.requestTime+Sj<Date.now()}async function aL(s){const e=s,{installationEntry:t,registrationPromise:i}=await y0(e);return i?i.catch(console.error):v0(e).catch(console.error),t.fid}async function oL(s,e=!1){const t=s;return await lL(t),(await v0(t,e)).token}async function lL(s){const{registrationPromise:e}=await y0(s);e&&await e}function cL(s){if(!s||!s.options)throw cp("App Configuration");if(!s.name)throw cp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw cp(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function cp(s){return Go.create("missing-app-config-values",{valueName:s})}const Hj="installations",uL="installations-internal",dL=s=>{const e=s.getProvider("app").getImmediate(),t=cL(e),i=Qo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},hL=s=>{const e=s.getProvider("app").getImmediate(),t=Qo(e,Hj).getImmediate();return{getId:()=>aL(t),getToken:l=>oL(t,l)}};function fL(){pi(new ei(Hj,dL,"PUBLIC")),pi(new ei(uL,hL,"PRIVATE"))}fL();xr(Tj,g0);xr(Tj,g0,"esm2020");const mL="/firebase-messaging-sw.js",gL="/firebase-cloud-messaging-push-scope",qj="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",pL="https://fcmregistrations.googleapis.com/v1",$j="google.c.a.c_id",yL="google.c.a.c_l",vL="google.c.a.ts",bL="google.c.a.e",rx=1e4;var ix;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ix||(ix={}));var Cu;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Cu||(Cu={}));function ia(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function wL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const up="fcm_token_details_db",xL=5,ax="fcm_token_object_Store";async function _L(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(up))return null;let e=null;return(await sf(up,xL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(ax))return;const g=d.objectStore(ax),y=await g.index("fcmSenderId").get(s);if(await g.clear(),!!y){if(l===2){const p=y;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:ia(p.vapidKey)}}}else if(l===3){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}else if(l===4){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}}}})).close(),await Pg(up),await Pg("fcm_vapid_details_db"),await Pg("undefined"),kL(e)?e:null}function kL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const jL="firebase-messaging-database",EL=1,Nu="firebase-messaging-store";let dp=null;function Wj(){return dp||(dp=sf(jL,EL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Nu)}})),dp}async function TL(s){const e=Gj(s),i=await(await Wj()).transaction(Nu).objectStore(Nu).get(e);if(i)return i;{const l=await _L(s.appConfig.senderId);if(l)return await b0(s,l),l}}async function b0(s,e){const t=Gj(s),l=(await Wj()).transaction(Nu,"readwrite");return await l.objectStore(Nu).put(e,t),await l.done,e}function Gj({appConfig:s}){return s.appId}const SL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dr=new Yo("messaging","Messaging",SL);async function CL(s,e){const t=await x0(s),i=Kj(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(w0(s.appConfig),l)).json()}catch(d){throw dr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-subscribe-no-token");return u.token}async function NL(s,e){const t=await x0(s),i=Kj(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${w0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw dr.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-update-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-update-no-token");return u.token}async function AL(s,e){const i={method:"DELETE",headers:await x0(s)};try{const u=await(await fetch(`${w0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw dr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw dr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function w0({projectId:s}){return`${pL}/projects/${s}/registrations`}async function x0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function Kj({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==qj&&(l.web.applicationPubKey=i),l}const RL=10080*60*1e3;async function IL(s){const e=await ML(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:ia(e.getKey("auth")),p256dh:ia(e.getKey("p256dh"))},i=await TL(s.firebaseDependencies);if(i){if(LL(i.subscriptionOptions,t))return Date.now()>=i.createTime+RL?DL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await AL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return ox(s.firebaseDependencies,t)}else return ox(s.firebaseDependencies,t)}async function DL(s,e){try{const t=await NL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await b0(s.firebaseDependencies,i),t}catch(t){throw t}}async function ox(s,e){const i={token:await CL(s,e),createTime:Date.now(),subscriptionOptions:e};return await b0(s,i),i.token}async function ML(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:wL(e)})}function LL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function lx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return PL(e,s),OL(e,s),VL(e,s),e}function PL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function OL(s,e){e.data&&(s.data=e.data)}function VL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function UL(s){return typeof s=="object"&&!!s&&$j in s}function BL(s){if(!s||!s.options)throw hp("App Configuration Object");if(!s.name)throw hp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw hp(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function hp(s){return dr.create("missing-app-config-values",{valueName:s})}class zL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=BL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function FL(s){try{s.swRegistration=await navigator.serviceWorker.register(mL,{scope:gL}),s.swRegistration.update().catch(()=>{}),await HL(s.swRegistration)}catch(e){throw dr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function HL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${rx} ms`)),rx),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function qL(s,e){if(!e&&!s.swRegistration&&await FL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw dr.create("invalid-sw-registration");s.swRegistration=e}}async function $L(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=qj)}async function Yj(s,e){if(!navigator)throw dr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw dr.create("permission-blocked");return await $L(s,e?.vapidKey),await qL(s,e?.serviceWorkerRegistration),IL(s)}async function WL(s,e,t){const i=GL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[$j],message_name:t[yL],message_time:t[vL],message_device_time:Math.floor(Date.now()/1e3)})}function GL(s){switch(s){case Cu.NOTIFICATION_CLICKED:return"notification_open";case Cu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function KL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Cu.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(lx(t)):s.onMessageHandler.next(lx(t)));const i=t.data;UL(i)&&i[bL]==="1"&&await WL(s,t.messageType,i)}const cx="@firebase/messaging",ux="0.12.23";const YL=s=>{const e=new zL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>KL(e,t)),e},QL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>Yj(e,i)}};function XL(){pi(new ei("messaging",YL,"PUBLIC")),pi(new ei("messaging-internal",QL,"PRIVATE")),xr(cx,ux),xr(cx,ux,"esm2020")}async function JL(){try{await Fx()}catch{return!1}return typeof window<"u"&&zx()&&MC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function ZL(s=Du()){return JL().then(e=>{if(!e)throw dr.create("unsupported-browser")},e=>{throw dr.create("indexed-db-unsupported")}),Qo(jn(s),"messaging").getImmediate()}async function eP(s,e){return s=jn(s),Yj(s,e)}XL();const tP="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let fp=null;function nP(){if(!fp)try{fp=ZL(Du())}catch{return null}return fp}function Yp(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function dx(){return"Notification"in window?Notification.permission:"denied"}function sP(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function rP(s){if(!Yp())return null;try{const e=await Notification.requestPermission(),t=nP();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let g=1;g<=d;g++){try{const y=()=>eP(t,{vapidKey:tP,serviceWorkerRegistration:i});if(u=l?await sP(y):await y(),u)break}catch(y){console.warn(`Push getToken attempt ${g}/${d} failed:`,y)}g<d&&await new Promise(y=>setTimeout(y,1500*g))}return u&&s&&await zn(ze(ge,"clients",s),{fcmTokens:jD(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function iP(s,e){if(!(!e||!s))try{await zn(ze(ge,"clients",s),{fcmTokens:ED(e)})}catch(t){console.error("Token revoke failed:",t)}}const aP=[{key:"daily_morning",label:"Morning motivation",desc:"Daily 6 AM motivational nudge to start your day"},{key:"daily_evening",label:"Evening check-in",desc:"Daily 6 PM reminder to log your habits"},{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function oP(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Pr(),{isDark:u,toggleTheme:d,accent:g,setAccent:y,isMono:p,toggleMono:b}=Ui(),k=Zs(),[T,I]=w.useState(!1),[H,K]=w.useState(null),[B,Y]=w.useState(!1),[te,Q]=w.useState("default"),[pe,we]=w.useState({daily_morning:!0,daily_evening:!0,buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[ye,M]=w.useState(null),E=w.useCallback((P,D="info")=>{M({message:P,type:D}),setTimeout(()=>M(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&k("/")},[l,s,k]),w.useEffect(()=>{if(!e)return;const P=e.notificationPrefs;P&&we(A=>({...A,...P}));const D=e.fcmTokens||[];D.length>0&&(I(!0),K(D[D.length-1])),Q(dx())},[e]);const L=async()=>{if(e){Y(!0);try{if(T)H&&await iP(e.id,H),I(!1),K(null),t({fcmTokens:[]}),E("Push notifications disabled","info");else{if(!Yp()){E("Push notifications are not supported on this device","error");return}const P=await rP(e.id),D=dx();Q(D),P?(I(!0),K(P),t({fcmTokens:[...e.fcmTokens||[],P]}),E("Push notifications enabled!","success")):E(D==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":D==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(P){console.error("Push toggle failed:",P),E("Something went wrong  please try again","error")}finally{Y(!1)}}},U=async P=>{if(!e)return;const D={...pe,[P]:!pe[P]};we(D);try{await zn(ze(ge,"clients",e.id),{notificationPrefs:D}),t({notificationPrefs:D})}catch(A){console.error("Failed to save pref:",A),we(Pe=>({...Pe,[P]:!Pe[P]})),E("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"19",cy:"13.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),a.jsx("circle",{cx:"5",cy:"15.5",r:"2.5"}),a.jsx("circle",{cx:"11",cy:"19.5",r:"2.5"}),a.jsx("path",{d:"M12 2a10 10 0 0 0 0 20 2 2 0 0 0 2-2v-1a2 2 0 0 1 2-2h1a2 2 0 0 0 2-2 10 10 0 0 0-7-13z"})]}),"Accent Colour"]}),a.jsx("div",{className:"settings-accent-row",children:[{key:"red",color:"#B8313D",label:"Red"},{key:"orange",color:"#FF8533",label:"Orange"},{key:"blue",color:"#1AADFF",label:"Blue"},{key:"green",color:"#C1FF72",label:"Green"},{key:"purple",color:"#CB6CE6",label:"Purple"}].map(P=>a.jsxs("button",{className:`settings-accent-option${g===P.key?" active":""}`,onClick:()=>y(P.key),"aria-label":`${P.label} accent`,children:[a.jsx("span",{className:"settings-accent-dot",style:{background:P.color}}),a.jsx("span",{className:"settings-accent-label",children:P.label})]},P.key))}),a.jsxs("div",{className:"settings-row settings-mono-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Mono"}),a.jsx("span",{className:"settings-row-desc",children:"Black & white with frosted glass"})]}),a.jsx("button",{className:`settings-toggle${p?" on":""}`,onClick:b,"aria-label":"Toggle mono theme",children:a.jsx("span",{className:"settings-toggle-knob"})})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Yp()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${T?" on":""}${B?" loading":""}`,onClick:L,disabled:B,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),aP.map(P=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:P.label}),a.jsx("span",{className:"settings-row-desc",children:P.desc})]}),a.jsx("button",{className:`settings-toggle${pe[P.key]?" on":""}`,onClick:()=>U(P.key),"aria-label":`Toggle ${P.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},P.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),ye&&a.jsx("div",{className:`settings-toast ${ye.type}`,children:ye.message}),a.jsx(ni,{active:"home"})]})}const vh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function mp({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function hx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,g=2*Math.PI*d,y=g*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:g,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const fx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function lP(s,e,t){const i=t instanceof Ft?t:Ft.fromDate(new Date(t)),l=i.toDate().getTime(),u=Date.now(),d=async()=>{const g=on(dt(ge,"workoutLogs"),Ut("clientId","==",e));return(await Qt(g)).docs.filter(p=>{const b=p.data().completedAt;if(!b)return!1;const k=b.toDate?b.toDate().getTime():new Date(b).getTime();return k>=l&&k<=u})};switch(s.type){case"workouts":return(await d()).length;case"minutes":return(await d()).reduce((y,p)=>y+(p.data().duration||0),0);case"habits_perfect":{const g=i.toDate().toISOString().slice(0,10),y=new Date().toISOString().slice(0,10),p=on(dt(ge,"habitLogs"),Ut("clientId","==",e));return(await Qt(p)).docs.filter(k=>{const T=k.data().date;if(T<g||T>y)return!1;const I=k.data().habits||{};return Object.values(I).length>0&&Object.values(I).every(H=>H===!0)}).length}case"streak":{const g=await d(),y=new Set(g.map(T=>T.data().completedAt.toDate().toISOString().slice(0,10)));let p=0;const b=new Date(i.toDate()),k=new Date;for(;y.has(b.toISOString().slice(0,10))&&b<=k;)p++,b.setDate(b.getDate()+1);return p}default:return 0}}function cP(){const{currentUser:s,clientData:e,loading:t}=Pr(),{isDark:i,toggleTheme:l}=Ui(),{isPremium:u}=uc(),d=Zs(),[g,y]=w.useState(null),[p,b]=w.useState(null),[k,T]=w.useState(0),[I,H]=w.useState(0),[K,B]=w.useState(!0),[Y,te]=w.useState(!1),[Q,pe]=w.useState(null),[we,ye]=w.useState(null),[M,E]=w.useState(!1),[L,U]=w.useState(null),P=w.useCallback((Ne,We="info")=>{ye({message:Ne,type:We}),setTimeout(()=>ye(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const D=w.useCallback(async()=>{if(e){B(!0);try{const Ne=on(dt(ge,"userChallenges"),Ut("clientId","==",e.id),Ut("status","==","active")),We=await Qt(Ne);if(We.empty)y(null),b(null);else{const je=We.docs[0],Se={id:je.id,...je.data()},ke=vh.find(Ve=>Ve.id===Se.challengeId);if(Se.endDate.toDate()<new Date)await zn(ze(ge,"userChallenges",je.id),{status:"failed"}),y(null),b(null),P("Challenge expired  time ran out","error");else if(y(Se),b(ke),ke){const Ve=await lP(ke,e.id,Se.startDate);if(T(Ve),Ve>=ke.goal&&Se.status==="active"){if(await zn(ze(ge,"userChallenges",je.id),{status:"completed",completedAt:xs()}),E(!0),y(He=>He?{...He,status:"completed"}:null),!Se.badgeAwarded){const He=Jr.find(Qe=>Qe.id===ke.id);if(He)try{const Qe=ze(ge,"coreBuddyBadges",e.id),Je=await _s(Qe),$t=Je.exists()?Je.data().earned||[]:[];if(!$t.some(Rt=>Rt.id===He.id)){const Rt={id:He.id,earnedAt:new Date().toISOString()};Je.exists()?await zn(Qe,{earned:[...$t,Rt]}):await Xn(Qe,{earned:[Rt]})}await zn(ze(ge,"userChallenges",je.id),{badgeAwarded:!0}),await or(dt(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:He.name,badgeDesc:He.desc,badgeId:He.id},createdAt:xs(),likeCount:0,commentCount:0}),U(He)}catch(Qe){console.error("Badge award failed:",Qe)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:ke.name,challenge_type:ke.type,duration_days:ke.duration})}}}const V=on(dt(ge,"userChallenges"),Ut("clientId","==",e.id),Ut("status","==","completed")),ce=await Qt(V);H(ce.size)}catch(Ne){console.error("Failed to load challenges:",Ne)}finally{B(!1)}}},[e,P]);w.useEffect(()=>{D()},[D]);const A=async Ne=>{if(!(!e||Y)){te(!0);try{const We=vh.find(ke=>ke.id===Ne);if(!We)return;const V=on(dt(ge,"userChallenges"),Ut("clientId","==",e.id),Ut("status","==","active"));if(!(await Qt(V)).empty){pe(null),P("You already have an active challenge","info"),await D();return}const je=Ft.now(),Se=Ft.fromDate(new Date(Date.now()+We.duration*864e5));await or(dt(ge,"userChallenges"),{clientId:e.id,challengeId:Ne,startDate:je,endDate:Se,status:"active",completedAt:null,badgeAwarded:!1,createdAt:xs()}),pe(null),P(`${We.name} started  let's go!`,"success"),await D()}catch(We){console.error("Start challenge failed:",We),We?.code==="permission-denied"?P("Permission denied  please re-login and try again","error"):P("Something went wrong  try again","error")}finally{te(!1)}}},Pe=async()=>{if(!(!g||Y)){te(!0);try{await zn(ze(ge,"userChallenges",g.id),{status:"failed"}),y(null),b(null),T(0),pe(null),P("Challenge abandoned","info"),await D()}catch(Ne){console.error("Give up failed:",Ne),P("Something went wrong","error")}finally{te(!1)}}},st=g?.endDate?Math.max(0,Math.ceil((g.endDate.toDate()-new Date)/864e5)):0,Z=()=>{if(!p||!g)return"";const Ne=Math.max(1,Math.ceil((Date.now()-g.startDate.toDate())/864e5)),We=p.goal/p.duration*Ne;return k>=We*1.15?"Ahead":k>=We*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Te=g&&g.status==="active"&&p,qe=M||g&&g.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),K?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):qe?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(hx,{progress:p?.goal||1,goal:p?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:p?.name}),a.jsxs("p",{className:"ch-completed-count",children:[I+(M?1:0)," challenge",I!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{E(!1),y(null),b(null),D()},children:"Choose Next Challenge"})]}):Te?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(hx,{progress:k,goal:p.goal,label:p.type==="minutes"?"minutes":p.type==="streak"?"day streak":p.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:st}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${Z().toLowerCase().replace(" ","")}`,children:Z()})]}),a.jsx("h2",{className:"ch-active-name",children:p.name}),a.jsx("p",{className:"ch-active-desc",children:p.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>pe("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:vh.filter(Ne=>Ne.id!==p.id).map(Ne=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(mp,{icon:Ne.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description})]})]},Ne.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:vh.map(Ne=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?pe(Ne):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(mp,{icon:Ne.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Ne.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:fx[Ne.difficulty]},children:Ne.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Ne.id))})]})]}),Q&&Q!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&pe(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(mp,{icon:Q.icon,size:36})}),a.jsx("h2",{children:Q.name}),a.jsx("p",{children:Q.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[Q.duration," days"]}),a.jsx("span",{style:{color:fx[Q.difficulty]},children:Q.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>A(Q.id),disabled:Y,children:Y?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>pe(null),disabled:Y,children:"Cancel"})]})}),Q==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&pe(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Pe,disabled:Y,children:Y?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>pe(null),disabled:Y,children:"Keep Going"})]})}),a.jsx(Wl,{badge:L,onDismiss:()=>U(null)}),we&&a.jsx("div",{className:`ch-toast ch-toast-${we.type}`,children:we.message}),a.jsx(ni,{})]})}const uP={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},dP=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function hP(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState(new Set),[p,b]=w.useState({}),[k,T]=w.useState(!0),[I,H]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{T(!0);try{const Y=await _s(ze(ge,"coreBuddyBadges",t.id));if(Y.exists()){const te=Y.data().earned||[];y(new Set(te.map(pe=>pe.id)));const Q={};te.forEach(pe=>{Q[pe.id]=pe}),b(Q)}}catch(Y){console.error("Failed to load badges:",Y)}finally{T(!1)}})()},[t]);const K=dP.map(Y=>({key:Y,label:uP[Y],badges:Jr.filter(te=>te.category===Y)})).filter(Y=>Y.badges.length>0),B=Jr.filter(Y=>g.has(Y.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[B," / ",Jr.length," earned"]}),k?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):K.map(Y=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:Y.label}),a.jsx("div",{className:"bdg-grid",children:Y.badges.map(te=>{const Q=g.has(te.id);return a.jsxs("button",{className:`bdg-item${Q?" earned":" locked"}`,onClick:()=>H(te),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[te.img?a.jsx("img",{src:te.img,alt:te.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!Q&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:te.name})]},te.id)})})]},Y.key))]}),I&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>H(null),children:a.jsxs("div",{className:"bdg-modal",onClick:Y=>Y.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${g.has(I.id)?" earned":" locked"}`,children:I.img?a.jsx("img",{src:I.img,alt:I.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:I.name}),a.jsx("p",{className:"bdg-modal-desc",children:I.desc}),g.has(I.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",p[I.id]?.earnedAt?`  ${new Date(p[I.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>H(null),children:"Close"})]})}),a.jsx(ni,{active:"badges"})]})}const fP=w.lazy(()=>Js(()=>import("./Dashboard-CJRAfT5W.js"),__vite__mapDeps([0,1,2]))),mP=w.lazy(()=>Js(()=>import("./AddClient-BCLqqoLO.js"),__vite__mapDeps([3,4]))),gP=w.lazy(()=>Js(()=>import("./ClientDashboard-BOQf86iB.js"),__vite__mapDeps([5,1,6]))),pP=w.lazy(()=>Js(()=>import("./ClientForms-Bsv41HYl.js"),__vite__mapDeps([7,8,6]))),yP=w.lazy(()=>Js(()=>import("./ClientTools-CEKwz9dW.js"),__vite__mapDeps([9,10,6]))),vP=w.lazy(()=>Js(()=>import("./MacroCalculator-BNXVFpab.js"),__vite__mapDeps([11,10,6]))),bP=w.lazy(()=>Js(()=>import("./ProteinSnacks-BEkUQl9w.js"),__vite__mapDeps([12,10,6]))),wP=w.lazy(()=>Js(()=>import("./DailyMotivation-DoWN_xLN.js"),__vite__mapDeps([13,10,6]))),xP=w.lazy(()=>Js(()=>import("./CircuitDashboard-Be0OWpSk.js"),__vite__mapDeps([14,15]))),_P=w.lazy(()=>Js(()=>import("./CircuitBooking-7AIordHO.js"),__vite__mapDeps([16,17,15]))),kP=w.lazy(()=>Js(()=>import("./PersonalBests-zZZ3oIJK.js"),__vite__mapDeps([18,19,6]))),jP=w.lazy(()=>Js(()=>import("./Leaderboard-BI5ZDAd5.js"),__vite__mapDeps([20,21]))),EP=w.lazy(()=>Js(()=>import("./UpgradePage-DLW9N_ce.js"),__vite__mapDeps([22,23,24]))),TP=w.lazy(()=>Js(()=>import("./SignUp-BX5e6qsl.js"),[])),SP=w.lazy(()=>Js(()=>import("./Onboarding-DCbgIRL3.js"),__vite__mapDeps([25,23,26])));function CP({children:s}){const{pathname:e}=Vi();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function NP(){const s=Zs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function AP(){return a.jsx(JM,{children:a.jsx(XM,{children:a.jsx(s3,{children:a.jsxs(aC,{basename:"/login",children:[a.jsx(NP,{}),a.jsx(CP,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(LS,{children:[a.jsx(In,{path:"/",element:a.jsx(a3,{})}),a.jsx(In,{path:"/dashboard",element:a.jsx(fP,{})}),a.jsx(In,{path:"/add-client",element:a.jsx(mP,{})}),a.jsx(In,{path:"/client",element:a.jsx(gP,{})}),a.jsx(In,{path:"/client/forms",element:a.jsx(pP,{})}),a.jsx(In,{path:"/client/tools",element:a.jsx(yP,{})}),a.jsx(In,{path:"/client/tools/macros",element:a.jsx(vP,{})}),a.jsx(In,{path:"/client/tools/snacks",element:a.jsx(bP,{})}),a.jsx(In,{path:"/client/tools/motivation",element:a.jsx(wP,{})}),a.jsx(In,{path:"/client/personal-bests",element:a.jsx(kP,{})}),a.jsx(In,{path:"/client/circuit",element:a.jsx(xP,{})}),a.jsx(In,{path:"/client/circuit/booking",element:a.jsx(_P,{})}),a.jsx(In,{path:"/client/core-buddy",element:a.jsx(N3,{})}),a.jsx(In,{path:"/client/core-buddy/nutrition",element:a.jsx(mh,{feature:"nutrition",children:a.jsx(I3,{})})}),a.jsx(In,{path:"/client/core-buddy/workouts",element:a.jsx(p5,{})}),a.jsx(In,{path:"/client/core-buddy/consistency",element:a.jsx(mh,{feature:"consistency",children:a.jsx(_5,{})})}),a.jsx(In,{path:"/client/core-buddy/buddies",element:a.jsx(mh,{feature:"buddies",children:a.jsx(j5,{})})}),a.jsx(In,{path:"/client/core-buddy/builder",element:a.jsx(C5,{})}),a.jsx(In,{path:"/client/core-buddy/profile/:userId",element:a.jsx(T5,{})}),a.jsx(In,{path:"/client/core-buddy/settings",element:a.jsx(oP,{})}),a.jsx(In,{path:"/client/core-buddy/challenges",element:a.jsx(cP,{})}),a.jsx(In,{path:"/client/core-buddy/badges",element:a.jsx(hP,{})}),a.jsx(In,{path:"/client/leaderboard",element:a.jsx(mh,{feature:"leaderboard",children:a.jsx(jP,{})})}),a.jsx(In,{path:"/signup",element:a.jsx(TP,{})}),a.jsx(In,{path:"/onboarding",element:a.jsx(SP,{})}),a.jsx(In,{path:"/upgrade",element:a.jsx(EP,{})}),a.jsx(In,{path:"*",element:a.jsx(Sx,{to:"/",replace:!0})})]})})})]})})})})}LT.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(AP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{r3 as A,Wl as B,ni as C,IP as D,xs as E,nl as P,Ft as T,or as a,ar as b,dt as c,ge as d,ze as e,QA as f,Qt as g,t4 as h,Xn as i,a as j,_s as k,Pr as l,Ui as m,Zs as n,MP as o,Ej as p,on as q,w as r,LP as s,RP as t,zn as u,PP as v,Ut as w,Jh as x,uc as y,i3 as z};
