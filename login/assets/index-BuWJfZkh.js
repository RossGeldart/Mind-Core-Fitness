const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-LWqG7lpQ.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-CtL3dvYY.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-CV7rnNFW.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-BwWdsNxI.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-CHPvPomJ.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-6ifMeNLu.js","assets/ProteinSnacks-CT6FteU5.js","assets/DailyMotivation-DPpx9dt2.js","assets/CircuitDashboard-1Fs3_iTx.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-DLuF_m-p.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-DlFHLsFs.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-Cw4kEVV3.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-d4DWifsm.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-CAK2ljU4.js","assets/Onboarding-DvZF-mkH.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var jp={exports:{}},$c={};var qb;function Sj(){if(qb)return $c;qb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return $c.Fragment=e,$c.jsx=t,$c.jsxs=t,$c}var Hb;function Cj(){return Hb||(Hb=1,jp.exports=Sj()),jp.exports}var a=Cj(),Sp={exports:{}},xt={};var $b;function Nj(){if($b)return xt;$b=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),j=Symbol.iterator;function P(O){return O===null||typeof O!="object"?null:(O=j&&O[j]||O["@@iterator"],typeof O=="function"?O:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},W=Object.assign,z={};function H(O,te,be){this.props=O,this.context=te,this.refs=z,this.updater=be||F}H.prototype.isReactComponent={},H.prototype.setState=function(O,te){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,te,"setState")},H.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function G(){}G.prototype=H.prototype;function X(O,te,be){this.props=O,this.context=te,this.refs=z,this.updater=be||F}var de=X.prototype=new G;de.constructor=X,W(de,H.prototype),de.isPureReactComponent=!0;var _e=Array.isArray;function pe(){}var C={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function M(O,te,be){var Se=be.ref;return{$$typeof:s,type:O,key:te,ref:Se!==void 0?Se:null,props:be}}function V(O,te){return M(O.type,te,O.props)}function D(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function L(O){var te={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(be){return te[be]})}var R=/\/+/g;function Ie(O,te){return typeof O=="object"&&O!==null&&O.key!=null?L(""+O.key):te.toString(36)}function Ye(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(pe,pe):(O.status="pending",O.then(function(te){O.status==="pending"&&(O.status="fulfilled",O.value=te)},function(te){O.status==="pending"&&(O.status="rejected",O.reason=te)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function ee(O,te,be,Se,xe){var Ce=typeof O;(Ce==="undefined"||Ce==="boolean")&&(O=null);var Be=!1;if(O===null)Be=!0;else switch(Ce){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(O.$$typeof){case s:case e:Be=!0;break;case b:return Be=O._init,ee(Be(O._payload),te,be,Se,xe)}}if(Be)return xe=xe(O),Be=Se===""?"."+Ie(O,0):Se,_e(xe)?(be="",Be!=null&&(be=Be.replace(R,"$&/")+"/"),ee(xe,te,be,"",function(Qt){return Qt})):xe!=null&&(D(xe)&&(xe=V(xe,be+(xe.key==null||O&&O.key===xe.key?"":(""+xe.key).replace(R,"$&/")+"/")+Be)),te.push(xe)),1;Be=0;var Ve=Se===""?".":Se+":";if(_e(O))for(var Le=0;Le<O.length;Le++)Se=O[Le],Ce=Ve+Ie(Se,Le),Be+=ee(Se,te,be,Ce,xe);else if(Le=P(O),typeof Le=="function")for(O=Le.call(O),Le=0;!(Se=O.next()).done;)Se=Se.value,Ce=Ve+Ie(Se,Le++),Be+=ee(Se,te,be,Ce,xe);else if(Ce==="object"){if(typeof O.then=="function")return ee(Ye(O),te,be,Se,xe);throw te=String(O),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Be}function Ee(O,te,be){if(O==null)return O;var Se=[],xe=0;return ee(O,Se,"","",function(Ce){return te.call(be,Ce,xe++)}),Se}function Pe(O){if(O._status===-1){var te=O._result;te=te(),te.then(function(be){(O._status===0||O._status===-1)&&(O._status=1,O._result=be)},function(be){(O._status===0||O._status===-1)&&(O._status=2,O._result=be)}),O._status===-1&&(O._status=0,O._result=te)}if(O._status===1)return O._result.default;throw O._result}var Ne=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},se={map:Ee,forEach:function(O,te,be){Ee(O,function(){te.apply(this,arguments)},be)},count:function(O){var te=0;return Ee(O,function(){te++}),te},toArray:function(O){return Ee(O,function(te){return te})||[]},only:function(O){if(!D(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return xt.Activity=E,xt.Children=se,xt.Component=H,xt.Fragment=t,xt.Profiler=l,xt.PureComponent=X,xt.StrictMode=i,xt.Suspense=g,xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,xt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},xt.cache=function(O){return function(){return O.apply(null,arguments)}},xt.cacheSignal=function(){return null},xt.cloneElement=function(O,te,be){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Se=W({},O.props),xe=O.key;if(te!=null)for(Ce in te.key!==void 0&&(xe=""+te.key),te)!S.call(te,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&te.ref===void 0||(Se[Ce]=te[Ce]);var Ce=arguments.length-2;if(Ce===1)Se.children=be;else if(1<Ce){for(var Be=Array(Ce),Ve=0;Ve<Ce;Ve++)Be[Ve]=arguments[Ve+2];Se.children=Be}return M(O.type,xe,Se)},xt.createContext=function(O){return O={$$typeof:d,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:u,_context:O},O},xt.createElement=function(O,te,be){var Se,xe={},Ce=null;if(te!=null)for(Se in te.key!==void 0&&(Ce=""+te.key),te)S.call(te,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(xe[Se]=te[Se]);var Be=arguments.length-2;if(Be===1)xe.children=be;else if(1<Be){for(var Ve=Array(Be),Le=0;Le<Be;Le++)Ve[Le]=arguments[Le+2];xe.children=Ve}if(O&&O.defaultProps)for(Se in Be=O.defaultProps,Be)xe[Se]===void 0&&(xe[Se]=Be[Se]);return M(O,Ce,xe)},xt.createRef=function(){return{current:null}},xt.forwardRef=function(O){return{$$typeof:p,render:O}},xt.isValidElement=D,xt.lazy=function(O){return{$$typeof:b,_payload:{_status:-1,_result:O},_init:Pe}},xt.memo=function(O,te){return{$$typeof:y,type:O,compare:te===void 0?null:te}},xt.startTransition=function(O){var te=C.T,be={};C.T=be;try{var Se=O(),xe=C.S;xe!==null&&xe(be,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(pe,Ne)}catch(Ce){Ne(Ce)}finally{te!==null&&be.types!==null&&(te.types=be.types),C.T=te}},xt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},xt.use=function(O){return C.H.use(O)},xt.useActionState=function(O,te,be){return C.H.useActionState(O,te,be)},xt.useCallback=function(O,te){return C.H.useCallback(O,te)},xt.useContext=function(O){return C.H.useContext(O)},xt.useDebugValue=function(){},xt.useDeferredValue=function(O,te){return C.H.useDeferredValue(O,te)},xt.useEffect=function(O,te){return C.H.useEffect(O,te)},xt.useEffectEvent=function(O){return C.H.useEffectEvent(O)},xt.useId=function(){return C.H.useId()},xt.useImperativeHandle=function(O,te,be){return C.H.useImperativeHandle(O,te,be)},xt.useInsertionEffect=function(O,te){return C.H.useInsertionEffect(O,te)},xt.useLayoutEffect=function(O,te){return C.H.useLayoutEffect(O,te)},xt.useMemo=function(O,te){return C.H.useMemo(O,te)},xt.useOptimistic=function(O,te){return C.H.useOptimistic(O,te)},xt.useReducer=function(O,te,be){return C.H.useReducer(O,te,be)},xt.useRef=function(O){return C.H.useRef(O)},xt.useState=function(O){return C.H.useState(O)},xt.useSyncExternalStore=function(O,te,be){return C.H.useSyncExternalStore(O,te,be)},xt.useTransition=function(){return C.H.useTransition()},xt.version="19.2.4",xt}var Wb;function Xg(){return Wb||(Wb=1,Sp.exports=Nj()),Sp.exports}var w=Xg(),Cp={exports:{}},Wc={},Np={exports:{}},Ap={};var Gb;function Aj(){return Gb||(Gb=1,(function(s){function e(ee,Ee){var Pe=ee.length;ee.push(Ee);e:for(;0<Pe;){var Ne=Pe-1>>>1,se=ee[Ne];if(0<l(se,Ee))ee[Ne]=Ee,ee[Pe]=se,Pe=Ne;else break e}}function t(ee){return ee.length===0?null:ee[0]}function i(ee){if(ee.length===0)return null;var Ee=ee[0],Pe=ee.pop();if(Pe!==Ee){ee[0]=Pe;e:for(var Ne=0,se=ee.length,O=se>>>1;Ne<O;){var te=2*(Ne+1)-1,be=ee[te],Se=te+1,xe=ee[Se];if(0>l(be,Pe))Se<se&&0>l(xe,be)?(ee[Ne]=xe,ee[Se]=Pe,Ne=Se):(ee[Ne]=be,ee[te]=Pe,Ne=te);else if(Se<se&&0>l(xe,Pe))ee[Ne]=xe,ee[Se]=Pe,Ne=Se;else break e}}return Ee}function l(ee,Ee){var Pe=ee.sortIndex-Ee.sortIndex;return Pe!==0?Pe:ee.id-Ee.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var g=[],y=[],b=1,E=null,j=3,P=!1,F=!1,W=!1,z=!1,H=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function de(ee){for(var Ee=t(y);Ee!==null;){if(Ee.callback===null)i(y);else if(Ee.startTime<=ee)i(y),Ee.sortIndex=Ee.expirationTime,e(g,Ee);else break;Ee=t(y)}}function _e(ee){if(W=!1,de(ee),!F)if(t(g)!==null)F=!0,pe||(pe=!0,L());else{var Ee=t(y);Ee!==null&&Ye(_e,Ee.startTime-ee)}}var pe=!1,C=-1,S=5,M=-1;function V(){return z?!0:!(s.unstable_now()-M<S)}function D(){if(z=!1,pe){var ee=s.unstable_now();M=ee;var Ee=!0;try{e:{F=!1,W&&(W=!1,G(C),C=-1),P=!0;var Pe=j;try{t:{for(de(ee),E=t(g);E!==null&&!(E.expirationTime>ee&&V());){var Ne=E.callback;if(typeof Ne=="function"){E.callback=null,j=E.priorityLevel;var se=Ne(E.expirationTime<=ee);if(ee=s.unstable_now(),typeof se=="function"){E.callback=se,de(ee),Ee=!0;break t}E===t(g)&&i(g),de(ee)}else i(g);E=t(g)}if(E!==null)Ee=!0;else{var O=t(y);O!==null&&Ye(_e,O.startTime-ee),Ee=!1}}break e}finally{E=null,j=Pe,P=!1}Ee=void 0}}finally{Ee?L():pe=!1}}}var L;if(typeof X=="function")L=function(){X(D)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,Ie=R.port2;R.port1.onmessage=D,L=function(){Ie.postMessage(null)}}else L=function(){H(D,0)};function Ye(ee,Ee){C=H(function(){ee(s.unstable_now())},Ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ee){ee.callback=null},s.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ee?Math.floor(1e3/ee):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_next=function(ee){switch(j){case 1:case 2:case 3:var Ee=3;break;default:Ee=j}var Pe=j;j=Ee;try{return ee()}finally{j=Pe}},s.unstable_requestPaint=function(){z=!0},s.unstable_runWithPriority=function(ee,Ee){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Pe=j;j=ee;try{return Ee()}finally{j=Pe}},s.unstable_scheduleCallback=function(ee,Ee,Pe){var Ne=s.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?Ne+Pe:Ne):Pe=Ne,ee){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Pe+se,ee={id:b++,callback:Ee,priorityLevel:ee,startTime:Pe,expirationTime:se,sortIndex:-1},Pe>Ne?(ee.sortIndex=Pe,e(y,ee),t(g)===null&&ee===t(y)&&(W?(G(C),C=-1):W=!0,Ye(_e,Pe-Ne))):(ee.sortIndex=se,e(g,ee),F||P||(F=!0,pe||(pe=!0,L()))),ee},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(ee){var Ee=j;return function(){var Pe=j;j=Ee;try{return ee.apply(this,arguments)}finally{j=Pe}}}})(Ap)),Ap}var Kb;function Rj(){return Kb||(Kb=1,Np.exports=Aj()),Np.exports}var Rp={exports:{}},$s={};var Yb;function Ij(){if(Yb)return $s;Yb=1;var s=Xg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:g,containerInfo:y,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return $s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$s.createPortal=function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,b)},$s.flushSync=function(g){var y=d.T,b=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=b,i.d.f()}},$s.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},$s.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},$s.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,P=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:E,integrity:j,fetchPriority:P}):b==="script"&&i.d.X(g,{crossOrigin:E,integrity:j,fetchPriority:P,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},$s.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},$s.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin);i.d.L(g,b,{crossOrigin:E,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},$s.preloadModule=function(g,y){if(typeof g=="string")if(y){var b=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},$s.requestFormReset=function(g){i.d.r(g)},$s.unstable_batchedUpdates=function(g,y){return g(y)},$s.useFormState=function(g,y,b){return d.H.useFormState(g,y,b)},$s.useFormStatus=function(){return d.H.useHostTransitionStatus()},$s.version="19.2.4",$s}var Qb;function Mj(){if(Qb)return Rp.exports;Qb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rp.exports=Ij(),Rp.exports}var Xb;function Dj(){if(Xb)return Wc;Xb=1;var s=Rj(),e=Xg(),t=Mj();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var _=!1,T=f.child;T;){if(T===o){_=!0,o=f,c=m;break}if(T===c){_=!0,c=f,o=m;break}T=T.sibling}if(!_){for(T=m.child;T;){if(T===o){_=!0,o=m,c=f;break}if(T===c){_=!0,c=m,o=f;break}T=T.sibling}if(!_)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var E=Object.assign,j=Symbol.for("react.element"),P=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),X=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),_e=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var R=Symbol.for("react.client.reference");function Ie(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===R?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case W:return"Fragment";case H:return"Profiler";case z:return"StrictMode";case _e:return"Suspense";case pe:return"SuspenseList";case M:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case F:return"Portal";case X:return n.displayName||"Context";case G:return(n._context.displayName||"Context")+".Consumer";case de:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return r=n.displayName||null,r!==null?r:Ie(n.type)||"Memo";case S:r=n._payload,n=n._init;try{return Ie(n(r))}catch{}}return null}var Ye=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},Ne=[],se=-1;function O(n){return{current:n}}function te(n){0>se||(n.current=Ne[se],Ne[se]=null,se--)}function be(n,r){se++,Ne[se]=n.current,n.current=r}var Se=O(null),xe=O(null),Ce=O(null),Be=O(null);function Ve(n,r){switch(be(Ce,r),be(xe,n),be(Se,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?hb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=hb(r),n=fb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}te(Se),be(Se,n)}function Le(){te(Se),te(xe),te(Ce)}function Qt(n){n.memoizedState!==null&&be(Be,n);var r=Se.current,o=fb(r,n.type);r!==o&&(be(xe,n),be(Se,o))}function Dt(n){xe.current===n&&(te(Se),te(xe)),Be.current===n&&(te(Be),zc._currentValue=Pe)}var bn,gn;function Ut(n){if(bn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);bn=r&&r[1]||"",gn=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bn+n+gn}var gt=!1;function Lt(n,r){if(!n||gt)return"";gt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(he){var ce=he}Reflect.construct(n,[],ke)}else{try{ke.call()}catch(he){ce=he}n.call(ke.prototype)}}else{try{throw Error()}catch(he){ce=he}(ke=n())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(he){if(he&&ce&&typeof he.stack=="string")return[he.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),_=m[0],T=m[1];if(_&&T){var B=_.split(`
`),ie=T.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ie.length&&!ie[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===ie.length)for(c=B.length-1,f=ie.length-1;1<=c&&0<=f&&B[c]!==ie[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==ie[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==ie[f]){var ge=`
`+B[c].replace(" at new "," at ");return n.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",n.displayName)),ge}while(1<=c&&0<=f);break}}}finally{gt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Ut(o):""}function sn(n,r){switch(n.tag){case 26:case 27:case 5:return Ut(n.type);case 16:return Ut("Lazy");case 13:return n.child!==r&&r!==null?Ut("Suspense Fallback"):Ut("Suspense");case 19:return Ut("SuspenseList");case 0:case 15:return Lt(n.type,!1);case 11:return Lt(n.type.render,!1);case 1:return Lt(n.type,!0);case 31:return Ut("Activity");default:return""}}function dt(n){try{var r="",o=null;do r+=sn(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var At=Object.prototype.hasOwnProperty,oe=s.unstable_scheduleCallback,Xt=s.unstable_cancelCallback,pt=s.unstable_shouldYield,Rt=s.unstable_requestPaint,ze=s.unstable_now,kt=s.unstable_getCurrentPriorityLevel,Jt=s.unstable_ImmediatePriority,cn=s.unstable_UserBlockingPriority,wn=s.unstable_NormalPriority,Ss=s.unstable_LowPriority,Vn=s.unstable_IdlePriority,ls=s.log,Un=s.unstable_setDisableYieldValue,xn=null,Ct=null;function un(n){if(typeof ls=="function"&&Un(n),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(xn,n)}catch{}}var Ze=Math.clz32?Math.clz32:lt,Z=Math.log,je=Math.LN2;function lt(n){return n>>>=0,n===0?32:31-(Z(n)/je|0)|0}var yt=256,bt=262144,Xe=4194304;function et(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function it(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,_=n.pingedLanes;n=n.warmLanes;var T=c&134217727;return T!==0?(c=T&~m,c!==0?f=et(c):(_&=T,_!==0?f=et(_):o||(o=T&~n,o!==0&&(f=et(o))))):(T=c&~m,T!==0?f=et(T):_!==0?f=et(_):o||(o=c&~n,o!==0&&(f=et(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Ot(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function _n(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kn(){var n=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),n}function Kn(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function le(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Me(n,r,o,c,f,m){var _=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var T=n.entanglements,B=n.expirationTimes,ie=n.hiddenUpdates;for(o=_&~o;0<o;){var ge=31-Ze(o),ke=1<<ge;T[ge]=0,B[ge]=-1;var ce=ie[ge];if(ce!==null)for(ie[ge]=null,ge=0;ge<ce.length;ge++){var he=ce[ge];he!==null&&(he.lane&=-536870913)}o&=~ke}c!==0&&qe(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(_&~r))}function qe(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Ze(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function ct(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Ze(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function st(n,r){var o=r&-r;return o=(o&42)!==0?1:Kt(o),(o&(n.suspendedLanes|r))!==0?0:o}function Kt(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function rn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Zt(){var n=Ee.p;return n!==0?n:(n=window.event,n===void 0?32:Ob(n.type))}function Nt(n,r){var o=Ee.p;try{return Ee.p=n,r()}finally{Ee.p=o}}var Rn=Math.random().toString(36).slice(2),en="__reactFiber$"+Rn,En="__reactProps$"+Rn,Bn="__reactContainer$"+Rn,ur="__reactEvents$"+Rn,fi="__reactListeners$"+Rn,mi="__reactHandles$"+Rn,Qr="__reactResources$"+Rn,Cs="__reactMarker$"+Rn;function Js(n){delete n[en],delete n[En],delete n[ur],delete n[fi],delete n[mi]}function Yn(n){var r=n[en];if(r)return r;for(var o=n.parentNode;o;){if(r=o[Bn]||o[en]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=wb(n);n!==null;){if(o=n[en])return o;n=wb(n)}return r}n=o,o=n.parentNode}return null}function ns(n){if(n=n[en]||n[Bn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function $n(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Wn(n){var r=n[Qr];return r||(r=n[Qr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function dn(n){n[Cs]=!0}var Ds=new Set,cs={};function Fs(n,r){us(n,r),us(n+"Capture",r)}function us(n,r){for(cs[n]=r,n=0;n<r.length;n++)Ds.add(r[n])}var Zs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ds={},er={};function Di(n){return At.call(er,n)?!0:At.call(ds,n)?!1:Zs.test(n)?er[n]=!0:(ds[n]=!0,!1)}function I(n,r,o){if(Di(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function q(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function J(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function ae(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function We(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function $e(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(_){o=""+_,m.call(this,_)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(_){o=""+_},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Re(n){if(!n._valueTracker){var r=We(n)?"checked":"value";n._valueTracker=$e(n,r,""+n[r])}}function It(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=We(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function ht(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ln=/[\n"\\]/g;function In(n){return n.replace(Ln,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function qs(n,r,o,c,f,m,_,T){n.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?n.type=_:n.removeAttribute("type"),r!=null?_==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+ae(r)):n.value!==""+ae(r)&&(n.value=""+ae(r)):_!=="submit"&&_!=="reset"||n.removeAttribute("value"),r!=null?ws(n,_,ae(r)):o!=null?ws(n,_,ae(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.name=""+ae(T):n.removeAttribute("name")}function dr(n,r,o,c,f,m,_,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Re(n);return}o=o!=null?""+ae(o):"",r=r!=null?""+ae(r):o,T||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=T?n.checked:!!c,n.defaultChecked=!!c,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(n.name=_),Re(n)}function ws(n,r,o){r==="number"&&ht(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function tr(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+ae(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function ga(n,r,o){if(r!=null&&(r=""+ae(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+ae(o):""}function xr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Ye(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=ae(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),Re(n)}function Ns(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var ya=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Li(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||ya.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Xr(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Li(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Li(n,m,r[m])}function Dr(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jr(n){return xs.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function nr(){}var Oi=null;function Qn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var x=null,N=null;function U(n){var r=ns(n);if(r&&(n=r.stateNode)){var o=n[En]||null;e:switch(n=r.stateNode,r.type){case"input":if(qs(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+In(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[En]||null;if(!f)throw Error(i(90));qs(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&It(c)}break e;case"textarea":ga(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&tr(n,!!o.multiple,r,!1)}}}var K=!1;function Q(n,r,o){if(K)return n(r,o);K=!0;try{var c=n(r);return c}finally{if(K=!1,(x!==null||N!==null)&&(Pd(),x&&(r=x,n=N,N=x=null,U(r),n)))for(r=0;r<n.length;r++)U(n[r])}}function fe(n,r){var o=n.stateNode;if(o===null)return null;var c=o[En]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var me=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),De=!1;if(me)try{var Ae={};Object.defineProperty(Ae,"passive",{get:function(){De=!0}}),window.addEventListener("test",Ae,Ae),window.removeEventListener("test",Ae,Ae)}catch{De=!1}var Ge=null,at=null,Mt=null;function _s(){if(Mt)return Mt;var n,r=at,o=r.length,c,f="value"in Ge?Ge.value:Ge.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var _=o-n;for(c=1;c<=_&&r[o-c]===f[m-c];c++);return Mt=f.slice(n,1<c?1-c:void 0)}function rt(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function $t(){return!0}function tn(){return!1}function Je(n){function r(o,c,f,m,_){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=_,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(o=n[T],this[T]=o?o(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?$t:tn,this.isPropagationStopped=tn,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),r}var an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nn=Je(an),zn=E({},an,{view:0,detail:0}),ks=Je(zn),Mn,As,Hs,Pi=E({},zn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:va,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Hs&&(Hs&&n.type==="mousemove"?(Mn=n.screenX-Hs.screenX,As=n.screenY-Hs.screenY):As=Mn=0,Hs=n),Mn)},movementY:function(n){return"movementY"in n?n.movementY:As}}),uo=Je(Pi),Zr=E({},Pi,{dataTransfer:0}),$u=Je(Zr),Wu=E({},zn,{relatedTarget:0}),ho=Je(Wu),lc=E({},an,{animationName:0,elapsedTime:0,pseudoElement:0}),Gu=Je(lc),el=E({},an,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ku=Je(el),Yu=E({},an,{data:0}),gi=Je(Yu),Qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ju={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Ju[n])?!!r[n]:!1}function va(){return Zu}var sr=E({},zn,{key:function(n){if(n.key){var r=Qu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=rt(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Xu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:va,charCode:function(n){return n.type==="keypress"?rt(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?rt(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ed=Je(sr),td=E({},Pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vi=Je(td),h=E({},zn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:va}),v=Je(h),k=E({},an,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Je(k),ne=E({},Pi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=Je(ne),Oe=E({},an,{newState:0,oldState:0}),Et=Je(Oe),ss=[9,13,27,32],hn=me&&"CompositionEvent"in window,Fn=null;me&&"documentMode"in document&&(Fn=document.documentMode);var Lr=me&&"TextEvent"in window&&!Fn,yi=me&&(!hn||Fn&&8<Fn&&11>=Fn),ei=" ",ti=!1;function fo(n,r){switch(n){case"keyup":return ss.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var nl=!1;function XE(n,r){switch(n){case"compositionend":return tl(r);case"keypress":return r.which!==32?null:(ti=!0,ei);case"textInput":return n=r.data,n===ei&&ti?null:n;default:return null}}function JE(n,r){if(nl)return n==="compositionend"||!hn&&fo(n,r)?(n=_s(),Mt=at=Ge=null,nl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return yi&&r.locale!=="ko"?null:r.data;default:return null}}var ZE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!ZE[n.type]:r==="textarea"}function E0(n,r,o,c){x?N?N.push(c):N=[c]:x=c,r=Hd(r,"onChange"),0<r.length&&(o=new Nn("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var cc=null,uc=null;function eT(n){ab(n,0)}function nd(n){var r=$n(n);if(It(r))return n}function T0(n,r){if(n==="change")return r}var j0=!1;if(me){var Mf;if(me){var Df="oninput"in document;if(!Df){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),Df=typeof S0.oninput=="function"}Mf=Df}else Mf=!1;j0=Mf&&(!document.documentMode||9<document.documentMode)}function C0(){cc&&(cc.detachEvent("onpropertychange",N0),uc=cc=null)}function N0(n){if(n.propertyName==="value"&&nd(uc)){var r=[];E0(r,uc,n,Qn(n)),Q(eT,r)}}function tT(n,r,o){n==="focusin"?(C0(),cc=r,uc=o,cc.attachEvent("onpropertychange",N0)):n==="focusout"&&C0()}function nT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nd(uc)}function sT(n,r){if(n==="click")return nd(r)}function rT(n,r){if(n==="input"||n==="change")return nd(r)}function iT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var _r=typeof Object.is=="function"?Object.is:iT;function dc(n,r){if(_r(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!At.call(r,f)||!_r(n[f],r[f]))return!1}return!0}function A0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function R0(n,r){var o=A0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=A0(o)}}function I0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?I0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function M0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=ht(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=ht(n.document)}return r}function Lf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var aT=me&&"documentMode"in document&&11>=document.documentMode,sl=null,Of=null,hc=null,Pf=!1;function D0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||sl==null||sl!==ht(c)||(c=sl,"selectionStart"in c&&Lf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),hc&&dc(hc,c)||(hc=c,c=Hd(Of,"onSelect"),0<c.length&&(r=new Nn("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=sl)))}function mo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var rl={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionrun:mo("Transition","TransitionRun"),transitionstart:mo("Transition","TransitionStart"),transitioncancel:mo("Transition","TransitionCancel"),transitionend:mo("Transition","TransitionEnd")},Vf={},L0={};me&&(L0=document.createElement("div").style,"AnimationEvent"in window||(delete rl.animationend.animation,delete rl.animationiteration.animation,delete rl.animationstart.animation),"TransitionEvent"in window||delete rl.transitionend.transition);function po(n){if(Vf[n])return Vf[n];if(!rl[n])return n;var r=rl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in L0)return Vf[n]=r[o];return n}var O0=po("animationend"),P0=po("animationiteration"),V0=po("animationstart"),oT=po("transitionrun"),lT=po("transitionstart"),cT=po("transitioncancel"),U0=po("transitionend"),B0=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function ni(n,r){B0.set(n,r),Fs(r,[n])}var sd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Or=[],il=0,Bf=0;function rd(){for(var n=il,r=Bf=il=0;r<n;){var o=Or[r];Or[r++]=null;var c=Or[r];Or[r++]=null;var f=Or[r];Or[r++]=null;var m=Or[r];if(Or[r++]=null,c!==null&&f!==null){var _=c.pending;_===null?f.next=f:(f.next=_.next,_.next=f),c.pending=f}m!==0&&z0(o,f,m)}}function id(n,r,o,c){Or[il++]=n,Or[il++]=r,Or[il++]=o,Or[il++]=c,Bf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function zf(n,r,o,c){return id(n,r,o,c),ad(n)}function go(n,r){return id(n,null,null,r),ad(n)}function z0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Ze(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ad(n){if(50<Dc)throw Dc=0,Qm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var al={};function uT(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(n,r,o,c){return new uT(n,r,o,c)}function Ff(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ui(n,r){var o=n.alternate;return o===null?(o=kr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function F0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function od(n,r,o,c,f,m){var _=0;if(c=n,typeof n=="function")Ff(n)&&(_=1);else if(typeof n=="string")_=pj(n,o,Se.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case M:return n=kr(31,o,r,f),n.elementType=M,n.lanes=m,n;case W:return yo(o.children,f,m,r);case z:_=8,f|=24;break;case H:return n=kr(12,o,r,f|2),n.elementType=H,n.lanes=m,n;case _e:return n=kr(13,o,r,f),n.elementType=_e,n.lanes=m,n;case pe:return n=kr(19,o,r,f),n.elementType=pe,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case X:_=10;break e;case G:_=9;break e;case de:_=11;break e;case C:_=14;break e;case S:_=16,c=null;break e}_=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=kr(_,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function yo(n,r,o,c){return n=kr(7,n,c,r),n.lanes=o,n}function qf(n,r,o){return n=kr(6,n,null,r),n.lanes=o,n}function q0(n){var r=kr(18,null,null,0);return r.stateNode=n,r}function Hf(n,r,o){return r=kr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var H0=new WeakMap;function Pr(n,r){if(typeof n=="object"&&n!==null){var o=H0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:dt(r)},H0.set(n,r),r)}return{value:n,source:r,stack:dt(r)}}var ol=[],ll=0,ld=null,fc=0,Vr=[],Ur=0,ba=null,vi=1,bi="";function Bi(n,r){ol[ll++]=fc,ol[ll++]=ld,ld=n,fc=r}function $0(n,r,o){Vr[Ur++]=vi,Vr[Ur++]=bi,Vr[Ur++]=ba,ba=n;var c=vi;n=bi;var f=32-Ze(c)-1;c&=~(1<<f),o+=1;var m=32-Ze(r)+f;if(30<m){var _=f-f%5;m=(c&(1<<_)-1).toString(32),c>>=_,f-=_,vi=1<<32-Ze(r)+f|o<<f|c,bi=m+n}else vi=1<<m|o<<f|c,bi=n}function $f(n){n.return!==null&&(Bi(n,1),$0(n,1,0))}function Wf(n){for(;n===ld;)ld=ol[--ll],ol[ll]=null,fc=ol[--ll],ol[ll]=null;for(;n===ba;)ba=Vr[--Ur],Vr[Ur]=null,bi=Vr[--Ur],Vr[Ur]=null,vi=Vr[--Ur],Vr[Ur]=null}function W0(n,r){Vr[Ur++]=vi,Vr[Ur++]=bi,Vr[Ur++]=ba,vi=r.id,bi=r.overflow,ba=n}var Ls=null,On=null,Wt=!1,wa=null,Br=!1,Gf=Error(i(519));function xa(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mc(Pr(r,n)),Gf}function G0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[en]=n,r[En]=c,o){case"dialog":Vt("cancel",r),Vt("close",r);break;case"iframe":case"object":case"embed":Vt("load",r);break;case"video":case"audio":for(o=0;o<Oc.length;o++)Vt(Oc[o],r);break;case"source":Vt("error",r);break;case"img":case"image":case"link":Vt("error",r),Vt("load",r);break;case"details":Vt("toggle",r);break;case"input":Vt("invalid",r),dr(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Vt("invalid",r);break;case"textarea":Vt("invalid",r),xr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ub(r.textContent,o)?(c.popover!=null&&(Vt("beforetoggle",r),Vt("toggle",r)),c.onScroll!=null&&Vt("scroll",r),c.onScrollEnd!=null&&Vt("scrollend",r),c.onClick!=null&&(r.onclick=nr),r=!0):r=!1,r||xa(n,!0)}function K0(n){for(Ls=n.return;Ls;)switch(Ls.tag){case 5:case 31:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:Ls=Ls.return}}function cl(n){if(n!==Ls)return!1;if(!Wt)return K0(n),Wt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||dp(n.type,n.memoizedProps)),o=!o),o&&On&&xa(n),K0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));On=bb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));On=bb(n)}else r===27?(r=On,La(n.type)?(n=gp,gp=null,On=n):On=r):On=Ls?Fr(n.stateNode.nextSibling):null;return!0}function vo(){On=Ls=null,Wt=!1}function Kf(){var n=wa;return n!==null&&(pr===null?pr=n:pr.push.apply(pr,n),wa=null),n}function mc(n){wa===null?wa=[n]:wa.push(n)}var Yf=O(null),bo=null,zi=null;function _a(n,r,o){be(Yf,r._currentValue),r._currentValue=o}function Fi(n){n._currentValue=Yf.current,te(Yf)}function Qf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Xf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var _=f.child;m=m.firstContext;e:for(;m!==null;){var T=m;m=f;for(var B=0;B<r.length;B++)if(T.context===r[B]){m.lanes|=o,T=m.alternate,T!==null&&(T.lanes|=o),Qf(m.return,o,n),c||(_=null);break e}m=T.next}}else if(f.tag===18){if(_=f.return,_===null)throw Error(i(341));_.lanes|=o,m=_.alternate,m!==null&&(m.lanes|=o),Qf(_,o,n),_=null}else _=f.child;if(_!==null)_.return=f;else for(_=f;_!==null;){if(_===n){_=null;break}if(f=_.sibling,f!==null){f.return=_.return,_=f;break}_=_.return}f=_}}function ul(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var _=f.alternate;if(_===null)throw Error(i(387));if(_=_.memoizedProps,_!==null){var T=f.type;_r(f.pendingProps.value,_.value)||(n!==null?n.push(T):n=[T])}}else if(f===Be.current){if(_=f.alternate,_===null)throw Error(i(387));_.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(zc):n=[zc])}f=f.return}n!==null&&Xf(r,n,o,c),r.flags|=262144}function cd(n){for(n=n.firstContext;n!==null;){if(!_r(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function wo(n){bo=n,zi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Os(n){return Y0(bo,n)}function ud(n,r){return bo===null&&wo(n),Y0(n,r)}function Y0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},zi===null){if(n===null)throw Error(i(308));zi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else zi=zi.next=r;return o}var dT=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},hT=s.unstable_scheduleCallback,fT=s.unstable_NormalPriority,hs={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new dT,data:new Map,refCount:0}}function pc(n){n.refCount--,n.refCount===0&&hT(fT,function(){n.controller.abort()})}var gc=null,Zf=0,dl=0,hl=null;function mT(n,r){if(gc===null){var o=gc=[];Zf=0,dl=np(),hl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Zf++,r.then(Q0,Q0),r}function Q0(){if(--Zf===0&&gc!==null){hl!==null&&(hl.status="fulfilled");var n=gc;gc=null,dl=0,hl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function pT(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var X0=ee.S;ee.S=function(n,r){D1=ze(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&mT(n,r),X0!==null&&X0(n,r)};var xo=O(null);function em(){var n=xo.current;return n!==null?n:An.pooledCache}function dd(n,r){r===null?be(xo,xo.current):be(xo,r.pool)}function J0(){var n=em();return n===null?null:{parent:hs._currentValue,pool:n}}var fl=Error(i(460)),tm=Error(i(474)),hd=Error(i(542)),fd={then:function(){}};function Z0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function ev(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(nr,nr),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n;default:if(typeof r.status=="string")r.then(nr,nr);else{if(n=An,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n}throw ko=r,fl}}function _o(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ko=o,fl):o}}var ko=null;function tv(){if(ko===null)throw Error(i(459));var n=ko;return ko=null,n}function nv(n){if(n===fl||n===hd)throw Error(i(483))}var ml=null,yc=0;function md(n){var r=yc;return yc+=1,ml===null&&(ml=[]),ev(ml,n,r)}function vc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function pd(n,r){throw r.$$typeof===j?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function sv(n){function r(Y,$){if(n){var re=Y.deletions;re===null?(Y.deletions=[$],Y.flags|=16):re.push($)}}function o(Y,$){if(!n)return null;for(;$!==null;)r(Y,$),$=$.sibling;return null}function c(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function f(Y,$){return Y=Ui(Y,$),Y.index=0,Y.sibling=null,Y}function m(Y,$,re){return Y.index=re,n?(re=Y.alternate,re!==null?(re=re.index,re<$?(Y.flags|=67108866,$):re):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function _(Y){return n&&Y.alternate===null&&(Y.flags|=67108866),Y}function T(Y,$,re,we){return $===null||$.tag!==6?($=qf(re,Y.mode,we),$.return=Y,$):($=f($,re),$.return=Y,$)}function B(Y,$,re,we){var tt=re.type;return tt===W?ge(Y,$,re.props.children,we,re.key):$!==null&&($.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===S&&_o(tt)===$.type)?($=f($,re.props),vc($,re),$.return=Y,$):($=od(re.type,re.key,re.props,null,Y.mode,we),vc($,re),$.return=Y,$)}function ie(Y,$,re,we){return $===null||$.tag!==4||$.stateNode.containerInfo!==re.containerInfo||$.stateNode.implementation!==re.implementation?($=Hf(re,Y.mode,we),$.return=Y,$):($=f($,re.children||[]),$.return=Y,$)}function ge(Y,$,re,we,tt){return $===null||$.tag!==7?($=yo(re,Y.mode,we,tt),$.return=Y,$):($=f($,re),$.return=Y,$)}function ke(Y,$,re){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=qf(""+$,Y.mode,re),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case P:return re=od($.type,$.key,$.props,null,Y.mode,re),vc(re,$),re.return=Y,re;case F:return $=Hf($,Y.mode,re),$.return=Y,$;case S:return $=_o($),ke(Y,$,re)}if(Ye($)||L($))return $=yo($,Y.mode,re,null),$.return=Y,$;if(typeof $.then=="function")return ke(Y,md($),re);if($.$$typeof===X)return ke(Y,ud(Y,$),re);pd(Y,$)}return null}function ce(Y,$,re,we){var tt=$!==null?$.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return tt!==null?null:T(Y,$,""+re,we);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case P:return re.key===tt?B(Y,$,re,we):null;case F:return re.key===tt?ie(Y,$,re,we):null;case S:return re=_o(re),ce(Y,$,re,we)}if(Ye(re)||L(re))return tt!==null?null:ge(Y,$,re,we,null);if(typeof re.then=="function")return ce(Y,$,md(re),we);if(re.$$typeof===X)return ce(Y,$,ud(Y,re),we);pd(Y,re)}return null}function he(Y,$,re,we,tt){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return Y=Y.get(re)||null,T($,Y,""+we,tt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case P:return Y=Y.get(we.key===null?re:we.key)||null,B($,Y,we,tt);case F:return Y=Y.get(we.key===null?re:we.key)||null,ie($,Y,we,tt);case S:return we=_o(we),he(Y,$,re,we,tt)}if(Ye(we)||L(we))return Y=Y.get(re)||null,ge($,Y,we,tt,null);if(typeof we.then=="function")return he(Y,$,re,md(we),tt);if(we.$$typeof===X)return he(Y,$,re,ud($,we),tt);pd($,we)}return null}function Ke(Y,$,re,we){for(var tt=null,on=null,Qe=$,jt=$=0,zt=null;Qe!==null&&jt<re.length;jt++){Qe.index>jt?(zt=Qe,Qe=null):zt=Qe.sibling;var ln=ce(Y,Qe,re[jt],we);if(ln===null){Qe===null&&(Qe=zt);break}n&&Qe&&ln.alternate===null&&r(Y,Qe),$=m(ln,$,jt),on===null?tt=ln:on.sibling=ln,on=ln,Qe=zt}if(jt===re.length)return o(Y,Qe),Wt&&Bi(Y,jt),tt;if(Qe===null){for(;jt<re.length;jt++)Qe=ke(Y,re[jt],we),Qe!==null&&($=m(Qe,$,jt),on===null?tt=Qe:on.sibling=Qe,on=Qe);return Wt&&Bi(Y,jt),tt}for(Qe=c(Qe);jt<re.length;jt++)zt=he(Qe,Y,jt,re[jt],we),zt!==null&&(n&&zt.alternate!==null&&Qe.delete(zt.key===null?jt:zt.key),$=m(zt,$,jt),on===null?tt=zt:on.sibling=zt,on=zt);return n&&Qe.forEach(function(Ba){return r(Y,Ba)}),Wt&&Bi(Y,jt),tt}function ut(Y,$,re,we){if(re==null)throw Error(i(151));for(var tt=null,on=null,Qe=$,jt=$=0,zt=null,ln=re.next();Qe!==null&&!ln.done;jt++,ln=re.next()){Qe.index>jt?(zt=Qe,Qe=null):zt=Qe.sibling;var Ba=ce(Y,Qe,ln.value,we);if(Ba===null){Qe===null&&(Qe=zt);break}n&&Qe&&Ba.alternate===null&&r(Y,Qe),$=m(Ba,$,jt),on===null?tt=Ba:on.sibling=Ba,on=Ba,Qe=zt}if(ln.done)return o(Y,Qe),Wt&&Bi(Y,jt),tt;if(Qe===null){for(;!ln.done;jt++,ln=re.next())ln=ke(Y,ln.value,we),ln!==null&&($=m(ln,$,jt),on===null?tt=ln:on.sibling=ln,on=ln);return Wt&&Bi(Y,jt),tt}for(Qe=c(Qe);!ln.done;jt++,ln=re.next())ln=he(Qe,Y,jt,ln.value,we),ln!==null&&(n&&ln.alternate!==null&&Qe.delete(ln.key===null?jt:ln.key),$=m(ln,$,jt),on===null?tt=ln:on.sibling=ln,on=ln);return n&&Qe.forEach(function(jj){return r(Y,jj)}),Wt&&Bi(Y,jt),tt}function Sn(Y,$,re,we){if(typeof re=="object"&&re!==null&&re.type===W&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case P:e:{for(var tt=re.key;$!==null;){if($.key===tt){if(tt=re.type,tt===W){if($.tag===7){o(Y,$.sibling),we=f($,re.props.children),we.return=Y,Y=we;break e}}else if($.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===S&&_o(tt)===$.type){o(Y,$.sibling),we=f($,re.props),vc(we,re),we.return=Y,Y=we;break e}o(Y,$);break}else r(Y,$);$=$.sibling}re.type===W?(we=yo(re.props.children,Y.mode,we,re.key),we.return=Y,Y=we):(we=od(re.type,re.key,re.props,null,Y.mode,we),vc(we,re),we.return=Y,Y=we)}return _(Y);case F:e:{for(tt=re.key;$!==null;){if($.key===tt)if($.tag===4&&$.stateNode.containerInfo===re.containerInfo&&$.stateNode.implementation===re.implementation){o(Y,$.sibling),we=f($,re.children||[]),we.return=Y,Y=we;break e}else{o(Y,$);break}else r(Y,$);$=$.sibling}we=Hf(re,Y.mode,we),we.return=Y,Y=we}return _(Y);case S:return re=_o(re),Sn(Y,$,re,we)}if(Ye(re))return Ke(Y,$,re,we);if(L(re)){if(tt=L(re),typeof tt!="function")throw Error(i(150));return re=tt.call(re),ut(Y,$,re,we)}if(typeof re.then=="function")return Sn(Y,$,md(re),we);if(re.$$typeof===X)return Sn(Y,$,ud(Y,re),we);pd(Y,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,$!==null&&$.tag===6?(o(Y,$.sibling),we=f($,re),we.return=Y,Y=we):(o(Y,$),we=qf(re,Y.mode,we),we.return=Y,Y=we),_(Y)):o(Y,$)}return function(Y,$,re,we){try{yc=0;var tt=Sn(Y,$,re,we);return ml=null,tt}catch(Qe){if(Qe===fl||Qe===hd)throw Qe;var on=kr(29,Qe,null,Y.mode);return on.lanes=we,on.return=Y,on}}}var Eo=sv(!0),rv=sv(!1),ka=!1;function nm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ea(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ta(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(fn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ad(n),z0(n,null,o),r}return id(n,c,r,o),ad(n)}function bc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ct(n,o)}}function rm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var _={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=_:m=m.next=_,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var im=!1;function wc(){if(im){var n=hl;if(n!==null)throw n}}function xc(n,r,o,c){im=!1;var f=n.updateQueue;ka=!1;var m=f.firstBaseUpdate,_=f.lastBaseUpdate,T=f.shared.pending;if(T!==null){f.shared.pending=null;var B=T,ie=B.next;B.next=null,_===null?m=ie:_.next=ie,_=B;var ge=n.alternate;ge!==null&&(ge=ge.updateQueue,T=ge.lastBaseUpdate,T!==_&&(T===null?ge.firstBaseUpdate=ie:T.next=ie,ge.lastBaseUpdate=B))}if(m!==null){var ke=f.baseState;_=0,ge=ie=B=null,T=m;do{var ce=T.lane&-536870913,he=ce!==T.lane;if(he?(Bt&ce)===ce:(c&ce)===ce){ce!==0&&ce===dl&&(im=!0),ge!==null&&(ge=ge.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Ke=n,ut=T;ce=r;var Sn=o;switch(ut.tag){case 1:if(Ke=ut.payload,typeof Ke=="function"){ke=Ke.call(Sn,ke,ce);break e}ke=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=ut.payload,ce=typeof Ke=="function"?Ke.call(Sn,ke,ce):Ke,ce==null)break e;ke=E({},ke,ce);break e;case 2:ka=!0}}ce=T.callback,ce!==null&&(n.flags|=64,he&&(n.flags|=8192),he=f.callbacks,he===null?f.callbacks=[ce]:he.push(ce))}else he={lane:ce,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ge===null?(ie=ge=he,B=ke):ge=ge.next=he,_|=ce;if(T=T.next,T===null){if(T=f.shared.pending,T===null)break;he=T,T=he.next,he.next=null,f.lastBaseUpdate=he,f.shared.pending=null}}while(!0);ge===null&&(B=ke),f.baseState=B,f.firstBaseUpdate=ie,f.lastBaseUpdate=ge,m===null&&(f.shared.lanes=0),Aa|=_,n.lanes=_,n.memoizedState=ke}}function iv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function av(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)iv(o[n],r)}var pl=O(null),gd=O(0);function ov(n,r){n=Xi,be(gd,n),be(pl,r),Xi=n|r.baseLanes}function am(){be(gd,Xi),be(pl,pl.current)}function om(){Xi=gd.current,te(pl),te(gd)}var Er=O(null),zr=null;function ja(n){var r=n.alternate;be(rs,rs.current&1),be(Er,n),zr===null&&(r===null||pl.current!==null||r.memoizedState!==null)&&(zr=n)}function lm(n){be(rs,rs.current),be(Er,n),zr===null&&(zr=n)}function lv(n){n.tag===22?(be(rs,rs.current),be(Er,n),zr===null&&(zr=n)):Sa()}function Sa(){be(rs,rs.current),be(Er,Er.current)}function Tr(n){te(Er),zr===n&&(zr=null),te(rs)}var rs=O(0);function yd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mp(o)||pp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var qi=0,Tt=null,Tn=null,fs=null,vd=!1,gl=!1,To=!1,bd=0,_c=0,yl=null,gT=0;function Xn(){throw Error(i(321))}function cm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!_r(n[o],r[o]))return!1;return!0}function um(n,r,o,c,f,m){return qi=m,Tt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ee.H=n===null||n.memoizedState===null?$v:Tm,To=!1,m=o(c,f),To=!1,gl&&(m=uv(r,o,c,f)),cv(n),m}function cv(n){ee.H=Tc;var r=Tn!==null&&Tn.next!==null;if(qi=0,fs=Tn=Tt=null,vd=!1,_c=0,yl=null,r)throw Error(i(300));n===null||ms||(n=n.dependencies,n!==null&&cd(n)&&(ms=!0))}function uv(n,r,o,c){Tt=n;var f=0;do{if(gl&&(yl=null),_c=0,gl=!1,25<=f)throw Error(i(301));if(f+=1,fs=Tn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}ee.H=Wv,m=r(o,c)}while(gl);return m}function yT(){var n=ee.H,r=n.useState()[0];return r=typeof r.then=="function"?kc(r):r,n=n.useState()[0],(Tn!==null?Tn.memoizedState:null)!==n&&(Tt.flags|=1024),r}function dm(){var n=bd!==0;return bd=0,n}function hm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fm(n){if(vd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}vd=!1}qi=0,fs=Tn=Tt=null,gl=!1,_c=bd=0,yl=null}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?Tt.memoizedState=fs=n:fs=fs.next=n,fs}function is(){if(Tn===null){var n=Tt.alternate;n=n!==null?n.memoizedState:null}else n=Tn.next;var r=fs===null?Tt.memoizedState:fs.next;if(r!==null)fs=r,Tn=n;else{if(n===null)throw Tt.alternate===null?Error(i(467)):Error(i(310));Tn=n,n={memoizedState:Tn.memoizedState,baseState:Tn.baseState,baseQueue:Tn.baseQueue,queue:Tn.queue,next:null},fs===null?Tt.memoizedState=fs=n:fs=fs.next=n}return fs}function wd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kc(n){var r=_c;return _c+=1,yl===null&&(yl=[]),n=ev(yl,n,r),r=Tt,(fs===null?r.memoizedState:fs.next)===null&&(r=r.alternate,ee.H=r===null||r.memoizedState===null?$v:Tm),n}function xd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return kc(n);if(n.$$typeof===X)return Os(n)}throw Error(i(438,String(n)))}function mm(n){var r=null,o=Tt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Tt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=wd(),Tt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=V;return r.index++,o}function Hi(n,r){return typeof r=="function"?r(n):r}function _d(n){var r=is();return pm(r,Tn,n)}function pm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var _=f.next;f.next=m.next,m.next=_}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var T=_=null,B=null,ie=r,ge=!1;do{var ke=ie.lane&-536870913;if(ke!==ie.lane?(Bt&ke)===ke:(qi&ke)===ke){var ce=ie.revertLane;if(ce===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),ke===dl&&(ge=!0);else if((qi&ce)===ce){ie=ie.next,ce===dl&&(ge=!0);continue}else ke={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},B===null?(T=B=ke,_=m):B=B.next=ke,Tt.lanes|=ce,Aa|=ce;ke=ie.action,To&&o(m,ke),m=ie.hasEagerState?ie.eagerState:o(m,ke)}else ce={lane:ke,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},B===null?(T=B=ce,_=m):B=B.next=ce,Tt.lanes|=ke,Aa|=ke;ie=ie.next}while(ie!==null&&ie!==r);if(B===null?_=m:B.next=T,!_r(m,n.memoizedState)&&(ms=!0,ge&&(o=hl,o!==null)))throw o;n.memoizedState=m,n.baseState=_,n.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function gm(n){var r=is(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var _=f=f.next;do m=n(m,_.action),_=_.next;while(_!==f);_r(m,r.memoizedState)||(ms=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function dv(n,r,o){var c=Tt,f=is(),m=Wt;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var _=!_r((Tn||f).memoizedState,o);if(_&&(f.memoizedState=o,ms=!0),f=f.queue,bm(mv.bind(null,c,f,n),[n]),f.getSnapshot!==r||_||fs!==null&&fs.memoizedState.tag&1){if(c.flags|=2048,vl(9,{destroy:void 0},fv.bind(null,c,f,o,r),null),An===null)throw Error(i(349));m||(qi&127)!==0||hv(c,r,o)}return o}function hv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Tt.updateQueue,r===null?(r=wd(),Tt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function fv(n,r,o,c){r.value=o,r.getSnapshot=c,pv(r)&&gv(n)}function mv(n,r,o){return o(function(){pv(r)&&gv(n)})}function pv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!_r(n,o)}catch{return!0}}function gv(n){var r=go(n,2);r!==null&&gr(r,n,2)}function ym(n){var r=rr();if(typeof n=="function"){var o=n;if(n=o(),To){un(!0);try{o()}finally{un(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:n},r}function yv(n,r,o,c){return n.baseState=o,pm(n,Tn,typeof c=="function"?c:Hi)}function vT(n,r,o,c,f){if(Td(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){m.listeners.push(_)}};ee.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,vv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function vv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=ee.T,_={};ee.T=_;try{var T=o(f,c),B=ee.S;B!==null&&B(_,T),bv(n,r,T)}catch(ie){vm(n,r,ie)}finally{m!==null&&_.types!==null&&(m.types=_.types),ee.T=m}}else try{m=o(f,c),bv(n,r,m)}catch(ie){vm(n,r,ie)}}function bv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){wv(n,r,c)},function(c){return vm(n,r,c)}):wv(n,r,o)}function wv(n,r,o){r.status="fulfilled",r.value=o,xv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,vv(n,o)))}function vm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,xv(r),r=r.next;while(r!==c)}n.action=null}function xv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function _v(n,r){return r}function kv(n,r){if(Wt){var o=An.formState;if(o!==null){e:{var c=Tt;if(Wt){if(On){t:{for(var f=On,m=Br;f.nodeType!==8;){if(!m){f=null;break t}if(f=Fr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){On=Fr(f.nextSibling),c=f.data==="F!";break e}}xa(c)}c=!1}c&&(r=o[0])}}return o=rr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_v,lastRenderedState:r},o.queue=c,o=Fv.bind(null,Tt,c),c.dispatch=o,c=ym(!1),m=Em.bind(null,Tt,!1,c.queue),c=rr(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=vT.bind(null,Tt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function Ev(n){var r=is();return Tv(r,Tn,n)}function Tv(n,r,o){if(r=pm(n,r,_v)[0],n=_d(Hi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=kc(r)}catch(_){throw _===fl?hd:_}else c=r;r=is();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Tt.flags|=2048,vl(9,{destroy:void 0},bT.bind(null,f,o),null)),[c,m,n]}function bT(n,r){n.action=r}function jv(n){var r=is(),o=Tn;if(o!==null)return Tv(r,o,n);is(),r=r.memoizedState,o=is();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function vl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Tt.updateQueue,r===null&&(r=wd(),Tt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Sv(){return is().memoizedState}function kd(n,r,o,c){var f=rr();Tt.flags|=n,f.memoizedState=vl(1|r,{destroy:void 0},o,c===void 0?null:c)}function Ed(n,r,o,c){var f=is();c=c===void 0?null:c;var m=f.memoizedState.inst;Tn!==null&&c!==null&&cm(c,Tn.memoizedState.deps)?f.memoizedState=vl(r,m,o,c):(Tt.flags|=n,f.memoizedState=vl(1|r,m,o,c))}function Cv(n,r){kd(8390656,8,n,r)}function bm(n,r){Ed(2048,8,n,r)}function wT(n){Tt.flags|=4;var r=Tt.updateQueue;if(r===null)r=wd(),Tt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Nv(n){var r=is().memoizedState;return wT({ref:r,nextImpl:n}),function(){if((fn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Av(n,r){return Ed(4,2,n,r)}function Rv(n,r){return Ed(4,4,n,r)}function Iv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Mv(n,r,o){o=o!=null?o.concat([n]):null,Ed(4,4,Iv.bind(null,r,n),o)}function wm(){}function Dv(n,r){var o=is();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&cm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Lv(n,r){var o=is();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&cm(r,c[1]))return c[0];if(c=n(),To){un(!0);try{n()}finally{un(!1)}}return o.memoizedState=[c,r],c}function xm(n,r,o){return o===void 0||(qi&1073741824)!==0&&(Bt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=O1(),Tt.lanes|=n,Aa|=n,o)}function Ov(n,r,o,c){return _r(o,r)?o:pl.current!==null?(n=xm(n,o,c),_r(n,r)||(ms=!0),n):(qi&42)===0||(qi&1073741824)!==0&&(Bt&261930)===0?(ms=!0,n.memoizedState=o):(n=O1(),Tt.lanes|=n,Aa|=n,r)}function Pv(n,r,o,c,f){var m=Ee.p;Ee.p=m!==0&&8>m?m:8;var _=ee.T,T={};ee.T=T,Em(n,!1,r,o);try{var B=f(),ie=ee.S;if(ie!==null&&ie(T,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ge=pT(B,c);Ec(n,r,ge,Cr(n))}else Ec(n,r,c,Cr(n))}catch(ke){Ec(n,r,{then:function(){},status:"rejected",reason:ke},Cr())}finally{Ee.p=m,_!==null&&T.types!==null&&(_.types=T.types),ee.T=_}}function xT(){}function _m(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Vv(n).queue;Pv(n,f,r,Pe,o===null?xT:function(){return Uv(n),o(c)})}function Vv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:Pe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Uv(n){var r=Vv(n);r.next===null&&(r=n.alternate.memoizedState),Ec(n,r.next.queue,{},Cr())}function km(){return Os(zc)}function Bv(){return is().memoizedState}function zv(){return is().memoizedState}function _T(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Cr();n=Ea(o);var c=Ta(r,n,o);c!==null&&(gr(c,r,o),bc(c,r,o)),r={cache:Jf()},n.payload=r;return}r=r.return}}function kT(n,r,o){var c=Cr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Td(n)?qv(r,o):(o=zf(n,r,o,c),o!==null&&(gr(o,n,c),Hv(o,r,c)))}function Fv(n,r,o){var c=Cr();Ec(n,r,o,c)}function Ec(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Td(n))qv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var _=r.lastRenderedState,T=m(_,o);if(f.hasEagerState=!0,f.eagerState=T,_r(T,_))return id(n,r,f,0),An===null&&rd(),!1}catch{}if(o=zf(n,r,f,c),o!==null)return gr(o,n,c),Hv(o,r,c),!0}return!1}function Em(n,r,o,c){if(c={lane:2,revertLane:np(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Td(n)){if(r)throw Error(i(479))}else r=zf(n,o,c,2),r!==null&&gr(r,n,2)}function Td(n){var r=n.alternate;return n===Tt||r!==null&&r===Tt}function qv(n,r){gl=vd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function Hv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ct(n,o)}}var Tc={readContext:Os,use:xd,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useLayoutEffect:Xn,useInsertionEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useSyncExternalStore:Xn,useId:Xn,useHostTransitionStatus:Xn,useFormState:Xn,useActionState:Xn,useOptimistic:Xn,useMemoCache:Xn,useCacheRefresh:Xn};Tc.useEffectEvent=Xn;var $v={readContext:Os,use:xd,useCallback:function(n,r){return rr().memoizedState=[n,r===void 0?null:r],n},useContext:Os,useEffect:Cv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,kd(4194308,4,Iv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return kd(4194308,4,n,r)},useInsertionEffect:function(n,r){kd(4,2,n,r)},useMemo:function(n,r){var o=rr();r=r===void 0?null:r;var c=n();if(To){un(!0);try{n()}finally{un(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=rr();if(o!==void 0){var f=o(r);if(To){un(!0);try{o(r)}finally{un(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=kT.bind(null,Tt,n),[c.memoizedState,n]},useRef:function(n){var r=rr();return n={current:n},r.memoizedState=n},useState:function(n){n=ym(n);var r=n.queue,o=Fv.bind(null,Tt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:wm,useDeferredValue:function(n,r){var o=rr();return xm(o,n,r)},useTransition:function(){var n=ym(!1);return n=Pv.bind(null,Tt,n.queue,!0,!1),rr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Tt,f=rr();if(Wt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),An===null)throw Error(i(349));(Bt&127)!==0||hv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Cv(mv.bind(null,c,m,n),[n]),c.flags|=2048,vl(9,{destroy:void 0},fv.bind(null,c,m,o,r),null),o},useId:function(){var n=rr(),r=An.identifierPrefix;if(Wt){var o=bi,c=vi;o=(c&~(1<<32-Ze(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=bd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=gT++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:kv,useActionState:kv,useOptimistic:function(n){var r=rr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Em.bind(null,Tt,!0,o),o.dispatch=r,[n,r]},useMemoCache:mm,useCacheRefresh:function(){return rr().memoizedState=_T.bind(null,Tt)},useEffectEvent:function(n){var r=rr(),o={impl:n};return r.memoizedState=o,function(){if((fn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Tm={readContext:Os,use:xd,useCallback:Dv,useContext:Os,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:_d,useRef:Sv,useState:function(){return _d(Hi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=is();return Ov(o,Tn.memoizedState,n,r)},useTransition:function(){var n=_d(Hi)[0],r=is().memoizedState;return[typeof n=="boolean"?n:kc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:Ev,useActionState:Ev,useOptimistic:function(n,r){var o=is();return yv(o,Tn,n,r)},useMemoCache:mm,useCacheRefresh:zv};Tm.useEffectEvent=Nv;var Wv={readContext:Os,use:xd,useCallback:Dv,useContext:Os,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:gm,useRef:Sv,useState:function(){return gm(Hi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=is();return Tn===null?xm(o,n,r):Ov(o,Tn.memoizedState,n,r)},useTransition:function(){var n=gm(Hi)[0],r=is().memoizedState;return[typeof n=="boolean"?n:kc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:jv,useActionState:jv,useOptimistic:function(n,r){var o=is();return Tn!==null?yv(o,Tn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mm,useCacheRefresh:zv};Wv.useEffectEvent=Nv;function jm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:E({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Cr(),f=Ea(c);f.payload=r,o!=null&&(f.callback=o),r=Ta(n,f,c),r!==null&&(gr(r,n,c),bc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Cr(),f=Ea(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ta(n,f,c),r!==null&&(gr(r,n,c),bc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Cr(),c=Ea(o);c.tag=2,r!=null&&(c.callback=r),r=Ta(n,c,o),r!==null&&(gr(r,n,o),bc(r,n,o))}};function Gv(n,r,o,c,f,m,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,_):r.prototype&&r.prototype.isPureReactComponent?!dc(o,c)||!dc(f,m):!0}function Kv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function jo(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=E({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Yv(n){sd(n)}function Qv(n){console.error(n)}function Xv(n){sd(n)}function jd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Cm(n,r,o){return o=Ea(o),o.tag=3,o.payload={element:null},o.callback=function(){jd(n,r)},o}function Zv(n){return n=Ea(n),n.tag=3,n}function e1(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Jv(r,o,c)}}var _=o.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(n.callback=function(){Jv(r,o,c),typeof f!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function ET(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ul(r,o,f,!0),o=Er.current,o!==null){switch(o.tag){case 31:case 13:return zr===null?Vd():o.alternate===null&&Jn===0&&(Jn=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Zm(n,c,f)),!1;case 22:return o.flags|=65536,c===fd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Zm(n,c,f)),!1}throw Error(i(435,o.tag))}return Zm(n,c,f),Vd(),!1}if(Wt)return r=Er.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Gf&&(n=Error(i(422),{cause:c}),mc(Pr(n,o)))):(c!==Gf&&(r=Error(i(423),{cause:c}),mc(Pr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Pr(c,o),f=Cm(n.stateNode,c,f),rm(n,f),Jn!==4&&(Jn=2)),!1;var m=Error(i(520),{cause:c});if(m=Pr(m,o),Mc===null?Mc=[m]:Mc.push(m),Jn!==4&&(Jn=2),r===null)return!0;c=Pr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Cm(o.stateNode,c,n),rm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ra===null||!Ra.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Zv(f),e1(f,n,o,c),rm(o,f),!1}o=o.return}while(o!==null);return!1}var Nm=Error(i(461)),ms=!1;function Ps(n,r,o,c){r.child=n===null?rv(r,null,o,c):Eo(r,n.child,o,c)}function t1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var _={};for(var T in c)T!=="ref"&&(_[T]=c[T])}else _=c;return wo(r),c=um(n,r,o,_,m,f),T=dm(),n!==null&&!ms?(hm(n,r,f),$i(n,r,f)):(Wt&&T&&$f(r),r.flags|=1,Ps(n,r,c,f),r.child)}function n1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Ff(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,s1(n,r,m,c,f)):(n=od(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Pm(n,f)){var _=m.memoizedProps;if(o=o.compare,o=o!==null?o:dc,o(_,c)&&n.ref===r.ref)return $i(n,r,f)}return r.flags|=1,n=Ui(m,c),n.ref=r.ref,n.return=r,r.child=n}function s1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(dc(m,c)&&n.ref===r.ref)if(ms=!1,r.pendingProps=c=m,Pm(n,f))(n.flags&131072)!==0&&(ms=!0);else return r.lanes=n.lanes,$i(n,r,f)}return Am(n,r,o,c,f)}function r1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return i1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&dd(r,m!==null?m.cachePool:null),m!==null?ov(r,m):am(),lv(r);else return c=r.lanes=536870912,i1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(dd(r,m.cachePool),ov(r,m),Sa(),r.memoizedState=null):(n!==null&&dd(r,null),am(),Sa());return Ps(n,r,f,o),r.child}function jc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function i1(n,r,o,c,f){var m=em();return m=m===null?null:{parent:hs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&dd(r,null),am(),lv(r),n!==null&&ul(n,r,c,!0),r.childLanes=f,null}function Sd(n,r){return r=Nd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function a1(n,r,o){return Eo(r,n.child,null,o),n=Sd(r,r.pendingProps),n.flags|=2,Tr(r),r.memoizedState=null,n}function TT(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Wt){if(c.mode==="hidden")return n=Sd(r,c),r.lanes=536870912,jc(null,n);if(lm(r),(n=On)?(n=vb(n,Br),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ba!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Ls=r,On=null)):n=null,n===null)throw xa(r);return r.lanes=536870912,null}return Sd(r,c)}var m=n.memoizedState;if(m!==null){var _=m.dehydrated;if(lm(r),f)if(r.flags&256)r.flags&=-257,r=a1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ms||ul(n,r,o,!1),f=(o&n.childLanes)!==0,ms||f){if(c=An,c!==null&&(_=st(c,o),_!==0&&_!==m.retryLane))throw m.retryLane=_,go(n,_),gr(c,n,_),Nm;Vd(),r=a1(n,r,o)}else n=m.treeContext,On=Fr(_.nextSibling),Ls=r,Wt=!0,wa=null,Br=!1,n!==null&&W0(r,n),r=Sd(r,c),r.flags|=4096;return r}return n=Ui(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Cd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Am(n,r,o,c,f){return wo(r),o=um(n,r,o,c,void 0,f),c=dm(),n!==null&&!ms?(hm(n,r,f),$i(n,r,f)):(Wt&&c&&$f(r),r.flags|=1,Ps(n,r,o,f),r.child)}function o1(n,r,o,c,f,m){return wo(r),r.updateQueue=null,o=uv(r,c,o,f),cv(n),c=dm(),n!==null&&!ms?(hm(n,r,m),$i(n,r,m)):(Wt&&c&&$f(r),r.flags|=1,Ps(n,r,o,m),r.child)}function l1(n,r,o,c,f){if(wo(r),r.stateNode===null){var m=al,_=o.contextType;typeof _=="object"&&_!==null&&(m=Os(_)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},nm(r),_=o.contextType,m.context=typeof _=="object"&&_!==null?Os(_):al,m.state=r.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(jm(r,o,_,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(_=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),_!==m.state&&Sm.enqueueReplaceState(m,m.state,null),xc(r,c,m,f),wc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var T=r.memoizedProps,B=jo(o,T);m.props=B;var ie=m.context,ge=o.contextType;_=al,typeof ge=="object"&&ge!==null&&(_=Os(ge));var ke=o.getDerivedStateFromProps;ge=typeof ke=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=r.pendingProps!==T,ge||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||ie!==_)&&Kv(r,m,c,_),ka=!1;var ce=r.memoizedState;m.state=ce,xc(r,c,m,f),wc(),ie=r.memoizedState,T||ce!==ie||ka?(typeof ke=="function"&&(jm(r,o,ke,c),ie=r.memoizedState),(B=ka||Gv(r,o,B,c,ce,ie,_))?(ge||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ie),m.props=c,m.state=ie,m.context=_,c=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,sm(n,r),_=r.memoizedProps,ge=jo(o,_),m.props=ge,ke=r.pendingProps,ce=m.context,ie=o.contextType,B=al,typeof ie=="object"&&ie!==null&&(B=Os(ie)),T=o.getDerivedStateFromProps,(ie=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==ke||ce!==B)&&Kv(r,m,c,B),ka=!1,ce=r.memoizedState,m.state=ce,xc(r,c,m,f),wc();var he=r.memoizedState;_!==ke||ce!==he||ka||n!==null&&n.dependencies!==null&&cd(n.dependencies)?(typeof T=="function"&&(jm(r,o,T,c),he=r.memoizedState),(ge=ka||Gv(r,o,ge,c,ce,he,B)||n!==null&&n.dependencies!==null&&cd(n.dependencies))?(ie||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,he,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,he,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===n.memoizedProps&&ce===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&ce===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=he),m.props=c,m.state=he,m.context=B,c=ge):(typeof m.componentDidUpdate!="function"||_===n.memoizedProps&&ce===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&ce===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Cd(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=Eo(r,n.child,null,f),r.child=Eo(r,null,o,f)):Ps(n,r,o,f),r.memoizedState=m.state,n=r.child):n=$i(n,r,f),n}function c1(n,r,o,c){return vo(),r.flags|=256,Ps(n,r,o,c),r.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:J0()}}function Mm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Sr),n}function u1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,_;if((_=m)||(_=n!==null&&n.memoizedState===null?!1:(rs.current&2)!==0),_&&(f=!0,r.flags&=-129),_=(r.flags&32)!==0,r.flags&=-33,n===null){if(Wt){if(f?ja(r):Sa(),(n=On)?(n=vb(n,Br),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ba!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=q0(n),o.return=r,r.child=o,Ls=r,On=null)):n=null,n===null)throw xa(r);return pp(n)?r.lanes=32:r.lanes=536870912,null}var T=c.children;return c=c.fallback,f?(Sa(),f=r.mode,T=Nd({mode:"hidden",children:T},f),c=yo(c,f,o,null),T.return=r,c.return=r,T.sibling=c,r.child=T,c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,_,o),r.memoizedState=Rm,jc(null,c)):(ja(r),Dm(r,T))}var B=n.memoizedState;if(B!==null&&(T=B.dehydrated,T!==null)){if(m)r.flags&256?(ja(r),r.flags&=-257,r=Lm(n,r,o)):r.memoizedState!==null?(Sa(),r.child=n.child,r.flags|=128,r=null):(Sa(),T=c.fallback,f=r.mode,c=Nd({mode:"visible",children:c.children},f),T=yo(T,f,o,null),T.flags|=2,c.return=r,T.return=r,c.sibling=T,r.child=c,Eo(r,n.child,null,o),c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,_,o),r.memoizedState=Rm,r=jc(null,c));else if(ja(r),pp(T)){if(_=T.nextSibling&&T.nextSibling.dataset,_)var ie=_.dgst;_=ie,c=Error(i(419)),c.stack="",c.digest=_,mc({value:c,source:null,stack:null}),r=Lm(n,r,o)}else if(ms||ul(n,r,o,!1),_=(o&n.childLanes)!==0,ms||_){if(_=An,_!==null&&(c=st(_,o),c!==0&&c!==B.retryLane))throw B.retryLane=c,go(n,c),gr(_,n,c),Nm;mp(T)||Vd(),r=Lm(n,r,o)}else mp(T)?(r.flags|=192,r.child=n.child,r=null):(n=B.treeContext,On=Fr(T.nextSibling),Ls=r,Wt=!0,wa=null,Br=!1,n!==null&&W0(r,n),r=Dm(r,c.children),r.flags|=4096);return r}return f?(Sa(),T=c.fallback,f=r.mode,B=n.child,ie=B.sibling,c=Ui(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,ie!==null?T=Ui(ie,T):(T=yo(T,f,o,null),T.flags|=2),T.return=r,c.return=r,c.sibling=T,r.child=c,jc(null,c),c=r.child,T=n.child.memoizedState,T===null?T=Im(o):(f=T.cachePool,f!==null?(B=hs._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=J0(),T={baseLanes:T.baseLanes|o,cachePool:f}),c.memoizedState=T,c.childLanes=Mm(n,_,o),r.memoizedState=Rm,jc(n.child,c)):(ja(r),o=n.child,n=o.sibling,o=Ui(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(_=r.deletions,_===null?(r.deletions=[n],r.flags|=16):_.push(n)),r.child=o,r.memoizedState=null,o)}function Dm(n,r){return r=Nd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Nd(n,r){return n=kr(22,n,null,r),n.lanes=0,n}function Lm(n,r,o){return Eo(r,n.child,null,o),n=Dm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function d1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qf(n.return,r,o)}function Om(n,r,o,c,f,m){var _=n.memoizedState;_===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(_.isBackwards=r,_.rendering=null,_.renderingStartTime=0,_.last=c,_.tail=o,_.tailMode=f,_.treeForkCount=m)}function h1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var _=rs.current,T=(_&2)!==0;if(T?(_=_&1|2,r.flags|=128):_&=1,be(rs,_),Ps(n,r,c,o),c=Wt?fc:0,!T&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&d1(n,o,r);else if(n.tag===19)d1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&yd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Om(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&yd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Om(r,!0,o,null,m,c);break;case"together":Om(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function $i(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Aa|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ul(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Ui(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Ui(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Pm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&cd(n)))}function jT(n,r,o){switch(r.tag){case 3:Ve(r,r.stateNode.containerInfo),_a(r,hs,n.memoizedState.cache),vo();break;case 27:case 5:Qt(r);break;case 4:Ve(r,r.stateNode.containerInfo);break;case 10:_a(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ja(r),r.flags|=128,null):(o&r.child.childLanes)!==0?u1(n,r,o):(ja(r),n=$i(n,r,o),n!==null?n.sibling:null);ja(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ul(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return h1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),be(rs,rs.current),c)break;return null;case 22:return r.lanes=0,r1(n,r,o,r.pendingProps);case 24:_a(r,hs,n.memoizedState.cache)}return $i(n,r,o)}function f1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ms=!0;else{if(!Pm(n,o)&&(r.flags&128)===0)return ms=!1,jT(n,r,o);ms=(n.flags&131072)!==0}else ms=!1,Wt&&(r.flags&1048576)!==0&&$0(r,fc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=_o(r.elementType),r.type=n,typeof n=="function")Ff(n)?(c=jo(n,c),r.tag=1,r=l1(null,r,n,c,o)):(r.tag=0,r=Am(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===de){r.tag=11,r=t1(null,r,n,c,o);break e}else if(f===C){r.tag=14,r=n1(null,r,n,c,o);break e}}throw r=Ie(n)||n,Error(i(306,r,""))}}return r;case 0:return Am(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=jo(c,r.pendingProps),l1(n,r,c,f,o);case 3:e:{if(Ve(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,sm(n,r),xc(r,c,null,o);var _=r.memoizedState;if(c=_.cache,_a(r,hs,c),c!==m.cache&&Xf(r,[hs],o,!0),wc(),c=_.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:_.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=c1(n,r,c,o);break e}else if(c!==f){f=Pr(Error(i(424)),r),mc(f),r=c1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,On=Fr(n.firstChild),Ls=r,Wt=!0,wa=null,Br=!0,o=rv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(vo(),c===f){r=$i(n,r,o);break e}Ps(n,r,c,o)}r=r.child}return r;case 26:return Cd(n,r),n===null?(o=Eb(r.type,null,r.pendingProps,null))?r.memoizedState=o:Wt||(o=r.type,n=r.pendingProps,c=$d(Ce.current).createElement(o),c[en]=r,c[En]=n,Vs(c,o,n),dn(c),r.stateNode=c):r.memoizedState=Eb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Qt(r),n===null&&Wt&&(c=r.stateNode=xb(r.type,r.pendingProps,Ce.current),Ls=r,Br=!0,f=On,La(r.type)?(gp=f,On=Fr(c.firstChild)):On=f),Ps(n,r,r.pendingProps.children,o),Cd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Wt&&((f=c=On)&&(c=nj(c,r.type,r.pendingProps,Br),c!==null?(r.stateNode=c,Ls=r,On=Fr(c.firstChild),Br=!1,f=!0):f=!1),f||xa(r)),Qt(r),f=r.type,m=r.pendingProps,_=n!==null?n.memoizedProps:null,c=m.children,dp(f,m)?c=null:_!==null&&dp(f,_)&&(r.flags|=32),r.memoizedState!==null&&(f=um(n,r,yT,null,null,o),zc._currentValue=f),Cd(n,r),Ps(n,r,c,o),r.child;case 6:return n===null&&Wt&&((n=o=On)&&(o=sj(o,r.pendingProps,Br),o!==null?(r.stateNode=o,Ls=r,On=null,n=!0):n=!1),n||xa(r)),null;case 13:return u1(n,r,o);case 4:return Ve(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=Eo(r,null,c,o):Ps(n,r,c,o),r.child;case 11:return t1(n,r,r.type,r.pendingProps,o);case 7:return Ps(n,r,r.pendingProps,o),r.child;case 8:return Ps(n,r,r.pendingProps.children,o),r.child;case 12:return Ps(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,_a(r,r.type,c.value),Ps(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,wo(r),f=Os(f),c=c(f),r.flags|=1,Ps(n,r,c,o),r.child;case 14:return n1(n,r,r.type,r.pendingProps,o);case 15:return s1(n,r,r.type,r.pendingProps,o);case 19:return h1(n,r,o);case 31:return TT(n,r,o);case 22:return r1(n,r,o,r.pendingProps);case 24:return wo(r),c=Os(hs),n===null?(f=em(),f===null&&(f=An,m=Jf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},nm(r),_a(r,hs,f)):((n.lanes&o)!==0&&(sm(n,r),xc(r,null,null,o),wc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),_a(r,hs,c)):(c=m.cache,_a(r,hs,c),c!==f.cache&&Xf(r,[hs],o,!0))),Ps(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Wi(n){n.flags|=4}function Vm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(B1())n.flags|=8192;else throw ko=fd,tm}else n.flags&=-16777217}function m1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Nb(r))if(B1())n.flags|=8192;else throw ko=fd,tm}function Ad(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?kn():536870912,n.lanes|=r,_l|=r)}function Sc(n,r){if(!Wt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Pn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function ST(n,r,o){var c=r.pendingProps;switch(Wf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(r),null;case 1:return Pn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Fi(hs),Le(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(cl(r)?Wi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Kf())),Pn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Wi(r),m!==null?(Pn(r),m1(r,m)):(Pn(r),Vm(r,f,null,c,o))):m?m!==n.memoizedState?(Wi(r),Pn(r),m1(r,m)):(Pn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Wi(r),Pn(r),Vm(r,f,n,c,o)),null;case 27:if(Dt(r),o=Ce.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Wi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pn(r),null}n=Se.current,cl(r)?G0(r):(n=xb(f,c,o),r.stateNode=n,Wi(r))}return Pn(r),null;case 5:if(Dt(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Wi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pn(r),null}if(m=Se.current,cl(r))G0(r);else{var _=$d(Ce.current);switch(m){case 1:m=_.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=_.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=_.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=_.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=_.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?_.createElement("select",{is:c.is}):_.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?_.createElement(f,{is:c.is}):_.createElement(f)}}m[en]=r,m[En]=c;e:for(_=r.child;_!==null;){if(_.tag===5||_.tag===6)m.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===r)break e;for(;_.sibling===null;){if(_.return===null||_.return===r)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}r.stateNode=m;e:switch(Vs(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Wi(r)}}return Pn(r),Vm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Wi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ce.current,cl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Ls,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[en]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ub(n.nodeValue,o)),n||xa(r,!0)}else n=$d(n).createTextNode(c),n[en]=r,r.stateNode=n}return Pn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=cl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[en]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pn(r),n=!1}else o=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Tr(r),r):(Tr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Pn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=cl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[en]=r}else vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pn(r),f=!1}else f=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Tr(r),r):(Tr(r),null)}return Tr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Ad(r,r.updateQueue),Pn(r),null);case 4:return Le(),n===null&&ap(r.stateNode.containerInfo),Pn(r),null;case 10:return Fi(r.type),Pn(r),null;case 19:if(te(rs),c=r.memoizedState,c===null)return Pn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Sc(c,!1);else{if(Jn!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=yd(n),m!==null){for(r.flags|=128,Sc(c,!1),n=m.updateQueue,r.updateQueue=n,Ad(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)F0(o,n),o=o.sibling;return be(rs,rs.current&1|2),Wt&&Bi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&ze()>Ld&&(r.flags|=128,f=!0,Sc(c,!1),r.lanes=4194304)}else{if(!f)if(n=yd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Ad(r,n),Sc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Wt)return Pn(r),null}else 2*ze()-c.renderingStartTime>Ld&&o!==536870912&&(r.flags|=128,f=!0,Sc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=ze(),n.sibling=null,o=rs.current,be(rs,f?o&1|2:o&1),Wt&&Bi(r,c.treeForkCount),n):(Pn(r),null);case 22:case 23:return Tr(r),om(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Pn(r),r.subtreeFlags&6&&(r.flags|=8192)):Pn(r),o=r.updateQueue,o!==null&&Ad(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&te(xo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Fi(hs),Pn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function CT(n,r){switch(Wf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Fi(hs),Le(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Dt(r),null;case 31:if(r.memoizedState!==null){if(Tr(r),r.alternate===null)throw Error(i(340));vo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Tr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));vo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return te(rs),null;case 4:return Le(),null;case 10:return Fi(r.type),null;case 22:case 23:return Tr(r),om(),n!==null&&te(xo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Fi(hs),null;case 25:return null;default:return null}}function p1(n,r){switch(Wf(r),r.tag){case 3:Fi(hs),Le();break;case 26:case 27:case 5:Dt(r);break;case 4:Le();break;case 31:r.memoizedState!==null&&Tr(r);break;case 13:Tr(r);break;case 19:te(rs);break;case 10:Fi(r.type);break;case 22:case 23:Tr(r),om(),n!==null&&te(xo);break;case 24:Fi(hs)}}function Cc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,_=o.inst;c=m(),_.destroy=c}o=o.next}while(o!==f)}}catch(T){vn(r,r.return,T)}}function Ca(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var _=c.inst,T=_.destroy;if(T!==void 0){_.destroy=void 0,f=r;var B=o,ie=T;try{ie()}catch(ge){vn(f,B,ge)}}}c=c.next}while(c!==m)}}catch(ge){vn(r,r.return,ge)}}function g1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{av(r,o)}catch(c){vn(n,n.return,c)}}}function y1(n,r,o){o.props=jo(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){vn(n,r,c)}}function Nc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){vn(n,r,f)}}function wi(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){vn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){vn(n,r,f)}else o.current=null}function v1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){vn(n,n.return,f)}}function Um(n,r,o){try{var c=n.stateNode;QT(c,n.type,o,r),c[En]=r}catch(f){vn(n,n.return,f)}}function b1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&La(n.type)||n.tag===4}function Bm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||b1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&La(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=nr));else if(c!==4&&(c===27&&La(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(zm(n,r,o),n=n.sibling;n!==null;)zm(n,r,o),n=n.sibling}function Rd(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&La(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Rd(n,r,o),n=n.sibling;n!==null;)Rd(n,r,o),n=n.sibling}function w1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Vs(r,c,o),r[en]=n,r[En]=o}catch(m){vn(n,n.return,m)}}var Gi=!1,ps=!1,Fm=!1,x1=typeof WeakSet=="function"?WeakSet:Set,Rs=null;function NT(n,r){if(n=n.containerInfo,cp=Jd,n=M0(n),Lf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var _=0,T=-1,B=-1,ie=0,ge=0,ke=n,ce=null;t:for(;;){for(var he;ke!==o||f!==0&&ke.nodeType!==3||(T=_+f),ke!==m||c!==0&&ke.nodeType!==3||(B=_+c),ke.nodeType===3&&(_+=ke.nodeValue.length),(he=ke.firstChild)!==null;)ce=ke,ke=he;for(;;){if(ke===n)break t;if(ce===o&&++ie===f&&(T=_),ce===m&&++ge===c&&(B=_),(he=ke.nextSibling)!==null)break;ke=ce,ce=ke.parentNode}ke=he}o=T===-1||B===-1?null:{start:T,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(up={focusedElem:n,selectionRange:o},Jd=!1,Rs=r;Rs!==null;)if(r=Rs,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rs=n;else for(;Rs!==null;){switch(r=Rs,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Ke=jo(o.type,f);n=c.getSnapshotBeforeUpdate(Ke,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(ut){vn(o,o.return,ut)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Rs=n;break}Rs=r.return}}function _1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Yi(n,o),c&4&&Cc(5,o);break;case 1:if(Yi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(_){vn(o,o.return,_)}else{var f=jo(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(_){vn(o,o.return,_)}}c&64&&g1(o),c&512&&Nc(o,o.return);break;case 3:if(Yi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{av(n,r)}catch(_){vn(o,o.return,_)}}break;case 27:r===null&&c&4&&w1(o);case 26:case 5:Yi(n,o),r===null&&c&4&&v1(o),c&512&&Nc(o,o.return);break;case 12:Yi(n,o);break;case 31:Yi(n,o),c&4&&T1(n,o);break;case 13:Yi(n,o),c&4&&j1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=VT.bind(null,o),rj(n,o))));break;case 22:if(c=o.memoizedState!==null||Gi,!c){r=r!==null&&r.memoizedState!==null||ps,f=Gi;var m=ps;Gi=c,(ps=r)&&!m?Qi(n,o,(o.subtreeFlags&8772)!==0):Yi(n,o),Gi=f,ps=m}break;case 30:break;default:Yi(n,o)}}function k1(n){var r=n.alternate;r!==null&&(n.alternate=null,k1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Js(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var qn=null,hr=!1;function Ki(n,r,o){for(o=o.child;o!==null;)E1(n,r,o),o=o.sibling}function E1(n,r,o){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(xn,o)}catch{}switch(o.tag){case 26:ps||wi(o,r),Ki(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ps||wi(o,r);var c=qn,f=hr;La(o.type)&&(qn=o.stateNode,hr=!1),Ki(n,r,o),Vc(o.stateNode),qn=c,hr=f;break;case 5:ps||wi(o,r);case 6:if(c=qn,f=hr,qn=null,Ki(n,r,o),qn=c,hr=f,qn!==null)if(hr)try{(qn.nodeType===9?qn.body:qn.nodeName==="HTML"?qn.ownerDocument.body:qn).removeChild(o.stateNode)}catch(m){vn(o,r,m)}else try{qn.removeChild(o.stateNode)}catch(m){vn(o,r,m)}break;case 18:qn!==null&&(hr?(n=qn,gb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Al(n)):gb(qn,o.stateNode));break;case 4:c=qn,f=hr,qn=o.stateNode.containerInfo,hr=!0,Ki(n,r,o),qn=c,hr=f;break;case 0:case 11:case 14:case 15:Ca(2,o,r),ps||Ca(4,o,r),Ki(n,r,o);break;case 1:ps||(wi(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&y1(o,r,c)),Ki(n,r,o);break;case 21:Ki(n,r,o);break;case 22:ps=(c=ps)||o.memoizedState!==null,Ki(n,r,o),ps=c;break;default:Ki(n,r,o)}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Al(n)}catch(o){vn(r,r.return,o)}}}function j1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Al(n)}catch(o){vn(r,r.return,o)}}function AT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new x1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new x1),r;default:throw Error(i(435,n.tag))}}function Id(n,r){var o=AT(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=UT.bind(null,n,c);c.then(f,f)}})}function fr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,_=r,T=_;e:for(;T!==null;){switch(T.tag){case 27:if(La(T.type)){qn=T.stateNode,hr=!1;break e}break;case 5:qn=T.stateNode,hr=!1;break e;case 3:case 4:qn=T.stateNode.containerInfo,hr=!0;break e}T=T.return}if(qn===null)throw Error(i(160));E1(m,_,f),qn=null,hr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)S1(r,n),r=r.sibling}var si=null;function S1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:fr(r,n),mr(n),c&4&&(Ca(3,n,n.return),Cc(3,n),Ca(5,n,n.return));break;case 1:fr(r,n),mr(n),c&512&&(ps||o===null||wi(o,o.return)),c&64&&Gi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=si;if(fr(r,n),mr(n),c&512&&(ps||o===null||wi(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Cs]||m[en]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Vs(m,c,o),m[en]=n,dn(m),c=m;break e;case"link":var _=Sb("link","href",f).get(c+(o.href||""));if(_){for(var T=0;T<_.length;T++)if(m=_[T],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){_.splice(T,1);break t}}m=f.createElement(c),Vs(m,c,o),f.head.appendChild(m);break;case"meta":if(_=Sb("meta","content",f).get(c+(o.content||""))){for(T=0;T<_.length;T++)if(m=_[T],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){_.splice(T,1);break t}}m=f.createElement(c),Vs(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[en]=n,dn(m),c=m}n.stateNode=c}else Cb(f,n.type,n.stateNode);else n.stateNode=jb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Cb(f,n.type,n.stateNode):jb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Um(n,n.memoizedProps,o.memoizedProps)}break;case 27:fr(r,n),mr(n),c&512&&(ps||o===null||wi(o,o.return)),o!==null&&c&4&&Um(n,n.memoizedProps,o.memoizedProps);break;case 5:if(fr(r,n),mr(n),c&512&&(ps||o===null||wi(o,o.return)),n.flags&32){f=n.stateNode;try{Ns(f,"")}catch(Ke){vn(n,n.return,Ke)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Um(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Fm=!0);break;case 6:if(fr(r,n),mr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Ke){vn(n,n.return,Ke)}}break;case 3:if(Kd=null,f=si,si=Wd(r.containerInfo),fr(r,n),si=f,mr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Al(r.containerInfo)}catch(Ke){vn(n,n.return,Ke)}Fm&&(Fm=!1,C1(n));break;case 4:c=si,si=Wd(n.stateNode.containerInfo),fr(r,n),mr(n),si=c;break;case 12:fr(r,n),mr(n);break;case 31:fr(r,n),mr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 13:fr(r,n),mr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Dd=ze()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 22:f=n.memoizedState!==null;var B=o!==null&&o.memoizedState!==null,ie=Gi,ge=ps;if(Gi=ie||f,ps=ge||B,fr(r,n),ps=ge,Gi=ie,mr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||B||Gi||ps||So(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){B=o=r;try{if(m=B.stateNode,f)_=m.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{T=B.stateNode;var ke=B.memoizedProps.style,ce=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;T.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Ke){vn(B,B.return,Ke)}}}else if(r.tag===6){if(o===null){B=r;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(Ke){vn(B,B.return,Ke)}}}else if(r.tag===18){if(o===null){B=r;try{var he=B.stateNode;f?yb(he,!0):yb(B.stateNode,!1)}catch(Ke){vn(B,B.return,Ke)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Id(n,o))));break;case 19:fr(r,n),mr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Id(n,c)));break;case 30:break;case 21:break;default:fr(r,n),mr(n)}}function mr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(b1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Bm(n);Rd(n,m,f);break;case 5:var _=o.stateNode;o.flags&32&&(Ns(_,""),o.flags&=-33);var T=Bm(n);Rd(n,T,_);break;case 3:case 4:var B=o.stateNode.containerInfo,ie=Bm(n);zm(n,ie,B);break;default:throw Error(i(161))}}catch(ge){vn(n,n.return,ge)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function C1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;C1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Yi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)_1(n,r.alternate,r),r=r.sibling}function So(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Ca(4,r,r.return),So(r);break;case 1:wi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&y1(r,r.return,o),So(r);break;case 27:Vc(r.stateNode);case 26:case 5:wi(r,r.return),So(r);break;case 22:r.memoizedState===null&&So(r);break;case 30:So(r);break;default:So(r)}n=n.sibling}}function Qi(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,_=m.flags;switch(m.tag){case 0:case 11:case 15:Qi(f,m,o),Cc(4,m);break;case 1:if(Qi(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ie){vn(c,c.return,ie)}if(c=m,f=c.updateQueue,f!==null){var T=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)iv(B[f],T)}catch(ie){vn(c,c.return,ie)}}o&&_&64&&g1(m),Nc(m,m.return);break;case 27:w1(m);case 26:case 5:Qi(f,m,o),o&&c===null&&_&4&&v1(m),Nc(m,m.return);break;case 12:Qi(f,m,o);break;case 31:Qi(f,m,o),o&&_&4&&T1(f,m);break;case 13:Qi(f,m,o),o&&_&4&&j1(f,m);break;case 22:m.memoizedState===null&&Qi(f,m,o),Nc(m,m.return);break;case 30:break;default:Qi(f,m,o)}r=r.sibling}}function qm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&pc(o))}function Hm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&pc(n))}function ri(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N1(n,r,o,c),r=r.sibling}function N1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ri(n,r,o,c),f&2048&&Cc(9,r);break;case 1:ri(n,r,o,c);break;case 3:ri(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&pc(n)));break;case 12:if(f&2048){ri(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,_=m.id,T=m.onPostCommit;typeof T=="function"&&T(_,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(B){vn(r,r.return,B)}}else ri(n,r,o,c);break;case 31:ri(n,r,o,c);break;case 13:ri(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,_=r.alternate,r.memoizedState!==null?m._visibility&2?ri(n,r,o,c):Ac(n,r):m._visibility&2?ri(n,r,o,c):(m._visibility|=2,bl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&qm(_,r);break;case 24:ri(n,r,o,c),f&2048&&Hm(r.alternate,r);break;default:ri(n,r,o,c)}}function bl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,_=r,T=o,B=c,ie=_.flags;switch(_.tag){case 0:case 11:case 15:bl(m,_,T,B,f),Cc(8,_);break;case 23:break;case 22:var ge=_.stateNode;_.memoizedState!==null?ge._visibility&2?bl(m,_,T,B,f):Ac(m,_):(ge._visibility|=2,bl(m,_,T,B,f)),f&&ie&2048&&qm(_.alternate,_);break;case 24:bl(m,_,T,B,f),f&&ie&2048&&Hm(_.alternate,_);break;default:bl(m,_,T,B,f)}r=r.sibling}}function Ac(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Ac(o,c),f&2048&&qm(c.alternate,c);break;case 24:Ac(o,c),f&2048&&Hm(c.alternate,c);break;default:Ac(o,c)}r=r.sibling}}var Rc=8192;function wl(n,r,o){if(n.subtreeFlags&Rc)for(n=n.child;n!==null;)A1(n,r,o),n=n.sibling}function A1(n,r,o){switch(n.tag){case 26:wl(n,r,o),n.flags&Rc&&n.memoizedState!==null&&gj(o,si,n.memoizedState,n.memoizedProps);break;case 5:wl(n,r,o);break;case 3:case 4:var c=si;si=Wd(n.stateNode.containerInfo),wl(n,r,o),si=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Rc,Rc=16777216,wl(n,r,o),Rc=c):wl(n,r,o));break;default:wl(n,r,o)}}function R1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Ic(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,M1(c,n)}R1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)I1(n),n=n.sibling}function I1(n){switch(n.tag){case 0:case 11:case 15:Ic(n),n.flags&2048&&Ca(9,n,n.return);break;case 3:Ic(n);break;case 12:Ic(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Md(n)):Ic(n);break;default:Ic(n)}}function Md(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,M1(c,n)}R1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Ca(8,r,r.return),Md(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Md(r));break;default:Md(r)}n=n.sibling}}function M1(n,r){for(;Rs!==null;){var o=Rs;switch(o.tag){case 0:case 11:case 15:Ca(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:pc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Rs=c;else e:for(o=n;Rs!==null;){c=Rs;var f=c.sibling,m=c.return;if(k1(c),c===o){Rs=null;break e}if(f!==null){f.return=m,Rs=f;break e}Rs=m}}}var RT={getCacheForType:function(n){var r=Os(hs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Os(hs).controller.signal}},IT=typeof WeakMap=="function"?WeakMap:Map,fn=0,An=null,Pt=null,Bt=0,yn=0,jr=null,Na=!1,xl=!1,$m=!1,Xi=0,Jn=0,Aa=0,Co=0,Wm=0,Sr=0,_l=0,Mc=null,pr=null,Gm=!1,Dd=0,D1=0,Ld=1/0,Od=null,Ra=null,Es=0,Ia=null,kl=null,Ji=0,Km=0,Ym=null,L1=null,Dc=0,Qm=null;function Cr(){return(fn&2)!==0&&Bt!==0?Bt&-Bt:ee.T!==null?np():Zt()}function O1(){if(Sr===0)if((Bt&536870912)===0||Wt){var n=bt;bt<<=1,(bt&3932160)===0&&(bt=262144),Sr=n}else Sr=536870912;return n=Er.current,n!==null&&(n.flags|=32),Sr}function gr(n,r,o){(n===An&&(yn===2||yn===9)||n.cancelPendingCommit!==null)&&(El(n,0),Ma(n,Bt,Sr,!1)),le(n,o),((fn&2)===0||n!==An)&&(n===An&&((fn&2)===0&&(Co|=o),Jn===4&&Ma(n,Bt,Sr,!1)),xi(n))}function P1(n,r,o){if((fn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Ot(n,r),f=c?LT(n,r):Jm(n,r,!0),m=c;do{if(f===0){xl&&!c&&Ma(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!MT(o)){f=Jm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var _=0;else _=n.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){r=_;e:{var T=n;f=Mc;var B=T.current.memoizedState.isDehydrated;if(B&&(El(T,_).flags|=256),_=Jm(T,_,!1),_!==2){if($m&&!B){T.errorRecoveryDisabledLanes|=m,Co|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=_}if(m=!1,f!==2)continue}}if(f===1){El(n,0),Ma(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ma(c,r,Sr,!Na);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Dd+300-ze(),10<f)){if(Ma(c,r,Sr,!Na),it(c,0,!0)!==0)break e;Ji=r,c.timeoutHandle=mb(V1.bind(null,c,o,pr,Od,Gm,r,Sr,Co,_l,Na,m,"Throttled",-0,0),f);break e}V1(c,o,pr,Od,Gm,r,Sr,Co,_l,Na,m,null,-0,0)}}break}while(!0);xi(n)}function V1(n,r,o,c,f,m,_,T,B,ie,ge,ke,ce,he){if(n.timeoutHandle=-1,ke=r.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:nr},A1(r,m,ke);var Ke=(m&62914560)===m?Dd-ze():(m&4194048)===m?D1-ze():0;if(Ke=yj(ke,Ke),Ke!==null){Ji=m,n.cancelPendingCommit=Ke(W1.bind(null,n,r,m,o,c,f,_,T,B,ge,ke,null,ce,he)),Ma(n,m,_,!ie);return}}W1(n,r,m,o,c,f,_,T,B)}function MT(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!_r(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ma(n,r,o,c){r&=~Wm,r&=~Co,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Ze(f),_=1<<m;c[m]=-1,f&=~_}o!==0&&qe(n,o,r)}function Pd(){return(fn&6)===0?(Lc(0),!1):!0}function Xm(){if(Pt!==null){if(yn===0)var n=Pt.return;else n=Pt,zi=bo=null,fm(n),ml=null,yc=0,n=Pt;for(;n!==null;)p1(n.alternate,n),n=n.return;Pt=null}}function El(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,ZT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Ji=0,Xm(),An=n,Pt=o=Ui(n.current,null),Bt=r,yn=0,jr=null,Na=!1,xl=Ot(n,r),$m=!1,_l=Sr=Wm=Co=Aa=Jn=0,pr=Mc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Ze(c),m=1<<f;r|=n[f],c&=~m}return Xi=r,rd(),o}function U1(n,r){Tt=null,ee.H=Tc,r===fl||r===hd?(r=tv(),yn=3):r===tm?(r=tv(),yn=4):yn=r===Nm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,jr=r,Pt===null&&(Jn=1,jd(n,Pr(r,n.current)))}function B1(){var n=Er.current;return n===null?!0:(Bt&4194048)===Bt?zr===null:(Bt&62914560)===Bt||(Bt&536870912)!==0?n===zr:!1}function z1(){var n=ee.H;return ee.H=Tc,n===null?Tc:n}function F1(){var n=ee.A;return ee.A=RT,n}function Vd(){Jn=4,Na||(Bt&4194048)!==Bt&&Er.current!==null||(xl=!0),(Aa&134217727)===0&&(Co&134217727)===0||An===null||Ma(An,Bt,Sr,!1)}function Jm(n,r,o){var c=fn;fn|=2;var f=z1(),m=F1();(An!==n||Bt!==r)&&(Od=null,El(n,r)),r=!1;var _=Jn;e:do try{if(yn!==0&&Pt!==null){var T=Pt,B=jr;switch(yn){case 8:Xm(),_=6;break e;case 3:case 2:case 9:case 6:Er.current===null&&(r=!0);var ie=yn;if(yn=0,jr=null,Tl(n,T,B,ie),o&&xl){_=0;break e}break;default:ie=yn,yn=0,jr=null,Tl(n,T,B,ie)}}DT(),_=Jn;break}catch(ge){U1(n,ge)}while(!0);return r&&n.shellSuspendCounter++,zi=bo=null,fn=c,ee.H=f,ee.A=m,Pt===null&&(An=null,Bt=0,rd()),_}function DT(){for(;Pt!==null;)q1(Pt)}function LT(n,r){var o=fn;fn|=2;var c=z1(),f=F1();An!==n||Bt!==r?(Od=null,Ld=ze()+500,El(n,r)):xl=Ot(n,r);e:do try{if(yn!==0&&Pt!==null){r=Pt;var m=jr;t:switch(yn){case 1:yn=0,jr=null,Tl(n,r,m,1);break;case 2:case 9:if(Z0(m)){yn=0,jr=null,H1(r);break}r=function(){yn!==2&&yn!==9||An!==n||(yn=7),xi(n)},m.then(r,r);break e;case 3:yn=7;break e;case 4:yn=5;break e;case 7:Z0(m)?(yn=0,jr=null,H1(r)):(yn=0,jr=null,Tl(n,r,m,7));break;case 5:var _=null;switch(Pt.tag){case 26:_=Pt.memoizedState;case 5:case 27:var T=Pt;if(_?Nb(_):T.stateNode.complete){yn=0,jr=null;var B=T.sibling;if(B!==null)Pt=B;else{var ie=T.return;ie!==null?(Pt=ie,Ud(ie)):Pt=null}break t}}yn=0,jr=null,Tl(n,r,m,5);break;case 6:yn=0,jr=null,Tl(n,r,m,6);break;case 8:Xm(),Jn=6;break e;default:throw Error(i(462))}}OT();break}catch(ge){U1(n,ge)}while(!0);return zi=bo=null,ee.H=c,ee.A=f,fn=o,Pt!==null?0:(An=null,Bt=0,rd(),Jn)}function OT(){for(;Pt!==null&&!pt();)q1(Pt)}function q1(n){var r=f1(n.alternate,n,Xi);n.memoizedProps=n.pendingProps,r===null?Ud(n):Pt=r}function H1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=o1(o,r,r.pendingProps,r.type,void 0,Bt);break;case 11:r=o1(o,r,r.pendingProps,r.type.render,r.ref,Bt);break;case 5:fm(r);default:p1(o,r),r=Pt=F0(r,Xi),r=f1(o,r,Xi)}n.memoizedProps=n.pendingProps,r===null?Ud(n):Pt=r}function Tl(n,r,o,c){zi=bo=null,fm(r),ml=null,yc=0;var f=r.return;try{if(ET(n,f,r,o,Bt)){Jn=1,jd(n,Pr(o,n.current)),Pt=null;return}}catch(m){if(f!==null)throw Pt=f,m;Jn=1,jd(n,Pr(o,n.current)),Pt=null;return}r.flags&32768?(Wt||c===1?n=!0:xl||(Bt&536870912)!==0?n=!1:(Na=n=!0,(c===2||c===9||c===3||c===6)&&(c=Er.current,c!==null&&c.tag===13&&(c.flags|=16384))),$1(r,n)):Ud(r)}function Ud(n){var r=n;do{if((r.flags&32768)!==0){$1(r,Na);return}n=r.return;var o=ST(r.alternate,r,Xi);if(o!==null){Pt=o;return}if(r=r.sibling,r!==null){Pt=r;return}Pt=r=n}while(r!==null);Jn===0&&(Jn=5)}function $1(n,r){do{var o=CT(n.alternate,n);if(o!==null){o.flags&=32767,Pt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Pt=n;return}Pt=n=o}while(n!==null);Jn=6,Pt=null}function W1(n,r,o,c,f,m,_,T,B){n.cancelPendingCommit=null;do Bd();while(Es!==0);if((fn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Bf,Me(n,o,m,_,T,B),n===An&&(Pt=An=null,Bt=0),kl=r,Ia=n,Ji=o,Km=m,Ym=f,L1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,BT(wn,function(){return X1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null,f=Ee.p,Ee.p=2,_=fn,fn|=4;try{NT(n,r,o)}finally{fn=_,Ee.p=f,ee.T=c}}Es=1,G1(),K1(),Y1()}}function G1(){if(Es===1){Es=0;var n=Ia,r=kl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=ee.T,ee.T=null;var c=Ee.p;Ee.p=2;var f=fn;fn|=4;try{S1(r,n);var m=up,_=M0(n.containerInfo),T=m.focusedElem,B=m.selectionRange;if(_!==T&&T&&T.ownerDocument&&I0(T.ownerDocument.documentElement,T)){if(B!==null&&Lf(T)){var ie=B.start,ge=B.end;if(ge===void 0&&(ge=ie),"selectionStart"in T)T.selectionStart=ie,T.selectionEnd=Math.min(ge,T.value.length);else{var ke=T.ownerDocument||document,ce=ke&&ke.defaultView||window;if(ce.getSelection){var he=ce.getSelection(),Ke=T.textContent.length,ut=Math.min(B.start,Ke),Sn=B.end===void 0?ut:Math.min(B.end,Ke);!he.extend&&ut>Sn&&(_=Sn,Sn=ut,ut=_);var Y=R0(T,ut),$=R0(T,Sn);if(Y&&$&&(he.rangeCount!==1||he.anchorNode!==Y.node||he.anchorOffset!==Y.offset||he.focusNode!==$.node||he.focusOffset!==$.offset)){var re=ke.createRange();re.setStart(Y.node,Y.offset),he.removeAllRanges(),ut>Sn?(he.addRange(re),he.extend($.node,$.offset)):(re.setEnd($.node,$.offset),he.addRange(re))}}}}for(ke=[],he=T;he=he.parentNode;)he.nodeType===1&&ke.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ke.length;T++){var we=ke[T];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}Jd=!!cp,up=cp=null}finally{fn=f,Ee.p=c,ee.T=o}}n.current=r,Es=2}}function K1(){if(Es===2){Es=0;var n=Ia,r=kl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=ee.T,ee.T=null;var c=Ee.p;Ee.p=2;var f=fn;fn|=4;try{_1(n,r.alternate,r)}finally{fn=f,Ee.p=c,ee.T=o}}Es=3}}function Y1(){if(Es===4||Es===3){Es=0,Rt();var n=Ia,r=kl,o=Ji,c=L1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,kl=Ia=null,Q1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ra=null),rn(o),r=r.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(xn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=ee.T,f=Ee.p,Ee.p=2,ee.T=null;try{for(var m=n.onRecoverableError,_=0;_<c.length;_++){var T=c[_];m(T.value,{componentStack:T.stack})}}finally{ee.T=r,Ee.p=f}}(Ji&3)!==0&&Bd(),xi(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Qm?Dc++:(Dc=0,Qm=n):Dc=0,Lc(0)}}function Q1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,pc(r)))}function Bd(){return G1(),K1(),Y1(),X1()}function X1(){if(Es!==5)return!1;var n=Ia,r=Km;Km=0;var o=rn(Ji),c=ee.T,f=Ee.p;try{Ee.p=32>o?32:o,ee.T=null,o=Ym,Ym=null;var m=Ia,_=Ji;if(Es=0,kl=Ia=null,Ji=0,(fn&6)!==0)throw Error(i(331));var T=fn;if(fn|=4,I1(m.current),N1(m,m.current,_,o),fn=T,Lc(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(xn,m)}catch{}return!0}finally{Ee.p=f,ee.T=c,Q1(n,r)}}function J1(n,r,o){r=Pr(o,r),r=Cm(n.stateNode,r,2),n=Ta(n,r,2),n!==null&&(le(n,2),xi(n))}function vn(n,r,o){if(n.tag===3)J1(n,n,o);else for(;r!==null;){if(r.tag===3){J1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ra===null||!Ra.has(c))){n=Pr(o,n),o=Zv(2),c=Ta(r,o,2),c!==null&&(e1(o,c,r,n),le(c,2),xi(c));break}}r=r.return}}function Zm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new IT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||($m=!0,f.add(o),n=PT.bind(null,n,r,o),r.then(n,n))}function PT(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,An===n&&(Bt&o)===o&&(Jn===4||Jn===3&&(Bt&62914560)===Bt&&300>ze()-Dd?(fn&2)===0&&El(n,0):Wm|=o,_l===Bt&&(_l=0)),xi(n)}function Z1(n,r){r===0&&(r=kn()),n=go(n,r),n!==null&&(le(n,r),xi(n))}function VT(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Z1(n,o)}function UT(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Z1(n,o)}function BT(n,r){return oe(n,r)}var zd=null,jl=null,ep=!1,Fd=!1,tp=!1,Da=0;function xi(n){n!==jl&&n.next===null&&(jl===null?zd=jl=n:jl=jl.next=n),Fd=!0,ep||(ep=!0,FT())}function Lc(n,r){if(!tp&&Fd){tp=!0;do for(var o=!1,c=zd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var _=c.suspendedLanes,T=c.pingedLanes;m=(1<<31-Ze(42|n)+1)-1,m&=f&~(_&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,sb(c,m))}else m=Bt,m=it(c,c===An?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Ot(c,m)||(o=!0,sb(c,m));c=c.next}while(o);tp=!1}}function zT(){eb()}function eb(){Fd=ep=!1;var n=0;Da!==0&&JT()&&(n=Da);for(var r=ze(),o=null,c=zd;c!==null;){var f=c.next,m=tb(c,r);m===0?(c.next=null,o===null?zd=f:o.next=f,f===null&&(jl=o)):(o=c,(n!==0||(m&3)!==0)&&(Fd=!0)),c=f}Es!==0&&Es!==5||Lc(n),Da!==0&&(Da=0)}function tb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var _=31-Ze(m),T=1<<_,B=f[_];B===-1?((T&o)===0||(T&c)!==0)&&(f[_]=_n(T,r)):B<=r&&(n.expiredLanes|=T),m&=~T}if(r=An,o=Bt,o=it(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(yn===2||yn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Xt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Ot(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Xt(c),rn(o)){case 2:case 8:o=cn;break;case 32:o=wn;break;case 268435456:o=Vn;break;default:o=wn}return c=nb.bind(null,n),o=oe(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Xt(c),n.callbackPriority=2,n.callbackNode=null,2}function nb(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Bd()&&n.callbackNode!==o)return null;var c=Bt;return c=it(n,n===An?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(P1(n,c,r),tb(n,ze()),n.callbackNode!=null&&n.callbackNode===o?nb.bind(null,n):null)}function sb(n,r){if(Bd())return null;P1(n,r,!0)}function FT(){ej(function(){(fn&6)!==0?oe(Jt,zT):eb()})}function np(){if(Da===0){var n=dl;n===0&&(n=yt,yt<<=1,(yt&261888)===0&&(yt=256)),Da=n}return Da}function rb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Jr(""+n)}function ib(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function qT(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=rb((f[En]||null).action),_=c.submitter;_&&(r=(r=_[En]||null)?rb(r.formAction):_.getAttribute("formAction"),r!==null&&(m=r,_=null));var T=new Nn("action","action",null,c,f);n.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Da!==0){var B=_?ib(f,_):new FormData(f);_m(o,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(T.preventDefault(),B=_?ib(f,_):new FormData(f),_m(o,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var sp=0;sp<Uf.length;sp++){var rp=Uf[sp],HT=rp.toLowerCase(),$T=rp[0].toUpperCase()+rp.slice(1);ni(HT,"on"+$T)}ni(O0,"onAnimationEnd"),ni(P0,"onAnimationIteration"),ni(V0,"onAnimationStart"),ni("dblclick","onDoubleClick"),ni("focusin","onFocus"),ni("focusout","onBlur"),ni(oT,"onTransitionRun"),ni(lT,"onTransitionStart"),ni(cT,"onTransitionCancel"),ni(U0,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function ab(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var _=c.length-1;0<=_;_--){var T=c[_],B=T.instance,ie=T.currentTarget;if(T=T.listener,B!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=ie;try{m(f)}catch(ge){sd(ge)}f.currentTarget=null,m=B}else for(_=0;_<c.length;_++){if(T=c[_],B=T.instance,ie=T.currentTarget,T=T.listener,B!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=ie;try{m(f)}catch(ge){sd(ge)}f.currentTarget=null,m=B}}}}function Vt(n,r){var o=r[ur];o===void 0&&(o=r[ur]=new Set);var c=n+"__bubble";o.has(c)||(ob(r,n,2,!1),o.add(c))}function ip(n,r,o){var c=0;r&&(c|=4),ob(o,n,c,r)}var qd="_reactListening"+Math.random().toString(36).slice(2);function ap(n){if(!n[qd]){n[qd]=!0,Ds.forEach(function(o){o!=="selectionchange"&&(WT.has(o)||ip(o,!1,n),ip(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[qd]||(r[qd]=!0,ip("selectionchange",!1,r))}}function ob(n,r,o,c){switch(Ob(r)){case 2:var f=wj;break;case 8:f=xj;break;default:f=xp}o=f.bind(null,r,o,n),f=void 0,!De||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function op(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var _=c.tag;if(_===3||_===4){var T=c.stateNode.containerInfo;if(T===f)break;if(_===4)for(_=c.return;_!==null;){var B=_.tag;if((B===3||B===4)&&_.stateNode.containerInfo===f)return;_=_.return}for(;T!==null;){if(_=Yn(T),_===null)return;if(B=_.tag,B===5||B===6||B===26||B===27){c=m=_;continue e}T=T.parentNode}}c=c.return}Q(function(){var ie=m,ge=Qn(o),ke=[];e:{var ce=B0.get(n);if(ce!==void 0){var he=Nn,Ke=n;switch(n){case"keypress":if(rt(o)===0)break e;case"keydown":case"keyup":he=ed;break;case"focusin":Ke="focus",he=ho;break;case"focusout":Ke="blur",he=ho;break;case"beforeblur":case"afterblur":he=ho;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=$u;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=v;break;case O0:case P0:case V0:he=Gu;break;case U0:he=A;break;case"scroll":case"scrollend":he=ks;break;case"wheel":he=ue;break;case"copy":case"cut":case"paste":he=Ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Vi;break;case"toggle":case"beforetoggle":he=Et}var ut=(r&4)!==0,Sn=!ut&&(n==="scroll"||n==="scrollend"),Y=ut?ce!==null?ce+"Capture":null:ce;ut=[];for(var $=ie,re;$!==null;){var we=$;if(re=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||re===null||Y===null||(we=fe($,Y),we!=null&&ut.push(Pc($,we,re))),Sn)break;$=$.return}0<ut.length&&(ce=new he(ce,Ke,null,o,ge),ke.push({event:ce,listeners:ut}))}}if((r&7)===0){e:{if(ce=n==="mouseover"||n==="pointerover",he=n==="mouseout"||n==="pointerout",ce&&o!==Oi&&(Ke=o.relatedTarget||o.fromElement)&&(Yn(Ke)||Ke[Bn]))break e;if((he||ce)&&(ce=ge.window===ge?ge:(ce=ge.ownerDocument)?ce.defaultView||ce.parentWindow:window,he?(Ke=o.relatedTarget||o.toElement,he=ie,Ke=Ke?Yn(Ke):null,Ke!==null&&(Sn=u(Ke),ut=Ke.tag,Ke!==Sn||ut!==5&&ut!==27&&ut!==6)&&(Ke=null)):(he=null,Ke=ie),he!==Ke)){if(ut=uo,we="onMouseLeave",Y="onMouseEnter",$="mouse",(n==="pointerout"||n==="pointerover")&&(ut=Vi,we="onPointerLeave",Y="onPointerEnter",$="pointer"),Sn=he==null?ce:$n(he),re=Ke==null?ce:$n(Ke),ce=new ut(we,$+"leave",he,o,ge),ce.target=Sn,ce.relatedTarget=re,we=null,Yn(ge)===ie&&(ut=new ut(Y,$+"enter",Ke,o,ge),ut.target=re,ut.relatedTarget=Sn,we=ut),Sn=we,he&&Ke)t:{for(ut=GT,Y=he,$=Ke,re=0,we=Y;we;we=ut(we))re++;we=0;for(var tt=$;tt;tt=ut(tt))we++;for(;0<re-we;)Y=ut(Y),re--;for(;0<we-re;)$=ut($),we--;for(;re--;){if(Y===$||$!==null&&Y===$.alternate){ut=Y;break t}Y=ut(Y),$=ut($)}ut=null}else ut=null;he!==null&&lb(ke,ce,he,ut,!1),Ke!==null&&Sn!==null&&lb(ke,Sn,Ke,ut,!0)}}e:{if(ce=ie?$n(ie):window,he=ce.nodeName&&ce.nodeName.toLowerCase(),he==="select"||he==="input"&&ce.type==="file")var on=T0;else if(k0(ce))if(j0)on=rT;else{on=nT;var Qe=tT}else he=ce.nodeName,!he||he.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ie&&Dr(ie.elementType)&&(on=T0):on=sT;if(on&&(on=on(n,ie))){E0(ke,on,o,ge);break e}Qe&&Qe(n,ce,ie),n==="focusout"&&ie&&ce.type==="number"&&ie.memoizedProps.value!=null&&ws(ce,"number",ce.value)}switch(Qe=ie?$n(ie):window,n){case"focusin":(k0(Qe)||Qe.contentEditable==="true")&&(sl=Qe,Of=ie,hc=null);break;case"focusout":hc=Of=sl=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,D0(ke,o,ge);break;case"selectionchange":if(aT)break;case"keydown":case"keyup":D0(ke,o,ge)}var jt;if(hn)e:{switch(n){case"compositionstart":var zt="onCompositionStart";break e;case"compositionend":zt="onCompositionEnd";break e;case"compositionupdate":zt="onCompositionUpdate";break e}zt=void 0}else nl?fo(n,o)&&(zt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(zt="onCompositionStart");zt&&(yi&&o.locale!=="ko"&&(nl||zt!=="onCompositionStart"?zt==="onCompositionEnd"&&nl&&(jt=_s()):(Ge=ge,at="value"in Ge?Ge.value:Ge.textContent,nl=!0)),Qe=Hd(ie,zt),0<Qe.length&&(zt=new gi(zt,n,null,o,ge),ke.push({event:zt,listeners:Qe}),jt?zt.data=jt:(jt=tl(o),jt!==null&&(zt.data=jt)))),(jt=Lr?XE(n,o):JE(n,o))&&(zt=Hd(ie,"onBeforeInput"),0<zt.length&&(Qe=new gi("onBeforeInput","beforeinput",null,o,ge),ke.push({event:Qe,listeners:zt}),Qe.data=jt)),qT(ke,n,ie,o,ge)}ab(ke,r)})}function Pc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Hd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=fe(n,o),f!=null&&c.unshift(Pc(n,f,m)),f=fe(n,r),f!=null&&c.push(Pc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function GT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function lb(n,r,o,c,f){for(var m=r._reactName,_=[];o!==null&&o!==c;){var T=o,B=T.alternate,ie=T.stateNode;if(T=T.tag,B!==null&&B===c)break;T!==5&&T!==26&&T!==27||ie===null||(B=ie,f?(ie=fe(o,m),ie!=null&&_.unshift(Pc(o,ie,B))):f||(ie=fe(o,m),ie!=null&&_.push(Pc(o,ie,B)))),o=o.return}_.length!==0&&n.push({event:r,listeners:_})}var KT=/\r\n?/g,YT=/\u0000|\uFFFD/g;function cb(n){return(typeof n=="string"?n:""+n).replace(KT,`
`).replace(YT,"")}function ub(n,r){return r=cb(r),cb(n)===r}function jn(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ns(n,""+c);break;case"className":q(n,"class",c);break;case"tabIndex":q(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":q(n,o,c);break;case"style":Xr(n,c,m);break;case"data":if(r!=="object"){q(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Jr(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&jn(n,r,"name",f.name,f,null),jn(n,r,"formEncType",f.formEncType,f,null),jn(n,r,"formMethod",f.formMethod,f,null),jn(n,r,"formTarget",f.formTarget,f,null)):(jn(n,r,"encType",f.encType,f,null),jn(n,r,"method",f.method,f,null),jn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Jr(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=nr);break;case"onScroll":c!=null&&Vt("scroll",n);break;case"onScrollEnd":c!=null&&Vt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Jr(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Vt("beforetoggle",n),Vt("toggle",n),I(n,"popover",c);break;case"xlinkActuate":J(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":J(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":J(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":J(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":J(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":J(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":J(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":J(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":J(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":I(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=pi.get(o)||o,I(n,o,c))}}function lp(n,r,o,c,f,m){switch(o){case"style":Xr(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&Ns(n,""+c);break;case"onScroll":c!=null&&Vt("scroll",n);break;case"onScrollEnd":c!=null&&Vt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=nr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cs.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[En]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):I(n,o,c)}}}function Vs(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vt("error",n),Vt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var _=o[m];if(_!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:jn(n,r,m,_,o,null)}}f&&jn(n,r,"srcSet",o.srcSet,o,null),c&&jn(n,r,"src",o.src,o,null);return;case"input":Vt("invalid",n);var T=m=_=f=null,B=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var ge=o[c];if(ge!=null)switch(c){case"name":f=ge;break;case"type":_=ge;break;case"checked":B=ge;break;case"defaultChecked":ie=ge;break;case"value":m=ge;break;case"defaultValue":T=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,r));break;default:jn(n,r,c,ge,o,null)}}dr(n,m,T,B,ie,_,f,!1);return;case"select":Vt("invalid",n),c=_=m=null;for(f in o)if(o.hasOwnProperty(f)&&(T=o[f],T!=null))switch(f){case"value":m=T;break;case"defaultValue":_=T;break;case"multiple":c=T;default:jn(n,r,f,T,o,null)}r=m,o=_,n.multiple=!!c,r!=null?tr(n,!!c,r,!1):o!=null&&tr(n,!!c,o,!0);return;case"textarea":Vt("invalid",n),m=f=c=null;for(_ in o)if(o.hasOwnProperty(_)&&(T=o[_],T!=null))switch(_){case"value":c=T;break;case"defaultValue":f=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:jn(n,r,_,T,o,null)}xr(n,c,f,m);return;case"option":for(B in o)o.hasOwnProperty(B)&&(c=o[B],c!=null)&&(B==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":jn(n,r,B,c,o,null));return;case"dialog":Vt("beforetoggle",n),Vt("toggle",n),Vt("cancel",n),Vt("close",n);break;case"iframe":case"object":Vt("load",n);break;case"video":case"audio":for(c=0;c<Oc.length;c++)Vt(Oc[c],n);break;case"image":Vt("error",n),Vt("load",n);break;case"details":Vt("toggle",n);break;case"embed":case"source":case"link":Vt("error",n),Vt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:jn(n,r,ie,c,o,null)}return;default:if(Dr(r)){for(ge in o)o.hasOwnProperty(ge)&&(c=o[ge],c!==void 0&&lp(n,r,ge,c,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(c=o[T],c!=null&&jn(n,r,T,c,o,null))}function QT(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,_=null,T=null,B=null,ie=null,ge=null;for(he in o){var ke=o[he];if(o.hasOwnProperty(he)&&ke!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":B=ke;default:c.hasOwnProperty(he)||jn(n,r,he,null,c,ke)}}for(var ce in c){var he=c[ce];if(ke=o[ce],c.hasOwnProperty(ce)&&(he!=null||ke!=null))switch(ce){case"type":m=he;break;case"name":f=he;break;case"checked":ie=he;break;case"defaultChecked":ge=he;break;case"value":_=he;break;case"defaultValue":T=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,r));break;default:he!==ke&&jn(n,r,ce,he,c,ke)}}qs(n,_,T,B,ie,ge,m,f);return;case"select":he=_=T=ce=null;for(m in o)if(B=o[m],o.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":he=B;default:c.hasOwnProperty(m)||jn(n,r,m,null,c,B)}for(f in c)if(m=c[f],B=o[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":ce=m;break;case"defaultValue":T=m;break;case"multiple":_=m;default:m!==B&&jn(n,r,f,m,c,B)}r=T,o=_,c=he,ce!=null?tr(n,!!o,ce,!1):!!c!=!!o&&(r!=null?tr(n,!!o,r,!0):tr(n,!!o,o?[]:"",!1));return;case"textarea":he=ce=null;for(T in o)if(f=o[T],o.hasOwnProperty(T)&&f!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:jn(n,r,T,null,c,f)}for(_ in c)if(f=c[_],m=o[_],c.hasOwnProperty(_)&&(f!=null||m!=null))switch(_){case"value":ce=f;break;case"defaultValue":he=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&jn(n,r,_,f,c,m)}ga(n,ce,he);return;case"option":for(var Ke in o)ce=o[Ke],o.hasOwnProperty(Ke)&&ce!=null&&!c.hasOwnProperty(Ke)&&(Ke==="selected"?n.selected=!1:jn(n,r,Ke,null,c,ce));for(B in c)ce=c[B],he=o[B],c.hasOwnProperty(B)&&ce!==he&&(ce!=null||he!=null)&&(B==="selected"?n.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":jn(n,r,B,ce,c,he));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in o)ce=o[ut],o.hasOwnProperty(ut)&&ce!=null&&!c.hasOwnProperty(ut)&&jn(n,r,ut,null,c,ce);for(ie in c)if(ce=c[ie],he=o[ie],c.hasOwnProperty(ie)&&ce!==he&&(ce!=null||he!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,r));break;default:jn(n,r,ie,ce,c,he)}return;default:if(Dr(r)){for(var Sn in o)ce=o[Sn],o.hasOwnProperty(Sn)&&ce!==void 0&&!c.hasOwnProperty(Sn)&&lp(n,r,Sn,void 0,c,ce);for(ge in c)ce=c[ge],he=o[ge],!c.hasOwnProperty(ge)||ce===he||ce===void 0&&he===void 0||lp(n,r,ge,ce,c,he);return}}for(var Y in o)ce=o[Y],o.hasOwnProperty(Y)&&ce!=null&&!c.hasOwnProperty(Y)&&jn(n,r,Y,null,c,ce);for(ke in c)ce=c[ke],he=o[ke],!c.hasOwnProperty(ke)||ce===he||ce==null&&he==null||jn(n,r,ke,ce,c,he)}function db(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,_=f.initiatorType,T=f.duration;if(m&&T&&db(_)){for(_=0,T=f.responseEnd,c+=1;c<o.length;c++){var B=o[c],ie=B.startTime;if(ie>T)break;var ge=B.transferSize,ke=B.initiatorType;ge&&db(ke)&&(B=B.responseEnd,_+=ge*(B<T?1:(T-ie)/(B-ie)))}if(--c,r+=8*(m+_)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cp=null,up=null;function $d(n){return n.nodeType===9?n:n.ownerDocument}function hb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function dp(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hp=null;function JT(){var n=window.event;return n&&n.type==="popstate"?n===hp?!1:(hp=n,!0):(hp=null,!1)}var mb=typeof setTimeout=="function"?setTimeout:void 0,ZT=typeof clearTimeout=="function"?clearTimeout:void 0,pb=typeof Promise=="function"?Promise:void 0,ej=typeof queueMicrotask=="function"?queueMicrotask:typeof pb<"u"?function(n){return pb.resolve(null).then(n).catch(tj)}:mb;function tj(n){setTimeout(function(){throw n})}function La(n){return n==="head"}function gb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Al(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Vc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Vc(o);for(var m=o.firstChild;m;){var _=m.nextSibling,T=m.nodeName;m[Cs]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=_}}else o==="body"&&Vc(n.ownerDocument.body);o=f}while(o);Al(r)}function yb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function fp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fp(o),Js(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function nj(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Cs])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Fr(n.nextSibling),n===null)break}return null}function sj(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Fr(n.nextSibling),n===null))return null;return n}function vb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Fr(n.nextSibling),n===null))return null;return n}function mp(n){return n.data==="$?"||n.data==="$~"}function pp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function rj(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Fr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var gp=null;function bb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Fr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function wb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function xb(n,r,o){switch(r=$d(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Vc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Js(n)}var qr=new Map,_b=new Set;function Wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Zi=Ee.d;Ee.d={f:ij,r:aj,D:oj,C:lj,L:cj,m:uj,X:hj,S:dj,M:fj};function ij(){var n=Zi.f(),r=Pd();return n||r}function aj(n){var r=ns(n);r!==null&&r.tag===5&&r.type==="form"?Uv(r):Zi.r(n)}var Sl=typeof document>"u"?null:document;function kb(n,r,o){var c=Sl;if(c&&typeof r=="string"&&r){var f=In(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),_b.has(f)||(_b.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Vs(r,"link",n),dn(r),c.head.appendChild(r)))}}function oj(n){Zi.D(n),kb("dns-prefetch",n,null)}function lj(n,r){Zi.C(n,r),kb("preconnect",n,r)}function cj(n,r,o){Zi.L(n,r,o);var c=Sl;if(c&&n&&r){var f='link[rel="preload"][as="'+In(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+In(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+In(o.imageSizes)+'"]')):f+='[href="'+In(n)+'"]';var m=f;switch(r){case"style":m=Cl(n);break;case"script":m=Nl(n)}qr.has(m)||(n=E({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),qr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Uc(m))||r==="script"&&c.querySelector(Bc(m))||(r=c.createElement("link"),Vs(r,"link",n),dn(r),c.head.appendChild(r)))}}function uj(n,r){Zi.m(n,r);var o=Sl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+In(c)+'"][href="'+In(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Nl(n)}if(!qr.has(m)&&(n=E({rel:"modulepreload",href:n},r),qr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Bc(m)))return}c=o.createElement("link"),Vs(c,"link",n),dn(c),o.head.appendChild(c)}}}function dj(n,r,o){Zi.S(n,r,o);var c=Sl;if(c&&n){var f=Wn(c).hoistableStyles,m=Cl(n);r=r||"default";var _=f.get(m);if(!_){var T={loading:0,preload:null};if(_=c.querySelector(Uc(m)))T.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":r},o),(o=qr.get(m))&&yp(n,o);var B=_=c.createElement("link");dn(B),Vs(B,"link",n),B._p=new Promise(function(ie,ge){B.onload=ie,B.onerror=ge}),B.addEventListener("load",function(){T.loading|=1}),B.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Gd(_,r,c)}_={type:"stylesheet",instance:_,count:1,state:T},f.set(m,_)}}}function hj(n,r){Zi.X(n,r);var o=Sl;if(o&&n){var c=Wn(o).hoistableScripts,f=Nl(n),m=c.get(f);m||(m=o.querySelector(Bc(f)),m||(n=E({src:n,async:!0},r),(r=qr.get(f))&&vp(n,r),m=o.createElement("script"),dn(m),Vs(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function fj(n,r){Zi.M(n,r);var o=Sl;if(o&&n){var c=Wn(o).hoistableScripts,f=Nl(n),m=c.get(f);m||(m=o.querySelector(Bc(f)),m||(n=E({src:n,async:!0,type:"module"},r),(r=qr.get(f))&&vp(n,r),m=o.createElement("script"),dn(m),Vs(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Eb(n,r,o,c){var f=(f=Ce.current)?Wd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Cl(o.href),o=Wn(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Cl(o.href);var m=Wn(f).hoistableStyles,_=m.get(n);if(_||(f=f.ownerDocument||f,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,_),(m=f.querySelector(Uc(n)))&&!m._p&&(_.instance=m,_.state.loading=5),qr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},qr.set(n,o),m||mj(f,n,o,_.state))),r&&c===null)throw Error(i(528,""));return _}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Nl(o),o=Wn(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Cl(n){return'href="'+In(n)+'"'}function Uc(n){return'link[rel="stylesheet"]['+n+"]"}function Tb(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function mj(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Vs(r,"link",o),dn(r),n.head.appendChild(r))}function Nl(n){return'[src="'+In(n)+'"]'}function Bc(n){return"script[async]"+n}function jb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+In(o.href)+'"]');if(c)return r.instance=c,dn(c),c;var f=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),dn(c),Vs(c,"style",f),Gd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Cl(o.href);var m=n.querySelector(Uc(f));if(m)return r.state.loading|=4,r.instance=m,dn(m),m;c=Tb(o),(f=qr.get(f))&&yp(c,f),m=(n.ownerDocument||n).createElement("link"),dn(m);var _=m;return _._p=new Promise(function(T,B){_.onload=T,_.onerror=B}),Vs(m,"link",c),r.state.loading|=4,Gd(m,o.precedence,n),r.instance=m;case"script":return m=Nl(o.src),(f=n.querySelector(Bc(m)))?(r.instance=f,dn(f),f):(c=o,(f=qr.get(m))&&(c=E({},o),vp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),dn(f),Vs(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Gd(c,o.precedence,n));return r.instance}function Gd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,_=0;_<c.length;_++){var T=c[_];if(T.dataset.precedence===r)m=T;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Kd=null;function Sb(n,r,o){if(Kd===null){var c=new Map,f=Kd=new Map;f.set(o,c)}else f=Kd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[Cs]||m[en]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var _=m.getAttribute(r)||"";_=n+_;var T=c.get(_);T?T.push(m):c.set(_,[m])}}return c}function Cb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function pj(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Nb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function gj(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Cl(c.href),m=r.querySelector(Uc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Yd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,dn(m);return}m=r.ownerDocument||r,c=Tb(c),(f=qr.get(f))&&yp(c,f),m=m.createElement("link"),dn(m);var _=m;_._p=new Promise(function(T,B){_.onload=T,_.onerror=B}),Vs(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Yd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var bp=0;function yj(n,r){return n.stylesheets&&n.count===0&&Xd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&bp===0&&(bp=62500*XT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Xd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>bp?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Yd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Qd=null;function Xd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Qd=new Map,r.forEach(vj,n),Qd=null,Yd.call(n))}function vj(n,r){if(!(r.state.loading&4)){var o=Qd.get(n);if(o)var c=o.get(null);else{o=new Map,Qd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var _=f[m];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(o.set(_.dataset.precedence,_),c=_)}c&&o.set(null,c)}f=r.instance,_=f.getAttribute("data-precedence"),m=o.get(_)||c,m===c&&o.set(null,f),o.set(_,f),this.count++,c=Yd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var zc={$$typeof:X,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function bj(n,r,o,c,f,m,_,T,B){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Kn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kn(0),this.hiddenUpdates=Kn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Ab(n,r,o,c,f,m,_,T,B,ie,ge,ke){return n=new bj(n,r,o,_,B,ie,ge,ke,T),r=1,m===!0&&(r|=24),m=kr(3,null,null,r),n.current=m,m.stateNode=n,r=Jf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},nm(m),n}function Rb(n){return n?(n=al,n):al}function Ib(n,r,o,c,f,m){f=Rb(f),c.context===null?c.context=f:c.pendingContext=f,c=Ea(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ta(n,c,r),o!==null&&(gr(o,n,r),bc(o,n,r))}function Mb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function wp(n,r){Mb(n,r),(n=n.alternate)&&Mb(n,r)}function Db(n){if(n.tag===13||n.tag===31){var r=go(n,67108864);r!==null&&gr(r,n,67108864),wp(n,67108864)}}function Lb(n){if(n.tag===13||n.tag===31){var r=Cr();r=Kt(r);var o=go(n,r);o!==null&&gr(o,n,r),wp(n,r)}}var Jd=!0;function wj(n,r,o,c){var f=ee.T;ee.T=null;var m=Ee.p;try{Ee.p=2,xp(n,r,o,c)}finally{Ee.p=m,ee.T=f}}function xj(n,r,o,c){var f=ee.T;ee.T=null;var m=Ee.p;try{Ee.p=8,xp(n,r,o,c)}finally{Ee.p=m,ee.T=f}}function xp(n,r,o,c){if(Jd){var f=_p(c);if(f===null)op(n,r,c,Zd,o),Pb(n,c);else if(kj(f,n,r,o,c))c.stopPropagation();else if(Pb(n,c),r&4&&-1<_j.indexOf(n)){for(;f!==null;){var m=ns(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var _=et(m.pendingLanes);if(_!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;_;){var B=1<<31-Ze(_);T.entanglements[1]|=B,_&=~B}xi(m),(fn&6)===0&&(Ld=ze()+500,Lc(0))}}break;case 31:case 13:T=go(m,2),T!==null&&gr(T,m,2),Pd(),wp(m,2)}if(m=_p(c),m===null&&op(n,r,c,Zd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else op(n,r,c,null,o)}}function _p(n){return n=Qn(n),kp(n)}var Zd=null;function kp(n){if(Zd=null,n=Yn(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Zd=n,null}function Ob(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kt()){case Jt:return 2;case cn:return 8;case wn:case Ss:return 32;case Vn:return 268435456;default:return 32}default:return 32}}var Ep=!1,Oa=null,Pa=null,Va=null,Fc=new Map,qc=new Map,Ua=[],_j="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(n,r){switch(n){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":Va=null;break;case"pointerover":case"pointerout":Fc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(r.pointerId)}}function Hc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=ns(r),r!==null&&Db(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function kj(n,r,o,c,f){switch(r){case"focusin":return Oa=Hc(Oa,n,r,o,c,f),!0;case"dragenter":return Pa=Hc(Pa,n,r,o,c,f),!0;case"mouseover":return Va=Hc(Va,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Fc.set(m,Hc(Fc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,qc.set(m,Hc(qc.get(m)||null,n,r,o,c,f)),!0}return!1}function Vb(n){var r=Yn(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Nt(n.priority,function(){Lb(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,Nt(n.priority,function(){Lb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function eh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=_p(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);Oi=c,o.target.dispatchEvent(c),Oi=null}else return r=ns(o),r!==null&&Db(r),n.blockedOn=o,!1;r.shift()}return!0}function Ub(n,r,o){eh(n)&&o.delete(r)}function Ej(){Ep=!1,Oa!==null&&eh(Oa)&&(Oa=null),Pa!==null&&eh(Pa)&&(Pa=null),Va!==null&&eh(Va)&&(Va=null),Fc.forEach(Ub),qc.forEach(Ub)}function th(n,r){n.blockedOn===r&&(n.blockedOn=null,Ep||(Ep=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ej)))}var nh=null;function Bb(n){nh!==n&&(nh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){nh===n&&(nh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kp(c||o)===null)continue;break}var m=ns(o);m!==null&&(n.splice(r,3),r-=3,_m(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Al(n){function r(B){return th(B,n)}Oa!==null&&th(Oa,n),Pa!==null&&th(Pa,n),Va!==null&&th(Va,n),Fc.forEach(r),qc.forEach(r);for(var o=0;o<Ua.length;o++){var c=Ua[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ua.length&&(o=Ua[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&Ua.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],_=f[En]||null;if(typeof m=="function")_||Bb(o);else if(_){var T=null;if(m&&m.hasAttribute("formAction")){if(f=m,_=m[En]||null)T=_.formAction;else if(kp(f)!==null)continue}else T=_.action;typeof T=="function"?o[c+1]=T:(o.splice(c,3),c-=3),Bb(o)}}}function zb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(_){return f=_})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Tp(n){this._internalRoot=n}sh.prototype.render=Tp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Cr();Ib(o,c,n,r,null,null)},sh.prototype.unmount=Tp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Ib(n.current,2,null,n,null,null),Pd(),r[Bn]=null}};function sh(n){this._internalRoot=n}sh.prototype.unstable_scheduleHydration=function(n){if(n){var r=Zt();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Ua.length&&r!==0&&r<Ua[o].priority;o++);Ua.splice(o,0,n),o===0&&Vb(n)}};var Fb=e.version;if(Fb!=="19.2.4")throw Error(i(527,Fb,"19.2.4"));Ee.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var Tj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{xn=rh.inject(Tj),Ct=rh}catch{}}return Wc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Yv,m=Qv,_=Xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(_=r.onRecoverableError)),r=Ab(n,1,!1,null,null,o,c,null,f,m,_,zb),n[Bn]=r.current,ap(n),new Tp(r)},Wc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Yv,_=Qv,T=Xv,B=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(B=o.formState)),r=Ab(n,1,!0,r,o??null,c,f,B,m,_,T,zb),r.context=Rb(null),o=r.current,c=Cr(),c=Kt(c),f=Ea(c),f.callback=null,Ta(o,f,c),o=c,r.current.lanes=o,le(r,o),xi(r),n[Bn]=r.current,ap(n),new sh(r)},Wc.version="19.2.4",Wc}var Jb;function Lj(){if(Jb)return Cp.exports;Jb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cp.exports=Dj(),Cp.exports}var Oj=Lj();const Pj="modulepreload",Vj=function(s){return"/login/"+s},Zb={},Qs=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=Vj(y),y in Zb)return;Zb[y]=!0;const b=y.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const j=document.createElement("link");if(j.rel=b?"stylesheet":Pj,b||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),b)return new Promise((P,F)=>{j.addEventListener("load",P),j.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var e2="popstate";function Uj(s={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return gg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:fu(l)}return zj(e,t,null,s)}function Hn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Gr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bj(){return Math.random().toString(36).substring(2,10)}function t2(s,e){return{usr:s.state,key:s.key,idx:e}}function gg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Jl(e):e,state:t,key:e&&e.key||i||Bj()}}function fu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Jl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function zj(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=b();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function b(){return(d.state||{idx:null}).idx}function E(){p="POP";let z=b(),H=z==null?null:z-y;y=z,g&&g({action:p,location:W.location,delta:H})}function j(z,H){p="PUSH";let G=gg(W.location,z,H);y=b()+1;let X=t2(G,y),de=W.createHref(G);try{d.pushState(X,"",de)}catch(_e){if(_e instanceof DOMException&&_e.name==="DataCloneError")throw _e;l.location.assign(de)}u&&g&&g({action:p,location:W.location,delta:1})}function P(z,H){p="REPLACE";let G=gg(W.location,z,H);y=b();let X=t2(G,y),de=W.createHref(G);d.replaceState(X,"",de),u&&g&&g({action:p,location:W.location,delta:0})}function F(z){return Fj(z)}let W={get action(){return p},get location(){return s(l,d)},listen(z){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(e2,E),g=z,()=>{l.removeEventListener(e2,E),g=null}},createHref(z){return e(l,z)},createURL:F,encodeLocation(z){let H=F(z);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:j,replace:P,go(z){return d.go(z)}};return W}function Fj(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Hn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:fu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function px(s,e,t="/"){return qj(s,e,t,!1)}function qj(s,e,t,i){let l=typeof e=="string"?Jl(e):e,u=oa(l.pathname||"/",t);if(u==null)return null;let d=gx(s);Hj(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=tS(u);p=Zj(d[g],y,i)}return p}function gx(s,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let b={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;Hn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let E=sa([i,b.relativePath]),j=t.concat(b);d.children&&d.children.length>0&&(Hn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),gx(d.children,e,j,E,g)),!(d.path==null&&!d.index)&&e.push({path:E,score:Xj(E,d.index),routesMeta:j})};return s.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of yx(d.path))u(d,p,!0,g)}),e}function yx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=yx(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function Hj(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Jj(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $j=/^:[\w-]+$/,Wj=3,Gj=2,Kj=1,Yj=10,Qj=-2,n2=s=>s==="*";function Xj(s,e){let t=s.split("/"),i=t.length;return t.some(n2)&&(i+=Qj),e&&(i+=Gj),t.filter(l=>!n2(l)).reduce((l,u)=>l+($j.test(u)?Wj:u===""?Kj:Yj),i)}function Jj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Zj(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",E=Mh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},b),j=g.route;if(!E&&y&&t&&!i[i.length-1].route.index&&(E=Mh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!E)return null;Object.assign(l,E.params),d.push({params:l,pathname:sa([u,E.pathname]),pathnameBase:iS(sa([u,E.pathnameBase])),route:j}),E.pathnameBase!=="/"&&(u=sa([u,E.pathnameBase]))}return d}function Mh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=eS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:b,isOptional:E},j)=>{if(b==="*"){let F=p[j]||"";d=u.slice(0,u.length-F.length).replace(/(.)\/+$/,"$1")}const P=p[j];return E&&!P?y[b]=void 0:y[b]=(P||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:s}}function eS(s,e=!1,t=!0){Gr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function tS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function oa(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function sS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Jl(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=s2(t.substring(1),"/"):u=s2(t,e)):u=e,{pathname:u,search:aS(i),hash:oS(l)}}function s2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ip(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jg(s){let e=rS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Zg(s,e,t,i=!1){let l;typeof s=="string"?l=Jl(s):(l={...s},Hn(!l.pathname||!l.pathname.includes("?"),Ip("?","pathname","search",l)),Hn(!l.pathname||!l.pathname.includes("#"),Ip("#","pathname","hash",l)),Hn(!l.search||!l.search.includes("#"),Ip("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let E=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),E-=1;l.pathname=j.join("/")}p=E>=0?e[E]:"/"}let g=sS(l,p),y=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||b)&&(g.pathname+="/"),g}var sa=s=>s.join("/").replace(/\/\/+/g,"/"),iS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),aS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,oS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,lS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function uS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bx(s,e){let t=s;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(vx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=oa(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{Gr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wx=["POST","PUT","PATCH","DELETE"];new Set(wx);var dS=["GET",...wx];new Set(dS);var Zl=w.createContext(null);Zl.displayName="DataRouter";var nf=w.createContext(null);nf.displayName="DataRouterState";var hS=w.createContext(!1),xx=w.createContext({isTransitioning:!1});xx.displayName="ViewTransition";var fS=w.createContext(new Map);fS.displayName="Fetchers";var mS=w.createContext(null);mS.displayName="Await";var Ir=w.createContext(null);Ir.displayName="Navigation";var Cu=w.createContext(null);Cu.displayName="Location";var di=w.createContext({outlet:null,matches:[],isDataRoute:!1});di.displayName="Route";var ey=w.createContext(null);ey.displayName="RouteError";var _x="REACT_ROUTER_ERROR",pS="REDIRECT",gS="ROUTE_ERROR_RESPONSE";function yS(s){if(s.startsWith(`${_x}:${pS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(s){if(s.startsWith(`${_x}:${gS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lS(e.status,e.statusText,e.data)}catch{}}function bS(s,{relative:e}={}){Hn(ec(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Ir),{hash:l,pathname:u,search:d}=Nu(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:sa([t,u])),i.createHref({pathname:p,search:d,hash:l})}function ec(){return w.useContext(Cu)!=null}function Ii(){return Hn(ec(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Cu).location}var kx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ex(s){w.useContext(Ir).static||w.useLayoutEffect(s)}function Xs(){let{isDataRoute:s}=w.useContext(di);return s?MS():wS()}function wS(){Hn(ec(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(Zl),{basename:e,navigator:t}=w.useContext(Ir),{matches:i}=w.useContext(di),{pathname:l}=Ii(),u=JSON.stringify(Jg(i)),d=w.useRef(!1);return Ex(()=>{d.current=!0}),w.useCallback((g,y={})=>{if(Gr(d.current,kx),!d.current)return;if(typeof g=="number"){t.go(g);return}let b=Zg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:sa([e,b.pathname])),(y.replace?t.replace:t.push)(b,y.state,y)},[e,t,u,l,s])}w.createContext(null);function xS(){let{matches:s}=w.useContext(di),e=s[s.length-1];return e?e.params:{}}function Nu(s,{relative:e}={}){let{matches:t}=w.useContext(di),{pathname:i}=Ii(),l=JSON.stringify(Jg(t));return w.useMemo(()=>Zg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function _S(s,e){return Tx(s,e)}function Tx(s,e,t,i,l){Hn(ec(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Ir),{matches:d}=w.useContext(di),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let G=E&&E.path||"";Sx(y,!E||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let j=Ii(),P;if(e){let G=typeof e=="string"?Jl(e):e;Hn(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),P=G}else P=j;let F=P.pathname||"/",W=F;if(b!=="/"){let G=b.replace(/^\//,"").split("/");W="/"+F.replace(/^\//,"").split("/").slice(G.length).join("/")}let z=px(s,{pathname:W});Gr(E||z!=null,`No routes matched location "${P.pathname}${P.search}${P.hash}" `),Gr(z==null||z[z.length-1].route.element!==void 0||z[z.length-1].route.Component!==void 0||z[z.length-1].route.lazy!==void 0,`Matched leaf route at location "${P.pathname}${P.search}${P.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=SS(z&&z.map(G=>Object.assign({},G,{params:Object.assign({},g,G.params),pathname:sa([b,u.encodeLocation?u.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:sa([b,u.encodeLocation?u.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),d,t,i,l);return e&&H?w.createElement(Cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...P},navigationType:"POP"}},H):H}function kS(){let s=IS(),e=cS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var ES=w.createElement(kS,null),jx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=vS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(di.Provider,{value:this.props.routeContext},w.createElement(ey.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(TS,{error:s},e):e}};jx.contextType=hS;var Mp=new WeakMap;function TS({children:s,error:e}){let{basename:t}=w.useContext(Ir);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=yS(e.digest);if(i){let l=Mp.get(e);if(l)throw l;let u=bx(i.location,t);if(vx&&!Mp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Mp.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function jS({routeContext:s,match:e,children:t}){let i=w.useContext(Zl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(di.Provider,{value:s},t)}function SS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(E=>E.route.id&&d?.[E.route.id]!==void 0);Hn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let E=u[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(g=b),E.route.id){let{loaderData:j,errors:P}=t,F=E.route.loader&&!j.hasOwnProperty(E.route.id)&&(!P||P[E.route.id]===void 0);if(E.route.lazy||F){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(b,E)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:uS(t.matches),errorInfo:E})}:void 0;return u.reduceRight((b,E,j)=>{let P,F=!1,W=null,z=null;t&&(P=d&&E.route.id?d[E.route.id]:void 0,W=E.route.errorElement||ES,p&&(g<0&&j===0?(Sx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,z=null):g===j&&(F=!0,z=E.route.hydrateFallbackElement||null)));let H=e.concat(u.slice(0,j+1)),G=()=>{let X;return P?X=W:F?X=z:E.route.Component?X=w.createElement(E.route.Component,null):E.route.element?X=E.route.element:X=b,w.createElement(jS,{match:E,routeContext:{outlet:b,matches:H,isDataRoute:t!=null},children:X})};return t&&(E.route.ErrorBoundary||E.route.errorElement||j===0)?w.createElement(jx,{location:t.location,revalidation:t.revalidation,component:W,error:P,children:G(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:y}):G()},null)}function ty(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(s){let e=w.useContext(Zl);return Hn(e,ty(s)),e}function NS(s){let e=w.useContext(nf);return Hn(e,ty(s)),e}function AS(s){let e=w.useContext(di);return Hn(e,ty(s)),e}function ny(s){let e=AS(s),t=e.matches[e.matches.length-1];return Hn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function RS(){return ny("useRouteId")}function IS(){let s=w.useContext(ey),e=NS("useRouteError"),t=ny("useRouteError");return s!==void 0?s:e.errors?.[t]}function MS(){let{router:s}=CS("useNavigate"),e=ny("useNavigate"),t=w.useRef(!1);return Ex(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Gr(t.current,kx),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var r2={};function Sx(s,e,t){!e&&!r2[s]&&(r2[s]=!0,Gr(!1,t))}w.memo(DS);function DS({routes:s,future:e,state:t,onError:i}){return Tx(s,void 0,t,i,e)}function Cx({to:s,replace:e,state:t,relative:i}){Hn(ec(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Ir);Gr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(di),{pathname:d}=Ii(),p=Xs(),g=Zg(s,Jg(u),d,i==="path"),y=JSON.stringify(g);return w.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Cn(s){Hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Hn(!ec(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=w.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=Jl(t));let{pathname:y="/",search:b="",hash:E="",state:j=null,key:P="default"}=t,F=w.useMemo(()=>{let W=oa(y,p);return W==null?null:{location:{pathname:W,search:b,hash:E,state:j,key:P},navigationType:i}},[p,y,b,E,j,P,i]);return Gr(F!=null,`<Router basename="${p}"> is not able to match the URL "${y}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:w.createElement(Ir.Provider,{value:g},w.createElement(Cu.Provider,{children:e,value:F}))}function OS({children:s,location:e}){return _S(yg(s),e)}function yg(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,yg(i.props.children,u));return}Hn(i.type===Cn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Hn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=yg(i.props.children,u)),t.push(d)}),t}var wh="get",xh="application/x-www-form-urlencoded";function sf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function PS(s){return sf(s)&&s.tagName.toLowerCase()==="button"}function VS(s){return sf(s)&&s.tagName.toLowerCase()==="form"}function US(s){return sf(s)&&s.tagName.toLowerCase()==="input"}function BS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function zS(s,e){return s.button===0&&(!e||e==="_self")&&!BS(s)}function vg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function FS(s,e){let t=vg(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var ih=null;function qS(){if(ih===null)try{new FormData(document.createElement("form"),0),ih=!1}catch{ih=!0}return ih}var HS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dp(s){return s!=null&&!HS.has(s)?(Gr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xh}"`),null):s}function $S(s,e){let t,i,l,u,d;if(VS(s)){let p=s.getAttribute("action");i=p?oa(p,e):null,t=s.getAttribute("method")||wh,l=Dp(s.getAttribute("enctype"))||xh,u=new FormData(s)}else if(PS(s)||US(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?oa(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||wh,l=Dp(s.getAttribute("formenctype"))||Dp(p.getAttribute("enctype"))||xh,u=new FormData(p,s),!qS()){let{name:y,type:b,value:E}=s;if(b==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,E)}}else{if(sf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=wh,i=null,l=xh,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function WS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&oa(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function GS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function YS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await GS(u,t);return d.links?d.links():[]}return[]}));return ZS(i.flat(1).filter(KS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function i2(s,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function QS(s,e,{includeHydrateFallback:t}={}){return XS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function XS(s){return[...new Set(s)]}function JS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function ZS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(JS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Nx(){let s=w.useContext(Zl);return sy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function eC(){let s=w.useContext(nf);return sy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ry=w.createContext(void 0);ry.displayName="FrameworkContext";function Ax(){let s=w.useContext(ry);return sy(s,"You must render this element inside a <HydratedRouter> element"),s}function tC(s,e){let t=w.useContext(ry),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:b,onTouchStart:E}=e,j=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let W=H=>{H.forEach(G=>{d(G.isIntersecting)})},z=new IntersectionObserver(W,{threshold:.5});return j.current&&z.observe(j.current),()=>{z.disconnect()}}},[s]),w.useEffect(()=>{if(i){let W=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(W)}}},[i]);let P=()=>{l(!0)},F=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,j,{}]:[u,j,{onFocus:Gc(p,P),onBlur:Gc(g,F),onMouseEnter:Gc(y,P),onMouseLeave:Gc(b,F),onTouchStart:Gc(E,P)}]:[!1,j,{}]}function Gc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function nC({page:s,...e}){let{router:t}=Nx(),i=w.useMemo(()=>px(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(rC,{page:s,matches:i,...e}):null}function sC(s){let{manifest:e,routeModules:t}=Ax(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return YS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function rC({page:s,matches:e,...t}){let i=Ii(),{future:l,manifest:u,routeModules:d}=Ax(),{basename:p}=Nx(),{loaderData:g,matches:y}=eC(),b=w.useMemo(()=>i2(s,e,y,u,i,"data"),[s,e,y,u,i]),E=w.useMemo(()=>i2(s,e,y,u,i,"assets"),[s,e,y,u,i]),j=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let W=new Set,z=!1;if(e.forEach(G=>{let X=u.routes[G.route.id];!X||!X.hasLoader||(!b.some(de=>de.route.id===G.route.id)&&G.route.id in g&&d[G.route.id]?.shouldRevalidate||X.hasClientLoader?z=!0:W.add(G.route.id))}),W.size===0)return[];let H=WS(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return z&&W.size>0&&H.searchParams.set("_routes",e.filter(G=>W.has(G.route.id)).map(G=>G.route.id).join(",")),[H.pathname+H.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,s,d]),P=w.useMemo(()=>QS(E,u),[E,u]),F=sC(E);return w.createElement(w.Fragment,null,j.map(W=>w.createElement("link",{key:W,rel:"prefetch",as:"fetch",href:W,...t})),P.map(W=>w.createElement("link",{key:W,rel:"modulepreload",href:W,...t})),F.map(({key:W,link:z})=>w.createElement("link",{key:W,nonce:t.nonce,...z,crossOrigin:z.crossOrigin??t.crossOrigin})))}function iC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var aC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{aC&&(window.__reactRouterVersion="7.13.0")}catch{}function oC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=Uj({window:i,v5Compat:!0}));let u=l.current,[d,p]=w.useState({action:u.action,location:u.location}),g=w.useCallback(y=>{t===!1?p(y):w.startTransition(()=>p(y))},[t]);return w.useLayoutEffect(()=>u.listen(g),[u,g]),w.createElement(LS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Rx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ix=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:j,...P},F){let{basename:W,unstable_useTransitions:z}=w.useContext(Ir),H=typeof y=="string"&&Rx.test(y),G=bx(y,W);y=G.to;let X=bS(y,{relative:l}),[de,_e,pe]=tC(i,P),C=dC(y,{replace:d,state:p,target:g,preventScrollReset:b,relative:l,viewTransition:E,unstable_defaultShouldRevalidate:j,unstable_useTransitions:z});function S(V){e&&e(V),V.defaultPrevented||C(V)}let M=w.createElement("a",{...P,...pe,href:G.absoluteURL||X,onClick:G.isExternal||u?e:S,ref:iC(F,_e),target:g,"data-discover":!H&&t==="render"?"true":void 0});return de&&!H?w.createElement(w.Fragment,null,M,w.createElement(nC,{page:X})):M});Ix.displayName="Link";var lC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},b){let E=Nu(d,{relative:y.relative}),j=Ii(),P=w.useContext(nf),{navigator:F,basename:W}=w.useContext(Ir),z=P!=null&&gC(E)&&p===!0,H=F.encodeLocation?F.encodeLocation(E).pathname:E.pathname,G=j.pathname,X=P&&P.navigation&&P.navigation.location?P.navigation.location.pathname:null;t||(G=G.toLowerCase(),X=X?X.toLowerCase():null,H=H.toLowerCase()),X&&W&&(X=oa(X,W)||X);const de=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let _e=G===H||!l&&G.startsWith(H)&&G.charAt(de)==="/",pe=X!=null&&(X===H||!l&&X.startsWith(H)&&X.charAt(H.length)==="/"),C={isActive:_e,isPending:pe,isTransitioning:z},S=_e?e:void 0,M;typeof i=="function"?M=i(C):M=[i,_e?"active":null,pe?"pending":null,z?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(C):u;return w.createElement(Ix,{...y,"aria-current":S,className:M,ref:b,style:V,to:d,viewTransition:p},typeof g=="function"?g(C):g)});lC.displayName="NavLink";var cC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=wh,action:p,onSubmit:g,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:j,...P},F)=>{let{unstable_useTransitions:W}=w.useContext(Ir),z=mC(),H=pC(p,{relative:y}),G=d.toLowerCase()==="get"?"get":"post",X=typeof p=="string"&&Rx.test(p),de=_e=>{if(g&&g(_e),_e.defaultPrevented)return;_e.preventDefault();let pe=_e.nativeEvent.submitter,C=pe?.getAttribute("formmethod")||d,S=()=>z(pe||_e.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:j});W&&t!==!1?w.startTransition(()=>S()):S()};return w.createElement("form",{ref:F,method:G,action:H,onSubmit:i?g:de,...P,"data-discover":!X&&s==="render"?"true":void 0})});cC.displayName="Form";function uC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mx(s){let e=w.useContext(Zl);return Hn(e,uC(s)),e}function dC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Xs(),b=Ii(),E=Nu(s,{relative:u});return w.useCallback(j=>{if(zS(j,e)){j.preventDefault();let P=t!==void 0?t:fu(b)===fu(E),F=()=>y(s,{replace:P,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?w.startTransition(()=>F()):F()}},[b,y,E,t,i,e,s,l,u,d,p,g])}function AO(s){Gr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(vg(s)),t=w.useRef(!1),i=Ii(),l=w.useMemo(()=>FS(i.search,t.current?null:e.current),[i.search]),u=Xs(),d=w.useCallback((p,g)=>{const y=vg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var hC=0,fC=()=>`__${String(++hC)}__`;function mC(){let{router:s}=Mx("useSubmit"),{basename:e}=w.useContext(Ir),t=RS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:b,body:E}=$S(u,e);if(d.navigate===!1){let j=d.fetcherKey||fC();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:E,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:E,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function pC(s,{relative:e}={}){let{basename:t}=w.useContext(Ir),i=w.useContext(di);Hn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Nu(s||".",{relative:e})},d=Ii();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:sa([t,u.pathname])),fu(u)}function gC(s,{relative:e}={}){let t=w.useContext(xx);Hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Mx("useViewTransitionState"),l=Nu(s,{relative:e});if(!t.isTransitioning)return!1;let u=oa(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=oa(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Mh(l.pathname,d)!=null||Mh(l.pathname,u)!=null}const yC=()=>{};var a2={};const Dx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},vC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Lx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,p=d?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,b=u>>2,E=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,P=y&63;g||(P=64,d||(j=64)),i.push(t[b],t[E],t[j],t[P])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Dx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):vC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const E=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||E==null)throw new bC;const j=u<<2|p>>4;if(i.push(j),y!==64){const P=p<<4&240|y>>2;if(i.push(P),E!==64){const F=y<<6&192|E;i.push(F)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class bC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(s){const e=Dx(s);return Lx.encodeByteArray(e,!0)},Dh=function(s){return wC(s).replace(/\./g,"")},Ox=function(s){try{return Lx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _C=()=>xC().__FIREBASE_DEFAULTS__,kC=()=>{if(typeof process>"u"||typeof a2>"u")return;const s=a2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},EC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Ox(s[1]);return e&&JSON.parse(e)},rf=()=>{try{return yC()||_C()||kC()||EC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Px=s=>rf()?.emulatorHosts?.[s],Vx=s=>{const e=Px(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ux=()=>rf()?.config,Bx=s=>rf()?.[`_${s}`];class TC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function ao(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iy(s){return(await fetch(s,{credentials:"include"})).ok}function zx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const au={};function jC(){const s={prod:[],emulator:[]};for(const e of Object.keys(au))au[e]?s.emulator.push(e):s.prod.push(e);return s}function SC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let o2=!1;function ay(s,e){if(typeof window>"u"||typeof document>"u"||!ao(window.location.host)||au[s]===e||au[s]||o2)return;au[s]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=jC().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,P){j.setAttribute("width","24"),j.setAttribute("id",P),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{o2=!0,d()},j}function b(j,P){j.setAttribute("id",P),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function E(){const j=SC(i),P=t("text"),F=document.getElementById(P)||document.createElement("span"),W=t("learnmore"),z=document.getElementById(W)||document.createElement("a"),H=t("preprendIcon"),G=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const X=j.element;p(X),b(z,W);const de=y();g(G,H),X.append(G,F,z,de),document.body.appendChild(X)}u?(F.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,F.innerText="Preview backend running in this workspace."),F.setAttribute("id",P)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function Ys(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ys())}function NC(){const s=rf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function IC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MC(){const s=Ys();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function DC(){return!NC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fx(){try{return typeof indexedDB=="object"}catch{return!1}}function qx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function LC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const OC="FirebaseError";class hi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=OC,Object.setPrototypeOf(this,hi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wo.prototype.create)}}class Wo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PC(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new hi(l,p,i)}}function PC(s,e){return s.replace(VC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const VC=/\{\$([^}]+)}/g;function UC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function la(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(l2(u)&&l2(d)){if(!la(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function l2(s){return s!==null&&typeof s=="object"}function Au(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function eu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function tu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function BC(s,e){const t=new zC(s,e);return t.subscribe.bind(t)}class zC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Lp),l.error===void 0&&(l.error=Lp),l.complete===void 0&&(l.complete=Lp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Lp(){}function pn(s){return s&&s._delegate?s._delegate:s}class Kr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ao="[DEFAULT]";class qC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new TC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($C(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:HC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(s){return s===Ao?void 0:s}function $C(s){return s.instantiationMode==="EAGER"}class WC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ft;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ft||(Ft={}));const GC={debug:Ft.DEBUG,verbose:Ft.VERBOSE,info:Ft.INFO,warn:Ft.WARN,error:Ft.ERROR,silent:Ft.SILENT},KC=Ft.INFO,YC={[Ft.DEBUG]:"log",[Ft.VERBOSE]:"log",[Ft.INFO]:"info",[Ft.WARN]:"warn",[Ft.ERROR]:"error"},QC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=YC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oy{constructor(e){this.name=e,this._logLevel=KC,this._logHandler=QC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ft))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ft.DEBUG,...e),this._logHandler(this,Ft.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ft.VERBOSE,...e),this._logHandler(this,Ft.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ft.INFO,...e),this._logHandler(this,Ft.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ft.WARN,...e),this._logHandler(this,Ft.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ft.ERROR,...e),this._logHandler(this,Ft.ERROR,...e)}}const XC=(s,e)=>e.some(t=>s instanceof t);let c2,u2;function JC(){return c2||(c2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZC(){return u2||(u2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hx=new WeakMap,bg=new WeakMap,$x=new WeakMap,Op=new WeakMap,ly=new WeakMap;function eN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ra(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Hx.set(t,s)}).catch(()=>{}),ly.set(e,s),e}function tN(s){if(bg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});bg.set(s,e)}let wg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return bg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||$x.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ra(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function nN(s){wg=s(wg)}function sN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Pp(this),e,...t);return $x.set(i,e.sort?e.sort():[e]),ra(i)}:ZC().includes(s)?function(...e){return s.apply(Pp(this),e),ra(Hx.get(this))}:function(...e){return ra(s.apply(Pp(this),e))}}function rN(s){return typeof s=="function"?sN(s):(s instanceof IDBTransaction&&tN(s),XC(s,JC())?new Proxy(s,wg):s)}function ra(s){if(s instanceof IDBRequest)return eN(s);if(Op.has(s))return Op.get(s);const e=rN(s);return e!==s&&(Op.set(s,e),ly.set(e,s)),e}const Pp=s=>ly.get(s);function af(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),p=ra(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ra(d.result),g.oldVersion,g.newVersion,ra(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}function Vp(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ra(t).then(()=>{})}const iN=["get","getKey","getAll","getAllKeys","count"],aN=["put","add","delete","clear"],Up=new Map;function d2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Up.get(e))return Up.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=aN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||iN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Up.set(e,u),u}nN(s=>({...s,get:(e,t,i)=>d2(e,t)||s.get(e,t,i),has:(e,t)=>!!d2(e,t)||s.has(e,t)}));class oN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lN(s){return s.getComponent()?.type==="VERSION"}const xg="@firebase/app",h2="0.14.7";const ca=new oy("@firebase/app"),cN="@firebase/app-compat",uN="@firebase/analytics-compat",dN="@firebase/analytics",hN="@firebase/app-check-compat",fN="@firebase/app-check",mN="@firebase/auth",pN="@firebase/auth-compat",gN="@firebase/database",yN="@firebase/data-connect",vN="@firebase/database-compat",bN="@firebase/functions",wN="@firebase/functions-compat",xN="@firebase/installations",_N="@firebase/installations-compat",kN="@firebase/messaging",EN="@firebase/messaging-compat",TN="@firebase/performance",jN="@firebase/performance-compat",SN="@firebase/remote-config",CN="@firebase/remote-config-compat",NN="@firebase/storage",AN="@firebase/storage-compat",RN="@firebase/firestore",IN="@firebase/ai",MN="@firebase/firestore-compat",DN="firebase",LN="12.8.0";const _g="[DEFAULT]",ON={[xg]:"fire-core",[cN]:"fire-core-compat",[dN]:"fire-analytics",[uN]:"fire-analytics-compat",[fN]:"fire-app-check",[hN]:"fire-app-check-compat",[mN]:"fire-auth",[pN]:"fire-auth-compat",[gN]:"fire-rtdb",[yN]:"fire-data-connect",[vN]:"fire-rtdb-compat",[bN]:"fire-fn",[wN]:"fire-fn-compat",[xN]:"fire-iid",[_N]:"fire-iid-compat",[kN]:"fire-fcm",[EN]:"fire-fcm-compat",[TN]:"fire-perf",[jN]:"fire-perf-compat",[SN]:"fire-rc",[CN]:"fire-rc-compat",[NN]:"fire-gcs",[AN]:"fire-gcs-compat",[RN]:"fire-fst",[MN]:"fire-fst-compat",[IN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Lh=new Map,PN=new Map,kg=new Map;function f2(s,e){try{s.container.addComponent(e)}catch(t){ca.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function li(s){const e=s.name;if(kg.has(e))return ca.debug(`There were multiple attempts to register component ${e}.`),!1;kg.set(e,s);for(const t of Lh.values())f2(t,s);for(const t of PN.values())f2(t,s);return!0}function Go(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Nr(s){return s==null?!1:s.settings!==void 0}const VN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xa=new Wo("app","Firebase",VN);class UN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Kr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xa.create("app-deleted",{appName:this._name})}}const Ko=LN;function cy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:_g,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Xa.create("bad-app-name",{appName:String(l)});if(t||(t=Ux()),!t)throw Xa.create("no-options");const u=Lh.get(l);if(u){if(la(t,u.options)&&la(i,u.config))return u;throw Xa.create("duplicate-app",{appName:l})}const d=new WC(l);for(const g of kg.values())d.addComponent(g);const p=new UN(t,i,d);return Lh.set(l,p),p}function Ru(s=_g){const e=Lh.get(s);if(!e&&s===_g&&Ux())return cy();if(!e)throw Xa.create("no-app",{appName:s});return e}function wr(s,e,t){let i=ON[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ca.warn(d.join(" "));return}li(new Kr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const BN="firebase-heartbeat-database",zN=1,mu="firebase-heartbeat-store";let Bp=null;function Wx(){return Bp||(Bp=af(BN,zN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(mu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Xa.create("idb-open",{originalErrorMessage:s.message})})),Bp}async function FN(s){try{const t=(await Wx()).transaction(mu),i=await t.objectStore(mu).get(Gx(s));return await t.done,i}catch(e){if(e instanceof hi)ca.warn(e.message);else{const t=Xa.create("idb-get",{originalErrorMessage:e?.message});ca.warn(t.message)}}}async function m2(s,e){try{const i=(await Wx()).transaction(mu,"readwrite");await i.objectStore(mu).put(e,Gx(s)),await i.done}catch(t){if(t instanceof hi)ca.warn(t.message);else{const i=Xa.create("idb-set",{originalErrorMessage:t?.message});ca.warn(i.message)}}}function Gx(s){return`${s.name}!${s.options.appId}`}const qN=1024,HN=30;class $N{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=p2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>HN){const l=KN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ca.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=p2(),{heartbeatsToSend:t,unsentEntries:i}=WN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ca.warn(e),""}}}function p2(){return new Date().toISOString().substring(0,10)}function WN(s,e=qN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),g2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),g2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fx()?qx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function g2(s){return Dh(JSON.stringify({version:2,heartbeats:s})).length}function KN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function YN(s){li(new Kr("platform-logger",e=>new oN(e),"PRIVATE")),li(new Kr("heartbeat",e=>new $N(e),"PRIVATE")),wr(xg,h2,s),wr(xg,h2,"esm2020"),wr("fire-js","")}YN("");function Kx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QN=Kx,Yx=new Wo("auth","Firebase",Kx());const Oh=new oy("@firebase/auth");function XN(s,...e){Oh.logLevel<=Ft.WARN&&Oh.warn(`Auth (${Ko}): ${s}`,...e)}function _h(s,...e){Oh.logLevel<=Ft.ERROR&&Oh.error(`Auth (${Ko}): ${s}`,...e)}function ci(s,...e){throw uy(s,...e)}function Ti(s,...e){return uy(s,...e)}function Qx(s,e,t){const i={...QN(),[e]:t};return new Wo("auth","Firebase",i).create(e,{appName:s.name})}function ia(s){return Qx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Yx.create(s,...e)}function ft(s,e,...t){if(!s)throw uy(e,...t)}function ta(s){const e="INTERNAL ASSERTION FAILED: "+s;throw _h(e),new Error(e)}function ua(s,e){s||ta(e)}function Eg(){return typeof self<"u"&&self.location?.href||""}function JN(){return y2()==="http:"||y2()==="https:"}function y2(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||RC()||"connection"in navigator)?navigator.onLine:!0}function eA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Iu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ua(t>e,"Short delay should be less than long delay!"),this.isMobile=CC()||IC()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dy(s,e){ua(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ta("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ta("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ta("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const nA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sA=new Iu(3e4,6e4);function fa(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ma(s,e,t,i,l={}){return Jx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Au({key:s.config.apiKey,...d}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return AC()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&ao(s.emulatorConfig.host)&&(y.credentials="include"),Xx.fetch()(await Zx(s,s.config.apiHost,t,p),y)})}async function Jx(s,e,t){s._canInitEmulator=!1;const i={...tA,...e};try{const l=new iA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(s,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw ah(s,"email-already-in-use",d);if(g==="USER_DISABLED")throw ah(s,"user-disabled",d);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Qx(s,b,y);ci(s,b)}}catch(l){if(l instanceof hi)throw l;ci(s,"network-request-failed",{message:String(l)})}}async function Mu(s,e,t,i,l={}){const u=await ma(s,e,t,i,l);return"mfaPendingCredential"in u&&ci(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Zx(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?dy(s.config,l):`${s.config.apiScheme}://${l}`;return nA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ti(this.auth,"network-request-failed")),sA.get())})}}function ah(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ti(s,e,i);return l.customData._tokenResponse=t,l}function v2(s){return s!==void 0&&s.enterprise!==void 0}class aA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oA(s,e){return ma(s,"GET","/v2/recaptchaConfig",fa(s,e))}async function lA(s,e){return ma(s,"POST","/v1/accounts:delete",e)}async function Ph(s,e){return ma(s,"POST","/v1/accounts:lookup",e)}function ou(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cA(s,e=!1){const t=pn(s),i=await t.getIdToken(e),l=hy(i);ft(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:ou(zp(l.auth_time)),issuedAtTime:ou(zp(l.iat)),expirationTime:ou(zp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function zp(s){return Number(s)*1e3}function hy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const l=Ox(t);return l?JSON.parse(l):(_h("Failed to decode base64 JWT payload"),null)}catch(l){return _h("Caught error parsing JWT payload as JSON",l?.toString()),null}}function b2(s){const e=hy(s);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function pu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hi&&uA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function uA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class dA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ou(this.lastLoginAt),this.creationTime=ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(s){const e=s.auth,t=await s.getIdToken(),i=await pu(s,Ph(e,{idToken:t}));ft(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?e_(l.providerUserInfo):[],d=fA(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!d?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Tg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function hA(s){const e=pn(s);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function e_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mA(s,e){const t=await Jx(s,{},async()=>{const i=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await Zx(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&ao(s.emulatorConfig.host)&&(g.credentials="include"),Xx.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pA(s,e){return ma(s,"POST","/v2/accounts:revokeToken",fa(s,e))}class Vl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):b2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const t=b2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Vl;return i&&(ft(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(ft(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(ft(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vl,this.toJSON())}_performRefresh(){return ta("not implemented")}}function za(s,e){ft(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ii{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Tg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await pu(this,this.stsTokenManager.getToken(this.auth,e));return ft(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cA(this,e)}reload(){return hA(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ii({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nr(this.auth.app))return Promise.reject(ia(this.auth));const e=await this.getIdToken();return await pu(this,lA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:j,isAnonymous:P,providerData:F,stsTokenManager:W}=t;ft(E&&W,e,"internal-error");const z=Vl.fromJSON(this.name,W);ft(typeof E=="string",e,"internal-error"),za(i,e.name),za(l,e.name),ft(typeof j=="boolean",e,"internal-error"),ft(typeof P=="boolean",e,"internal-error"),za(u,e.name),za(d,e.name),za(p,e.name),za(g,e.name),za(y,e.name),za(b,e.name);const H=new ii({uid:E,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:P,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:z,createdAt:y,lastLoginAt:b});return F&&Array.isArray(F)&&(H.providerData=F.map(G=>({...G}))),g&&(H._redirectEventId=g),H}static async _fromIdTokenResponse(e,t,i=!1){const l=new Vl;l.updateFromServerResponse(t);const u=new ii({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Vh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];ft(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?e_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Vl;p.updateFromIdToken(i);const g=new ii({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Tg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const w2=new Map;function na(s){ua(s instanceof Function,"Expected a class definition");let e=w2.get(s);return e?(ua(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,w2.set(s,e),e)}class t_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}t_.type="NONE";const x2=t_;function kh(s,e,t){return`firebase:${s}:${e}:${t}`}class Ul{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=kh(this.userKey,l.apiKey,u),this.fullPersistenceKey=kh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?ii._fromGetAccountInfoResponse(this.auth,t,e):null}return ii._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ul(na(x2),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||na(x2);const d=kh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(d);if(b){let E;if(typeof b=="string"){const j=await Ph(e,{idToken:b}).catch(()=>{});if(!j)break;E=await ii._fromGetAccountInfoResponse(e,j,b)}else E=ii._fromJSON(e,b);y!==u&&(p=E),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Ul(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Ul(u,e,i))}}function _2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(o_(e))return"Blackberry";if(l_(e))return"Webos";if(s_(e))return"Safari";if((e.includes("chrome/")||r_(e))&&!e.includes("edge/"))return"Chrome";if(a_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function n_(s=Ys()){return/firefox\//i.test(s)}function s_(s=Ys()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function r_(s=Ys()){return/crios\//i.test(s)}function i_(s=Ys()){return/iemobile/i.test(s)}function a_(s=Ys()){return/android/i.test(s)}function o_(s=Ys()){return/blackberry/i.test(s)}function l_(s=Ys()){return/webos/i.test(s)}function fy(s=Ys()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function gA(s=Ys()){return fy(s)&&!!window.navigator?.standalone}function yA(){return MC()&&document.documentMode===10}function c_(s=Ys()){return fy(s)||a_(s)||l_(s)||o_(s)||/windows phone/i.test(s)||i_(s)}function u_(s,e=[]){let t;switch(s){case"Browser":t=_2(Ys());break;case"Worker":t=`${_2(Ys())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ko}/${i}`}class vA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bA(s,e={}){return ma(s,"GET","/v2/passwordPolicy",fa(s,e))}const wA=6;class xA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??wA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _A{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new k2(this),this.idTokenSubscription=new k2(this),this.beforeStateQueue=new vA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=na(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ul.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await ii._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nr(this.app))return Promise.reject(ia(this));const t=e?pn(e):null;return t&&ft(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nr(this.app)?Promise.reject(ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nr(this.app)?Promise.reject(ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(na(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bA(this),t=new xA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await pA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&na(e)||this._popupRedirectResolver;ft(t,this,"argument-error"),this.redirectPersistenceManager=await Ul.create(this,[na(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oo(s){return pn(s)}class k2{constructor(e){this.auth=e,this.observer=null,this.addObserver=BC(t=>this.observer=t)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kA(s){of=s}function d_(s){return of.loadJS(s)}function EA(){return of.recaptchaEnterpriseScript}function TA(){return of.gapiScript}function jA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class SA{constructor(){this.enterprise=new CA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NA="recaptcha-enterprise",h_="NO_RECAPTCHA";class AA{constructor(e){this.type=NA,this.auth=oo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{oA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new aA(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;v2(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(h_)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&v2(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=EA();g.length!==0&&(g+=p),d_(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function E2(s,e,t,i=!1,l=!1){const u=new AA(s);let d;if(l)d=h_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Uh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await E2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await E2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function RA(s,e){const t=Go(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(la(u,e??{}))return l;ci(l,"already-initialized")}return t.initialize({options:e})}function IA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(na);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function MA(s,e,t){const i=oo(s);ft(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=f_(e),{host:d,port:p}=DA(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){ft(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ft(la(y,i.config.emulator)&&la(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,ao(d)?(iy(`${u}//${d}${g}`),ay("Auth",!0)):LA()}function f_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function DA(s){const e=f_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:T2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:T2(d)}}}function T2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function LA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class my{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ta("not implemented")}_getIdTokenResponse(e){return ta("not implemented")}_linkToIdToken(e,t){return ta("not implemented")}_getReauthenticationResolver(e){return ta("not implemented")}}async function OA(s,e){return ma(s,"POST","/v1/accounts:signUp",e)}async function PA(s,e){return Mu(s,"POST","/v1/accounts:signInWithPassword",fa(s,e))}async function m_(s,e){return ma(s,"POST","/v1/accounts:sendOobCode",fa(s,e))}async function VA(s,e){return m_(s,e)}async function UA(s,e){return m_(s,e)}async function BA(s,e){return Mu(s,"POST","/v1/accounts:signInWithEmailLink",fa(s,e))}async function zA(s,e){return Mu(s,"POST","/v1/accounts:signInWithEmailLink",fa(s,e))}class gu extends my{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new gu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new gu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,t,"signInWithPassword",PA);case"emailLink":return BA(e,{email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,i,"signUpPassword",OA);case"emailLink":return zA(e,{idToken:t,email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Bl(s,e){return Mu(s,"POST","/v1/accounts:signInWithIdp",fa(s,e))}const FA="http://localhost";class Vo extends my{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ci("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Vo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Bl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Bl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bl(e,t)}buildRequest(){const e={requestUri:FA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Au(t)}return e}}function qA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HA(s){const e=eu(tu(s)).link,t=e?eu(tu(e)).deep_link_id:null,i=eu(tu(s)).deep_link_id;return(i?eu(tu(i)).link:null)||i||t||e||s}class py{constructor(e){const t=eu(tu(e)),i=t.apiKey??null,l=t.oobCode??null,u=qA(t.mode??null);ft(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=HA(e);try{return new py(t)}catch{return null}}}class tc{constructor(){this.providerId=tc.PROVIDER_ID}static credential(e,t){return gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=py.parseLink(t);return ft(i,"argument-error"),gu._fromEmailAndCode(e,i.code,i.tenantId)}}tc.PROVIDER_ID="password";tc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class p_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends p_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qa extends Du{constructor(){super("facebook.com")}static credential(e){return Vo._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qa.credentialFromTaggedObject(e)}static credentialFromError(e){return qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qa.credential(e.oauthAccessToken)}catch{return null}}}qa.FACEBOOK_SIGN_IN_METHOD="facebook.com";qa.PROVIDER_ID="facebook.com";class Ha extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vo._fromParams({providerId:Ha.PROVIDER_ID,signInMethod:Ha.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ha.credentialFromTaggedObject(e)}static credentialFromError(e){return Ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ha.credential(t,i)}catch{return null}}}Ha.GOOGLE_SIGN_IN_METHOD="google.com";Ha.PROVIDER_ID="google.com";class $a extends Du{constructor(){super("github.com")}static credential(e){return Vo._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $a.credentialFromTaggedObject(e)}static credentialFromError(e){return $a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $a.credential(e.oauthAccessToken)}catch{return null}}}$a.GITHUB_SIGN_IN_METHOD="github.com";$a.PROVIDER_ID="github.com";class Wa extends Du{constructor(){super("twitter.com")}static credential(e,t){return Vo._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wa.credential(t,i)}catch{return null}}}Wa.TWITTER_SIGN_IN_METHOD="twitter.com";Wa.PROVIDER_ID="twitter.com";async function $A(s,e){return Mu(s,"POST","/v1/accounts:signUp",fa(s,e))}class Uo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ii._fromIdTokenResponse(e,i,l),d=j2(i);return new Uo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=j2(i);return new Uo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function j2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Bh extends hi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Bh(e,t,i,l)}}function g_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(s,u,e,i):u})}async function WA(s,e,t=!1){const i=await pu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Uo._forOperation(s,"link",i)}async function GA(s,e,t=!1){const{auth:i}=s;if(Nr(i.app))return Promise.reject(ia(i));const l="reauthenticate";try{const u=await pu(s,g_(i,l,e,s),t);ft(u.idToken,i,"internal-error");const d=hy(u.idToken);ft(d,i,"internal-error");const{sub:p}=d;return ft(s.uid===p,i,"user-mismatch"),Uo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ci(i,"user-mismatch"),u}}async function y_(s,e,t=!1){if(Nr(s.app))return Promise.reject(ia(s));const i="signIn",l=await g_(s,i,e),u=await Uo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function KA(s,e){return y_(oo(s),e)}async function v_(s){const e=oo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YA(s,e,t){const i=oo(s);await Uh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",UA)}async function QA(s,e,t){if(Nr(s.app))return Promise.reject(ia(s));const i=oo(s),d=await Uh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$A).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&v_(s),g}),p=await Uo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function XA(s,e,t){return Nr(s.app)?Promise.reject(ia(s)):KA(pn(s),tc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&v_(s),i})}async function RO(s,e){const t=pn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await VA(t.auth,l);u!==s.email&&await s.reload()}function S2(s,e){return pn(s).setPersistence(e)}function JA(s,e,t,i){return pn(s).onIdTokenChanged(e,t,i)}function ZA(s,e,t){return pn(s).beforeAuthStateChanged(e,t)}function e4(s,e,t,i){return pn(s).onAuthStateChanged(e,t,i)}function t4(s){return pn(s).signOut()}const zh="__sak";class b_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const n4=1e3,s4=10;class w_ extends b_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=c_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},n4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}w_.type="LOCAL";const jg=w_;class x_ extends b_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}x_.type="SESSION";const gy=x_;function r4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new lf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await r4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function yy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class i4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=yy("",20);l.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(E){const j=E;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function ji(){return window}function a4(s){ji().location.href=s}function __(){return typeof ji().WorkerGlobalScope<"u"&&typeof ji().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return __()?self:null}const k_="firebaseLocalStorageDb",u4=1,Fh="firebaseLocalStorage",E_="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(s,e){return s.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function d4(){const s=indexedDB.deleteDatabase(k_);return new Lu(s).toPromise()}function Sg(){const s=indexedDB.open(k_,u4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Fh,{keyPath:E_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Fh)?e(i):(i.close(),await d4(),e(await Sg()))})})}async function C2(s,e,t){const i=cf(s,!0).put({[E_]:e,value:t});return new Lu(i).toPromise()}async function h4(s,e){const t=cf(s,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function N2(s,e){const t=cf(s,!0).delete(e);return new Lu(t).toPromise()}const f4=800,m4=3;class T_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return __()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new i4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sg();return await C2(e,zh,"1"),await N2(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>N2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=cf(l,!1).getAll();return new Lu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}T_.type="LOCAL";const p4=T_;new Iu(3e4,6e4);function g4(s,e){return e?na(e):(ft(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class vy extends my{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function y4(s){return y_(s.auth,new vy(s),s.bypassAuthState)}function v4(s){const{auth:e,user:t}=s;return ft(t,e,"internal-error"),GA(t,new vy(s),s.bypassAuthState)}async function b4(s){const{auth:e,user:t}=s;return ft(t,e,"internal-error"),WA(t,new vy(s),s.bypassAuthState)}class j_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y4;case"linkViaPopup":case"linkViaRedirect":return b4;case"reauthViaPopup":case"reauthViaRedirect":return v4;default:ci(this.auth,"internal-error")}}resolve(e){ua(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ua(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const w4=new Iu(2e3,1e4);class Pl extends j_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Pl.currentPopupAction&&Pl.currentPopupAction.cancel(),Pl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){ua(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ti(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ti(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ti(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,w4.get())};e()}}Pl.currentPopupAction=null;const x4="pendingRedirect",Eh=new Map;class _4 extends j_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Eh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Eh.set(this.auth._key(),e)}return this.bypassAuthState||Eh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(s,e){const t=j4(e),i=T4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function E4(s,e){Eh.set(s._key(),e)}function T4(s){return na(s._redirectPersistence)}function j4(s){return kh(x4,s.config.apiKey,s.name)}async function S4(s,e,t=!1){if(Nr(s.app))return Promise.reject(ia(s));const i=oo(s),l=g4(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const C4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!S_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ti(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C4&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function S_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function A4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S_(s);default:return!1}}async function R4(s,e={}){return ma(s,"GET","/v1/projects",e)}const I4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function D4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await R4(s);for(const t of e)try{if(L4(t))return}catch{}ci(s,"unauthorized-domain")}function L4(s){const e=Eg(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(I4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const O4=new Iu(3e4,6e4);function R2(){const s=ji().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function P4(s){return new Promise((e,t)=>{function i(){R2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{R2(),t(Ti(s,"network-request-failed"))},timeout:O4.get()})}if(ji().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ji().gapi?.load)i();else{const l=jA("iframefcb");return ji()[l]=()=>{gapi.load?i():t(Ti(s,"network-request-failed"))},d_(`${TA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function V4(s){return Th=Th||P4(s),Th}const U4=new Iu(5e3,15e3),B4="__/auth/iframe",z4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function H4(s){const e=s.config;ft(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dy(e,z4):`https://${s.config.authDomain}/${B4}`,i={apiKey:e.apiKey,appName:s.name,v:Ko},l=q4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Au(i).slice(1)}`}async function $4(s){const e=await V4(s),t=ji().gapi;return ft(t,s,"internal-error"),e.open({where:document.body,url:H4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ti(s,"network-request-failed"),p=ji().setTimeout(()=>{u(d)},U4.get());function g(){ji().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class I2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(s,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...W4,width:i.toString(),height:l.toString(),top:u,left:d},y=Ys().toLowerCase();t&&(p=r_(y)?Y4:t),n_(y)&&(e=e||Q4,g.scrollbars="yes");const b=Object.entries(g).reduce((j,[P,F])=>`${j}${P}=${F},`,"");if(gA(y)&&p!=="_self")return J4(e||"",p),new I2(null);const E=window.open(e||"",p,b);ft(E,s,"popup-blocked");try{E.focus()}catch{}return new I2(E)}function J4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function M2(s,e,t,i,l,u){ft(s.config.authDomain,s,"auth-domain-config-required"),ft(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Ko,eventId:l};if(e instanceof p_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",UC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries({}))d[b]=E}if(e instanceof Du){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),y=g?`#${tR}=${encodeURIComponent(g)}`:"";return`${nR(s)}?${Au(p).slice(1)}${y}`}function nR({config:s}){return s.emulator?dy(s,eR):`https://${s.authDomain}/${Z4}`}const Fp="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gy,this._completeRedirectFn=S4,this._overrideRedirectResult=E4}async _openPopup(e,t,i,l){ua(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await M2(e,t,i,Eg(),l);return X4(e,u,yy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await M2(e,t,i,Eg(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(ua(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new N4(e);return t.register("authEvent",l=>(ft(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fp,{type:Fp},l=>{const u=l?.[0]?.[Fp];u!==void 0&&t(!!u),ci(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return c_()||s_()||fy()}}const rR=sR;var D2="@firebase/auth",L2="1.12.0";class iR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(s){li(new Kr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;ft(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u_(s)},y=new _A(i,l,u,g);return IA(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),li(new Kr("auth-internal",e=>{const t=oo(e.getProvider("auth").getImmediate());return(i=>new iR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(D2,L2,aR(s)),wr(D2,L2,"esm2020")}const lR=300,cR=Bx("authIdTokenMaxAge")||lR;let O2=null;const uR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;O2!==l&&(O2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function C_(s=Ru()){const e=Go(s,"auth");if(e.isInitialized())return e.getImmediate();const t=RA(s,{popupRedirectResolver:rR,persistence:[p4,jg,gy]}),i=Bx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZA(t,d,()=>d(t.currentUser)),JA(t,p=>d(p))}}const l=Px("auth");return l&&MA(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ti("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var P2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ja,N_;(function(){var s;function e(C,S){function M(){}M.prototype=S.prototype,C.F=S.prototype,C.prototype=new M,C.prototype.constructor=C,C.D=function(V,D,L){for(var R=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)R[Ie-2]=arguments[Ie];return S.prototype[D].apply(V,R)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,S,M){M||(M=0);const V=Array(16);if(typeof S=="string")for(var D=0;D<16;++D)V[D]=S.charCodeAt(M++)|S.charCodeAt(M++)<<8|S.charCodeAt(M++)<<16|S.charCodeAt(M++)<<24;else for(D=0;D<16;++D)V[D]=S[M++]|S[M++]<<8|S[M++]<<16|S[M++]<<24;S=C.g[0],M=C.g[1],D=C.g[2];let L=C.g[3],R;R=S+(L^M&(D^L))+V[0]+3614090360&4294967295,S=M+(R<<7&4294967295|R>>>25),R=L+(D^S&(M^D))+V[1]+3905402710&4294967295,L=S+(R<<12&4294967295|R>>>20),R=D+(M^L&(S^M))+V[2]+606105819&4294967295,D=L+(R<<17&4294967295|R>>>15),R=M+(S^D&(L^S))+V[3]+3250441966&4294967295,M=D+(R<<22&4294967295|R>>>10),R=S+(L^M&(D^L))+V[4]+4118548399&4294967295,S=M+(R<<7&4294967295|R>>>25),R=L+(D^S&(M^D))+V[5]+1200080426&4294967295,L=S+(R<<12&4294967295|R>>>20),R=D+(M^L&(S^M))+V[6]+2821735955&4294967295,D=L+(R<<17&4294967295|R>>>15),R=M+(S^D&(L^S))+V[7]+4249261313&4294967295,M=D+(R<<22&4294967295|R>>>10),R=S+(L^M&(D^L))+V[8]+1770035416&4294967295,S=M+(R<<7&4294967295|R>>>25),R=L+(D^S&(M^D))+V[9]+2336552879&4294967295,L=S+(R<<12&4294967295|R>>>20),R=D+(M^L&(S^M))+V[10]+4294925233&4294967295,D=L+(R<<17&4294967295|R>>>15),R=M+(S^D&(L^S))+V[11]+2304563134&4294967295,M=D+(R<<22&4294967295|R>>>10),R=S+(L^M&(D^L))+V[12]+1804603682&4294967295,S=M+(R<<7&4294967295|R>>>25),R=L+(D^S&(M^D))+V[13]+4254626195&4294967295,L=S+(R<<12&4294967295|R>>>20),R=D+(M^L&(S^M))+V[14]+2792965006&4294967295,D=L+(R<<17&4294967295|R>>>15),R=M+(S^D&(L^S))+V[15]+1236535329&4294967295,M=D+(R<<22&4294967295|R>>>10),R=S+(D^L&(M^D))+V[1]+4129170786&4294967295,S=M+(R<<5&4294967295|R>>>27),R=L+(M^D&(S^M))+V[6]+3225465664&4294967295,L=S+(R<<9&4294967295|R>>>23),R=D+(S^M&(L^S))+V[11]+643717713&4294967295,D=L+(R<<14&4294967295|R>>>18),R=M+(L^S&(D^L))+V[0]+3921069994&4294967295,M=D+(R<<20&4294967295|R>>>12),R=S+(D^L&(M^D))+V[5]+3593408605&4294967295,S=M+(R<<5&4294967295|R>>>27),R=L+(M^D&(S^M))+V[10]+38016083&4294967295,L=S+(R<<9&4294967295|R>>>23),R=D+(S^M&(L^S))+V[15]+3634488961&4294967295,D=L+(R<<14&4294967295|R>>>18),R=M+(L^S&(D^L))+V[4]+3889429448&4294967295,M=D+(R<<20&4294967295|R>>>12),R=S+(D^L&(M^D))+V[9]+568446438&4294967295,S=M+(R<<5&4294967295|R>>>27),R=L+(M^D&(S^M))+V[14]+3275163606&4294967295,L=S+(R<<9&4294967295|R>>>23),R=D+(S^M&(L^S))+V[3]+4107603335&4294967295,D=L+(R<<14&4294967295|R>>>18),R=M+(L^S&(D^L))+V[8]+1163531501&4294967295,M=D+(R<<20&4294967295|R>>>12),R=S+(D^L&(M^D))+V[13]+2850285829&4294967295,S=M+(R<<5&4294967295|R>>>27),R=L+(M^D&(S^M))+V[2]+4243563512&4294967295,L=S+(R<<9&4294967295|R>>>23),R=D+(S^M&(L^S))+V[7]+1735328473&4294967295,D=L+(R<<14&4294967295|R>>>18),R=M+(L^S&(D^L))+V[12]+2368359562&4294967295,M=D+(R<<20&4294967295|R>>>12),R=S+(M^D^L)+V[5]+4294588738&4294967295,S=M+(R<<4&4294967295|R>>>28),R=L+(S^M^D)+V[8]+2272392833&4294967295,L=S+(R<<11&4294967295|R>>>21),R=D+(L^S^M)+V[11]+1839030562&4294967295,D=L+(R<<16&4294967295|R>>>16),R=M+(D^L^S)+V[14]+4259657740&4294967295,M=D+(R<<23&4294967295|R>>>9),R=S+(M^D^L)+V[1]+2763975236&4294967295,S=M+(R<<4&4294967295|R>>>28),R=L+(S^M^D)+V[4]+1272893353&4294967295,L=S+(R<<11&4294967295|R>>>21),R=D+(L^S^M)+V[7]+4139469664&4294967295,D=L+(R<<16&4294967295|R>>>16),R=M+(D^L^S)+V[10]+3200236656&4294967295,M=D+(R<<23&4294967295|R>>>9),R=S+(M^D^L)+V[13]+681279174&4294967295,S=M+(R<<4&4294967295|R>>>28),R=L+(S^M^D)+V[0]+3936430074&4294967295,L=S+(R<<11&4294967295|R>>>21),R=D+(L^S^M)+V[3]+3572445317&4294967295,D=L+(R<<16&4294967295|R>>>16),R=M+(D^L^S)+V[6]+76029189&4294967295,M=D+(R<<23&4294967295|R>>>9),R=S+(M^D^L)+V[9]+3654602809&4294967295,S=M+(R<<4&4294967295|R>>>28),R=L+(S^M^D)+V[12]+3873151461&4294967295,L=S+(R<<11&4294967295|R>>>21),R=D+(L^S^M)+V[15]+530742520&4294967295,D=L+(R<<16&4294967295|R>>>16),R=M+(D^L^S)+V[2]+3299628645&4294967295,M=D+(R<<23&4294967295|R>>>9),R=S+(D^(M|~L))+V[0]+4096336452&4294967295,S=M+(R<<6&4294967295|R>>>26),R=L+(M^(S|~D))+V[7]+1126891415&4294967295,L=S+(R<<10&4294967295|R>>>22),R=D+(S^(L|~M))+V[14]+2878612391&4294967295,D=L+(R<<15&4294967295|R>>>17),R=M+(L^(D|~S))+V[5]+4237533241&4294967295,M=D+(R<<21&4294967295|R>>>11),R=S+(D^(M|~L))+V[12]+1700485571&4294967295,S=M+(R<<6&4294967295|R>>>26),R=L+(M^(S|~D))+V[3]+2399980690&4294967295,L=S+(R<<10&4294967295|R>>>22),R=D+(S^(L|~M))+V[10]+4293915773&4294967295,D=L+(R<<15&4294967295|R>>>17),R=M+(L^(D|~S))+V[1]+2240044497&4294967295,M=D+(R<<21&4294967295|R>>>11),R=S+(D^(M|~L))+V[8]+1873313359&4294967295,S=M+(R<<6&4294967295|R>>>26),R=L+(M^(S|~D))+V[15]+4264355552&4294967295,L=S+(R<<10&4294967295|R>>>22),R=D+(S^(L|~M))+V[6]+2734768916&4294967295,D=L+(R<<15&4294967295|R>>>17),R=M+(L^(D|~S))+V[13]+1309151649&4294967295,M=D+(R<<21&4294967295|R>>>11),R=S+(D^(M|~L))+V[4]+4149444226&4294967295,S=M+(R<<6&4294967295|R>>>26),R=L+(M^(S|~D))+V[11]+3174756917&4294967295,L=S+(R<<10&4294967295|R>>>22),R=D+(S^(L|~M))+V[2]+718787259&4294967295,D=L+(R<<15&4294967295|R>>>17),R=M+(L^(D|~S))+V[9]+3951481745&4294967295,C.g[0]=C.g[0]+S&4294967295,C.g[1]=C.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.v=function(C,S){S===void 0&&(S=C.length);const M=S-this.blockSize,V=this.C;let D=this.h,L=0;for(;L<S;){if(D==0)for(;L<=M;)l(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<S;)if(V[D++]=C.charCodeAt(L++),D==this.blockSize){l(this,V),D=0;break}}else for(;L<S;)if(V[D++]=C[L++],D==this.blockSize){l(this,V),D=0;break}}this.h=D,this.o+=S},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var S=1;S<C.length-8;++S)C[S]=0;S=this.o*8;for(var M=C.length-8;M<C.length;++M)C[M]=S&255,S/=256;for(this.v(C),C=Array(16),S=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)C[S++]=this.g[M]>>>V&255;return C};function u(C,S){var M=p;return Object.prototype.hasOwnProperty.call(M,C)?M[C]:M[C]=S(C)}function d(C,S){this.h=S;const M=[];let V=!0;for(let D=C.length-1;D>=0;D--){const L=C[D]|0;V&&L==S||(M[D]=L,V=!1)}this.g=M}var p={};function g(C){return-128<=C&&C<128?u(C,function(S){return new d([S|0],S<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return E;if(C<0)return z(y(-C));const S=[];let M=1;for(let V=0;C>=M;V++)S[V]=C/M|0,M*=4294967296;return new d(S,0)}function b(C,S){if(C.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(C.charAt(0)=="-")return z(b(C.substring(1),S));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(S,8));let V=E;for(let L=0;L<C.length;L+=8){var D=Math.min(8,C.length-L);const R=parseInt(C.substring(L,L+D),S);D<8?(D=y(Math.pow(S,D)),V=V.j(D).add(y(R))):(V=V.j(M),V=V.add(y(R)))}return V}var E=g(0),j=g(1),P=g(16777216);s=d.prototype,s.m=function(){if(W(this))return-z(this).m();let C=0,S=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);C+=(V>=0?V:4294967296+V)*S,S*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(F(this))return"0";if(W(this))return"-"+z(this).toString(C);const S=y(Math.pow(C,6));var M=this;let V="";for(;;){const D=de(M,S).g;M=H(M,D.j(S));let L=((M.g.length>0?M.g[0]:M.h)>>>0).toString(C);if(M=D,F(M))return L+V;for(;L.length<6;)L="0"+L;V=L+V}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function F(C){if(C.h!=0)return!1;for(let S=0;S<C.g.length;S++)if(C.g[S]!=0)return!1;return!0}function W(C){return C.h==-1}s.l=function(C){return C=H(this,C),W(C)?-1:F(C)?0:1};function z(C){const S=C.g.length,M=[];for(let V=0;V<S;V++)M[V]=~C.g[V];return new d(M,~C.h).add(j)}s.abs=function(){return W(this)?z(this):this},s.add=function(C){const S=Math.max(this.g.length,C.g.length),M=[];let V=0;for(let D=0;D<=S;D++){let L=V+(this.i(D)&65535)+(C.i(D)&65535),R=(L>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);V=R>>>16,L&=65535,R&=65535,M[D]=R<<16|L}return new d(M,M[M.length-1]&-2147483648?-1:0)};function H(C,S){return C.add(z(S))}s.j=function(C){if(F(this)||F(C))return E;if(W(this))return W(C)?z(this).j(z(C)):z(z(this).j(C));if(W(C))return z(this.j(z(C)));if(this.l(P)<0&&C.l(P)<0)return y(this.m()*C.m());const S=this.g.length+C.g.length,M=[];for(var V=0;V<2*S;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let D=0;D<C.g.length;D++){const L=this.i(V)>>>16,R=this.i(V)&65535,Ie=C.i(D)>>>16,Ye=C.i(D)&65535;M[2*V+2*D]+=R*Ye,G(M,2*V+2*D),M[2*V+2*D+1]+=L*Ye,G(M,2*V+2*D+1),M[2*V+2*D+1]+=R*Ie,G(M,2*V+2*D+1),M[2*V+2*D+2]+=L*Ie,G(M,2*V+2*D+2)}for(C=0;C<S;C++)M[C]=M[2*C+1]<<16|M[2*C];for(C=S;C<2*S;C++)M[C]=0;return new d(M,0)};function G(C,S){for(;(C[S]&65535)!=C[S];)C[S+1]+=C[S]>>>16,C[S]&=65535,S++}function X(C,S){this.g=C,this.h=S}function de(C,S){if(F(S))throw Error("division by zero");if(F(C))return new X(E,E);if(W(C))return S=de(z(C),S),new X(z(S.g),z(S.h));if(W(S))return S=de(C,z(S)),new X(z(S.g),S.h);if(C.g.length>30){if(W(C)||W(S))throw Error("slowDivide_ only works with positive integers.");for(var M=j,V=S;V.l(C)<=0;)M=_e(M),V=_e(V);var D=pe(M,1),L=pe(V,1);for(V=pe(V,2),M=pe(M,2);!F(V);){var R=L.add(V);R.l(C)<=0&&(D=D.add(M),L=R),V=pe(V,1),M=pe(M,1)}return S=H(C,D.j(S)),new X(D,S)}for(D=E;C.l(S)>=0;){for(M=Math.max(1,Math.floor(C.m()/S.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),L=y(M),R=L.j(S);W(R)||R.l(C)>0;)M-=V,L=y(M),R=L.j(S);F(L)&&(L=j),D=D.add(L),C=H(C,R)}return new X(D,C)}s.B=function(C){return de(this,C).h},s.and=function(C){const S=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<S;V++)M[V]=this.i(V)&C.i(V);return new d(M,this.h&C.h)},s.or=function(C){const S=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<S;V++)M[V]=this.i(V)|C.i(V);return new d(M,this.h|C.h)},s.xor=function(C){const S=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<S;V++)M[V]=this.i(V)^C.i(V);return new d(M,this.h^C.h)};function _e(C){const S=C.g.length+1,M=[];for(let V=0;V<S;V++)M[V]=C.i(V)<<1|C.i(V-1)>>>31;return new d(M,C.h)}function pe(C,S){const M=S>>5;S%=32;const V=C.g.length-M,D=[];for(let L=0;L<V;L++)D[L]=S>0?C.i(L+M)>>>S|C.i(L+M+1)<<32-S:C.i(L+M);return new d(D,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,N_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=b,Ja=d}).apply(typeof P2<"u"?P2:typeof self<"u"?self:typeof window<"u"?window:{});var oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var A_,nu,R_,jh,Cg,I_,M_,D_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof oh=="object"&&oh];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ne=h[A];if(!(ne in k))break e;k=k[ne]}h=h[h.length-1],A=k[h],v=v(A),v!=A&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&k.push([A,v[A]]);return k}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,k){return h.call.apply(h.bind,arguments)}function y(h,v,k){return y=g,y.apply(null,arguments)}function b(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var A=k.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function E(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(A,ne,ue){for(var Oe=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)Oe[Et-2]=arguments[Et];return v.prototype[ne].apply(A,Oe)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function P(h){const v=h.length;if(v>0){const k=Array(v);for(let A=0;A<v;A++)k[A]=h[A];return k}return[]}function F(h,v){for(let A=1;A<arguments.length;A++){const ne=arguments[A];var k=typeof ne;if(k=k!="object"?k:ne?Array.isArray(ne)?"array":k:"null",k=="array"||k=="object"&&typeof ne.length=="number"){k=h.length||0;const ue=ne.length||0;h.length=k+ue;for(let Oe=0;Oe<ue;Oe++)h[k+Oe]=ne[Oe]}else h.push(ne)}}class W{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function z(h){d.setTimeout(()=>{throw h},0)}function H(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class G{constructor(){this.h=this.g=null}add(v,k){const A=X.get();A.set(v,k),this.h?this.h.next=A:this.g=A,this.h=A}}var X=new W(()=>new de,h=>h.reset());class de{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,pe=!1,C=new G,S=()=>{const h=Promise.resolve(void 0);_e=()=>{h.then(M)}};function M(){for(var h;h=H();){try{h.h.call(h.g)}catch(k){z(k)}var v=X;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}pe=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function R(h){return/^[\s\xa0]*$/.test(h)}function Ie(h,v){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}E(Ie,D),Ie.prototype.init=function(h,v){const k=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Ie.Z.h.call(this)},Ie.prototype.h=function(){Ie.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ye="closure_listenable_"+(Math.random()*1e6|0),ee=0;function Ee(h,v,k,A,ne){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!A,this.ha=ne,this.key=++ee,this.da=this.fa=!1}function Pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ne(h,v,k){for(const A in h)v.call(k,h[A],A,h)}function se(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function O(h){const v={};for(const k in h)v[k]=h[k];return v}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(h,v){let k,A;for(let ne=1;ne<arguments.length;ne++){A=arguments[ne];for(k in A)h[k]=A[k];for(let ue=0;ue<te.length;ue++)k=te[ue],Object.prototype.hasOwnProperty.call(A,k)&&(h[k]=A[k])}}function Se(h){this.src=h,this.g={},this.h=0}Se.prototype.add=function(h,v,k,A,ne){const ue=h.toString();h=this.g[ue],h||(h=this.g[ue]=[],this.h++);const Oe=Ce(h,v,A,ne);return Oe>-1?(v=h[Oe],k||(v.fa=!1)):(v=new Ee(v,this.src,ue,!!A,ne),v.fa=k,h.push(v)),v};function xe(h,v){const k=v.type;if(k in h.g){var A=h.g[k],ne=Array.prototype.indexOf.call(A,v,void 0),ue;(ue=ne>=0)&&Array.prototype.splice.call(A,ne,1),ue&&(Pe(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Ce(h,v,k,A){for(let ne=0;ne<h.length;++ne){const ue=h[ne];if(!ue.da&&ue.listener==v&&ue.capture==!!k&&ue.ha==A)return ne}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),Ve={};function Le(h,v,k,A,ne){if(Array.isArray(v)){for(let ue=0;ue<v.length;ue++)Le(h,v[ue],k,A,ne);return null}return k=dt(k),h&&h[Ye]?h.J(v,k,p(A)?!!A.capture:!1,ne):Qt(h,v,k,!1,A,ne)}function Qt(h,v,k,A,ne,ue){if(!v)throw Error("Invalid event type");const Oe=p(ne)?!!ne.capture:!!ne;let Et=Lt(h);if(Et||(h[Be]=Et=new Se(h)),k=Et.add(v,k,A,Oe,ue),k.proxy)return k;if(A=Dt(),k.proxy=A,A.src=h,A.listener=k,h.addEventListener)L||(ne=Oe),ne===void 0&&(ne=!1),h.addEventListener(v.toString(),A,ne);else if(h.attachEvent)h.attachEvent(Ut(v.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Dt(){function h(k){return v.call(h.src,h.listener,k)}const v=gt;return h}function bn(h,v,k,A,ne){if(Array.isArray(v))for(var ue=0;ue<v.length;ue++)bn(h,v[ue],k,A,ne);else A=p(A)?!!A.capture:!!A,k=dt(k),h&&h[Ye]?(h=h.i,ue=String(v).toString(),ue in h.g&&(v=h.g[ue],k=Ce(v,k,A,ne),k>-1&&(Pe(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[ue],h.h--)))):h&&(h=Lt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ce(v,k,A,ne)),(k=h>-1?v[h]:null)&&gn(k))}function gn(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[Ye])xe(v.i,h);else{var k=h.type,A=h.proxy;v.removeEventListener?v.removeEventListener(k,A,h.capture):v.detachEvent?v.detachEvent(Ut(k),A):v.addListener&&v.removeListener&&v.removeListener(A),(k=Lt(v))?(xe(k,h),k.h==0&&(k.src=null,v[Be]=null)):Pe(h)}}}function Ut(h){return h in Ve?Ve[h]:Ve[h]="on"+h}function gt(h,v){if(h.da)h=!0;else{v=new Ie(v,this);const k=h.listener,A=h.ha||h.src;h.fa&&gn(h),h=k.call(A,v)}return h}function Lt(h){return h=h[Be],h instanceof Se?h:null}var sn="__closure_events_fn_"+(Math.random()*1e9>>>0);function dt(h){return typeof h=="function"?h:(h[sn]||(h[sn]=function(v){return h.handleEvent(v)}),h[sn])}function At(){V.call(this),this.i=new Se(this),this.M=this,this.G=null}E(At,V),At.prototype[Ye]=!0,At.prototype.removeEventListener=function(h,v,k,A){bn(this,h,v,k,A)};function oe(h,v){var k,A=h.G;if(A)for(k=[];A;A=A.G)k.push(A);if(h=h.M,A=v.type||v,typeof v=="string")v=new D(v,h);else if(v instanceof D)v.target=v.target||h;else{var ne=v;v=new D(A,h),be(v,ne)}ne=!0;let ue,Oe;if(k)for(Oe=k.length-1;Oe>=0;Oe--)ue=v.g=k[Oe],ne=Xt(ue,A,!0,v)&&ne;if(ue=v.g=h,ne=Xt(ue,A,!0,v)&&ne,ne=Xt(ue,A,!1,v)&&ne,k)for(Oe=0;Oe<k.length;Oe++)ue=v.g=k[Oe],ne=Xt(ue,A,!1,v)&&ne}At.prototype.N=function(){if(At.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let A=0;A<k.length;A++)Pe(k[A]);delete h.g[v],h.h--}}this.G=null},At.prototype.J=function(h,v,k,A){return this.i.add(String(h),v,!1,k,A)},At.prototype.K=function(h,v,k,A){return this.i.add(String(h),v,!0,k,A)};function Xt(h,v,k,A){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let ne=!0;for(let ue=0;ue<v.length;++ue){const Oe=v[ue];if(Oe&&!Oe.da&&Oe.capture==k){const Et=Oe.listener,ss=Oe.ha||Oe.src;Oe.fa&&xe(h.i,Oe),ne=Et.call(ss,A)!==!1&&ne}}return ne&&!A.defaultPrevented}function pt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function Rt(h){h.g=pt(()=>{h.g=null,h.i&&(h.i=!1,Rt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class ze extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Rt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kt(h){V.call(this),this.h=h,this.g={}}E(kt,V);var Jt=[];function cn(h){Ne(h.g,function(v,k){this.g.hasOwnProperty(k)&&gn(v)},h),h.g={}}kt.prototype.N=function(){kt.Z.N.call(this),cn(this)},kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wn=d.JSON.stringify,Ss=d.JSON.parse,Vn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function ls(){}function Un(){}var xn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ct(){D.call(this,"d")}E(Ct,D);function un(){D.call(this,"c")}E(un,D);var Ze={},Z=null;function je(){return Z=Z||new At}Ze.Ia="serverreachability";function lt(h){D.call(this,Ze.Ia,h)}E(lt,D);function yt(h){const v=je();oe(v,new lt(v))}Ze.STAT_EVENT="statevent";function bt(h,v){D.call(this,Ze.STAT_EVENT,h),this.stat=v}E(bt,D);function Xe(h){const v=je();oe(v,new bt(v,h))}Ze.Ja="timingevent";function et(h,v){D.call(this,Ze.Ja,h),this.size=v}E(et,D);function it(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function _n(h,v,k,A,ne,ue){h.info(function(){if(h.g)if(ue){var Oe="",Et=ue.split("&");for(let hn=0;hn<Et.length;hn++){var ss=Et[hn].split("=");if(ss.length>1){const Fn=ss[0];ss=ss[1];const Lr=Fn.split("_");Oe=Lr.length>=2&&Lr[1]=="type"?Oe+(Fn+"="+ss+"&"):Oe+(Fn+"=redacted&")}}}else Oe=null;else Oe=ue;return"XMLHTTP REQ ("+A+") [attempt "+ne+"]: "+v+`
`+k+`
`+Oe})}function kn(h,v,k,A,ne,ue,Oe){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ne+"]: "+v+`
`+k+`
`+ue+" "+Oe})}function Kn(h,v,k,A){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Me(h,k)+(A?" "+A:"")})}function le(h,v){h.info(function(){return"TIMEOUT: "+v})}Ot.prototype.info=function(){};function Me(h,v){if(!h.g)return v;if(!v)return null;try{const ue=JSON.parse(v);if(ue){for(h=0;h<ue.length;h++)if(Array.isArray(ue[h])){var k=ue[h];if(!(k.length<2)){var A=k[1];if(Array.isArray(A)&&!(A.length<1)){var ne=A[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Oe=1;Oe<A.length;Oe++)A[Oe]=""}}}}return wn(ue)}catch{return v}}var qe={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ct={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},st;function Kt(){}E(Kt,ls),Kt.prototype.g=function(){return new XMLHttpRequest},st=new Kt;function rn(h){return encodeURIComponent(String(h))}function Zt(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Nt(h,v,k,A){this.j=h,this.i=v,this.l=k,this.S=A||1,this.V=new kt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Rn}function Rn(){this.i=null,this.g="",this.h=!1}var en={},En={};function Bn(h,v,k){h.M=1,h.A=It(J(v)),h.u=k,h.R=!0,ur(h,null)}function ur(h,v){h.F=Date.now(),Cs(h),h.B=J(h.A);var k=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Dr(k.i,"t",A),h.C=0,k=h.j.L,h.h=new Rn,h.g=Ju(h.j,k?v:null,!h.u),h.P>0&&(h.O=new ze(y(h.Y,h,h.g),h.P)),v=h.V,k=h.g,A=h.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(Jt[0]=ne.toString()),ne=Jt);for(let ue=0;ue<ne.length;ue++){const Oe=Le(k,ne[ue],A||v.handleEvent,!1,v.h||v);if(!Oe)break;v.g[Oe.key]=Oe}v=h.J?O(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),yt(),_n(h.i,h.v,h.B,h.l,h.S,h.u)}Nt.prototype.ba=function(h){h=h.target;const v=this.O;v&&tn(h)==3?v.j():this.Y(h)},Nt.prototype.Y=function(h){try{if(h==this.g)e:{const Et=tn(this.g),ss=this.g.ya(),hn=this.g.ca();if(!(Et<3)&&(Et!=3||this.g&&(this.h.h||this.g.la()||Je(this.g)))){this.K||Et!=4||ss==7||(ss==8||hn<=0?yt(3):yt(2)),Yn(this);var v=this.g.ca();this.X=v;var k=fi(this);if(this.o=v==200,kn(this.i,this.v,this.B,this.l,this.S,Et,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ne=this.g;if((A=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(A)){var ue=A;break t}}ue=null}if(h=ue)Kn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Wn(this,h);else{this.o=!1,this.m=3,Xe(12),$n(this),ns(this);break e}}if(this.R){h=!0;let Fn;for(;!this.K&&this.C<k.length;)if(Fn=Qr(this,k),Fn==En){Et==4&&(this.m=4,Xe(14),h=!1),Kn(this.i,this.l,null,"[Incomplete Response]");break}else if(Fn==en){this.m=4,Xe(15),Kn(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Kn(this.i,this.l,Fn,null),Wn(this,Fn);if(mi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||k.length!=0||this.h.h||(this.m=1,Xe(16),h=!1),this.o=this.o&&h,!h)Kn(this.i,this.l,k,"[Invalid Chunked Response]"),$n(this),ns(this);else if(k.length>0&&!this.W){this.W=!0;var Oe=this.j;Oe.g==this&&Oe.aa&&!Oe.P&&(Oe.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),lc(Oe),Oe.P=!0,Xe(11))}}else Kn(this.i,this.l,k,null),Wn(this,k);Et==4&&$n(this),this.o&&!this.K&&(Et==4?Ku(this.j,this):(this.o=!1,Cs(this)))}else an(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,Xe(12)):(this.m=0,Xe(13)),$n(this),ns(this)}}}catch{}};function fi(h){if(!mi(h))return h.g.la();const v=Je(h.g);if(v==="")return"";let k="";const A=v.length,ne=tn(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return $n(h),ns(h),"";h.h.i=new d.TextDecoder}for(let ue=0;ue<A;ue++)h.h.h=!0,k+=h.h.i.decode(v[ue],{stream:!(ne&&ue==A-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function mi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Qr(h,v){var k=h.C,A=v.indexOf(`
`,k);return A==-1?En:(k=Number(v.substring(k,A)),isNaN(k)?en:(A+=1,A+k>v.length?En:(v=v.slice(A,A+k),h.C=A+k,v)))}Nt.prototype.cancel=function(){this.K=!0,$n(this)};function Cs(h){h.T=Date.now()+h.H,Js(h,h.H)}function Js(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=it(y(h.aa,h),v)}function Yn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Nt.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(le(this.i,this.B),this.M!=2&&(yt(),Xe(17)),$n(this),this.m=2,ns(this)):Js(this,this.T-h)};function ns(h){h.j.I==0||h.K||Ku(h.j,h)}function $n(h){Yn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,cn(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Wn(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||us(k.h,h))){if(!h.L&&us(k.h,h)&&k.I==3){try{var A=k.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ne=A;if(ne[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)el(k),Mn(k);else break e;ho(k),Xe(18)}}else k.xa=ne[1],0<k.xa-k.K&&ne[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=it(y(k.Va,k),6e3));Fs(k.h)<=1&&k.ta&&(k.ta=void 0)}else gi(k,11)}else if((h.L||k.g==h)&&el(k),!R(v))for(ne=k.Ba.g.parse(v),v=0;v<ne.length;v++){let hn=ne[v];const Fn=hn[0];if(!(Fn<=k.K))if(k.K=Fn,hn=hn[1],k.I==2)if(hn[0]=="c"){k.M=hn[1],k.ba=hn[2];const Lr=hn[3];Lr!=null&&(k.ka=Lr,k.j.info("VER="+k.ka));const yi=hn[4];yi!=null&&(k.za=yi,k.j.info("SVER="+k.za));const ei=hn[5];ei!=null&&typeof ei=="number"&&ei>0&&(A=1.5*ei,k.O=A,k.j.info("backChannelRequestTimeoutMs_="+A)),A=k;const ti=h.g;if(ti){const fo=ti.g?ti.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fo){var ue=A.h;ue.g||fo.indexOf("spdy")==-1&&fo.indexOf("quic")==-1&&fo.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Zs(ue,ue.h),ue.h=null))}if(A.G){const tl=ti.g?ti.g.getResponseHeader("X-HTTP-Session-Id"):null;tl&&(A.wa=tl,Re(A.J,A.G,tl))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),A=k;var Oe=h;if(A.na=Xu(A,A.L?A.ba:null,A.W),Oe.L){ds(A.h,Oe);var Et=Oe,ss=A.O;ss&&(Et.H=ss),Et.D&&(Yn(Et),Cs(Et)),A.g=Oe}else Wu(A);k.i.length>0&&Hs(k)}else hn[0]!="stop"&&hn[0]!="close"||gi(k,7);else k.I==3&&(hn[0]=="stop"||hn[0]=="close"?hn[0]=="stop"?gi(k,7):ks(k):hn[0]!="noop"&&k.l&&k.l.qa(hn),k.A=0)}}yt(4)}catch{}}var dn=class{constructor(h,v){this.g=h,this.map=v}};function Ds(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function cs(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Fs(h){return h.h?1:h.g?h.g.size:0}function us(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Zs(h,v){h.g?h.g.add(v):h.h=v}function ds(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Ds.prototype.cancel=function(){if(this.i=er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function er(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return P(h.i)}var Di=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function I(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const A=h[k].indexOf("=");let ne,ue=null;A>=0?(ne=h[k].substring(0,A),ue=h[k].substring(A+1)):ne=h[k],v(ne,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function q(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof q?(this.l=h.l,ae(this,h.j),this.o=h.o,this.g=h.g,We(this,h.u),this.h=h.h,$e(this,pi(h.i)),this.m=h.m):h&&(v=String(h).match(Di))?(this.l=!1,ae(this,v[1]||"",!0),this.o=ht(v[2]||""),this.g=ht(v[3]||"",!0),We(this,v[4]),this.h=ht(v[5]||"",!0),$e(this,v[6]||"",!0),this.m=ht(v[7]||"")):(this.l=!1,this.i=new xr(null,this.l))}q.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Ln(v,qs,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Ln(v,qs,!0),"@"),h.push(rn(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(Ln(k,k.charAt(0)=="/"?ws:dr,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",Ln(k,ga)),h.join("")},q.prototype.resolve=function(h){const v=J(this);let k=!!h.j;k?ae(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var A=h.h;if(k)We(v,h.u);else if(k=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ne=v.h.lastIndexOf("/");ne!=-1&&(A=v.h.slice(0,ne+1)+A)}if(ne=A,ne==".."||ne==".")A="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){A=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const ue=[];for(let Oe=0;Oe<ne.length;){const Et=ne[Oe++];Et=="."?A&&Oe==ne.length&&ue.push(""):Et==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),A&&Oe==ne.length&&ue.push("")):(ue.push(Et),A=!0)}A=ue.join("/")}else A=ne}return k?v.h=A:k=h.i.toString()!=="",k?$e(v,pi(h.i)):k=!!h.m,k&&(v.m=h.m),v};function J(h){return new q(h)}function ae(h,v,k){h.j=k?ht(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function We(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function $e(h,v,k){v instanceof xr?(h.i=v,Jr(h.i,h.l)):(k||(v=Ln(v,tr)),h.i=new xr(v,h.l))}function Re(h,v,k){h.i.set(v,k)}function It(h){return Re(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function ht(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ln(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,In),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function In(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var qs=/[#\/\?@]/g,dr=/[#\?:]/g,ws=/[#\?]/g,tr=/[#\?@]/g,ga=/#/g;function xr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Ns(h){h.g||(h.g=new Map,h.h=0,h.i&&I(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}s=xr.prototype,s.add=function(h,v){Ns(this),this.i=null,h=xs(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function ya(h,v){Ns(h),v=xs(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Li(h,v){return Ns(h),v=xs(h,v),h.g.has(v)}s.forEach=function(h,v){Ns(this),this.g.forEach(function(k,A){k.forEach(function(ne){h.call(v,ne,A,this)},this)},this)};function Xr(h,v){Ns(h);let k=[];if(typeof v=="string")Li(h,v)&&(k=k.concat(h.g.get(xs(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}s.set=function(h,v){return Ns(this),this.i=null,h=xs(this,h),Li(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=Xr(this,h),h.length>0?String(h[0]):v):v};function Dr(h,v,k){ya(h,v),k.length>0&&(h.i=null,h.g.set(xs(h,v),P(k)),h.h+=k.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var k=v[A];const ne=rn(k);k=Xr(this,k);for(let ue=0;ue<k.length;ue++){let Oe=ne;k[ue]!==""&&(Oe+="="+rn(k[ue])),h.push(Oe)}}return this.i=h.join("&")};function pi(h){const v=new xr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function xs(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Jr(h,v){v&&!h.j&&(Ns(h),h.i=null,h.g.forEach(function(k,A){const ne=A.toLowerCase();A!=ne&&(ya(this,A),Dr(this,ne,k))},h)),h.j=v}function nr(h,v){const k=new Ot;if(d.Image){const A=new Image;A.onload=b(Qn,k,"TestLoadImage: loaded",!0,v,A),A.onerror=b(Qn,k,"TestLoadImage: error",!1,v,A),A.onabort=b(Qn,k,"TestLoadImage: abort",!1,v,A),A.ontimeout=b(Qn,k,"TestLoadImage: timeout",!1,v,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else v(!1)}function Oi(h,v){const k=new Ot,A=new AbortController,ne=setTimeout(()=>{A.abort(),Qn(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:A.signal}).then(ue=>{clearTimeout(ne),ue.ok?Qn(k,"TestPingServer: ok",!0,v):Qn(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ne),Qn(k,"TestPingServer: error",!1,v)})}function Qn(h,v,k,A,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),A(k)}catch{}}function x(){this.g=new Vn}function N(h){this.i=h.Sb||null,this.h=h.ab||!1}E(N,ls),N.prototype.g=function(){return new U(this.i,this.h)};function U(h,v){At.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(U,At),s=U.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,fe(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Q(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,fe(this)),this.g&&(this.readyState=3,fe(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;K(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function K(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?Q(this):fe(this),this.readyState==3&&K(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,Q(this))},s.Na=function(h){this.g&&(this.response=h,Q(this))},s.ga=function(){this.g&&Q(this)};function Q(h){h.readyState=4,h.l=null,h.j=null,h.B=null,fe(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function fe(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(U.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function me(h){let v="";return Ne(h,function(k,A){v+=A,v+=":",v+=k,v+=`\r
`}),v}function De(h,v,k){e:{for(A in k){var A=!1;break e}A=!0}A||(k=me(k),typeof h=="string"?k!=null&&rn(k):Re(h,v,k))}function Ae(h){At.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(Ae,At);var Ge=/^https?$/i,at=["POST","PUT"];s=Ae.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,k,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():st.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(ue){Mt(this,ue);return}if(h=k||"",k=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ne in A)k.set(ne,A[ne]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ue of A.keys())k.set(ue,A.get(ue));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(k.keys()).find(ue=>ue.toLowerCase()=="content-type"),ne=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(at,v,void 0)>=0)||A||ne||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Oe]of k)this.g.setRequestHeader(ue,Oe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ue){Mt(this,ue)}};function Mt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,_s(h),$t(h)}function _s(h){h.A||(h.A=!0,oe(h,"complete"),oe(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,oe(this,"complete"),oe(this,"abort"),$t(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Ae.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?rt(this):this.Xa())},s.Xa=function(){rt(this)};function rt(h){if(h.h&&typeof u<"u"){if(h.v&&tn(h)==4)setTimeout(h.Ca.bind(h),0);else if(oe(h,"readystatechange"),tn(h)==4){h.h=!1;try{const ue=h.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var A;if(A=ue===0){let Oe=String(h.D).match(Di)[1]||null;!Oe&&d.self&&d.self.location&&(Oe=d.self.location.protocol.slice(0,-1)),A=!Ge.test(Oe?Oe.toLowerCase():"")}k=A}if(k)oe(h,"complete"),oe(h,"success");else{h.o=6;try{var ne=tn(h)>2?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.ca()+"]",_s(h)}}finally{$t(h)}}}}function $t(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||oe(h,"ready");try{k.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function tn(h){return h.g?h.g.readyState:0}s.ca=function(){try{return tn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Ss(v)}};function Je(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function an(h){const v={};h=(h.g&&tn(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(R(h[A]))continue;var k=Zt(h[A]);const ne=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ue=v[ne]||[];v[ne]=ue,ue.push(k)}se(v,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nn(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function zn(h){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Nn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Nn("baseRetryDelayMs",5e3,h),this.Za=Nn("retryDelaySeedMs",1e4,h),this.Ta=Nn("forwardChannelMaxRetries",2,h),this.va=Nn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Ds(h&&h.concurrentRequestLimit),this.Ba=new x,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=zn.prototype,s.ka=8,s.I=1,s.connect=function(h,v,k,A){Xe(0),this.W=h,this.H=v||{},k&&A!==void 0&&(this.H.OSID=k,this.H.OAID=A),this.F=this.X,this.J=Xu(this,null,this.W),Hs(this)};function ks(h){if(As(h),h.I==3){var v=h.V++,k=J(h.J);if(Re(k,"SID",h.M),Re(k,"RID",v),Re(k,"TYPE","terminate"),Zr(h,k),v=new Nt(h,h.j,v),v.M=2,v.A=It(J(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=Ju(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Cs(v)}Qu(h)}function Mn(h){h.g&&(lc(h),h.g.cancel(),h.g=null)}function As(h){Mn(h),h.v&&(d.clearTimeout(h.v),h.v=null),el(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Hs(h){if(!cs(h.h)&&!h.m){h.m=!0;var v=h.Ea;_e||S(),pe||(_e(),pe=!0),C.add(v,h),h.D=0}}function Pi(h,v){return Fs(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=it(y(h.Ea,h,v),Yu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ne=new Nt(this,this.j,h);let ue=this.o;if(this.U&&(ue?(ue=O(ue),be(ue,this.U)):ue=this.U),this.u!==null||this.R||(ne.J=ue,ue=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var A=this.i[k];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=$u(this,ne,v),k=J(this.J),Re(k,"RID",h),Re(k,"CVER",22),this.G&&Re(k,"X-HTTP-Session-Id",this.G),Zr(this,k),ue&&(this.R?v="headers="+rn(me(ue))+"&"+v:this.u&&De(k,this.u,ue)),Zs(this.h,ne),this.Ra&&Re(k,"TYPE","init"),this.S?(Re(k,"$req",v),Re(k,"SID","null"),ne.U=!0,Bn(ne,k,null)):Bn(ne,k,v),this.I=2}}else this.I==3&&(h?uo(this,h):this.i.length==0||cs(this.h)||uo(this))};function uo(h,v){var k;v?k=v.l:k=h.V++;const A=J(h.J);Re(A,"SID",h.M),Re(A,"RID",k),Re(A,"AID",h.K),Zr(h,A),h.u&&h.o&&De(A,h.u,h.o),k=new Nt(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=$u(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Zs(h.h,k),Bn(k,A,v)}function Zr(h,v){h.H&&Ne(h.H,function(k,A){Re(v,A,k)}),h.l&&Ne({},function(k,A){Re(v,A,k)})}function $u(h,v,k){k=Math.min(h.i.length,k);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var ne=h.i;let Et=-1;for(;;){const ss=["count="+k];Et==-1?k>0?(Et=ne[0].g,ss.push("ofs="+Et)):Et=0:ss.push("ofs="+Et);let hn=!0;for(let Fn=0;Fn<k;Fn++){var ue=ne[Fn].g;const Lr=ne[Fn].map;if(ue-=Et,ue<0)Et=Math.max(0,ne[Fn].g-100),hn=!1;else try{ue="req"+ue+"_"||"";try{var Oe=Lr instanceof Map?Lr:Object.entries(Lr);for(const[yi,ei]of Oe){let ti=ei;p(ei)&&(ti=wn(ei)),ss.push(ue+yi+"="+encodeURIComponent(ti))}}catch(yi){throw ss.push(ue+"type="+encodeURIComponent("_badmap")),yi}}catch{A&&A(Lr)}}if(hn){Oe=ss.join("&");break e}}Oe=void 0}return h=h.i.splice(0,k),v.G=h,Oe}function Wu(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;_e||S(),pe||(_e(),pe=!0),C.add(v,h),h.A=0}}function ho(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=it(y(h.Da,h),Yu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Gu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=it(y(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Xe(10),Mn(this),Gu(this))};function lc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Gu(h){h.g=new Nt(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=J(h.na);Re(v,"RID","rpc"),Re(v,"SID",h.M),Re(v,"AID",h.K),Re(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Re(v,"TO",h.ia),Re(v,"TYPE","xmlhttp"),Zr(h,v),h.u&&h.o&&De(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=It(J(v)),k.u=null,k.R=!0,ur(k,h)}s.Va=function(){this.C!=null&&(this.C=null,Mn(this),ho(this),Xe(19))};function el(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Ku(h,v){var k=null;if(h.g==v){el(h),lc(h),h.g=null;var A=2}else if(us(h.h,v))k=v.G,ds(h.h,v),A=1;else return;if(h.I!=0){if(v.o)if(A==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var ne=h.D;A=je(),oe(A,new et(A,k)),Hs(h)}else Wu(h);else if(ne=v.m,ne==3||ne==0&&v.X>0||!(A==1&&Pi(h,v)||A==2&&ho(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),ne){case 1:gi(h,5);break;case 4:gi(h,10);break;case 3:gi(h,6);break;default:gi(h,2)}}}function Yu(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function gi(h,v){if(h.j.info("Error code "+v),v==2){var k=y(h.bb,h),A=h.Ua;const ne=!A;A=new q(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||ae(A,"https"),It(A),ne?nr(A.toString(),k):Oi(A.toString(),k)}else Xe(2);h.I=0,h.l&&h.l.pa(v),Qu(h),As(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Xe(2)):(this.j.info("Failed to ping google.com"),Xe(1))};function Qu(h){if(h.I=0,h.ja=[],h.l){const v=er(h.h);(v.length!=0||h.i.length!=0)&&(F(h.ja,v),F(h.ja,h.i),h.h.i.length=0,P(h.i),h.i.length=0),h.l.oa()}}function Xu(h,v,k){var A=k instanceof q?J(k):new q(k);if(A.g!="")v&&(A.g=v+"."+A.g),We(A,A.u);else{var ne=d.location;A=ne.protocol,v=v?v+"."+ne.hostname:ne.hostname,ne=+ne.port;const ue=new q(null);A&&ae(ue,A),v&&(ue.g=v),ne&&We(ue,ne),k&&(ue.h=k),A=ue}return k=h.G,v=h.wa,k&&v&&Re(A,k,v),Re(A,"VER",h.ka),Zr(h,A),A}function Ju(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Ae(new N({ab:k})):new Ae(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}s=Zu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function va(){}va.prototype.g=function(h,v){return new sr(h,v)};function sr(h,v){At.call(this),this.g=new zn(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!R(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Vi(this)}E(sr,At),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){ks(this.g)},sr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=wn(h),h=k);v.i.push(new dn(v.Ya++,h)),v.I==3&&Hs(v)},sr.prototype.N=function(){this.g.l=null,delete this.j,ks(this.g),delete this.g,sr.Z.N.call(this)};function ed(h){Ct.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}E(ed,Ct);function td(){un.call(this),this.status=1}E(td,un);function Vi(h){this.g=h}E(Vi,Zu),Vi.prototype.ra=function(){oe(this.g,"a")},Vi.prototype.qa=function(h){oe(this.g,new ed(h))},Vi.prototype.pa=function(h){oe(this.g,new td)},Vi.prototype.oa=function(){oe(this.g,"b")},va.prototype.createWebChannel=va.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,D_=function(){return new va},M_=function(){return je()},I_=Ze,Cg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qe.NO_ERROR=0,qe.TIMEOUT=8,qe.HTTP_ERROR=6,jh=qe,ct.COMPLETE="complete",R_=ct,Un.EventType=xn,xn.OPEN="a",xn.CLOSE="b",xn.ERROR="c",xn.MESSAGE="d",At.prototype.listen=At.prototype.J,nu=Un,Ae.prototype.listenOnce=Ae.prototype.K,Ae.prototype.getLastError=Ae.prototype.Ha,Ae.prototype.getLastErrorCode=Ae.prototype.ya,Ae.prototype.getStatus=Ae.prototype.ca,Ae.prototype.getResponseJson=Ae.prototype.La,Ae.prototype.getResponseText=Ae.prototype.la,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Fa,A_=Ae}).apply(typeof oh<"u"?oh:typeof self<"u"?self:typeof window<"u"?window:{});class Gs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gs.UNAUTHENTICATED=new Gs(null),Gs.GOOGLE_CREDENTIALS=new Gs("google-credentials-uid"),Gs.FIRST_PARTY=new Gs("first-party-uid"),Gs.MOCK_USER=new Gs("mock-user");let nc="12.8.0";function hR(s){nc=s}const Bo=new oy("@firebase/firestore");function Ml(){return Bo.logLevel}function He(s,...e){if(Bo.logLevel<=Ft.DEBUG){const t=e.map(by);Bo.debug(`Firestore (${nc}): ${s}`,...t)}}function da(s,...e){if(Bo.logLevel<=Ft.ERROR){const t=e.map(by);Bo.error(`Firestore (${nc}): ${s}`,...t)}}function Hl(s,...e){if(Bo.logLevel<=Ft.WARN){const t=e.map(by);Bo.warn(`Firestore (${nc}): ${s}`,...t)}}function by(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function mt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,L_(s,i,t)}function L_(s,e,t){let i=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw da(i),new Error(i)}function mn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||L_(e,l,i)}function _t(s,e){return s}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends hi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class aa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class O_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Gs.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=Gs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){mn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new aa;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new aa,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new aa)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(mn(typeof i.accessToken=="string",31837,{l:i}),new O_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string",2055,{h:e}),new Gs(e)}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Gs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new gR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Gs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){mn(this.o===void 0,3512);const i=u=>{u.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,He("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new V2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(mn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new V2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function qt(s,e){return s<e?-1:s>e?1:0}function Ng(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return qp(l)===qp(u)?qt(l,u):qp(l)?1:-1}return qt(s.length,e.length)}const wR=55296,xR=57343;function qp(s){const e=s.charCodeAt(0);return e>=wR&&e<=xR}function $l(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const U2="__name__";class ki{constructor(e,t,i){t===void 0?t=0:t>e.length&&mt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&mt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ki.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=ki.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return qt(e.length,t.length)}static compareSegments(e,t){const i=ki.isNumericId(e),l=ki.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?ki.extractNumericId(e).compare(ki.extractNumericId(t)):Ng(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ja.fromString(e.substring(4,e.length-2))}}class Dn extends ki{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bs extends ki{construct(e,t,i){return new Bs(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===U2}static keyField(){return new Bs([U2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new Ue(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new Ue(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ue(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new Ue(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bs(t)}static emptyPath(){return new Bs([])}}class nt{constructor(e){this.path=e}static fromPath(e){return new nt(Dn.fromString(e))}static fromName(e){return new nt(Dn.fromString(e).popFirst(5))}static empty(){return new nt(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new Dn(e.slice()))}}function P_(s,e,t){if(!t)throw new Ue(ve.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function kR(s,e,t,i){if(e===!0&&i===!0)throw new Ue(ve.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function B2(s){if(!nt.isDocumentKey(s))throw new Ue(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function z2(s){if(nt.isDocumentKey(s))throw new Ue(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function V_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":mt(12329,{type:typeof s})}function or(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ue(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(s);throw new Ue(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ER(s,e){if(e<=0)throw new Ue(ve.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function bs(s,e){const t={typeString:s};return e&&(t.value=e),t}function Ou(s,e){if(!V_(s))throw new Ue(ve.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ue(ve.INVALID_ARGUMENT,t);return!0}const F2=-62135596800,q2=1e6;class St{static now(){return St.fromMillis(Date.now())}static fromDate(e){return St.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*q2);return new St(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F2)throw new Ue(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q2}_compareTo(e){return this.seconds===e.seconds?qt(this.nanoseconds,e.nanoseconds):qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:St._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,St._jsonSchema))return new St(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-F2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}St._jsonSchemaVersion="firestore/timestamp/1.0",St._jsonSchema={type:bs("string",St._jsonSchemaVersion),seconds:bs("number"),nanoseconds:bs("number")};class wt{static fromTimestamp(e){return new wt(e)}static min(){return new wt(new St(0,0))}static max(){return new wt(new St(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const yu=-1;function TR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=wt.fromTimestamp(i===1e9?new St(t+1,0):new St(t,i));return new eo(l,nt.empty(),e)}function jR(s){return new eo(s.readTime,s.key,yu)}class eo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new eo(wt.min(),nt.empty(),yu)}static max(){return new eo(wt.max(),nt.empty(),yu)}}function SR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=nt.comparator(s.documentKey,e.documentKey),t!==0?t:qt(s.largestBatchId,e.largestBatchId))}const CR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function sc(s){if(s.code!==ve.FAILED_PRECONDITION||s.message!==CR)throw s;He("LocalStore","Unexpectedly lost primary lease")}class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&mt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Te(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Te?t:Te.resolve(t)}catch(t){return Te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.reject(t)}static resolve(e){return new Te(((t,i)=>{t(e)}))}static reject(e){return new Te(((t,i)=>{i(e)}))}static waitFor(e){return new Te(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Te.resolve(!1);for(const i of e)t=t.next((l=>l?Te.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Te(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((b=>{d[y]=b,++p,p===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Te(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function AR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rc(s){return s.name==="IndexedDbTransactionError"}class df{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const xy=-1;function hf(s){return s==null}function qh(s){return s===0&&1/s==-1/0}function RR(s){return typeof s=="number"&&Number.isInteger(s)&&!qh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const U_="";function IR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=H2(e)),e=MR(s.get(t),e);return H2(e)}function MR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case U_:t+="";break;default:t+=u}}return t}function H2(s){return s+U_+""}function $2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function lo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function B_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Gn{constructor(e,t){this.comparator=e,this.root=t||Us.EMPTY}insert(e,t){return new Gn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Us.BLACK,null,null))}remove(e){return new Gn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Us.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lh(this.root,e,this.comparator,!1)}getReverseIterator(){return new lh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lh(this.root,e,this.comparator,!0)}}class lh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Us{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Us.RED,this.left=l??Us.EMPTY,this.right=u??Us.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Us(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Us.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Us.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Us.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Us.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw mt(27949);return e+(this.isRed()?0:1)}}Us.EMPTY=null,Us.RED=!0,Us.BLACK=!1;Us.EMPTY=new class{constructor(){this.size=0}get key(){throw mt(57766)}get value(){throw mt(16141)}get color(){throw mt(16727)}get left(){throw mt(29726)}get right(){throw mt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Us(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class js{constructor(e){this.comparator=e,this.data=new Gn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new W2(this.data.getIterator())}getIteratorFrom(e){return new W2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof js)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new js(this.comparator);return t.data=e,t}}class W2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Rr{constructor(e){this.fields=e,e.sort(Bs.comparator)}static empty(){return new Rr([])}unionWith(e){let t=new js(Bs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Rr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $l(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class z_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class zs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new z_("Invalid base64 string: "+u):u}})(e);return new zs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new zs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zs.EMPTY_BYTE_STRING=new zs("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(s){if(mn(!!s,39018),typeof s=="string"){let e=0;const t=DR.exec(s);if(mn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:as(s.seconds),nanos:as(s.nanos)}}function as(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function no(s){return typeof s=="string"?zs.fromBase64String(s):zs.fromUint8Array(s)}const F_="server_timestamp",q_="__type__",H_="__previous_value__",$_="__local_write_time__";function _y(s){return(s?.mapValue?.fields||{})[q_]?.stringValue===F_}function ff(s){const e=s.mapValue.fields[H_];return _y(e)?ff(e):e}function vu(s){const e=to(s.mapValue.fields[$_].timestampValue);return new St(e.seconds,e.nanos)}class LR{constructor(e,t,i,l,u,d,p,g,y,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=E}}const Hh="(default)";class bu{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new bu("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof bu&&e.projectId===this.projectId&&e.database===this.database}}function OR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ue(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bu(s.options.projectId,e)}const W_="__type__",PR="__max__",ch={mapValue:{}},G_="__vector__",$h="value";function so(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?_y(s)?4:UR(s)?9007199254740991:VR(s)?10:11:mt(28295,{value:s})}function Ai(s,e){if(s===e)return!0;const t=so(s);if(t!==so(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return vu(s).isEqual(vu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=to(l.timestampValue),p=to(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return no(l.bytesValue).isEqual(no(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return as(l.geoPointValue.latitude)===as(u.geoPointValue.latitude)&&as(l.geoPointValue.longitude)===as(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return as(l.integerValue)===as(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=as(l.doubleValue),p=as(u.doubleValue);return d===p?qh(d)===qh(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return $l(s.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if($2(d)!==$2(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ai(d[g],p[g])))return!1;return!0})(s,e);default:return mt(52216,{left:s})}}function wu(s,e){return(s.values||[]).find((t=>Ai(t,e)))!==void 0}function Wl(s,e){if(s===e)return 0;const t=so(s),i=so(e);if(t!==i)return qt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=as(u.integerValue||u.doubleValue),g=as(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return G2(s.timestampValue,e.timestampValue);case 4:return G2(vu(s),vu(e));case 5:return Ng(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=no(u),g=no(d);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const b=qt(p[y],g[y]);if(b!==0)return b}return qt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=qt(as(u.latitude),as(d.latitude));return p!==0?p:qt(as(u.longitude),as(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return K2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[$h]?.arrayValue,b=g[$h]?.arrayValue,E=qt(y?.values?.length||0,b?.values?.length||0);return E!==0?E:K2(y,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===ch.mapValue&&d===ch.mapValue)return 0;if(u===ch.mapValue)return 1;if(d===ch.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},b=Object.keys(y);g.sort(),b.sort();for(let E=0;E<g.length&&E<b.length;++E){const j=Ng(g[E],b[E]);if(j!==0)return j;const P=Wl(p[g[E]],y[b[E]]);if(P!==0)return P}return qt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw mt(23264,{he:t})}}function G2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return qt(s,e);const t=to(s),i=to(e),l=qt(t.seconds,i.seconds);return l!==0?l:qt(t.nanos,i.nanos)}function K2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Wl(t[l],i[l]);if(u)return u}return qt(t.length,i.length)}function Gl(s){return Ag(s)}function Ag(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=to(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return no(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return nt.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Ag(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Ag(t.fields[d])}`;return l+"}"})(s.mapValue):mt(61005,{value:s})}function Sh(s){switch(so(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(s);return e?16+Sh(e):16;case 5:return 2*s.stringValue.length;case 6:return no(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Sh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return lo(i.fields,((u,d)=>{l+=u.length+Sh(d)})),l})(s.mapValue);default:throw mt(13486,{value:s})}}function Y2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Rg(s){return!!s&&"integerValue"in s}function ky(s){return!!s&&"arrayValue"in s}function Q2(s){return!!s&&"nullValue"in s}function X2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ch(s){return!!s&&"mapValue"in s}function VR(s){return(s?.mapValue?.fields||{})[W_]?.stringValue===G_}function lu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return lo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=lu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=lu(s.arrayValue.values[t]);return e}return{...s}}function UR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===PR}class vr{constructor(e){this.value=e}static empty(){return new vr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ch(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lu(t)}setAll(e){let t=Bs.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=lu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Ch(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Ch(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){lo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new vr(lu(this.value))}}function K_(s){const e=[];return lo(s.fields,((t,i)=>{const l=new Bs([t]);if(Ch(i)){const u=K_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Rr(e)}class Ks{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Ks(e,0,wt.min(),wt.min(),wt.min(),vr.empty(),0)}static newFoundDocument(e,t,i,l){return new Ks(e,1,t,wt.min(),i,l,0)}static newNoDocument(e,t){return new Ks(e,2,t,wt.min(),wt.min(),vr.empty(),0)}static newUnknownDocument(e,t){return new Ks(e,3,t,wt.min(),wt.min(),vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ks&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ks(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function J2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=nt.comparator(nt.fromName(d.referenceValue),t.key):i=Wl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Z2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ai(s.position[t],e.position[t]))return!1;return!0}class xu{constructor(e,t="asc"){this.field=e,this.dir=t}}function BR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Y_{}class ys extends Y_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FR(e,t,i):t==="array-contains"?new $R(e,i):t==="in"?new WR(e,i):t==="not-in"?new GR(e,i):t==="array-contains-any"?new KR(e,i):new ys(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qR(e,i):new HR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wl(t,this.value)):t!==null&&so(this.value)===so(t)&&this.matchesComparison(Wl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ui extends Y_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ui(e,t)}matches(e){return Q_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Q_(s){return s.op==="and"}function X_(s){return zR(s)&&Q_(s)}function zR(s){for(const e of s.filters)if(e instanceof ui)return!1;return!0}function Ig(s){if(s instanceof ys)return s.field.canonicalString()+s.op.toString()+Gl(s.value);if(X_(s))return s.filters.map((e=>Ig(e))).join(",");{const e=s.filters.map((t=>Ig(t))).join(",");return`${s.op}(${e})`}}function J_(s,e){return s instanceof ys?(function(i,l){return l instanceof ys&&i.op===l.op&&i.field.isEqual(l.field)&&Ai(i.value,l.value)})(s,e):s instanceof ui?(function(i,l){return l instanceof ui&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&J_(d,l.filters[p])),!0):!1})(s,e):void mt(19439)}function Z_(s){return s instanceof ys?(function(t){return`${t.field.canonicalString()} ${t.op} ${Gl(t.value)}`})(s):s instanceof ui?(function(t){return t.op.toString()+" {"+t.getFilters().map(Z_).join(" ,")+"}"})(s):"Filter"}class FR extends ys{constructor(e,t,i){super(e,t,i),this.key=nt.fromName(i.referenceValue)}matches(e){const t=nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class qR extends ys{constructor(e,t){super(e,"in",t),this.keys=ek("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class HR extends ys{constructor(e,t){super(e,"not-in",t),this.keys=ek("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ek(s,e){return(e.arrayValue?.values||[]).map((t=>nt.fromName(t.referenceValue)))}class $R extends ys{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ky(t)&&wu(t.arrayValue,this.value)}}class WR extends ys{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class GR extends ys{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class KR extends ys{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ky(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}class YR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function ew(s,e=null,t=[],i=[],l=null,u=null,d=null){return new YR(s,e,t,i,l,u,d)}function Ey(s){const e=_t(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ig(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),hf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Gl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Gl(i))).join(",")),e.Te=t}return e.Te}function Ty(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!BR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!J_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Z2(s.startAt,e.startAt)&&Z2(s.endAt,e.endAt)}function Mg(s){return nt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class ic{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function QR(s,e,t,i,l,u,d,p){return new ic(s,e,t,i,l,u,d,p)}function mf(s){return new ic(s)}function tw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function XR(s){return nt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function tk(s){return s.collectionGroup!==null}function cu(s){const e=_t(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new js(Bs.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new xu(u,i))})),t.has(Bs.keyField().canonicalString())||e.Ie.push(new xu(Bs.keyField(),i))}return e.Ie}function Si(s){const e=_t(s);return e.Ee||(e.Ee=JR(e,cu(s))),e.Ee}function JR(s,e){if(s.limitType==="F")return ew(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new xu(l.field,u)}));const t=s.endAt?new Wh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Wh(s.startAt.position,s.startAt.inclusive):null;return ew(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Dg(s,e){const t=s.filters.concat([e]);return new ic(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ZR(s,e){const t=s.explicitOrderBy.concat([e]);return new ic(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Gh(s,e,t){return new ic(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function pf(s,e){return Ty(Si(s),Si(e))&&s.limitType===e.limitType}function nk(s){return`${Ey(Si(s))}|lt:${s.limitType}`}function Dl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>Z_(l))).join(", ")}]`),hf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Gl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Gl(l))).join(",")),`Target(${i})`})(Si(s))}; limitType=${s.limitType})`}function gf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):nt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of cu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=J2(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,cu(i),l)||i.endAt&&!(function(d,p,g){const y=J2(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,cu(i),l))})(s,e)}function eI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function sk(s){return(e,t)=>{let i=!1;for(const l of cu(s)){const u=tI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function tI(s,e,t){const i=s.field.isKeyField()?nt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Wl(g,y):mt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return mt(19790,{direction:s.dir})}}class Yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return B_(this.inner)}size(){return this.innerSize}}const nI=new Gn(nt.comparator);function ha(){return nI}const rk=new Gn(nt.comparator);function su(...s){let e=rk;for(const t of s)e=e.insert(t.key,t);return e}function ik(s){let e=rk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ro(){return uu()}function ak(){return uu()}function uu(){return new Yo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const sI=new Gn(nt.comparator),rI=new js(nt.comparator);function Ht(...s){let e=rI;for(const t of s)e=e.add(t);return e}const iI=new js(qt);function aI(){return iI}function jy(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function ok(s){return{integerValue:""+s}}function lk(s,e){return RR(e)?ok(e):jy(s,e)}class yf{constructor(){this._=void 0}}function oI(s,e,t){return s instanceof _u?(function(l,u){const d={fields:{[q_]:{stringValue:F_},[$_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&_y(u)&&(u=ff(u)),u&&(d.fields[H_]=u),{mapValue:d}})(t,e):s instanceof Kl?uk(s,e):s instanceof Yl?dk(s,e):(function(l,u){const d=ck(l,u),p=nw(d)+nw(l.Ae);return Rg(d)&&Rg(l.Ae)?ok(p):jy(l.serializer,p)})(s,e)}function lI(s,e,t){return s instanceof Kl?uk(s,e):s instanceof Yl?dk(s,e):t}function ck(s,e){return s instanceof ku?(function(i){return Rg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class _u extends yf{}class Kl extends yf{constructor(e){super(),this.elements=e}}function uk(s,e){const t=hk(e);for(const i of s.elements)t.some((l=>Ai(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Yl extends yf{constructor(e){super(),this.elements=e}}function dk(s,e){let t=hk(e);for(const i of s.elements)t=t.filter((l=>!Ai(l,i)));return{arrayValue:{values:t}}}class ku extends yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nw(s){return as(s.integerValue||s.doubleValue)}function hk(s){return ky(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class vf{constructor(e,t){this.field=e,this.transform=t}}function cI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Kl&&l instanceof Kl||i instanceof Yl&&l instanceof Yl?$l(i.elements,l.elements,Ai):i instanceof ku&&l instanceof ku?Ai(i.Ae,l.Ae):i instanceof _u&&l instanceof _u})(s.transform,e.transform)}class uI{constructor(e,t){this.version=e,this.transformResults=t}}class lr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lr}static exists(e){return new lr(void 0,e)}static updateTime(e){return new lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class bf{}function fk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new wf(s.key,lr.none()):new Pu(s.key,s.data,lr.none());{const t=s.data,i=vr.empty();let l=new js(Bs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new co(s.key,i,new Rr(l.toArray()),lr.none())}}function dI(s,e,t){s instanceof Pu?(function(l,u,d){const p=l.value.clone(),g=rw(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):s instanceof co?(function(l,u,d){if(!Nh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=rw(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(mk(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function du(s,e,t,i){return s instanceof Pu?(function(u,d,p,g){if(!Nh(u.precondition,d))return p;const y=u.value.clone(),b=iw(u.fieldTransforms,g,d);return y.setAll(b),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof co?(function(u,d,p,g){if(!Nh(u.precondition,d))return p;const y=iw(u.fieldTransforms,g,d),b=d.data;return b.setAll(mk(u)),b.setAll(y),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((E=>E.field)))})(s,e,t,i):(function(u,d,p){return Nh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,t)}function hI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=ck(i.transform,l||null);u!=null&&(t===null&&(t=vr.empty()),t.set(i.field,u))}return t||null}function sw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&$l(i,l,((u,d)=>cI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Pu extends bf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class co extends bf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function mk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function rw(s,e,t){const i=new Map;mn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,lI(d,p,t[l]))}return i}function iw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,oI(u,d,e))}return i}class wf extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fI extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&dI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ak();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=fk(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(wt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ht())}isEqual(e){return this.batchId===e.batchId&&$l(this.mutations,e.mutations,((t,i)=>sw(t,i)))&&$l(this.baseMutations,e.baseMutations,((t,i)=>sw(t,i)))}}class Sy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){mn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return sI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Sy(e,t,i,l)}}class pI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gI{constructor(e,t){this.count=e,this.unchangedNames=t}}var gs,Yt;function yI(s){switch(s){case ve.OK:return mt(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return mt(15467,{code:s})}}function pk(s){if(s===void 0)return da("GRPC error has no .code"),ve.UNKNOWN;switch(s){case gs.OK:return ve.OK;case gs.CANCELLED:return ve.CANCELLED;case gs.UNKNOWN:return ve.UNKNOWN;case gs.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case gs.INTERNAL:return ve.INTERNAL;case gs.UNAVAILABLE:return ve.UNAVAILABLE;case gs.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case gs.NOT_FOUND:return ve.NOT_FOUND;case gs.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case gs.ABORTED:return ve.ABORTED;case gs.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case gs.DATA_LOSS:return ve.DATA_LOSS;default:return mt(39323,{code:s})}}(Yt=gs||(gs={}))[Yt.OK=0]="OK",Yt[Yt.CANCELLED=1]="CANCELLED",Yt[Yt.UNKNOWN=2]="UNKNOWN",Yt[Yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yt[Yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yt[Yt.NOT_FOUND=5]="NOT_FOUND",Yt[Yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yt[Yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yt[Yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yt[Yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yt[Yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yt[Yt.ABORTED=10]="ABORTED",Yt[Yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yt[Yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yt[Yt.INTERNAL=13]="INTERNAL",Yt[Yt.UNAVAILABLE=14]="UNAVAILABLE",Yt[Yt.DATA_LOSS=15]="DATA_LOSS";function vI(){return new TextEncoder}const bI=new Ja([4294967295,4294967295],0);function aw(s){const e=vI().encode(s),t=new N_;return t.update(e),new Uint8Array(t.digest())}function ow(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ja([t,i],0),new Ja([l,u],0)]}class Cy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ru(`Invalid padding: ${t}`);if(i<0)throw new ru(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ru(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ru(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ja.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Ja.fromNumber(i)));return l.compare(bI)===1&&(l=new Ja([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Cy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new xf(wt.min(),l,new Gn(qt),ha(),Ht())}}class Vu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Vu(i,t,Ht(),Ht(),Ht())}}class Ah{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class gk{constructor(e,t){this.targetId=e,this.Ce=t}}class yk{constructor(e,t,i=zs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class lw{constructor(){this.ve=0,this.Fe=cw(),this.Me=zs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ht(),t=Ht(),i=Ht();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:mt(38017,{changeType:u})}})),new Vu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=cw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,mn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class wI{constructor(e){this.Ge=e,this.ze=new Map,this.je=ha(),this.He=uh(),this.Je=uh(),this.Ze=new Gn(qt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:mt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Mg(u))if(i===0){const d=new nt(u.path);this.et(t,d,Ks.newNoDocument(d,wt.min()))}else mn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=no(i).toUint8Array()}catch(g){if(g instanceof z_)return Hl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Cy(d,l,u)}catch(g){return Hl(g instanceof ru?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&Mg(p.target)){const g=new nt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,Ks.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Ht();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new xf(e,t,this.Ze,this.je,i);return this.je=ha(),this.He=uh(),this.Je=uh(),this.Ze=new Gn(qt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new lw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new js(qt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new js(qt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||He("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function uh(){return new Gn(nt.comparator)}function cw(){return new Gn(nt.comparator)}const xI={asc:"ASCENDING",desc:"DESCENDING"},_I={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kI={and:"AND",or:"OR"};class EI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lg(s,e){return s.useProto3Json||hf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function TI(s,e){return Kh(s,e.toTimestamp())}function Ci(s){return mn(!!s,49232),wt.fromTimestamp((function(t){const i=to(t);return new St(i.seconds,i.nanos)})(s))}function Ny(s,e){return Og(s,e).canonicalString()}function Og(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function bk(s){const e=Dn.fromString(s);return mn(Ek(e),10190,{key:e.toString()}),e}function Pg(s,e){return Ny(s.databaseId,e.path)}function Hp(s,e){const t=bk(e);if(t.get(1)!==s.databaseId.projectId)throw new Ue(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ue(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new nt(xk(t))}function wk(s,e){return Ny(s.databaseId,e)}function jI(s){const e=bk(s);return e.length===4?Dn.emptyPath():xk(e)}function Vg(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function xk(s){return mn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function uw(s,e,t){return{name:Pg(s,e),fields:t.value.mapValue.fields}}function SI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:mt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,b){return y.useProto3Json?(mn(b===void 0||typeof b=="string",58123),zs.fromBase64String(b||"")):(mn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),zs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const b=y.code===void 0?ve.UNKNOWN:pk(y.code);return new Ue(b,y.message||"")})(d);t=new yk(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Hp(s,i.document.name),u=Ci(i.document.updateTime),d=i.document.createTime?Ci(i.document.createTime):wt.min(),p=new vr({mapValue:{fields:i.document.fields}}),g=Ks.newFoundDocument(l,u,d,p),y=i.targetIds||[],b=i.removedTargetIds||[];t=new Ah(y,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Hp(s,i.document),u=i.readTime?Ci(i.readTime):wt.min(),d=Ks.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Ah([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Hp(s,i.document),u=i.removedTargetIds||[];t=new Ah([],u,l,null)}else{if(!("filter"in e))return mt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new gI(l,u),p=i.targetId;t=new gk(p,d)}}return t}function CI(s,e){let t;if(e instanceof Pu)t={update:uw(s,e.key,e.value)};else if(e instanceof wf)t={delete:Pg(s,e.key)};else if(e instanceof co)t={update:uw(s,e.key,e.data),updateMask:PI(e.fieldMask)};else{if(!(e instanceof fI))return mt(16599,{dt:e.type});t={verify:Pg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof _u)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Kl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Yl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof ku)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw mt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:TI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:mt(27497)})(s,e.precondition)),t}function NI(s,e){return s&&s.length>0?(mn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Ci(l.updateTime):Ci(u);return d.isEqual(wt.min())&&(d=Ci(u)),new uI(d,l.transformResults||[])})(t,e)))):[]}function AI(s,e){return{documents:[wk(s,e.path)]}}function RI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=wk(s,l);const u=(function(y){if(y.length!==0)return kk(ui.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((b=>(function(j){return{field:Ll(j.field),direction:DI(j.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Lg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function II(s){let e=jI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){mn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(E){const j=_k(E);return j instanceof ui&&X_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((j=>(function(F){return new xu(Ol(F.field),(function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(F.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let j;return j=typeof E=="object"?E.value:E,hf(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(E){const j=!!E.before,P=E.values||[];return new Wh(P,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const j=!E.before,P=E.values||[];return new Wh(P,j)})(t.endAt)),QR(e,l,d,u,p,"F",g,y)}function MI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _k(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ol(t.unaryFilter.field);return ys.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ol(t.unaryFilter.field);return ys.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ol(t.unaryFilter.field);return ys.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ol(t.unaryFilter.field);return ys.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return mt(61313);default:return mt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ys.create(Ol(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return mt(58110);default:return mt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ui.create(t.compositeFilter.filters.map((i=>_k(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return mt(1026)}})(t.compositeFilter.op))})(s):mt(30097,{filter:s})}function DI(s){return xI[s]}function LI(s){return _I[s]}function OI(s){return kI[s]}function Ll(s){return{fieldPath:s.canonicalString()}}function Ol(s){return Bs.fromServerFormat(s.fieldPath)}function kk(s){return s instanceof ys?(function(t){if(t.op==="=="){if(X2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(X2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ll(t.field),op:LI(t.op),value:t.value}}})(s):s instanceof ui?(function(t){const i=t.getFilters().map((l=>kk(l)));return i.length===1?i[0]:{compositeFilter:{op:OI(t.op),filters:i}}})(s):mt(54877,{filter:s})}function PI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ek(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Tk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Ka{constructor(e,t,i,l,u=wt.min(),d=wt.min(),p=zs.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Ka(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class VI{constructor(e){this.yt=e}}function UI(s){const e=II({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Gh(e,e.limit,"L"):e}class BI{constructor(){this.Sn=new zI}addToCollectionParentIndex(e,t){return this.Sn.add(t),Te.resolve()}getCollectionParents(e,t){return Te.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Te.resolve()}deleteFieldIndex(e,t){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,t){return Te.resolve()}getDocumentsMatchingTarget(e,t){return Te.resolve(null)}getIndexType(e,t){return Te.resolve(0)}getFieldIndexes(e,t){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,t){return Te.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,t){return Te.resolve(eo.min())}updateCollectionGroup(e,t,i){return Te.resolve()}updateIndexEntries(e,t){return Te.resolve()}}class zI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new js(Dn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new js(Dn.comparator)).toArray()}}const dw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jk=41943040;class yr{static withCacheSize(e){return new yr(e,yr.DEFAULT_COLLECTION_PERCENTILE,yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}yr.DEFAULT_COLLECTION_PERCENTILE=10,yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yr.DEFAULT=new yr(jk,yr.DEFAULT_COLLECTION_PERCENTILE,yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yr.DISABLED=new yr(-1,0,0);class Ql{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ql(0)}static ar(){return new Ql(-1)}}const hw="LruGarbageCollector",FI=1048576;function fw([s,e],[t,i]){const l=qt(s,t);return l===0?qt(e,i):l}class qI{constructor(e){this.Pr=e,this.buffer=new js(fw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();fw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){He(hw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rc(t)?He(hw,"Ignoring IndexedDB error during garbage collection: ",t):await sc(t)}await this.Ar(3e5)}))}}class $I{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Te.resolve(df.ce);const i=new qI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(dw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),l=this.params.maximumSequenceNumbersToCollect):l=E,d=Date.now(),this.nthSequenceNumber(e,l)))).next((E=>(i=E,p=Date.now(),this.removeTargets(e,i,t)))).next((E=>(u=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(y=Date.now(),Ml()<=Ft.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${E} documents in `+(y-g)+`ms
Total Duration: ${y-b}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:E}))))}}function WI(s,e){return new $I(s,e)}class GI{constructor(){this.changes=new Yo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ks.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Te.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&du(i.mutation,l,Rr.empty(),St.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ht()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ht()){const l=Ro();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=su();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ro();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ht())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=ha();const d=uu(),p=(function(){return uu()})();return t.forEach(((g,y)=>{const b=i.get(y.key);l.has(y.key)&&(b===void 0||b.mutation instanceof co)?u=u.insert(y.key,y):b!==void 0?(d.set(y.key,b.mutation.getFieldMask()),du(b.mutation,y,b.mutation.getFieldMask(),St.now())):d.set(y.key,Rr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,b)=>d.set(y,b))),t.forEach(((y,b)=>p.set(y,new KI(b,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=uu();let l=new Gn(((d,p)=>d-p)),u=Ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let b=i.get(g)||Rr.empty();b=p.applyToLocalView(y,b),i.set(g,b);const E=(l.get(p.batchId)||Ht()).add(g);l=l.insert(p.batchId,E)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,b=g.value,E=ak();b.forEach((j=>{if(!u.has(j)){const P=fk(t.get(j),i.get(j));P!==null&&E.set(j,P),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,E))}return Te.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return XR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Te.resolve(Ro());let p=yu,g=u;return d.next((y=>Te.forEach(y,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),u.get(b)?Te.resolve():this.remoteDocumentCache.getEntry(e,b).next((j=>{g=g.insert(b,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Ht()))).next((b=>({batchId:p,changes:ik(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new nt(t)).next((i=>{let l=su();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=su();return this.indexManager.getCollectionParents(e,u).next((p=>Te.forEach(p,(g=>{const y=(function(E,j){return new ic(j,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((b=>{b.forEach(((E,j)=>{d=d.insert(E,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const b=y.getKey();d.get(b)===null&&(d=d.insert(b,Ks.newInvalidDocument(b)))}));let p=su();return d.forEach(((g,y)=>{const b=u.get(g);b!==void 0&&du(b.mutation,y,Rr.empty(),St.now()),gf(t,y)&&(p=p.insert(g,y))})),p}))}}class QI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Te.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ci(l.createTime)}})(t)),Te.resolve()}getNamedQuery(e,t){return Te.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:UI(l.bundledQuery),readTime:Ci(l.readTime)}})(t)),Te.resolve()}}class XI{constructor(){this.overlays=new Gn(nt.comparator),this.Lr=new Map}getOverlay(e,t){return Te.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ro();return Te.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Te.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Te.resolve()}getOverlaysForCollection(e,t,i){const l=Ro(),u=t.length+1,d=new nt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Te.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Gn(((y,b)=>y-b));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let b=u.get(y.largestBatchId);b===null&&(b=Ro(),u=u.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=Ro(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=l)););return Te.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new pI(t,i));let u=this.Lr.get(t);u===void 0&&(u=Ht(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class JI{constructor(){this.sessionToken=zs.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Te.resolve()}}class Ay{constructor(){this.kr=new js(Is.Kr),this.qr=new js(Is.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Is(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Is(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new nt(new Dn([])),i=new Is(t,e),l=new Is(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new nt(new Dn([])),i=new Is(t,e),l=new Is(t,e+1);let u=Ht();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Is(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Is{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return nt.comparator(e.key,t.key)||qt(e.Hr,t.Hr)}static Ur(e,t){return qt(e.Hr,t.Hr)||nt.comparator(e.key,t.key)}}class ZI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new js(Is.Kr)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mI(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Is(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Te.resolve(d)}lookupMutationBatch(e,t){return Te.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Te.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?xy:this.Yn-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Is(t,0),l=new Is(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Te.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new js(qt);return t.forEach((l=>{const u=new Is(l,0),d=new Is(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Te.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;nt.isDocumentKey(u)||(u=u.child(""));const d=new Is(new nt(u),0);let p=new js(qt);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Te.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){mn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Te.forEach(t.mutations,(l=>{const u=new Is(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Is(t,0),l=this.Jr.firstAfterOrEqual(i);return Te.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eM{constructor(e){this.ti=e,this.docs=(function(){return new Gn(nt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Te.resolve(i?i.document.mutableCopy():Ks.newInvalidDocument(t))}getEntries(e,t){let i=ha();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Ks.newInvalidDocument(l))})),Te.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ha();const d=t.path,p=new nt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:b}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||SR(jR(b),i)<=0||(l.has(b.key)||gf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return Te.resolve(u)}getAllFromCollectionGroup(e,t,i,l){mt(9500)}ni(e,t){return Te.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new tM(this)}getSize(e){return Te.resolve(this.size)}}class tM extends GI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Te.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class nM{constructor(e){this.persistence=e,this.ri=new Yo((t=>Ey(t)),Ty),this.lastRemoteSnapshotVersion=wt.min(),this.highestTargetId=0,this.ii=0,this.si=new Ay,this.targetCount=0,this.oi=Ql._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Te.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Ql(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Te.resolve()}updateTargetData(e,t){return this.lr(t),Te.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Te.waitFor(u).next((()=>l))}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Te.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Te.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Te.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Te.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Te.resolve(i)}containsKey(e,t){return Te.resolve(this.si.containsKey(t))}}class Sk{constructor(e,t){this._i={},this.overlays={},this.ai=new df(0),this.ui=!1,this.ui=!0,this.ci=new JI,this.referenceDelegate=e(this),this.li=new nM(this),this.indexManager=new BI,this.remoteDocumentCache=(function(l){return new eM(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new VI(t),this.Pi=new QI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new ZI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){He("MemoryPersistence","Starting transaction:",e);const l=new sM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Te.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sM extends NR{constructor(e){super(),this.currentSequenceNumber=e}}class Ry{constructor(e){this.persistence=e,this.Ri=new Ay,this.Ai=null}static Vi(e){return new Ry(e)}get di(){if(this.Ai)return this.Ai;throw mt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Te.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Te.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Te.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.di,(i=>{const l=nt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,wt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Te.or([()=>Te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new Yo((i=>IR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=WI(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return Te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Te.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Te.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,wt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Te.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Te.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Te.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sh(e.data.value)),t}wr(e,t,i){return Te.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Te.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Iy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Ht(),l=Ht();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Iy(e,t.fromCache,i,l)}}class rM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class iM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DC()?8:AR(Ys())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new rM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ml()<=Ft.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",Dl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Te.resolve()):(Ml()<=Ft.DEBUG&&He("QueryEngine","Query:",Dl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ml()<=Ft.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",Dl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Si(t))):Te.resolve())}gs(e,t){if(tw(t))return Te.resolve(null);let i=Si(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=Si(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Ht(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return tw(t)||l.isEqual(wt.min())?Te.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Te.resolve(null):(Ml()<=Ft.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Dl(t)),this.Ds(e,d,t,TR(l,yu)).next((p=>p)))}))}bs(e,t){let i=new js(sk(e));return t.forEach(((l,u)=>{gf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ml()<=Ft.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",Dl(t)),this.fs.getDocumentsMatchingQuery(e,t,eo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const My="LocalStore",aM=3e8;class oM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Gn(qt),this.Fs=new Yo((u=>Ey(u)),Ty),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function lM(s,e,t,i){return new oM(s,e,t,i)}async function Ck(s,e){const t=_t(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=Ht();for(const y of l){d.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}for(const y of u){p.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function cM(s,e){const t=_t(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,b){const E=y.batch,j=E.keys();let P=Te.resolve();return j.forEach((F=>{P=P.next((()=>b.getEntry(g,F))).next((W=>{const z=y.docVersions.get(F);mn(z!==null,48541),W.version.compareTo(z)<0&&(E.applyToRemoteDocument(W,y),W.isValidDocument()&&(W.setReadTime(y.commitVersion),b.addEntry(W)))}))})),P.next((()=>p.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Ht();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Nk(s){const e=_t(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function uM(s,e){const t=_t(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const j=l.get(E);if(!j)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,E))));let P=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(E)!==null?P=P.withResumeToken(zs.EMPTY_BYTE_STRING,wt.min()).withLastLimboFreeSnapshotVersion(wt.min()):b.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(b.resumeToken,i)),l=l.insert(E,P),(function(W,z,H){return W.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-W.snapshotVersion.toMicroseconds()>=aM?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(j,P,b)&&p.push(t.li.updateTargetData(u,P))}));let g=ha(),y=Ht();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(dM(u,d,e.documentUpdates).next((b=>{g=b.Bs,y=b.Ls}))),!i.isEqual(wt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((E=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return Te.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function dM(s,e,t){let i=Ht(),l=Ht();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=ha();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(wt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):He(My,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function hM(s,e){const t=_t(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=xy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function fM(s,e){const t=_t(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Te.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Ka(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Ug(s,e,t){const i=_t(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!rc(d))throw d;He(My,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function mw(s,e,t){const i=_t(s);let l=wt.min(),u=Ht();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,b){const E=_t(g),j=E.Fs.get(b);return j!==void 0?Te.resolve(E.vs.get(j)):E.li.getTargetData(y,b)})(i,d,Si(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:wt.min(),t?u:Ht()))).next((p=>(mM(i,eI(e),p),{documents:p,ks:u})))))}function mM(s,e,t){let i=s.Ms.get(e)||wt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class pw{constructor(){this.activeTargetIds=aI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pM{constructor(){this.vo=new pw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new pw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gM{Mo(e){}shutdown(){}}const gw="ConnectivityMonitor";class yw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){He(gw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){He(gw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let dh=null;function Bg(){return dh===null?dh=(function(){return 268435456+Math.round(2147483648*Math.random())})():dh++,"0x"+dh.toString(16)}const $p="RestConnection",yM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class vM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Hh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Bg(),p=this.Qo(e,t.toUriEncodedString());He($p,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),b=ao(y);return this.zo(e,p,g,i,b).then((E=>(He($p,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw Hl($p,`RPC '${e}' ${d} failed with error: `,E,"url: ",p,"request:",i),E}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=yM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class bM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ws="WebChannelConnection",Kc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class zl extends vM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!zl.c_){const e=M_();Kc(e,I_.STAT_EVENT,(t=>{t.stat===Cg.PROXY?He(Ws,"STAT_EVENT: detected buffering proxy"):t.stat===Cg.NOPROXY&&He(Ws,"STAT_EVENT: detected no buffering proxy")})),zl.c_=!0}}zo(e,t,i,l,u){const d=Bg();return new Promise(((p,g)=>{const y=new A_;y.setWithCredentials(!0),y.listenOnce(R_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case jh.NO_ERROR:const E=y.getResponseJson();He(Ws,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),p(E);break;case jh.TIMEOUT:He(Ws,`RPC '${e}' ${d} timed out`),g(new Ue(ve.DEADLINE_EXCEEDED,"Request time out"));break;case jh.HTTP_ERROR:const j=y.getStatus();if(He(Ws,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let P=y.getResponseJson();Array.isArray(P)&&(P=P[0]);const F=P?.error;if(F&&F.status&&F.message){const W=(function(H){const G=H.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(G)>=0?G:ve.UNKNOWN})(F.status);g(new Ue(W,F.message))}else g(new Ue(ve.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new Ue(ve.UNAVAILABLE,"Connection failed."));break;default:mt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{He(Ws,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);He(Ws,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Bg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");He(Ws,`Creating RPC '${e}' stream ${l}: ${y}`,p);const b=d.createWebChannel(y,p);this.I_(b);let E=!1,j=!1;const P=new bM({Ho:F=>{j?He(Ws,`Not sending because RPC '${e}' stream ${l} is closed:`,F):(E||(He(Ws,`Opening RPC '${e}' stream ${l} transport.`),b.open(),E=!0),He(Ws,`RPC '${e}' stream ${l} sending:`,F),b.send(F))},Jo:()=>b.close()});return Kc(b,nu.EventType.OPEN,(()=>{j||(He(Ws,`RPC '${e}' stream ${l} transport opened.`),P.i_())})),Kc(b,nu.EventType.CLOSE,(()=>{j||(j=!0,He(Ws,`RPC '${e}' stream ${l} transport closed`),P.o_(),this.E_(b))})),Kc(b,nu.EventType.ERROR,(F=>{j||(j=!0,Hl(Ws,`RPC '${e}' stream ${l} transport errored. Name:`,F.name,"Message:",F.message),P.o_(new Ue(ve.UNAVAILABLE,"The operation could not be completed")))})),Kc(b,nu.EventType.MESSAGE,(F=>{if(!j){const W=F.data[0];mn(!!W,16349);const z=W,H=z?.error||z[0]?.error;if(H){He(Ws,`RPC '${e}' stream ${l} received error:`,H);const G=H.status;let X=(function(pe){const C=gs[pe];if(C!==void 0)return pk(C)})(G),de=H.message;X===void 0&&(X=ve.INTERNAL,de="Unknown error status: "+G+" with message "+H.message),j=!0,P.o_(new Ue(X,de)),b.close()}else He(Ws,`RPC '${e}' stream ${l} received:`,W),P.__(W)}})),zl.u_(),setTimeout((()=>{P.s_()}),0),P}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return D_()}}function wM(s){return new zl(s)}function Wp(){return typeof document<"u"?document:null}function _f(s){return new EI(s,!0)}zl.c_=!1;class Ak{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&He("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const vw="PersistentStream";class Rk{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ak(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(da(t.toString()),da("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new Ue(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return He(vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(He(vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xM extends Rk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return wt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?wt.min():d.readTime?Ci(d.readTime):wt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Vg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=Mg(g)?{documents:AI(u,g)}:{query:RI(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=vk(u,d.resumeToken);const y=Lg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(wt.min())>0){p.readTime=Kh(u,d.snapshotVersion.toTimestamp());const y=Lg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=MI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Vg(this.serializer),t.removeTarget=e,this.K_(t)}}class _M extends Rk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return mn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){mn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=NI(e.writeResults,e.commitTime),i=Ci(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>CI(this.serializer,i)))};this.K_(t)}}class kM{}class EM extends kM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new Ue(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Og(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ue(ve.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Og(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ue(ve.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function TM(s,e,t,i){return new EM(s,e,t,i)}class jM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(da(t),this.aa=!1):He("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const zo="RemoteStore";class SM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Qo(this)&&(He(zo,"Restarting streams for network reachability change."),await(async function(g){const y=_t(g);y.Ea.add(4),await Uu(y),y.Va.set("Unknown"),y.Ea.delete(4),await kf(y)})(this))}))})),this.Va=new jM(i,l)}}async function kf(s){if(Qo(s))for(const e of s.Ra)await e(!0)}async function Uu(s){for(const e of s.Ra)await e(!1)}function Ik(s,e){const t=_t(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Py(t)?Oy(t):ac(t).O_()&&Ly(t,e))}function Dy(s,e){const t=_t(s),i=ac(t);t.Ia.delete(e),i.O_()&&Mk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Qo(t)&&t.Va.set("Unknown"))}function Ly(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(wt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ac(s).Z_(e)}function Mk(s,e){s.da.$e(e),ac(s).X_(e)}function Oy(s){s.da=new wI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ac(s).start(),s.Va.ua()}function Py(s){return Qo(s)&&!ac(s).x_()&&s.Ia.size>0}function Qo(s){return _t(s).Ea.size===0}function Dk(s){s.da=void 0}async function CM(s){s.Va.set("Online")}async function NM(s){s.Ia.forEach(((e,t)=>{Ly(s,e)}))}async function AM(s,e){Dk(s),Py(s)?(s.Va.ha(e),Oy(s)):s.Va.set("Unknown")}async function RM(s,e,t){if(s.Va.set("Online"),e instanceof yk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){He(zo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(s,i)}else if(e instanceof Ah?s.da.Xe(e):e instanceof gk?s.da.st(e):s.da.tt(e),!t.isEqual(wt.min()))try{const i=await Nk(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(y);b&&u.Ia.set(y,b.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(zs.EMPTY_BYTE_STRING,b.snapshotVersion)),Mk(u,g);const E=new Ka(b.target,g,y,b.sequenceNumber);Ly(u,E)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){He(zo,"Failed to raise snapshot:",i),await Qh(s,i)}}async function Qh(s,e,t){if(!rc(e))throw e;s.Ea.add(1),await Uu(s),s.Va.set("Offline"),t||(t=()=>Nk(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{He(zo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await kf(s)}))}function Lk(s,e){return e().catch((t=>Qh(s,t,e)))}async function Ef(s){const e=_t(s),t=ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xy;for(;IM(e);)try{const l=await hM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MM(e,l)}catch(l){await Qh(e,l)}Ok(e)&&Pk(e)}function IM(s){return Qo(s)&&s.Ta.length<10}function MM(s,e){s.Ta.push(e);const t=ro(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Ok(s){return Qo(s)&&!ro(s).x_()&&s.Ta.length>0}function Pk(s){ro(s).start()}async function DM(s){ro(s).ra()}async function LM(s){const e=ro(s);for(const t of s.Ta)e.ea(t.mutations)}async function OM(s,e,t){const i=s.Ta.shift(),l=Sy.from(i,e,t);await Lk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await Ef(s)}async function PM(s,e){e&&ro(s).Y_&&await(async function(i,l){if((function(d){return yI(d)&&d!==ve.ABORTED})(l.code)){const u=i.Ta.shift();ro(i).B_(),await Lk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await Ef(i)}})(s,e),Ok(s)&&Pk(s)}async function bw(s,e){const t=_t(s);t.asyncQueue.verifyOperationInProgress(),He(zo,"RemoteStore received new credentials");const i=Qo(t);t.Ea.add(3),await Uu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kf(t)}async function VM(s,e){const t=_t(s);e?(t.Ea.delete(2),await kf(t)):e||(t.Ea.add(2),await Uu(t),t.Va.set("Unknown"))}function ac(s){return s.ma||(s.ma=(function(t,i,l){const u=_t(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:CM.bind(null,s),Yo:NM.bind(null,s),t_:AM.bind(null,s),J_:RM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Py(s)?Oy(s):s.Va.set("Unknown")):(await s.ma.stop(),Dk(s))}))),s.ma}function ro(s){return s.fa||(s.fa=(function(t,i,l){const u=_t(t);return u.sa(),new _M(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DM.bind(null,s),t_:PM.bind(null,s),ta:LM.bind(null,s),na:OM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Ef(s)):(await s.fa.stop(),s.Ta.length>0&&(He(zo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Vy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new aa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Vy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uy(s,e){if(da("AsyncQueue",`${e}: ${s}`),rc(s))return new Ue(ve.UNAVAILABLE,`${e}: ${s}`);throw s}class Fl{static emptySet(e){return new Fl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||nt.comparator(t.key,i.key):(t,i)=>nt.comparator(t.key,i.key),this.keyedMap=su(),this.sortedSet=new Gn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Fl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Fl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class ww{constructor(){this.ga=new Gn(nt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):mt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Xl{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Xl(e,t,Fl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class UM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class BM{constructor(){this.queries=xw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=_t(t),u=l.queries;l.queries=xw(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ue(ve.ABORTED,"Firestore shutting down"))}}function xw(){return new Yo((s=>nk(s)),pf)}async function By(s,e){const t=_t(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new UM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Uy(d,`Initialization of query '${Dl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Fy(t)}async function zy(s,e){const t=_t(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function zM(s,e){const t=_t(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Fy(t)}function FM(s,e,t){const i=_t(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Fy(s){s.Ca.forEach((e=>{e.next()}))}var zg,_w;(_w=zg||(zg={})).Ma="default",_w.Cache="cache";class qy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Xl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zg.Cache}}class Vk{constructor(e){this.key=e}}class Uk{constructor(e){this.key=e}}class qM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ht(),this.mutatedKeys=Ht(),this.eu=sk(e),this.tu=new Fl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new ww,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,E)=>{const j=l.get(b),P=gf(this.query,E)?E:null,F=!!j&&this.mutatedKeys.has(j.key),W=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations);let z=!1;j&&P?j.data.isEqual(P.data)?F!==W&&(i.track({type:3,doc:P}),z=!0):this.su(j,P)||(i.track({type:2,doc:P}),z=!0,(g&&this.eu(P,g)>0||y&&this.eu(P,y)<0)&&(p=!0)):!j&&P?(i.track({type:0,doc:P}),z=!0):j&&!P&&(i.track({type:1,doc:j}),z=!0,(g||y)&&(p=!0)),z&&(P?(d=d.add(P),u=W?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,E)=>(function(P,F){const W=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mt(20277,{Vt:z})}};return W(P)-W(F)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new Xl(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ww,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Ht(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Uk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Vk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Ht();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Hy="SyncEngine";class HM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $M{constructor(e){this.key=e,this.hu=!1}}class WM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Yo((p=>nk(p)),pf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Gn(nt.comparator),this.Au=new Map,this.Vu=new Ay,this.du={},this.mu=new Map,this.fu=Ql.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GM(s,e,t=!0){const i=$k(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Bk(i,e,t,!0),l}async function KM(s,e){const t=$k(s);await Bk(t,e,!0,!1)}async function Bk(s,e,t,i){const l=await fM(s.localStore,Si(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await YM(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Ik(s.remoteStore,l),p}async function YM(s,e,t,i,l){s.pu=(E,j,P)=>(async function(W,z,H,G){let X=z.view.ru(H);X.Ss&&(X=await mw(W.localStore,z.query,!1).then((({documents:C})=>z.view.ru(C,X))));const de=G&&G.targetChanges.get(z.targetId),_e=G&&G.targetMismatches.get(z.targetId)!=null,pe=z.view.applyChanges(X,W.isPrimaryClient,de,_e);return Ew(W,z.targetId,pe.au),pe.snapshot})(s,E,j,P);const u=await mw(s.localStore,e,!0),d=new qM(e,u.ks),p=d.ru(u.documents),g=Vu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=d.applyChanges(p,s.isPrimaryClient,g);Ew(s,t,y.au);const b=new HM(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function QM(s,e,t){const i=_t(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!pf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Ug(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Dy(i.remoteStore,l.targetId),Fg(i,l.targetId)})).catch(sc)):(Fg(i,l.targetId),await Ug(i.localStore,l.targetId,!0))}async function XM(s,e){const t=_t(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Dy(t.remoteStore,i.targetId))}async function JM(s,e,t){const i=i6(s);try{const l=await(function(d,p){const g=_t(d),y=St.now(),b=p.reduce(((P,F)=>P.add(F.key)),Ht());let E,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(P=>{let F=ha(),W=Ht();return g.xs.getEntries(P,b).next((z=>{F=z,F.forEach(((H,G)=>{G.isValidDocument()||(W=W.add(H))}))})).next((()=>g.localDocuments.getOverlayedDocuments(P,F))).next((z=>{E=z;const H=[];for(const G of p){const X=hI(G,E.get(G.key).overlayedDocument);X!=null&&H.push(new co(G.key,X,K_(X.value.mapValue),lr.exists(!0)))}return g.mutationQueue.addMutationBatch(P,y,H,p)})).next((z=>{j=z;const H=z.applyToLocalDocumentSet(E,W);return g.documentOverlayCache.saveOverlays(P,z.batchId,H)}))})).then((()=>({batchId:j.batchId,changes:ik(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new Gn(qt)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Bu(i,l.changes),await Ef(i.remoteStore)}catch(l){const u=Uy(l,"Failed to persist write");t.reject(u)}}async function zk(s,e){const t=_t(s);try{const i=await uM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(mn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?mn(d.hu,14607):l.removedDocuments.size>0&&(mn(d.hu,42227),d.hu=!1))})),await Bu(t,i,e)}catch(i){await sc(i)}}function kw(s,e,t){const i=_t(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=_t(d);g.onlineState=p;let y=!1;g.queries.forEach(((b,E)=>{for(const j of E.ba)j.va(p)&&(y=!0)})),y&&Fy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ZM(s,e,t){const i=_t(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Gn(nt.comparator);d=d.insert(u,Ks.newNoDocument(u,wt.min()));const p=Ht().add(u),g=new xf(wt.min(),new Map,new Gn(qt),d,p);await zk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),$y(i)}else await Ug(i.localStore,e,!1).then((()=>Fg(i,e,t))).catch(sc)}async function e6(s,e){const t=_t(s),i=e.batch.batchId;try{const l=await cM(t.localStore,e);qk(t,i,null),Fk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bu(t,l)}catch(l){await sc(l)}}async function t6(s,e,t){const i=_t(s);try{const l=await(function(d,p){const g=_t(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return g.mutationQueue.lookupMutationBatch(y,p).next((E=>(mn(E!==null,37113),b=E.keys(),g.mutationQueue.removeMutationBatch(y,E)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>g.localDocuments.getDocuments(y,b)))}))})(i.localStore,e);qk(i,e,t),Fk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bu(i,l)}catch(l){await sc(l)}}function Fk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function qk(s,e,t){const i=_t(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Fg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Hk(s,i)}))}function Hk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Dy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),$y(s))}function Ew(s,e,t){for(const i of t)i instanceof Vk?(s.Vu.addReference(i.key,e),n6(s,i)):i instanceof Uk?(He(Hy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Hk(s,i.key)):mt(19791,{wu:i})}function n6(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(He(Hy,"New document in limbo: "+t),s.Eu.add(i),$y(s))}function $y(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new nt(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new $M(t)),s.Ru=s.Ru.insert(t,i),Ik(s.remoteStore,new Ka(Si(mf(t.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function Bu(s,e,t){const i=_t(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(y){l.push(y);const b=Iy.Es(g.targetId,y);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const b=_t(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>Te.forEach(y,(j=>Te.forEach(j.Ts,(P=>b.persistence.referenceDelegate.addReference(E,j.targetId,P))).next((()=>Te.forEach(j.Is,(P=>b.persistence.referenceDelegate.removeReference(E,j.targetId,P)))))))))}catch(E){if(!rc(E))throw E;He(My,"Failed to update sequence numbers: "+E)}for(const E of y){const j=E.targetId;if(!E.fromCache){const P=b.vs.get(j),F=P.snapshotVersion,W=P.withLastLimboFreeSnapshotVersion(F);b.vs=b.vs.insert(j,W)}}})(i.localStore,u))}async function s6(s,e){const t=_t(s);if(!t.currentUser.isEqual(e)){He(Hy,"User change. New user:",e.toKey());const i=await Ck(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ue(ve.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bu(t,i.Ns)}}function r6(s,e){const t=_t(s),i=t.Au.get(e);if(i&&i.hu)return Ht().add(i.key);{let l=Ht();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function $k(s){const e=_t(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=zk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZM.bind(null,e),e.Pu.J_=zM.bind(null,e.eventManager),e.Pu.yu=FM.bind(null,e.eventManager),e}function i6(s){const e=_t(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t6.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return lM(this.persistence,new iM,e.initialUser,this.serializer)}Cu(e){return new Sk(Ry.Vi,this.serializer)}Du(e){return new pM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class a6 extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){mn(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new HI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?yr.withCacheSize(this.cacheSizeBytes):yr.DEFAULT;return new Sk((i=>Yh.Vi(i,t)),this.serializer)}}class qg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=s6.bind(null,this.syncEngine),await VM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BM})()}createDatastore(e){const t=_f(e.databaseInfo.databaseId),i=wM(e.databaseInfo);return TM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new SM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>kw(this.syncEngine,t,0)),(function(){return yw.v()?new yw:new gM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,b){const E=new WM(l,u,d,p,g,y);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=_t(t);He(zo,"RemoteStore shutting down."),i.Ea.add(5),await Uu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}qg.provider={build:()=>new qg};class Wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):da("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const io="FirestoreClient";class o6{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Gs.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{He(io,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(He(io,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new aa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Uy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gp(s,e){s.asyncQueue.verifyOperationInProgress(),He(io,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Ck(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Tw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await l6(s);He(io,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>bw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>bw(e.remoteStore,l))),s._onlineComponents=e}async function l6(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){He(io,"Using user provided OfflineComponentProvider");try{await Gp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===ve.FAILED_PRECONDITION||l.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Hl("Error using user provided cache. Falling back to memory cache: "+t),await Gp(s,new Xh)}}else He(io,"Using default OfflineComponentProvider"),await Gp(s,new a6(void 0));return s._offlineComponents}async function Wk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(He(io,"Using user provided OnlineComponentProvider"),await Tw(s,s._uninitializedComponentsProvider._online)):(He(io,"Using default OnlineComponentProvider"),await Tw(s,new qg))),s._onlineComponents}function c6(s){return Wk(s).then((e=>e.syncEngine))}async function Jh(s){const e=await Wk(s),t=e.eventManager;return t.onListen=GM.bind(null,e.syncEngine),t.onUnlisten=QM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XM.bind(null,e.syncEngine),t}function u6(s,e,t,i){const l=new Wy(i),u=new qy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>By(await Jh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>zy(await Jh(s),u)))}}function d6(s,e,t={}){const i=new aa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const b=new Wy({next:j=>{b.Nu(),d.enqueueAndForget((()=>zy(u,E)));const P=j.docs.has(p);!P&&j.fromCache?y.reject(new Ue(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):P&&j.fromCache&&g&&g.source==="server"?y.reject(new Ue(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),E=new qy(mf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return By(u,E)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function h6(s,e,t={}){const i=new aa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const b=new Wy({next:j=>{b.Nu(),d.enqueueAndForget((()=>zy(u,E))),j.fromCache&&g.source==="server"?y.reject(new Ue(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),E=new qy(p,b,{includeMetadataChanges:!0,Ka:!0});return By(u,E)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function f6(s,e){const t=new aa;return s.asyncQueue.enqueueAndForget((async()=>JM(await c6(s),e,t))),t.promise}function Gk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const m6="ComponentProvider",jw=new Map;function p6(s,e,t,i,l){return new LR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Gk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Kk="firestore.googleapis.com",Sw=!0;class Cw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Kk,this.ssl=Sw}else this.host=e.host,this.ssl=e.ssl??Sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FI)throw new Ue(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Gk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ue(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ue(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ue(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new fR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ue(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=jw.get(t);i&&(He(m6,"Removing Datastore"),jw.delete(t),i.terminate())})(this),Promise.resolve()}}function g6(s,e,t,i={}){s=or(s,Tf);const l=ao(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(iy(`https://${p}`),ay("Firestore",!0)),u.host!==Kk&&u.host!==p&&Hl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!la(g,d)&&(s._setSettings(g),i.mockUserToken)){let y,b;if(typeof i.mockUserToken=="string")y=i.mockUserToken,b=Gs.MOCK_USER;else{y=zx(i.mockUserToken,s._app?.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new Ue(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Gs(E)}s._authCredentials=new mR(new O_(y,b))}}class pa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new pa(this.firestore,e,this._query)}}class Zn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Za(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zn(this.firestore,e,this._key)}toJSON(){return{type:Zn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ou(t,Zn._jsonSchema))return new Zn(e,i||null,new nt(Dn.fromString(t.referencePath)))}}Zn._jsonSchemaVersion="firestore/documentReference/1.0",Zn._jsonSchema={type:bs("string",Zn._jsonSchemaVersion),referencePath:bs("string")};class Za extends pa{constructor(e,t,i){super(e,t,mf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zn(this.firestore,null,new nt(e))}withConverter(e){return new Za(this.firestore,e,this._path)}}function ot(s,e,...t){if(s=pn(s),P_("collection","path",e),s instanceof Tf){const i=Dn.fromString(e,...t);return z2(i),new Za(s,null,i)}{if(!(s instanceof Zn||s instanceof Za))throw new Ue(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return z2(i),new Za(s.firestore,null,i)}}function Fe(s,e,...t){if(s=pn(s),arguments.length===1&&(e=wy.newId()),P_("doc","path",e),s instanceof Tf){const i=Dn.fromString(e,...t);return B2(i),new Zn(s,null,new nt(i))}{if(!(s instanceof Zn||s instanceof Za))throw new Ue(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return B2(i),new Zn(s.firestore,s instanceof Za?s.converter:null,new nt(i))}}const Nw="AsyncQueue";class Aw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ak(this,"async_queue_retry"),this._c=()=>{const i=Wp();i&&He(Nw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new aa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!rc(e))throw e;He(Nw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,da("INTERNAL UNHANDLED ERROR: ",Rw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Vy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&mt(47125,{Pc:Rw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Rw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ri extends Tf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Aw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Aw(e),this._firestoreClient=void 0,await e}}}function y6(s,e){const t=typeof s=="object"?s:Ru(),i=typeof s=="string"?s:Hh,l=Go(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Vx("firestore");u&&g6(l,...u)}return l}function zu(s){if(s._terminated)throw new Ue(ve.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||v6(s),s._firestoreClient}function v6(s){const e=s._freezeSettings(),t=p6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new o6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr(zs.fromBase64String(e))}catch(t){throw new Ue(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wr(zs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:bs("string",Wr._jsonSchemaVersion),bytes:bs("string")};class jf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xo{constructor(e){this._methodName=e}}class Ni{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qt(this._lat,e._lat)||qt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ni._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,Ni._jsonSchema))return new Ni(e.latitude,e.longitude)}}Ni._jsonSchemaVersion="firestore/geoPoint/1.0",Ni._jsonSchema={type:bs("string",Ni._jsonSchemaVersion),latitude:bs("number"),longitude:bs("number")};class ai{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ai(e.vectorValues);throw new Ue(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:bs("string",ai._jsonSchemaVersion),vectorValues:bs("object")};const b6=/^__.*__$/;class w6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pu(e,this.data,t,this.fieldTransforms)}}class Yk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new co(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt(40011,{dataSource:s})}}class Sf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Qk(this.dataSource)&&b6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class x6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_f(e)}createContext(e,t,i,l=!1){return new Sf({dataSource:e,methodName:t,targetDoc:i,path:Bs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fu(s){const e=s._freezeSettings(),t=_f(s._databaseId);return new x6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Gy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Jy("Data must be an object, but it was:",d,i);const p=eE(i,d);let g,y;if(u.merge)g=new Rr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const E of u.mergeFields){const j=Fo(e,E,t);if(!d.contains(j))throw new Ue(ve.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);sE(b,j)||b.push(j)}g=new Rr(b),y=d.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,y=d.fieldTransforms;return new w6(new vr(p),g,y)}class Cf extends Xo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}function Xk(s,e,t){return new Sf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ky extends Xo{_toFieldTransform(e){return new vf(e.path,new _u)}isEqual(e){return e instanceof Ky}}class Yy extends Xo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>Jo(u,t))),l=new Kl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Yy&&la(this.Ac,e.Ac)}}class Qy extends Xo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>Jo(u,t))),l=new Yl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Qy&&la(this.Ac,e.Ac)}}class Xy extends Xo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new ku(e.serializer,lk(e.serializer,this.Vc));return new vf(e.path,t)}isEqual(e){return e instanceof Xy&&this.Vc===e.Vc}}function Jk(s,e,t,i){const l=s.createContext(1,e,t);Jy("Data must be an object, but it was:",l,i);const u=[],d=vr.empty();lo(i,((g,y)=>{const b=nE(e,g,t);y=pn(y);const E=l.childContextForFieldPath(b);if(y instanceof Cf)u.push(b);else{const j=Jo(y,E);j!=null&&(u.push(b),d.set(b,j))}}));const p=new Rr(u);return new Yk(d,p,l.fieldTransforms)}function Zk(s,e,t,i,l,u){const d=s.createContext(1,e,t),p=[Fo(e,i,t)],g=[l];if(u.length%2!=0)throw new Ue(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(Fo(e,u[j])),g.push(u[j+1]);const y=[],b=vr.empty();for(let j=p.length-1;j>=0;--j)if(!sE(y,p[j])){const P=p[j];let F=g[j];F=pn(F);const W=d.childContextForFieldPath(P);if(F instanceof Cf)y.push(P);else{const z=Jo(F,W);z!=null&&(y.push(P),b.set(P,z))}}const E=new Rr(y);return new Yk(b,E,d.fieldTransforms)}function _6(s,e,t,i=!1){return Jo(t,s.createContext(i?4:3,e))}function Jo(s,e){if(tE(s=pn(s)))return Jy("Unsupported field value:",e,s),eE(s,e);if(s instanceof Xo)return(function(i,l){if(!Qk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Jo(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=pn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return lk(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=St.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof St){const u=new St(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ni)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Wr)return{bytesValue:vk(l.serializer,i._byteString)};if(i instanceof Zn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ny(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ai)return(function(d,p){const g=d instanceof ai?d.toArray():d;return{mapValue:{fields:{[W_]:{stringValue:G_},[$h]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return jy(p.serializer,b)}))}}}}}})(i,l);if(Tk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${uf(i)}`)})(s,e)}function eE(s,e){const t={};return B_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(s,((i,l)=>{const u=Jo(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function tE(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof St||s instanceof Ni||s instanceof Wr||s instanceof Zn||s instanceof Xo||s instanceof ai||Tk(s))}function Jy(s,e,t){if(!tE(t)||!V_(t)){const i=uf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Fo(s,e,t){if((e=pn(e))instanceof jf)return e._internalPath;if(typeof e=="string")return nE(s,e);throw Zh("Field path arguments must be of type string or ",s,!1,void 0,t)}const k6=new RegExp("[~\\*/\\[\\]]");function nE(s,e,t){if(e.search(k6)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new jf(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Zh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new Ue(ve.INVALID_ARGUMENT,p+s+g)}function sE(s,e){return s.some((t=>t.isEqual(e)))}class E6{convertValue(e,t="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return as(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw mt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return lo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>as(i.doubleValue)));return new ai(t)}convertGeoPoint(e){return new Ni(as(e.latitude),as(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const t=to(e);return new St(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);mn(Ek(i),9688,{name:e});const l=new bu(i.get(1),i.get(3)),u=new nt(i.popFirst(5));return l.isEqual(t)||da(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Zy extends E6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zn(this.firestore,null,t)}}function Ms(){return new Ky("serverTimestamp")}function T6(...s){return new Yy("arrayUnion",s)}function j6(...s){return new Qy("arrayRemove",s)}function Io(s){return new Xy("increment",s)}const Iw="@firebase/firestore",Mw="4.10.0";function Dw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class rE{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Zn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Fo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class S6 extends rE{data(){return super.data()}}function iE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ue(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e0{}class t0 extends e0{}function nn(s,e,...t){let i=[];e instanceof e0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof n0)).length,p=u.filter((g=>g instanceof Nf)).length;if(d>1||d>0&&p>0)throw new Ue(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Nf extends t0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return aE(e._query,t),new pa(e.firestore,e.converter,Dg(e._query,t))}_parse(e){const t=Fu(e.firestore);return(function(u,d,p,g,y,b,E){let j;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ue(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Ow(E,b);const F=[];for(const W of E)F.push(Lw(g,u,W));j={arrayValue:{values:F}}}else j=Lw(g,u,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Ow(E,b),j=_6(p,d,E,b==="in"||b==="not-in");return ys.create(y,b,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vt(s,e,t){const i=e,l=Fo("where",s);return Nf._create(l,i,t)}class n0 extends e0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ui.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)aE(d,g),d=Dg(d,g)})(e._query,t),new pa(e.firestore,e.converter,Dg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class s0 extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new s0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new Ue(ve.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new Ue(ve.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xu(u,d)})(e._query,this._field,this._direction);return new pa(e.firestore,e.converter,ZR(e._query,t))}}function Eu(s,e="asc"){const t=e,i=Fo("orderBy",s);return s0._create(i,t)}class r0 extends t0{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new r0(e,t,i)}_apply(e){return new pa(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function Tu(s){return ER("limit",s),r0._create("limit",s,"F")}function Lw(s,e,t){if(typeof(t=pn(t))=="string"){if(t==="")throw new Ue(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tk(e)&&t.indexOf("/")!==-1)throw new Ue(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!nt.isDocumentKey(i))throw new Ue(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Y2(s,new nt(i))}if(t instanceof Zn)return Y2(s,t._key);throw new Ue(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Ow(s,e){if(!Array.isArray(s)||s.length===0)throw new Ue(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aE(s,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function i0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class iu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends rE{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Fo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Do._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:bs("string",Do._jsonSchemaVersion),bundleSource:bs("string","DocumentSnapshot"),bundleName:bs("string"),bundle:bs("string")};class Rh extends Do{data(e={}){return super.data(e)}}class Lo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new iu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Rh(this._firestore,this._userDataWriter,i.key,i,new iu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,b=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:C6(p.type),doc:g,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function C6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mt(61501,{type:s})}}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:bs("string",Lo._jsonSchemaVersion),bundleSource:bs("string","QuerySnapshot"),bundleName:bs("string"),bundle:bs("string")};class N6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fu(e)}set(e,t,i){this._verifyNotCommitted();const l=Kp(e,this._firestore),u=i0(l.converter,t,i),d=Gy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,lr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Kp(e,this._firestore);let d;return d=typeof(t=pn(t))=="string"||t instanceof jf?Zk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Jk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kp(e,this._firestore);return this._mutations=this._mutations.concat(new wf(t._key,lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ue(ve.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kp(s,e){if((s=pn(s)).firestore!==e)throw new Ue(ve.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function vs(s){s=or(s,Zn);const e=or(s.firestore,Ri),t=zu(e);return d6(t,s._key).then((i=>lE(e,s,i)))}function Gt(s){s=or(s,pa);const e=or(s.firestore,Ri),t=zu(e),i=new Zy(e);return iE(s._query),h6(t,s._query).then((l=>new Lo(e,i,s,l)))}function Ts(s,e,t){s=or(s,Zn);const i=or(s.firestore,Ri),l=i0(s.converter,e,t),u=Fu(i);return qu(i,[Gy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,lr.none())])}function os(s,e,t,...i){s=or(s,Zn);const l=or(s.firestore,Ri),u=Fu(l);let d;return d=typeof(e=pn(e))=="string"||e instanceof jf?Zk(u,"updateDoc",s._key,e,t,i):Jk(u,"updateDoc",s._key,e),qu(l,[d.toMutation(s._key,lr.exists(!0))])}function Ar(s){return qu(or(s.firestore,Ri),[new wf(s._key,lr.none())])}function br(s,e){const t=or(s.firestore,Ri),i=Fe(s),l=i0(s.converter,e),u=Fu(s.firestore);return qu(t,[Gy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,lr.exists(!1))]).then((()=>i))}function oE(s,...e){s=pn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Dw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dw(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(s instanceof Zn)d=or(s.firestore,Ri),p=mf(s._key.path),u={next:y=>{e[i]&&e[i](lE(d,s,y))},error:e[i+1],complete:e[i+2]};else{const y=or(s,pa);d=or(y.firestore,Ri),p=y._query;const b=new Zy(d);u={next:E=>{e[i]&&e[i](new Lo(d,b,y,E))},error:e[i+1],complete:e[i+2]},iE(s._query)}const g=zu(d);return u6(g,p,l,u)}function qu(s,e){const t=zu(s);return f6(t,e)}function lE(s,e,t){const i=t.docs.get(e._key),l=new Zy(s);return new Do(s,l,e._key,i,new iu(t.hasPendingWrites,t.fromCache),e.converter)}function Pw(s){return s=or(s,Ri),zu(s),new N6(s,(e=>qu(s,e)))}(function(e,t=!0){hR(Ko),li(new Kr("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ri(new pR(i.getProvider("auth-internal")),new vR(d,i.getProvider("app-check-internal")),OR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),wr(Iw,Mw,e),wr(Iw,Mw,"esm2020")})();var A6="firebase",R6="12.8.0";wr(A6,R6,"app");const cE="firebasestorage.googleapis.com",uE="storageBucket",I6=120*1e3,M6=600*1e3;class ts extends hi{constructor(e,t,i=0){super(Yp(e),`Firebase Storage: ${t} (${Yp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ts.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var es;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(es||(es={}));function Yp(s){return"storage/"+s}function a0(){const s="An unknown error occurred, please check the error payload for server response.";return new ts(es.UNKNOWN,s)}function D6(s){return new ts(es.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function L6(s){return new ts(es.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function O6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ts(es.UNAUTHENTICATED,s)}function P6(){return new ts(es.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function V6(s){return new ts(es.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function U6(){return new ts(es.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function B6(){return new ts(es.CANCELED,"User canceled the upload/download.")}function z6(s){return new ts(es.INVALID_URL,"Invalid URL '"+s+"'.")}function F6(s){return new ts(es.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function q6(){return new ts(es.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uE+"' property when initializing the app?")}function H6(){return new ts(es.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $6(){return new ts(es.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function W6(s){return new ts(es.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Hg(s){return new ts(es.INVALID_ARGUMENT,s)}function dE(){return new ts(es.APP_DELETED,"The Firebase app was deleted.")}function G6(s){return new ts(es.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hu(s,e){return new ts(es.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Yc(s){throw new ts(es.INTERNAL_ERROR,"Internal error: "+s)}class ar{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ar.makeFromUrl(e,t)}catch{return new ar(e,"")}if(i.path==="")return i;throw F6(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(de){de.path.charAt(de.path.length-1)==="/"&&(de.path_=de.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(de){de.path_=decodeURIComponent(de.path)}const b="v[A-Za-z0-9_]+",E=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",P=new RegExp(`^https?://${E}/${b}/b/${l}/o${j}`,"i"),F={bucket:1,path:3},W=t===cE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,z="([^?#]*)",H=new RegExp(`^https?://${W}/${l}/${z}`,"i"),X=[{regex:p,indices:g,postModify:u},{regex:P,indices:F,postModify:y},{regex:H,indices:{bucket:1,path:2},postModify:y}];for(let de=0;de<X.length;de++){const _e=X[de],pe=_e.regex.exec(e);if(pe){const C=pe[_e.indices.bucket];let S=pe[_e.indices.path];S||(S=""),i=new ar(C,S),_e.postModify(i);break}}if(i==null)throw z6(e);return i}}class K6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Y6(s,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function b(...z){y||(y=!0,e.apply(null,z))}function E(z){l=setTimeout(()=>{l=null,s(P,g())},z)}function j(){u&&clearTimeout(u)}function P(z,...H){if(y){j();return}if(z){j(),b.call(null,z,...H);return}if(g()||d){j(),b.call(null,z,...H);return}i<64&&(i*=2);let X;p===1?(p=2,X=0):X=(i+Math.random())*1e3,E(X)}let F=!1;function W(z){F||(F=!0,j(),!y&&(l!==null?(z||(p=2),clearTimeout(l),E(0)):z||(p=1)))}return E(0),u=setTimeout(()=>{d=!0,W(!0)},t),W}function Q6(s){s(!1)}function X6(s){return s!==void 0}function J6(s){return typeof s=="object"&&!Array.isArray(s)}function o0(s){return typeof s=="string"||s instanceof String}function Vw(s){return l0()&&s instanceof Blob}function l0(){return typeof Blob<"u"}function $g(s,e,t,i){if(i<e)throw Hg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Hg(`Invalid value for '${s}'. Expected ${t} or less.`)}function Af(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function hE(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Oo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Oo||(Oo={}));function Z6(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class eD{constructor(e,t,i,l,u,d,p,g,y,b,E,j=!0,P=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=E,this.retry=j,this.isUsingEmulator=P,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((F,W)=>{this.resolve_=F,this.reject_=W,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new hh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Oo.NO_ERROR,g=u.getStatus();if(!p||Z6(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Oo.ABORT;i(!1,new hh(!1,null,b));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new hh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());X6(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=a0();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?dE():B6();d(g)}else{const g=U6();d(g)}};this.canceled_?t(!1,new hh(!1,null,!0)):this.backoffId_=Y6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Q6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function tD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function nD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function rD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function iD(s,e,t,i,l,u,d=!0,p=!1){const g=hE(s.urlParams),y=s.url+g,b=Object.assign({},s.headers);return sD(b,e),tD(b,t),nD(b,u),rD(b,i),new eD(y,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,p)}function aD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oD(...s){const e=aD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(l0())return new Blob(s);throw new ts(es.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function cD(s){if(typeof atob>"u")throw W6("base-64");return atob(s)}const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Qp{constructor(e,t){this.data=e,this.contentType=t||null}}function uD(s,e){switch(s){case Ei.RAW:return new Qp(fE(e));case Ei.BASE64:case Ei.BASE64URL:return new Qp(mE(s,e));case Ei.DATA_URL:return new Qp(hD(e),fD(e))}throw a0()}function fE(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function dD(s){let e;try{e=decodeURIComponent(s)}catch{throw hu(Ei.DATA_URL,"Malformed data URL.")}return fE(e)}function mE(s,e){switch(s){case Ei.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw hu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw hu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=cD(e)}catch(l){throw l.message.includes("polyfill")?l:hu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class pE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw hu(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=mD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function hD(s){const e=new pE(s);return e.base64?mE(Ei.BASE64,e.rest):dD(e.rest)}function fD(s){return new pE(s).contentType}function mD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Ga{constructor(e,t){let i=0,l="";Vw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Vw(this.data_)){const i=this.data_,l=lD(i,e,t);return l===null?null:new Ga(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ga(i,!0)}}static getBlob(...e){if(l0()){const t=e.map(i=>i instanceof Ga?i.data_:i);return new Ga(oD.apply(null,t))}else{const t=e.map(d=>o0(d)?uD(Ei.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ga(l,!0)}}uploadData(){return this.data_}}function c0(s){let e;try{e=JSON.parse(s)}catch{return null}return J6(e)?e:null}function pD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function gD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function gE(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function yD(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||yD}}let fh=null;function vD(s){return!o0(s)||s.length<2?s:gE(s)}function yE(){if(fh)return fh;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(u,d){return vD(d)}const t=new ir("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),fh=s,fh}function bD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new ar(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function wD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return bD(i,s),i}function vE(s,e,t){const i=c0(e);return i===null?null:wD(s,i,t)}function xD(s,e,t,i){const l=c0(e);if(l===null||!o0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const b=s.bucket,E=s.fullPath,j="/b/"+d(b)+"/o/"+d(E),P=Af(j,t,i),F=hE({alt:"media",token:y});return P+F})[0]}function _D(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Uw="prefixes",Bw="items";function kD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Uw])for(const l of t[Uw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new ar(e,u));i.prefixes.push(d)}if(t[Bw])for(const l of t[Bw]){const u=s._makeStorageReference(new ar(e,l.name));i.items.push(u)}return i}function ED(s,e,t){const i=c0(t);return i===null?null:kD(s,e,i)}class u0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function d0(s){if(!s)throw a0()}function TD(s,e){function t(i,l){const u=vE(s,l,e);return d0(u!==null),u}return t}function jD(s,e){function t(i,l){const u=ED(s,e,l);return d0(u!==null),u}return t}function SD(s,e){function t(i,l){const u=vE(s,l,e);return d0(u!==null),xD(u,l,s.host,s._protocol)}return t}function h0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=P6():l=O6():t.getStatus()===402?l=L6(s.bucket):t.getStatus()===403?l=V6(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function CD(s){const e=h0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=D6(s.path)),u.serverResponse=l.serverResponse,u}return t}function ND(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Af(d,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,b=new u0(p,g,jD(s,e.bucket),y);return b.urlParams=u,b.errorHandler=h0(e),b}function AD(s,e,t){const i=e.fullServerUrl(),l=Af(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new u0(l,u,SD(s,t),d);return p.errorHandler=CD(e),p}function RD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function ID(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=RD(null,e)),i}function MD(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let X="";for(let de=0;de<2;de++)X=X+Math.random().toString().slice(2);return X}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=ID(e,i,l),b=_D(y,t),E="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",P=Ga.getBlob(E,i,j);if(P===null)throw H6();const F={name:y.fullPath},W=Af(u,s.host,s._protocol),z="POST",H=s.maxUploadRetryTime,G=new u0(W,z,TD(s,t),H);return G.urlParams=F,G.headers=d,G.body=P.uploadData(),G.errorHandler=h0(e),G}class DD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Oo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Oo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Oo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Yc("cannot .send() more than once");if(ao(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class LD extends DD{initXhr(){this.xhr_.responseType="text"}}function f0(){return new LD}class qo{constructor(e,t){this._service=e,t instanceof ar?this._location=t:this._location=ar.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new qo(e,t)}get root(){const e=new ar(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gE(this._location.path)}get storage(){return this._service}get parent(){const e=pD(this._location.path);if(e===null)return null;const t=new ar(this._location.bucket,e);return new qo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw G6(e)}}function OD(s,e,t){s._throwIfRoot("uploadBytes");const i=MD(s.storage,s._location,yE(),new Ga(e,!0),t);return s.storage.makeRequestWithTokens(i,f0).then(l=>({metadata:l,ref:s}))}function PD(s){const e={prefixes:[],items:[]};return bE(s,e).then(()=>e)}async function bE(s,e,t){const l=await VD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await bE(s,e,l.nextPageToken)}function VD(s,e){e!=null&&typeof e.maxResults=="number"&&$g("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=ND(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,f0)}function UD(s){s._throwIfRoot("getDownloadURL");const e=AD(s.storage,s._location,yE());return s.storage.makeRequestWithTokens(e,f0).then(t=>{if(t===null)throw $6();return t})}function BD(s,e){const t=gD(s._location.path,e),i=new ar(s._location.bucket,t);return new qo(s.storage,i)}function zD(s){return/^[A-Za-z]+:\/\//.test(s)}function FD(s,e){return new qo(s,e)}function wE(s,e){if(s instanceof m0){const t=s;if(t._bucket==null)throw q6();const i=new qo(t,t._bucket);return e!=null?wE(i,e):i}else return e!==void 0?BD(s,e):s}function qD(s,e){if(e&&zD(e)){if(s instanceof m0)return FD(s,e);throw Hg("To use ref(service, url), the first argument must be a Storage instance.")}else return wE(s,e)}function zw(s,e){const t=e?.[uE];return t==null?null:ar.makeFromBucketSpec(t,s)}function HD(s,e,t,i={}){s.host=`${e}:${t}`;const l=ao(e);l&&(iy(`https://${s.host}/b`),ay("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:zx(u,s.app.options.projectId))}class m0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=cE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=I6,this._maxUploadRetryTime=M6,this._requests=new Set,l!=null?this._bucket=ar.makeFromBucketSpec(l,this._host):this._bucket=zw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ar.makeFromBucketSpec(this._url,e):this._bucket=zw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$g("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$g("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new K6(dE());{const d=iD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Fw="@firebase/storage",qw="0.14.0";const xE="storage";function Ih(s,e,t){return s=pn(s),OD(s,e,t)}function Hw(s){return s=pn(s),PD(s)}function Po(s){return s=pn(s),UD(s)}function Ya(s,e){return s=pn(s),qD(s,e)}function $D(s=Ru(),e){s=pn(s);const i=Go(s,xE).getImmediate({identifier:e}),l=Vx("storage");return l&&WD(i,...l),i}function WD(s,e,t,i={}){HD(s,e,t,i)}function GD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new m0(t,i,l,e,Ko)}function KD(){li(new Kr(xE,GD,"PUBLIC").setMultipleInstances(!0)),wr(Fw,qw,""),wr(Fw,qw,"esm2020")}KD();const _E={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},p0=cy(_E),No=C_(p0),ye=y6(p0),Qa=$D(p0),YD=cy(_E,"secondary"),MO=C_(YD),QD="EYdciKDOi3UYBLk1u8hHams5tmO2",kE=w.createContext();function Mr(){return w.useContext(kE)}function XD({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[p,g]=w.useState(null),[y,b]=w.useState(!0);w.useEffect(()=>{let G=null;const X=e4(No,de=>{if(t(de),G&&(G(),G=null),de)if(de.uid===QD)l(!0),d(!1),g(null),b(!1);else{l(!1);const _e=nn(ot(ye,"clients"),vt("uid","==",de.uid)),pe=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const S=await vs(Fe(ye,"clients",C));S.exists()&&(d(!0),g({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};G=oE(_e,async C=>{if(C.empty)await pe();else{const S=C.docs[0];d(!0),g({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async C=>{console.error("Error listening to client data:",C),await pe(),b(!1)})}else l(!1),d(!1),g(null),b(!1)});return()=>{X(),G&&G()}},[]);const H={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:G=>{g(X=>X?{...X,...G}:G)},resolveClient:async()=>{if(p)return p;const G=localStorage.getItem("mcf_clientId");if(G)try{const X=await vs(Fe(ye,"clients",G));if(X.exists()){const de={id:X.id,...X.data()};return d(!0),g(de),de}}catch(X){console.error("resolveClient direct read failed:",X)}if(e){const X=nn(ot(ye,"clients"),vt("uid","==",e.uid)),de=await Gt(X);if(!de.empty){const _e={id:de.docs[0].id,...de.docs[0].data()};return d(!0),g(_e),_e}}return null},login:async(G,X,de=!0)=>(await S2(No,de?jg:gy),await XA(No,G,X)),signup:async(G,X,de)=>{await S2(No,jg);const _e=await QA(No,X.trim().toLowerCase(),de),pe=_e.user,C=Fe(ot(ye,"clients")),S={uid:pe.uid,name:G.trim(),email:X.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:St.now()};await Ts(C,S),d(!0),g({id:C.id,...S});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return _e},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(No)},resetPassword:G=>YA(No,G),loading:y};return a.jsx(kE.Provider,{value:H,children:s})}const EE=w.createContext();function Mi(){return w.useContext(EE)}function JD({children:s}){const[e,t]=w.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(EE.Provider,{value:p,children:s})}const TE=w.createContext();function oc(){return w.useContext(TE)}const ZD=["nutrition","buddies"],e3=[5,10],t3=2,n3=1;function s3({children:s}){const{clientData:e,loading:t}=Mr(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!ZD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:e3,FREE_RANDOMISER_WEEKLY_LIMIT:t3,FREE_HABIT_LIMIT:n3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(TE.Provider,{value:i,children:s})}function r3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function i3({className:s=""}){const{isDark:e,toggleTheme:t}=Mi();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function a3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,p]=w.useState(""),[g,y]=w.useState(!1),[b,E]=w.useState(!1),[j,P]=w.useState(!1),{login:F,resetPassword:W,currentUser:z,isAdmin:H,isClient:G,clientData:X,loading:de}=Mr(),_e=Xs();if(w.useEffect(()=>{if(!de&&z){if(!z.emailVerified&&X?.signupSource==="self_signup"){_e("/signup");return}H?_e("/dashboard"):G?_e(r3(X)):(y(!1),p("No account found. Please sign up or contact your trainer."))}},[de,z,H,G,X,_e]),de||z)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const pe=async S=>{S.preventDefault(),p(""),y(!0);try{await F(s,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},C=async S=>{if(S.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await W(s.trim()),P(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(i3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),j?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{E(!1),P(!1),p("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:pe,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:S=>u(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!0),p("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>_e("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function mh({feature:s,children:e}){const{canAccess:t,loading:i}=oc();return i||t(s)?e:a.jsx(Cx,{to:"/upgrade",replace:!0})}function Yr({active:s}){const e=Xs(),{clientData:t}=Mr(),{isPremium:i}=oc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Zo({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),p=w.useRef(0),g=w.useRef(!1),y=w.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),b=w.useCallback(j=>{if(!g.current||l)return;const P=j.touches[0].clientY-p.current;P>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((P-20)*.35,80)))},[l]),E=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:b,onTouchEnd:E,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Hu(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const p=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const jE=Hu(60,100,100,85,96),o3=Hu(60,100,100,78,94),l3=Hu(60,100,100,82,94);Hu(60,50,50,38,46);const DO=Hu(60,40,40,30,37);function c3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[p,g]=w.useState("below"),[y,b]=w.useState(!1),E=w.useRef(null),j=w.useRef(t);j.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const _e=pe=>pe.preventDefault();return document.addEventListener("touchmove",_e,{passive:!1}),document.addEventListener("wheel",_e,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",_e),document.removeEventListener("wheel",_e),document.body.style.overflow=""}},[t]);const P=w.useMemo(()=>t?s.filter(_e=>document.querySelector(_e.selector)):[],[t]),F=P[i],W=i===P.length-1,z=F?.selector,H=w.useCallback(()=>{if(!z)return;const _e=document.querySelector(z);if(!_e){d(null);return}const pe=_e.getBoundingClientRect(),C=8;d({top:pe.top-C,left:pe.left-C,width:pe.width+C*2,height:pe.height+C*2});const S=window.innerHeight-pe.bottom;g(S<260?"above":"below")},[z]);if(w.useEffect(()=>{if(!t||!z)return;b(!0);const _e=document.querySelector(z);if(_e){document.body.style.overflow="",_e.scrollIntoView({behavior:"smooth",block:"center"});let pe=null,C=0,S=0;const M=60,V=()=>{S++;const R=_e.getBoundingClientRect(),Ie=Math.round(R.top);if(pe!==null&&Ie===pe?C++:C=0,pe=Ie,C>=3||S>=M){j.current&&(document.body.style.overflow="hidden"),H(),b(!1);return}D=requestAnimationFrame(V)};let D;const L=setTimeout(()=>{D=requestAnimationFrame(V)},120);return()=>{clearTimeout(L),D&&cancelAnimationFrame(D),j.current&&(document.body.style.overflow="hidden")}}},[t,i,z,H]),w.useEffect(()=>{if(!t)return;const _e=()=>{E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(H)};return window.addEventListener("scroll",_e,!0),window.addEventListener("resize",_e),()=>{window.removeEventListener("scroll",_e,!0),window.removeEventListener("resize",_e),E.current&&cancelAnimationFrame(E.current)}},[t,H]),!t||!F||P.length===0)return null;const G=()=>{W?e():l(i+1)},X=()=>{i>0&&l(i-1)},de=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:_e=>{_e.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:G}),u&&a.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:P.map((_e,pe)=>a.jsx("span",{className:`st-dot${pe===i?" active":""}${pe<i?" done":""}`},pe))}),a.jsx("h3",{className:"st-title",children:F.title}),a.jsx("p",{className:"st-body",children:F.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:X,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:G,children:F.cta||(W?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:de,children:"Skip tour"})]})]})}const u3="/login/assets/first_workout-B8SFkzJX.PNG",d3="/login/assets/workouts_10-Z5R3u0xH.PNG",h3="/login/assets/workouts_25-CzxSlcAj.PNG",f3="/login/assets/workouts_50-BpzWup3V.PNG",m3="/login/assets/workouts_100-D7_r6tn1.PNG",p3="/login/assets/streak_2-CsRr-XA9.PNG",g3="/login/assets/streak_4-BHO09tbw.PNG",y3="/login/assets/streak_8-DX2UWMko.PNG",v3="/login/assets/nutrition_7-CHVV11fj.PNG",b3="/login/assets/leaderboard_join-BLoId4Hz.PNG",w3="/login/assets/habits_7-Dvki70KO.PNG",x3="/login/assets/starter_streak-CCltAfrC.PNG",_3="/login/assets/consistency_king-Cho2jxBt.PNG",k3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",E3="/login/assets/minute_master-hA2RLkIL.PNG",T3="/login/assets/habit_machine--nFXaIUW.PNG",j3="/login/assets/iron_will-Dh2dTaie.PNG",oi=[{id:"first_workout",img:u3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:d3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:h3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:f3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:m3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:p3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:g3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:y3,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:v3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:b3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:w3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:x3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:_3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:k3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:E3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:T3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:j3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],$w=3,Ww=5,S3=["trained","protein","steps","sleep","water"];function Xp(s){return s.toISOString().split("T")[0]}const Jp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],Qc={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Zp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Xc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function C3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function N3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Mr(),{isDark:d,toggleTheme:p}=Mi(),{isPremium:g,FREE_HABIT_LIMIT:y}=oc(),b=Xs(),[E,j]=w.useState(g?Ww:y),P=E,[F,W]=w.useState({hours:0,minutes:0,seconds:0}),[z,H]=w.useState(0),[G,X]=w.useState(0),[de,_e]=w.useState(0),[pe,C]=w.useState(!1),[S,M]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[V,D]=w.useState(null),[L,R]=w.useState(0),[Ie,Ye]=w.useState(0),[ee,Ee]=w.useState($w),[Pe,Ne]=w.useState(!1),[se,O]=w.useState(!1),[te,be]=w.useState([]),[Se,xe]=w.useState(null),[Ce,Be]=w.useState(!1),Ve=w.useRef(null),[Le,Qt]=w.useState(0),[Dt,bn]=w.useState(0),[gn,Ut]=w.useState(null),gt=w.useCallback((x,N="info")=>{Ut({message:x,type:N}),setTimeout(()=>Ut(null),4e3)},[]),[Lt,sn]=w.useState([]),[dt,At]=w.useState(!1),[oe,Xt]=w.useState(""),[pt,Rt]=w.useState(null),[ze,kt]=w.useState(null),[Jt,cn]=w.useState(!1),[wn,Ss]=w.useState(new Set),[Vn,ls]=w.useState(new Set),[Un,xn]=w.useState({}),[Ct,un]=w.useState({}),[Ze,Z]=w.useState({}),[je,lt]=w.useState({}),[yt,bt]=w.useState({}),[Xe,et]=w.useState({}),it=w.useRef(null),Ot=w.useRef(null),_n=w.useRef({}),[kn,Kn]=w.useState([]),[le,Me]=w.useState(!1),qe=w.useRef(null),[ct,st]=w.useState([]),[Kt,rn]=w.useState(""),[Zt,Nt]=w.useState(!1),[Rn,en]=w.useState(null),[En,Bn]=w.useState([]),[ur,fi]=w.useState(null),[mi,Qr]=w.useState(!1),Cs=w.useRef(!1),[Js,Yn]=w.useState(null),[ns,$n]=w.useState(!1),Wn=w.useRef(!1),dn=(()=>{const x=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return g&&x.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),x.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),x})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let x=t?.tourComplete||Wn.current;if(!x&&t?.id)try{x=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(pe&&t&&!x){const N=setTimeout(()=>$n(!0),600);return()=>clearTimeout(N)}},[pe,t]),w.useEffect(()=>{if(!(!pe||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const x=setTimeout(()=>O(!0),1500);return()=>clearTimeout(x)}}},[pe,t]),w.useEffect(()=>{if(t)try{const x=sessionStorage.getItem(`cbDash_${t.id}`);if(x){const N=JSON.parse(x);X(N.totalWorkouts??0),_e(N.habitWeekPct??0),M(N.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(N.nutritionTargetData??null),R(N.todayHabitsCount??0),N.realHabitCount&&j(N.realHabitCount),Ye(N.weeklyWorkouts??0),Ee(N.weeklyWorkoutTarget??$w),be(N.leaderboardTop3??[]),Qt(N.streakWeeks??0),C(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&xe(t.photoURL),t?.weeklyWorkoutTarget&&Ee(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const x=nn(ot(ye,"notifications"),vt("toId","==",t.id)),N=oE(x,U=>{const K=U.docs.map(Q=>({id:Q.id,...Q.data()}));K.sort((Q,fe)=>{const me=Q.createdAt?.toMillis?.()||0;return(fe.createdAt?.toMillis?.()||0)-me}),Kn(K.slice(0,50))},U=>{console.error("Notification listener error:",U),U.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>N()},[t]),w.useEffect(()=>{const x=N=>{qe.current&&!qe.current.contains(N.target)&&Me(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),w.useEffect(()=>{if(!t)return;const x=t.id;(async()=>{try{const[N,U,K]=await Promise.all([Gt(nn(ot(ye,"buddies"),vt("user1","==",x))),Gt(nn(ot(ye,"buddies"),vt("user2","==",x))),Gt(ot(ye,"clients"))]),Q=new Set;[...N.docs,...U.docs].forEach(me=>{const De=me.data();Q.add(De.user1===x?De.user2:De.user1)});const fe={};K.docs.forEach(me=>{fe[me.id]=me.data()}),st(Array.from(Q).filter(me=>fe[me]).map(me=>({id:me,name:fe[me].name,photoURL:fe[me].photoURL||null})))}catch(N){console.error("Error loading buddies for mentions:",N)}})()},[t]);const Ds=kn.filter(x=>!x.read).length,cs=async()=>{const x=kn.filter(U=>!U.read);if(!x.length)return;const N=Pw(ye);x.forEach(U=>N.update(Fe(ye,"notifications",U.id),{read:!0})),await N.commit()},Fs=async()=>{if(!kn.length)return;const x=Pw(ye);kn.forEach(N=>x.delete(Fe(ye,"notifications",N.id))),await x.commit()},us=async(x,N,U={})=>{if(!(!t||x===t.id))try{await br(ot(ye,"notifications"),{toId:x,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:N,read:!1,createdAt:Ms(),...U})}catch(K){console.error("Notification create error:",K),K.code==="permission-denied"&&gt("Notifications blocked  check Firestore rules","error")}},Zs=(x,N)=>{const U=N==="compose"?it.current?.selectionStart:null,Q=(U!=null?x.slice(0,U):x).match(/@(\w*)$/);if(Q){Nt(!0),en(N),rn(Q[1].toLowerCase());const fe=ct.filter(me=>me.name&&me.name.toLowerCase().includes(Q[1].toLowerCase())).slice(0,5);Bn(fe)}else Nt(!1),Bn([])},ds=(x,N)=>{if(N==="compose"){const U=it.current,K=oe,Q=U?.selectionStart??K.length,fe=K.slice(0,Q),me=K.slice(Q),De=fe.replace(/@\w*$/,`@${x.name} `);Xt(De+me),setTimeout(()=>{U?.focus(),U.selectionStart=U.selectionEnd=De.length},0)}else{const K=(Ct[N]||"").replace(/@\w*$/,`@${x.name} `);un(Q=>({...Q,[N]:K}))}Nt(!1),Bn([])},er=x=>x&&x.split(/(@\w[\w\s]*?\s)/g).map((U,K)=>U.startsWith("@")&&ct.some(Q=>U.trim()===`@${Q.name}`)?a.jsx("span",{className:"mention-highlight",children:U.trim()},K):U),Di=async x=>{const N=x.target.files?.[0];if(!(!N||!t)){if(!N.type.startsWith("image/")){gt("Please select an image file","error");return}if(N.size>5*1024*1024){gt("Image must be under 5MB","error");return}Be(!0);try{const U=await new Promise(fe=>{const me=new Image;me.onload=()=>{const De=document.createElement("canvas"),Ae=400;let Ge=me.width,at=me.height;Ge>at?(at=at/Ge*Ae,Ge=Ae):(Ge=Ge/at*Ae,at=Ae),De.width=Ge,De.height=at,De.getContext("2d").drawImage(me,0,0,Ge,at),De.toBlob(Mt=>fe(Mt),"image/jpeg",.75)},me.src=URL.createObjectURL(N)}),K=Ya(Qa,`profilePhotos/${t.id}`);await Ih(K,U);const Q=await Po(K);await os(Fe(ye,"clients",t.id),{photoURL:Q}),xe(Q),l({photoURL:Q}),gt("Profile photo updated!","success")}catch(U){console.error("Photo upload error:",U),gt("Failed to upload photo","error")}Be(!1),Ve.current&&(Ve.current.value="")}};w.useEffect(()=>{const x=()=>{const U=new Date,K=new Date(U);K.setHours(23,59,59,999);const Q=K-U,fe=Math.floor(Q/(1e3*60*60)),me=Math.floor(Q%(1e3*60*60)/(1e3*60)),De=Math.floor(Q%(1e3*60)/1e3);W({hours:fe,minutes:me,seconds:De}),H(60-De)};x();const N=setInterval(x,1e3);return()=>clearInterval(N)},[]),w.useEffect(()=>{const x=setInterval(()=>{bn(N=>(N+1)%Jp.length)},8e3);return()=>clearInterval(x)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let N=null,U=null;try{const K=Xp(new Date),Q=ot(ye,"workoutLogs"),fe=nn(Q,vt("clientId","==",t.id));N=await Gt(fe),X(N.docs.length);const me=new Date,De=me.getDay(),Ae=De===0?6:De-1,Ge=new Date(me);Ge.setDate(me.getDate()-Ae),Ge.setHours(0,0,0,0);const at=Ge.getTime(),Mt=N.docs.filter(Nn=>{const zn=Nn.data().completedAt;return zn?(zn.toDate?zn.toDate().getTime():new Date(zn).getTime())>=at:!1}).length;Ye(Mt);const[_s,rt]=await Promise.all([Gt(nn(ot(ye,"habitLogs"),vt("clientId","==",t.id),vt("date","==",K))),vs(Fe(ye,"customHabits",t.id))]);let $t=Ww;if(rt.exists()){const Nn=rt.data(),zn=Nn.habits||[],ks=Nn.hiddenDefaults||[];$t=S3.filter(As=>!ks.includes(As)).length+zn.length}g||($t=Math.min($t,y)),j($t);let tn=0;if(!_s.empty){const Nn=_s.docs[0].data().habits||{};tn=Object.values(Nn).filter(Boolean).length}_e(Math.round(tn/$t*100)),R(tn);const Je=await vs(Fe(ye,"nutritionTargets",t.id));Je.exists()&&(D(Je.data()),U=Je.data());const an=await vs(Fe(ye,"nutritionLogs",`${t.id}_${K}`));if(an.exists()){const zn=(an.data().entries||[]).reduce((ks,Mn)=>({protein:ks.protein+(Mn.protein||0),carbs:ks.carbs+(Mn.carbs||0),fats:ks.fats+(Mn.fats||0),calories:ks.calories+(Mn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});M(zn)}}catch(K){console.error("Error loading dashboard stats:",K)}try{const K=ot(ye,"clients"),Q=nn(K,vt("leaderboardOptIn","==",!0)),me=(await Gt(Q)).docs.map(De=>({id:De.id,name:De.data().name,photoURL:De.data().photoURL||null}));if(be(me.slice(0,3)),t?.id){const De=me.findIndex(Ge=>Ge.id===t.id),Ae=De>=0?De+1:null;try{const Ge=`lbRank_${t.id}`,at=sessionStorage.getItem(Ge);at&&Yn(parseInt(at,10)),Ae&&sessionStorage.setItem(Ge,String(Ae))}catch{}}}catch(K){console.error("Leaderboard preview error:",K)}try{let K=0;if(N){const Q=N.docs.map(fe=>fe.data().date).filter(Boolean).sort().reverse();if(Q.length>0){const fe=new Date;let me=new Date(fe);e:for(let De=0;De<52;De++){const Ae=new Date(me),Ge=Ae.getDay(),at=Ge===0?6:Ge-1;Ae.setDate(Ae.getDate()-at),Ae.setHours(0,0,0,0);const Mt=new Date(Ae);Mt.setDate(Mt.getDate()+7);const _s=Xp(Ae),rt=Xp(Mt);if(Q.some(tn=>tn>=_s&&tn<rt))K++;else{if(De>0)break e;break}me.setDate(me.getDate()-7)}}}Qt(K)}catch(K){console.error("Streak computation error:",K)}C(!0)})()},[s,t,P]),w.useEffect(()=>{if(!(!pe||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:G,habitWeekPct:de,nutritionTotals:S,nutritionTargetData:V,todayHabitsCount:L,realHabitCount:E,weeklyWorkouts:Ie,weeklyWorkoutTarget:ee,leaderboardTop3:te,streakWeeks:Le}))}catch{}},[pe,G,de,S,V,L,Ie,ee,te,Le,t]),w.useEffect(()=>{if(!(!pe||Cs.current)&&Ie>=ee&&ee>0){const x=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(x))return;sessionStorage.setItem(x,"1")}catch{}Cs.current=!0,Qr(!0),setTimeout(()=>Qr(!1),3500)}},[pe,Ie,ee,t]);const I=w.useCallback(async()=>{if(Wn.current=!0,$n(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await os(Fe(ye,"clients",t.id),{tourComplete:!0})}catch(x){console.error("Failed to save tour completion:",x)}}},[t,l]),q=w.useCallback(async x=>{if(Ee(x),Ne(!1),O(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await os(Fe(ye,"clients",t.id),{weeklyWorkoutTarget:x})}catch(N){console.error("Failed to save weekly target:",N)}}},[t]),J=x=>{const N=x.currentTarget,U=N.querySelector(".ripple");U&&U.remove();const K=N.getBoundingClientRect(),Q=Math.max(K.width,K.height),fe=x.clientX-K.left-Q/2,me=x.clientY-K.top-Q/2,De=document.createElement("span");De.className="ripple",De.style.cssText=`width:${Q}px;height:${Q}px;left:${fe}px;top:${me}px;`,N.appendChild(De),setTimeout(()=>De.remove(),600)},ae=t?.name?.split(" ")[0]||"there",We=Math.min(Math.round(Ie/ee*100),100),$e=Le>0?Math.min(Math.round(Le/12*100),100):0,Re=[{label:"Wk Streak",value:`${Le}`,pct:$e,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Ie}/${ee}`,pct:We,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${de}%`,pct:de,color:"var(--color-primary)",size:"normal"}],It=S.calories>0&&V?.calories&&S.calories>=V.calories*.8,ht=Ie>=ee&&ee>0,Ln=L>=P,In=(()=>{if(!pe)return null;const x=ee-Ie;return x===1?"1 more workout to hit your weekly goal":x===2?"2 more workouts to hit your weekly goal":P-L===1?"1 habit left to complete today":null})(),qs=x=>!V||!V[x]?0:Math.min(Math.round(S[x]/V[x]*100),100),dr=(()=>{const x=new Date().getHours(),N=pe&&L>=P&&S.calories>0,U=K=>K[Math.floor(Date.now()/6e4%K.length)];return N?U(Qc.allDone):x>=5&&x<12?U(Qc.morning):x>=12&&x<17?U(Qc.afternoon):x>=17&&x<21?U(Qc.evening):U(Qc.night)})(),ws=pe?Ie===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:L<P?{label:"DAILY HABITS",message:`${L}/${P} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:de,ringLabel:`${L}/${P}`}:g&&S.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,tr=w.useCallback(async()=>{if(t){At(!0);try{const x=await Gt(nn(ot(ye,"posts"),vt("authorId","==",t.id),Eu("createdAt","desc"),Tu(30)));sn(x.docs.map(U=>({id:U.id,...U.data()})));const N=await Gt(nn(ot(ye,"postLikes"),vt("userId","==",t.id)));Ss(new Set(N.docs.map(U=>U.data().postId)))}catch(x){console.error("Error loading journey:",x)}finally{At(!1)}}},[t]);w.useEffect(()=>{pe&&t&&tr()},[pe,t,tr]);const ga=x=>{const N=x.target.files?.[0];if(N){if(!N.type.startsWith("image/")){gt("Please select an image file","error");return}if(N.size>10*1024*1024){gt("Image must be under 10MB","error");return}Rt(N),kt(URL.createObjectURL(N))}},xr=()=>{Rt(null),ze&&URL.revokeObjectURL(ze),kt(null),Ot.current&&(Ot.current.value="")},Ns=async()=>{if(!(!oe.trim()&&!pt||Jt||!t)){cn(!0);try{let x=null;if(pt){const Q=await C3(pt),fe=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,me=Ya(Qa,`postImages/${t.id}/${fe}`);await Ih(me,Q),x=await Po(me)}await br(ot(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:oe.trim(),type:x?"image":"text",imageURL:x||null,createdAt:Ms(),likeCount:0,commentCount:0});const U=oe.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(U){const Q=new Set;U.forEach(fe=>{const me=fe.slice(1).trim(),De=ct.find(Ae=>Ae.name&&Ae.name.toLowerCase()===me.toLowerCase());De&&!Q.has(De.id)&&(Q.add(De.id),us(De.id,"mention",{}))})}Xt(""),xr(),it.current&&(it.current.style.height="auto"),await tr();const K=ct.length;gt(K>0?`Shared with ${K} ${K===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(x){console.error("Error posting:",x),gt(x?.message||"Failed to post","error")}finally{cn(!1)}}},ya=async x=>{if(window.confirm("Delete this post?"))try{await Ar(Fe(ye,"posts",x)),sn(N=>N.filter(U=>U.id!==x)),gt("Post deleted","info")}catch(N){console.error("Delete error:",N),gt("Failed to delete","error")}},Li=async x=>{if(!t)return;const N=t.id,U=`${x}_${N}`,K=wn.has(x),Q=new Set(wn);K?Q.delete(x):Q.add(x),Ss(Q),sn(fe=>fe.map(me=>me.id===x?{...me,likeCount:Math.max(0,(me.likeCount||0)+(K?-1:1))}:me));try{if(K)await Ar(Fe(ye,"postLikes",U)),await os(Fe(ye,"posts",x),{likeCount:Io(-1)});else{await Ts(Fe(ye,"postLikes",U),{postId:x,userId:N,createdAt:Ms()}),await os(Fe(ye,"posts",x),{likeCount:Io(1)});const fe=Lt.find(me=>me.id===x);fe&&us(fe.authorId,"like",{postId:x})}}catch(fe){console.error("Like error:",fe),tr()}},Xr=async x=>{try{const N=await Gt(nn(ot(ye,"postComments"),vt("postId","==",x),Eu("createdAt","asc"),Tu(50)));xn(U=>({...U,[x]:N.docs.map(K=>({id:K.id,...K.data()}))}))}catch(N){console.error("Error loading comments:",N)}},Dr=x=>{const N=new Set(Vn);N.has(x)?N.delete(x):(N.add(x),Un[x]||Xr(x)),ls(N)},pi=async x=>{const N=(Ct[x]||"").trim(),U=yt[x];if(!(!N&&!U||!t)){Z(K=>({...K,[x]:!0}));try{let K=null;if(U){const Ae=Ya(Qa,`comment-images/${Date.now()}_${U.name}`);await Ih(Ae,U),K=await Po(Ae)}const Q={postId:x,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:N||"",createdAt:Ms()};K&&(Q.imageURL=K);const fe=je[x];fe&&(Q.replyToId=fe.id,Q.replyToName=fe.authorName),await br(ot(ye,"postComments"),Q),await os(Fe(ye,"posts",x),{commentCount:Io(1)});const me=Lt.find(Ae=>Ae.id===x);me&&us(me.authorId,"comment",{postId:x});const De=N.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(De){const Ae=new Set;De.forEach(Ge=>{const at=Ge.slice(1).trim(),Mt=ct.find(_s=>_s.name&&_s.name.toLowerCase()===at.toLowerCase());Mt&&!Ae.has(Mt.id)&&(Ae.add(Mt.id),us(Mt.id,"mention",{postId:x}))})}un(Ae=>({...Ae,[x]:""})),bt(Ae=>({...Ae,[x]:null})),et(Ae=>({...Ae,[x]:null})),lt(Ae=>({...Ae,[x]:null})),_n.current[x]&&(_n.current[x].value=""),sn(Ae=>Ae.map(Ge=>Ge.id===x?{...Ge,commentCount:(Ge.commentCount||0)+1}:Ge)),await Xr(x)}catch(K){console.error("Comment error:",K),gt("Failed to comment","error")}finally{Z(K=>({...K,[x]:!1}))}}},xs=async(x,N)=>{try{await Ar(Fe(ye,"postComments",N)),await os(Fe(ye,"posts",x),{commentCount:Io(-1)}),xn(U=>({...U,[x]:(U[x]||[]).filter(K=>K.id!==N)})),sn(U=>U.map(K=>K.id===x?{...K,commentCount:Math.max((K.commentCount||1)-1,0)}:K))}catch(U){console.error("Delete comment error:",U),gt("Failed to delete comment","error")}},Jr=(x,N)=>{const U=N.target.files?.[0];if(!U)return;if(U.size>5*1024*1024){gt("Image must be under 5MB","error");return}bt(Q=>({...Q,[x]:U}));const K=new FileReader;K.onload=Q=>et(fe=>({...fe,[x]:Q.target.result})),K.readAsDataURL(U)},nr=x=>{bt(N=>({...N,[x]:null})),et(N=>({...N,[x]:null})),_n.current[x]&&(_n.current[x].value="")},Oi=x=>{Xt(x.target.value),x.target.style.height="auto",x.target.style.height=Math.min(x.target.scrollHeight,120)+"px",Zs(x.target.value,"compose")},Qn=(x,N)=>{un(U=>({...U,[x]:N})),Zs(N,x)};return a.jsx(Zo,{children:a.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:qe,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{Me(!le),le||cs()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Ds>0&&a.jsx("span",{className:"header-notif-badge",children:Ds>9?"9+":Ds})]}),le&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),kn.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Fs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:kn.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):kn.map(x=>a.jsxs("div",{className:`notif-item${x.read?"":" unread"}`,onClick:()=>{if(Me(!1),x.type==="buddy_request"||x.type==="buddy_accept")b(g?"/client/core-buddy/buddies":"/upgrade");else if((x.type==="like"||x.type==="comment")&&x.postId){if(!Vn.has(x.postId)){const N=new Set(Vn);N.add(x.postId),ls(N),Un[x.postId]||Xr(x.postId)}setTimeout(()=>{const N=document.getElementById(`post-${x.postId}`);N&&N.scrollIntoView({behavior:"smooth",block:"center"})},150)}else x.type==="like"||x.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):x.type==="mention"&&b(`/client/core-buddy/profile/${x.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:x.fromPhotoURL?a.jsx("img",{src:x.fromPhotoURL,alt:""}):a.jsx("span",{children:(x.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:x.fromName})," ",x.type==="buddy_request"&&"sent you a buddy request",x.type==="buddy_accept"&&"accepted your buddy request",x.type==="like"&&"liked your post",x.type==="comment"&&"commented on your post",x.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Zp(x.createdAt)})]})]},x.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:p,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:jE.map((x,N)=>{const U=N<z;return a.jsx("line",{x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2,className:`ring-tick ${U?"elapsed":"remaining"}`,strokeWidth:x.thick?"3":"2"},N)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ve.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Se||"/Logo.webp",alt:Se?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ce?" uploading":""}`,children:Ce?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ve,type:"file",accept:"image/*",onChange:Di,style:{display:"none"}})]}),!Se&&!Ce&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ve.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(F.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(F.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(F.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Jp[Dt].text," ",a.jsx("strong",{children:Jp[Dt].bold})]},Dt)]}),a.jsx("div",{className:"cb-stats-row",children:Re.map(x=>{const N=(x.size==="large",38),U=2*Math.PI*N,K=U-x.pct/100*U,Q=x.editable,fe=x.pct>=75&&x.pct<100,me=x.pct>=100;return a.jsxs("div",{className:`cb-stat-item${x.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${Q?" cb-stat-tappable":""}${Q&&se?" cb-stat-hint":""}${fe?" cb-stat-near":""}${me?" cb-stat-complete":""}`,onClick:Q?()=>{Ne(!0),O(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:N}),a.jsx("circle",{className:`cb-stat-fill${fe?" cb-fill-near":""}${me?" cb-fill-complete":""}`,cx:"50",cy:"50",r:N,strokeDasharray:U,strokeDashoffset:K})]}),a.jsx("span",{className:`cb-stat-value${me?" cb-val-complete":""}`,children:x.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[x.label==="Wk Streak"&&Le>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),x.label]})]},x.label)})}),Pe&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Ne(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:x=>x.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(x=>a.jsx("button",{className:`cb-target-option${x===ee?" active":""}`,onClick:()=>q(x),children:x},x))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[dr.main," ",a.jsx("strong",{children:ae}),"  ",dr.sub]}),In&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:In})]}),ws&&a.jsxs("button",{className:"cb-nudge-card",onClick:ws.action||void 0,style:ws.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-ws.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:ws.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:ws.label}),a.jsx("span",{className:"cb-nudge-title",children:ws.message}),ws.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[ws.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[g&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${It?" cb-card-done":""}`,onClick:x=>{J(x),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:qs("protein"),color:"var(--color-primary)"},{label:"C",pct:qs("carbs"),color:"var(--color-primary)"},{label:"F",pct:qs("fats"),color:"var(--color-primary)"},{label:"Cal",pct:qs("calories"),color:"var(--color-primary)"}].map(x=>{const U=2*Math.PI*38,K=U-x.pct/100*U;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:x.color},strokeDasharray:U,strokeDashoffset:K})]}),a.jsx("span",{style:{color:x.color},children:x.label})]},x.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${ht?" cb-card-done":""}`,onClick:x=>{J(x),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Ie," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[G," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Ln?" cb-card-done":""}`,onClick:x=>{J(x),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${L>=P?" cb-habits-all-done":""}`,children:Array.from({length:P},(x,N)=>a.jsx("span",{className:`cb-habit-dot${N<L?" done":""}${!N&&L>0&&N>=L?" cb-dot-warming":""}`,style:N>=L&&L>0?{"--glow-intensity":Math.min(L/P,.9)}:void 0},N))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[L,"/",P," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:x=>{J(x),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),te.length>0?a.jsx("div",{className:"cb-lb-preview",children:te.map((x,N)=>{const U=["#FFD700","#A8B4C0","#CD7F32"][N],K=x.name?x.name.split(" ").map(De=>De[0]).join("").slice(0,2).toUpperCase():"?",Q=x.id===t?.id,fe=N+1,me=Q&&Js?Js-fe:0;return a.jsxs("div",{className:`cb-lb-entry${Q?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:U},children:x.photoURL?a.jsx("img",{src:x.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:K})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:U},children:["#",fe,Q&&me>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",me]}),Q&&me<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:me})]})]},x.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:x=>{J(x),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:oi.find(x=>x.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:x=>{J(x),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:oi.find(x=>x.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:x=>{J(x),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Se?a.jsx("img",{src:Se,alt:""}):a.jsx("span",{children:Xc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:it,placeholder:"Share your progress... (use @ to mention)",value:oe,onChange:Oi,rows:1,maxLength:500}),Zt&&Rn==="compose"&&En.length>0&&a.jsx("div",{className:"mention-dropdown",children:En.map(x=>a.jsxs("button",{className:"mention-option",onClick:()=>ds(x,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:x.photoURL?a.jsx("img",{src:x.photoURL,alt:""}):a.jsx("span",{children:Xc(x.name)})}),a.jsx("span",{children:x.name})]},x.id))}),ze&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:ze,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:xr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Ot.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Ot,type:"file",accept:"image/*",onChange:ga,hidden:!0}),(oe.trim()||pt)&&a.jsx("button",{className:"journey-post-btn",onClick:Ns,disabled:Jt,children:Jt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),dt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):Lt.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:Lt.map(x=>a.jsxs("div",{id:`post-${x.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:x.authorPhotoURL?a.jsx("img",{src:x.authorPhotoURL,alt:""}):a.jsx("span",{children:Xc(x.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:x.authorName}),a.jsx("span",{className:"journey-post-time",children:Zp(x.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>ya(x.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),x.type==="workout_summary"&&x.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:x.metadata.title}),x.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:x.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),!x.metadata.stats?.length&&x.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:x.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):x.type==="badge_earned"&&x.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const N=oi.find(U=>U.id===x.metadata.badgeId);return N?.img?a.jsx("img",{src:N.img,alt:x.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:x.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:x.metadata.title}),x.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:x.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):x.type==="habits_summary"&&x.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:x.metadata.title}),x.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:x.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),x.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:x.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[x.content&&a.jsx("p",{className:"journey-post-content",children:er(x.content)}),x.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:x.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${wn.has(x.id)?" liked":""}`,onClick:()=>Li(x.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:wn.has(x.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:x.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Vn.has(x.id)?" active":""}`,onClick:()=>Dr(x.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:x.commentCount||0})]})]}),Vn.has(x.id)&&a.jsxs("div",{className:"journey-comments",children:[Un[x.id]?.length>0?Un[x.id].map(N=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:N.authorPhotoURL?a.jsx("img",{src:N.authorPhotoURL,alt:""}):a.jsx("span",{children:Xc(N.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:N.authorName}),N.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),N.replyToName]}),N.content&&a.jsx("span",{className:"journey-comment-text",children:er(N.content)}),N.imageURL&&a.jsx("img",{className:"journey-comment-image",src:N.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Zp(N.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>lt(U=>({...U,[x.id]:{id:N.id,authorName:N.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>xs(x.id,N.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},N.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),je[x.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:je[x.id].authorName})]}),a.jsx("button",{onClick:()=>lt(N=>({...N,[x.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Xe[x.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Xe[x.id],alt:"Preview"}),a.jsx("button",{onClick:()=>nr(x.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>_n.current[x.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:N=>{_n.current[x.id]=N},type:"file",accept:"image/*",onChange:N=>Jr(x.id,N),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Ct[x.id]||"",onChange:N=>Qn(x.id,N.target.value),onKeyDown:N=>{N.key==="Enter"&&pi(x.id)},maxLength:300}),Zt&&Rn===x.id&&En.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:En.map(N=>a.jsxs("button",{className:"mention-option",onClick:()=>ds(N,x.id),children:[a.jsx("div",{className:"mention-option-avatar",children:N.photoURL?a.jsx("img",{src:N.photoURL,alt:""}):a.jsx("span",{children:Xc(N.name)})}),a.jsx("span",{children:N.name})]},N.id))}),a.jsx("button",{onClick:()=>pi(x.id),disabled:!(Ct[x.id]||"").trim()&&!yt[x.id]||Ze[x.id],children:Ze[x.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},x.id))})]})]}),!g&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(Yr,{active:"home"}),mi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Ie,"/",ee," sessions complete"]})]})}),gn&&a.jsxs("div",{className:`toast-notification ${gn.type}`,children:[gn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),gn.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),gn.message]}),a.jsx(c3,{steps:dn,active:ns,onFinish:I})]})})}async function ef(s,e){const t=oi.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=Fe(ye,"coreBuddyBadges",e.id),l=await vs(i),u=l.exists()?l.data().earned||[]:[];if(u.some(p=>p.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await os(i,{earned:[...u,d]}):await Ts(i,{earned:[d]}),await br(ot(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:Ms(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function ql({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const eg=new Map;function Hr(){return new Date().toISOString().split("T")[0]}const Gw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],A3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function R3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function I3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=Mi(),p=Xs(),[g,y]=w.useState("loading"),[b,E]=w.useState(null),[j,P]=w.useState(null),[F,W]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[z,H]=w.useState(null),[G,X]=w.useState(Hr()),[de,_e]=w.useState({entries:[]}),[pe,C]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[S,M]=w.useState(!1),[V,D]=w.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[L,R]=w.useState(!1),[Ie,Ye]=w.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[ee,Ee]=w.useState(!1),[Pe,Ne]=w.useState(R3),[se,O]=w.useState(null),[te,be]=w.useState(null),[Se,xe]=w.useState(!1),[Ce,Be]=w.useState(null),[Ve,Le]=w.useState(""),[Qt,Dt]=w.useState(!1),[bn,gn]=w.useState(""),[Ut,gt]=w.useState([]),[Lt,sn]=w.useState(!1),[dt,At]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,Xt]=w.useState(null),[pt,Rt]=w.useState("100"),[ze,kt]=w.useState(0),[Jt,cn]=w.useState("weight"),[wn,Ss]=w.useState(0),[Vn,ls]=w.useState(null);w.useRef(null);const Un=w.useRef(!1),xn=w.useRef(null),Ct=w.useRef(null),un=w.useRef(null),Ze=w.useCallback((I,q="info")=>{ls({message:I,type:q}),setTimeout(()=>ls(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await vs(Fe(ye,"nutritionTargets",t.id));q.exists()?(E(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await vs(Fe(ye,"nutritionLogs",`${t.id}_${G}`));if(q.exists()){const J=q.data();_e({entries:J.entries||[]})}else _e({entries:[]})}catch(q){console.error("Error loading log:",q),_e({entries:[]})}})()},[t?.id,G]),w.useEffect(()=>{const I=de.entries.reduce((q,J)=>({protein:q.protein+(J.protein||0),carbs:q.carbs+(J.carbs||0),fats:q.fats+(J.fats||0),calories:q.calories+(J.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});C(I)},[de.entries]);const Z=async I=>{try{if(await Ts(Fe(ye,"nutritionLogs",`${t.id}_${G}`),{clientId:t.id,date:G,entries:I.entries,updatedAt:St.now()}),b?.protein&&G===Hr()&&I.entries.reduce((J,ae)=>J+(ae.protein||0),0)>=b.protein){let J=1;for(let ae=1;ae<7;ae++){const We=new Date;We.setDate(We.getDate()-ae);const $e=We.toISOString().split("T")[0];try{const Re=await vs(Fe(ye,"nutritionLogs",`${t.id}_${$e}`));if(Re.exists())if((Re.data().entries||[]).reduce((ht,Ln)=>ht+(Ln.protein||0),0)>=b.protein)J++;else break;else break}catch{break}}if(J>=7){const ae=await ef("nutrition_7",t);ae&&P(ae)}}}catch(q){console.error("Error saving nutrition log:",q)}},je=G===Hr(),lt=(I,q)=>new Date(I,q+1,0).getDate(),yt=(I,q)=>new Date(I,q,1).getDay(),bt=I=>{if(I===Hr())return"Today";const q=new Date(I+"T12:00:00"),J=new Date;return J.setDate(J.getDate()-1),I===J.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},Xe=["January","February","March","April","May","June","July","August","September","October","November","December"],et=["Su","Mo","Tu","We","Th","Fr","Sa"],it=()=>{let I=parseFloat(F.weight);F.weightUnit==="lbs"&&(I*=.453592);let q;F.heightUnit==="cm"?q=parseFloat(F.height):q=(parseFloat(F.heightFeet)||0)*30.48+(parseFloat(F.heightInches)||0)*2.54;const J=parseInt(F.age);let ae=F.gender==="male"?10*I+6.25*q-5*J+5:10*I+6.25*q-5*J-161;const $e=ae*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[F.dailyActivity],Re={low:100,moderate:200,high:300,daily:400},It=Math.round($e+Re[F.trainingFrequency]);let ht=It,Ln,In;switch(F.goal){case"lose":ht=It*(1-{light:.15,moderate:.2,harsh:.25}[F.deficitLevel]),Ln=2.2,In=.3;break;case"build":ht=It*1.1,Ln=2,In=.22;break;default:Ln=1.8,In=.25}ht=Math.max(ht,F.gender==="male"?1400:1100);const qs=Math.round(I*Ln),dr=Math.round(ht*In/9),ws=Math.max(0,Math.round((ht-qs*4-dr*9)/4));H({calories:Math.round(ht),protein:qs,carbs:ws,fats:dr,bmr:Math.round(ae),neat:Math.round($e),exerciseAdd:Re[F.trainingFrequency],tdee:Math.round(It)})},Ot=async()=>{if(z)try{const I={clientId:t.id,calories:z.calories,protein:z.protein,carbs:z.carbs,fats:z.fats,goal:F.goal,updatedAt:St.now()};await Ts(Fe(ye,"nutritionTargets",t.id),I),E(I),y("dashboard"),Ze("Macro targets saved!","success")}catch(I){console.error("Error saving targets:",I),Ze("Failed to save targets. Please try again.","error")}},_n=()=>{const I=F.weight&&parseFloat(F.weight)>0,q=F.age&&parseInt(F.age)>0,J=F.heightUnit==="cm"?F.height&&parseFloat(F.height)>0:F.heightFeet&&parseFloat(F.heightFeet)>0||F.heightInches&&parseFloat(F.heightInches)>0;return I&&q&&J},kn="nut_favourite_foods",Kn=()=>{try{return JSON.parse(localStorage.getItem(kn)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await vs(Fe(ye,"favouriteFoods",t.id));if(q.exists()){const J=q.data().items||[];localStorage.setItem(kn,JSON.stringify(J)),Ss(ae=>ae+1)}else{const J=Kn();J.length>0&&await Ts(Fe(ye,"favouriteFoods",t.id),{items:J,updatedAt:St.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const le=I=>Kn().some(q=>q.name.toLowerCase()===(I||"").toLowerCase()),Me=I=>{const q=Kn(),J=q.findIndex(ae=>ae.name.toLowerCase()===I.name.toLowerCase());J>=0?q.splice(J,1):q.unshift({name:I.name,protein:I.protein,carbs:I.carbs,fats:I.fats,calories:I.calories,serving:I.serving,per100g:I.per100g||null,servingUnit:I.servingUnit||"g",portion:I.portion||null}),localStorage.setItem(kn,JSON.stringify(q)),t?.id&&Ts(Fe(ye,"favouriteFoods",t.id),{items:q,updatedAt:St.now()}).catch(ae=>console.error("Error saving favourites:",ae)),Ss(ae=>ae+1)},qe=I=>{const q=[...de.entries,{...I,meal:Pe,id:Date.now(),addedAt:new Date().toISOString()}],J={...de,entries:q};_e(J),Z(J),be(null),Xt(null),Rt("100"),kt(0),cn("weight"),At({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ze("Food added!","success")},ct=I=>{const q=de.entries.filter(ae=>ae.id!==I),J={...de,entries:q};_e(J),Z(J)},st=async I=>{if(!(!t?.id||I===G)){Ee(!0);try{const q=await vs(Fe(ye,"nutritionLogs",`${t.id}_${I}`));if(!q.exists()||!q.data().entries?.length){Ze("No food logged on that day","error");return}const J=q.data().entries.map($e=>({...$e,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ae=[...de.entries,...J],We={...de,entries:ae};_e(We),Z(We),R(!1),Ze(`Copied ${J.length} items from ${bt(I)}`,"success")}catch(q){console.error("Error copying day:",q),Ze("Failed to copy day","error")}finally{Ee(!1)}}},Kt=w.useRef(null),rn=w.useRef([]),Zt=3,Nt=5,Rn=async()=>{xe(!0);const I=document.querySelector("#barcode-reader");if(!I){xe(!1),Ze("Scanner container not found.","error");return}if(!Kt.current)try{const J=await Qs(()=>import("./quagga.min-BbicSfvA.js").then(ae=>ae.q),[]);Kt.current=J.default}catch(J){console.error("Failed to load barcode scanner:",J),xe(!1),Ze("Could not load scanner.","error");return}const q=Kt.current;q.init({inputStream:{type:"LiveStream",target:I,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},J=>{if(J){console.error("Quagga init error:",J),xe(!1),Ze("Could not access camera. Check permissions.","error");return}q.start(),Un.current=!0}),rn.current=[],q.onDetected(J=>{const ae=J.codeResult.decodedCodes?.filter($e=>$e.error!==void 0)?.map($e=>$e.error)||[];if((ae.length>0?ae.reduce(($e,Re)=>$e+Re,0)/ae.length:1)<.15){const $e=J.codeResult.code,Re=rn.current;Re.push($e),Re.length>Nt&&Re.shift(),Re.filter(ht=>ht===$e).length>=Zt&&(q.offDetected(),rn.current=[],Be($e))}})},en=()=>{const I=Kt.current;Un.current&&I&&(I.stop(),I.offDetected(),Un.current=!1),xe(!1)},En=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Bn=I=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((I||"").replace(/\s/g,"")),ur=I=>{if(!I)return{value:100,unit:"g"};const q=I.toLowerCase().replace(/\s/g,""),J=q.match(/([\d.]+)/),ae=J?parseFloat(J[1]):100;return Bn(I)?/cl/.test(q)?{value:ae*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:ae*1e3,unit:"ml"}:{value:ae,unit:"ml"}:{value:ae,unit:"g"}},fi=I=>{if(Bn(I.serving_size)||Bn(I.quantity))return"ml";const q=I.product_name||I.product_name_en||"";return En.test(q)?"ml":"g"},mi=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Qr=(I,q)=>{const J=I||"",ae=J.match(/\((\d+\.?\d*)\s*g\)/i),We=J.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ae&&We){const It=parseFloat(ae[1]);let ht=We[1].replace(/^\d+\s*/,"").trim();if(ht&&It>0)return{label:ht,weight:It}}const $e=J.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if($e){const It=parseFloat($e[1]);let ht=$e[2].replace(/^\d+\s*/,"").trim();if(ht&&It>0)return{label:ht,weight:It}}const Re=q||"";for(const{pattern:It,label:ht,weight:Ln}of mi)if(It.test(Re))return{label:ht,weight:Ln};return null},Cs=I=>{const q=I.nutriments||{},J=fi(I),ae=ur(I.serving_size),We=J==="ml"?ae.unit==="ml"?ae.value:100:ae.value,$e=I.product_name||I.product_name_en||"Unknown Product",Re=Qr(I.serving_size,$e);return{name:$e,brand:I.brands||"",image:I.image_small_url||I.image_url||null,servingSize:I.serving_size||"100g",servingValue:We,servingUnit:J,portion:Re,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},Js=async I=>{Dt(!0);try{const q=`https://world.openfoodfacts.org/api/v2/product/${I}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,J=await fetch(q);if(!J.ok)throw new Error(`HTTP ${J.status}`);const ae=await J.json();if(ae.status==="success"||ae.status===1||ae.product){const We=Cs(ae.product);We.calories===0&&We.protein===0&&We.carbs===0?Ze("Product found but no nutrition data available.","error"):(Xt(We),We.portion?(kt(1),Rt(String(We.portion.weight)),cn("portion")):(kt(0),Rt(String(We.servingValue||100)),cn("weight")),Le(""))}else Ze("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),Ze("Failed to look up product. Check your connection.","error")}Dt(!1)},Yn=(I,q,J)=>{const ae=I.toLowerCase().trim(),We=q.toLowerCase().trim(),$e=J.toLowerCase().trim();let Re=0;return(ae===$e||ae===$e+"s"||ae+"s"===$e)&&(Re+=100),(ae.endsWith(" "+$e)||ae.endsWith(" "+$e+"s"))&&(Re+=40),(ae.startsWith($e+" ")||ae.startsWith($e+"s "))&&(Re+=15),$e.split(/\s+/).some(ht=>We===ht||We.startsWith(ht))&&(Re+=30),Re+=Math.max(0,30-ae.length),Re},ns=async()=>{if(!bn.trim())return;xn.current&&xn.current.abort();const I=new AbortController;xn.current=I;const q=bn.trim().toLowerCase(),J=q.split(/\s+/).filter(Boolean);if(eg.has(q)){gt(eg.get(q));return}sn(!0);try{const We=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(bn.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,$e=await fetch(We,{signal:I.signal});if(!$e.ok)throw new Error(`HTTP ${$e.status}`);const It=((await $e.json()).products||[]).map(ht=>Cs(ht)).filter(ht=>ht.name!=="Unknown Product"&&(ht.calories>0||ht.protein>0)).filter(ht=>{const Ln=(ht.name+" "+ht.brand).toLowerCase();return J.every(In=>Ln.includes(In))}).sort((ht,Ln)=>Yn(Ln.name,Ln.brand,q)-Yn(ht.name,ht.brand,q)).slice(0,10);eg.set(q,It),gt(It),It.length===0&&Ze("No results found. Try a different search.","info")}catch(ae){if(ae.name==="AbortError")return;console.error("Search error:",ae),Ze("Search failed. Check your connection.","error")}sn(!1)};w.useEffect(()=>{if(Ct.current&&clearTimeout(Ct.current),!(!bn.trim()||te!=="search"||oe))return Ct.current=setTimeout(()=>{ns()},700),()=>clearTimeout(Ct.current)},[bn]);const $n=l,Wn={"ring-protein":$n?"#2dd4bf":"#14b8a6","ring-carbs":$n?"#fbbf24":"#f59e0b","ring-fats":$n?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},dn=80,Ds=2*Math.PI*dn,cs=(I,q,J,ae,We)=>{const $e=ae>0?Math.min(100,Math.round(J/ae*100)):0,Re=Ds-$e/100*Ds,It=Wn[We]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:dn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:dn,style:{stroke:It},strokeDasharray:Ds,strokeDashoffset:Re})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:It},children:Math.round(J)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ae,I==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:It},children:q})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:It},children:[$e,"%"]})]})};if(w.useEffect(()=>{if(!Ce)return;const I=setTimeout(()=>{const q=Ce;en(),Be(null),Js(q)},1500);return()=>clearTimeout(I)},[Ce]),w.useEffect(()=>()=>{const I=Kt.current;if(Un.current&&I){try{I.stop(),I.offDetected()}catch{}Un.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:F.gender==="male"?"active":"",onClick:()=>{W(I=>({...I,gender:"male"})),H(null)},children:"Male"}),a.jsx("button",{className:F.gender==="female"?"active":"",onClick:()=>{W(I=>({...I,gender:"female"})),H(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:F.age,onChange:I=>{W(q=>({...q,age:I.target.value})),H(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:F.weight,onChange:I=>{W(q=>({...q,weight:I.target.value})),H(null)},placeholder:F.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:F.weightUnit==="kg"?"active":"",onClick:()=>{W(I=>({...I,weightUnit:"kg"})),H(null)},children:"kg"}),a.jsx("button",{className:F.weightUnit==="lbs"?"active":"",onClick:()=>{W(I=>({...I,weightUnit:"lbs"})),H(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[F.heightUnit==="cm"?a.jsx("input",{type:"number",value:F.height,onChange:I=>{W(q=>({...q,height:I.target.value})),H(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:F.heightFeet,onChange:I=>{W(q=>({...q,heightFeet:I.target.value})),H(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:F.heightInches,onChange:I=>{W(q=>({...q,heightInches:I.target.value})),H(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:F.heightUnit==="cm"?"active":"",onClick:()=>{W(I=>({...I,heightUnit:"cm"})),H(null)},children:"cm"}),a.jsx("button",{className:F.heightUnit==="ft"?"active":"",onClick:()=>{W(I=>({...I,heightUnit:"ft"})),H(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:F.dailyActivity,onChange:I=>{W(q=>({...q,dailyActivity:I.target.value})),H(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:F.trainingFrequency,onChange:I=>{W(q=>({...q,trainingFrequency:I.target.value})),H(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:F.goal==="lose"?"active":"",onClick:()=>{W(I=>({...I,goal:"lose"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:F.goal==="maintain"?"active":"",onClick:()=>{W(I=>({...I,goal:"maintain"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:F.goal==="build"?"active":"",onClick:()=>{W(I=>({...I,goal:"build"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),F.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:F.deficitLevel==="light"?"active":"",onClick:()=>{W(I=>({...I,deficitLevel:"light"})),H(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:F.deficitLevel==="moderate"?"active":"",onClick:()=>{W(I=>({...I,deficitLevel:"moderate"})),H(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:F.deficitLevel==="harsh"?"active":"",onClick:()=>{W(I=>({...I,deficitLevel:"harsh"})),H(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:it,disabled:!_n(),children:"Calculate Macros"})]}),z&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[cs("Protein","Protein",z.protein,z.protein,"ring-protein"),cs("Carbs","Carbs",z.carbs,z.carbs,"ring-carbs"),cs("Fats","Fats",z.fats,z.fats,"ring-fats"),cs("Calories","Calories",z.calories,z.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[z.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[z.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",z.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[z.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Ot,children:"Set as My Daily Targets"})]})]}),Vn&&a.jsx("div",{className:`toast-notification ${Vn.type}`,children:Vn.message})]});const Fs=I=>{const q=new Date(I+"T12:00:00"),J=q.getDay(),ae=new Date(q);ae.setDate(q.getDate()-(J+6)%7);const We=[];for(let $e=0;$e<7;$e++){const Re=new Date(ae);Re.setDate(ae.getDate()+$e),We.push(Re.toISOString().split("T")[0])}return We},us=["M","T","W","T","F","S","S"],Zs=(I,q="search")=>{Ne(I),q==="scan"?(be("scan"),Xt(null)):q==="manual"?(be("manual"),At({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?be("favourites"):(be("search"),gt([]),gn(""))},ds=Fs(G),er=new Date(G+"T12:00:00"),Di=`${Xe[er.getMonth()]} ${er.getFullYear()}`;return a.jsx(Zo,{children:a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),H(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(G+"T12:00:00");I.setDate(I.getDate()-7);const q=I.toISOString().split("T")[0];X(q)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{M(!S),D({year:er.getFullYear(),month:er.getMonth()})},children:Di}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(G+"T12:00:00");I.setDate(I.getDate()+7);const q=I.toISOString().split("T")[0];q<=Hr()&&X(q)},"aria-label":"Next week",disabled:ds[6]>=Hr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:ds.map((I,q)=>{const J=new Date(I+"T12:00:00").getDate(),ae=I===G,We=I>Hr(),$e=I===Hr();return a.jsxs("button",{className:`nut-week-day${ae?" selected":""}${$e?" today":""}${We?" future":""}`,disabled:We,onClick:()=>X(I),children:[a.jsx("span",{className:"nut-week-day-letter",children:us[q]}),a.jsx("span",{className:"nut-week-day-num",children:J})]},I)})})]}),S&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>D(I=>{let q=I.month-1,J=I.year;return q<0&&(q=11,J--),{year:J,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Xe[V.month]," ",V.year]}),a.jsx("button",{onClick:()=>D(I=>{let q=I.month+1,J=I.year;return q>11&&(q=0,J++),{year:J,month:q}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:et.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(yt(V.year,V.month))].map((I,q)=>a.jsx("span",{},`e${q}`)),[...Array(lt(V.year,V.month))].map((I,q)=>{const J=q+1,ae=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(J).padStart(2,"0")}`,We=ae>Hr(),$e=ae===G,Re=ae===Hr();return a.jsx("button",{className:`nut-cal-day${$e?" selected":""}${Re?" today":""}${We?" future":""}`,disabled:We,onClick:()=>{X(ae),M(!1)},children:J},J)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[cs("Protein","Protein",pe.protein,b.protein,"ring-protein"),cs("Carbs","Carbs",pe.carbs,b.carbs,"ring-carbs"),cs("Fats","Fats",pe.fats,b.fats,"ring-fats"),cs("Calories","kCal",pe.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[je&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{R(!0),Ye({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Gw.map(I=>{const q=de.entries.filter(ae=>(ae.meal||"snacks")===I.key),J=q.reduce((ae,We)=>({protein:ae.protein+(We.protein||0),carbs:ae.carbs+(We.carbs||0),fats:ae.fats+(We.fats||0),calories:ae.calories+(We.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${I.key}`,children:A3[I.key]}),a.jsx("span",{className:"nut-meal-card-title",children:I.label}),q.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[J.calories," cal"]}),je&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>O(se===I.key?null:I.key),"aria-label":`Add to ${I.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?J.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[J.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?J.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[J.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?J.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[J.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?J.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:J.calories})]})]}),q.length>0&&a.jsx("div",{className:"nut-log-list",children:q.map(ae=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${le(ae.name)?" active":""}`,onClick:()=>Me(ae),"aria-label":le(ae.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:le(ae.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ae.name}),ae.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ae.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ae.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ae.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ae.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ae.calories})]}),je&&a.jsx("button",{className:"nut-log-delete",onClick:()=>ct(ae.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))}),q.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:je?"Tap + to add food":"No entries"})})]},I.key)})})})]})}),se&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>O(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Gw.find(I=>I.key===se)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const I=se;O(null),Zs(I,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const I=se;O(null),Zs(I,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const I=se;O(null),Zs(I,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const I=se;O(null),Zs(I,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),L&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>R(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>R(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Ye(I=>{let q=I.month-1,J=I.year;return q<0&&(q=11,J--),{year:J,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Xe[Ie.month]," ",Ie.year]}),a.jsx("button",{onClick:()=>Ye(I=>{let q=I.month+1,J=I.year;return q>11&&(q=0,J++),{year:J,month:q}}),disabled:Ie.year===new Date().getFullYear()&&Ie.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:et.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(yt(Ie.year,Ie.month))].map((I,q)=>a.jsx("span",{},`e${q}`)),[...Array(lt(Ie.year,Ie.month))].map((I,q)=>{const J=q+1,ae=`${Ie.year}-${String(Ie.month+1).padStart(2,"0")}-${String(J).padStart(2,"0")}`,We=ae>Hr(),$e=ae===G,Re=ae===Hr(),It=We||$e;return a.jsx("button",{className:`nut-cal-day${$e?" selected":""}${Re?" today":""}${We?" future":""}`,disabled:It,onClick:()=>st(ae),children:J},J)})]}),ee&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),te&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{en(),Be(null),be(null),Xt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:te==="scan"?"Scan Barcode":te==="search"?"Search Food":te==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{en(),Be(null),be(null),Xt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),te==="scan"&&!oe&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Se&&!Ce&&a.jsx("div",{className:"nut-scan-line"}),Ce&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:Ce})]})]}),!Se&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Rn,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Se&&!Ce&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Ve,onChange:I=>Le(I.target.value),onKeyDown:I=>I.key==="Enter"&&Ve.trim()&&Js(Ve.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Ve.trim()&&Js(Ve.trim()),disabled:!Ve.trim()||Qt,children:Qt?"...":"Look Up"})]})]}),te==="scan"&&oe&&(()=>{const I=oe.servingUnit||"g",q=oe.portion,J=Jt==="portion"&&q?ze*q.weight:parseFloat(pt)||0,ae=J/100,We=I==="ml"?[100,200,250,500]:[50,100,150,200],$e=Jt==="portion"&&q?`${ze} ${q.label}${ze!==1?"s":""} (${Math.round(J)}${I})`:`${Math.round(J)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(oe.name)?" active":""}`,onClick:()=>Me({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Jt==="portion"?"active":"",onClick:()=>{cn("portion"),ze<1&&kt(1)},children:"Portions"}),a.jsxs("button",{className:Jt==="weight"?"active":"",onClick:()=>{cn("weight"),Rt(String(Math.round(J)||100))},children:["Custom (",I,")"]})]}),Jt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,ze-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ze}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,ze!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(J),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(ze+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Re=>Rt(Re.target.value),onFocus:Re=>Re.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:We.map(Re=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Re)?" active":""}`,onClick:()=>Rt(String(Re)),children:[Re,I]},Re))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ae),"p / ",Math.round(oe.carbs*ae),"c / ",Math.round(oe.fats*ae),"f / ",Math.round(oe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Xt(null),be("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qe({name:oe.name,protein:Math.round(oe.protein*ae),carbs:Math.round(oe.carbs*ae),fats:Math.round(oe.fats*ae),calories:Math.round(oe.calories*ae),serving:$e}),children:"Add"})]})]})})(),te==="search"&&!oe&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:un,value:bn,onChange:I=>gn(I.target.value),onKeyDown:I=>{I.key==="Enter"&&(clearTimeout(Ct.current),ns())},onFocus:()=>setTimeout(()=>un.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:ns,disabled:Lt,children:Lt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Ut.map((I,q)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{Xt(I),I.portion?(kt(1),Rt(String(I.portion.weight)),cn("portion")):(kt(0),Rt(String(I.servingValue||100)),cn("weight"))},children:[I.image&&a.jsx("img",{src:I.image,alt:I.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:I.name}),I.brand&&a.jsx("span",{className:"nut-search-item-brand",children:I.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[I.calories," cal  ",I.protein,"p  ",I.carbs,"c  ",I.fats,"f per 100",I.servingUnit||"g"]})]})]},q)),Ut.length===0&&bn&&!Lt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),te==="search"&&oe&&(()=>{const I=oe.servingUnit||"g",q=oe.portion,J=Jt==="portion"&&q?ze*q.weight:parseFloat(pt)||0,ae=J/100,We=I==="ml"?[100,200,250,500]:[50,100,150,200],$e=Jt==="portion"&&q?`${ze} ${q.label}${ze!==1?"s":""} (${Math.round(J)}${I})`:`${Math.round(J)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[oe.image&&a.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(oe.name)?" active":""}`,onClick:()=>Me({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&a.jsx("p",{className:"nut-product-brand",children:oe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Jt==="portion"?"active":"",onClick:()=>{cn("portion"),ze<1&&kt(1)},children:"Portions"}),a.jsxs("button",{className:Jt==="weight"?"active":"",onClick:()=>{cn("weight"),Rt(String(Math.round(J)||100))},children:["Custom (",I,")"]})]}),Jt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,ze-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ze}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,ze!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(J),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(ze+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Re=>Rt(Re.target.value),onFocus:Re=>Re.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:We.map(Re=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Re)?" active":""}`,onClick:()=>Rt(String(Re)),children:[Re,I]},Re))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ae),"p / ",Math.round(oe.carbs*ae),"c / ",Math.round(oe.fats*ae),"f / ",Math.round(oe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qe({name:oe.name,protein:Math.round(oe.protein*ae),carbs:Math.round(oe.carbs*ae),fats:Math.round(oe.fats*ae),calories:Math.round(oe.calories*ae),serving:$e}),children:"Add"})]})]})})(),te==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:dt.name,onChange:I=>At(q=>({...q,name:I.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:dt.serving,onChange:I=>At(q=>({...q,serving:I.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:dt.protein,onChange:I=>At(q=>({...q,protein:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:dt.carbs,onChange:I=>At(q=>({...q,carbs:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:dt.fats,onChange:I=>At(q=>({...q,fats:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:dt.calories,onChange:I=>At(q=>({...q,calories:I.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!dt.name.trim(),onClick:()=>qe({name:dt.name,protein:parseFloat(dt.protein)||0,carbs:parseFloat(dt.carbs)||0,fats:parseFloat(dt.fats)||0,calories:parseFloat(dt.calories)||0,serving:dt.serving||""}),children:"Add Food"})]}),te==="favourites"&&!oe&&(()=>{const I=Kn(),q=J=>{if(J.per100g){const ae=J.per100g;Xt({name:J.name,brand:"",image:null,servingSize:J.serving||"100g",servingValue:100,servingUnit:J.servingUnit||"g",portion:J.portion||null,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,per100g:!0}),J.portion?(kt(1),Rt(String(J.portion.weight)),cn("portion")):(kt(0),Rt("100"),cn("weight"))}else qe({name:J.name,protein:J.protein,carbs:J.carbs,fats:J.fats,calories:J.calories,serving:J.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:I.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:I.map((J,ae)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:We=>{We.stopPropagation(),Me(J)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>q(J),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:J.name}),a.jsx("span",{className:"nut-recent-item-serving",children:J.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[J.calories," cal"]})]})]},ae))})})})(),te==="favourites"&&oe&&(()=>{const I=oe.servingUnit||"g",q=oe.portion,J=Jt==="portion"&&q?ze*q.weight:parseFloat(pt)||0,ae=J/100,We=I==="ml"?[100,200,250,500]:[50,100,150,200],$e=Jt==="portion"&&q?`${ze} ${q.label}${ze!==1?"s":""} (${Math.round(J)}${I})`:`${Math.round(J)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:oe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(oe.name)?" active":""}`,onClick:()=>Me({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Jt==="portion"?"active":"",onClick:()=>{cn("portion"),ze<1&&kt(1)},children:"Portions"}),a.jsxs("button",{className:Jt==="weight"?"active":"",onClick:()=>{cn("weight"),Rt(String(Math.round(J)||100))},children:["Custom (",I,")"]})]}),Jt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(Math.max(1,ze-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ze}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,ze!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(J),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>kt(ze+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Re=>Rt(Re.target.value),onFocus:Re=>Re.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:We.map(Re=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Re)?" active":""}`,onClick:()=>Rt(String(Re)),children:[Re,I]},Re))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(oe.protein*ae),"p / ",Math.round(oe.carbs*ae),"c / ",Math.round(oe.fats*ae),"f / ",Math.round(oe.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qe({name:oe.name,protein:Math.round(oe.protein*ae),carbs:Math.round(oe.carbs*ae),fats:Math.round(oe.fats*ae),calories:Math.round(oe.calories*ae),serving:$e}),children:"Add"})]})]})})()]})}),a.jsx(Yr,{active:"nutrition"}),Vn&&a.jsx("div",{className:`toast-notification ${Vn.type}`,children:Vn.message}),a.jsx(ql,{badge:j,onDismiss:()=>P(null)})]})})}async function M3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const b=y.getContext("2d"),E="#2a2a28",j="#ffffff",P="#A12F3A",F="#1a1a1a",W="#555555";b.fillStyle=E,b.fillRect(0,0,p,g);const z=Math.round(p*.82),H=Math.round(g*.75),G=Math.round((p-z)/2),X=Math.round((g-H)/2),de=28,_e=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Kw(b,G,X,z,H,de),b.fillStyle=j,b.fill(),b.restore(),b.save(),Kw(b,G,X,z,H,de),b.strokeStyle=P,b.lineWidth=_e,b.stroke(),b.restore();const pe=220,C=50,S=52,M=68,V=10,D=36,L=48,R=30,Ie=34,Ye=46,ee=30,Ee=28;b.font=`bold ${S}px 'Orbitron', sans-serif`;const Pe=Jc(b,t.toUpperCase(),z-100);b.font=`500 ${D}px 'Montserrat', sans-serif`;let Ne=[];e==="badge"&&d?Ne=Jc(b,d,z-120):e==="badge"&&l.length>0?Ne=Jc(b,l.join("    "),z-120):i.length>0&&(Ne=Jc(b,i.map(gt=>`${gt.value} ${gt.label}`).join("    "),z-120));const se=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Ie}px 'Montserrat', sans-serif`;const O=Jc(b,se,z-80);let te=Pe.length*M;Ne.length>0&&(te+=V+Ne.length*L),te+=R+O.length*Ye,te+=ee+Ee;const Se=X+H-60-te,Ce=X+40,Be=Se-C,Ve=p/2,Le=(Ce+Be)/2,Qt=e==="badge"&&u?u:"/Logo.webp";b.save();const Dt=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",bn=b.createRadialGradient(Ve,Le,pe*.6,Ve,Le,pe*1.5);bn.addColorStop(0,Dt),bn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=bn,b.fillRect(Ve-pe*1.5,Le-pe*1.5,pe*3,pe*3),b.restore(),b.beginPath(),b.arc(Ve,Le,pe+6,0,Math.PI*2),b.fillStyle=j,b.fill();const gn=e==="badge"?"#ffc107":P;b.beginPath(),b.arc(Ve,Le,pe,0,Math.PI*2),b.strokeStyle=gn,b.lineWidth=5,b.stroke();try{const gt=await D3(Qt);b.save(),b.beginPath(),b.arc(Ve,Le,pe-6,0,Math.PI*2),b.clip();const Lt=(pe-6)*2;b.drawImage(gt,Ve-pe+6,Le-pe+6,Lt,Lt),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=P,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Ve,Le)}let Ut=Se;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=F,b.font=`bold ${S}px 'Orbitron', sans-serif`;for(const gt of Pe)b.fillText(gt,p/2,Ut),Ut+=M;if(Ne.length>0){Ut+=V,b.fillStyle=W,b.font=`500 ${D}px 'Montserrat', sans-serif`;for(const gt of Ne)b.fillText(gt,p/2,Ut),Ut+=L}Ut+=R,b.fillStyle=F,b.font=`bold ${Ie}px 'Montserrat', sans-serif`;for(const gt of O)b.fillText(gt,p/2,Ut),Ut+=Ye;return Ut+=ee,b.fillStyle=P,b.font=`600 ${Ee}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,Ut),new Promise(gt=>{y.toBlob(Lt=>gt(Lt),"image/png")})}function Kw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function D3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Jc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;s.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function L3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const b=u.createOscillator(),E=u.createGain();b.type="sine",b.frequency.value=70,E.gain.value=.2,E.gain.setTargetAtTime(0,d+.22,.04),b.connect(E).connect(p),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const O3=2e3,Wg=42,Rl=2*Math.PI*Wg,P3=1200,Yw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Gg({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:b=!1}){const[E,j]=w.useState("hold"),[P,F]=w.useState(!1),[W,z]=w.useState(0),[H,G]=w.useState(!1),[X,de]=w.useState(!1),[_e,pe]=w.useState(null),C=L3(),S=w.useRef(null),M=w.useRef(null),V=w.useRef(null),D=w.useRef(null),L=w.useRef(!1),R=w.useRef(!1),Ie=w.useRef(0),Ye=w.useRef(Yw[Math.floor(Math.random()*Yw.length)]),ee=w.useRef([...Array(80)].map((xe,Ce)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ce%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ce%3}))),Ee=w.useCallback(()=>{if(L.current)return;L.current=!0,R.current=!1,Ie.current=0,F(!0),z(0),D.current=performance.now(),C.tap(),S.current&&(S.current.style.strokeDashoffset=Rl);const xe=Ce=>{const Be=Ce-D.current,Ve=Math.min(Be/O3,1);if(S.current&&(S.current.style.strokeDashoffset=Rl-Ve*Rl),M.current){const Le=8*(1-Ve),Qt=1-Ve,Dt=1+Ve*.15;M.current.style.filter=`blur(${Le}px) grayscale(${Qt})`,M.current.style.transform=`scale(${Dt})`}z(Ve),Be-Ie.current>=P3&&(Ie.current=Be,C.tick()),Ve<1?V.current=requestAnimationFrame(xe):(L.current=!1,R.current=!0,V.current=null,F(!1),z(1),C.complete(),j("celebrate"))};V.current=requestAnimationFrame(xe)},[C]),Pe=w.useCallback(()=>{L.current&&(L.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),S.current&&(S.current.style.strokeDashoffset=Rl),M.current&&(M.current.style.filter="",M.current.style.transform=""),F(!1),z(0))},[]),Ne=w.useCallback(()=>{G(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),se=w.useCallback(()=>{const xe=[s||"Workout Complete!"];return e&&xe.push(e),t?.length&&xe.push(t.map(Ce=>`${Ce.value} ${Ce.label}`).join(" | ")),xe.push("#MindCoreFitness"),xe.join(`
`)},[s,e,t]),O=w.useCallback(async()=>{if(!(X||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ye.current}),de(!0),pe("Posted to Journey!"),setTimeout(()=>pe(null),2500)}catch(xe){console.error("Journey post failed:",xe),pe(xe?.message||"Failed to post"),setTimeout(()=>pe(null),3500)}},[X,u,s,e,t]),[te,be]=w.useState(!1),Se=w.useCallback(async()=>{be(!0);try{const xe=await M3({type:y||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ye.current,userName:d}),Ce=se();if(navigator.share&&navigator.canShare?.({files:[new File([xe],"workout.png",{type:"image/png"})]})){const Be=new File([xe],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ce,files:[Be]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ce}):(await navigator.clipboard.writeText(Ce),pe("Copied to clipboard!"),setTimeout(()=>pe(null),2500))}catch{try{await navigator.clipboard.writeText(se()),pe("Copied to clipboard!"),setTimeout(()=>pe(null),2500)}catch{}}finally{be(!1)}},[s,e,t,d,se]);return E==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:g}),a.jsxs("div",{className:`wc-hold-ring-touch ${P?"wc-holding":""}`,onPointerDown:xe=>{xe.preventDefault(),Ee()},onPointerUp:Pe,onPointerLeave:Pe,onPointerCancel:Pe,onClick:xe=>{xe.stopPropagation(),R.current&&(R.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:xe=>{(xe.key==="Enter"||xe.key===" ")&&(xe.preventDefault(),C.complete(),j("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Wg}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:S,cx:"50",cy:"50",r:Wg,style:{strokeDasharray:Rl,strokeDashoffset:Rl}})]}),a.jsx("img",{ref:M,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${H?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:ee.current.map((xe,Ce)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${xe.shape}`,style:{"--x":`${xe.x}%`,"--delay":`${xe.delay}s`,"--color":xe.color,"--drift":`${xe.drift}px`,"--spin":`${xe.spin}deg`,"--duration":`${xe.duration}s`,width:`${xe.width}px`,height:`${xe.height}px`}},Ce))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Ye.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((xe,Ce)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:xe.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:xe.label})]},Ce))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${X?"wc-share-done":""}`,onClick:O,disabled:X,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),X?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Se,disabled:te,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),te?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Ne,children:p}),_e&&a.jsx("div",{className:"wc-share-toast",children:_e})]})]})}const Qw="/login/assets/randomiser-glq9YJkL.jpg",Xw="/login/assets/programme-card-workout-CnNzTYkz.webp",V3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",U3="/login/assets/muscle-group-arms-C9AdZL4-.png",B3="/login/assets/arms-bicep-BUrmT1o-.png",z3="/login/assets/arms-tricep-D9tAnFnS.png",F3="/login/assets/arms-full-arms-BY3TvpJm.png",q3="/login/assets/muscle-group-chest-Cxfuc7XI.png",H3="/login/assets/chest-strength-BR4BAFTH.png",$3="/login/assets/chest-hypertrophy-B8yNrvjB.png",W3="/login/assets/chest-endurance-e-OSWtWO.png",G3="/login/assets/muscle-group-shoulders-DibNtCLF.png",K3="/login/assets/shoulders-strength-CKlZBF5A.png",Y3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",Q3="/login/assets/shoulders-endurance-HuqNG5rD.png",X3="/login/assets/muscle-group-core-CPR-bdRg.png",J3="/login/assets/core-lower-abs-TVcqGMFJ.png",Z3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e5="/login/assets/core-weighted-core-4Kwh9mTv.png",t5="/login/assets/muscle-group-back-8JPV-YUo.png",n5="/login/assets/back-strength-BmSRxnwo.png",s5="/login/assets/back-hypertrophy-CXHmsnCz.png",r5="/login/assets/back-endurance-C8qJ8l5I.png",i5="/login/assets/muscle-group-legs-B8jcbdov.png",a5="/login/assets/legs-quads-DbnfsebI.png",o5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l5="/login/assets/legs-power-plyo-D2qBXeUR.png",c5=60,tg=5,u5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},d5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ng={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},sg=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:V3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Zc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:U3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:q3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:G3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:i5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:X3}],Jw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:H3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:W3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:n5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:s5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:K3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:Y3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:Q3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:B3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:z3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:F3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:a5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:J3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:Z3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},rg=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],$r=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],_i=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],ig=[5,10,15,20,30],ph={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Zw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function h5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function f5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function m5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=Mi(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=oc(),b=Xs(),[E,j]=w.useState("randomiser_hub"),[P,F]=w.useState(["bodyweight"]),[W,z]=w.useState("core"),[H,G]=w.useState("intermediate"),[X,de]=w.useState(p?15:5),[_e,pe]=w.useState([]),[C,S]=w.useState(!1),M=w.useRef(!1),V=w.useRef([]),[D,L]=w.useState([]),[R,Ie]=w.useState(2),[Ye,ee]=w.useState(_i[1]),[Ee,Pe]=w.useState(1),[Ne,se]=w.useState(0),[O,te]=w.useState("work"),[be,Se]=w.useState(0),[xe,Ce]=w.useState(!1),[Be,Ve]=w.useState(0),[Le,Qt]=w.useState(!1),[Dt,bn]=w.useState(!1),[gn,Ut]=w.useState(null),gt=w.useRef(null);w.useRef(null),w.useRef(null);const[Lt,sn]=w.useState(null),dt=w.useCallback((x,N="info")=>{sn({message:x,type:N}),setTimeout(()=>sn(null),3e3)},[]),At=w.useCallback(async x=>{if(!t)throw new Error("Not signed in");const N=x&&typeof x=="object"&&x.type;await br(ot(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:N?"":x,type:N?x.type:"text",imageURL:null,createdAt:Ms(),likeCount:0,commentCount:0,...N?{metadata:{title:x.title||"",subtitle:x.subtitle||"",stats:x.stats||[],quote:x.quote||"",badges:x.badges||[]}}:{}})},[t]),[oe,Xt]=w.useState(null),[pt,Rt]=w.useState(null),[ze,kt]=w.useState(0),[Jt,cn]=w.useState(0),[wn,Ss]=w.useState([]),[Vn,ls]=w.useState(""),[Un,xn]=w.useState(""),[Ct,un]=w.useState(!1),[Ze,Z]=w.useState(0),[je,lt]=w.useState(!1),[yt,bt]=w.useState({}),Xe=w.useRef(null),et=w.useRef(null),[it,Ot]=w.useState(0),[_n,kn]=w.useState(0),[Kn,le]=w.useState(0),[Me,qe]=w.useState(0),[ct,st]=w.useState(0),[Kt,rn]=w.useState(0),[Zt,Nt]=w.useState(null),[Rn,en]=w.useState({beginner:0,intermediate:0,advanced:0}),En=p?ig:ig.filter(x=>g.includes(x)),Bn=!p&&it>=y,[ur,fi]=w.useState([]),[mi,Qr]=w.useState(!1),[Cs,Js]=w.useState({}),[Yn,ns]=w.useState(!1),[$n,Wn]=w.useState(!1),[dn,Ds]=w.useState(""),[cs,Fs]=w.useState(null),[us,Zs]=w.useState([]),[ds,er]=w.useState({total:0,favouriteFocus:null,streak:0}),[Di,I]=w.useState(null),[q,J]=w.useState(""),[ae,We]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&b("/")},[s,e,i,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const N=ot(ye,"workoutLogs"),U=nn(N,vt("clientId","==",t.id)),Q=(await Gt(U)).docs.map(Je=>Je.data()),fe=Q.filter(Je=>Je.type!=="programme");qe(fe.length);const me=fe.reduce((Je,an)=>Je+(an.duration||0),0);st(me);const De={beginner:0,intermediate:0,advanced:0};fe.forEach(Je=>{Je.level&&De[Je.level]!==void 0&&De[Je.level]++}),en(De);const Ae=new Date,Ge=Ae.getDay(),at=Ge===0?-6:1-Ge,Mt=new Date(Ae);Mt.setDate(Ae.getDate()+at),Mt.setHours(0,0,0,0);const _s=Mt.getTime(),rt=Q.filter(Je=>{const an=Je.completedAt;return an?(an.toDate?an.toDate().getTime():new Date(an).getTime())>=_s:!1});Ot(rt.filter(Je=>Je.type!=="programme").length);let $t=0;if(t)try{const Je=await vs(Fe(ye,"clientProgrammes",t.id));if(Je.exists()){const an=Je.data(),Nn=an.templateId;$t=rt.filter(Mn=>Mn.type==="programme"&&Mn.programmeId===Nn).length,I(Nn);const zn=sg.find(Mn=>Mn.id===Nn);zn&&J(zn.name);const ks=u5[Nn];if(ks){const Mn=Object.keys(an.completedSessions||{}).length,As=ks.duration*ks.daysPerWeek;le(As>0?Math.round(Mn/As*100):0)}}else I(null),J(""),le(0)}catch{}kn($t);const tn=fe.map(Je=>Je.completedAt).filter(Boolean).map(Je=>Je.toDate?Je.toDate().getTime():new Date(Je).getTime()).sort((Je,an)=>an-Je);if(tn.length===0)rn(0);else{const Je=new Set;tn.forEach(As=>{const Hs=new Date(As),Pi=Hs.getDay(),uo=Pi===0?-6:1-Pi,Zr=new Date(Hs);Zr.setDate(Hs.getDate()+uo),Zr.setHours(0,0,0,0),Je.add(Zr.getTime())});const an=[...Je].sort((As,Hs)=>Hs-As);let Nn=0;const zn=new Date(Ae),ks=Ae.getDay()===0?-6:1-Ae.getDay();zn.setDate(Ae.getDate()+ks),zn.setHours(0,0,0,0);let Mn=zn.getTime();an.includes(Mn)||(Mn-=10080*60*1e3);for(let As=0;As<200&&an.includes(Mn);As++)Nn++,Mn-=10080*60*1e3;rn(Nn)}}catch(N){console.error("Error loading workout stats:",N)}finally{We(!0)}})()},[s,t,E]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const N=nn(ot(ye,"savedWorkouts"),vt("clientId","==",t.id)),K=(await Gt(N)).docs.map(Q=>({id:Q.id,...Q.data()}));K.sort((Q,fe)=>{const me=Q.savedAt?.toMillis?.()||Q.savedAt?.seconds*1e3||0;return(fe.savedAt?.toMillis?.()||fe.savedAt?.seconds*1e3||0)-me}),fi(K)}catch(N){console.error("Error loading saved workouts:",N)}finally{Qr(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const N=nn(ot(ye,"workoutLogs"),vt("clientId","==",t.id),Eu("completedAt","desc"),Tu(20)),Q=(await Gt(N)).docs.map(rt=>rt.data()).filter(rt=>rt.type!=="programme"&&rt.type!=="muscle_group");Zs(Q.slice(0,3));const fe=Q.length,me={};Q.forEach(rt=>{rt.focus&&(me[rt.focus]=(me[rt.focus]||0)+1)});const De=Object.keys(me).sort((rt,$t)=>me[$t]-me[rt])[0]||null;let Ae=0;if(Q.length>0){const rt=new Set;Q.forEach(Je=>{const an=Je.completedAt?.toDate?Je.completedAt.toDate():Je.completedAt?new Date(Je.completedAt):null;an&&rt.add(new Date(an.getFullYear(),an.getMonth(),an.getDate()).toDateString())});const $t=new Date;$t.setHours(0,0,0,0);let tn=new Date($t);for(rt.has(tn.toDateString())||tn.setDate(tn.getDate()-1);rt.has(tn.toDateString());)Ae++,tn.setDate(tn.getDate()-1)}er({total:fe,favouriteFocus:De,streak:Ae});const Ge={core:null,upper:null,lower:null,fullbody:null};Q.forEach(rt=>{if(rt.focus&&Ge[rt.focus]===null&&rt.completedAt){const $t=rt.completedAt.toDate?rt.completedAt.toDate():new Date(rt.completedAt);Ge[rt.focus]=$t}});let at=null,Mt=new Date;const _s=["core","upper","lower","fullbody"];for(const rt of _s){if(Ge[rt]===null){const $t=$r.find(tn=>tn.key===rt)?.label||rt;at={focus:rt,label:$t,daysAgo:null,message:`You haven't tried ${$t} yet`};break}if(Ge[rt]<Mt){Mt=Ge[rt];const $t=Math.floor((Date.now()-Ge[rt].getTime())/864e5);if($t>=5){const tn=$r.find(Je=>Je.key===rt)?.label||rt;at={focus:rt,label:tn,daysAgo:$t,message:`${tn}  ${$t} days ago`}}}}Fs(at)}catch(N){console.error("Error loading recent workouts:",N)}})()},[s,t,E]);const $e=async x=>{if(!(!s||!t||D.length===0)){ns(!0);try{const N=$r.find(Q=>Q.key===W)?.label||W,U=x||`${N} ${X}min`,K=await br(ot(ye,"savedWorkouts"),{clientId:t.id,name:U,equipment:P,focus:W,level:H,duration:X,exercises:D.map(Q=>({name:Q.name,videoUrl:Q.videoUrl,isGif:Q.isGif||!1})),rounds:R,savedAt:St.now()});fi(Q=>[{id:K.id,clientId:t.id,name:U,equipment:P,focus:W,level:H,duration:X,exercises:D.map(fe=>({name:fe.name,videoUrl:fe.videoUrl,isGif:fe.isGif||!1})),rounds:R,savedAt:St.now()},...Q]),dt("Workout saved!","success")}catch(N){console.error("Error saving workout:",N),dt("Failed to save workout","error")}finally{ns(!1),Wn(!1),Ds("")}}},Re=async x=>{try{await Ar(Fe(ye,"savedWorkouts",x)),fi(N=>N.filter(U=>U.id!==x)),dt("Workout removed","info")}catch(N){console.error("Error deleting saved workout:",N),dt("Failed to remove workout","error")}},It=x=>{F(x.equipment||["bodyweight"]),z(x.focus||"core"),G(x.level||"intermediate"),de(x.duration||15);const N=_i.find(U=>U.key===(x.level||"intermediate"));ee(N),L(x.exercises||[]),Ie(x.rounds||2),j("preview")},ht=async()=>{const x=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");F(x?.equipment||["bodyweight"]),z(x?.focus||"core"),G(x?.level||"intermediate"),de(x?.duration||15),setTimeout(()=>dr(),50)},Ln=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:P,focus:W,level:H,duration:X}))};localStorage.getItem("mcf_last_randomiser");const In=()=>{const x=[];let N;W==="mix"?N=["core","upper","lower"]:W==="fullbody"?N=["upper","lower"]:N=[W];for(const U of P)for(const K of N)x.push(`exercises/${U}/${K}`);return x},qs=async()=>{if(M.current){for(;M.current;)await new Promise(x=>setTimeout(x,200));return V.current}M.current=!0,S(!0);try{const x=In(),N=[];for(const fe of x)try{const me=Ya(Qa,fe),De=await Hw(me);N.push(...De.items)}catch{console.warn(`Folder ${fe} not found, skipping.`)}if(N.length===0&&P.includes("bodyweight")&&W==="core")try{const fe=Ya(Qa,"core"),me=await Hw(fe);N.push(...me.items)}catch{console.warn("Legacy core/ folder not found either.")}if(N.length===0){const fe=P.map(De=>rg.find(Ae=>Ae.key===De)?.label).join(" + "),me=$r.find(De=>De.key===W)?.label;return dt(`No exercises found for ${fe} / ${me}. Upload videos to Firebase Storage.`,"error"),M.current=!1,S(!1),[]}const U=new Set,K=N.filter(fe=>{const me=fe.name.replace(/\.(mp4|gif)$/i,"");return U.has(me)?!1:(U.add(me),!0)}),Q=await Promise.all(K.map(async fe=>{const me=await Po(fe),De=h5(fe.name.replace(/\.(mp4|gif)$/i,"")),Ae=/\.gif$/i.test(fe.name);return{name:De,videoUrl:me,isGif:Ae}}));return V.current=Q,pe(Q),M.current=!1,S(!1),Q}catch(x){console.error("Error loading exercises:",x);const N=x.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${x.message||x.code||"Unknown error"}`;return dt(N,"error"),M.current=!1,S(!1),[]}},dr=async()=>{if(Bn)return;Ln(),j("spinning"),V.current=[];const x=await qs();if(x.length===0){j("setup");return}const N=_i.find(Ge=>Ge.key===H);ee(N);const U=N.work+N.rest,K=X*60,Q=Math.floor(K/U);let fe,me;Q<=6?(fe=Math.max(3,Math.floor(Q/2)),me=Math.floor(Q/fe)):Q<=12?(fe=Math.min(6,Math.floor(Q/2)),me=Math.floor(Q/fe)):(fe=Math.min(10,Math.floor(Q/2)),me=Math.floor(Q/fe)),me=Math.max(2,me);const De=f5(x),Ae=De.slice(0,Math.min(fe,De.length));L(Ae),Ie(me),setTimeout(()=>j("preview"),2e3)},ws=()=>{j("countdown"),Ve(3)};w.useEffect(()=>{if(E!=="countdown")return;if(Be<=0){j("workout"),Pe(1),se(0),te("work"),Se(Ye.work),Ce(!1),Jr();return}xs();const x=setTimeout(()=>Ve(N=>N-1),1e3);return()=>clearTimeout(x)},[Be,E]),w.useEffect(()=>{if(E!=="workout"||xe)return;if(be<=0){tr();return}be<=3&&xs();const x=setTimeout(()=>Se(N=>N-1),1e3);return()=>clearTimeout(x)},[be,E,xe]);const tr=()=>{if(O==="work")te("rest"),Se(Ye.rest);else{const x=Ne+1;if(x>=D.length){const N=Ee+1;if(N>R){Qt(!0),ga();return}Pe(N),se(0)}else se(x);te("work"),Se(Ye.work),Jr()}},ga=async()=>{if(s)try{await br(ot(ye,"workoutLogs"),{clientId:t.id,level:H,duration:X,equipment:P,focus:W,exerciseCount:D.length,rounds:R,exercises:D.map(Q=>Q.name),completedAt:St.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:X,level:H,focus_area:W,exercise_count:D.length}),Ot(Q=>Q+1);const x=Me+1;qe(x),st(Q=>Q+X),en(Q=>({...Q,[H]:(Q[H]||0)+1}));const N=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const Q of N)if(x>=Q.count){const fe=await ef(Q.id,t);if(fe){Nt(fe);break}}const U=Kt+(it===0?1:0),K=[{weeks:2,id:"streak_2"},{weeks:4,id:"streak_4"},{weeks:8,id:"streak_8"}];for(const Q of K)if(U>=Q.weeks){const fe=await ef(Q.id,t);fe&&!Zt&&Nt(fe)}}catch(x){console.error("Error saving workout log:",x)}},xr=async(x,N,U)=>{if(!(!t||!N))try{const K=t.id,Q=await vs(Fe(ye,"coreBuddyPBs",K)),me=(Q.exists()?Q.data():null)?.exercises||{},De=me[x];let Ae=!1;if(De?(N>(De.weight||0)||N===(De.weight||0)&&U>(De.reps||0))&&(Ae=!0):Ae=!0,Ae){const Ge={...me,[x]:{weight:N,reps:U,achievedAt:St.now()}};await Ts(Fe(ye,"coreBuddyPBs",K),{clientId:t.id,exercises:Ge,updatedAt:St.now()}),dt(`New PB! ${N}kg  ${U} reps`,"success"),xs()}}catch(K){console.error("Error checking PB:",K)}},Ns=async x=>{if(Rt(x),x.interval){const K=[];for(const Q of x.exercises){let fe=null,me=!1;if(Q.storagePath)try{const De=Ya(Qa,Q.storagePath);fe=await Po(De),me=/\.gif$/i.test(Q.storagePath)}catch{}K.push({name:Q.name,videoUrl:fe,isGif:me})}L(K),Ie(x.rounds),ee({work:x.work,rest:x.rest}),j("preview");return}const N={};for(const K of x.exercises)if(K.storagePath)try{const Q=Ya(Qa,K.storagePath);N[K.name]={url:await Po(Q),isGif:/\.gif$/i.test(K.storagePath)}}catch{}bt(N);const U=x.exercises.map(K=>({name:K.name,type:K.type,targetSets:K.sets,targetReps:K.reps||0,targetTime:K.time||0,sets:[]}));Ss(U),kt(0),cn(0),ls(""),xn(""),lt(!1),un(!1),Z(0),setMgSessionBadges([]),setMgBadgeCelebration(null),j("muscle_workout")},ya=()=>{const x=Xe.current;x&&(x.paused?(x.play(),lt(!0)):(x.pause(),lt(!1)))};w.useEffect(()=>{if(E!=="muscle_workout"||!Ct||Ze<=0){E==="muscle_workout"&&Ct&&Ze<=0&&(un(!1),xs());return}return et.current=setTimeout(()=>Z(x=>x-1),1e3),()=>clearTimeout(et.current)},[E,Ct,Ze]);const Li=async()=>{const x=wn[ze];let N={};if(x.type==="weighted"){const Q=parseFloat(Vn)||0,fe=parseInt(Un)||0;if(fe===0){dt("Enter your reps","error");return}N={weight:Q,reps:fe}}else if(x.type==="reps"){const Q=parseInt(Un)||0;if(Q===0){dt("Enter your reps","error");return}N={reps:Q}}else if(x.type==="timed"){const Q=x.targetTime-Ze;N={time:Math.max(Q,1)}}const U=[...wn];U[ze]={...x,sets:[...x.sets,N]},Ss(U),x.type==="weighted"&&N.weight>0&&await xr(x.name,N.weight,N.reps);const K=x.sets.length+1;if(K<x.targetSets)cn(K),xn(""),un(!1),Z(0);else if(ze+1<wn.length){const Q=ze+1;kt(Q),cn(0),ls(""),xn(""),lt(!1),un(!1),Z(0)}else await Xr(U),bn(!0)},Xr=async x=>{if(!(!s||!t))try{const N=x.reduce((U,K)=>U+K.sets.length,0);await br(ot(ye,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:oe,sessionId:pt?.id,sessionName:pt?.name,exerciseCount:x.length,totalSets:N,duration:Math.round(N*1.5),exercises:x.map(U=>({name:U.name,type:U.type,sets:U.sets})),completedAt:St.now()})}catch(N){console.error("Error saving muscle group workout log:",N)}},Dr=w.useRef(null),pi=()=>(Dr.current||(Dr.current=new(window.AudioContext||window.webkitAudioContext)),Dr.current),xs=()=>{try{const x=pi(),N=x.createOscillator(),U=x.createGain();N.connect(U),U.connect(x.destination),N.frequency.value=880,U.gain.value=.3,N.start(x.currentTime),N.stop(x.currentTime+.15)}catch{}},Jr=()=>{try{const x=pi(),N=x.createOscillator(),U=x.createGain();N.connect(U),U.connect(x.destination),N.frequency.value=1200,U.gain.value=.4,N.start(x.currentTime),N.stop(x.currentTime+.3)}catch{}};w.useEffect(()=>{if(E!=="workout"||O!=="work"||!D[Ne]?.isGif)return;const N=setInterval(()=>{const U=gt.current;if(!U)return;const K=U.getAttribute("src");U.removeAttribute("src"),setTimeout(()=>{gt.current&&gt.current.setAttribute("src",K)},0)},4e3);return()=>clearInterval(N)},[E,O,Ne,Ee,D]);const nr=(x,N,U)=>{const K=Math.round(x/N*c5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:l3.map((Q,fe)=>a.jsx("line",{x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,className:fe<K?`wk-tick-filled ${U}`:"wk-tick-empty",strokeWidth:Q.thick?"3":"2"},fe))})},Oi=()=>{const x=D.length*R;return((Ee-1)*D.length+Ne+(O==="rest"?.5:0))/x},Qn=Lt&&a.jsx("div",{className:`toast-notification ${Lt.type}`,children:Lt.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(E==="menu")return a.jsx(Zo,{children:a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>j("randomiser_hub"),children:a.jsx("img",{src:Qw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>b("/upgrade"),children:[a.jsx("img",{src:Xw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[sg.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:sg.map((x,N)=>x.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:x.id}}),style:{animationDelay:`${N*.06}s`},children:[a.jsx("img",{src:x.image,alt:x.name,className:"wk-prog-img"}),N===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},x.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:x.id}}),style:{animationDelay:`${N*.06}s`},children:[a.jsx("img",{src:Xw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:d5[x.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[x.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:x.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:x.name.toUpperCase()}),a.jsxs("p",{children:[x.daysPerWeek,"x per week  ",x.focus==="fullbody"?"Full Body":x.focus.charAt(0).toUpperCase()+x.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),N===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},x.id))})})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Zc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Zc.map((x,N)=>a.jsx("button",{className:`wk-muscle-hero-card${x.image?" wk-muscle-thumb":""}`,onClick:()=>{Xt(x.key),j("muscle_sessions")},style:{animationDelay:`${N*.05}s`},children:x.image?a.jsx("img",{src:x.image,alt:x.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Qw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ng[x.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:x.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:x.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Jw[x.key]?.length||0," sessions"]})]})]})]})},x.key))})]})]}),a.jsx(Yr,{active:"workouts"}),Qn,a.jsx(ql,{badge:Zt,onDismiss:()=>Nt(null)})]})});if(E==="randomiser_hub"){const x=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},N=$r.find(K=>K.key===x.focus)?.label||x.focus,U=_i.find(K=>K.key===x.level)?.label||x.level;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[ds.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:ds.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),ds.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[ds.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),ds.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:ph[ds.favouriteFocus]||"var(--color-primary)"},children:$r.find(K=>K.key===ds.favouriteFocus)?.label||ds.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>j("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:ht,disabled:Bn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[N,"  ",U,"  ",x.duration,"min"]})]})]}),cs&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{z(cs.focus),j("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:cs.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Zw[Math.floor(Date.now()/864e5)%Zw.length]]})]}),p&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",ur.length>0&&a.jsx("span",{className:"wk-hub-count",children:ur.length})]}),mi?ur.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:$r.map(K=>{const Q=ur.filter(me=>me.focus===K.key);if(Q.length===0)return null;const fe=Cs[K.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${fe?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":ph[K.key]||"var(--color-primary)"},onClick:()=>Js(me=>({...me,[K.key]:!me[K.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":ph[K.key]||"var(--color-primary)"},children:K.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:Q.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${fe?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),fe&&a.jsx("div",{className:"wk-hub-saved-list",children:Q.map((me,De)=>{const Ae=(me.equipment||[]).map(at=>rg.find(Mt=>Mt.key===at)?.label||at).join(", "),Ge=_i.find(at=>at.key===me.level)?.label||me.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${De*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>It(me),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:me.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[Ge,"  ",me.duration,"min  ",(me.exercises||[]).length," ex"]})}),Ae&&a.jsx("span",{className:"wk-hub-saved-equip",children:Ae})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>Re(me.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},me.id)})})]},K.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),us.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:us.map((K,Q)=>{const fe=$r.find(Ge=>Ge.key===K.focus)?.label||K.focus||"",me=_i.find(Ge=>Ge.key===K.level)?.label||K.level||"",De=K.completedAt?.toDate?K.completedAt.toDate():K.completedAt?new Date(K.completedAt):null,Ae=De?(()=>{const Ge=Math.floor((Date.now()-De.getTime())/1e3);return Ge<3600?`${Math.floor(Ge/60)}m ago`:Ge<86400?`${Math.floor(Ge/3600)}h ago`:`${Math.floor(Ge/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${Q*.05}s`},onClick:()=>{z(K.focus||"core"),G(K.level||"intermediate"),de(K.duration||15),K.equipment&&F(K.equipment),j("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":ph[K.focus]||"var(--color-primary)"},children:fe}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[me,"  ",K.duration||"?","min  ",K.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Ae}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},Q)})})]})]}),a.jsx(Yr,{active:"workouts"}),Qn,a.jsx(ql,{badge:Zt,onDismiss:()=>Nt(null)})]})}if(E==="setup"){const x=$r.find(U=>U.key===W)?.label||W,N=_i.find(U=>U.key===H)?.label||H;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Me}`,pct:Me>0?Math.min(Math.round(Me/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${it}/${tg}`,pct:Math.round(Math.min(it,tg)/tg*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Kt}`,pct:Kt>0?Math.min(Math.round(Kt/12*100),100):0,color:"#38B6FF",size:"normal"}].map(U=>{const Q=2*Math.PI*38,fe=Q-U.pct/100*Q;return a.jsxs("div",{className:`wk-stat-item${U.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:U.color},strokeDasharray:Q,strokeDashoffset:fe})]}),a.jsx("span",{className:"wk-stat-value",style:{color:U.color},children:U.value})]}),a.jsx("span",{className:"wk-stat-label",children:U.label})]},U.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:$r.map(U=>a.jsxs("button",{className:`wk-equip-btn${W===U.key?" active":""}${U.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{xs(),z(U.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:U.icon})}),a.jsx("span",{children:U.label})]},U.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:_i.map(U=>a.jsxs("button",{className:`wk-level-card wk-level-${U.key}${H===U.key?" active":""}`,onClick:()=>{xs(),G(U.key)},children:[a.jsx("span",{className:"wk-level-name",children:U.label}),a.jsx("span",{className:"wk-level-desc",children:U.desc})]},U.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:ig.map(U=>{const K=!En.includes(U);return a.jsxs("button",{className:`wk-time-btn${X===U?" active":""}${K?" locked":""}`,onClick:()=>{K||(xs(),de(U))},disabled:K,children:[a.jsx("span",{className:"wk-time-num",children:U}),a.jsx("span",{className:"wk-time-unit",children:K?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},U)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:rg.map(U=>{const K=P.includes(U.key);return a.jsxs("button",{className:`wk-equip-btn${K?" active":""}`,onClick:()=>{K&&P.length===1||(xs(),F(Q=>K&&Q.length===1?Q:K?Q.filter(fe=>fe!==U.key):[...Q,U.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:U.icon})}),a.jsx("span",{children:U.label})]},U.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[x,"  ",N,"  ",X," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[Bn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:dr,disabled:C||Bn,children:C?"Loading exercises...":Bn?"Limit Reached":"Randomise Workout"})]}),Qn]})}if(E==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:o3.map((x,N)=>a.jsx("line",{x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2,className:"wk-spin-tick",strokeWidth:x.thick?"3.5":"2",style:{animationDelay:`${N*.03}s`}},N))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Qn]});if(E==="preview"){const x=pt?.interval?{work:pt.work,rest:pt.rest}:_i.find(U=>U.key===H),N=D.length*R*(x.work+x.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j(pt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[pt?.interval&&a.jsx("h2",{className:"mg-preview-title",children:pt.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:R}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(N/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[x.work,"/",x.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:D.map((U,K)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${K*.06}s`},onClick:()=>Ut(U),children:[a.jsx("span",{className:"wk-preview-num",children:K+1}),a.jsx("div",{className:"wk-preview-thumb",children:U.isGif?a.jsx("img",{src:U.videoUrl,alt:U.name,loading:"lazy"}):a.jsx("video",{src:`${U.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:U.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},K))}),gn&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Ut(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:U=>U.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Ut(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:gn.isGif?a.jsx("img",{src:gn.videoUrl,alt:gn.name}):a.jsx("video",{src:gn.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:gn.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!pt?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>dr(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),p&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Wn(!0),disabled:Yn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:ws,children:"Start Workout"})]}),$n&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Wn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:U=>U.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:dn,onChange:U=>Ds(U.target.value),placeholder:`${$r.find(U=>U.key===W)?.label||W} ${X}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Wn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>$e(dn),disabled:Yn,children:Yn?"Saving...":"Save"})]})]})})]})]})}if(E==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Be}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(E==="workout"){const x=D[Ne],N=O==="work"?Ye.work:Ye.rest,U=O==="rest"?Ne+1<D.length?D[Ne+1]:Ee<R?D[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"wk-video-container",children:O==="work"?x.isGif?a.jsx("img",{ref:gt,className:"wk-video",src:x.videoUrl,alt:x.name},x.videoUrl):a.jsx("video",{className:"wk-video",src:x.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},x.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),U&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",U.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ne+1," / ",D.length]}),a.jsx("h2",{className:"wk-exercise-name",children:x.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Ee," of ",R]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[nr(be,N,O==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:be}),a.jsx("span",{className:`wk-timer-phase ${O}`,children:O==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ce(!xe),children:xe?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Se(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Oi()*100}%`}})}),Le&&(()=>{const K=_i.find(fe=>fe.key===H),Q=D.length*R*(K.work+K.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Gg,{title:"Workout Complete!",stats:[{value:Math.ceil(Q/60),label:"Minutes"},{value:D.length*R,label:"Intervals"},{value:R,label:"Rounds"}],hideShare:!p,onShareJourney:t?At:null,userName:t?.name,onDismissStart:()=>j("randomiser_hub"),onDone:()=>{Qt(!1),Rt(null),Xt(null)}}),!pt?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Wn(!0),disabled:Yn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),$n&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Wn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:fe=>fe.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:dn,onChange:fe=>Ds(fe.target.value),placeholder:`${$r.find(fe=>fe.key===W)?.label||W} ${X}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Wn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>$e(dn),disabled:Yn,children:Yn?"Saving...":"Save"})]})]})})]})})()]})}if(E==="muscle_sessions"){const x=Zc.find(U=>U.key===oe),N=Jw[oe]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ng[oe]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:x?.icon})})}),a.jsxs("h2",{children:[x?.label," Workouts"]}),a.jsxs("p",{children:[N.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:N.map((U,K)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{Rt(U),j("muscle_overview")},style:{animationDelay:`${K*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:U.name}),a.jsx("p",{children:U.desc}),a.jsx("div",{className:"mg-session-meta",children:U.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[U.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[U.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[U.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const Q=U.exercises.map(De=>De.sets||0),fe=Math.min(...Q),me=Math.max(...Q);return fe===me?`${fe} sets each`:`${fe}-${me} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},U.id))})]}),Qn]})}if(E==="muscle_overview"){const x=pt;if(!x)return null;const N=Zc.find(U=>U.key===oe);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:x.image?void 0:{background:ng[oe]},children:x.image?a.jsx("img",{src:x.image,alt:x.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:N?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:x.name}),x.level&&a.jsx("span",{className:"mg-overview-level",children:x.level})]}),a.jsx("p",{className:"mg-overview-desc",children:x.desc})]}),x.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:x.overview})]}),x.tips&&x.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:x.tips.map((U,K)=>a.jsx("li",{children:U},K))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",x.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:x.exercises.map((U,K)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:K+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:U.name}),x.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[x.work,"s work / ",x.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[U.sets," sets  ",U.reps?`${U.reps} reps`:`${U.time}s`,U.type==="weighted"&&"  weighted"]})]})]},K))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Ns(x),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Qn]})}if(E==="muscle_workout"){const x=pt;if(!x)return null;const N=x.exercises[ze],U=wn[ze];if(!N||!U)return null;const K=U.sets.length,Q=x.exercises.length,fe=x.exercises.reduce((at,Mt)=>at+(Mt.sets||0),0),De=wn.reduce((at,Mt)=>at+Mt.sets.length,0)/fe*100,Ae=yt[N.name];N.type==="timed"&&Ze===0&&!Ct&&K===Jt&&setTimeout(()=>Z(N.time),0);const Ge=K+1<N.sets?"Log Set":ze+1<Q?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${De}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",ze+1,"/",Q]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Ae?a.jsxs("div",{className:"mg-video-container",onClick:ya,children:[Ae.isGif?a.jsx("img",{className:"mg-video",src:Ae.url,alt:N.name}):a.jsx("video",{ref:Xe,className:"mg-video",src:Ae.url,loop:!0,muted:!0,playsInline:!0},N.name),!je&&!Ae.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:N.name}),a.jsx("span",{className:`mg-ex-type-badge ${N.type}`,children:N.type==="weighted"?"Weight + Reps":N.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",K+1," of ",N.sets]}),N.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",N.reps," reps"]}),N.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",N.time,"s"]})]}),N.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Vn,onChange:at=>ls(at.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Un,onChange:at=>xn(at.target.value),placeholder:"0"})]})]}),N.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Un,onChange:at=>xn(at.target.value),placeholder:"0"})]})}),N.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Ze,"s"]})}),Ct?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>un(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Ze===0&&Z(N.time),un(!0)},children:Ze<N.time&&Ze>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:Li,children:Ge}),U.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:U.sets.map((at,Mt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Mt+1,": ",at.weight!=null?`${at.weight}kg  ${at.reps}`:at.reps!=null?`${at.reps} reps`:`${at.time}s`]})]},Mt))})]})]}),Qn,Dt&&(()=>{const at=wn.reduce((rt,$t)=>rt+$t.sets.length,0),Mt=Zc.find(rt=>rt.key===oe)?.label||"",_s=[{value:wn.length,label:"Exercises"},{value:at,label:"Sets"}];return a.jsx(Gg,{title:`${Mt} Complete!`,subtitle:pt?.name,stats:_s,hideShare:!p,onShareJourney:t?At:null,userName:t?.name,onDismissStart:()=>j("randomiser_hub"),onDone:()=>{bn(!1),Rt(null),Xt(null)}})})()]})}return a.jsx(ql,{badge:Zt,onDismiss:()=>Nt(null)})}const p5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],g5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",y5="#e91e63",v5="#FF4D88",b5=700,Kg=42,Il=2*Math.PI*Kg,gh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function w5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Fa(s){return s.toISOString().split("T")[0]}function x5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=Mi(),{isPremium:p,FREE_HABIT_LIMIT:g}=oc(),y=Xs(),[b,E]=w.useState({}),[j,P]=w.useState([]),[F,W]=w.useState(!0),[z,H]=w.useState(!1),[G,X]=w.useState(0),[de,_e]=w.useState(null),[pe,C]=w.useState(null),[S,M]=w.useState(!1),[V,D]=w.useState(null),[L,R]=w.useState(!1),[Ie,Ye]=w.useState(!1),[ee,Ee]=w.useState(!1),[Pe,Ne]=w.useState(""),[se,O]=w.useState(null),[te,be]=w.useState([]),[Se,xe]=w.useState(null),Ce=w.useRef(null),Be=w.useRef(null),Ve=w.useRef(null),Le=w.useRef(null),Qt=w.useRef(!1),Dt=w.useRef({}),bn=w.useRef([]),gn=w.useRef([]),Ut=w.useRef(null),gt=w.useRef(gh[Math.floor(Math.random()*gh.length)]),Lt=w.useCallback((le,Me="info")=>{_e({message:le,type:Me}),setTimeout(()=>_e(null),3e3)},[]),sn=new Date,dt=Fa(sn),At=w5(sn),oe=x5(At),Xt=["M","T","W","T","F","S","S"],pt=(le,Me)=>l&&Me?Me:le,Rt=[...p5.filter(le=>!te.includes(le.key)).map(le=>({...le,color:pt(le.color,le.darkColor)})),...j.map(le=>({key:`custom_${le.id}`,label:le.label,icon:g5,color:pt(y5,v5),isCustom:!0,id:le.id}))],ze=p?Rt:Rt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Me=ot(ye,"habitLogs"),qe=nn(Me,vt("clientId","==",t.id)),ct=await Gt(qe),st={};ct.docs.forEach(Nt=>{const Rn=Nt.data();st[Rn.date]={...Rn,_id:Nt.id}}),E(st);const Kt=await vs(Fe(ye,"customHabits",t.id));if(Kt.exists()){const Nt=Kt.data();P(Nt.habits||[]),be(Nt.hiddenDefaults||[])}let rn=0;const Zt=new Date(sn);for(;;){const Nt=Fa(Zt),Rn=st[Nt];if(Rn)if(Object.values(Rn.habits||{}).filter(Boolean).length>=3)rn++,Zt.setDate(Zt.getDate()-1);else break;else if(Nt===dt)Zt.setDate(Zt.getDate()-1);else break}X(rn)}catch(Me){console.error("Error loading habit logs:",Me)}finally{W(!1)}})()},[s,t]);const kt=b[dt]||{habits:{}};w.useEffect(()=>{Object.values(kt.habits||{}).filter(Boolean).length<ze.length&&Ie&&Ye(!1)},[ze.length,kt.habits]);const Jt=async le=>{if(!(!s||z||kt.habits?.[le])){bn.current=[...Array(10)].map((qe,ct)=>{const st=ct/10*2*Math.PI,Kt=18+Math.random()*20;return{tx:Math.cos(st)*Kt,ty:Math.sin(st)*Kt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),C(le),setTimeout(()=>C(null),700),navigator.vibrate&&navigator.vibrate(50),H(!0);try{const ct={...kt.habits||{},[le]:!0},st=kt._id||`${t.id}_${dt}`;if(E(rn=>({...rn,[dt]:{clientId:t.id,date:dt,habits:ct,_id:st}})),await Ts(Fe(ye,"habitLogs",st),{clientId:t.id,date:dt,habits:ct}),Object.values(ct).filter(Boolean).length===ze.length&&!Ie){gt.current=gh[Math.floor(Math.random()*gh.length)],gn.current=[...Array(80)].map((Zt,Nt)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Nt%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Nt%3})),setTimeout(()=>{M(!0),Ye(!0),setTimeout(()=>Ut.current?.focus(),1100)},400);let rn=1;for(let Zt=1;Zt<7;Zt++){const Nt=new Date;Nt.setDate(Nt.getDate()-Zt);const Rn=Fa(Nt),en=b[Rn];if(en)if(Object.values(en.habits||{}).filter(Boolean).length>=ze.length)rn++;else break;else break}rn>=7&&ef("habits_7",t).then(Zt=>{Zt&&D(Zt)})}}catch(qe){console.error("Error saving habit:",qe),Lt("Failed to save. Try again.","error"),E(ct=>({...ct,[dt]:{...ct[dt],habits:{...ct[dt]?.habits||{},[le]:!1}}}))}finally{H(!1)}}},cn=async le=>{if(!(!s||z)){H(!0);try{const qe={...kt.habits||{},[le]:!1},ct=kt._id||`${t.id}_${dt}`;await Ts(Fe(ye,"habitLogs",ct),{clientId:t.id,date:dt,habits:qe}),E(st=>({...st,[dt]:{clientId:t.id,date:dt,habits:qe,_id:ct}}))}catch(Me){console.error("Error undoing habit:",Me),Lt("Failed to undo. Try again.","error")}finally{H(!1)}}},wn=le=>{if(kt.habits?.[le]||!1||z||Le.current)return;Le.current=le,xe(le),Be.current=performance.now();const qe=Dt.current[le];qe&&(qe.style.strokeDashoffset=Il);const ct=st=>{const Kt=st-Be.current,rn=Math.min(Kt/b5,1),Zt=Dt.current[le];Zt&&(Zt.style.strokeDashoffset=Il-rn*Il),rn<1?Ve.current=requestAnimationFrame(ct):(Le.current=null,Qt.current=!0,Ve.current=null,xe(null),Jt(le))};Ve.current=requestAnimationFrame(ct)},Ss=()=>{if(!Le.current)return;const le=Le.current;Le.current=null,Ve.current&&(cancelAnimationFrame(Ve.current),Ve.current=null),Ce.current&&(clearTimeout(Ce.current),Ce.current=null),Dt.current[le]&&(Dt.current[le].style.strokeDashoffset=Il),xe(null),Be.current=null};w.useEffect(()=>()=>{Ve.current&&cancelAnimationFrame(Ve.current),Ce.current&&clearTimeout(Ce.current)},[]);const Vn=w.useCallback(async le=>{if(!t)throw new Error("Not signed in");const Me=le&&typeof le=="object"&&le.type;await br(ot(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me?"":le,type:Me?le.type:"text",imageURL:null,createdAt:Ms(),likeCount:0,commentCount:0,...Me?{metadata:{title:le.title||"",subtitle:le.subtitle||"",stats:le.stats||[],quote:le.quote||"",badges:le.badges||[]}}:{}})},[t]),ls=async()=>{const le=Pe.trim();if(!le)return;if(!t?.id){Lt("Still loading, try again","error");return}const Me=Date.now().toString(36),qe=[...j,{id:Me,label:le}];try{await Ts(Fe(ye,"customHabits",t.id),{clientId:t.id,habits:qe,hiddenDefaults:te},{merge:!0}),P(qe),Ne(""),Ee(!1),Lt(`Added "${le}"`,"success")}catch(ct){console.error("Error adding custom habit:",ct),Lt(ct?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ct?.message||"Unknown error"}`,"error")}},Un=async le=>{if(!t?.id)return;const Me=j.filter(qe=>qe.id!==le);try{await Ts(Fe(ye,"customHabits",t.id),{clientId:t.id,habits:Me,hiddenDefaults:te},{merge:!0}),P(Me),O(null),Lt("Habit removed","success")}catch(qe){console.error("Error deleting habit:",qe),Lt("Failed to remove","error")}},xn=async le=>{if(!t?.id)return;const Me=[...te,le];try{await Ts(Fe(ye,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Me},{merge:!0}),be(Me),O(null),Lt("Habit removed","success")}catch(qe){console.error("Error hiding default habit:",qe),Lt("Failed to remove","error")}},Ct=oe.map(le=>{const Me=Fa(le),qe=b[Me],ct=qe?Object.values(qe.habits||{}).filter(Boolean).length:0;return{date:le,dateStr:Me,completed:ct,total:ze.length}}),un=Ct.reduce((le,Me)=>le+Me.completed,0),Ze=Ct.reduce((le,Me)=>le+Me.total,0),Z=Ze>0?Math.round(un/Ze*100):0,je=Object.values(kt.habits||{}).filter(Boolean).length,lt=ze.length>0?Math.round(je/ze.length*100):0,yt=je===ze.length&&ze.length>0,bt=(()=>{const le=Object.keys(b).sort();let Me=0,qe=0,ct=null;for(const st of le){const Kt=b[st];if(Object.values(Kt.habits||{}).filter(Boolean).length>=3){if(ct){const Zt=new Date(ct);qe=(new Date(st)-Zt)/(1e3*60*60*24)===1?qe+1:1}else qe=1;qe>Me&&(Me=qe),ct=st}else qe=0,ct=null}return Math.max(Me,G)})(),Xe=new Date(sn.getFullYear(),sn.getMonth(),1),et=Xe.toLocaleString("default",{month:"long"}),it=new Date(sn.getFullYear(),sn.getMonth()+1,0).getDate(),Ot=(Xe.getDay()+6)%7,_n=Array.from({length:it},(le,Me)=>{const qe=new Date(sn.getFullYear(),sn.getMonth(),Me+1),ct=Fa(qe),st=b[ct],Kt=st?Object.values(st.habits||{}).filter(Boolean).length:0,rn=qe>sn;return{day:Me+1,dateStr:ct,completed:Kt,total:ze.length,isFuture:rn,isToday:ct===dt}}),kn=ze.map(le=>({...le,days:oe.map(Me=>{const qe=Fa(Me);return b[qe]?.habits?.[le.key]||!1})})),Kn=Ct.filter(le=>le.completed===le.total&&le.total>0).length;return a.jsx(Zo,{children:a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||F?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${yt?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-lt/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[je,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),ze.length]}),a.jsx("span",{className:"cbc-ring-label",children:yt?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:yt?"You showed up for yourself today.":je===0?"Start your day strong.":`${ze.length-je} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:G}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:bt}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[ze.map(le=>{const Me=kt.habits?.[le.key]||!1,qe=pe===le.key,ct=Se===le.key;return a.jsxs("div",{className:`cbc-habit-tile ${Me?"cbc-habit-done":""} ${qe?"cbc-habit-just-checked":""}`,style:{"--habit-color":le.color},children:[p&&a.jsx("button",{className:"cbc-habit-delete",onClick:st=>{st.stopPropagation(),O(le.isCustom?{type:"custom",id:le.id,label:le.label}:{type:"default",key:le.key,label:le.label})},"aria-label":`Remove ${le.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${ct?"cbc-holding":""} ${Me?"cbc-ring-completed":""}`,onPointerDown:st=>{Me||(st.preventDefault(),wn(le.key))},onPointerUp:Ss,onPointerLeave:Ss,onPointerCancel:Ss,onClick:st=>{if(st.stopPropagation(),Qt.current){Qt.current=!1;return}Me&&cn(le.key)},role:"button",tabIndex:0,"aria-label":Me?`Undo ${le.label}`:`Press and hold to complete ${le.label}`,onKeyDown:st=>{(st.key==="Enter"||st.key===" ")&&(st.preventDefault(),Me?cn(le.key):Jt(le.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Kg}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:st=>{st&&(Dt.current[le.key]=st)},cx:"50",cy:"50",r:Kg,style:{stroke:le.color,strokeDasharray:Il,strokeDashoffset:Me?0:Il}})]}),Me&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":le.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:le.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:le.icon})})}),qe&&a.jsx("div",{className:"cbc-particles",children:bn.current.map((st,Kt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${st.tx}px`,"--ty":`${st.ty}px`,"--size":`${st.size}px`,"--particle-color":le.color,animationDuration:`${st.duration}s`}},Kt))})]}),a.jsx("span",{className:"cbc-habit-label",children:le.label}),Me?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},le.key)}),p?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Ee(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[Kn,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),Xt.map((le,Me)=>a.jsx("span",{className:`cbc-weekly-day-label${oe[Me]&&Fa(oe[Me])===dt?" cbc-today-label":""}`,children:le},Me))]}),kn.map(le=>(le.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:le.color},children:le.label}),le.days.map((Me,qe)=>a.jsx("span",{className:`cbc-weekly-dot${Me?" cbc-dot-done":""}${oe[qe]&&Fa(oe[qe])===dt?" cbc-dot-today":""}`,style:Me?{background:le.color,borderColor:le.color,boxShadow:`0 0 6px ${le.color}40`}:void 0},qe))]},le.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Z}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[un,"/",Ze," completed (",Z,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:et}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((le,Me)=>a.jsx("span",{className:"cbc-cal-day-label",children:le},Me))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Ot},(le,Me)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Me}`)),_n.map(le=>{const Me=le.total>0?le.completed/le.total:0,qe=le.isFuture?-1:Me===0?0:Me<.4?1:Me<.75?2:Me<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${le.isToday?" cbc-cal-today":""}${qe===4?" cbc-cal-perfect":""} cbc-cal-heat-${qe<0?"future":qe}`,children:le.day},le.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(Yr,{active:"home"}),ee&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ee(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:le=>le.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Pe,onChange:le=>Ne(le.target.value),maxLength:30,autoFocus:!0,onKeyDown:le=>le.key==="Enter"&&ls()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Ee(!1),Ne("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:ls,disabled:!Pe.trim(),children:"Add"})]})]})}),se&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>O(null),children:a.jsxs("div",{className:"cbc-modal",onClick:le=>le.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',se.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>O(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>se.type==="custom"?Un(se.id):xn(se.key),children:"Remove"})]})]})}),S&&a.jsx(Gg,{title:"All Habits Complete!",subtitle:gt.current,stats:[{value:`${je}/${ze.length}`,label:"Habits"},{value:G||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Vn:null,userName:t?.name,onDone:()=>{M(!1),R(!1)}}),de&&a.jsx("div",{className:`toast-notification ${de.type}`,children:de.message}),a.jsx(ql,{badge:V,onDismiss:()=>D(null)})]})})}function yh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ex(s,e){return[s,e].sort().join("_")}function k5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Mi(),d=Xs(),[p,g]=w.useState("buddies"),[y,b]=w.useState([]),[E,j]=w.useState([]),[P,F]=w.useState([]),[W,z]=w.useState(""),[H,G]=w.useState([]),[X,de]=w.useState([]),[_e,pe]=w.useState(!0),[C,S]=w.useState(null),[M,V]=w.useState(null),D=w.useCallback((se,O="info")=>{V({message:se,type:O}),setTimeout(()=>V(null),3500)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const L=w.useCallback(async()=>{if(t){pe(!0);try{const se=t.id,te=(await Gt(ot(ye,"clients"))).docs.map(Le=>({id:Le.id,...Le.data()}));de(te);const be=Object.fromEntries(te.map(Le=>[Le.id,Le])),Se=await Gt(nn(ot(ye,"buddies"),vt("user1","==",se))),xe=await Gt(nn(ot(ye,"buddies"),vt("user2","==",se))),Ce=new Set;[...Se.docs,...xe.docs].forEach(Le=>{const Qt=Le.data(),Dt=Qt.user1===se?Qt.user2:Qt.user1;Ce.add(Dt)}),b(Array.from(Ce).map(Le=>be[Le]).filter(Boolean));const Be=await Gt(nn(ot(ye,"buddyRequests"),vt("toId","==",se),vt("status","==","pending")));j(Be.docs.map(Le=>({reqId:Le.id,...Le.data(),fromClient:be[Le.data().fromId]})).filter(Le=>Le.fromClient));const Ve=await Gt(nn(ot(ye,"buddyRequests"),vt("fromId","==",se),vt("status","==","pending")));F(Ve.docs.map(Le=>({reqId:Le.id,...Le.data(),toClient:be[Le.data().toId]})).filter(Le=>Le.toClient))}catch(se){console.error("Error fetching buddy data:",se),D("Failed to load buddies","error")}finally{pe(!1)}}},[t,D]);w.useEffect(()=>{L()},[L]),w.useEffect(()=>{if(!W.trim()||!t){G([]);return}const se=W.toLowerCase(),O=t.id,te=new Set(y.map(Ce=>Ce.id)),be=new Set(P.map(Ce=>Ce.toId)),Se=new Set(E.map(Ce=>Ce.fromId)),xe=X.filter(Ce=>Ce.id===O||!Ce.name||!Ce.coreBuddyAccess&&Ce.clientType!=="core_buddy"?!1:Ce.name.toLowerCase().includes(se)).map(Ce=>({...Ce,isBuddy:te.has(Ce.id),isPendingOut:be.has(Ce.id),isPendingIn:Se.has(Ce.id)})).slice(0,20);G(xe)},[W,X,y,P,E,t]);const R=async(se,O)=>{if(!(!t||se===t.id))try{await br(ot(ye,"notifications"),{toId:se,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:O,read:!1,createdAt:Ms()})}catch(te){console.error("Notification error:",te),te.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},Ie=async se=>{S(se);try{const O=`${t.id}_${se}`;await Ts(Fe(ye,"buddyRequests",O),{fromId:t.id,toId:se,status:"pending",createdAt:Ms()}),await R(se,"buddy_request"),D("Buddy request sent!","success"),await L()}catch(O){console.error("Error sending request:",O),D("Failed to send request","error")}finally{S(null)}},Ye=async se=>{S(se.reqId);try{const O=ex(se.fromId,t.id);await Ts(Fe(ye,"buddies",O),{user1:[se.fromId,t.id].sort()[0],user2:[se.fromId,t.id].sort()[1],connectedAt:Ms()}),await Ar(Fe(ye,"buddyRequests",se.reqId)),await R(se.fromId,"buddy_accept"),D("Buddy added!","success"),await L()}catch(O){console.error("Error accepting request:",O),D("Failed to accept","error")}finally{S(null)}},ee=async se=>{S(se.reqId);try{await Ar(Fe(ye,"buddyRequests",se.reqId)),D("Request declined","info"),await L()}catch(O){console.error("Error declining:",O),D("Failed to decline","error")}finally{S(null)}},Ee=async se=>{S(se.reqId);try{await Ar(Fe(ye,"buddyRequests",se.reqId)),D("Request cancelled","info"),await L()}catch(O){console.error("Error cancelling:",O),D("Failed to cancel","error")}finally{S(null)}},Pe=async se=>{S(se);try{const O=ex(t.id,se);await Ar(Fe(ye,"buddies",O)),D("Buddy removed","info"),await L()}catch(O){console.error("Error removing buddy:",O),D("Failed to remove buddy","error")}finally{S(null)}},Ne=E.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(Zo,{children:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ne>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ne})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),_e?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(se=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${se.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:se.photoURL?a.jsx("img",{src:se.photoURL,alt:se.name}):a.jsx("span",{children:yh(se.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:se.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:O=>{O.stopPropagation(),Pe(se.id)},disabled:C===se.id,"aria-label":"Remove buddy",children:C===se.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},se.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[E.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:E.map(se=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:se.fromClient.photoURL?a.jsx("img",{src:se.fromClient.photoURL,alt:se.fromClient.name}):a.jsx("span",{children:yh(se.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>Ye(se),disabled:C===se.reqId,children:C===se.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>ee(se),disabled:C===se.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},se.reqId))})]}),P.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:P.map(se=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:se.toClient?.photoURL?a.jsx("img",{src:se.toClient.photoURL,alt:se.toClient.name}):a.jsx("span",{children:yh(se.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>Ee(se),disabled:C===se.reqId,children:C===se.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},se.reqId))})]}),E.length===0&&P.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:W,onChange:se=>z(se.target.value),autoFocus:!0}),W&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>z(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),W.trim()&&H.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',W,'"']})}),H.length>0&&a.jsx("div",{className:"bdy-list",children:H.map(se=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${se.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:se.photoURL?a.jsx("img",{src:se.photoURL,alt:se.name}):a.jsx("span",{children:yh(se.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.name}),se.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),se.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):se.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):se.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:O=>{O.stopPropagation();const te=E.find(be=>be.fromId===se.id);te&&Ye(te)},disabled:!!C,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:O=>{O.stopPropagation(),Ie(se.id)},disabled:C===se.id,children:C===se.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},se.id))})]})]})]}),a.jsx(Yr,{active:"buddies"}),M&&a.jsxs("div",{className:`toast-notification ${M.type}`,children:[a.jsx("span",{className:"toast-icon",children:M.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:M.message})]})]})})}function vh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ag(s,e){return[s,e].sort().join("_")}const E5=5;function og(s){return s.toISOString().split("T")[0]}function tx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function T5(){const{userId:s}=xS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=Mi(),p=Xs(),[g,y]=w.useState(null),[b,E]=w.useState("none"),[j,P]=w.useState(null),[F,W]=w.useState(!0),[z,H]=w.useState(!1),[G,X]=w.useState(null),[de,_e]=w.useState([]),[pe,C]=w.useState(!1),[S,M]=w.useState(new Set),[V,D]=w.useState(new Set),[L,R]=w.useState({}),[Ie,Ye]=w.useState({}),[ee,Ee]=w.useState({}),[Pe,Ne]=w.useState(!0),[se,O]=w.useState(0),[te,be]=w.useState(0),[Se,xe]=w.useState(0),[Ce,Be]=w.useState(new Set),[Ve,Le]=w.useState(null),[Qt,Dt]=w.useState(!1),[bn,gn]=w.useState(!1),[Ut,gt]=w.useState([]),[Lt,sn]=w.useState(!1),[dt,At]=w.useState(null),[oe,Xt]=w.useState([]),pt=w.useCallback((Z,je="info")=>{X({message:Z,type:je}),setTimeout(()=>X(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),w.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let Z=!1;return(async()=>{W(!0);try{const yt=(await Gt(ot(ye,"clients"))).docs.map(it=>({id:it.id,...it.data()})).find(it=>it.id===s);if(!yt){Z||W(!1);return}Z||y(yt);const bt=i.id,Xe=ag(bt,s);if((await vs(Fe(ye,"buddies",Xe))).exists())Z||E("buddy");else{const it=`${bt}_${s}`,Ot=await vs(Fe(ye,"buddyRequests",it));if(Ot.exists()&&Ot.data().status==="pending")Z||(E("pending_out"),P(it));else{const _n=`${s}_${bt}`,kn=await vs(Fe(ye,"buddyRequests",_n));kn.exists()&&kn.data().status==="pending"?Z||(E("pending_in"),P(_n)):Z||E("none")}}}catch(je){console.error("Error loading profile:",je)}finally{Z||W(!1)}})(),()=>{Z=!0}},[i,s]),w.useEffect(()=>{if(!s||!g)return;let Z=!1;return(async()=>{Ne(!0);try{const je=await Gt(nn(ot(ye,"workoutLogs"),vt("clientId","==",s)));if(Z)return;const lt=je.docs.length;O(lt);let yt=0;const bt=je.docs.map(et=>et.data().date).filter(Boolean).sort().reverse();if(bt.length>0){const et=new Date;let it=new Date(et);for(let Ot=0;Ot<52;Ot++){const _n=new Date(it),kn=_n.getDay(),Kn=kn===0?6:kn-1;_n.setDate(_n.getDate()-Kn),_n.setHours(0,0,0,0);const le=new Date(_n);le.setDate(le.getDate()+7);const Me=og(_n),qe=og(le);if(bt.some(st=>st>=Me&&st<qe))yt++;else{if(Ot>0)break;break}it.setDate(it.getDate()-7)}}Z||be(yt);let Xe=0;for(let et=0;et<30;et++){const it=new Date;it.setDate(it.getDate()-et);const Ot=og(it);try{const _n=await Gt(nn(ot(ye,"habitLogs"),vt("clientId","==",s),vt("date","==",Ot)));if(_n.empty)break;{const kn=_n.docs[0].data().habits||{};if(Object.values(kn).filter(Boolean).length>=E5)Xe++;else break}}catch{break}}Z||xe(Xe);try{const et=await vs(Fe(ye,"coreBuddyBadges",s));if(!Z&&et.exists()){const it=et.data().earned||[];Be(new Set(it.map(Ot=>Ot.id)))}}catch(et){console.error("Error loading buddy badges:",et)}}catch(je){console.error("Error loading buddy stats:",je)}finally{Z||Ne(!1)}})(),()=>{Z=!0}},[s,g]),w.useEffect(()=>{if(!i)return;const Z=i.id;(async()=>{try{const[je,lt,yt]=await Promise.all([Gt(nn(ot(ye,"buddies"),vt("user1","==",Z))),Gt(nn(ot(ye,"buddies"),vt("user2","==",Z))),Gt(ot(ye,"clients"))]),bt=new Set;[...je.docs,...lt.docs].forEach(et=>{const it=et.data();bt.add(it.user1===Z?it.user2:it.user1)});const Xe={};yt.docs.forEach(et=>{Xe[et.id]=et.data()}),gt(Array.from(bt).filter(et=>Xe[et]).map(et=>({id:et,name:Xe[et].name,photoURL:Xe[et].photoURL||null})))}catch(je){console.error("Error loading buddies for mentions:",je)}})()},[i]);const Rt=async(Z,je,lt={})=>{if(!(!i||Z===i.id))try{await br(ot(ye,"notifications"),{toId:Z,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:je,read:!1,createdAt:Ms(),...lt})}catch(yt){console.error("Notification error:",yt),yt.code==="permission-denied"&&pt("Notifications blocked  check Firestore rules","error")}},ze=async()=>{H(!0);try{const Z=`${i.id}_${s}`;await Ts(Fe(ye,"buddyRequests",Z),{fromId:i.id,toId:s,status:"pending",createdAt:Ms()}),await Rt(s,"buddy_request"),E("pending_out"),P(Z),pt("Buddy request sent!","success")}catch(Z){console.error(Z),pt("Failed to send request","error")}finally{H(!1)}},kt=async()=>{if(j){H(!0);try{const Z=ag(i.id,s);await Ts(Fe(ye,"buddies",Z),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Ms()}),await Ar(Fe(ye,"buddyRequests",j)),await Rt(s,"buddy_accept"),E("buddy"),pt("Buddy added!","success")}catch(Z){console.error(Z),pt("Failed to accept","error")}finally{H(!1)}}},Jt=async()=>{if(j){H(!0);try{await Ar(Fe(ye,"buddyRequests",j)),E("none"),pt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(Z){console.error(Z),pt("Failed","error")}finally{H(!1)}}},cn=async()=>{H(!0);try{const Z=ag(i.id,s);await Ar(Fe(ye,"buddies",Z)),E("none"),Dt(!1),pt("Buddy removed","info")}catch(Z){console.error(Z),pt("Failed to remove","error")}finally{H(!1)}},wn=w.useCallback(async()=>{if(s){C(!0);try{const Z=await Gt(nn(ot(ye,"posts"),vt("authorId","==",s),Eu("createdAt","desc"),Tu(30)));if(_e(Z.docs.map(je=>({id:je.id,...je.data()}))),i){const je=await Gt(nn(ot(ye,"postLikes"),vt("userId","==",i.id)));M(new Set(je.docs.map(lt=>lt.data().postId)))}}catch(Z){console.error("Error loading journey:",Z)}finally{C(!1)}}},[s,i]);w.useEffect(()=>{!F&&g&&wn()},[F,g,wn]);const Ss=async Z=>{if(window.confirm("Delete this post?"))try{await Ar(Fe(ye,"posts",Z)),_e(je=>je.filter(lt=>lt.id!==Z)),pt("Post deleted","info")}catch(je){console.error("Delete error:",je),pt("Failed to delete","error")}},Vn=async Z=>{if(!i)return;const je=i.id,lt=`${Z}_${je}`,yt=S.has(Z),bt=new Set(S);yt?bt.delete(Z):bt.add(Z),M(bt),_e(Xe=>Xe.map(et=>et.id===Z?{...et,likeCount:Math.max(0,(et.likeCount||0)+(yt?-1:1))}:et));try{if(yt)await Ar(Fe(ye,"postLikes",lt)),await os(Fe(ye,"posts",Z),{likeCount:Io(-1)});else{await Ts(Fe(ye,"postLikes",lt),{postId:Z,userId:je,createdAt:Ms()}),await os(Fe(ye,"posts",Z),{likeCount:Io(1)});const Xe=de.find(et=>et.id===Z);Xe&&Rt(Xe.authorId,"like",{postId:Z})}}catch(Xe){console.error("Like error:",Xe),wn()}},ls=async Z=>{try{const je=await Gt(nn(ot(ye,"postComments"),vt("postId","==",Z),Eu("createdAt","asc"),Tu(50)));R(lt=>({...lt,[Z]:je.docs.map(yt=>({id:yt.id,...yt.data()}))}))}catch(je){console.error("Error loading comments:",je)}},Un=Z=>{const je=new Set(V);je.has(Z)?je.delete(Z):(je.add(Z),L[Z]||ls(Z)),D(je)},xn=(Z,je)=>{const lt=Z.match(/@(\w*)$/);if(lt){sn(!0),At(je);const yt=Ut.filter(bt=>bt.name&&bt.name.toLowerCase().includes(lt[1].toLowerCase())).slice(0,5);Xt(yt)}else sn(!1),Xt([])},Ct=(Z,je)=>{const yt=(Ie[je]||"").replace(/@\w*$/,`@${Z.name} `);Ye(bt=>({...bt,[je]:yt})),sn(!1),Xt([])},un=(Z,je)=>{Ye(lt=>({...lt,[Z]:je})),xn(je,Z)},Ze=async Z=>{const je=(Ie[Z]||"").trim();if(!(!je||!i)){Ee(lt=>({...lt,[Z]:!0}));try{await br(ot(ye,"postComments"),{postId:Z,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:je,createdAt:Ms()}),await os(Fe(ye,"posts",Z),{commentCount:Io(1)});const lt=de.find(bt=>bt.id===Z);lt&&Rt(lt.authorId,"comment",{postId:Z});const yt=je.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(yt){const bt=new Set;yt.forEach(Xe=>{const et=Xe.slice(1).trim(),it=Ut.find(Ot=>Ot.name&&Ot.name.toLowerCase()===et.toLowerCase());it&&!bt.has(it.id)&&(bt.add(it.id),Rt(it.id,"mention",{postId:Z}))})}Ye(bt=>({...bt,[Z]:""})),_e(bt=>bt.map(Xe=>Xe.id===Z?{...Xe,commentCount:(Xe.commentCount||0)+1}:Xe)),await ls(Z)}catch(lt){console.error("Comment error:",lt),pt("Failed to comment","error")}finally{Ee(lt=>({...lt,[Z]:!1}))}}};return l||F||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsx(Zo,{children:a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>Dt(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${g.photoURL?" tappable":""}`,onClick:()=>g.photoURL&&gn(!0),children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:vh(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ze,disabled:z,children:z?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Jt,disabled:z,children:z?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:kt,disabled:z,children:z?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Jt,disabled:z,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),Pe?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:se}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[te,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Se>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Se," day",Se!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const Z=oi.filter(je=>Ce.has(je.id));return Z.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${g.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[Z.length,"/",oi.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:Z.map(je=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Le(je),children:[a.jsx("img",{src:je.img,alt:je.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:je.name})]},je.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),pe?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):de.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:de.map(Z=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:vh(Z.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Z.authorName}),a.jsx("span",{className:"journey-post-time",children:tx(Z.createdAt)})]}),Z.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ss(Z.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Z.type==="workout_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(je=>`${je.value} ${je.label}`).join("    ")}),!Z.metadata.stats?.length&&Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="badge_earned"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const je=oi.find(lt=>lt.id===Z.metadata.badgeId);return je?.img?a.jsx("img",{src:je.img,alt:Z.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:Z.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="habits_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(je=>`${je.value} ${je.label}`).join("    ")}),Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[Z.content&&a.jsx("p",{className:"journey-post-content",children:Z.content}),Z.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Z.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(Z.id)?" liked":""}`,onClick:()=>Vn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(Z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Z.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(Z.id)?" active":""}`,onClick:()=>Un(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Z.commentCount||0})]})]}),V.has(Z.id)&&a.jsxs("div",{className:"journey-comments",children:[L[Z.id]?.length>0?L[Z.id].map(je=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${je.authorId}`),children:je.authorPhotoURL?a.jsx("img",{src:je.authorPhotoURL,alt:""}):a.jsx("span",{children:vh(je.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:je.authorName}),a.jsx("span",{className:"journey-comment-text",children:je.content})]}),a.jsx("span",{className:"journey-comment-time",children:tx(je.createdAt)})]})]},je.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ie[Z.id]||"",onChange:je=>un(Z.id,je.target.value),onKeyDown:je=>{je.key==="Enter"&&Ze(Z.id)},maxLength:300}),Lt&&dt===Z.id&&oe.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:oe.map(je=>a.jsxs("button",{className:"mention-option",onClick:()=>Ct(je,Z.id),children:[a.jsx("div",{className:"mention-option-avatar",children:je.photoURL?a.jsx("img",{src:je.photoURL,alt:""}):a.jsx("span",{children:vh(je.name)})}),a.jsx("span",{children:je.name})]},je.id))}),a.jsx("button",{onClick:()=>Ze(Z.id),disabled:!(Ie[Z.id]||"").trim()||ee[Z.id],children:ee[Z.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Z.id))})]})]}),a.jsx(Yr,{active:"buddies"}),bn&&g.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>gn(!1),children:a.jsx("img",{src:g.photoURL,alt:g.name,className:"prf-photo-overlay-img"})}),Ve&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Le(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Z=>Z.stopPropagation(),children:[a.jsx("img",{src:Ve.img,alt:Ve.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Ve.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Ve.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Le(null),children:"Close"})]})}),Qt&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>Dt(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:Z=>Z.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",g.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>Dt(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:cn,disabled:z,children:z?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),G&&a.jsxs("div",{className:`toast-notification ${G.type}`,children:[a.jsx("span",{className:"toast-icon",children:G.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):G.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:G.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Yr,{active:"buddies"})]})}const lg=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],nx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function j5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function S5(){const s=Xs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Mr(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[p,g]=w.useState(0),[y,b]=w.useState(0),[E,j]=w.useState(null),[P,F]=w.useState(!1),W=w.useRef(null),[z,H]=w.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:nx.filter(R=>R.defaultOn).map(R=>R.id)}),[G,X]=w.useState(!1),[de,_e]=w.useState(!1),[pe,C]=w.useState(null);w.useEffect(()=>{e?.photoURL&&j(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const L=()=>{const Ie=new Date,Ye=new Date(Ie);Ye.setHours(23,59,59,999);const ee=Ye-Ie;d({hours:Math.floor(ee/36e5),minutes:Math.floor(ee%36e5/6e4),seconds:Math.floor(ee%6e4/1e3)}),g(60-Math.floor(ee%6e4/1e3))};L();const R=setInterval(L,1e3);return()=>clearInterval(R)},[]),w.useEffect(()=>{const L=setInterval(()=>b(R=>(R+1)%lg.length),8e3);return()=>clearInterval(L)},[]);const S=async L=>{const R=L.target.files?.[0];if(!(!R||!e?.id)){F(!0);try{const Ie=Ya(Qa,`profilePhotos/${e.id}`);await Ih(Ie,R);const Ye=await Po(Ie);await os(Fe(ye,"clients",e.id),{photoURL:Ye}),j(Ye),i({photoURL:Ye})}catch(Ie){console.error("Photo upload error:",Ie)}finally{F(!1)}}},M=L=>{_e(!1),H(R=>R.includes(L)?R.filter(Ie=>Ie!==L):[...R,L])},V=(L,R)=>{_e(!1),H(Ie=>{const Ye=Ie.indexOf(L);if(Ye<0)return Ie;const ee=Ye+R;if(ee<0||ee>=Ie.length)return Ie;const Ee=[...Ie];return[Ee[Ye],Ee[ee]]=[Ee[ee],Ee[Ye]],Ee})},D=async()=>{X(!0),C(null);try{const L=e||await l();if(!L?.id){C("Could not find your profile. Try refreshing."),X(!1);return}await os(Fe(ye,"clients",L.id),{dashboardWidgets:z}),i({dashboardWidgets:z}),_e(!0)}catch(L){console.error("Save config error:",L),C("Save failed  please try again.")}finally{X(!1)}};return a.jsx(Zo,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:jE.map((L,R)=>a.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${R<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},R))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>W.current?.click(),children:[a.jsx("img",{src:E||"/Logo.webp",alt:E?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${P?" uploading":""}`,children:P?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:W,type:"file",accept:"image/*",onChange:S,style:{display:"none"}})]}),!E&&!P&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>W.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[lg[y].text," ",a.jsx("strong",{children:lg[y].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:nx.map(L=>{const R=z.includes(L.id),Ie=z.indexOf(L.id);return a.jsxs("div",{className:`bldr-widget-card${R?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:j5(L.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:L.label}),a.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[R&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,-1),disabled:Ie===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Ie+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,1),disabled:Ie===z.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${R?" on":""}`,onClick:()=>M(L.id),"aria-label":R?`Remove ${L.label}`:`Add ${L.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${de?" saved":""}`,onClick:D,disabled:G||de,children:G?"Saving...":de?"Saved":"Save Dashboard"}),pe&&a.jsx("p",{className:"bldr-save-error",children:pe}),de&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(Yr,{active:"home"})]})})}const SE="@firebase/installations",g0="0.6.19";const CE=1e4,NE=`w:${g0}`,AE="FIS_v2",C5="https://firebaseinstallations.googleapis.com/v1",N5=3600*1e3,A5="installations",R5="Installations";const I5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ho=new Wo(A5,R5,I5);function RE(s){return s instanceof hi&&s.code.includes("request-failed")}function IE({projectId:s}){return`${C5}/projects/${s}/installations`}function ME(s){return{token:s.token,requestStatus:2,expiresIn:D5(s.expiresIn),creationTime:Date.now()}}async function DE(s,e){const i=(await e.json()).error;return Ho.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function LE({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function M5(s,{refreshToken:e}){const t=LE(s);return t.append("Authorization",L5(e)),t}async function OE(s){const e=await s();return e.status>=500&&e.status<600?s():e}function D5(s){return Number(s.replace("s","000"))}function L5(s){return`${AE} ${s}`}async function O5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=IE(s),l=LE(s),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const d={fid:t,authVersion:AE,appId:s.appId,sdkVersion:NE},p={method:"POST",headers:l,body:JSON.stringify(d)},g=await OE(()=>fetch(i,p));if(g.ok){const y=await g.json();return{fid:y.fid||t,registrationStatus:2,refreshToken:y.refreshToken,authToken:ME(y.authToken)}}else throw await DE("Create Installation",g)}function PE(s){return new Promise(e=>{setTimeout(e,s)})}function P5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const V5=/^[cdef][\w-]{21}$/,Yg="";function U5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=B5(s);return V5.test(t)?t:Yg}catch{return Yg}}function B5(s){return P5(s).substr(0,22)}function Rf(s){return`${s.appName}!${s.appId}`}const VE=new Map;function UE(s,e){const t=Rf(s);BE(t,e),z5(t,e)}function BE(s,e){const t=VE.get(s);if(t)for(const i of t)i(e)}function z5(s,e){const t=F5();t&&t.postMessage({key:s,fid:e}),q5()}let Mo=null;function F5(){return!Mo&&"BroadcastChannel"in self&&(Mo=new BroadcastChannel("[Firebase] FID Change"),Mo.onmessage=s=>{BE(s.data.key,s.data.fid)}),Mo}function q5(){VE.size===0&&Mo&&(Mo.close(),Mo=null)}const H5="firebase-installations-database",$5=1,$o="firebase-installations-store";let cg=null;function y0(){return cg||(cg=af(H5,$5,{upgrade:(s,e)=>{e===0&&s.createObjectStore($o)}})),cg}async function tf(s,e){const t=Rf(s),l=(await y0()).transaction($o,"readwrite"),u=l.objectStore($o),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&UE(s,e.fid),e}async function zE(s){const e=Rf(s),i=(await y0()).transaction($o,"readwrite");await i.objectStore($o).delete(e),await i.done}async function If(s,e){const t=Rf(s),l=(await y0()).transaction($o,"readwrite"),u=l.objectStore($o),d=await u.get(t),p=e(d);return p===void 0?await u.delete(t):await u.put(p,t),await l.done,p&&(!d||d.fid!==p.fid)&&UE(s,p.fid),p}async function v0(s){let e;const t=await If(s.appConfig,i=>{const l=W5(i),u=G5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Yg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function W5(s){const e=s||{fid:U5(),registrationStatus:0};return FE(e)}function G5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Ho.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=K5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Y5(s)}:{installationEntry:e}}async function K5(s,e){try{const t=await O5(s,e);return tf(s.appConfig,t)}catch(t){throw RE(t)&&t.customData.serverCode===409?await zE(s.appConfig):await tf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Y5(s){let e=await sx(s.appConfig);for(;e.registrationStatus===1;)await PE(100),e=await sx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await v0(s);return i||t}return e}function sx(s){return If(s,e=>{if(!e)throw Ho.create("installation-not-found");return FE(e)})}function FE(s){return Q5(s)?{fid:s.fid,registrationStatus:0}:s}function Q5(s){return s.registrationStatus===1&&s.registrationTime+CE<Date.now()}async function X5({appConfig:s,heartbeatServiceProvider:e},t){const i=J5(s,t),l=M5(s,t),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const d={installation:{sdkVersion:NE,appId:s.appId}},p={method:"POST",headers:l,body:JSON.stringify(d)},g=await OE(()=>fetch(i,p));if(g.ok){const y=await g.json();return ME(y)}else throw await DE("Generate Auth Token",g)}function J5(s,{fid:e}){return`${IE(s)}/${e}/authTokens:generate`}async function b0(s,e=!1){let t;const i=await If(s.appConfig,u=>{if(!qE(u))throw Ho.create("not-registered");const d=u.authToken;if(!e&&tL(d))return u;if(d.requestStatus===1)return t=Z5(s,e),u;{if(!navigator.onLine)throw Ho.create("app-offline");const p=sL(u);return t=eL(s,p),p}});return t?await t:i.authToken}async function Z5(s,e){let t=await rx(s.appConfig);for(;t.authToken.requestStatus===1;)await PE(100),t=await rx(s.appConfig);const i=t.authToken;return i.requestStatus===0?b0(s,e):i}function rx(s){return If(s,e=>{if(!qE(e))throw Ho.create("not-registered");const t=e.authToken;return rL(t)?{...e,authToken:{requestStatus:0}}:e})}async function eL(s,e){try{const t=await X5(s,e),i={...e,authToken:t};return await tf(s.appConfig,i),t}catch(t){if(RE(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await zE(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await tf(s.appConfig,i)}throw t}}function qE(s){return s!==void 0&&s.registrationStatus===2}function tL(s){return s.requestStatus===2&&!nL(s)}function nL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+N5}function sL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function rL(s){return s.requestStatus===1&&s.requestTime+CE<Date.now()}async function iL(s){const e=s,{installationEntry:t,registrationPromise:i}=await v0(e);return i?i.catch(console.error):b0(e).catch(console.error),t.fid}async function aL(s,e=!1){const t=s;return await oL(t),(await b0(t,e)).token}async function oL(s){const{registrationPromise:e}=await v0(s);e&&await e}function lL(s){if(!s||!s.options)throw ug("App Configuration");if(!s.name)throw ug("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw ug(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function ug(s){return Ho.create("missing-app-config-values",{valueName:s})}const HE="installations",cL="installations-internal",uL=s=>{const e=s.getProvider("app").getImmediate(),t=lL(e),i=Go(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},dL=s=>{const e=s.getProvider("app").getImmediate(),t=Go(e,HE).getImmediate();return{getId:()=>iL(t),getToken:l=>aL(t,l)}};function hL(){li(new Kr(HE,uL,"PUBLIC")),li(new Kr(cL,dL,"PRIVATE"))}hL();wr(SE,g0);wr(SE,g0,"esm2020");const fL="/firebase-messaging-sw.js",mL="/firebase-cloud-messaging-push-scope",$E="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",pL="https://fcmregistrations.googleapis.com/v1",WE="google.c.a.c_id",gL="google.c.a.c_l",yL="google.c.a.ts",vL="google.c.a.e",ix=1e4;var ax;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ax||(ax={}));var ju;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(ju||(ju={}));function ea(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const dg="fcm_token_details_db",wL=5,ox="fcm_token_object_Store";async function xL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(dg))return null;let e=null;return(await af(dg,wL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(ox))return;const p=d.objectStore(ox),g=await p.index("fcmSenderId").get(s);if(await p.clear(),!!g){if(l===2){const y=g;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:y.createTime??Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:ea(y.vapidKey)}}}else if(l===3){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:ea(y.auth),p256dh:ea(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:ea(y.vapidKey)}}}else if(l===4){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:ea(y.auth),p256dh:ea(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:ea(y.vapidKey)}}}}}})).close(),await Vp(dg),await Vp("fcm_vapid_details_db"),await Vp("undefined"),_L(e)?e:null}function _L(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const kL="firebase-messaging-database",EL=1,Su="firebase-messaging-store";let hg=null;function GE(){return hg||(hg=af(kL,EL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Su)}})),hg}async function TL(s){const e=KE(s),i=await(await GE()).transaction(Su).objectStore(Su).get(e);if(i)return i;{const l=await xL(s.appConfig.senderId);if(l)return await w0(s,l),l}}async function w0(s,e){const t=KE(s),l=(await GE()).transaction(Su,"readwrite");return await l.objectStore(Su).put(e,t),await l.done,e}function KE({appConfig:s}){return s.appId}const jL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},cr=new Wo("messaging","Messaging",jL);async function SL(s,e){const t=await _0(s),i=YE(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(x0(s.appConfig),l)).json()}catch(d){throw cr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw cr.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw cr.create("token-subscribe-no-token");return u.token}async function CL(s,e){const t=await _0(s),i=YE(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${x0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw cr.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw cr.create("token-update-failed",{errorInfo:d})}if(!u.token)throw cr.create("token-update-no-token");return u.token}async function NL(s,e){const i={method:"DELETE",headers:await _0(s)};try{const u=await(await fetch(`${x0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw cr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw cr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function x0({projectId:s}){return`${pL}/projects/${s}/registrations`}async function _0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function YE({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==$E&&(l.web.applicationPubKey=i),l}const AL=10080*60*1e3;async function RL(s){const e=await ML(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:ea(e.getKey("auth")),p256dh:ea(e.getKey("p256dh"))},i=await TL(s.firebaseDependencies);if(i){if(DL(i.subscriptionOptions,t))return Date.now()>=i.createTime+AL?IL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await NL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return lx(s.firebaseDependencies,t)}else return lx(s.firebaseDependencies,t)}async function IL(s,e){try{const t=await CL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await w0(s.firebaseDependencies,i),t}catch(t){throw t}}async function lx(s,e){const i={token:await SL(s,e),createTime:Date.now(),subscriptionOptions:e};return await w0(s,i),i.token}async function ML(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:bL(e)})}function DL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function cx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return LL(e,s),OL(e,s),PL(e,s),e}function LL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function OL(s,e){e.data&&(s.data=e.data)}function PL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function VL(s){return typeof s=="object"&&!!s&&WE in s}function UL(s){if(!s||!s.options)throw fg("App Configuration Object");if(!s.name)throw fg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw fg(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fg(s){return cr.create("missing-app-config-values",{valueName:s})}class BL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=UL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function zL(s){try{s.swRegistration=await navigator.serviceWorker.register(fL,{scope:mL}),s.swRegistration.update().catch(()=>{}),await FL(s.swRegistration)}catch(e){throw cr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function FL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${ix} ms`)),ix),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function qL(s,e){if(!e&&!s.swRegistration&&await zL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw cr.create("invalid-sw-registration");s.swRegistration=e}}async function HL(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=$E)}async function QE(s,e){if(!navigator)throw cr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw cr.create("permission-blocked");return await HL(s,e?.vapidKey),await qL(s,e?.serviceWorkerRegistration),RL(s)}async function $L(s,e,t){const i=WL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[WE],message_name:t[gL],message_time:t[yL],message_device_time:Math.floor(Date.now()/1e3)})}function WL(s){switch(s){case ju.NOTIFICATION_CLICKED:return"notification_open";case ju.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function GL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===ju.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(cx(t)):s.onMessageHandler.next(cx(t)));const i=t.data;VL(i)&&i[vL]==="1"&&await $L(s,t.messageType,i)}const ux="@firebase/messaging",dx="0.12.23";const KL=s=>{const e=new BL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>GL(e,t)),e},YL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>QE(e,i)}};function QL(){li(new Kr("messaging",KL,"PUBLIC")),li(new Kr("messaging-internal",YL,"PRIVATE")),wr(ux,dx),wr(ux,dx,"esm2020")}async function XL(){try{await qx()}catch{return!1}return typeof window<"u"&&Fx()&&LC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function JL(s=Ru()){return XL().then(e=>{if(!e)throw cr.create("unsupported-browser")},e=>{throw cr.create("indexed-db-unsupported")}),Go(pn(s),"messaging").getImmediate()}async function ZL(s,e){return s=pn(s),QE(s,e)}QL();const eO="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let mg=null;function tO(){if(!mg)try{mg=JL(Ru())}catch{return null}return mg}function Qg(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function hx(){return"Notification"in window?Notification.permission:"denied"}function nO(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function sO(s){if(!Qg())return null;try{const e=await Notification.requestPermission(),t=tO();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let p=1;p<=d;p++){try{const g=()=>ZL(t,{vapidKey:eO,serviceWorkerRegistration:i});if(u=l?await nO(g):await g(),u)break}catch(g){console.warn(`Push getToken attempt ${p}/${d} failed:`,g)}p<d&&await new Promise(g=>setTimeout(g,1500*p))}return u&&s&&await os(Fe(ye,"clients",s),{fcmTokens:T6(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function rO(s,e){if(!(!e||!s))try{await os(Fe(ye,"clients",s),{fcmTokens:j6(e)})}catch(t){console.error("Token revoke failed:",t)}}const iO=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function aO(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=Mi(),p=Xs(),[g,y]=w.useState(!1),[b,E]=w.useState(null),[j,P]=w.useState(!1),[F,W]=w.useState("default"),[z,H]=w.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[G,X]=w.useState(null),de=w.useCallback((C,S="info")=>{X({message:C,type:S}),setTimeout(()=>X(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&p("/")},[l,s,p]),w.useEffect(()=>{if(!e)return;const C=e.notificationPrefs;C&&H(M=>({...M,...C}));const S=e.fcmTokens||[];S.length>0&&(y(!0),E(S[S.length-1])),W(hx())},[e]);const _e=async()=>{if(e){P(!0);try{if(g)b&&await rO(e.id,b),y(!1),E(null),t({fcmTokens:[]}),de("Push notifications disabled","info");else{if(!Qg()){de("Push notifications are not supported on this device","error");return}const C=await sO(e.id),S=hx();W(S),C?(y(!0),E(C),t({fcmTokens:[...e.fcmTokens||[],C]}),de("Push notifications enabled!","success")):de(S==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":S==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(C){console.error("Push toggle failed:",C),de("Something went wrong  please try again","error")}finally{P(!1)}}},pe=async C=>{if(!e)return;const S={...z,[C]:!z[C]};H(S);try{await os(Fe(ye,"clients",e.id),{notificationPrefs:S}),t({notificationPrefs:S})}catch(M){console.error("Failed to save pref:",M),H(V=>({...V,[C]:!V[C]})),de("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Qg()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${g?" on":""}${j?" loading":""}`,onClick:_e,disabled:j,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),iO.map(C=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:C.label}),a.jsx("span",{className:"settings-row-desc",children:C.desc})]}),a.jsx("button",{className:`settings-toggle${z[C.key]?" on":""}`,onClick:()=>pe(C.key),"aria-label":`Toggle ${C.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},C.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),G&&a.jsx("div",{className:`settings-toast ${G.type}`,children:G.message}),a.jsx(Yr,{active:"home"})]})}const bh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function pg({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function fx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,p=2*Math.PI*d,g=p*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:p,strokeDashoffset:g,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const mx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function oO(s,e,t){const i=t instanceof St?t:St.fromDate(new Date(t)),l=St.now();switch(s.type){case"workouts":{const u=nn(ot(ye,"workoutLogs"),vt("clientId","==",e),vt("completedAt",">=",i),vt("completedAt","<=",l));return(await Gt(u)).size}case"minutes":{const u=nn(ot(ye,"workoutLogs"),vt("clientId","==",e),vt("completedAt",">=",i),vt("completedAt","<=",l));return(await Gt(u)).docs.reduce((p,g)=>p+(g.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),d=new Date().toISOString().slice(0,10),p=nn(ot(ye,"habitLogs"),vt("clientId","==",e));return(await Gt(p)).docs.filter(y=>{const b=y.data().date;if(b<u||b>d)return!1;const E=y.data().habits||{};return Object.values(E).length>0&&Object.values(E).every(j=>j===!0)}).length}case"streak":{const u=nn(ot(ye,"workoutLogs"),vt("clientId","==",e),vt("completedAt",">=",i),vt("completedAt","<=",l)),d=await Gt(u),p=new Set(d.docs.map(E=>E.data().completedAt.toDate().toISOString().slice(0,10)));let g=0;const y=new Date(i.toDate()),b=new Date;for(;p.has(y.toISOString().slice(0,10))&&y<=b;)g++,y.setDate(y.getDate()+1);return g}default:return 0}}function lO(){const{currentUser:s,clientData:e,loading:t}=Mr(),{isDark:i,toggleTheme:l}=Mi(),{isPremium:u}=oc(),d=Xs(),[p,g]=w.useState(null),[y,b]=w.useState(null),[E,j]=w.useState(0),[P,F]=w.useState(0),[W,z]=w.useState(!0),[H,G]=w.useState(!1),[X,de]=w.useState(null),[_e,pe]=w.useState(null),[C,S]=w.useState(!1),[M,V]=w.useState(null),D=w.useCallback((Ne,se="info")=>{pe({message:Ne,type:se}),setTimeout(()=>pe(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const L=w.useCallback(async()=>{if(e){z(!0);try{const Ne=nn(ot(ye,"userChallenges"),vt("clientId","==",e.id),vt("status","==","active")),se=await Gt(Ne);if(se.empty)g(null),b(null);else{const be=se.docs[0],Se={id:be.id,...be.data()},xe=bh.find(Ce=>Ce.id===Se.challengeId);if(Se.endDate.toDate()<new Date)await os(Fe(ye,"userChallenges",be.id),{status:"failed"}),g(null),b(null),D("Challenge expired  time ran out","error");else if(g(Se),b(xe),xe){const Ce=await oO(xe,e.id,Se.startDate);if(j(Ce),Ce>=xe.goal&&Se.status==="active"){if(await os(Fe(ye,"userChallenges",be.id),{status:"completed",completedAt:Ms()}),S(!0),g(Be=>Be?{...Be,status:"completed"}:null),!Se.badgeAwarded){const Be=oi.find(Ve=>Ve.id===xe.id);if(Be)try{const Ve=Fe(ye,"coreBuddyBadges",e.id),Le=await vs(Ve),Qt=Le.exists()?Le.data().earned||[]:[];if(!Qt.some(Dt=>Dt.id===Be.id)){const Dt={id:Be.id,earnedAt:new Date().toISOString()};Le.exists()?await os(Ve,{earned:[...Qt,Dt]}):await Ts(Ve,{earned:[Dt]})}await os(Fe(ye,"userChallenges",be.id),{badgeAwarded:!0}),await br(ot(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:Be.name,badgeDesc:Be.desc,badgeId:Be.id},createdAt:Ms(),likeCount:0,commentCount:0}),V(Be)}catch(Ve){console.error("Badge award failed:",Ve)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:xe.name,challenge_type:xe.type,duration_days:xe.duration})}}}const O=nn(ot(ye,"userChallenges"),vt("clientId","==",e.id),vt("status","==","completed")),te=await Gt(O);F(te.size)}catch(Ne){console.error("Failed to load challenges:",Ne)}finally{z(!1)}}},[e,D]);w.useEffect(()=>{L()},[L]);const R=async Ne=>{if(!(!e||H)){G(!0);try{const se=bh.find(xe=>xe.id===Ne);if(!se)return;const O=nn(ot(ye,"userChallenges"),vt("clientId","==",e.id),vt("status","==","active"));if(!(await Gt(O)).empty){de(null),D("You already have an active challenge","info"),await L();return}const be=St.now(),Se=St.fromDate(new Date(Date.now()+se.duration*864e5));await br(ot(ye,"userChallenges"),{clientId:e.id,challengeId:Ne,startDate:be,endDate:Se,status:"active",completedAt:null,badgeAwarded:!1,createdAt:Ms()}),de(null),D(`${se.name} started  let's go!`,"success"),await L()}catch(se){console.error("Start challenge failed:",se),se?.code==="permission-denied"?D("Permission denied  please re-login and try again","error"):D("Something went wrong  try again","error")}finally{G(!1)}}},Ie=async()=>{if(!(!p||H)){G(!0);try{await os(Fe(ye,"userChallenges",p.id),{status:"failed"}),g(null),b(null),j(0),de(null),D("Challenge abandoned","info"),await L()}catch(Ne){console.error("Give up failed:",Ne),D("Something went wrong","error")}finally{G(!1)}}},Ye=p?.endDate?Math.max(0,Math.ceil((p.endDate.toDate()-new Date)/864e5)):0,ee=()=>{if(!y||!p)return"";const Ne=Math.max(1,Math.ceil((Date.now()-p.startDate.toDate())/864e5)),se=y.goal/y.duration*Ne;return E>=se*1.15?"Ahead":E>=se*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Ee=p&&p.status==="active"&&y,Pe=C||p&&p.status==="completed";return a.jsxs("div",{className:"ch-page","data-theme":i?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),W?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):Pe?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(fx,{progress:y?.goal||1,goal:y?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:y?.name}),a.jsxs("p",{className:"ch-completed-count",children:[P+(C?1:0)," challenge",P!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{S(!1),g(null),b(null),L()},children:"Choose Next Challenge"})]}):Ee?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(fx,{progress:E,goal:y.goal,label:y.type==="minutes"?"minutes":y.type==="streak"?"day streak":y.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:Ye}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${ee().toLowerCase().replace(" ","")}`,children:ee()})]}),a.jsx("h2",{className:"ch-active-name",children:y.name}),a.jsx("p",{className:"ch-active-desc",children:y.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>de("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:bh.filter(Ne=>Ne.id!==y.id).map(Ne=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(pg,{icon:Ne.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description})]})]},Ne.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:bh.map(Ne=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?de(Ne):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(pg,{icon:Ne.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Ne.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:mx[Ne.difficulty]},children:Ne.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Ne.id))})]})]}),X&&X!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!H&&de(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(pg,{icon:X.icon,size:36})}),a.jsx("h2",{children:X.name}),a.jsx("p",{children:X.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[X.duration," days"]}),a.jsx("span",{style:{color:mx[X.difficulty]},children:X.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>R(X.id),disabled:H,children:H?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>de(null),disabled:H,children:"Cancel"})]})}),X==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!H&&de(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Ie,disabled:H,children:H?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>de(null),disabled:H,children:"Keep Going"})]})}),a.jsx(ql,{badge:M,onDismiss:()=>V(null)}),_e&&a.jsx("div",{className:`ch-toast ch-toast-${_e.type}`,children:_e.message}),a.jsx(Yr,{})]})}const cO={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},uO=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function dO(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=Mi(),d=Xs(),[p,g]=w.useState(new Set),[y,b]=w.useState({}),[E,j]=w.useState(!0),[P,F]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{j(!0);try{const H=await vs(Fe(ye,"coreBuddyBadges",t.id));if(H.exists()){const G=H.data().earned||[];g(new Set(G.map(de=>de.id)));const X={};G.forEach(de=>{X[de.id]=de}),b(X)}}catch(H){console.error("Failed to load badges:",H)}finally{j(!1)}})()},[t]);const W=uO.map(H=>({key:H,label:cO[H],badges:oi.filter(G=>G.category===H)})).filter(H=>H.badges.length>0),z=oi.filter(H=>p.has(H.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[z," / ",oi.length," earned"]}),E?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):W.map(H=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:H.label}),a.jsx("div",{className:"bdg-grid",children:H.badges.map(G=>{const X=p.has(G.id);return a.jsxs("button",{className:`bdg-item${X?" earned":" locked"}`,onClick:()=>F(G),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[G.img?a.jsx("img",{src:G.img,alt:G.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!X&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:G.name})]},G.id)})})]},H.key))]}),P&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>F(null),children:a.jsxs("div",{className:"bdg-modal",onClick:H=>H.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${p.has(P.id)?" earned":" locked"}`,children:P.img?a.jsx("img",{src:P.img,alt:P.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:P.name}),a.jsx("p",{className:"bdg-modal-desc",children:P.desc}),p.has(P.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",y[P.id]?.earnedAt?`  ${new Date(y[P.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>F(null),children:"Close"})]})}),a.jsx(Yr,{active:"badges"})]})}const hO=w.lazy(()=>Qs(()=>import("./Dashboard-LWqG7lpQ.js"),__vite__mapDeps([0,1,2]))),fO=w.lazy(()=>Qs(()=>import("./AddClient-CtL3dvYY.js"),__vite__mapDeps([3,4]))),mO=w.lazy(()=>Qs(()=>import("./ClientDashboard-CV7rnNFW.js"),__vite__mapDeps([5,1,6]))),pO=w.lazy(()=>Qs(()=>import("./ClientForms-BwWdsNxI.js"),__vite__mapDeps([7,8,6]))),gO=w.lazy(()=>Qs(()=>import("./ClientTools-CHPvPomJ.js"),__vite__mapDeps([9,10,6]))),yO=w.lazy(()=>Qs(()=>import("./MacroCalculator-6ifMeNLu.js"),__vite__mapDeps([11,10,6]))),vO=w.lazy(()=>Qs(()=>import("./ProteinSnacks-CT6FteU5.js"),__vite__mapDeps([12,10,6]))),bO=w.lazy(()=>Qs(()=>import("./DailyMotivation-DPpx9dt2.js"),__vite__mapDeps([13,10,6]))),wO=w.lazy(()=>Qs(()=>import("./CircuitDashboard-1Fs3_iTx.js"),__vite__mapDeps([14,15]))),xO=w.lazy(()=>Qs(()=>import("./CircuitBooking-DLuF_m-p.js"),__vite__mapDeps([16,17,15]))),_O=w.lazy(()=>Qs(()=>import("./PersonalBests-DlFHLsFs.js"),__vite__mapDeps([18,19,6]))),kO=w.lazy(()=>Qs(()=>import("./Leaderboard-Cw4kEVV3.js"),__vite__mapDeps([20,21]))),EO=w.lazy(()=>Qs(()=>import("./UpgradePage-d4DWifsm.js"),__vite__mapDeps([22,23,24]))),TO=w.lazy(()=>Qs(()=>import("./SignUp-s8Oruzq1.js"),[])),jO=w.lazy(()=>Qs(()=>import("./Onboarding-CAK2ljU4.js"),__vite__mapDeps([25,23,26])));function SO({children:s}){const{pathname:e}=Ii();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function CO(){const s=Xs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function NO(){return a.jsx(JD,{children:a.jsx(XD,{children:a.jsx(s3,{children:a.jsxs(oC,{basename:"/login",children:[a.jsx(CO,{}),a.jsx(SO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(OS,{children:[a.jsx(Cn,{path:"/",element:a.jsx(a3,{})}),a.jsx(Cn,{path:"/dashboard",element:a.jsx(hO,{})}),a.jsx(Cn,{path:"/add-client",element:a.jsx(fO,{})}),a.jsx(Cn,{path:"/client",element:a.jsx(mO,{})}),a.jsx(Cn,{path:"/client/forms",element:a.jsx(pO,{})}),a.jsx(Cn,{path:"/client/tools",element:a.jsx(gO,{})}),a.jsx(Cn,{path:"/client/tools/macros",element:a.jsx(yO,{})}),a.jsx(Cn,{path:"/client/tools/snacks",element:a.jsx(vO,{})}),a.jsx(Cn,{path:"/client/tools/motivation",element:a.jsx(bO,{})}),a.jsx(Cn,{path:"/client/personal-bests",element:a.jsx(_O,{})}),a.jsx(Cn,{path:"/client/circuit",element:a.jsx(wO,{})}),a.jsx(Cn,{path:"/client/circuit/booking",element:a.jsx(xO,{})}),a.jsx(Cn,{path:"/client/core-buddy",element:a.jsx(N3,{})}),a.jsx(Cn,{path:"/client/core-buddy/nutrition",element:a.jsx(mh,{feature:"nutrition",children:a.jsx(I3,{})})}),a.jsx(Cn,{path:"/client/core-buddy/workouts",element:a.jsx(m5,{})}),a.jsx(Cn,{path:"/client/core-buddy/consistency",element:a.jsx(mh,{feature:"consistency",children:a.jsx(_5,{})})}),a.jsx(Cn,{path:"/client/core-buddy/buddies",element:a.jsx(mh,{feature:"buddies",children:a.jsx(k5,{})})}),a.jsx(Cn,{path:"/client/core-buddy/builder",element:a.jsx(S5,{})}),a.jsx(Cn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(T5,{})}),a.jsx(Cn,{path:"/client/core-buddy/settings",element:a.jsx(aO,{})}),a.jsx(Cn,{path:"/client/core-buddy/challenges",element:a.jsx(lO,{})}),a.jsx(Cn,{path:"/client/core-buddy/badges",element:a.jsx(dO,{})}),a.jsx(Cn,{path:"/client/leaderboard",element:a.jsx(mh,{feature:"leaderboard",children:a.jsx(kO,{})})}),a.jsx(Cn,{path:"/signup",element:a.jsx(TO,{})}),a.jsx(Cn,{path:"/onboarding",element:a.jsx(jO,{})}),a.jsx(Cn,{path:"/upgrade",element:a.jsx(EO,{})}),a.jsx(Cn,{path:"*",element:a.jsx(Cx,{to:"/",replace:!0})})]})})})]})})})})}Oj.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(NO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{r3 as A,ql as B,Yr as C,RO as D,Ms as E,Zo as P,St as T,br as a,Ar as b,ot as c,ye as d,Fe as e,QA as f,Gt as g,t4 as h,Ts as i,a as j,vs as k,Mr as l,Mi as m,Xs as n,Eu as o,jE as p,nn as q,w as r,MO as s,AO as t,os as u,DO as v,vt as w,ef as x,oc as y,i3 as z};
