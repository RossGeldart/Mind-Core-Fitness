const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-ChH7y0b8.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-DWWf72eQ.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-lf5OhHp1.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BbRCjf0I.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BNUY6BR9.js","assets/ProteinSnacks-CsA9tRsY.js","assets/DailyMotivation-DTt7yusu.js","assets/CircuitDashboard-BpEA_YGB.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-C6YzQ8iS.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-ZRomYbo5.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-D4OGWk6u.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-NeeqJzxB.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var yp={exports:{}},Gc={};var k1;function _T(){if(k1)return Gc;k1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Gc.Fragment=e,Gc.jsx=t,Gc.jsxs=t,Gc}var j1;function kT(){return j1||(j1=1,yp.exports=_T()),yp.exports}var r=kT(),bp={exports:{}},Xt={};var T1;function jT(){if(T1)return Xt;T1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),T=Symbol.iterator;function V(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,U={};function Z(L,ae,De){this.props=L,this.context=ae,this.refs=U,this.updater=De||W}Z.prototype.isReactComponent={},Z.prototype.setState=function(L,ae){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,ae,"setState")},Z.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function K(){}K.prototype=Z.prototype;function se(L,ae,De){this.props=L,this.context=ae,this.refs=U,this.updater=De||W}var he=se.prototype=new K;he.constructor=se,z(he,Z.prototype),he.isPureReactComponent=!0;var Me=Array.isArray;function we(){}var C={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function R(L,ae,De){var Pe=De.ref;return{$$typeof:n,type:L,key:ae,ref:Pe!==void 0?Pe:null,props:De}}function O(L,ae){return R(L.type,ae,L.props)}function I(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var ae={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(De){return ae[De]})}var D=/\/+/g;function Ue(L,ae){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):ae.toString(36)}function lt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(we,we):(L.status="pending",L.then(function(ae){L.status==="pending"&&(L.status="fulfilled",L.value=ae)},function(ae){L.status==="pending"&&(L.status="rejected",L.reason=ae)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function B(L,ae,De,Pe,Ke){var Be=typeof L;(Be==="undefined"||Be==="boolean")&&(L=null);var gt=!1;if(L===null)gt=!0;else switch(Be){case"bigint":case"string":case"number":gt=!0;break;case"object":switch(L.$$typeof){case n:case e:gt=!0;break;case _:return gt=L._init,B(gt(L._payload),ae,De,Pe,Ke)}}if(gt)return Ke=Ke(L),gt=Pe===""?"."+Ue(L,0):Pe,Me(Ke)?(De="",gt!=null&&(De=gt.replace(D,"$&/")+"/"),B(Ke,ae,De,"",function(Zt){return Zt})):Ke!=null&&(I(Ke)&&(Ke=O(Ke,De+(Ke.key==null||L&&L.key===Ke.key?"":(""+Ke.key).replace(D,"$&/")+"/")+gt)),ae.push(Ke)),1;gt=0;var Nt=Pe===""?".":Pe+":";if(Me(L))for(var ct=0;ct<L.length;ct++)Pe=L[ct],Be=Nt+Ue(Pe,ct),gt+=B(Pe,ae,De,Be,Ke);else if(ct=V(L),typeof ct=="function")for(L=ct.call(L),ct=0;!(Pe=L.next()).done;)Pe=Pe.value,Be=Nt+Ue(Pe,ct++),gt+=B(Pe,ae,De,Be,Ke);else if(Be==="object"){if(typeof L.then=="function")return B(lt(L),ae,De,Pe,Ke);throw ae=String(L),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return gt}function re(L,ae,De){if(L==null)return L;var Pe=[],Ke=0;return B(L,Pe,"","",function(Be){return ae.call(De,Be,Ke++)}),Pe}function Te(L){if(L._status===-1){var ae=L._result;ae=ae(),ae.then(function(De){(L._status===0||L._status===-1)&&(L._status=1,L._result=De)},function(De){(L._status===0||L._status===-1)&&(L._status=2,L._result=De)}),L._status===-1&&(L._status=0,L._result=ae)}if(L._status===1)return L._result.default;throw L._result}var Ve=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},ee={map:re,forEach:function(L,ae,De){re(L,function(){ae.apply(this,arguments)},De)},count:function(L){var ae=0;return re(L,function(){ae++}),ae},toArray:function(L){return re(L,function(ae){return ae})||[]},only:function(L){if(!I(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Xt.Activity=x,Xt.Children=ee,Xt.Component=Z,Xt.Fragment=t,Xt.Profiler=l,Xt.PureComponent=se,Xt.StrictMode=i,Xt.Suspense=g,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return C.H.useMemoCache(L)}},Xt.cache=function(L){return function(){return L.apply(null,arguments)}},Xt.cacheSignal=function(){return null},Xt.cloneElement=function(L,ae,De){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var Pe=z({},L.props),Ke=L.key;if(ae!=null)for(Be in ae.key!==void 0&&(Ke=""+ae.key),ae)!E.call(ae,Be)||Be==="key"||Be==="__self"||Be==="__source"||Be==="ref"&&ae.ref===void 0||(Pe[Be]=ae[Be]);var Be=arguments.length-2;if(Be===1)Pe.children=De;else if(1<Be){for(var gt=Array(Be),Nt=0;Nt<Be;Nt++)gt[Nt]=arguments[Nt+2];Pe.children=gt}return R(L.type,Ke,Pe)},Xt.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Xt.createElement=function(L,ae,De){var Pe,Ke={},Be=null;if(ae!=null)for(Pe in ae.key!==void 0&&(Be=""+ae.key),ae)E.call(ae,Pe)&&Pe!=="key"&&Pe!=="__self"&&Pe!=="__source"&&(Ke[Pe]=ae[Pe]);var gt=arguments.length-2;if(gt===1)Ke.children=De;else if(1<gt){for(var Nt=Array(gt),ct=0;ct<gt;ct++)Nt[ct]=arguments[ct+2];Ke.children=Nt}if(L&&L.defaultProps)for(Pe in gt=L.defaultProps,gt)Ke[Pe]===void 0&&(Ke[Pe]=gt[Pe]);return R(L,Be,Ke)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(L){return{$$typeof:p,render:L}},Xt.isValidElement=I,Xt.lazy=function(L){return{$$typeof:_,_payload:{_status:-1,_result:L},_init:Te}},Xt.memo=function(L,ae){return{$$typeof:y,type:L,compare:ae===void 0?null:ae}},Xt.startTransition=function(L){var ae=C.T,De={};C.T=De;try{var Pe=L(),Ke=C.S;Ke!==null&&Ke(De,Pe),typeof Pe=="object"&&Pe!==null&&typeof Pe.then=="function"&&Pe.then(we,Ve)}catch(Be){Ve(Be)}finally{ae!==null&&De.types!==null&&(ae.types=De.types),C.T=ae}},Xt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Xt.use=function(L){return C.H.use(L)},Xt.useActionState=function(L,ae,De){return C.H.useActionState(L,ae,De)},Xt.useCallback=function(L,ae){return C.H.useCallback(L,ae)},Xt.useContext=function(L){return C.H.useContext(L)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(L,ae){return C.H.useDeferredValue(L,ae)},Xt.useEffect=function(L,ae){return C.H.useEffect(L,ae)},Xt.useEffectEvent=function(L){return C.H.useEffectEvent(L)},Xt.useId=function(){return C.H.useId()},Xt.useImperativeHandle=function(L,ae,De){return C.H.useImperativeHandle(L,ae,De)},Xt.useInsertionEffect=function(L,ae){return C.H.useInsertionEffect(L,ae)},Xt.useLayoutEffect=function(L,ae){return C.H.useLayoutEffect(L,ae)},Xt.useMemo=function(L,ae){return C.H.useMemo(L,ae)},Xt.useOptimistic=function(L,ae){return C.H.useOptimistic(L,ae)},Xt.useReducer=function(L,ae,De){return C.H.useReducer(L,ae,De)},Xt.useRef=function(L){return C.H.useRef(L)},Xt.useState=function(L){return C.H.useState(L)},Xt.useSyncExternalStore=function(L,ae,De){return C.H.useSyncExternalStore(L,ae,De)},Xt.useTransition=function(){return C.H.useTransition()},Xt.version="19.2.4",Xt}var E1;function Lg(){return E1||(E1=1,bp.exports=jT()),bp.exports}var v=Lg(),vp={exports:{}},Kc={},xp={exports:{}},wp={};var S1;function TT(){return S1||(S1=1,(function(n){function e(B,re){var Te=B.length;B.push(re);e:for(;0<Te;){var Ve=Te-1>>>1,ee=B[Ve];if(0<l(ee,re))B[Ve]=re,B[Te]=ee,Te=Ve;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var re=B[0],Te=B.pop();if(Te!==re){B[0]=Te;e:for(var Ve=0,ee=B.length,L=ee>>>1;Ve<L;){var ae=2*(Ve+1)-1,De=B[ae],Pe=ae+1,Ke=B[Pe];if(0>l(De,Te))Pe<ee&&0>l(Ke,De)?(B[Ve]=Ke,B[Pe]=Te,Ve=Pe):(B[Ve]=De,B[ae]=Te,Ve=ae);else if(Pe<ee&&0>l(Ke,Te))B[Ve]=Ke,B[Pe]=Te,Ve=Pe;else break e}}return re}function l(B,re){var Te=B.sortIndex-re.sortIndex;return Te!==0?Te:B.id-re.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],_=1,x=null,T=3,V=!1,W=!1,z=!1,U=!1,Z=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;function he(B){for(var re=t(y);re!==null;){if(re.callback===null)i(y);else if(re.startTime<=B)i(y),re.sortIndex=re.expirationTime,e(g,re);else break;re=t(y)}}function Me(B){if(z=!1,he(B),!W)if(t(g)!==null)W=!0,we||(we=!0,H());else{var re=t(y);re!==null&&lt(Me,re.startTime-B)}}var we=!1,C=-1,E=5,R=-1;function O(){return U?!0:!(n.unstable_now()-R<E)}function I(){if(U=!1,we){var B=n.unstable_now();R=B;var re=!0;try{e:{W=!1,z&&(z=!1,K(C),C=-1),V=!0;var Te=T;try{t:{for(he(B),x=t(g);x!==null&&!(x.expirationTime>B&&O());){var Ve=x.callback;if(typeof Ve=="function"){x.callback=null,T=x.priorityLevel;var ee=Ve(x.expirationTime<=B);if(B=n.unstable_now(),typeof ee=="function"){x.callback=ee,he(B),re=!0;break t}x===t(g)&&i(g),he(B)}else i(g);x=t(g)}if(x!==null)re=!0;else{var L=t(y);L!==null&&lt(Me,L.startTime-B),re=!1}}break e}finally{x=null,T=Te,V=!1}re=void 0}}finally{re?H():we=!1}}}var H;if(typeof se=="function")H=function(){se(I)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,Ue=D.port2;D.port1.onmessage=I,H=function(){Ue.postMessage(null)}}else H=function(){Z(I,0)};function lt(B,re){C=Z(function(){B(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(B){switch(T){case 1:case 2:case 3:var re=3;break;default:re=T}var Te=T;T=re;try{return B()}finally{T=Te}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function(B,re){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Te=T;T=B;try{return re()}finally{T=Te}},n.unstable_scheduleCallback=function(B,re,Te){var Ve=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Ve+Te:Ve):Te=Ve,B){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Te+ee,B={id:_++,callback:re,priorityLevel:B,startTime:Te,expirationTime:ee,sortIndex:-1},Te>Ve?(B.sortIndex=Te,e(y,B),t(g)===null&&B===t(y)&&(z?(K(C),C=-1):z=!0,lt(Me,Te-Ve))):(B.sortIndex=ee,e(g,B),W||V||(W=!0,we||(we=!0,H()))),B},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(B){var re=T;return function(){var Te=T;T=re;try{return B.apply(this,arguments)}finally{T=Te}}}})(wp)),wp}var N1;function ET(){return N1||(N1=1,xp.exports=TT()),xp.exports}var _p={exports:{}},hr={};var C1;function ST(){if(C1)return hr;C1=1;var n=Lg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,_){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:x==null?null:""+x,children:g,containerInfo:y,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return hr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,hr.createPortal=function(g,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,_)},hr.flushSync=function(g){var y=d.T,_=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=_,i.d.f()}},hr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},hr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},hr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var _=y.as,x=p(_,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,V=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;_==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:x,integrity:T,fetchPriority:V}):_==="script"&&i.d.X(g,{crossOrigin:x,integrity:T,fetchPriority:V,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},hr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var _=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},hr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var _=y.as,x=p(_,y.crossOrigin);i.d.L(g,_,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},hr.preloadModule=function(g,y){if(typeof g=="string")if(y){var _=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},hr.requestFormReset=function(g){i.d.r(g)},hr.unstable_batchedUpdates=function(g,y){return g(y)},hr.useFormState=function(g,y,_){return d.H.useFormState(g,y,_)},hr.useFormStatus=function(){return d.H.useHostTransitionStatus()},hr.version="19.2.4",hr}var R1;function NT(){if(R1)return _p.exports;R1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_p.exports=ST(),_p.exports}var A1;function CT(){if(A1)return Kc;A1=1;var n=ET(),e=Lg(),t=NT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,S=m.child;S;){if(S===o){w=!0,o=m,c=f;break}if(S===c){w=!0,c=m,o=f;break}S=S.sibling}if(!w){for(S=f.child;S;){if(S===o){w=!0,o=f,c=m;break}if(S===c){w=!0,c=f,o=m;break}S=S.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function _(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=_(s),a!==null)return a;s=s.sibling}return null}var x=Object.assign,T=Symbol.for("react.element"),V=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),se=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function Ue(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case z:return"Fragment";case Z:return"Profiler";case U:return"StrictMode";case Me:return"Suspense";case we:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case W:return"Portal";case se:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case he:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:Ue(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return Ue(s(a))}catch{}}return null}var lt=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Ve=[],ee=-1;function L(s){return{current:s}}function ae(s){0>ee||(s.current=Ve[ee],Ve[ee]=null,ee--)}function De(s,a){ee++,Ve[ee]=s.current,s.current=a}var Pe=L(null),Ke=L(null),Be=L(null),gt=L(null);function Nt(s,a){switch(De(Be,a),De(Ke,s),De(Pe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Wv(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Wv(a),s=Gv(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ae(Pe),De(Pe,s)}function ct(){ae(Pe),ae(Ke),ae(Be)}function Zt(s){s.memoizedState!==null&&De(gt,s);var a=Pe.current,o=Gv(a,s.type);a!==o&&(De(Ke,s),De(Pe,o))}function Vs(s){Ke.current===s&&(ae(Pe),ae(Ke)),gt.current===s&&(ae(gt),qc._currentValue=Te)}var ft,ht;function ce(s){if(ft===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);ft=a&&a[1]||"",ht=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ft+s+ht}var os=!1;function Yt(s,a){if(!s||os)return"";os=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(ye){var ue=ye}Reflect.construct(s,[],Ie)}else{try{Ie.call()}catch(ye){ue=ye}s.call(Ie.prototype)}}else{try{throw Error()}catch(ye){ue=ye}(Ie=s())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(ye){if(ye&&ue&&typeof ye.stack=="string")return[ye.stack,ue.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],S=f[1];if(w&&S){var q=w.split(`
`),le=S.split(`
`);for(m=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(c===q.length||m===le.length)for(c=q.length-1,m=le.length-1;1<=c&&0<=m&&q[c]!==le[m];)m--;for(;1<=c&&0<=m;c--,m--)if(q[c]!==le[m]){if(c!==1||m!==1)do if(c--,m--,0>m||q[c]!==le[m]){var je=`
`+q[c].replace(" at new "," at ");return s.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",s.displayName)),je}while(1<=c&&0<=m);break}}}finally{os=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ce(o):""}function Ct(s,a){switch(s.tag){case 26:case 27:case 5:return ce(s.type);case 16:return ce("Lazy");case 13:return s.child!==a&&a!==null?ce("Suspense Fallback"):ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return Yt(s.type,!1);case 11:return Yt(s.type.render,!1);case 1:return Yt(s.type,!0);case 31:return ce("Activity");default:return""}}function yt(s){try{var a="",o=null;do a+=Ct(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var st=Object.prototype.hasOwnProperty,He=n.unstable_scheduleCallback,zt=n.unstable_cancelCallback,Ns=n.unstable_shouldYield,$s=n.unstable_requestPaint,Dt=n.unstable_now,Tt=n.unstable_getCurrentPriorityLevel,rs=n.unstable_ImmediatePriority,As=n.unstable_UserBlockingPriority,Ut=n.unstable_NormalPriority,Xs=n.unstable_LowPriority,Pt=n.unstable_IdlePriority,fs=n.log,qt=n.unstable_setDisableYieldValue,ve=null,G=null;function de(s){if(typeof fs=="function"&&qt(s),G&&typeof G.setStrictMode=="function")try{G.setStrictMode(ve,s)}catch{}}var Ee=Math.clz32?Math.clz32:Ye,Le=Math.log,_e=Math.LN2;function Ye(s){return s>>>=0,s===0?32:31-(Le(s)/_e|0)|0}var at=256,Y=262144,ne=4194304;function $e(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function We(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=$e(c):(w&=S,w!==0?m=$e(w):o||(o=S&~s,o!==0&&(m=$e(o))))):(S=c&~f,S!==0?m=$e(S):w!==0?m=$e(w):o||(o=c&~s,o!==0&&(m=$e(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function rt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function pt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vt(){var s=ne;return ne<<=1,(ne&62914560)===0&&(ne=4194304),s}function Rt(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function _s(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ws(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,q=s.expirationTimes,le=s.hiddenUpdates;for(o=w&~o;0<o;){var je=31-Ee(o),Ie=1<<je;S[je]=0,q[je]=-1;var ue=le[je];if(ue!==null)for(le[je]=null,je=0;je<ue.length;je++){var ye=ue[je];ye!==null&&(ye.lane&=-536870913)}o&=~Ie}c!==0&&as(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function as(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Ee(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function ks(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Ee(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Bs(s,a){var o=a&-a;return o=(o&42)!==0?1:$(o),(o&(s.suspendedLanes|a))!==0?0:o}function $(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ce(){var s=re.p;return s!==0?s:(s=window.event,s===void 0?32:g1(s.type))}function Se(s,a){var o=re.p;try{return re.p=s,a()}finally{re.p=o}}var ke=Math.random().toString(36).slice(2),ot="__reactFiber$"+ke,bt="__reactProps$"+ke,Je="__reactContainer$"+ke,_t="__reactEvents$"+ke,jt="__reactListeners$"+ke,Cs="__reactHandles$"+ke,un="__reactResources$"+ke,fn="__reactMarker$"+ke;function kn(s){delete s[ot],delete s[bt],delete s[_t],delete s[jt],delete s[Cs]}function Mn(s){var a=s[ot];if(a)return a;for(var o=s.parentNode;o;){if(a=o[Je]||o[ot]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=e1(s);s!==null;){if(o=s[ot])return o;s=e1(s)}return a}s=o,o=s.parentNode}return null}function pn(s){if(s=s[ot]||s[Je]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Fs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function j(s){var a=s[un];return a||(a=s[un]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function N(s){s[fn]=!0}var P=new Set,F={};function me(s,a){Fe(s,a),Fe(s+"Capture",a)}function Fe(s,a){for(F[s]=a,s=0;s<a.length;s++)P.add(a[s])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},Ze={};function es(s){return st.call(Ze,s)?!0:st.call(tt,s)?!1:ze.test(s)?Ze[s]=!0:(tt[s]=!0,!1)}function js(s,a,o){if(es(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function cs(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function ls(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function zs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function jn(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function or(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function us(s){if(!s._valueTracker){var a=jn(s)?"checked":"value";s._valueTracker=or(s,a,""+s[a])}}function Qr(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=jn(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function In(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var X=/[\n"\\]/g;function be(s){return s.replace(X,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ge(s,a,o,c,m,f,w,S){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+zs(a)):s.value!==""+zs(a)&&(s.value=""+zs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Qe(s,w,zs(a)):o!=null?Qe(s,w,zs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+zs(S):s.removeAttribute("name")}function Xe(s,a,o,c,m,f,w,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){us(s);return}o=o!=null?""+zs(o):"",a=a!=null?""+zs(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),us(s)}function Qe(s,a,o){a==="number"&&In(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ut(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+zs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Ht(s,a,o){if(a!=null&&(a=""+zs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+zs(o):""}function $t(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(lt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=zs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),us(s)}function Vt(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Tn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Tn.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Ps(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&At(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&At(s,f,a[f])}function gn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var En=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yr(s){return Fn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Qt(){}var Js=null;function dn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var $n=null,Wn=null;function Sn(s){var a=pn(s);if(a&&(s=a.stateNode)){var o=s[bt]||null;e:switch(s=a.stateNode,a.type){case"input":if(ge(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+be(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[bt]||null;if(!m)throw Error(i(90));ge(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Qr(c)}break e;case"textarea":Ht(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ut(s,!!o.multiple,a,!1)}}}var Gn=!1;function lr(s,a,o){if(Gn)return s(a,o);Gn=!0;try{var c=s(a);return c}finally{if(Gn=!1,($n!==null||Wn!==null)&&(Md(),$n&&(a=$n,s=Wn,Wn=$n=null,Sn(a),s)))for(a=0;a<s.length;a++)Sn(s[a])}}function cr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[bt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var M=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J=!1;if(M)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){J=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{J=!1}var et=null,kt=null,It=null;function it(){if(It)return It;var s,a=kt,o=a.length,c,m="value"in et?et.value:et.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return It=m.slice(s,1<c?1-c:void 0)}function Ft(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Gt(){return!0}function is(){return!1}function Wt(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Gt:is,this.isPropagationStopped=is,this}return x(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),a}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kn=Wt(xs),br=x({},xs,{view:0,detail:0}),sn=Wt(br),Zs,Yn,hn,zn=x({},br,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hn&&(hn&&s.type==="mousemove"?(Zs=s.screenX-hn.screenX,Yn=s.screenY-hn.screenY):Yn=Zs=0,hn=s),Zs)},movementY:function(s){return"movementY"in s?s.movementY:Yn}}),ur=Wt(zn),Zn=x({},zn,{dataTransfer:0}),vr=Wt(Zn),dr=x({},br,{relatedTarget:0}),yn=Wt(dr),xr=x({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ar=Wt(xr),Wa=x({},xs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),sl=Wt(Wa),nl=x({},xs,{data:0}),wr=Wt(nl),ca={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ua={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ku(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Gu[s])?!!a[s]:!1}function _i(){return Ku}var _r=x({},br,{key:function(s){if(s.key){var a=ca[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Ft(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ua[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Ft(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ft(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yu=Wt(_r),Qu=x({},zn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ga=Wt(Qu),h=x({},br,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),b=Wt(h),k=x({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Wt(k),ie=x({},zn,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=Wt(ie),Ge=x({},xs,{newState:0,oldState:0}),ts=Wt(Ge),Nn=[9,13,27,32],Ls=M&&"CompositionEvent"in window,on=null;M&&"documentMode"in document&&(on=document.documentMode);var Xr=M&&"TextEvent"in window&&!on,Na=M&&(!Ls||on&&8<on&&11>=on),da=" ",ha=!1;function bo(s,a){switch(s){case"keyup":return Nn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var al=!1;function Wk(s,a){switch(s){case"compositionend":return rl(a);case"keypress":return a.which!==32?null:(ha=!0,da);case"textInput":return s=a.data,s===da&&ha?null:s;default:return null}}function Gk(s,a){if(al)return s==="compositionend"||!Ls&&bo(s,a)?(s=it(),It=kt=et=null,al=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Na&&a.locale!=="ko"?null:a.data;default:return null}}var Kk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Kk[s.type]:a==="textarea"}function rb(s,a,o,c){$n?Wn?Wn.push(c):Wn=[c]:$n=c,a=Bd(a,"onChange"),0<a.length&&(o=new Kn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var dc=null,hc=null;function Yk(s){Uv(s,0)}function Xu(s){var a=Fs(s);if(Qr(a))return s}function ab(s,a){if(s==="change")return a}var ib=!1;if(M){var km;if(M){var jm="oninput"in document;if(!jm){var ob=document.createElement("div");ob.setAttribute("oninput","return;"),jm=typeof ob.oninput=="function"}km=jm}else km=!1;ib=km&&(!document.documentMode||9<document.documentMode)}function lb(){dc&&(dc.detachEvent("onpropertychange",cb),hc=dc=null)}function cb(s){if(s.propertyName==="value"&&Xu(hc)){var a=[];rb(a,hc,s,dn(s)),lr(Yk,a)}}function Qk(s,a,o){s==="focusin"?(lb(),dc=a,hc=o,dc.attachEvent("onpropertychange",cb)):s==="focusout"&&lb()}function Xk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(hc)}function Jk(s,a){if(s==="click")return Xu(a)}function Zk(s,a){if(s==="input"||s==="change")return Xu(a)}function ej(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Ur=typeof Object.is=="function"?Object.is:ej;function mc(s,a){if(Ur(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!st.call(a,m)||!Ur(s[m],a[m]))return!1}return!0}function ub(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function db(s,a){var o=ub(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ub(o)}}function hb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?hb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function mb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=In(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=In(s.document)}return a}function Tm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var tj=M&&"documentMode"in document&&11>=document.documentMode,il=null,Em=null,fc=null,Sm=!1;function fb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Sm||il==null||il!==In(c)||(c=il,"selectionStart"in c&&Tm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),fc&&mc(fc,c)||(fc=c,c=Bd(Em,"onSelect"),0<c.length&&(a=new Kn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=il)))}function vo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ol={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Nm={},pb={};M&&(pb=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function xo(s){if(Nm[s])return Nm[s];if(!ol[s])return s;var a=ol[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in pb)return Nm[s]=a[o];return s}var gb=xo("animationend"),yb=xo("animationiteration"),bb=xo("animationstart"),sj=xo("transitionrun"),nj=xo("transitionstart"),rj=xo("transitioncancel"),vb=xo("transitionend"),xb=new Map,Cm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cm.push("scrollEnd");function ma(s,a){xb.set(s,a),me(a,[s])}var Ju=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Jr=[],ll=0,Rm=0;function Zu(){for(var s=ll,a=Rm=ll=0;a<s;){var o=Jr[a];Jr[a++]=null;var c=Jr[a];Jr[a++]=null;var m=Jr[a];Jr[a++]=null;var f=Jr[a];if(Jr[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&wb(o,m,f)}}function ed(s,a,o,c){Jr[ll++]=s,Jr[ll++]=a,Jr[ll++]=o,Jr[ll++]=c,Rm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Am(s,a,o,c){return ed(s,a,o,c),td(s)}function wo(s,a){return ed(s,null,null,a),td(s)}function wb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Ee(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function td(s){if(50<Lc)throw Lc=0,Ff=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var cl={};function aj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(s,a,o,c){return new aj(s,a,o,c)}function Mm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ka(s,a){var o=s.alternate;return o===null?(o=Fr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function _b(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function sd(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Mm(s)&&(w=1);else if(typeof s=="string")w=uT(s,o,Pe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Fr(31,o,a,m),s.elementType=R,s.lanes=f,s;case z:return _o(o.children,m,f,a);case U:w=8,m|=24;break;case Z:return s=Fr(12,o,a,m|2),s.elementType=Z,s.lanes=f,s;case Me:return s=Fr(13,o,a,m),s.elementType=Me,s.lanes=f,s;case we:return s=Fr(19,o,a,m),s.elementType=we,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case se:w=10;break e;case K:w=9;break e;case he:w=11;break e;case C:w=14;break e;case E:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Fr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function _o(s,a,o,c){return s=Fr(7,s,c,a),s.lanes=o,s}function Im(s,a,o){return s=Fr(6,s,null,a),s.lanes=o,s}function kb(s){var a=Fr(18,null,null,0);return a.stateNode=s,a}function Dm(s,a,o){return a=Fr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var jb=new WeakMap;function Zr(s,a){if(typeof s=="object"&&s!==null){var o=jb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:yt(a)},jb.set(s,a),a)}return{value:s,source:a,stack:yt(a)}}var ul=[],dl=0,nd=null,pc=0,ea=[],ta=0,ki=null,Ca=1,Ra="";function Ya(s,a){ul[dl++]=pc,ul[dl++]=nd,nd=s,pc=a}function Tb(s,a,o){ea[ta++]=Ca,ea[ta++]=Ra,ea[ta++]=ki,ki=s;var c=Ca;s=Ra;var m=32-Ee(c)-1;c&=~(1<<m),o+=1;var f=32-Ee(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Ca=1<<32-Ee(a)+m|o<<m|c,Ra=f+s}else Ca=1<<f|o<<m|c,Ra=s}function Pm(s){s.return!==null&&(Ya(s,1),Tb(s,1,0))}function Lm(s){for(;s===nd;)nd=ul[--dl],ul[dl]=null,pc=ul[--dl],ul[dl]=null;for(;s===ki;)ki=ea[--ta],ea[ta]=null,Ra=ea[--ta],ea[ta]=null,Ca=ea[--ta],ea[ta]=null}function Eb(s,a){ea[ta++]=Ca,ea[ta++]=Ra,ea[ta++]=ki,Ca=a.id,Ra=a.overflow,ki=s}var er=null,rn=null,ws=!1,ji=null,sa=!1,Om=Error(i(519));function Ti(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gc(Zr(a,s)),Om}function Sb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[ot]=s,a[bt]=c,o){case"dialog":hs("cancel",a),hs("close",a);break;case"iframe":case"object":case"embed":hs("load",a);break;case"video":case"audio":for(o=0;o<Vc.length;o++)hs(Vc[o],a);break;case"source":hs("error",a);break;case"img":case"image":case"link":hs("error",a),hs("load",a);break;case"details":hs("toggle",a);break;case"input":hs("invalid",a),Xe(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":hs("invalid",a);break;case"textarea":hs("invalid",a),$t(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||Hv(a.textContent,o)?(c.popover!=null&&(hs("beforetoggle",a),hs("toggle",a)),c.onScroll!=null&&hs("scroll",a),c.onScrollEnd!=null&&hs("scrollend",a),c.onClick!=null&&(a.onclick=Qt),a=!0):a=!1,a||Ti(s,!0)}function Nb(s){for(er=s.return;er;)switch(er.tag){case 5:case 31:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:er=er.return}}function hl(s){if(s!==er)return!1;if(!ws)return Nb(s),ws=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||sp(s.type,s.memoizedProps)),o=!o),o&&rn&&Ti(s),Nb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));rn=Zv(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));rn=Zv(s)}else a===27?(a=rn,Bi(s.type)?(s=op,op=null,rn=s):rn=a):rn=er?ra(s.stateNode.nextSibling):null;return!0}function ko(){rn=er=null,ws=!1}function Vm(){var s=ji;return s!==null&&(Pr===null?Pr=s:Pr.push.apply(Pr,s),ji=null),s}function gc(s){ji===null?ji=[s]:ji.push(s)}var Bm=L(null),jo=null,Qa=null;function Ei(s,a,o){De(Bm,a._currentValue),a._currentValue=o}function Xa(s){s._currentValue=Bm.current,ae(Bm)}function Um(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Fm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var q=0;q<a.length;q++)if(S.context===a[q]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Um(f.return,o,s),c||(w=null);break e}f=S.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),Um(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function ml(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var S=m.type;Ur(m.pendingProps.value,w.value)||(s!==null?s.push(S):s=[S])}}else if(m===gt.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(qc):s=[qc])}m=m.return}s!==null&&Fm(a,s,o,c),a.flags|=262144}function rd(s){for(s=s.firstContext;s!==null;){if(!Ur(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){jo=s,Qa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function tr(s){return Cb(jo,s)}function ad(s,a){return jo===null&&To(s),Cb(s,a)}function Cb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Qa===null){if(s===null)throw Error(i(308));Qa=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Qa=Qa.next=a;return o}var ij=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},oj=n.unstable_scheduleCallback,lj=n.unstable_NormalPriority,Dn={$$typeof:se,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zm(){return{controller:new ij,data:new Map,refCount:0}}function yc(s){s.refCount--,s.refCount===0&&oj(lj,function(){s.controller.abort()})}var bc=null,qm=0,fl=0,pl=null;function cj(s,a){if(bc===null){var o=bc=[];qm=0,fl=Gf(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return qm++,a.then(Rb,Rb),a}function Rb(){if(--qm===0&&bc!==null){pl!==null&&(pl.status="fulfilled");var s=bc;bc=null,fl=0,pl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function uj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Ab=B.S;B.S=function(s,a){fv=Dt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&cj(s,a),Ab!==null&&Ab(s,a)};var Eo=L(null);function Hm(){var s=Eo.current;return s!==null?s:en.pooledCache}function id(s,a){a===null?De(Eo,Eo.current):De(Eo,a.pool)}function Mb(){var s=Hm();return s===null?null:{parent:Dn._currentValue,pool:s}}var gl=Error(i(460)),$m=Error(i(474)),od=Error(i(542)),ld={then:function(){}};function Ib(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Db(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Qt,Qt),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Lb(s),s;default:if(typeof a.status=="string")a.then(Qt,Qt);else{if(s=en,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Lb(s),s}throw No=a,gl}}function So(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(No=o,gl):o}}var No=null;function Pb(){if(No===null)throw Error(i(459));var s=No;return No=null,s}function Lb(s){if(s===gl||s===od)throw Error(i(483))}var yl=null,vc=0;function cd(s){var a=vc;return vc+=1,yl===null&&(yl=[]),Db(yl,s,a)}function xc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function ud(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Ob(s){function a(te,Q){if(s){var oe=te.deletions;oe===null?(te.deletions=[Q],te.flags|=16):oe.push(Q)}}function o(te,Q){if(!s)return null;for(;Q!==null;)a(te,Q),Q=Q.sibling;return null}function c(te){for(var Q=new Map;te!==null;)te.key!==null?Q.set(te.key,te):Q.set(te.index,te),te=te.sibling;return Q}function m(te,Q){return te=Ka(te,Q),te.index=0,te.sibling=null,te}function f(te,Q,oe){return te.index=oe,s?(oe=te.alternate,oe!==null?(oe=oe.index,oe<Q?(te.flags|=67108866,Q):oe):(te.flags|=67108866,Q)):(te.flags|=1048576,Q)}function w(te){return s&&te.alternate===null&&(te.flags|=67108866),te}function S(te,Q,oe,Ae){return Q===null||Q.tag!==6?(Q=Im(oe,te.mode,Ae),Q.return=te,Q):(Q=m(Q,oe),Q.return=te,Q)}function q(te,Q,oe,Ae){var Et=oe.type;return Et===z?je(te,Q,oe.props.children,Ae,oe.key):Q!==null&&(Q.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===E&&So(Et)===Q.type)?(Q=m(Q,oe.props),xc(Q,oe),Q.return=te,Q):(Q=sd(oe.type,oe.key,oe.props,null,te.mode,Ae),xc(Q,oe),Q.return=te,Q)}function le(te,Q,oe,Ae){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==oe.containerInfo||Q.stateNode.implementation!==oe.implementation?(Q=Dm(oe,te.mode,Ae),Q.return=te,Q):(Q=m(Q,oe.children||[]),Q.return=te,Q)}function je(te,Q,oe,Ae,Et){return Q===null||Q.tag!==7?(Q=_o(oe,te.mode,Ae,Et),Q.return=te,Q):(Q=m(Q,oe),Q.return=te,Q)}function Ie(te,Q,oe){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Im(""+Q,te.mode,oe),Q.return=te,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case V:return oe=sd(Q.type,Q.key,Q.props,null,te.mode,oe),xc(oe,Q),oe.return=te,oe;case W:return Q=Dm(Q,te.mode,oe),Q.return=te,Q;case E:return Q=So(Q),Ie(te,Q,oe)}if(lt(Q)||H(Q))return Q=_o(Q,te.mode,oe,null),Q.return=te,Q;if(typeof Q.then=="function")return Ie(te,cd(Q),oe);if(Q.$$typeof===se)return Ie(te,ad(te,Q),oe);ud(te,Q)}return null}function ue(te,Q,oe,Ae){var Et=Q!==null?Q.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Et!==null?null:S(te,Q,""+oe,Ae);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case V:return oe.key===Et?q(te,Q,oe,Ae):null;case W:return oe.key===Et?le(te,Q,oe,Ae):null;case E:return oe=So(oe),ue(te,Q,oe,Ae)}if(lt(oe)||H(oe))return Et!==null?null:je(te,Q,oe,Ae,null);if(typeof oe.then=="function")return ue(te,Q,cd(oe),Ae);if(oe.$$typeof===se)return ue(te,Q,ad(te,oe),Ae);ud(te,oe)}return null}function ye(te,Q,oe,Ae,Et){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return te=te.get(oe)||null,S(Q,te,""+Ae,Et);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case V:return te=te.get(Ae.key===null?oe:Ae.key)||null,q(Q,te,Ae,Et);case W:return te=te.get(Ae.key===null?oe:Ae.key)||null,le(Q,te,Ae,Et);case E:return Ae=So(Ae),ye(te,Q,oe,Ae,Et)}if(lt(Ae)||H(Ae))return te=te.get(oe)||null,je(Q,te,Ae,Et,null);if(typeof Ae.then=="function")return ye(te,Q,oe,cd(Ae),Et);if(Ae.$$typeof===se)return ye(te,Q,oe,ad(Q,Ae),Et);ud(Q,Ae)}return null}function mt(te,Q,oe,Ae){for(var Et=null,Ms=null,xt=Q,ns=Q=0,gs=null;xt!==null&&ns<oe.length;ns++){xt.index>ns?(gs=xt,xt=null):gs=xt.sibling;var Is=ue(te,xt,oe[ns],Ae);if(Is===null){xt===null&&(xt=gs);break}s&&xt&&Is.alternate===null&&a(te,xt),Q=f(Is,Q,ns),Ms===null?Et=Is:Ms.sibling=Is,Ms=Is,xt=gs}if(ns===oe.length)return o(te,xt),ws&&Ya(te,ns),Et;if(xt===null){for(;ns<oe.length;ns++)xt=Ie(te,oe[ns],Ae),xt!==null&&(Q=f(xt,Q,ns),Ms===null?Et=xt:Ms.sibling=xt,Ms=xt);return ws&&Ya(te,ns),Et}for(xt=c(xt);ns<oe.length;ns++)gs=ye(xt,te,ns,oe[ns],Ae),gs!==null&&(s&&gs.alternate!==null&&xt.delete(gs.key===null?ns:gs.key),Q=f(gs,Q,ns),Ms===null?Et=gs:Ms.sibling=gs,Ms=gs);return s&&xt.forEach(function(Hi){return a(te,Hi)}),ws&&Ya(te,ns),Et}function Mt(te,Q,oe,Ae){if(oe==null)throw Error(i(151));for(var Et=null,Ms=null,xt=Q,ns=Q=0,gs=null,Is=oe.next();xt!==null&&!Is.done;ns++,Is=oe.next()){xt.index>ns?(gs=xt,xt=null):gs=xt.sibling;var Hi=ue(te,xt,Is.value,Ae);if(Hi===null){xt===null&&(xt=gs);break}s&&xt&&Hi.alternate===null&&a(te,xt),Q=f(Hi,Q,ns),Ms===null?Et=Hi:Ms.sibling=Hi,Ms=Hi,xt=gs}if(Is.done)return o(te,xt),ws&&Ya(te,ns),Et;if(xt===null){for(;!Is.done;ns++,Is=oe.next())Is=Ie(te,Is.value,Ae),Is!==null&&(Q=f(Is,Q,ns),Ms===null?Et=Is:Ms.sibling=Is,Ms=Is);return ws&&Ya(te,ns),Et}for(xt=c(xt);!Is.done;ns++,Is=oe.next())Is=ye(xt,te,ns,Is.value,Ae),Is!==null&&(s&&Is.alternate!==null&&xt.delete(Is.key===null?ns:Is.key),Q=f(Is,Q,ns),Ms===null?Et=Is:Ms.sibling=Is,Ms=Is);return s&&xt.forEach(function(wT){return a(te,wT)}),ws&&Ya(te,ns),Et}function Ys(te,Q,oe,Ae){if(typeof oe=="object"&&oe!==null&&oe.type===z&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case V:e:{for(var Et=oe.key;Q!==null;){if(Q.key===Et){if(Et=oe.type,Et===z){if(Q.tag===7){o(te,Q.sibling),Ae=m(Q,oe.props.children),Ae.return=te,te=Ae;break e}}else if(Q.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===E&&So(Et)===Q.type){o(te,Q.sibling),Ae=m(Q,oe.props),xc(Ae,oe),Ae.return=te,te=Ae;break e}o(te,Q);break}else a(te,Q);Q=Q.sibling}oe.type===z?(Ae=_o(oe.props.children,te.mode,Ae,oe.key),Ae.return=te,te=Ae):(Ae=sd(oe.type,oe.key,oe.props,null,te.mode,Ae),xc(Ae,oe),Ae.return=te,te=Ae)}return w(te);case W:e:{for(Et=oe.key;Q!==null;){if(Q.key===Et)if(Q.tag===4&&Q.stateNode.containerInfo===oe.containerInfo&&Q.stateNode.implementation===oe.implementation){o(te,Q.sibling),Ae=m(Q,oe.children||[]),Ae.return=te,te=Ae;break e}else{o(te,Q);break}else a(te,Q);Q=Q.sibling}Ae=Dm(oe,te.mode,Ae),Ae.return=te,te=Ae}return w(te);case E:return oe=So(oe),Ys(te,Q,oe,Ae)}if(lt(oe))return mt(te,Q,oe,Ae);if(H(oe)){if(Et=H(oe),typeof Et!="function")throw Error(i(150));return oe=Et.call(oe),Mt(te,Q,oe,Ae)}if(typeof oe.then=="function")return Ys(te,Q,cd(oe),Ae);if(oe.$$typeof===se)return Ys(te,Q,ad(te,oe),Ae);ud(te,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,Q!==null&&Q.tag===6?(o(te,Q.sibling),Ae=m(Q,oe),Ae.return=te,te=Ae):(o(te,Q),Ae=Im(oe,te.mode,Ae),Ae.return=te,te=Ae),w(te)):o(te,Q)}return function(te,Q,oe,Ae){try{vc=0;var Et=Ys(te,Q,oe,Ae);return yl=null,Et}catch(xt){if(xt===gl||xt===od)throw xt;var Ms=Fr(29,xt,null,te.mode);return Ms.lanes=Ae,Ms.return=te,Ms}}}var Co=Ob(!0),Vb=Ob(!1),Si=!1;function Wm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ni(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ci(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Os&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=td(s),wb(s,null,o),a}return ed(s,c,a,o),td(s)}function wc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}function Km(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Ym=!1;function _c(){if(Ym){var s=pl;if(s!==null)throw s}}function kc(s,a,o,c){Ym=!1;var m=s.updateQueue;Si=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var q=S,le=q.next;q.next=null,w===null?f=le:w.next=le,w=q;var je=s.alternate;je!==null&&(je=je.updateQueue,S=je.lastBaseUpdate,S!==w&&(S===null?je.firstBaseUpdate=le:S.next=le,je.lastBaseUpdate=q))}if(f!==null){var Ie=m.baseState;w=0,je=le=q=null,S=f;do{var ue=S.lane&-536870913,ye=ue!==S.lane;if(ye?(ps&ue)===ue:(c&ue)===ue){ue!==0&&ue===fl&&(Ym=!0),je!==null&&(je=je.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var mt=s,Mt=S;ue=a;var Ys=o;switch(Mt.tag){case 1:if(mt=Mt.payload,typeof mt=="function"){Ie=mt.call(Ys,Ie,ue);break e}Ie=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Mt.payload,ue=typeof mt=="function"?mt.call(Ys,Ie,ue):mt,ue==null)break e;Ie=x({},Ie,ue);break e;case 2:Si=!0}}ue=S.callback,ue!==null&&(s.flags|=64,ye&&(s.flags|=8192),ye=m.callbacks,ye===null?m.callbacks=[ue]:ye.push(ue))}else ye={lane:ue,tag:S.tag,payload:S.payload,callback:S.callback,next:null},je===null?(le=je=ye,q=Ie):je=je.next=ye,w|=ue;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ye=S,S=ye.next,ye.next=null,m.lastBaseUpdate=ye,m.shared.pending=null}}while(!0);je===null&&(q=Ie),m.baseState=q,m.firstBaseUpdate=le,m.lastBaseUpdate=je,f===null&&(m.shared.lanes=0),Di|=w,s.lanes=w,s.memoizedState=Ie}}function Bb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Ub(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Bb(o[s],a)}var bl=L(null),dd=L(0);function Fb(s,a){s=ii,De(dd,s),De(bl,a),ii=s|a.baseLanes}function Qm(){De(dd,ii),De(bl,bl.current)}function Xm(){ii=dd.current,ae(bl),ae(dd)}var zr=L(null),na=null;function Ri(s){var a=s.alternate;De(Cn,Cn.current&1),De(zr,s),na===null&&(a===null||bl.current!==null||a.memoizedState!==null)&&(na=s)}function Jm(s){De(Cn,Cn.current),De(zr,s),na===null&&(na=s)}function zb(s){s.tag===22?(De(Cn,Cn.current),De(zr,s),na===null&&(na=s)):Ai()}function Ai(){De(Cn,Cn.current),De(zr,zr.current)}function qr(s){ae(zr),na===s&&(na=null),ae(Cn)}var Cn=L(0);function hd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ap(o)||ip(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ja=0,ss=null,Gs=null,Pn=null,md=!1,vl=!1,Ro=!1,fd=0,jc=0,xl=null,dj=0;function bn(){throw Error(i(321))}function Zm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Ur(s[o],a[o]))return!1;return!0}function ef(s,a,o,c,m,f){return Ja=f,ss=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,B.H=s===null||s.memoizedState===null?T0:gf,Ro=!1,f=o(c,m),Ro=!1,vl&&(f=Hb(a,o,c,m)),qb(s),f}function qb(s){B.H=Sc;var a=Gs!==null&&Gs.next!==null;if(Ja=0,Pn=Gs=ss=null,md=!1,jc=0,xl=null,a)throw Error(i(300));s===null||Ln||(s=s.dependencies,s!==null&&rd(s)&&(Ln=!0))}function Hb(s,a,o,c){ss=s;var m=0;do{if(vl&&(xl=null),jc=0,vl=!1,25<=m)throw Error(i(301));if(m+=1,Pn=Gs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}B.H=E0,f=a(o,c)}while(vl);return f}function hj(){var s=B.H,a=s.useState()[0];return a=typeof a.then=="function"?Tc(a):a,s=s.useState()[0],(Gs!==null?Gs.memoizedState:null)!==s&&(ss.flags|=1024),a}function tf(){var s=fd!==0;return fd=0,s}function sf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function nf(s){if(md){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}md=!1}Ja=0,Pn=Gs=ss=null,vl=!1,jc=fd=0,xl=null}function kr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?ss.memoizedState=Pn=s:Pn=Pn.next=s,Pn}function Rn(){if(Gs===null){var s=ss.alternate;s=s!==null?s.memoizedState:null}else s=Gs.next;var a=Pn===null?ss.memoizedState:Pn.next;if(a!==null)Pn=a,Gs=s;else{if(s===null)throw ss.alternate===null?Error(i(467)):Error(i(310));Gs=s,s={memoizedState:Gs.memoizedState,baseState:Gs.baseState,baseQueue:Gs.baseQueue,queue:Gs.queue,next:null},Pn===null?ss.memoizedState=Pn=s:Pn=Pn.next=s}return Pn}function pd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(s){var a=jc;return jc+=1,xl===null&&(xl=[]),s=Db(xl,s,a),a=ss,(Pn===null?a.memoizedState:Pn.next)===null&&(a=a.alternate,B.H=a===null||a.memoizedState===null?T0:gf),s}function gd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tc(s);if(s.$$typeof===se)return tr(s)}throw Error(i(438,String(s)))}function rf(s){var a=null,o=ss.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=ss.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=pd(),ss.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=O;return a.index++,o}function Za(s,a){return typeof a=="function"?a(s):a}function yd(s){var a=Rn();return af(a,Gs,s)}function af(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=w=null,q=null,le=a,je=!1;do{var Ie=le.lane&-536870913;if(Ie!==le.lane?(ps&Ie)===Ie:(Ja&Ie)===Ie){var ue=le.revertLane;if(ue===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Ie===fl&&(je=!0);else if((Ja&ue)===ue){le=le.next,ue===fl&&(je=!0);continue}else Ie={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},q===null?(S=q=Ie,w=f):q=q.next=Ie,ss.lanes|=ue,Di|=ue;Ie=le.action,Ro&&o(f,Ie),f=le.hasEagerState?le.eagerState:o(f,Ie)}else ue={lane:Ie,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},q===null?(S=q=ue,w=f):q=q.next=ue,ss.lanes|=Ie,Di|=Ie;le=le.next}while(le!==null&&le!==a);if(q===null?w=f:q.next=S,!Ur(f,s.memoizedState)&&(Ln=!0,je&&(o=pl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=q,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function of(s){var a=Rn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);Ur(f,a.memoizedState)||(Ln=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function $b(s,a,o){var c=ss,m=Rn(),f=ws;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!Ur((Gs||m).memoizedState,o);if(w&&(m.memoizedState=o,Ln=!0),m=m.queue,uf(Kb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Pn!==null&&Pn.memoizedState.tag&1){if(c.flags|=2048,wl(9,{destroy:void 0},Gb.bind(null,c,m,o,a),null),en===null)throw Error(i(349));f||(Ja&127)!==0||Wb(c,a,o)}return o}function Wb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=ss.updateQueue,a===null?(a=pd(),ss.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Gb(s,a,o,c){a.value=o,a.getSnapshot=c,Yb(a)&&Qb(s)}function Kb(s,a,o){return o(function(){Yb(a)&&Qb(s)})}function Yb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Ur(s,o)}catch{return!0}}function Qb(s){var a=wo(s,2);a!==null&&Lr(a,s,2)}function lf(s){var a=kr();if(typeof s=="function"){var o=s;if(s=o(),Ro){de(!0);try{o()}finally{de(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:s},a}function Xb(s,a,o,c){return s.baseState=o,af(s,Gs,typeof c=="function"?c:Za)}function mj(s,a,o,c,m){if(xd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};B.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Jb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Jb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=B.T,w={};B.T=w;try{var S=o(m,c),q=B.S;q!==null&&q(w,S),Zb(s,a,S)}catch(le){cf(s,a,le)}finally{f!==null&&w.types!==null&&(f.types=w.types),B.T=f}}else try{f=o(m,c),Zb(s,a,f)}catch(le){cf(s,a,le)}}function Zb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){e0(s,a,c)},function(c){return cf(s,a,c)}):e0(s,a,o)}function e0(s,a,o){a.status="fulfilled",a.value=o,t0(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Jb(s,o)))}function cf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,t0(a),a=a.next;while(a!==c)}s.action=null}function t0(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function s0(s,a){return a}function n0(s,a){if(ws){var o=en.formState;if(o!==null){e:{var c=ss;if(ws){if(rn){t:{for(var m=rn,f=sa;m.nodeType!==8;){if(!f){m=null;break t}if(m=ra(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){rn=ra(m.nextSibling),c=m.data==="F!";break e}}Ti(c)}c=!1}c&&(a=o[0])}}return o=kr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s0,lastRenderedState:a},o.queue=c,o=_0.bind(null,ss,c),c.dispatch=o,c=lf(!1),f=pf.bind(null,ss,!1,c.queue),c=kr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=mj.bind(null,ss,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function r0(s){var a=Rn();return a0(a,Gs,s)}function a0(s,a,o){if(a=af(s,a,s0)[0],s=yd(Za)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Tc(a)}catch(w){throw w===gl?od:w}else c=a;a=Rn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(ss.flags|=2048,wl(9,{destroy:void 0},fj.bind(null,m,o),null)),[c,f,s]}function fj(s,a){s.action=a}function i0(s){var a=Rn(),o=Gs;if(o!==null)return a0(a,o,s);Rn(),a=a.memoizedState,o=Rn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function wl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=ss.updateQueue,a===null&&(a=pd(),ss.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function o0(){return Rn().memoizedState}function bd(s,a,o,c){var m=kr();ss.flags|=s,m.memoizedState=wl(1|a,{destroy:void 0},o,c===void 0?null:c)}function vd(s,a,o,c){var m=Rn();c=c===void 0?null:c;var f=m.memoizedState.inst;Gs!==null&&c!==null&&Zm(c,Gs.memoizedState.deps)?m.memoizedState=wl(a,f,o,c):(ss.flags|=s,m.memoizedState=wl(1|a,f,o,c))}function l0(s,a){bd(8390656,8,s,a)}function uf(s,a){vd(2048,8,s,a)}function pj(s){ss.flags|=4;var a=ss.updateQueue;if(a===null)a=pd(),ss.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function c0(s){var a=Rn().memoizedState;return pj({ref:a,nextImpl:s}),function(){if((Os&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function u0(s,a){return vd(4,2,s,a)}function d0(s,a){return vd(4,4,s,a)}function h0(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function m0(s,a,o){o=o!=null?o.concat([s]):null,vd(4,4,h0.bind(null,a,s),o)}function df(){}function f0(s,a){var o=Rn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Zm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function p0(s,a){var o=Rn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Zm(a,c[1]))return c[0];if(c=s(),Ro){de(!0);try{s()}finally{de(!1)}}return o.memoizedState=[c,a],c}function hf(s,a,o){return o===void 0||(Ja&1073741824)!==0&&(ps&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=gv(),ss.lanes|=s,Di|=s,o)}function g0(s,a,o,c){return Ur(o,a)?o:bl.current!==null?(s=hf(s,o,c),Ur(s,a)||(Ln=!0),s):(Ja&42)===0||(Ja&1073741824)!==0&&(ps&261930)===0?(Ln=!0,s.memoizedState=o):(s=gv(),ss.lanes|=s,Di|=s,a)}function y0(s,a,o,c,m){var f=re.p;re.p=f!==0&&8>f?f:8;var w=B.T,S={};B.T=S,pf(s,!1,a,o);try{var q=m(),le=B.S;if(le!==null&&le(S,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var je=uj(q,c);Ec(s,a,je,Wr(s))}else Ec(s,a,c,Wr(s))}catch(Ie){Ec(s,a,{then:function(){},status:"rejected",reason:Ie},Wr())}finally{re.p=f,w!==null&&S.types!==null&&(w.types=S.types),B.T=w}}function gj(){}function mf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=b0(s).queue;y0(s,m,a,Te,o===null?gj:function(){return v0(s),o(c)})}function b0(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:Te},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function v0(s){var a=b0(s);a.next===null&&(a=s.alternate.memoizedState),Ec(s,a.next.queue,{},Wr())}function ff(){return tr(qc)}function x0(){return Rn().memoizedState}function w0(){return Rn().memoizedState}function yj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Wr();s=Ni(o);var c=Ci(a,s,o);c!==null&&(Lr(c,a,o),wc(c,a,o)),a={cache:zm()},s.payload=a;return}a=a.return}}function bj(s,a,o){var c=Wr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xd(s)?k0(a,o):(o=Am(s,a,o,c),o!==null&&(Lr(o,s,c),j0(o,a,c)))}function _0(s,a,o){var c=Wr();Ec(s,a,o,c)}function Ec(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xd(s))k0(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,S=f(w,o);if(m.hasEagerState=!0,m.eagerState=S,Ur(S,w))return ed(s,a,m,0),en===null&&Zu(),!1}catch{}if(o=Am(s,a,m,c),o!==null)return Lr(o,s,c),j0(o,a,c),!0}return!1}function pf(s,a,o,c){if(c={lane:2,revertLane:Gf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xd(s)){if(a)throw Error(i(479))}else a=Am(s,o,c,2),a!==null&&Lr(a,s,2)}function xd(s){var a=s.alternate;return s===ss||a!==null&&a===ss}function k0(s,a){vl=md=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function j0(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}var Sc={readContext:tr,use:gd,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};Sc.useEffectEvent=bn;var T0={readContext:tr,use:gd,useCallback:function(s,a){return kr().memoizedState=[s,a===void 0?null:a],s},useContext:tr,useEffect:l0,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,bd(4194308,4,h0.bind(null,a,s),o)},useLayoutEffect:function(s,a){return bd(4194308,4,s,a)},useInsertionEffect:function(s,a){bd(4,2,s,a)},useMemo:function(s,a){var o=kr();a=a===void 0?null:a;var c=s();if(Ro){de(!0);try{s()}finally{de(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=kr();if(o!==void 0){var m=o(a);if(Ro){de(!0);try{o(a)}finally{de(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=bj.bind(null,ss,s),[c.memoizedState,s]},useRef:function(s){var a=kr();return s={current:s},a.memoizedState=s},useState:function(s){s=lf(s);var a=s.queue,o=_0.bind(null,ss,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:df,useDeferredValue:function(s,a){var o=kr();return hf(o,s,a)},useTransition:function(){var s=lf(!1);return s=y0.bind(null,ss,s.queue,!0,!1),kr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=ss,m=kr();if(ws){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),en===null)throw Error(i(349));(ps&127)!==0||Wb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,l0(Kb.bind(null,c,f,s),[s]),c.flags|=2048,wl(9,{destroy:void 0},Gb.bind(null,c,f,o,a),null),o},useId:function(){var s=kr(),a=en.identifierPrefix;if(ws){var o=Ra,c=Ca;o=(c&~(1<<32-Ee(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=fd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=dj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:ff,useFormState:n0,useActionState:n0,useOptimistic:function(s){var a=kr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=pf.bind(null,ss,!0,o),o.dispatch=a,[s,a]},useMemoCache:rf,useCacheRefresh:function(){return kr().memoizedState=yj.bind(null,ss)},useEffectEvent:function(s){var a=kr(),o={impl:s};return a.memoizedState=o,function(){if((Os&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},gf={readContext:tr,use:gd,useCallback:f0,useContext:tr,useEffect:uf,useImperativeHandle:m0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:p0,useReducer:yd,useRef:o0,useState:function(){return yd(Za)},useDebugValue:df,useDeferredValue:function(s,a){var o=Rn();return g0(o,Gs.memoizedState,s,a)},useTransition:function(){var s=yd(Za)[0],a=Rn().memoizedState;return[typeof s=="boolean"?s:Tc(s),a]},useSyncExternalStore:$b,useId:x0,useHostTransitionStatus:ff,useFormState:r0,useActionState:r0,useOptimistic:function(s,a){var o=Rn();return Xb(o,Gs,s,a)},useMemoCache:rf,useCacheRefresh:w0};gf.useEffectEvent=c0;var E0={readContext:tr,use:gd,useCallback:f0,useContext:tr,useEffect:uf,useImperativeHandle:m0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:p0,useReducer:of,useRef:o0,useState:function(){return of(Za)},useDebugValue:df,useDeferredValue:function(s,a){var o=Rn();return Gs===null?hf(o,s,a):g0(o,Gs.memoizedState,s,a)},useTransition:function(){var s=of(Za)[0],a=Rn().memoizedState;return[typeof s=="boolean"?s:Tc(s),a]},useSyncExternalStore:$b,useId:x0,useHostTransitionStatus:ff,useFormState:i0,useActionState:i0,useOptimistic:function(s,a){var o=Rn();return Gs!==null?Xb(o,Gs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:rf,useCacheRefresh:w0};E0.useEffectEvent=c0;function yf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:x({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var bf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Wr(),m=Ni(c);m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Lr(a,s,c),wc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Wr(),m=Ni(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Lr(a,s,c),wc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Wr(),c=Ni(o);c.tag=2,a!=null&&(c.callback=a),a=Ci(s,c,o),a!==null&&(Lr(a,s,o),wc(a,s,o))}};function S0(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!mc(o,c)||!mc(m,f):!0}function N0(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&bf.enqueueReplaceState(a,a.state,null)}function Ao(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=x({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function C0(s){Ju(s)}function R0(s){console.error(s)}function A0(s){Ju(s)}function wd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function M0(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function vf(s,a,o){return o=Ni(o),o.tag=3,o.payload={element:null},o.callback=function(){wd(s,a)},o}function I0(s){return s=Ni(s),s.tag=3,s}function D0(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){M0(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){M0(a,o,c),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function vj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&ml(a,o,m,!0),o=zr.current,o!==null){switch(o.tag){case 31:case 13:return na===null?Id():o.alternate===null&&vn===0&&(vn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Hf(s,c,m)),!1;case 22:return o.flags|=65536,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Hf(s,c,m)),!1}throw Error(i(435,o.tag))}return Hf(s,c,m),Id(),!1}if(ws)return a=zr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Om&&(s=Error(i(422),{cause:c}),gc(Zr(s,o)))):(c!==Om&&(a=Error(i(423),{cause:c}),gc(Zr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Zr(c,o),m=vf(s.stateNode,c,m),Km(s,m),vn!==4&&(vn=2)),!1;var f=Error(i(520),{cause:c});if(f=Zr(f,o),Pc===null?Pc=[f]:Pc.push(f),vn!==4&&(vn=2),a===null)return!0;c=Zr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=vf(o.stateNode,c,s),Km(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=I0(m),D0(m,s,o,c),Km(o,m),!1}o=o.return}while(o!==null);return!1}var xf=Error(i(461)),Ln=!1;function sr(s,a,o,c){a.child=s===null?Vb(a,null,o,c):Co(a,s.child,o,c)}function P0(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var S in c)S!=="ref"&&(w[S]=c[S])}else w=c;return To(a),c=ef(s,a,o,w,f,m),S=tf(),s!==null&&!Ln?(sf(s,a,m),ei(s,a,m)):(ws&&S&&Pm(a),a.flags|=1,sr(s,a,c,m),a.child)}function L0(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Mm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,O0(s,a,f,c,m)):(s=sd(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Nf(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:mc,o(w,c)&&s.ref===a.ref)return ei(s,a,m)}return a.flags|=1,s=Ka(f,c),s.ref=a.ref,s.return=a,a.child=s}function O0(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(mc(f,c)&&s.ref===a.ref)if(Ln=!1,a.pendingProps=c=f,Nf(s,m))(s.flags&131072)!==0&&(Ln=!0);else return a.lanes=s.lanes,ei(s,a,m)}return wf(s,a,o,c,m)}function V0(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return B0(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(a,f!==null?f.cachePool:null),f!==null?Fb(a,f):Qm(),zb(a);else return c=a.lanes=536870912,B0(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(id(a,f.cachePool),Fb(a,f),Ai(),a.memoizedState=null):(s!==null&&id(a,null),Qm(),Ai());return sr(s,a,m,o),a.child}function Nc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function B0(s,a,o,c,m){var f=Hm();return f=f===null?null:{parent:Dn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&id(a,null),Qm(),zb(a),s!==null&&ml(s,a,c,!0),a.childLanes=m,null}function _d(s,a){return a=jd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function U0(s,a,o){return Co(a,s.child,null,o),s=_d(a,a.pendingProps),s.flags|=2,qr(a),a.memoizedState=null,s}function xj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ws){if(c.mode==="hidden")return s=_d(a,c),a.lanes=536870912,Nc(null,s);if(Jm(a),(s=rn)?(s=Jv(s,sa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Ca,overflow:Ra}:null,retryLane:536870912,hydrationErrors:null},o=kb(s),o.return=a,a.child=o,er=a,rn=null)):s=null,s===null)throw Ti(a);return a.lanes=536870912,null}return _d(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(Jm(a),m)if(a.flags&256)a.flags&=-257,a=U0(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(Ln||ml(s,a,o,!1),m=(o&s.childLanes)!==0,Ln||m){if(c=en,c!==null&&(w=Bs(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,wo(s,w),Lr(c,s,w),xf;Id(),a=U0(s,a,o)}else s=f.treeContext,rn=ra(w.nextSibling),er=a,ws=!0,ji=null,sa=!1,s!==null&&Eb(a,s),a=_d(a,c),a.flags|=4096;return a}return s=Ka(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function kd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function wf(s,a,o,c,m){return To(a),o=ef(s,a,o,c,void 0,m),c=tf(),s!==null&&!Ln?(sf(s,a,m),ei(s,a,m)):(ws&&c&&Pm(a),a.flags|=1,sr(s,a,o,m),a.child)}function F0(s,a,o,c,m,f){return To(a),a.updateQueue=null,o=Hb(a,c,o,m),qb(s),c=tf(),s!==null&&!Ln?(sf(s,a,f),ei(s,a,f)):(ws&&c&&Pm(a),a.flags|=1,sr(s,a,o,f),a.child)}function z0(s,a,o,c,m){if(To(a),a.stateNode===null){var f=cl,w=o.contextType;typeof w=="object"&&w!==null&&(f=tr(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=bf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Wm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?tr(w):cl,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(yf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&bf.enqueueReplaceState(f,f.state,null),kc(a,c,f,m),_c(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,q=Ao(o,S);f.props=q;var le=f.context,je=o.contextType;w=cl,typeof je=="object"&&je!==null&&(w=tr(je));var Ie=o.getDerivedStateFromProps;je=typeof Ie=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,je||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||le!==w)&&N0(a,f,c,w),Si=!1;var ue=a.memoizedState;f.state=ue,kc(a,c,f,m),_c(),le=a.memoizedState,S||ue!==le||Si?(typeof Ie=="function"&&(yf(a,o,Ie,c),le=a.memoizedState),(q=Si||S0(a,o,q,c,ue,le,w))?(je||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=le),f.props=c,f.state=le,f.context=w,c=q):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Gm(s,a),w=a.memoizedProps,je=Ao(o,w),f.props=je,Ie=a.pendingProps,ue=f.context,le=o.contextType,q=cl,typeof le=="object"&&le!==null&&(q=tr(le)),S=o.getDerivedStateFromProps,(le=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==Ie||ue!==q)&&N0(a,f,c,q),Si=!1,ue=a.memoizedState,f.state=ue,kc(a,c,f,m),_c();var ye=a.memoizedState;w!==Ie||ue!==ye||Si||s!==null&&s.dependencies!==null&&rd(s.dependencies)?(typeof S=="function"&&(yf(a,o,S,c),ye=a.memoizedState),(je=Si||S0(a,o,je,c,ue,ye,q)||s!==null&&s.dependencies!==null&&rd(s.dependencies))?(le||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,ye,q),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,ye,q)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ue===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ue===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ye),f.props=c,f.state=ye,f.context=q,c=je):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ue===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ue===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,kd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Co(a,s.child,null,m),a.child=Co(a,null,o,m)):sr(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ei(s,a,m),s}function q0(s,a,o,c){return ko(),a.flags|=256,sr(s,a,o,c),a.child}var _f={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kf(s){return{baseLanes:s,cachePool:Mb()}}function jf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=$r),s}function H0(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Cn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(ws){if(m?Ri(a):Ai(),(s=rn)?(s=Jv(s,sa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Ca,overflow:Ra}:null,retryLane:536870912,hydrationErrors:null},o=kb(s),o.return=a,a.child=o,er=a,rn=null)):s=null,s===null)throw Ti(a);return ip(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Ai(),m=a.mode,S=jd({mode:"hidden",children:S},m),c=_o(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=kf(o),c.childLanes=jf(s,w,o),a.memoizedState=_f,Nc(null,c)):(Ri(a),Tf(a,S))}var q=s.memoizedState;if(q!==null&&(S=q.dehydrated,S!==null)){if(f)a.flags&256?(Ri(a),a.flags&=-257,a=Ef(s,a,o)):a.memoizedState!==null?(Ai(),a.child=s.child,a.flags|=128,a=null):(Ai(),S=c.fallback,m=a.mode,c=jd({mode:"visible",children:c.children},m),S=_o(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Co(a,s.child,null,o),c=a.child,c.memoizedState=kf(o),c.childLanes=jf(s,w,o),a.memoizedState=_f,a=Nc(null,c));else if(Ri(a),ip(S)){if(w=S.nextSibling&&S.nextSibling.dataset,w)var le=w.dgst;w=le,c=Error(i(419)),c.stack="",c.digest=w,gc({value:c,source:null,stack:null}),a=Ef(s,a,o)}else if(Ln||ml(s,a,o,!1),w=(o&s.childLanes)!==0,Ln||w){if(w=en,w!==null&&(c=Bs(w,o),c!==0&&c!==q.retryLane))throw q.retryLane=c,wo(s,c),Lr(w,s,c),xf;ap(S)||Id(),a=Ef(s,a,o)}else ap(S)?(a.flags|=192,a.child=s.child,a=null):(s=q.treeContext,rn=ra(S.nextSibling),er=a,ws=!0,ji=null,sa=!1,s!==null&&Eb(a,s),a=Tf(a,c.children),a.flags|=4096);return a}return m?(Ai(),S=c.fallback,m=a.mode,q=s.child,le=q.sibling,c=Ka(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,le!==null?S=Ka(le,S):(S=_o(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Nc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=kf(o):(m=S.cachePool,m!==null?(q=Dn._currentValue,m=m.parent!==q?{parent:q,pool:q}:m):m=Mb(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=jf(s,w,o),a.memoizedState=_f,Nc(s.child,c)):(Ri(a),o=s.child,s=o.sibling,o=Ka(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Tf(s,a){return a=jd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function jd(s,a){return s=Fr(22,s,null,a),s.lanes=0,s}function Ef(s,a,o){return Co(a,s.child,null,o),s=Tf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function $0(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Um(s.return,a,o)}function Sf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function W0(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Cn.current,S=(w&2)!==0;if(S?(w=w&1|2,a.flags|=128):w&=1,De(Cn,w),sr(s,a,c,o),c=ws?pc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&$0(s,o,a);else if(s.tag===19)$0(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&hd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Sf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&hd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Sf(a,!0,o,null,f,c);break;case"together":Sf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ei(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Di|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(ml(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Ka(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Ka(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Nf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&rd(s)))}function wj(s,a,o){switch(a.tag){case 3:Nt(a,a.stateNode.containerInfo),Ei(a,Dn,s.memoizedState.cache),ko();break;case 27:case 5:Zt(a);break;case 4:Nt(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Jm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ri(a),a.flags|=128,null):(o&a.child.childLanes)!==0?H0(s,a,o):(Ri(a),s=ei(s,a,o),s!==null?s.sibling:null);Ri(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(ml(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return W0(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),De(Cn,Cn.current),c)break;return null;case 22:return a.lanes=0,V0(s,a,o,a.pendingProps);case 24:Ei(a,Dn,s.memoizedState.cache)}return ei(s,a,o)}function G0(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)Ln=!0;else{if(!Nf(s,o)&&(a.flags&128)===0)return Ln=!1,wj(s,a,o);Ln=(s.flags&131072)!==0}else Ln=!1,ws&&(a.flags&1048576)!==0&&Tb(a,pc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=So(a.elementType),a.type=s,typeof s=="function")Mm(s)?(c=Ao(s,c),a.tag=1,a=z0(null,a,s,c,o)):(a.tag=0,a=wf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===he){a.tag=11,a=P0(null,a,s,c,o);break e}else if(m===C){a.tag=14,a=L0(null,a,s,c,o);break e}}throw a=Ue(s)||s,Error(i(306,a,""))}}return a;case 0:return wf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Ao(c,a.pendingProps),z0(s,a,c,m,o);case 3:e:{if(Nt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Gm(s,a),kc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Ei(a,Dn,c),c!==f.cache&&Fm(a,[Dn],o,!0),_c(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=q0(s,a,c,o);break e}else if(c!==m){m=Zr(Error(i(424)),a),gc(m),a=q0(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,rn=ra(s.firstChild),er=a,ws=!0,ji=null,sa=!0,o=Vb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===m){a=ei(s,a,o);break e}sr(s,a,c,o)}a=a.child}return a;case 26:return kd(s,a),s===null?(o=r1(a.type,null,a.pendingProps,null))?a.memoizedState=o:ws||(o=a.type,s=a.pendingProps,c=Ud(Be.current).createElement(o),c[ot]=a,c[bt]=s,nr(c,o,s),N(c),a.stateNode=c):a.memoizedState=r1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Zt(a),s===null&&ws&&(c=a.stateNode=t1(a.type,a.pendingProps,Be.current),er=a,sa=!0,m=rn,Bi(a.type)?(op=m,rn=ra(c.firstChild)):rn=m),sr(s,a,a.pendingProps.children,o),kd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ws&&((m=c=rn)&&(c=Xj(c,a.type,a.pendingProps,sa),c!==null?(a.stateNode=c,er=a,rn=ra(c.firstChild),sa=!1,m=!0):m=!1),m||Ti(a)),Zt(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,sp(m,f)?c=null:w!==null&&sp(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=ef(s,a,hj,null,null,o),qc._currentValue=m),kd(s,a),sr(s,a,c,o),a.child;case 6:return s===null&&ws&&((s=o=rn)&&(o=Jj(o,a.pendingProps,sa),o!==null?(a.stateNode=o,er=a,rn=null,s=!0):s=!1),s||Ti(a)),null;case 13:return H0(s,a,o);case 4:return Nt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Co(a,null,c,o):sr(s,a,c,o),a.child;case 11:return P0(s,a,a.type,a.pendingProps,o);case 7:return sr(s,a,a.pendingProps,o),a.child;case 8:return sr(s,a,a.pendingProps.children,o),a.child;case 12:return sr(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ei(a,a.type,c.value),sr(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,To(a),m=tr(m),c=c(m),a.flags|=1,sr(s,a,c,o),a.child;case 14:return L0(s,a,a.type,a.pendingProps,o);case 15:return O0(s,a,a.type,a.pendingProps,o);case 19:return W0(s,a,o);case 31:return xj(s,a,o);case 22:return V0(s,a,o,a.pendingProps);case 24:return To(a),c=tr(Dn),s===null?(m=Hm(),m===null&&(m=en,f=zm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Wm(a),Ei(a,Dn,m)):((s.lanes&o)!==0&&(Gm(s,a),kc(a,null,null,o),_c()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ei(a,Dn,c)):(c=f.cache,Ei(a,Dn,c),c!==m.cache&&Fm(a,[Dn],o,!0))),sr(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ti(s){s.flags|=4}function Cf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(xv())s.flags|=8192;else throw No=ld,$m}else s.flags&=-16777217}function K0(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!c1(a))if(xv())s.flags|=8192;else throw No=ld,$m}function Td(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?vt():536870912,s.lanes|=a,Tl|=a)}function Cc(s,a){if(!ws)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function an(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function _j(s,a,o){var c=a.pendingProps;switch(Lm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(a),null;case 1:return an(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Xa(Dn),ct(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(hl(a)?ti(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Vm())),an(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ti(a),f!==null?(an(a),K0(a,f)):(an(a),Cf(a,m,null,c,o))):f?f!==s.memoizedState?(ti(a),an(a),K0(a,f)):(an(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ti(a),an(a),Cf(a,m,s,c,o)),null;case 27:if(Vs(a),o=Be.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ti(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return an(a),null}s=Pe.current,hl(a)?Sb(a):(s=t1(m,c,o),a.stateNode=s,ti(a))}return an(a),null;case 5:if(Vs(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ti(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return an(a),null}if(f=Pe.current,hl(a))Sb(a);else{var w=Ud(Be.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[ot]=a,f[bt]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(nr(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ti(a)}}return an(a),Cf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ti(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Be.current,hl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=er,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[ot]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||Hv(s.nodeValue,o)),s||Ti(a,!0)}else s=Ud(s).createTextNode(c),s[ot]=a,a.stateNode=s}return an(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=hl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[ot]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;an(a),s=!1}else o=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(qr(a),a):(qr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return an(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=hl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ot]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;an(a),m=!1}else m=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(qr(a),a):(qr(a),null)}return qr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Td(a,a.updateQueue),an(a),null);case 4:return ct(),s===null&&Xf(a.stateNode.containerInfo),an(a),null;case 10:return Xa(a.type),an(a),null;case 19:if(ae(Cn),c=a.memoizedState,c===null)return an(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Cc(c,!1);else{if(vn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=hd(s),f!==null){for(a.flags|=128,Cc(c,!1),s=f.updateQueue,a.updateQueue=s,Td(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)_b(o,s),o=o.sibling;return De(Cn,Cn.current&1|2),ws&&Ya(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Dt()>Rd&&(a.flags|=128,m=!0,Cc(c,!1),a.lanes=4194304)}else{if(!m)if(s=hd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Td(a,s),Cc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!ws)return an(a),null}else 2*Dt()-c.renderingStartTime>Rd&&o!==536870912&&(a.flags|=128,m=!0,Cc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Dt(),s.sibling=null,o=Cn.current,De(Cn,m?o&1|2:o&1),ws&&Ya(a,c.treeForkCount),s):(an(a),null);case 22:case 23:return qr(a),Xm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(an(a),a.subtreeFlags&6&&(a.flags|=8192)):an(a),o=a.updateQueue,o!==null&&Td(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&ae(Eo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Xa(Dn),an(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function kj(s,a){switch(Lm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Xa(Dn),ct(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Vs(a),null;case 31:if(a.memoizedState!==null){if(qr(a),a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(qr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ae(Cn),null;case 4:return ct(),null;case 10:return Xa(a.type),null;case 22:case 23:return qr(a),Xm(),s!==null&&ae(Eo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Xa(Dn),null;case 25:return null;default:return null}}function Y0(s,a){switch(Lm(a),a.tag){case 3:Xa(Dn),ct();break;case 26:case 27:case 5:Vs(a);break;case 4:ct();break;case 31:a.memoizedState!==null&&qr(a);break;case 13:qr(a);break;case 19:ae(Cn);break;case 10:Xa(a.type);break;case 22:case 23:qr(a),Xm(),s!==null&&ae(Eo);break;case 24:Xa(Dn)}}function Rc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(S){Hs(a,a.return,S)}}function Mi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,S=w.destroy;if(S!==void 0){w.destroy=void 0,m=a;var q=o,le=S;try{le()}catch(je){Hs(m,q,je)}}}c=c.next}while(c!==f)}}catch(je){Hs(a,a.return,je)}}function Q0(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Ub(a,o)}catch(c){Hs(s,s.return,c)}}}function X0(s,a,o){o.props=Ao(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Hs(s,a,c)}}function Ac(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Hs(s,a,m)}}function Aa(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Hs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Hs(s,a,m)}else o.current=null}function J0(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Hs(s,s.return,m)}}function Rf(s,a,o){try{var c=s.stateNode;$j(c,s.type,o,a),c[bt]=a}catch(m){Hs(s,s.return,m)}}function Z0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Bi(s.type)||s.tag===4}function Af(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Z0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Bi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Qt));else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Mf(s,a,o),s=s.sibling;s!==null;)Mf(s,a,o),s=s.sibling}function Ed(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Ed(s,a,o),s=s.sibling;s!==null;)Ed(s,a,o),s=s.sibling}function ev(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);nr(a,c,o),a[ot]=s,a[bt]=o}catch(f){Hs(s,s.return,f)}}var si=!1,On=!1,If=!1,tv=typeof WeakSet=="function"?WeakSet:Set,Qn=null;function jj(s,a){if(s=s.containerInfo,ep=Gd,s=mb(s),Tm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,S=-1,q=-1,le=0,je=0,Ie=s,ue=null;t:for(;;){for(var ye;Ie!==o||m!==0&&Ie.nodeType!==3||(S=w+m),Ie!==f||c!==0&&Ie.nodeType!==3||(q=w+c),Ie.nodeType===3&&(w+=Ie.nodeValue.length),(ye=Ie.firstChild)!==null;)ue=Ie,Ie=ye;for(;;){if(Ie===s)break t;if(ue===o&&++le===m&&(S=w),ue===f&&++je===c&&(q=w),(ye=Ie.nextSibling)!==null)break;Ie=ue,ue=Ie.parentNode}Ie=ye}o=S===-1||q===-1?null:{start:S,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(tp={focusedElem:s,selectionRange:o},Gd=!1,Qn=a;Qn!==null;)if(a=Qn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Qn=s;else for(;Qn!==null;){switch(a=Qn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var mt=Ao(o.type,m);s=c.getSnapshotBeforeUpdate(mt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Mt){Hs(o,o.return,Mt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)rp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Qn=s;break}Qn=a.return}}function sv(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ri(s,o),c&4&&Rc(5,o);break;case 1:if(ri(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Hs(o,o.return,w)}else{var m=Ao(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Hs(o,o.return,w)}}c&64&&Q0(o),c&512&&Ac(o,o.return);break;case 3:if(ri(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Ub(s,a)}catch(w){Hs(o,o.return,w)}}break;case 27:a===null&&c&4&&ev(o);case 26:case 5:ri(s,o),a===null&&c&4&&J0(o),c&512&&Ac(o,o.return);break;case 12:ri(s,o);break;case 31:ri(s,o),c&4&&av(s,o);break;case 13:ri(s,o),c&4&&iv(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Ij.bind(null,o),Zj(s,o))));break;case 22:if(c=o.memoizedState!==null||si,!c){a=a!==null&&a.memoizedState!==null||On,m=si;var f=On;si=c,(On=a)&&!f?ai(s,o,(o.subtreeFlags&8772)!==0):ri(s,o),si=m,On=f}break;case 30:break;default:ri(s,o)}}function nv(s){var a=s.alternate;a!==null&&(s.alternate=null,nv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&kn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ln=null,Mr=!1;function ni(s,a,o){for(o=o.child;o!==null;)rv(s,a,o),o=o.sibling}function rv(s,a,o){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(ve,o)}catch{}switch(o.tag){case 26:On||Aa(o,a),ni(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:On||Aa(o,a);var c=ln,m=Mr;Bi(o.type)&&(ln=o.stateNode,Mr=!1),ni(s,a,o),Uc(o.stateNode),ln=c,Mr=m;break;case 5:On||Aa(o,a);case 6:if(c=ln,m=Mr,ln=null,ni(s,a,o),ln=c,Mr=m,ln!==null)if(Mr)try{(ln.nodeType===9?ln.body:ln.nodeName==="HTML"?ln.ownerDocument.body:ln).removeChild(o.stateNode)}catch(f){Hs(o,a,f)}else try{ln.removeChild(o.stateNode)}catch(f){Hs(o,a,f)}break;case 18:ln!==null&&(Mr?(s=ln,Qv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Il(s)):Qv(ln,o.stateNode));break;case 4:c=ln,m=Mr,ln=o.stateNode.containerInfo,Mr=!0,ni(s,a,o),ln=c,Mr=m;break;case 0:case 11:case 14:case 15:Mi(2,o,a),On||Mi(4,o,a),ni(s,a,o);break;case 1:On||(Aa(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&X0(o,a,c)),ni(s,a,o);break;case 21:ni(s,a,o);break;case 22:On=(c=On)||o.memoizedState!==null,ni(s,a,o),On=c;break;default:ni(s,a,o)}}function av(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Il(s)}catch(o){Hs(a,a.return,o)}}}function iv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Il(s)}catch(o){Hs(a,a.return,o)}}function Tj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new tv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new tv),a;default:throw Error(i(435,s.tag))}}function Sd(s,a){var o=Tj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Dj.bind(null,s,c);c.then(m,m)}})}function Ir(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,S=w;e:for(;S!==null;){switch(S.tag){case 27:if(Bi(S.type)){ln=S.stateNode,Mr=!1;break e}break;case 5:ln=S.stateNode,Mr=!1;break e;case 3:case 4:ln=S.stateNode.containerInfo,Mr=!0;break e}S=S.return}if(ln===null)throw Error(i(160));rv(f,w,m),ln=null,Mr=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)ov(a,s),a=a.sibling}var fa=null;function ov(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ir(a,s),Dr(s),c&4&&(Mi(3,s,s.return),Rc(3,s),Mi(5,s,s.return));break;case 1:Ir(a,s),Dr(s),c&512&&(On||o===null||Aa(o,o.return)),c&64&&si&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=fa;if(Ir(a,s),Dr(s),c&512&&(On||o===null||Aa(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[fn]||f[ot]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),nr(f,c,o),f[ot]=s,N(f),c=f;break e;case"link":var w=o1("link","href",m).get(c+(o.href||""));if(w){for(var S=0;S<w.length;S++)if(f=w[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(S,1);break t}}f=m.createElement(c),nr(f,c,o),m.head.appendChild(f);break;case"meta":if(w=o1("meta","content",m).get(c+(o.content||""))){for(S=0;S<w.length;S++)if(f=w[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(S,1);break t}}f=m.createElement(c),nr(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[ot]=s,N(f),c=f}s.stateNode=c}else l1(m,s.type,s.stateNode);else s.stateNode=i1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?l1(m,s.type,s.stateNode):i1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Rf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Ir(a,s),Dr(s),c&512&&(On||o===null||Aa(o,o.return)),o!==null&&c&4&&Rf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Ir(a,s),Dr(s),c&512&&(On||o===null||Aa(o,o.return)),s.flags&32){m=s.stateNode;try{Vt(m,"")}catch(mt){Hs(s,s.return,mt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Rf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(If=!0);break;case 6:if(Ir(a,s),Dr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(mt){Hs(s,s.return,mt)}}break;case 3:if(qd=null,m=fa,fa=Fd(a.containerInfo),Ir(a,s),fa=m,Dr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(a.containerInfo)}catch(mt){Hs(s,s.return,mt)}If&&(If=!1,lv(s));break;case 4:c=fa,fa=Fd(s.stateNode.containerInfo),Ir(a,s),Dr(s),fa=c;break;case 12:Ir(a,s),Dr(s);break;case 31:Ir(a,s),Dr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 13:Ir(a,s),Dr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Cd=Dt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 22:m=s.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,le=si,je=On;if(si=le||m,On=je||q,Ir(a,s),On=je,si=le,Dr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||q||si||On||Mo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){q=o=a;try{if(f=q.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{S=q.stateNode;var Ie=q.memoizedProps.style,ue=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;S.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(mt){Hs(q,q.return,mt)}}}else if(a.tag===6){if(o===null){q=a;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(mt){Hs(q,q.return,mt)}}}else if(a.tag===18){if(o===null){q=a;try{var ye=q.stateNode;m?Xv(ye,!0):Xv(q.stateNode,!1)}catch(mt){Hs(q,q.return,mt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Sd(s,o))));break;case 19:Ir(a,s),Dr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 30:break;case 21:break;default:Ir(a,s),Dr(s)}}function Dr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Z0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Af(s);Ed(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Vt(w,""),o.flags&=-33);var S=Af(s);Ed(s,S,w);break;case 3:case 4:var q=o.stateNode.containerInfo,le=Af(s);Mf(s,le,q);break;default:throw Error(i(161))}}catch(je){Hs(s,s.return,je)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function lv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;lv(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ri(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)sv(s,a.alternate,a),a=a.sibling}function Mo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Mi(4,a,a.return),Mo(a);break;case 1:Aa(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&X0(a,a.return,o),Mo(a);break;case 27:Uc(a.stateNode);case 26:case 5:Aa(a,a.return),Mo(a);break;case 22:a.memoizedState===null&&Mo(a);break;case 30:Mo(a);break;default:Mo(a)}s=s.sibling}}function ai(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:ai(m,f,o),Rc(4,f);break;case 1:if(ai(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){Hs(c,c.return,le)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)Bb(q[m],S)}catch(le){Hs(c,c.return,le)}}o&&w&64&&Q0(f),Ac(f,f.return);break;case 27:ev(f);case 26:case 5:ai(m,f,o),o&&c===null&&w&4&&J0(f),Ac(f,f.return);break;case 12:ai(m,f,o);break;case 31:ai(m,f,o),o&&w&4&&av(m,f);break;case 13:ai(m,f,o),o&&w&4&&iv(m,f);break;case 22:f.memoizedState===null&&ai(m,f,o),Ac(f,f.return);break;case 30:break;default:ai(m,f,o)}a=a.sibling}}function Df(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&yc(o))}function Pf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&yc(s))}function pa(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)cv(s,a,o,c),a=a.sibling}function cv(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:pa(s,a,o,c),m&2048&&Rc(9,a);break;case 1:pa(s,a,o,c);break;case 3:pa(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&yc(s)));break;case 12:if(m&2048){pa(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,S=f.onPostCommit;typeof S=="function"&&S(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Hs(a,a.return,q)}}else pa(s,a,o,c);break;case 31:pa(s,a,o,c);break;case 13:pa(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?pa(s,a,o,c):Mc(s,a):f._visibility&2?pa(s,a,o,c):(f._visibility|=2,_l(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Df(w,a);break;case 24:pa(s,a,o,c),m&2048&&Pf(a.alternate,a);break;default:pa(s,a,o,c)}}function _l(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,S=o,q=c,le=w.flags;switch(w.tag){case 0:case 11:case 15:_l(f,w,S,q,m),Rc(8,w);break;case 23:break;case 22:var je=w.stateNode;w.memoizedState!==null?je._visibility&2?_l(f,w,S,q,m):Mc(f,w):(je._visibility|=2,_l(f,w,S,q,m)),m&&le&2048&&Df(w.alternate,w);break;case 24:_l(f,w,S,q,m),m&&le&2048&&Pf(w.alternate,w);break;default:_l(f,w,S,q,m)}a=a.sibling}}function Mc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Mc(o,c),m&2048&&Df(c.alternate,c);break;case 24:Mc(o,c),m&2048&&Pf(c.alternate,c);break;default:Mc(o,c)}a=a.sibling}}var Ic=8192;function kl(s,a,o){if(s.subtreeFlags&Ic)for(s=s.child;s!==null;)uv(s,a,o),s=s.sibling}function uv(s,a,o){switch(s.tag){case 26:kl(s,a,o),s.flags&Ic&&s.memoizedState!==null&&dT(o,fa,s.memoizedState,s.memoizedProps);break;case 5:kl(s,a,o);break;case 3:case 4:var c=fa;fa=Fd(s.stateNode.containerInfo),kl(s,a,o),fa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Ic,Ic=16777216,kl(s,a,o),Ic=c):kl(s,a,o));break;default:kl(s,a,o)}}function dv(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Dc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Qn=c,mv(c,s)}dv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hv(s),s=s.sibling}function hv(s){switch(s.tag){case 0:case 11:case 15:Dc(s),s.flags&2048&&Mi(9,s,s.return);break;case 3:Dc(s);break;case 12:Dc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Nd(s)):Dc(s);break;default:Dc(s)}}function Nd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Qn=c,mv(c,s)}dv(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Mi(8,a,a.return),Nd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Nd(a));break;default:Nd(a)}s=s.sibling}}function mv(s,a){for(;Qn!==null;){var o=Qn;switch(o.tag){case 0:case 11:case 15:Mi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:yc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Qn=c;else e:for(o=s;Qn!==null;){c=Qn;var m=c.sibling,f=c.return;if(nv(c),c===o){Qn=null;break e}if(m!==null){m.return=f,Qn=m;break e}Qn=f}}}var Ej={getCacheForType:function(s){var a=tr(Dn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return tr(Dn).controller.signal}},Sj=typeof WeakMap=="function"?WeakMap:Map,Os=0,en=null,ds=null,ps=0,qs=0,Hr=null,Ii=!1,jl=!1,Lf=!1,ii=0,vn=0,Di=0,Io=0,Of=0,$r=0,Tl=0,Pc=null,Pr=null,Vf=!1,Cd=0,fv=0,Rd=1/0,Ad=null,Pi=null,qn=0,Li=null,El=null,oi=0,Bf=0,Uf=null,pv=null,Lc=0,Ff=null;function Wr(){return(Os&2)!==0&&ps!==0?ps&-ps:B.T!==null?Gf():Ce()}function gv(){if($r===0)if((ps&536870912)===0||ws){var s=Y;Y<<=1,(Y&3932160)===0&&(Y=262144),$r=s}else $r=536870912;return s=zr.current,s!==null&&(s.flags|=32),$r}function Lr(s,a,o){(s===en&&(qs===2||qs===9)||s.cancelPendingCommit!==null)&&(Sl(s,0),Oi(s,ps,$r,!1)),_s(s,o),((Os&2)===0||s!==en)&&(s===en&&((Os&2)===0&&(Io|=o),vn===4&&Oi(s,ps,$r,!1)),Ma(s))}function yv(s,a,o){if((Os&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||rt(s,a),m=c?Rj(s,a):qf(s,a,!0),f=c;do{if(m===0){jl&&!c&&Oi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Nj(o)){m=qf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var S=s;m=Pc;var q=S.current.memoizedState.isDehydrated;if(q&&(Sl(S,w).flags|=256),w=qf(S,w,!1),w!==2){if(Lf&&!q){S.errorRecoveryDisabledLanes|=f,Io|=f,m=4;break e}f=Pr,Pr=m,f!==null&&(Pr===null?Pr=f:Pr.push.apply(Pr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Sl(s,0),Oi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Oi(c,a,$r,!Ii);break e;case 2:Pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Cd+300-Dt(),10<m)){if(Oi(c,a,$r,!Ii),We(c,0,!0)!==0)break e;oi=a,c.timeoutHandle=Kv(bv.bind(null,c,o,Pr,Ad,Vf,a,$r,Io,Tl,Ii,f,"Throttled",-0,0),m);break e}bv(c,o,Pr,Ad,Vf,a,$r,Io,Tl,Ii,f,null,-0,0)}}break}while(!0);Ma(s)}function bv(s,a,o,c,m,f,w,S,q,le,je,Ie,ue,ye){if(s.timeoutHandle=-1,Ie=a.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qt},uv(a,f,Ie);var mt=(f&62914560)===f?Cd-Dt():(f&4194048)===f?fv-Dt():0;if(mt=hT(Ie,mt),mt!==null){oi=f,s.cancelPendingCommit=mt(Ev.bind(null,s,a,f,o,c,m,w,S,q,je,Ie,null,ue,ye)),Oi(s,f,w,!le);return}}Ev(s,a,f,o,c,m,w,S,q)}function Nj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Ur(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oi(s,a,o,c){a&=~Of,a&=~Io,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Ee(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&as(s,o,a)}function Md(){return(Os&6)===0?(Oc(0),!1):!0}function zf(){if(ds!==null){if(qs===0)var s=ds.return;else s=ds,Qa=jo=null,nf(s),yl=null,vc=0,s=ds;for(;s!==null;)Y0(s.alternate,s),s=s.return;ds=null}}function Sl(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Kj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),oi=0,zf(),en=s,ds=o=Ka(s.current,null),ps=a,qs=0,Hr=null,Ii=!1,jl=rt(s,a),Lf=!1,Tl=$r=Of=Io=Di=vn=0,Pr=Pc=null,Vf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Ee(c),f=1<<m;a|=s[m],c&=~f}return ii=a,Zu(),o}function vv(s,a){ss=null,B.H=Sc,a===gl||a===od?(a=Pb(),qs=3):a===$m?(a=Pb(),qs=4):qs=a===xf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Hr=a,ds===null&&(vn=1,wd(s,Zr(a,s.current)))}function xv(){var s=zr.current;return s===null?!0:(ps&4194048)===ps?na===null:(ps&62914560)===ps||(ps&536870912)!==0?s===na:!1}function wv(){var s=B.H;return B.H=Sc,s===null?Sc:s}function _v(){var s=B.A;return B.A=Ej,s}function Id(){vn=4,Ii||(ps&4194048)!==ps&&zr.current!==null||(jl=!0),(Di&134217727)===0&&(Io&134217727)===0||en===null||Oi(en,ps,$r,!1)}function qf(s,a,o){var c=Os;Os|=2;var m=wv(),f=_v();(en!==s||ps!==a)&&(Ad=null,Sl(s,a)),a=!1;var w=vn;e:do try{if(qs!==0&&ds!==null){var S=ds,q=Hr;switch(qs){case 8:zf(),w=6;break e;case 3:case 2:case 9:case 6:zr.current===null&&(a=!0);var le=qs;if(qs=0,Hr=null,Nl(s,S,q,le),o&&jl){w=0;break e}break;default:le=qs,qs=0,Hr=null,Nl(s,S,q,le)}}Cj(),w=vn;break}catch(je){vv(s,je)}while(!0);return a&&s.shellSuspendCounter++,Qa=jo=null,Os=c,B.H=m,B.A=f,ds===null&&(en=null,ps=0,Zu()),w}function Cj(){for(;ds!==null;)kv(ds)}function Rj(s,a){var o=Os;Os|=2;var c=wv(),m=_v();en!==s||ps!==a?(Ad=null,Rd=Dt()+500,Sl(s,a)):jl=rt(s,a);e:do try{if(qs!==0&&ds!==null){a=ds;var f=Hr;t:switch(qs){case 1:qs=0,Hr=null,Nl(s,a,f,1);break;case 2:case 9:if(Ib(f)){qs=0,Hr=null,jv(a);break}a=function(){qs!==2&&qs!==9||en!==s||(qs=7),Ma(s)},f.then(a,a);break e;case 3:qs=7;break e;case 4:qs=5;break e;case 7:Ib(f)?(qs=0,Hr=null,jv(a)):(qs=0,Hr=null,Nl(s,a,f,7));break;case 5:var w=null;switch(ds.tag){case 26:w=ds.memoizedState;case 5:case 27:var S=ds;if(w?c1(w):S.stateNode.complete){qs=0,Hr=null;var q=S.sibling;if(q!==null)ds=q;else{var le=S.return;le!==null?(ds=le,Dd(le)):ds=null}break t}}qs=0,Hr=null,Nl(s,a,f,5);break;case 6:qs=0,Hr=null,Nl(s,a,f,6);break;case 8:zf(),vn=6;break e;default:throw Error(i(462))}}Aj();break}catch(je){vv(s,je)}while(!0);return Qa=jo=null,B.H=c,B.A=m,Os=o,ds!==null?0:(en=null,ps=0,Zu(),vn)}function Aj(){for(;ds!==null&&!Ns();)kv(ds)}function kv(s){var a=G0(s.alternate,s,ii);s.memoizedProps=s.pendingProps,a===null?Dd(s):ds=a}function jv(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=F0(o,a,a.pendingProps,a.type,void 0,ps);break;case 11:a=F0(o,a,a.pendingProps,a.type.render,a.ref,ps);break;case 5:nf(a);default:Y0(o,a),a=ds=_b(a,ii),a=G0(o,a,ii)}s.memoizedProps=s.pendingProps,a===null?Dd(s):ds=a}function Nl(s,a,o,c){Qa=jo=null,nf(a),yl=null,vc=0;var m=a.return;try{if(vj(s,m,a,o,ps)){vn=1,wd(s,Zr(o,s.current)),ds=null;return}}catch(f){if(m!==null)throw ds=m,f;vn=1,wd(s,Zr(o,s.current)),ds=null;return}a.flags&32768?(ws||c===1?s=!0:jl||(ps&536870912)!==0?s=!1:(Ii=s=!0,(c===2||c===9||c===3||c===6)&&(c=zr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Tv(a,s)):Dd(a)}function Dd(s){var a=s;do{if((a.flags&32768)!==0){Tv(a,Ii);return}s=a.return;var o=_j(a.alternate,a,ii);if(o!==null){ds=o;return}if(a=a.sibling,a!==null){ds=a;return}ds=a=s}while(a!==null);vn===0&&(vn=5)}function Tv(s,a){do{var o=kj(s.alternate,s);if(o!==null){o.flags&=32767,ds=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){ds=s;return}ds=s=o}while(s!==null);vn=6,ds=null}function Ev(s,a,o,c,m,f,w,S,q){s.cancelPendingCommit=null;do Pd();while(qn!==0);if((Os&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Rm,Ws(s,o,f,w,S,q),s===en&&(ds=en=null,ps=0),El=a,Li=s,oi=o,Bf=f,Uf=m,pv=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Pj(Ut,function(){return Av(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,m=re.p,re.p=2,w=Os,Os|=4;try{jj(s,a,o)}finally{Os=w,re.p=m,B.T=c}}qn=1,Sv(),Nv(),Cv()}}function Sv(){if(qn===1){qn=0;var s=Li,a=El,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var c=re.p;re.p=2;var m=Os;Os|=4;try{ov(a,s);var f=tp,w=mb(s.containerInfo),S=f.focusedElem,q=f.selectionRange;if(w!==S&&S&&S.ownerDocument&&hb(S.ownerDocument.documentElement,S)){if(q!==null&&Tm(S)){var le=q.start,je=q.end;if(je===void 0&&(je=le),"selectionStart"in S)S.selectionStart=le,S.selectionEnd=Math.min(je,S.value.length);else{var Ie=S.ownerDocument||document,ue=Ie&&Ie.defaultView||window;if(ue.getSelection){var ye=ue.getSelection(),mt=S.textContent.length,Mt=Math.min(q.start,mt),Ys=q.end===void 0?Mt:Math.min(q.end,mt);!ye.extend&&Mt>Ys&&(w=Ys,Ys=Mt,Mt=w);var te=db(S,Mt),Q=db(S,Ys);if(te&&Q&&(ye.rangeCount!==1||ye.anchorNode!==te.node||ye.anchorOffset!==te.offset||ye.focusNode!==Q.node||ye.focusOffset!==Q.offset)){var oe=Ie.createRange();oe.setStart(te.node,te.offset),ye.removeAllRanges(),Mt>Ys?(ye.addRange(oe),ye.extend(Q.node,Q.offset)):(oe.setEnd(Q.node,Q.offset),ye.addRange(oe))}}}}for(Ie=[],ye=S;ye=ye.parentNode;)ye.nodeType===1&&Ie.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Ie.length;S++){var Ae=Ie[S];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}Gd=!!ep,tp=ep=null}finally{Os=m,re.p=c,B.T=o}}s.current=a,qn=2}}function Nv(){if(qn===2){qn=0;var s=Li,a=El,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var c=re.p;re.p=2;var m=Os;Os|=4;try{sv(s,a.alternate,a)}finally{Os=m,re.p=c,B.T=o}}qn=3}}function Cv(){if(qn===4||qn===3){qn=0,$s();var s=Li,a=El,o=oi,c=pv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?qn=5:(qn=0,El=Li=null,Rv(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Pi=null),xe(o),a=a.stateNode,G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(ve,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=B.T,m=re.p,re.p=2,B.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var S=c[w];f(S.value,{componentStack:S.stack})}}finally{B.T=a,re.p=m}}(oi&3)!==0&&Pd(),Ma(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Ff?Lc++:(Lc=0,Ff=s):Lc=0,Oc(0)}}function Rv(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,yc(a)))}function Pd(){return Sv(),Nv(),Cv(),Av()}function Av(){if(qn!==5)return!1;var s=Li,a=Bf;Bf=0;var o=xe(oi),c=B.T,m=re.p;try{re.p=32>o?32:o,B.T=null,o=Uf,Uf=null;var f=Li,w=oi;if(qn=0,El=Li=null,oi=0,(Os&6)!==0)throw Error(i(331));var S=Os;if(Os|=4,hv(f.current),cv(f,f.current,w,o),Os=S,Oc(0,!1),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(ve,f)}catch{}return!0}finally{re.p=m,B.T=c,Rv(s,a)}}function Mv(s,a,o){a=Zr(o,a),a=vf(s.stateNode,a,2),s=Ci(s,a,2),s!==null&&(_s(s,2),Ma(s))}function Hs(s,a,o){if(s.tag===3)Mv(s,s,o);else for(;a!==null;){if(a.tag===3){Mv(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){s=Zr(o,s),o=I0(2),c=Ci(a,o,2),c!==null&&(D0(o,c,a,s),_s(c,2),Ma(c));break}}a=a.return}}function Hf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Sj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Lf=!0,m.add(o),s=Mj.bind(null,s,a,o),a.then(s,s))}function Mj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,en===s&&(ps&o)===o&&(vn===4||vn===3&&(ps&62914560)===ps&&300>Dt()-Cd?(Os&2)===0&&Sl(s,0):Of|=o,Tl===ps&&(Tl=0)),Ma(s)}function Iv(s,a){a===0&&(a=vt()),s=wo(s,a),s!==null&&(_s(s,a),Ma(s))}function Ij(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),Iv(s,o)}function Dj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Iv(s,o)}function Pj(s,a){return He(s,a)}var Ld=null,Cl=null,$f=!1,Od=!1,Wf=!1,Vi=0;function Ma(s){s!==Cl&&s.next===null&&(Cl===null?Ld=Cl=s:Cl=Cl.next=s),Od=!0,$f||($f=!0,Oj())}function Oc(s,a){if(!Wf&&Od){Wf=!0;do for(var o=!1,c=Ld;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Ee(42|s)+1)-1,f&=m&~(w&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,Ov(c,f))}else f=ps,f=We(c,c===en?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||rt(c,f)||(o=!0,Ov(c,f));c=c.next}while(o);Wf=!1}}function Lj(){Dv()}function Dv(){Od=$f=!1;var s=0;Vi!==0&&Gj()&&(s=Vi);for(var a=Dt(),o=null,c=Ld;c!==null;){var m=c.next,f=Pv(c,a);f===0?(c.next=null,o===null?Ld=m:o.next=m,m===null&&(Cl=o)):(o=c,(s!==0||(f&3)!==0)&&(Od=!0)),c=m}qn!==0&&qn!==5||Oc(s),Vi!==0&&(Vi=0)}function Pv(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-Ee(f),S=1<<w,q=m[w];q===-1?((S&o)===0||(S&c)!==0)&&(m[w]=pt(S,a)):q<=a&&(s.expiredLanes|=S),f&=~S}if(a=en,o=ps,o=We(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(qs===2||qs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&zt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||rt(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&zt(c),xe(o)){case 2:case 8:o=As;break;case 32:o=Ut;break;case 268435456:o=Pt;break;default:o=Ut}return c=Lv.bind(null,s),o=He(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&zt(c),s.callbackPriority=2,s.callbackNode=null,2}function Lv(s,a){if(qn!==0&&qn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Pd()&&s.callbackNode!==o)return null;var c=ps;return c=We(s,s===en?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(yv(s,c,a),Pv(s,Dt()),s.callbackNode!=null&&s.callbackNode===o?Lv.bind(null,s):null)}function Ov(s,a){if(Pd())return null;yv(s,a,!0)}function Oj(){Yj(function(){(Os&6)!==0?He(rs,Lj):Dv()})}function Gf(){if(Vi===0){var s=fl;s===0&&(s=at,at<<=1,(at&261888)===0&&(at=256)),Vi=s}return Vi}function Vv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:yr(""+s)}function Bv(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Vj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=Vv((m[bt]||null).action),w=c.submitter;w&&(a=(a=w[bt]||null)?Vv(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var S=new Kn("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var q=w?Bv(m,w):new FormData(m);mf(o,{pending:!0,data:q,method:m.method,action:f},null,q)}}else typeof f=="function"&&(S.preventDefault(),q=w?Bv(m,w):new FormData(m),mf(o,{pending:!0,data:q,method:m.method,action:f},f,q))},currentTarget:m}]})}}for(var Kf=0;Kf<Cm.length;Kf++){var Yf=Cm[Kf],Bj=Yf.toLowerCase(),Uj=Yf[0].toUpperCase()+Yf.slice(1);ma(Bj,"on"+Uj)}ma(gb,"onAnimationEnd"),ma(yb,"onAnimationIteration"),ma(bb,"onAnimationStart"),ma("dblclick","onDoubleClick"),ma("focusin","onFocus"),ma("focusout","onBlur"),ma(sj,"onTransitionRun"),ma(nj,"onTransitionStart"),ma(rj,"onTransitionCancel"),ma(vb,"onTransitionEnd"),Fe("onMouseEnter",["mouseout","mouseover"]),Fe("onMouseLeave",["mouseout","mouseover"]),Fe("onPointerEnter",["pointerout","pointerover"]),Fe("onPointerLeave",["pointerout","pointerover"]),me("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),me("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),me("onBeforeInput",["compositionend","keypress","textInput","paste"]),me("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vc));function Uv(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var S=c[w],q=S.instance,le=S.currentTarget;if(S=S.listener,q!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(je){Ju(je)}m.currentTarget=null,f=q}else for(w=0;w<c.length;w++){if(S=c[w],q=S.instance,le=S.currentTarget,S=S.listener,q!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(je){Ju(je)}m.currentTarget=null,f=q}}}}function hs(s,a){var o=a[_t];o===void 0&&(o=a[_t]=new Set);var c=s+"__bubble";o.has(c)||(Fv(a,s,2,!1),o.add(c))}function Qf(s,a,o){var c=0;a&&(c|=4),Fv(o,s,c,a)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function Xf(s){if(!s[Vd]){s[Vd]=!0,P.forEach(function(o){o!=="selectionchange"&&(Fj.has(o)||Qf(o,!1,s),Qf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Vd]||(a[Vd]=!0,Qf("selectionchange",!1,a))}}function Fv(s,a,o,c){switch(g1(a)){case 2:var m=pT;break;case 8:m=gT;break;default:m=hp}o=m.bind(null,a,o,s),m=void 0,!J||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Jf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===m)break;if(w===4)for(w=c.return;w!==null;){var q=w.tag;if((q===3||q===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;S!==null;){if(w=Mn(S),w===null)return;if(q=w.tag,q===5||q===6||q===26||q===27){c=f=w;continue e}S=S.parentNode}}c=c.return}lr(function(){var le=f,je=dn(o),Ie=[];e:{var ue=xb.get(s);if(ue!==void 0){var ye=Kn,mt=s;switch(s){case"keypress":if(Ft(o)===0)break e;case"keydown":case"keyup":ye=Yu;break;case"focusin":mt="focus",ye=yn;break;case"focusout":mt="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=ur;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=vr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=b;break;case gb:case yb:case bb:ye=Ar;break;case vb:ye=A;break;case"scroll":case"scrollend":ye=sn;break;case"wheel":ye=fe;break;case"copy":case"cut":case"paste":ye=sl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Ga;break;case"toggle":case"beforetoggle":ye=ts}var Mt=(a&4)!==0,Ys=!Mt&&(s==="scroll"||s==="scrollend"),te=Mt?ue!==null?ue+"Capture":null:ue;Mt=[];for(var Q=le,oe;Q!==null;){var Ae=Q;if(oe=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||oe===null||te===null||(Ae=cr(Q,te),Ae!=null&&Mt.push(Bc(Q,Ae,oe))),Ys)break;Q=Q.return}0<Mt.length&&(ue=new ye(ue,mt,null,o,je),Ie.push({event:ue,listeners:Mt}))}}if((a&7)===0){e:{if(ue=s==="mouseover"||s==="pointerover",ye=s==="mouseout"||s==="pointerout",ue&&o!==Js&&(mt=o.relatedTarget||o.fromElement)&&(Mn(mt)||mt[Je]))break e;if((ye||ue)&&(ue=je.window===je?je:(ue=je.ownerDocument)?ue.defaultView||ue.parentWindow:window,ye?(mt=o.relatedTarget||o.toElement,ye=le,mt=mt?Mn(mt):null,mt!==null&&(Ys=u(mt),Mt=mt.tag,mt!==Ys||Mt!==5&&Mt!==27&&Mt!==6)&&(mt=null)):(ye=null,mt=le),ye!==mt)){if(Mt=ur,Ae="onMouseLeave",te="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Mt=Ga,Ae="onPointerLeave",te="onPointerEnter",Q="pointer"),Ys=ye==null?ue:Fs(ye),oe=mt==null?ue:Fs(mt),ue=new Mt(Ae,Q+"leave",ye,o,je),ue.target=Ys,ue.relatedTarget=oe,Ae=null,Mn(je)===le&&(Mt=new Mt(te,Q+"enter",mt,o,je),Mt.target=oe,Mt.relatedTarget=Ys,Ae=Mt),Ys=Ae,ye&&mt)t:{for(Mt=zj,te=ye,Q=mt,oe=0,Ae=te;Ae;Ae=Mt(Ae))oe++;Ae=0;for(var Et=Q;Et;Et=Mt(Et))Ae++;for(;0<oe-Ae;)te=Mt(te),oe--;for(;0<Ae-oe;)Q=Mt(Q),Ae--;for(;oe--;){if(te===Q||Q!==null&&te===Q.alternate){Mt=te;break t}te=Mt(te),Q=Mt(Q)}Mt=null}else Mt=null;ye!==null&&zv(Ie,ue,ye,Mt,!1),mt!==null&&Ys!==null&&zv(Ie,Ys,mt,Mt,!0)}}e:{if(ue=le?Fs(le):window,ye=ue.nodeName&&ue.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ue.type==="file")var Ms=ab;else if(nb(ue))if(ib)Ms=Zk;else{Ms=Xk;var xt=Qk}else ye=ue.nodeName,!ye||ye.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?le&&gn(le.elementType)&&(Ms=ab):Ms=Jk;if(Ms&&(Ms=Ms(s,le))){rb(Ie,Ms,o,je);break e}xt&&xt(s,ue,le),s==="focusout"&&le&&ue.type==="number"&&le.memoizedProps.value!=null&&Qe(ue,"number",ue.value)}switch(xt=le?Fs(le):window,s){case"focusin":(nb(xt)||xt.contentEditable==="true")&&(il=xt,Em=le,fc=null);break;case"focusout":fc=Em=il=null;break;case"mousedown":Sm=!0;break;case"contextmenu":case"mouseup":case"dragend":Sm=!1,fb(Ie,o,je);break;case"selectionchange":if(tj)break;case"keydown":case"keyup":fb(Ie,o,je)}var ns;if(Ls)e:{switch(s){case"compositionstart":var gs="onCompositionStart";break e;case"compositionend":gs="onCompositionEnd";break e;case"compositionupdate":gs="onCompositionUpdate";break e}gs=void 0}else al?bo(s,o)&&(gs="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(gs="onCompositionStart");gs&&(Na&&o.locale!=="ko"&&(al||gs!=="onCompositionStart"?gs==="onCompositionEnd"&&al&&(ns=it()):(et=je,kt="value"in et?et.value:et.textContent,al=!0)),xt=Bd(le,gs),0<xt.length&&(gs=new wr(gs,s,null,o,je),Ie.push({event:gs,listeners:xt}),ns?gs.data=ns:(ns=rl(o),ns!==null&&(gs.data=ns)))),(ns=Xr?Wk(s,o):Gk(s,o))&&(gs=Bd(le,"onBeforeInput"),0<gs.length&&(xt=new wr("onBeforeInput","beforeinput",null,o,je),Ie.push({event:xt,listeners:gs}),xt.data=ns)),Vj(Ie,s,le,o,je)}Uv(Ie,a)})}function Bc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Bd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=cr(s,o),m!=null&&c.unshift(Bc(s,m,f)),m=cr(s,a),m!=null&&c.push(Bc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function zj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function zv(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var S=o,q=S.alternate,le=S.stateNode;if(S=S.tag,q!==null&&q===c)break;S!==5&&S!==26&&S!==27||le===null||(q=le,m?(le=cr(o,f),le!=null&&w.unshift(Bc(o,le,q))):m||(le=cr(o,f),le!=null&&w.push(Bc(o,le,q)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var qj=/\r\n?/g,Hj=/\u0000|\uFFFD/g;function qv(s){return(typeof s=="string"?s:""+s).replace(qj,`
`).replace(Hj,"")}function Hv(s,a){return a=qv(a),qv(s)===a}function Ks(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Vt(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Vt(s,""+c);break;case"className":cs(s,"class",c);break;case"tabIndex":cs(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":cs(s,o,c);break;case"style":Ps(s,c,f);break;case"data":if(a!=="object"){cs(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=yr(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Ks(s,a,"name",m.name,m,null),Ks(s,a,"formEncType",m.formEncType,m,null),Ks(s,a,"formMethod",m.formMethod,m,null),Ks(s,a,"formTarget",m.formTarget,m,null)):(Ks(s,a,"encType",m.encType,m,null),Ks(s,a,"method",m.method,m,null),Ks(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=yr(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Qt);break;case"onScroll":c!=null&&hs("scroll",s);break;case"onScrollEnd":c!=null&&hs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=yr(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":hs("beforetoggle",s),hs("toggle",s),js(s,"popover",c);break;case"xlinkActuate":ls(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ls(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ls(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ls(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ls(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ls(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ls(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ls(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ls(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":js(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=En.get(o)||o,js(s,o,c))}}function Zf(s,a,o,c,m,f){switch(o){case"style":Ps(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Vt(s,c):(typeof c=="number"||typeof c=="bigint")&&Vt(s,""+c);break;case"onScroll":c!=null&&hs("scroll",s);break;case"onScrollEnd":c!=null&&hs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Qt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!F.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[bt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):js(s,o,c)}}}function nr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":hs("error",s),hs("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,f,w,o,null)}}m&&Ks(s,a,"srcSet",o.srcSet,o,null),c&&Ks(s,a,"src",o.src,o,null);return;case"input":hs("invalid",s);var S=f=w=m=null,q=null,le=null;for(c in o)if(o.hasOwnProperty(c)){var je=o[c];if(je!=null)switch(c){case"name":m=je;break;case"type":w=je;break;case"checked":q=je;break;case"defaultChecked":le=je;break;case"value":f=je;break;case"defaultValue":S=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(i(137,a));break;default:Ks(s,a,c,je,o,null)}}Xe(s,f,S,q,le,w,m,!1);return;case"select":hs("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":w=S;break;case"multiple":c=S;default:Ks(s,a,m,S,o,null)}a=f,o=w,s.multiple=!!c,a!=null?ut(s,!!c,a,!1):o!=null&&ut(s,!!c,o,!0);return;case"textarea":hs("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(S=o[w],S!=null))switch(w){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Ks(s,a,w,S,o,null)}$t(s,c,m,f);return;case"option":for(q in o)o.hasOwnProperty(q)&&(c=o[q],c!=null)&&(q==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Ks(s,a,q,c,o,null));return;case"dialog":hs("beforetoggle",s),hs("toggle",s),hs("cancel",s),hs("close",s);break;case"iframe":case"object":hs("load",s);break;case"video":case"audio":for(c=0;c<Vc.length;c++)hs(Vc[c],s);break;case"image":hs("error",s),hs("load",s);break;case"details":hs("toggle",s);break;case"embed":case"source":case"link":hs("error",s),hs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in o)if(o.hasOwnProperty(le)&&(c=o[le],c!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,le,c,o,null)}return;default:if(gn(a)){for(je in o)o.hasOwnProperty(je)&&(c=o[je],c!==void 0&&Zf(s,a,je,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Ks(s,a,S,c,o,null))}function $j(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,S=null,q=null,le=null,je=null;for(ye in o){var Ie=o[ye];if(o.hasOwnProperty(ye)&&Ie!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":q=Ie;default:c.hasOwnProperty(ye)||Ks(s,a,ye,null,c,Ie)}}for(var ue in c){var ye=c[ue];if(Ie=o[ue],c.hasOwnProperty(ue)&&(ye!=null||Ie!=null))switch(ue){case"type":f=ye;break;case"name":m=ye;break;case"checked":le=ye;break;case"defaultChecked":je=ye;break;case"value":w=ye;break;case"defaultValue":S=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,a));break;default:ye!==Ie&&Ks(s,a,ue,ye,c,Ie)}}ge(s,w,S,q,le,je,f,m);return;case"select":ye=w=S=ue=null;for(f in o)if(q=o[f],o.hasOwnProperty(f)&&q!=null)switch(f){case"value":break;case"multiple":ye=q;default:c.hasOwnProperty(f)||Ks(s,a,f,null,c,q)}for(m in c)if(f=c[m],q=o[m],c.hasOwnProperty(m)&&(f!=null||q!=null))switch(m){case"value":ue=f;break;case"defaultValue":S=f;break;case"multiple":w=f;default:f!==q&&Ks(s,a,m,f,c,q)}a=S,o=w,c=ye,ue!=null?ut(s,!!o,ue,!1):!!c!=!!o&&(a!=null?ut(s,!!o,a,!0):ut(s,!!o,o?[]:"",!1));return;case"textarea":ye=ue=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ks(s,a,S,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":ue=m;break;case"defaultValue":ye=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Ks(s,a,w,m,c,f)}Ht(s,ue,ye);return;case"option":for(var mt in o)ue=o[mt],o.hasOwnProperty(mt)&&ue!=null&&!c.hasOwnProperty(mt)&&(mt==="selected"?s.selected=!1:Ks(s,a,mt,null,c,ue));for(q in c)ue=c[q],ye=o[q],c.hasOwnProperty(q)&&ue!==ye&&(ue!=null||ye!=null)&&(q==="selected"?s.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":Ks(s,a,q,ue,c,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in o)ue=o[Mt],o.hasOwnProperty(Mt)&&ue!=null&&!c.hasOwnProperty(Mt)&&Ks(s,a,Mt,null,c,ue);for(le in c)if(ue=c[le],ye=o[le],c.hasOwnProperty(le)&&ue!==ye&&(ue!=null||ye!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,a));break;default:Ks(s,a,le,ue,c,ye)}return;default:if(gn(a)){for(var Ys in o)ue=o[Ys],o.hasOwnProperty(Ys)&&ue!==void 0&&!c.hasOwnProperty(Ys)&&Zf(s,a,Ys,void 0,c,ue);for(je in c)ue=c[je],ye=o[je],!c.hasOwnProperty(je)||ue===ye||ue===void 0&&ye===void 0||Zf(s,a,je,ue,c,ye);return}}for(var te in o)ue=o[te],o.hasOwnProperty(te)&&ue!=null&&!c.hasOwnProperty(te)&&Ks(s,a,te,null,c,ue);for(Ie in c)ue=c[Ie],ye=o[Ie],!c.hasOwnProperty(Ie)||ue===ye||ue==null&&ye==null||Ks(s,a,Ie,ue,c,ye)}function $v(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Wj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,S=m.duration;if(f&&S&&$v(w)){for(w=0,S=m.responseEnd,c+=1;c<o.length;c++){var q=o[c],le=q.startTime;if(le>S)break;var je=q.transferSize,Ie=q.initiatorType;je&&$v(Ie)&&(q=q.responseEnd,w+=je*(q<S?1:(S-le)/(q-le)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ep=null,tp=null;function Ud(s){return s.nodeType===9?s:s.ownerDocument}function Wv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gv(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function sp(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var np=null;function Gj(){var s=window.event;return s&&s.type==="popstate"?s===np?!1:(np=s,!0):(np=null,!1)}var Kv=typeof setTimeout=="function"?setTimeout:void 0,Kj=typeof clearTimeout=="function"?clearTimeout:void 0,Yv=typeof Promise=="function"?Promise:void 0,Yj=typeof queueMicrotask=="function"?queueMicrotask:typeof Yv<"u"?function(s){return Yv.resolve(null).then(s).catch(Qj)}:Kv;function Qj(s){setTimeout(function(){throw s})}function Bi(s){return s==="head"}function Qv(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Il(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Uc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Uc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,S=f.nodeName;f[fn]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Uc(s.ownerDocument.body);o=m}while(o);Il(a)}function Xv(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function rp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rp(o),kn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Xj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[fn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ra(s.nextSibling),s===null)break}return null}function Jj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ra(s.nextSibling),s===null))return null;return s}function Jv(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ra(s.nextSibling),s===null))return null;return s}function ap(s){return s.data==="$?"||s.data==="$~"}function ip(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Zj(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ra(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var op=null;function Zv(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ra(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function e1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function t1(s,a,o){switch(a=Ud(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Uc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);kn(s)}var aa=new Map,s1=new Set;function Fd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var li=re.d;re.d={f:eT,r:tT,D:sT,C:nT,L:rT,m:aT,X:oT,S:iT,M:lT};function eT(){var s=li.f(),a=Md();return s||a}function tT(s){var a=pn(s);a!==null&&a.tag===5&&a.type==="form"?v0(a):li.r(s)}var Rl=typeof document>"u"?null:document;function n1(s,a,o){var c=Rl;if(c&&typeof a=="string"&&a){var m=be(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),s1.has(m)||(s1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),nr(a,"link",s),N(a),c.head.appendChild(a)))}}function sT(s){li.D(s),n1("dns-prefetch",s,null)}function nT(s,a){li.C(s,a),n1("preconnect",s,a)}function rT(s,a,o){li.L(s,a,o);var c=Rl;if(c&&s&&a){var m='link[rel="preload"][as="'+be(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+be(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+be(o.imageSizes)+'"]')):m+='[href="'+be(s)+'"]';var f=m;switch(a){case"style":f=Al(s);break;case"script":f=Ml(s)}aa.has(f)||(s=x({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),aa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Fc(f))||a==="script"&&c.querySelector(zc(f))||(a=c.createElement("link"),nr(a,"link",s),N(a),c.head.appendChild(a)))}}function aT(s,a){li.m(s,a);var o=Rl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+be(c)+'"][href="'+be(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Ml(s)}if(!aa.has(f)&&(s=x({rel:"modulepreload",href:s},a),aa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(zc(f)))return}c=o.createElement("link"),nr(c,"link",s),N(c),o.head.appendChild(c)}}}function iT(s,a,o){li.S(s,a,o);var c=Rl;if(c&&s){var m=j(c).hoistableStyles,f=Al(s);a=a||"default";var w=m.get(f);if(!w){var S={loading:0,preload:null};if(w=c.querySelector(Fc(f)))S.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":a},o),(o=aa.get(f))&&lp(s,o);var q=w=c.createElement("link");N(q),nr(q,"link",s),q._p=new Promise(function(le,je){q.onload=le,q.onerror=je}),q.addEventListener("load",function(){S.loading|=1}),q.addEventListener("error",function(){S.loading|=2}),S.loading|=4,zd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:S},m.set(f,w)}}}function oT(s,a){li.X(s,a);var o=Rl;if(o&&s){var c=j(o).hoistableScripts,m=Ml(s),f=c.get(m);f||(f=o.querySelector(zc(m)),f||(s=x({src:s,async:!0},a),(a=aa.get(m))&&cp(s,a),f=o.createElement("script"),N(f),nr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function lT(s,a){li.M(s,a);var o=Rl;if(o&&s){var c=j(o).hoistableScripts,m=Ml(s),f=c.get(m);f||(f=o.querySelector(zc(m)),f||(s=x({src:s,async:!0,type:"module"},a),(a=aa.get(m))&&cp(s,a),f=o.createElement("script"),N(f),nr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function r1(s,a,o,c){var m=(m=Be.current)?Fd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Al(o.href),o=j(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Al(o.href);var f=j(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Fc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),aa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},aa.set(s,o),f||cT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ml(o),o=j(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Al(s){return'href="'+be(s)+'"'}function Fc(s){return'link[rel="stylesheet"]['+s+"]"}function a1(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function cT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),nr(a,"link",o),N(a),s.head.appendChild(a))}function Ml(s){return'[src="'+be(s)+'"]'}function zc(s){return"script[async]"+s}function i1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+be(o.href)+'"]');if(c)return a.instance=c,N(c),c;var m=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),N(c),nr(c,"style",m),zd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Al(o.href);var f=s.querySelector(Fc(m));if(f)return a.state.loading|=4,a.instance=f,N(f),f;c=a1(o),(m=aa.get(m))&&lp(c,m),f=(s.ownerDocument||s).createElement("link"),N(f);var w=f;return w._p=new Promise(function(S,q){w.onload=S,w.onerror=q}),nr(f,"link",c),a.state.loading|=4,zd(f,o.precedence,s),a.instance=f;case"script":return f=Ml(o.src),(m=s.querySelector(zc(f)))?(a.instance=m,N(m),m):(c=o,(m=aa.get(f))&&(c=x({},o),cp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),N(m),nr(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,zd(c,o.precedence,s));return a.instance}function zd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var S=c[w];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function lp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function cp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var qd=null;function o1(s,a,o){if(qd===null){var c=new Map,m=qd=new Map;m.set(o,c)}else m=qd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[fn]||f[ot]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var S=c.get(w);S?S.push(f):c.set(w,[f])}}return c}function l1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function uT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function c1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function dT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Al(c.href),f=a.querySelector(Fc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Hd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,N(f);return}f=a.ownerDocument||a,c=a1(c),(m=aa.get(m))&&lp(c,m),f=f.createElement("link"),N(f);var w=f;w._p=new Promise(function(S,q){w.onload=S,w.onerror=q}),nr(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Hd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var up=0;function hT(s,a){return s.stylesheets&&s.count===0&&Wd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&up===0&&(up=62500*Wj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>up?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Hd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var $d=null;function Wd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,$d=new Map,a.forEach(mT,s),$d=null,Hd.call(s))}function mT(s,a){if(!(a.state.loading&4)){var o=$d.get(s);if(o)var c=o.get(null);else{o=new Map,$d.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Hd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var qc={$$typeof:se,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function fT(s,a,o,c,m,f,w,S,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rt(0),this.hiddenUpdates=Rt(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function u1(s,a,o,c,m,f,w,S,q,le,je,Ie){return s=new fT(s,a,o,w,q,le,je,Ie,S),a=1,f===!0&&(a|=24),f=Fr(3,null,null,a),s.current=f,f.stateNode=s,a=zm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Wm(f),s}function d1(s){return s?(s=cl,s):cl}function h1(s,a,o,c,m,f){m=d1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ni(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ci(s,c,a),o!==null&&(Lr(o,s,a),wc(o,s,a))}function m1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function dp(s,a){m1(s,a),(s=s.alternate)&&m1(s,a)}function f1(s){if(s.tag===13||s.tag===31){var a=wo(s,67108864);a!==null&&Lr(a,s,67108864),dp(s,67108864)}}function p1(s){if(s.tag===13||s.tag===31){var a=Wr();a=$(a);var o=wo(s,a);o!==null&&Lr(o,s,a),dp(s,a)}}var Gd=!0;function pT(s,a,o,c){var m=B.T;B.T=null;var f=re.p;try{re.p=2,hp(s,a,o,c)}finally{re.p=f,B.T=m}}function gT(s,a,o,c){var m=B.T;B.T=null;var f=re.p;try{re.p=8,hp(s,a,o,c)}finally{re.p=f,B.T=m}}function hp(s,a,o,c){if(Gd){var m=mp(c);if(m===null)Jf(s,a,c,Kd,o),y1(s,c);else if(bT(m,s,a,o,c))c.stopPropagation();else if(y1(s,c),a&4&&-1<yT.indexOf(s)){for(;m!==null;){var f=pn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=$e(f.pendingLanes);if(w!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;w;){var q=1<<31-Ee(w);S.entanglements[1]|=q,w&=~q}Ma(f),(Os&6)===0&&(Rd=Dt()+500,Oc(0))}}break;case 31:case 13:S=wo(f,2),S!==null&&Lr(S,f,2),Md(),dp(f,2)}if(f=mp(c),f===null&&Jf(s,a,c,Kd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Jf(s,a,c,null,o)}}function mp(s){return s=dn(s),fp(s)}var Kd=null;function fp(s){if(Kd=null,s=Mn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Kd=s,null}function g1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Tt()){case rs:return 2;case As:return 8;case Ut:case Xs:return 32;case Pt:return 268435456;default:return 32}default:return 32}}var pp=!1,Ui=null,Fi=null,zi=null,Hc=new Map,$c=new Map,qi=[],yT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function y1(s,a){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":Hc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(a.pointerId)}}function Wc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=pn(a),a!==null&&f1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function bT(s,a,o,c,m){switch(a){case"focusin":return Ui=Wc(Ui,s,a,o,c,m),!0;case"dragenter":return Fi=Wc(Fi,s,a,o,c,m),!0;case"mouseover":return zi=Wc(zi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Hc.set(f,Wc(Hc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,$c.set(f,Wc($c.get(f)||null,s,a,o,c,m)),!0}return!1}function b1(s){var a=Mn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Se(s.priority,function(){p1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Se(s.priority,function(){p1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=mp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Js=c,o.target.dispatchEvent(c),Js=null}else return a=pn(o),a!==null&&f1(a),s.blockedOn=o,!1;a.shift()}return!0}function v1(s,a,o){Yd(s)&&o.delete(a)}function vT(){pp=!1,Ui!==null&&Yd(Ui)&&(Ui=null),Fi!==null&&Yd(Fi)&&(Fi=null),zi!==null&&Yd(zi)&&(zi=null),Hc.forEach(v1),$c.forEach(v1)}function Qd(s,a){s.blockedOn===a&&(s.blockedOn=null,pp||(pp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,vT)))}var Xd=null;function x1(s){Xd!==s&&(Xd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Xd===s&&(Xd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(fp(c||o)===null)continue;break}var f=pn(o);f!==null&&(s.splice(a,3),a-=3,mf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Il(s){function a(q){return Qd(q,s)}Ui!==null&&Qd(Ui,s),Fi!==null&&Qd(Fi,s),zi!==null&&Qd(zi,s),Hc.forEach(a),$c.forEach(a);for(var o=0;o<qi.length;o++){var c=qi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<qi.length&&(o=qi[0],o.blockedOn===null);)b1(o),o.blockedOn===null&&qi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[bt]||null;if(typeof f=="function")w||x1(o);else if(w){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[bt]||null)S=w.formAction;else if(fp(m)!==null)continue}else S=w.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),x1(o)}}}function w1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function gp(s){this._internalRoot=s}Jd.prototype.render=gp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Wr();h1(o,c,s,a,null,null)},Jd.prototype.unmount=gp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;h1(s.current,2,null,s,null,null),Md(),a[Je]=null}};function Jd(s){this._internalRoot=s}Jd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ce();s={blockedOn:null,target:s,priority:a};for(var o=0;o<qi.length&&a!==0&&a<qi[o].priority;o++);qi.splice(o,0,s),o===0&&b1(s)}};var _1=e.version;if(_1!=="19.2.4")throw Error(i(527,_1,"19.2.4"));re.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var xT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{ve=Zd.inject(xT),G=Zd}catch{}}return Kc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=C0,f=R0,w=A0;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=u1(s,1,!1,null,null,o,c,null,m,f,w,w1),s[Je]=a.current,Xf(s),new gp(a)},Kc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=C0,w=R0,S=A0,q=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),a=u1(s,1,!0,a,o??null,c,m,q,f,w,S,w1),a.context=d1(null),o=a.current,c=Wr(),c=$(c),m=Ni(c),m.callback=null,Ci(o,m,c),o=c,a.current.lanes=o,_s(a,o),Ma(a),s[Je]=a.current,Xf(s),new Jd(a)},Kc.version="19.2.4",Kc}var M1;function RT(){if(M1)return vp.exports;M1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vp.exports=CT(),vp.exports}var AT=RT();const MT="modulepreload",IT=function(n){return"/login/"+n},I1={},Rr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(_=>Promise.resolve(_).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=IT(y),y in I1)return;I1[y]=!0;const _=y.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${x}`))return;const T=document.createElement("link");if(T.rel=_?"stylesheet":MT,_||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),_)return new Promise((V,W)=>{T.addEventListener("load",V),T.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var D1="popstate";function DT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return ng("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:pu(l)}return LT(e,t,null,n)}function cn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function oa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PT(){return Math.random().toString(36).substring(2,10)}function P1(n,e){return{usr:n.state,key:n.key,idx:e}}function ng(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?sc(e):e,state:t,key:e&&e.key||i||PT()}}function pu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function sc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function LT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=_();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function _(){return(d.state||{idx:null}).idx}function x(){p="POP";let U=_(),Z=U==null?null:U-y;y=U,g&&g({action:p,location:z.location,delta:Z})}function T(U,Z){p="PUSH";let K=ng(z.location,U,Z);y=_()+1;let se=P1(K,y),he=z.createHref(K);try{d.pushState(se,"",he)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;l.location.assign(he)}u&&g&&g({action:p,location:z.location,delta:1})}function V(U,Z){p="REPLACE";let K=ng(z.location,U,Z);y=_();let se=P1(K,y),he=z.createHref(K);d.replaceState(se,"",he),u&&g&&g({action:p,location:z.location,delta:0})}function W(U){return OT(U)}let z={get action(){return p},get location(){return n(l,d)},listen(U){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(D1,x),g=U,()=>{l.removeEventListener(D1,x),g=null}},createHref(U){return e(l,U)},createURL:W,encodeLocation(U){let Z=W(U);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:T,replace:V,go(U){return d.go(U)}};return z}function OT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),cn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:pu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function P2(n,e,t="/"){return VT(n,e,t,!1)}function VT(n,e,t,i){let l=typeof e=="string"?sc(e):e,u=fi(l.pathname||"/",t);if(u==null)return null;let d=L2(n);BT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=QT(u);p=KT(d[g],y,i)}return p}function L2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let _={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&g)return;cn(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let x=di([i,_.relativePath]),T=t.concat(_);d.children&&d.children.length>0&&(cn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),L2(d.children,e,T,x,g)),!(d.path==null&&!d.index)&&e.push({path:x,score:WT(x,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of O2(d.path))u(d,p,!0,g)}),e}function O2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=O2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function BT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:GT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var UT=/^:[\w-]+$/,FT=3,zT=2,qT=1,HT=10,$T=-2,L1=n=>n==="*";function WT(n,e){let t=n.split("/"),i=t.length;return t.some(L1)&&(i+=$T),e&&(i+=zT),t.filter(l=>!L1(l)).reduce((l,u)=>l+(UT.test(u)?FT:u===""?qT:HT),i)}function GT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function KT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,_=u==="/"?e:e.slice(u.length)||"/",x=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},_),T=g.route;if(!x&&y&&t&&!i[i.length-1].route.index&&(x=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},_)),!x)return null;Object.assign(l,x.params),d.push({params:l,pathname:di([u,x.pathname]),pathnameBase:eE(di([u,x.pathnameBase])),route:T}),x.pathnameBase!=="/"&&(u=di([u,x.pathnameBase]))}return d}function Sh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=YT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:_,isOptional:x},T)=>{if(_==="*"){let W=p[T]||"";d=u.slice(0,u.length-W.length).replace(/(.)\/+$/,"$1")}const V=p[T];return x&&!V?y[_]=void 0:y[_]=(V||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function YT(n,e=!1,t=!0){oa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function QT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return oa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function fi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var XT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function JT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?sc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=O1(t.substring(1),"/"):u=O1(t,e)):u=e,{pathname:u,search:tE(i),hash:sE(l)}}function O1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function kp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Og(n){let e=ZT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Vg(n,e,t,i=!1){let l;typeof n=="string"?l=sc(n):(l={...n},cn(!l.pathname||!l.pathname.includes("?"),kp("?","pathname","search",l)),cn(!l.pathname||!l.pathname.includes("#"),kp("#","pathname","hash",l)),cn(!l.search||!l.search.includes("#"),kp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let x=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),x-=1;l.pathname=T.join("/")}p=x>=0?e[x]:"/"}let g=JT(l,p),y=d&&d!=="/"&&d.endsWith("/"),_=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||_)&&(g.pathname+="/"),g}var di=n=>n.join("/").replace(/\/\/+/g,"/"),eE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),tE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,sE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,nE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function rE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function aE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var V2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function B2(n,e){let t=n;if(typeof t!="string"||!XT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(V2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=fi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{oa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var U2=["POST","PUT","PATCH","DELETE"];new Set(U2);var iE=["GET",...U2];new Set(iE);var nc=v.createContext(null);nc.displayName="DataRouter";var Qh=v.createContext(null);Qh.displayName="DataRouterState";var oE=v.createContext(!1),F2=v.createContext({isTransitioning:!1});F2.displayName="ViewTransition";var lE=v.createContext(new Map);lE.displayName="Fetchers";var cE=v.createContext(null);cE.displayName="Await";var Yr=v.createContext(null);Yr.displayName="Navigation";var Nu=v.createContext(null);Nu.displayName="Location";var Ta=v.createContext({outlet:null,matches:[],isDataRoute:!1});Ta.displayName="Route";var Bg=v.createContext(null);Bg.displayName="RouteError";var z2="REACT_ROUTER_ERROR",uE="REDIRECT",dE="ROUTE_ERROR_RESPONSE";function hE(n){if(n.startsWith(`${z2}:${uE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function mE(n){if(n.startsWith(`${z2}:${dE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new nE(e.status,e.statusText,e.data)}catch{}}function fE(n,{relative:e}={}){cn(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Yr),{hash:l,pathname:u,search:d}=Cu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:di([t,u])),i.createHref({pathname:p,search:d,hash:l})}function rc(){return v.useContext(Nu)!=null}function Ea(){return cn(rc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Nu).location}var q2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function H2(n){v.useContext(Yr).static||v.useLayoutEffect(n)}function Jn(){let{isDataRoute:n}=v.useContext(Ta);return n?NE():pE()}function pE(){cn(rc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(nc),{basename:e,navigator:t}=v.useContext(Yr),{matches:i}=v.useContext(Ta),{pathname:l}=Ea(),u=JSON.stringify(Og(i)),d=v.useRef(!1);return H2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(oa(d.current,q2),!d.current)return;if(typeof g=="number"){t.go(g);return}let _=Vg(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:di([e,_.pathname])),(y.replace?t.replace:t.push)(_,y.state,y)},[e,t,u,l,n])}v.createContext(null);function gE(){let{matches:n}=v.useContext(Ta),e=n[n.length-1];return e?e.params:{}}function Cu(n,{relative:e}={}){let{matches:t}=v.useContext(Ta),{pathname:i}=Ea(),l=JSON.stringify(Og(t));return v.useMemo(()=>Vg(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function yE(n,e){return $2(n,e)}function $2(n,e,t,i,l){cn(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Yr),{matches:d}=v.useContext(Ta),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",_=p?p.pathnameBase:"/",x=p&&p.route;{let K=x&&x.path||"";G2(y,!x||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let T=Ea(),V;if(e){let K=typeof e=="string"?sc(e):e;cn(_==="/"||K.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${K.pathname}" was given in the \`location\` prop.`),V=K}else V=T;let W=V.pathname||"/",z=W;if(_!=="/"){let K=_.replace(/^\//,"").split("/");z="/"+W.replace(/^\//,"").split("/").slice(K.length).join("/")}let U=P2(n,{pathname:z});oa(x||U!=null,`No routes matched location "${V.pathname}${V.search}${V.hash}" `),oa(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${V.pathname}${V.search}${V.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Z=_E(U&&U.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:di([_,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?_:di([_,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&Z?v.createElement(Nu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...V},navigationType:"POP"}},Z):Z}function bE(){let n=SE(),e=rE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var vE=v.createElement(bE,null),W2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=mE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(Ta.Provider,{value:this.props.routeContext},v.createElement(Bg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(xE,{error:n},e):e}};W2.contextType=oE;var jp=new WeakMap;function xE({children:n,error:e}){let{basename:t}=v.useContext(Yr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=hE(e.digest);if(i){let l=jp.get(e);if(l)throw l;let u=B2(i.location,t);if(V2&&!jp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw jp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function wE({routeContext:n,match:e,children:t}){let i=v.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(Ta.Provider,{value:n},t)}function _E(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let _=u.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);cn(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,_+1))}let p=!1,g=-1;if(t)for(let _=0;_<u.length;_++){let x=u[_];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(g=_),x.route.id){let{loaderData:T,errors:V}=t,W=x.route.loader&&!T.hasOwnProperty(x.route.id)&&(!V||V[x.route.id]===void 0);if(x.route.lazy||W){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(_,x)=>{i(_,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:aE(t.matches),errorInfo:x})}:void 0;return u.reduceRight((_,x,T)=>{let V,W=!1,z=null,U=null;t&&(V=d&&x.route.id?d[x.route.id]:void 0,z=x.route.errorElement||vE,p&&(g<0&&T===0?(G2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),W=!0,U=null):g===T&&(W=!0,U=x.route.hydrateFallbackElement||null)));let Z=e.concat(u.slice(0,T+1)),K=()=>{let se;return V?se=z:W?se=U:x.route.Component?se=v.createElement(x.route.Component,null):x.route.element?se=x.route.element:se=_,v.createElement(wE,{match:x,routeContext:{outlet:_,matches:Z,isDataRoute:t!=null},children:se})};return t&&(x.route.ErrorBoundary||x.route.errorElement||T===0)?v.createElement(W2,{location:t.location,revalidation:t.revalidation,component:z,error:V,children:K(),routeContext:{outlet:null,matches:Z,isDataRoute:!0},onError:y}):K()},null)}function Ug(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kE(n){let e=v.useContext(nc);return cn(e,Ug(n)),e}function jE(n){let e=v.useContext(Qh);return cn(e,Ug(n)),e}function TE(n){let e=v.useContext(Ta);return cn(e,Ug(n)),e}function Fg(n){let e=TE(n),t=e.matches[e.matches.length-1];return cn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function EE(){return Fg("useRouteId")}function SE(){let n=v.useContext(Bg),e=jE("useRouteError"),t=Fg("useRouteError");return n!==void 0?n:e.errors?.[t]}function NE(){let{router:n}=kE("useNavigate"),e=Fg("useNavigate"),t=v.useRef(!1);return H2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{oa(t.current,q2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var V1={};function G2(n,e,t){!e&&!V1[n]&&(V1[n]=!0,oa(!1,t))}v.memo(CE);function CE({routes:n,future:e,state:t,onError:i}){return $2(n,void 0,t,i,e)}function RE({to:n,replace:e,state:t,relative:i}){cn(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Yr);oa(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(Ta),{pathname:d}=Ea(),p=Jn(),g=Vg(n,Og(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function tn(n){cn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function AE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){cn(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=sc(t));let{pathname:y="/",search:_="",hash:x="",state:T=null,key:V="default"}=t,W=v.useMemo(()=>{let z=fi(y,p);return z==null?null:{location:{pathname:z,search:_,hash:x,state:T,key:V},navigationType:i}},[p,y,_,x,T,V,i]);return oa(W!=null,`<Router basename="${p}"> is not able to match the URL "${y}${_}${x}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:v.createElement(Yr.Provider,{value:g},v.createElement(Nu.Provider,{children:e,value:W}))}function ME({children:n,location:e}){return yE(rg(n),e)}function rg(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,rg(i.props.children,u));return}cn(i.type===tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=rg(i.props.children,u)),t.push(d)}),t}var ph="get",gh="application/x-www-form-urlencoded";function Xh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function IE(n){return Xh(n)&&n.tagName.toLowerCase()==="button"}function DE(n){return Xh(n)&&n.tagName.toLowerCase()==="form"}function PE(n){return Xh(n)&&n.tagName.toLowerCase()==="input"}function LE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function OE(n,e){return n.button===0&&(!e||e==="_self")&&!LE(n)}function ag(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function VE(n,e){let t=ag(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var eh=null;function BE(){if(eh===null)try{new FormData(document.createElement("form"),0),eh=!1}catch{eh=!0}return eh}var UE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Tp(n){return n!=null&&!UE.has(n)?(oa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gh}"`),null):n}function FE(n,e){let t,i,l,u,d;if(DE(n)){let p=n.getAttribute("action");i=p?fi(p,e):null,t=n.getAttribute("method")||ph,l=Tp(n.getAttribute("enctype"))||gh,u=new FormData(n)}else if(IE(n)||PE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?fi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||ph,l=Tp(n.getAttribute("formenctype"))||Tp(p.getAttribute("enctype"))||gh,u=new FormData(p,n),!BE()){let{name:y,type:_,value:x}=n;if(_==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,x)}}else{if(Xh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ph,i=null,l=gh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&fi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function qE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function $E(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await qE(u,t);return d.links?d.links():[]}return[]}));return YE(i.flat(1).filter(HE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function B1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let _=i.routes[g.route.id];if(!_||!_.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let x=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function WE(n,e,{includeHydrateFallback:t}={}){return GE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function GE(n){return[...new Set(n)]}function KE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function YE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(KE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function K2(){let n=v.useContext(nc);return zg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function QE(){let n=v.useContext(Qh);return zg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var qg=v.createContext(void 0);qg.displayName="FrameworkContext";function Y2(){let n=v.useContext(qg);return zg(n,"You must render this element inside a <HydratedRouter> element"),n}function XE(n,e){let t=v.useContext(qg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:_,onTouchStart:x}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let z=Z=>{Z.forEach(K=>{d(K.isIntersecting)})},U=new IntersectionObserver(z,{threshold:.5});return T.current&&U.observe(T.current),()=>{U.disconnect()}}},[n]),v.useEffect(()=>{if(i){let z=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(z)}}},[i]);let V=()=>{l(!0)},W=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Yc(p,V),onBlur:Yc(g,W),onMouseEnter:Yc(y,V),onMouseLeave:Yc(_,W),onTouchStart:Yc(x,V)}]:[!1,T,{}]}function Yc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function JE({page:n,...e}){let{router:t}=K2(),i=v.useMemo(()=>P2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(eS,{page:n,matches:i,...e}):null}function ZE(n){let{manifest:e,routeModules:t}=Y2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return $E(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function eS({page:n,matches:e,...t}){let i=Ea(),{future:l,manifest:u,routeModules:d}=Y2(),{basename:p}=K2(),{loaderData:g,matches:y}=QE(),_=v.useMemo(()=>B1(n,e,y,u,i,"data"),[n,e,y,u,i]),x=v.useMemo(()=>B1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let z=new Set,U=!1;if(e.forEach(K=>{let se=u.routes[K.route.id];!se||!se.hasLoader||(!_.some(he=>he.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||se.hasClientLoader?U=!0:z.add(K.route.id))}),z.size===0)return[];let Z=zE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return U&&z.size>0&&Z.searchParams.set("_routes",e.filter(K=>z.has(K.route.id)).map(K=>K.route.id).join(",")),[Z.pathname+Z.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,_,e,n,d]),V=v.useMemo(()=>WE(x,u),[x,u]),W=ZE(x);return v.createElement(v.Fragment,null,T.map(z=>v.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...t})),V.map(z=>v.createElement("link",{key:z,rel:"modulepreload",href:z,...t})),W.map(({key:z,link:U})=>v.createElement("link",{key:z,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function tS(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var sS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sS&&(window.__reactRouterVersion="7.13.0")}catch{}function nS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=DT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(AE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Q2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:_,viewTransition:x,unstable_defaultShouldRevalidate:T,...V},W){let{basename:z,unstable_useTransitions:U}=v.useContext(Yr),Z=typeof y=="string"&&Q2.test(y),K=B2(y,z);y=K.to;let se=fE(y,{relative:l}),[he,Me,we]=XE(i,V),C=oS(y,{replace:d,state:p,target:g,preventScrollReset:_,relative:l,viewTransition:x,unstable_defaultShouldRevalidate:T,unstable_useTransitions:U});function E(O){e&&e(O),O.defaultPrevented||C(O)}let R=v.createElement("a",{...V,...we,href:K.absoluteURL||se,onClick:K.isExternal||u?e:E,ref:tS(W,Me),target:g,"data-discover":!Z&&t==="render"?"true":void 0});return he&&!Z?v.createElement(v.Fragment,null,R,v.createElement(JE,{page:se})):R});X2.displayName="Link";var rS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},_){let x=Cu(d,{relative:y.relative}),T=Ea(),V=v.useContext(Qh),{navigator:W,basename:z}=v.useContext(Yr),U=V!=null&&mS(x)&&p===!0,Z=W.encodeLocation?W.encodeLocation(x).pathname:x.pathname,K=T.pathname,se=V&&V.navigation&&V.navigation.location?V.navigation.location.pathname:null;t||(K=K.toLowerCase(),se=se?se.toLowerCase():null,Z=Z.toLowerCase()),se&&z&&(se=fi(se,z)||se);const he=Z!=="/"&&Z.endsWith("/")?Z.length-1:Z.length;let Me=K===Z||!l&&K.startsWith(Z)&&K.charAt(he)==="/",we=se!=null&&(se===Z||!l&&se.startsWith(Z)&&se.charAt(Z.length)==="/"),C={isActive:Me,isPending:we,isTransitioning:U},E=Me?e:void 0,R;typeof i=="function"?R=i(C):R=[i,Me?"active":null,we?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let O=typeof u=="function"?u(C):u;return v.createElement(X2,{...y,"aria-current":E,className:R,ref:_,style:O,to:d,viewTransition:p},typeof g=="function"?g(C):g)});rS.displayName="NavLink";var aS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=ph,action:p,onSubmit:g,relative:y,preventScrollReset:_,viewTransition:x,unstable_defaultShouldRevalidate:T,...V},W)=>{let{unstable_useTransitions:z}=v.useContext(Yr),U=dS(),Z=hS(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",se=typeof p=="string"&&Q2.test(p),he=Me=>{if(g&&g(Me),Me.defaultPrevented)return;Me.preventDefault();let we=Me.nativeEvent.submitter,C=we?.getAttribute("formmethod")||d,E=()=>U(we||Me.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:_,viewTransition:x,unstable_defaultShouldRevalidate:T});z&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:W,method:K,action:Z,onSubmit:i?g:he,...V,"data-discover":!se&&n==="render"?"true":void 0})});aS.displayName="Form";function iS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function J2(n){let e=v.useContext(nc);return cn(e,iS(n)),e}function oS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Jn(),_=Ea(),x=Cu(n,{relative:u});return v.useCallback(T=>{if(OE(T,e)){T.preventDefault();let V=t!==void 0?t:pu(_)===pu(x),W=()=>y(n,{replace:V,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>W()):W()}},[_,y,x,t,i,e,n,l,u,d,p,g])}function lS(n){oa(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(ag(n)),t=v.useRef(!1),i=Ea(),l=v.useMemo(()=>VE(i.search,t.current?null:e.current),[i.search]),u=Jn(),d=v.useCallback((p,g)=>{const y=ag(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var cS=0,uS=()=>`__${String(++cS)}__`;function dS(){let{router:n}=J2("useSubmit"),{basename:e}=v.useContext(Yr),t=EE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:_,body:x}=FE(u,e);if(d.navigate===!1){let T=d.fetcherKey||uS();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:_,body:x,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:_,body:x,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function hS(n,{relative:e}={}){let{basename:t}=v.useContext(Yr),i=v.useContext(Ta);cn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Cu(n||".",{relative:e})},d=Ea();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(_=>_==="")){p.delete("index"),g.filter(x=>x).forEach(x=>p.append("index",x));let _=p.toString();u.search=_?`?${_}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:di([t,u.pathname])),pu(u)}function mS(n,{relative:e}={}){let t=v.useContext(F2);cn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=J2("useViewTransitionState"),l=Cu(n,{relative:e});if(!t.isTransitioning)return!1;let u=fi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=fi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Sh(l.pathname,d)!=null||Sh(l.pathname,u)!=null}const fS=()=>{};var U1={};const Z2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},pS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},ew={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,_=u>>2,x=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,V=y&63;g||(V=64,d||(T=64)),i.push(t[_],t[x],t[T],t[V])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Z2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const x=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||x==null)throw new gS;const T=u<<2|p>>4;if(i.push(T),y!==64){const V=p<<4&240|y>>2;if(i.push(V),x!==64){const W=y<<6&192|x;i.push(W)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yS=function(n){const e=Z2(n);return ew.encodeByteArray(e,!0)},Nh=function(n){return yS(n).replace(/\./g,"")},tw=function(n){try{return ew.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const vS=()=>bS().__FIREBASE_DEFAULTS__,xS=()=>{if(typeof process>"u"||typeof U1>"u")return;const n=U1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tw(n[1]);return e&&JSON.parse(e)},Jh=()=>{try{return fS()||vS()||xS()||wS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},sw=n=>Jh()?.emulatorHosts?.[n],nw=n=>{const e=sw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},rw=()=>Jh()?.config,aw=n=>Jh()?.[`_${n}`];class _S{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hg(n){return(await fetch(n,{credentials:"include"})).ok}function iw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Nh(JSON.stringify(t)),Nh(JSON.stringify(d)),""].join(".")}const ou={};function kS(){const n={prod:[],emulator:[]};for(const e of Object.keys(ou))ou[e]?n.emulator.push(e):n.prod.push(e);return n}function jS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let F1=!1;function $g(n,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||ou[n]===e||ou[n]||F1)return;ou[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=kS().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,V){T.setAttribute("width","24"),T.setAttribute("id",V),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{F1=!0,d()},T}function _(T,V){T.setAttribute("id",V),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function x(){const T=jS(i),V=t("text"),W=document.getElementById(V)||document.createElement("span"),z=t("learnmore"),U=document.getElementById(z)||document.createElement("a"),Z=t("preprendIcon"),K=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const se=T.element;p(se),_(U,z);const he=y();g(K,Z),se.append(K,W,U,he),document.body.appendChild(se)}u?(W.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,W.innerText="Preview backend running in this workspace."),W.setAttribute("id",V)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function gr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gr())}function ES(){const n=Jh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function SS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function CS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RS(){const n=gr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function AS(){return!ES()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MS(){try{return typeof indexedDB=="object"}catch{return!1}}function IS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const DS="FirebaseError";class $a extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=DS,Object.setPrototypeOf(this,$a.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ru.prototype.create)}}class Ru{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new $a(l,p,i)}}function PS(n,e){return n.replace(LS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const LS=/\{\$([^}]+)}/g;function OS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $o(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(z1(u)&&z1(d)){if(!$o(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function z1(n){return n!==null&&typeof n=="object"}function Au(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function tu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function su(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function VS(n,e){const t=new BS(n,e);return t.subscribe.bind(t)}class BS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");US(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Ep),l.error===void 0&&(l.error=Ep),l.complete===void 0&&(l.complete=Ep);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function US(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ep(){}function Qs(n){return n&&n._delegate?n._delegate:n}class io{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Vo="[DEFAULT]";class FS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new _S;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qS(e))try{this.getOrInitializeService({instanceIdentifier:Vo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Vo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vo){return this.instances.has(e)}getOptions(e=Vo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:zS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Vo){return this.component?this.component.multipleInstances?e:Vo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zS(n){return n===Vo?void 0:n}function qS(n){return n.instantiationMode==="EAGER"}class HS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ys;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ys||(ys={}));const $S={debug:ys.DEBUG,verbose:ys.VERBOSE,info:ys.INFO,warn:ys.WARN,error:ys.ERROR,silent:ys.SILENT},WS=ys.INFO,GS={[ys.DEBUG]:"log",[ys.VERBOSE]:"log",[ys.INFO]:"info",[ys.WARN]:"warn",[ys.ERROR]:"error"},KS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=GS[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wg{constructor(e){this.name=e,this._logLevel=WS,this._logHandler=KS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ys))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$S[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ys.DEBUG,...e),this._logHandler(this,ys.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ys.VERBOSE,...e),this._logHandler(this,ys.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ys.INFO,...e),this._logHandler(this,ys.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ys.WARN,...e),this._logHandler(this,ys.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ys.ERROR,...e),this._logHandler(this,ys.ERROR,...e)}}const YS=(n,e)=>e.some(t=>n instanceof t);let q1,H1;function QS(){return q1||(q1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function XS(){return H1||(H1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ow=new WeakMap,ig=new WeakMap,lw=new WeakMap,Sp=new WeakMap,Gg=new WeakMap;function JS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(so(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&ow.set(t,n)}).catch(()=>{}),Gg.set(e,n),e}function ZS(n){if(ig.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ig.set(n,e)}let og={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ig.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function eN(n){og=n(og)}function tN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Np(this),e,...t);return lw.set(i,e.sort?e.sort():[e]),so(i)}:XS().includes(n)?function(...e){return n.apply(Np(this),e),so(ow.get(this))}:function(...e){return so(n.apply(Np(this),e))}}function sN(n){return typeof n=="function"?tN(n):(n instanceof IDBTransaction&&ZS(n),YS(n,QS())?new Proxy(n,og):n)}function so(n){if(n instanceof IDBRequest)return JS(n);if(Sp.has(n))return Sp.get(n);const e=sN(n);return e!==n&&(Sp.set(n,e),Gg.set(e,n)),e}const Np=n=>Gg.get(n);function nN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=so(d);return i&&d.addEventListener("upgradeneeded",g=>{i(so(d.result),g.oldVersion,g.newVersion,so(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const rN=["get","getKey","getAll","getAllKeys","count"],aN=["put","add","delete","clear"],Cp=new Map;function $1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cp.get(e))return Cp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=aN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||rN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Cp.set(e,u),u}eN(n=>({...n,get:(e,t,i)=>$1(e,t)||n.get(e,t,i),has:(e,t)=>!!$1(e,t)||n.has(e,t)}));class iN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function oN(n){return n.getComponent()?.type==="VERSION"}const lg="@firebase/app",W1="0.14.7";const pi=new Wg("@firebase/app"),lN="@firebase/app-compat",cN="@firebase/analytics-compat",uN="@firebase/analytics",dN="@firebase/app-check-compat",hN="@firebase/app-check",mN="@firebase/auth",fN="@firebase/auth-compat",pN="@firebase/database",gN="@firebase/data-connect",yN="@firebase/database-compat",bN="@firebase/functions",vN="@firebase/functions-compat",xN="@firebase/installations",wN="@firebase/installations-compat",_N="@firebase/messaging",kN="@firebase/messaging-compat",jN="@firebase/performance",TN="@firebase/performance-compat",EN="@firebase/remote-config",SN="@firebase/remote-config-compat",NN="@firebase/storage",CN="@firebase/storage-compat",RN="@firebase/firestore",AN="@firebase/ai",MN="@firebase/firestore-compat",IN="firebase",DN="12.8.0";const cg="[DEFAULT]",PN={[lg]:"fire-core",[lN]:"fire-core-compat",[uN]:"fire-analytics",[cN]:"fire-analytics-compat",[hN]:"fire-app-check",[dN]:"fire-app-check-compat",[mN]:"fire-auth",[fN]:"fire-auth-compat",[pN]:"fire-rtdb",[gN]:"fire-data-connect",[yN]:"fire-rtdb-compat",[bN]:"fire-fn",[vN]:"fire-fn-compat",[xN]:"fire-iid",[wN]:"fire-iid-compat",[_N]:"fire-fcm",[kN]:"fire-fcm-compat",[jN]:"fire-perf",[TN]:"fire-perf-compat",[EN]:"fire-rc",[SN]:"fire-rc-compat",[NN]:"fire-gcs",[CN]:"fire-gcs-compat",[RN]:"fire-fst",[MN]:"fire-fst-compat",[AN]:"fire-vertex","fire-js":"fire-js",[IN]:"fire-js-all"};const Ch=new Map,LN=new Map,ug=new Map;function G1(n,e){try{n.container.addComponent(e)}catch(t){pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Wo(n){const e=n.name;if(ug.has(e))return pi.debug(`There were multiple attempts to register component ${e}.`),!1;ug.set(e,n);for(const t of Ch.values())G1(t,n);for(const t of LN.values())G1(t,n);return!0}function Zh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Gr(n){return n==null?!1:n.settings!==void 0}const ON={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Ru("app","Firebase",ON);class VN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Zo=DN;function Kg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:cg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=rw()),!t)throw no.create("no-options");const u=Ch.get(l);if(u){if($o(t,u.options)&&$o(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new HS(l);for(const g of ug.values())d.addComponent(g);const p=new VN(t,i,d);return Ch.set(l,p),p}function Yg(n=cg){const e=Ch.get(n);if(!e&&n===cg&&rw())return Kg();if(!e)throw no.create("no-app",{appName:n});return e}function Oa(n,e,t){let i=PN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pi.warn(d.join(" "));return}Wo(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const BN="firebase-heartbeat-database",UN=1,gu="firebase-heartbeat-store";let Rp=null;function cw(){return Rp||(Rp=nN(BN,UN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(gu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),Rp}async function FN(n){try{const t=(await cw()).transaction(gu),i=await t.objectStore(gu).get(uw(n));return await t.done,i}catch(e){if(e instanceof $a)pi.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});pi.warn(t.message)}}}async function K1(n,e){try{const i=(await cw()).transaction(gu,"readwrite");await i.objectStore(gu).put(e,uw(n)),await i.done}catch(t){if(t instanceof $a)pi.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});pi.warn(i.message)}}}function uw(n){return`${n.name}!${n.options.appId}`}const zN=1024,qN=30;class HN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Y1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>qN){const l=GN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){pi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Y1(),{heartbeatsToSend:t,unsentEntries:i}=$N(this._heartbeatsCache.heartbeats),l=Nh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return pi.warn(e),""}}}function Y1(){return new Date().toISOString().substring(0,10)}function $N(n,e=zN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),Q1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),Q1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class WN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MS()?IS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Q1(n){return Nh(JSON.stringify({version:2,heartbeats:n})).length}function GN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function KN(n){Wo(new io("platform-logger",e=>new iN(e),"PRIVATE")),Wo(new io("heartbeat",e=>new HN(e),"PRIVATE")),Oa(lg,W1,n),Oa(lg,W1,"esm2020"),Oa("fire-js","")}KN("");function dw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YN=dw,hw=new Ru("auth","Firebase",dw());const Rh=new Wg("@firebase/auth");function QN(n,...e){Rh.logLevel<=ys.WARN&&Rh.warn(`Auth (${Zo}): ${n}`,...e)}function yh(n,...e){Rh.logLevel<=ys.ERROR&&Rh.error(`Auth (${Zo}): ${n}`,...e)}function _a(n,...e){throw Qg(n,...e)}function Va(n,...e){return Qg(n,...e)}function mw(n,e,t){const i={...YN(),[e]:t};return new Ru("auth","Firebase",i).create(e,{appName:n.name})}function hi(n){return mw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return hw.create(n,...e)}function Lt(n,e,...t){if(!n)throw Qg(e,...t)}function ci(n){const e="INTERNAL ASSERTION FAILED: "+n;throw yh(e),new Error(e)}function gi(n,e){n||ci(e)}function dg(){return typeof self<"u"&&self.location?.href||""}function XN(){return X1()==="http:"||X1()==="https:"}function X1(){return typeof self<"u"&&self.location?.protocol||null}function JN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XN()||NS()||"connection"in navigator)?navigator.onLine:!0}function ZN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Mu{constructor(e,t){this.shortDelay=e,this.longDelay=t,gi(t>e,"Short delay should be less than long delay!"),this.isMobile=TS()||CS()}get(){return JN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xg(n,e){gi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class fw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ci("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ci("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ci("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sC=new Mu(3e4,6e4);function vi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function xi(n,e,t,i,l={}){return pw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Au({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return SS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&fo(n.emulatorConfig.host)&&(y.credentials="include"),fw.fetch()(await gw(n,n.config.apiHost,t,p),y)})}async function pw(n,e,t){n._canInitEmulator=!1;const i={...eC,...e};try{const l=new rC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw th(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw th(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw th(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw th(n,"user-disabled",d);const _=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw mw(n,_,y);_a(n,_)}}catch(l){if(l instanceof $a)throw l;_a(n,"network-request-failed",{message:String(l)})}}async function Iu(n,e,t,i,l={}){const u=await xi(n,e,t,i,l);return"mfaPendingCredential"in u&&_a(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function gw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Xg(n.config,l):`${n.config.apiScheme}://${l}`;return tC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function nC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Va(this.auth,"network-request-failed")),sC.get())})}}function th(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Va(n,e,i);return l.customData._tokenResponse=t,l}function J1(n){return n!==void 0&&n.enterprise!==void 0}class aC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function iC(n,e){return xi(n,"GET","/v2/recaptchaConfig",vi(n,e))}async function oC(n,e){return xi(n,"POST","/v1/accounts:delete",e)}async function Ah(n,e){return xi(n,"POST","/v1/accounts:lookup",e)}function lu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lC(n,e=!1){const t=Qs(n),i=await t.getIdToken(e),l=Jg(i);Lt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:lu(Ap(l.auth_time)),issuedAtTime:lu(Ap(l.iat)),expirationTime:lu(Ap(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ap(n){return Number(n)*1e3}function Jg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return yh("JWT malformed, contained fewer than 3 sections"),null;try{const l=tw(t);return l?JSON.parse(l):(yh("Failed to decode base64 JWT payload"),null)}catch(l){return yh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function Z1(n){const e=Jg(n);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function yu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof $a&&cC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function cC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class uC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class hg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=lu(this.lastLoginAt),this.creationTime=lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mh(n){const e=n.auth,t=await n.getIdToken(),i=await yu(n,Ah(e,{idToken:t}));Lt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?yw(l.providerUserInfo):[],d=hC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,_={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new hg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,_)}async function dC(n){const e=Qs(n);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function yw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mC(n,e){const t=await pw(n,{},async()=>{const i=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await gw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&fo(n.emulatorConfig.host)&&(g.credentials="include"),fw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function fC(n,e){return xi(n,"POST","/v2/accounts:revokeToken",vi(n,e))}class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Z1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const t=Z1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new $l;return i&&(Lt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Lt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Lt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return ci("not implemented")}}function $i(n,e){Lt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class va{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new uC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new hg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await yu(this,this.stsTokenManager.getToken(this.auth,e));return Lt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return lC(this,e)}reload(){return dC(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new va({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Mh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gr(this.auth.app))return Promise.reject(hi(this.auth));const e=await this.getIdToken();return await yu(this,oC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:x,emailVerified:T,isAnonymous:V,providerData:W,stsTokenManager:z}=t;Lt(x&&z,e,"internal-error");const U=$l.fromJSON(this.name,z);Lt(typeof x=="string",e,"internal-error"),$i(i,e.name),$i(l,e.name),Lt(typeof T=="boolean",e,"internal-error"),Lt(typeof V=="boolean",e,"internal-error"),$i(u,e.name),$i(d,e.name),$i(p,e.name),$i(g,e.name),$i(y,e.name),$i(_,e.name);const Z=new va({uid:x,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:V,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:U,createdAt:y,lastLoginAt:_});return W&&Array.isArray(W)&&(Z.providerData=W.map(K=>({...K}))),g&&(Z._redirectEventId=g),Z}static async _fromIdTokenResponse(e,t,i=!1){const l=new $l;l.updateFromServerResponse(t);const u=new va({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Mh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Lt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?yw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new $l;p.updateFromIdToken(i);const g=new va({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new hg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const ex=new Map;function ui(n){gi(n instanceof Function,"Expected a class definition");let e=ex.get(n);return e?(gi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ex.set(n,e),e)}class bw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bw.type="NONE";const tx=bw;function bh(n,e,t){return`firebase:${n}:${e}:${t}`}class Wl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=bh(this.userKey,l.apiKey,u),this.fullPersistenceKey=bh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ah(this.auth,{idToken:e}).catch(()=>{});return t?va._fromGetAccountInfoResponse(this.auth,t,e):null}return va._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Wl(ui(tx),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||ui(tx);const d=bh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const _=await y._get(d);if(_){let x;if(typeof _=="string"){const T=await Ah(e,{idToken:_}).catch(()=>{});if(!T)break;x=await va._fromGetAccountInfoResponse(e,T,_)}else x=va._fromJSON(e,_);y!==u&&(p=x),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Wl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Wl(u,e,i))}}function sx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_w(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jw(e))return"Blackberry";if(Tw(e))return"Webos";if(xw(e))return"Safari";if((e.includes("chrome/")||ww(e))&&!e.includes("edge/"))return"Chrome";if(kw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function vw(n=gr()){return/firefox\//i.test(n)}function xw(n=gr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ww(n=gr()){return/crios\//i.test(n)}function _w(n=gr()){return/iemobile/i.test(n)}function kw(n=gr()){return/android/i.test(n)}function jw(n=gr()){return/blackberry/i.test(n)}function Tw(n=gr()){return/webos/i.test(n)}function Zg(n=gr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pC(n=gr()){return Zg(n)&&!!window.navigator?.standalone}function gC(){return RS()&&document.documentMode===10}function Ew(n=gr()){return Zg(n)||kw(n)||Tw(n)||jw(n)||/windows phone/i.test(n)||_w(n)}function Sw(n,e=[]){let t;switch(n){case"Browser":t=sx(gr());break;case"Worker":t=`${sx(gr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zo}/${i}`}class yC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bC(n,e={}){return xi(n,"GET","/v2/passwordPolicy",vi(n,e))}const vC=6;class xC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??vC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class wC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nx(this),this.idTokenSubscription=new nx(this),this.beforeStateQueue=new yC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ui(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ah(this,{idToken:e}),i=await va._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Gr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gr(this.app))return Promise.reject(hi(this));const t=e?Qs(e):null;return t&&Lt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gr(this.app)?Promise.reject(hi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gr(this.app)?Promise.reject(hi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bC(this),t=new xC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ru("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await fC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ui(e)||this._popupRedirectResolver;Lt(t,this,"argument-error"),this.redirectPersistenceManager=await Wl.create(this,[ui(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&QN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function po(n){return Qs(n)}class nx{constructor(e){this.auth=e,this.observer=null,this.addObserver=VS(t=>this.observer=t)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let em={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _C(n){em=n}function Nw(n){return em.loadJS(n)}function kC(){return em.recaptchaEnterpriseScript}function jC(){return em.gapiScript}function TC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class EC{constructor(){this.enterprise=new SC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class SC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NC="recaptcha-enterprise",Cw="NO_RECAPTCHA";class CC{constructor(e){this.type=NC,this.auth=po(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{iC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new aC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;J1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Cw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new EC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&J1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=kC();g.length!==0&&(g+=p),Nw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function rx(n,e,t,i=!1,l=!1){const u=new CC(n);let d;if(l)d=Cw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ih(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await rx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await rx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function RC(n,e){const t=Zh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if($o(u,e??{}))return l;_a(l,"already-initialized")}return t.initialize({options:e})}function AC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ui);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function MC(n,e,t){const i=po(n);Lt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Rw(e),{host:d,port:p}=IC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},_=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Lt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Lt($o(y,i.config.emulator)&&$o(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(Hg(`${u}//${d}${g}`),$g("Auth",!0)):DC()}function Rw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function IC(n){const e=Rw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:ax(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:ax(d)}}}function ax(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function DC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class ey{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ci("not implemented")}_getIdTokenResponse(e){return ci("not implemented")}_linkToIdToken(e,t){return ci("not implemented")}_getReauthenticationResolver(e){return ci("not implemented")}}async function PC(n,e){return xi(n,"POST","/v1/accounts:signUp",e)}async function LC(n,e){return Iu(n,"POST","/v1/accounts:signInWithPassword",vi(n,e))}async function Aw(n,e){return xi(n,"POST","/v1/accounts:sendOobCode",vi(n,e))}async function OC(n,e){return Aw(n,e)}async function VC(n,e){return Aw(n,e)}async function BC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",vi(n,e))}async function UC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",vi(n,e))}class bu extends ey{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new bu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new bu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,t,"signInWithPassword",LC);case"emailLink":return BC(e,{email:this._email,oobCode:this._password});default:_a(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,i,"signUpPassword",PC);case"emailLink":return UC(e,{idToken:t,email:this._email,oobCode:this._password});default:_a(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gl(n,e){return Iu(n,"POST","/v1/accounts:signInWithIdp",vi(n,e))}const FC="http://localhost";class Go extends ey{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Go(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_a("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Go(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Gl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:FC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Au(t)}return e}}function zC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qC(n){const e=tu(su(n)).link,t=e?tu(su(e)).deep_link_id:null,i=tu(su(n)).deep_link_id;return(i?tu(su(i)).link:null)||i||t||e||n}class ty{constructor(e){const t=tu(su(e)),i=t.apiKey??null,l=t.oobCode??null,u=zC(t.mode??null);Lt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qC(e);try{return new ty(t)}catch{return null}}}class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,t){return bu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ty.parseLink(t);return Lt(i,"argument-error"),bu._fromEmailAndCode(e,i.code,i.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Mw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends Mw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Du{constructor(){super("facebook.com")}static credential(e){return Go._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Yi extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Go._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Yi.credential(t,i)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";class Qi extends Du{constructor(){super("github.com")}static credential(e){return Go._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";class Xi extends Du{constructor(){super("twitter.com")}static credential(e,t){return Go._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function HC(n,e){return Iu(n,"POST","/v1/accounts:signUp",vi(n,e))}class Ko{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await va._fromIdTokenResponse(e,i,l),d=ix(i);return new Ko({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ix(i);return new Ko({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ix(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Dh extends $a{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Dh(e,t,i,l)}}function Iw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(n,u,e,i):u})}async function $C(n,e,t=!1){const i=await yu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ko._forOperation(n,"link",i)}async function WC(n,e,t=!1){const{auth:i}=n;if(Gr(i.app))return Promise.reject(hi(i));const l="reauthenticate";try{const u=await yu(n,Iw(i,l,e,n),t);Lt(u.idToken,i,"internal-error");const d=Jg(u.idToken);Lt(d,i,"internal-error");const{sub:p}=d;return Lt(n.uid===p,i,"user-mismatch"),Ko._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&_a(i,"user-mismatch"),u}}async function Dw(n,e,t=!1){if(Gr(n.app))return Promise.reject(hi(n));const i="signIn",l=await Iw(n,i,e),u=await Ko._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function GC(n,e){return Dw(po(n),e)}async function Pw(n){const e=po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KC(n,e,t){const i=po(n);await Ih(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",VC)}async function YC(n,e,t){if(Gr(n.app))return Promise.reject(hi(n));const i=po(n),d=await Ih(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Pw(n),g}),p=await Ko._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function QC(n,e,t){return Gr(n.app)?Promise.reject(hi(n)):GC(Qs(n),ac.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Pw(n),i})}async function VP(n,e){const t=Qs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await OC(t.auth,l);u!==n.email&&await n.reload()}function ox(n,e){return Qs(n).setPersistence(e)}function XC(n,e,t,i){return Qs(n).onIdTokenChanged(e,t,i)}function JC(n,e,t){return Qs(n).beforeAuthStateChanged(e,t)}function ZC(n,e,t,i){return Qs(n).onAuthStateChanged(e,t,i)}function e4(n){return Qs(n).signOut()}const Ph="__sak";class Lw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ph,"1"),this.storage.removeItem(Ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const t4=1e3,s4=10;class Ow extends Lw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ew(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);gC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},t4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ow.type="LOCAL";const mg=Ow;class Vw extends Lw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Vw.type="SESSION";const sy=Vw;function n4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class tm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new tm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await n4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tm.receivers=[];function ny(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class r4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ny("",20);l.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(x){const T=x;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(_),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(_),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ba(){return window}function a4(n){Ba().location.href=n}function Bw(){return typeof Ba().WorkerGlobalScope<"u"&&typeof Ba().importScripts=="function"}async function i4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o4(){return navigator?.serviceWorker?.controller||null}function l4(){return Bw()?self:null}const Uw="firebaseLocalStorageDb",c4=1,Lh="firebaseLocalStorage",Fw="fbase_key";class Pu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sm(n,e){return n.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function u4(){const n=indexedDB.deleteDatabase(Uw);return new Pu(n).toPromise()}function fg(){const n=indexedDB.open(Uw,c4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Lh,{keyPath:Fw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Lh)?e(i):(i.close(),await u4(),e(await fg()))})})}async function lx(n,e,t){const i=sm(n,!0).put({[Fw]:e,value:t});return new Pu(i).toPromise()}async function d4(n,e){const t=sm(n,!1).get(e),i=await new Pu(t).toPromise();return i===void 0?null:i.value}function cx(n,e){const t=sm(n,!0).delete(e);return new Pu(t).toPromise()}const h4=800,m4=3;class zw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tm._getInstance(l4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await i4(),!this.activeServiceWorker)return;this.sender=new r4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fg();return await lx(e,Ph,"1"),await cx(e,Ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>lx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>d4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=sm(l,!1).getAll();return new Pu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),h4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zw.type="LOCAL";const f4=zw;new Mu(3e4,6e4);function p4(n,e){return e?ui(e):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ry extends ey{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function g4(n){return Dw(n.auth,new ry(n),n.bypassAuthState)}function y4(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),WC(t,new ry(n),n.bypassAuthState)}async function b4(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),$C(t,new ry(n),n.bypassAuthState)}class qw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return g4;case"linkViaPopup":case"linkViaRedirect":return b4;case"reauthViaPopup":case"reauthViaRedirect":return y4;default:_a(this.auth,"internal-error")}}resolve(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const v4=new Mu(2e3,1e4);class Hl extends qw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Hl.currentPopupAction&&Hl.currentPopupAction.cancel(),Hl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){gi(this.filter.length===1,"Popup operations only handle one event");const e=ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Va(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Va(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Va(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,v4.get())};e()}}Hl.currentPopupAction=null;const x4="pendingRedirect",vh=new Map;class w4 extends qw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=vh.get(this.auth._key());if(!e){try{const i=await _4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}vh.set(this.auth._key(),e)}return this.bypassAuthState||vh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _4(n,e){const t=T4(e),i=j4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function k4(n,e){vh.set(n._key(),e)}function j4(n){return ui(n._redirectPersistence)}function T4(n){return bh(x4,n.config.apiKey,n.name)}async function E4(n,e,t=!1){if(Gr(n.app))return Promise.reject(hi(n));const i=po(n),l=p4(i,e),d=await new w4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const S4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!C4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Hw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Va(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S4&&this.cachedEventUids.clear(),this.cachedEventUids.has(ux(e))}saveEventToCache(e){this.cachedEventUids.add(ux(e)),this.lastProcessedEventTime=Date.now()}}function ux(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Hw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function C4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hw(n);default:return!1}}async function R4(n,e={}){return xi(n,"GET","/v1/projects",e)}const A4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function I4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await R4(n);for(const t of e)try{if(D4(t))return}catch{}_a(n,"unauthorized-domain")}function D4(n){const e=dg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(A4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const P4=new Mu(3e4,6e4);function dx(){const n=Ba().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function L4(n){return new Promise((e,t)=>{function i(){dx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dx(),t(Va(n,"network-request-failed"))},timeout:P4.get()})}if(Ba().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ba().gapi?.load)i();else{const l=TC("iframefcb");return Ba()[l]=()=>{gapi.load?i():t(Va(n,"network-request-failed"))},Nw(`${jC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw xh=null,e})}let xh=null;function O4(n){return xh=xh||L4(n),xh}const V4=new Mu(5e3,15e3),B4="__/auth/iframe",U4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q4(n){const e=n.config;Lt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Xg(e,U4):`https://${n.config.authDomain}/${B4}`,i={apiKey:e.apiKey,appName:n.name,v:Zo},l=z4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Au(i).slice(1)}`}async function H4(n){const e=await O4(n),t=Ba().gapi;return Lt(t,n,"internal-error"),e.open({where:document.body,url:q4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Va(n,"network-request-failed"),p=Ba().setTimeout(()=>{u(d)},V4.get());function g(){Ba().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const $4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W4=500,G4=600,K4="_blank",Y4="http://localhost";class hx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q4(n,e,t,i=W4,l=G4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...$4,width:i.toString(),height:l.toString(),top:u,left:d},y=gr().toLowerCase();t&&(p=ww(y)?K4:t),vw(y)&&(e=e||Y4,g.scrollbars="yes");const _=Object.entries(g).reduce((T,[V,W])=>`${T}${V}=${W},`,"");if(pC(y)&&p!=="_self")return X4(e||"",p),new hx(null);const x=window.open(e||"",p,_);Lt(x,n,"popup-blocked");try{x.focus()}catch{}return new hx(x)}function X4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const J4="__/auth/handler",Z4="emulator/auth/handler",eR=encodeURIComponent("fac");async function mx(n,e,t,i,l,u){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Zo,eventId:l};if(e instanceof Mw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",OS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,x]of Object.entries({}))d[_]=x}if(e instanceof Du){const _=e.getScopes().filter(x=>x!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const _ of Object.keys(p))p[_]===void 0&&delete p[_];const g=await n._getAppCheckToken(),y=g?`#${eR}=${encodeURIComponent(g)}`:"";return`${tR(n)}?${Au(p).slice(1)}${y}`}function tR({config:n}){return n.emulator?Xg(n,Z4):`https://${n.authDomain}/${J4}`}const Mp="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sy,this._completeRedirectFn=E4,this._overrideRedirectResult=k4}async _openPopup(e,t,i,l){gi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await mx(e,t,i,dg(),l);return Q4(e,u,ny())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await mx(e,t,i,dg(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(gi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await H4(e),i=new N4(e);return t.register("authEvent",l=>(Lt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mp,{type:Mp},l=>{const u=l?.[0]?.[Mp];u!==void 0&&t(!!u),_a(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=I4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ew()||xw()||Zg()}}const nR=sR;var fx="@firebase/auth",px="1.12.0";class rR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iR(n){Wo(new io("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Lt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sw(n)},y=new wC(i,l,u,g);return AC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Wo(new io("auth-internal",e=>{const t=po(e.getProvider("auth").getImmediate());return(i=>new rR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Oa(fx,px,aR(n)),Oa(fx,px,"esm2020")}const oR=300,lR=aw("authIdTokenMaxAge")||oR;let gx=null;const cR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>lR)return;const l=t?.token;gx!==l&&(gx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function $w(n=Yg()){const e=Zh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RC(n,{popupRedirectResolver:nR,persistence:[f4,mg,sy]}),i=aw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=cR(u.toString());JC(t,d,()=>d(t.currentUser)),XC(t,p=>d(p))}}const l=sw("auth");return l&&MC(t,`http://${l}`),t}function uR(){return document.getElementsByTagName("head")?.[0]??document}_C({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Va("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",uR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iR("Browser");var yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,Ww;(function(){var n;function e(C,E){function R(){}R.prototype=E.prototype,C.F=E.prototype,C.prototype=new R,C.prototype.constructor=C,C.D=function(O,I,H){for(var D=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)D[Ue-2]=arguments[Ue];return E.prototype[I].apply(O,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,E,R){R||(R=0);const O=Array(16);if(typeof E=="string")for(var I=0;I<16;++I)O[I]=E.charCodeAt(R++)|E.charCodeAt(R++)<<8|E.charCodeAt(R++)<<16|E.charCodeAt(R++)<<24;else for(I=0;I<16;++I)O[I]=E[R++]|E[R++]<<8|E[R++]<<16|E[R++]<<24;E=C.g[0],R=C.g[1],I=C.g[2];let H=C.g[3],D;D=E+(H^R&(I^H))+O[0]+3614090360&4294967295,E=R+(D<<7&4294967295|D>>>25),D=H+(I^E&(R^I))+O[1]+3905402710&4294967295,H=E+(D<<12&4294967295|D>>>20),D=I+(R^H&(E^R))+O[2]+606105819&4294967295,I=H+(D<<17&4294967295|D>>>15),D=R+(E^I&(H^E))+O[3]+3250441966&4294967295,R=I+(D<<22&4294967295|D>>>10),D=E+(H^R&(I^H))+O[4]+4118548399&4294967295,E=R+(D<<7&4294967295|D>>>25),D=H+(I^E&(R^I))+O[5]+1200080426&4294967295,H=E+(D<<12&4294967295|D>>>20),D=I+(R^H&(E^R))+O[6]+2821735955&4294967295,I=H+(D<<17&4294967295|D>>>15),D=R+(E^I&(H^E))+O[7]+4249261313&4294967295,R=I+(D<<22&4294967295|D>>>10),D=E+(H^R&(I^H))+O[8]+1770035416&4294967295,E=R+(D<<7&4294967295|D>>>25),D=H+(I^E&(R^I))+O[9]+2336552879&4294967295,H=E+(D<<12&4294967295|D>>>20),D=I+(R^H&(E^R))+O[10]+4294925233&4294967295,I=H+(D<<17&4294967295|D>>>15),D=R+(E^I&(H^E))+O[11]+2304563134&4294967295,R=I+(D<<22&4294967295|D>>>10),D=E+(H^R&(I^H))+O[12]+1804603682&4294967295,E=R+(D<<7&4294967295|D>>>25),D=H+(I^E&(R^I))+O[13]+4254626195&4294967295,H=E+(D<<12&4294967295|D>>>20),D=I+(R^H&(E^R))+O[14]+2792965006&4294967295,I=H+(D<<17&4294967295|D>>>15),D=R+(E^I&(H^E))+O[15]+1236535329&4294967295,R=I+(D<<22&4294967295|D>>>10),D=E+(I^H&(R^I))+O[1]+4129170786&4294967295,E=R+(D<<5&4294967295|D>>>27),D=H+(R^I&(E^R))+O[6]+3225465664&4294967295,H=E+(D<<9&4294967295|D>>>23),D=I+(E^R&(H^E))+O[11]+643717713&4294967295,I=H+(D<<14&4294967295|D>>>18),D=R+(H^E&(I^H))+O[0]+3921069994&4294967295,R=I+(D<<20&4294967295|D>>>12),D=E+(I^H&(R^I))+O[5]+3593408605&4294967295,E=R+(D<<5&4294967295|D>>>27),D=H+(R^I&(E^R))+O[10]+38016083&4294967295,H=E+(D<<9&4294967295|D>>>23),D=I+(E^R&(H^E))+O[15]+3634488961&4294967295,I=H+(D<<14&4294967295|D>>>18),D=R+(H^E&(I^H))+O[4]+3889429448&4294967295,R=I+(D<<20&4294967295|D>>>12),D=E+(I^H&(R^I))+O[9]+568446438&4294967295,E=R+(D<<5&4294967295|D>>>27),D=H+(R^I&(E^R))+O[14]+3275163606&4294967295,H=E+(D<<9&4294967295|D>>>23),D=I+(E^R&(H^E))+O[3]+4107603335&4294967295,I=H+(D<<14&4294967295|D>>>18),D=R+(H^E&(I^H))+O[8]+1163531501&4294967295,R=I+(D<<20&4294967295|D>>>12),D=E+(I^H&(R^I))+O[13]+2850285829&4294967295,E=R+(D<<5&4294967295|D>>>27),D=H+(R^I&(E^R))+O[2]+4243563512&4294967295,H=E+(D<<9&4294967295|D>>>23),D=I+(E^R&(H^E))+O[7]+1735328473&4294967295,I=H+(D<<14&4294967295|D>>>18),D=R+(H^E&(I^H))+O[12]+2368359562&4294967295,R=I+(D<<20&4294967295|D>>>12),D=E+(R^I^H)+O[5]+4294588738&4294967295,E=R+(D<<4&4294967295|D>>>28),D=H+(E^R^I)+O[8]+2272392833&4294967295,H=E+(D<<11&4294967295|D>>>21),D=I+(H^E^R)+O[11]+1839030562&4294967295,I=H+(D<<16&4294967295|D>>>16),D=R+(I^H^E)+O[14]+4259657740&4294967295,R=I+(D<<23&4294967295|D>>>9),D=E+(R^I^H)+O[1]+2763975236&4294967295,E=R+(D<<4&4294967295|D>>>28),D=H+(E^R^I)+O[4]+1272893353&4294967295,H=E+(D<<11&4294967295|D>>>21),D=I+(H^E^R)+O[7]+4139469664&4294967295,I=H+(D<<16&4294967295|D>>>16),D=R+(I^H^E)+O[10]+3200236656&4294967295,R=I+(D<<23&4294967295|D>>>9),D=E+(R^I^H)+O[13]+681279174&4294967295,E=R+(D<<4&4294967295|D>>>28),D=H+(E^R^I)+O[0]+3936430074&4294967295,H=E+(D<<11&4294967295|D>>>21),D=I+(H^E^R)+O[3]+3572445317&4294967295,I=H+(D<<16&4294967295|D>>>16),D=R+(I^H^E)+O[6]+76029189&4294967295,R=I+(D<<23&4294967295|D>>>9),D=E+(R^I^H)+O[9]+3654602809&4294967295,E=R+(D<<4&4294967295|D>>>28),D=H+(E^R^I)+O[12]+3873151461&4294967295,H=E+(D<<11&4294967295|D>>>21),D=I+(H^E^R)+O[15]+530742520&4294967295,I=H+(D<<16&4294967295|D>>>16),D=R+(I^H^E)+O[2]+3299628645&4294967295,R=I+(D<<23&4294967295|D>>>9),D=E+(I^(R|~H))+O[0]+4096336452&4294967295,E=R+(D<<6&4294967295|D>>>26),D=H+(R^(E|~I))+O[7]+1126891415&4294967295,H=E+(D<<10&4294967295|D>>>22),D=I+(E^(H|~R))+O[14]+2878612391&4294967295,I=H+(D<<15&4294967295|D>>>17),D=R+(H^(I|~E))+O[5]+4237533241&4294967295,R=I+(D<<21&4294967295|D>>>11),D=E+(I^(R|~H))+O[12]+1700485571&4294967295,E=R+(D<<6&4294967295|D>>>26),D=H+(R^(E|~I))+O[3]+2399980690&4294967295,H=E+(D<<10&4294967295|D>>>22),D=I+(E^(H|~R))+O[10]+4293915773&4294967295,I=H+(D<<15&4294967295|D>>>17),D=R+(H^(I|~E))+O[1]+2240044497&4294967295,R=I+(D<<21&4294967295|D>>>11),D=E+(I^(R|~H))+O[8]+1873313359&4294967295,E=R+(D<<6&4294967295|D>>>26),D=H+(R^(E|~I))+O[15]+4264355552&4294967295,H=E+(D<<10&4294967295|D>>>22),D=I+(E^(H|~R))+O[6]+2734768916&4294967295,I=H+(D<<15&4294967295|D>>>17),D=R+(H^(I|~E))+O[13]+1309151649&4294967295,R=I+(D<<21&4294967295|D>>>11),D=E+(I^(R|~H))+O[4]+4149444226&4294967295,E=R+(D<<6&4294967295|D>>>26),D=H+(R^(E|~I))+O[11]+3174756917&4294967295,H=E+(D<<10&4294967295|D>>>22),D=I+(E^(H|~R))+O[2]+718787259&4294967295,I=H+(D<<15&4294967295|D>>>17),D=R+(H^(I|~E))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(I+(D<<21&4294967295|D>>>11))&4294967295,C.g[2]=C.g[2]+I&4294967295,C.g[3]=C.g[3]+H&4294967295}i.prototype.v=function(C,E){E===void 0&&(E=C.length);const R=E-this.blockSize,O=this.C;let I=this.h,H=0;for(;H<E;){if(I==0)for(;H<=R;)l(this,C,H),H+=this.blockSize;if(typeof C=="string"){for(;H<E;)if(O[I++]=C.charCodeAt(H++),I==this.blockSize){l(this,O),I=0;break}}else for(;H<E;)if(O[I++]=C[H++],I==this.blockSize){l(this,O),I=0;break}}this.h=I,this.o+=E},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;E=this.o*8;for(var R=C.length-8;R<C.length;++R)C[R]=E&255,E/=256;for(this.v(C),C=Array(16),E=0,R=0;R<4;++R)for(let O=0;O<32;O+=8)C[E++]=this.g[R]>>>O&255;return C};function u(C,E){var R=p;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=E(C)}function d(C,E){this.h=E;const R=[];let O=!0;for(let I=C.length-1;I>=0;I--){const H=C[I]|0;O&&H==E||(R[I]=H,O=!1)}this.g=R}var p={};function g(C){return-128<=C&&C<128?u(C,function(E){return new d([E|0],E<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return x;if(C<0)return U(y(-C));const E=[];let R=1;for(let O=0;C>=R;O++)E[O]=C/R|0,R*=4294967296;return new d(E,0)}function _(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return U(_(C.substring(1),E));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(E,8));let O=x;for(let H=0;H<C.length;H+=8){var I=Math.min(8,C.length-H);const D=parseInt(C.substring(H,H+I),E);I<8?(I=y(Math.pow(E,I)),O=O.j(I).add(y(D))):(O=O.j(R),O=O.add(y(D)))}return O}var x=g(0),T=g(1),V=g(16777216);n=d.prototype,n.m=function(){if(z(this))return-U(this).m();let C=0,E=1;for(let R=0;R<this.g.length;R++){const O=this.i(R);C+=(O>=0?O:4294967296+O)*E,E*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(W(this))return"0";if(z(this))return"-"+U(this).toString(C);const E=y(Math.pow(C,6));var R=this;let O="";for(;;){const I=he(R,E).g;R=Z(R,I.j(E));let H=((R.g.length>0?R.g[0]:R.h)>>>0).toString(C);if(R=I,W(R))return H+O;for(;H.length<6;)H="0"+H;O=H+O}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function W(C){if(C.h!=0)return!1;for(let E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function z(C){return C.h==-1}n.l=function(C){return C=Z(this,C),z(C)?-1:W(C)?0:1};function U(C){const E=C.g.length,R=[];for(let O=0;O<E;O++)R[O]=~C.g[O];return new d(R,~C.h).add(T)}n.abs=function(){return z(this)?U(this):this},n.add=function(C){const E=Math.max(this.g.length,C.g.length),R=[];let O=0;for(let I=0;I<=E;I++){let H=O+(this.i(I)&65535)+(C.i(I)&65535),D=(H>>>16)+(this.i(I)>>>16)+(C.i(I)>>>16);O=D>>>16,H&=65535,D&=65535,R[I]=D<<16|H}return new d(R,R[R.length-1]&-2147483648?-1:0)};function Z(C,E){return C.add(U(E))}n.j=function(C){if(W(this)||W(C))return x;if(z(this))return z(C)?U(this).j(U(C)):U(U(this).j(C));if(z(C))return U(this.j(U(C)));if(this.l(V)<0&&C.l(V)<0)return y(this.m()*C.m());const E=this.g.length+C.g.length,R=[];for(var O=0;O<2*E;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(let I=0;I<C.g.length;I++){const H=this.i(O)>>>16,D=this.i(O)&65535,Ue=C.i(I)>>>16,lt=C.i(I)&65535;R[2*O+2*I]+=D*lt,K(R,2*O+2*I),R[2*O+2*I+1]+=H*lt,K(R,2*O+2*I+1),R[2*O+2*I+1]+=D*Ue,K(R,2*O+2*I+1),R[2*O+2*I+2]+=H*Ue,K(R,2*O+2*I+2)}for(C=0;C<E;C++)R[C]=R[2*C+1]<<16|R[2*C];for(C=E;C<2*E;C++)R[C]=0;return new d(R,0)};function K(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function se(C,E){this.g=C,this.h=E}function he(C,E){if(W(E))throw Error("division by zero");if(W(C))return new se(x,x);if(z(C))return E=he(U(C),E),new se(U(E.g),U(E.h));if(z(E))return E=he(C,U(E)),new se(U(E.g),E.h);if(C.g.length>30){if(z(C)||z(E))throw Error("slowDivide_ only works with positive integers.");for(var R=T,O=E;O.l(C)<=0;)R=Me(R),O=Me(O);var I=we(R,1),H=we(O,1);for(O=we(O,2),R=we(R,2);!W(O);){var D=H.add(O);D.l(C)<=0&&(I=I.add(R),H=D),O=we(O,1),R=we(R,1)}return E=Z(C,I.j(E)),new se(I,E)}for(I=x;C.l(E)>=0;){for(R=Math.max(1,Math.floor(C.m()/E.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),H=y(R),D=H.j(E);z(D)||D.l(C)>0;)R-=O,H=y(R),D=H.j(E);W(H)&&(H=T),I=I.add(H),C=Z(C,D)}return new se(I,C)}n.B=function(C){return he(this,C).h},n.and=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let O=0;O<E;O++)R[O]=this.i(O)&C.i(O);return new d(R,this.h&C.h)},n.or=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let O=0;O<E;O++)R[O]=this.i(O)|C.i(O);return new d(R,this.h|C.h)},n.xor=function(C){const E=Math.max(this.g.length,C.g.length),R=[];for(let O=0;O<E;O++)R[O]=this.i(O)^C.i(O);return new d(R,this.h^C.h)};function Me(C){const E=C.g.length+1,R=[];for(let O=0;O<E;O++)R[O]=C.i(O)<<1|C.i(O-1)>>>31;return new d(R,C.h)}function we(C,E){const R=E>>5;E%=32;const O=C.g.length-R,I=[];for(let H=0;H<O;H++)I[H]=E>0?C.i(H+R)>>>E|C.i(H+R+1)<<32-E:C.i(H+R);return new d(I,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ww=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=_,ro=d}).apply(typeof yx<"u"?yx:typeof self<"u"?self:typeof window<"u"?window:{});var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Gw,nu,Kw,wh,pg,Yw,Qw,Xw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof sh=="object"&&sh];for(var b=0;b<h.length;++b){var k=h[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var k=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ie=h[A];if(!(ie in k))break e;k=k[ie]}h=h[h.length-1],A=k[h],b=b(A),b!=A&&b!=null&&e(k,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var k=[],A;for(A in b)Object.prototype.hasOwnProperty.call(b,A)&&k.push([A,b[A]]);return k}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,k){return h.call.apply(h.bind,arguments)}function y(h,b,k){return y=g,y.apply(null,arguments)}function _(h,b){var k=Array.prototype.slice.call(arguments,1);return function(){var A=k.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function x(h,b){function k(){}k.prototype=b.prototype,h.Z=b.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(A,ie,fe){for(var Ge=Array(arguments.length-2),ts=2;ts<arguments.length;ts++)Ge[ts-2]=arguments[ts];return b.prototype[ie].apply(A,Ge)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function V(h){const b=h.length;if(b>0){const k=Array(b);for(let A=0;A<b;A++)k[A]=h[A];return k}return[]}function W(h,b){for(let A=1;A<arguments.length;A++){const ie=arguments[A];var k=typeof ie;if(k=k!="object"?k:ie?Array.isArray(ie)?"array":k:"null",k=="array"||k=="object"&&typeof ie.length=="number"){k=h.length||0;const fe=ie.length||0;h.length=k+fe;for(let Ge=0;Ge<fe;Ge++)h[k+Ge]=ie[Ge]}else h.push(ie)}}class z{constructor(b,k){this.i=b,this.j=k,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function U(h){d.setTimeout(()=>{throw h},0)}function Z(){var h=C;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,k){const A=se.get();A.set(b,k),this.h?this.h.next=A:this.g=A,this.h=A}}var se=new z(()=>new he,h=>h.reset());class he{constructor(){this.next=this.g=this.h=null}set(b,k){this.h=b,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,we=!1,C=new K,E=()=>{const h=Promise.resolve(void 0);Me=()=>{h.then(R)}};function R(){for(var h;h=Z();){try{h.h.call(h.g)}catch(k){U(k)}var b=se;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}we=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,b),d.removeEventListener("test",k,b)}catch{}return h})();function D(h){return/^[\s\xa0]*$/.test(h)}function Ue(h,b){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}x(Ue,I),Ue.prototype.init=function(h,b){const k=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(k=="mouseover"?b=h.fromElement:k=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Ue.Z.h.call(this)},Ue.prototype.h=function(){Ue.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var lt="closure_listenable_"+(Math.random()*1e6|0),B=0;function re(h,b,k,A,ie){this.listener=h,this.proxy=null,this.src=b,this.type=k,this.capture=!!A,this.ha=ie,this.key=++B,this.da=this.fa=!1}function Te(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ve(h,b,k){for(const A in h)b.call(k,h[A],A,h)}function ee(h,b){for(const k in h)b.call(void 0,h[k],k,h)}function L(h){const b={};for(const k in h)b[k]=h[k];return b}const ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(h,b){let k,A;for(let ie=1;ie<arguments.length;ie++){A=arguments[ie];for(k in A)h[k]=A[k];for(let fe=0;fe<ae.length;fe++)k=ae[fe],Object.prototype.hasOwnProperty.call(A,k)&&(h[k]=A[k])}}function Pe(h){this.src=h,this.g={},this.h=0}Pe.prototype.add=function(h,b,k,A,ie){const fe=h.toString();h=this.g[fe],h||(h=this.g[fe]=[],this.h++);const Ge=Be(h,b,A,ie);return Ge>-1?(b=h[Ge],k||(b.fa=!1)):(b=new re(b,this.src,fe,!!A,ie),b.fa=k,h.push(b)),b};function Ke(h,b){const k=b.type;if(k in h.g){var A=h.g[k],ie=Array.prototype.indexOf.call(A,b,void 0),fe;(fe=ie>=0)&&Array.prototype.splice.call(A,ie,1),fe&&(Te(b),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Be(h,b,k,A){for(let ie=0;ie<h.length;++ie){const fe=h[ie];if(!fe.da&&fe.listener==b&&fe.capture==!!k&&fe.ha==A)return ie}return-1}var gt="closure_lm_"+(Math.random()*1e6|0),Nt={};function ct(h,b,k,A,ie){if(Array.isArray(b)){for(let fe=0;fe<b.length;fe++)ct(h,b[fe],k,A,ie);return null}return k=yt(k),h&&h[lt]?h.J(b,k,p(A)?!!A.capture:!1,ie):Zt(h,b,k,!1,A,ie)}function Zt(h,b,k,A,ie,fe){if(!b)throw Error("Invalid event type");const Ge=p(ie)?!!ie.capture:!!ie;let ts=Yt(h);if(ts||(h[gt]=ts=new Pe(h)),k=ts.add(b,k,A,Ge,fe),k.proxy)return k;if(A=Vs(),k.proxy=A,A.src=h,A.listener=k,h.addEventListener)H||(ie=Ge),ie===void 0&&(ie=!1),h.addEventListener(b.toString(),A,ie);else if(h.attachEvent)h.attachEvent(ce(b.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Vs(){function h(k){return b.call(h.src,h.listener,k)}const b=os;return h}function ft(h,b,k,A,ie){if(Array.isArray(b))for(var fe=0;fe<b.length;fe++)ft(h,b[fe],k,A,ie);else A=p(A)?!!A.capture:!!A,k=yt(k),h&&h[lt]?(h=h.i,fe=String(b).toString(),fe in h.g&&(b=h.g[fe],k=Be(b,k,A,ie),k>-1&&(Te(b[k]),Array.prototype.splice.call(b,k,1),b.length==0&&(delete h.g[fe],h.h--)))):h&&(h=Yt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Be(b,k,A,ie)),(k=h>-1?b[h]:null)&&ht(k))}function ht(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[lt])Ke(b.i,h);else{var k=h.type,A=h.proxy;b.removeEventListener?b.removeEventListener(k,A,h.capture):b.detachEvent?b.detachEvent(ce(k),A):b.addListener&&b.removeListener&&b.removeListener(A),(k=Yt(b))?(Ke(k,h),k.h==0&&(k.src=null,b[gt]=null)):Te(h)}}}function ce(h){return h in Nt?Nt[h]:Nt[h]="on"+h}function os(h,b){if(h.da)h=!0;else{b=new Ue(b,this);const k=h.listener,A=h.ha||h.src;h.fa&&ht(h),h=k.call(A,b)}return h}function Yt(h){return h=h[gt],h instanceof Pe?h:null}var Ct="__closure_events_fn_"+(Math.random()*1e9>>>0);function yt(h){return typeof h=="function"?h:(h[Ct]||(h[Ct]=function(b){return h.handleEvent(b)}),h[Ct])}function st(){O.call(this),this.i=new Pe(this),this.M=this,this.G=null}x(st,O),st.prototype[lt]=!0,st.prototype.removeEventListener=function(h,b,k,A){ft(this,h,b,k,A)};function He(h,b){var k,A=h.G;if(A)for(k=[];A;A=A.G)k.push(A);if(h=h.M,A=b.type||b,typeof b=="string")b=new I(b,h);else if(b instanceof I)b.target=b.target||h;else{var ie=b;b=new I(A,h),De(b,ie)}ie=!0;let fe,Ge;if(k)for(Ge=k.length-1;Ge>=0;Ge--)fe=b.g=k[Ge],ie=zt(fe,A,!0,b)&&ie;if(fe=b.g=h,ie=zt(fe,A,!0,b)&&ie,ie=zt(fe,A,!1,b)&&ie,k)for(Ge=0;Ge<k.length;Ge++)fe=b.g=k[Ge],ie=zt(fe,A,!1,b)&&ie}st.prototype.N=function(){if(st.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const k=h.g[b];for(let A=0;A<k.length;A++)Te(k[A]);delete h.g[b],h.h--}}this.G=null},st.prototype.J=function(h,b,k,A){return this.i.add(String(h),b,!1,k,A)},st.prototype.K=function(h,b,k,A){return this.i.add(String(h),b,!0,k,A)};function zt(h,b,k,A){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ie=!0;for(let fe=0;fe<b.length;++fe){const Ge=b[fe];if(Ge&&!Ge.da&&Ge.capture==k){const ts=Ge.listener,Nn=Ge.ha||Ge.src;Ge.fa&&Ke(h.i,Ge),ie=ts.call(Nn,A)!==!1&&ie}}return ie&&!A.defaultPrevented}function Ns(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function $s(h){h.g=Ns(()=>{h.g=null,h.i&&(h.i=!1,$s(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Dt extends O{constructor(b,k){super(),this.m=b,this.l=k,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:$s(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tt(h){O.call(this),this.h=h,this.g={}}x(Tt,O);var rs=[];function As(h){Ve(h.g,function(b,k){this.g.hasOwnProperty(k)&&ht(b)},h),h.g={}}Tt.prototype.N=function(){Tt.Z.N.call(this),As(this)},Tt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ut=d.JSON.stringify,Xs=d.JSON.parse,Pt=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function fs(){}function qt(){}var ve={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function G(){I.call(this,"d")}x(G,I);function de(){I.call(this,"c")}x(de,I);var Ee={},Le=null;function _e(){return Le=Le||new st}Ee.Ia="serverreachability";function Ye(h){I.call(this,Ee.Ia,h)}x(Ye,I);function at(h){const b=_e();He(b,new Ye(b))}Ee.STAT_EVENT="statevent";function Y(h,b){I.call(this,Ee.STAT_EVENT,h),this.stat=b}x(Y,I);function ne(h){const b=_e();He(b,new Y(b,h))}Ee.Ja="timingevent";function $e(h,b){I.call(this,Ee.Ja,h),this.size=b}x($e,I);function We(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function rt(){this.g=!0}rt.prototype.ua=function(){this.g=!1};function pt(h,b,k,A,ie,fe){h.info(function(){if(h.g)if(fe){var Ge="",ts=fe.split("&");for(let Ls=0;Ls<ts.length;Ls++){var Nn=ts[Ls].split("=");if(Nn.length>1){const on=Nn[0];Nn=Nn[1];const Xr=on.split("_");Ge=Xr.length>=2&&Xr[1]=="type"?Ge+(on+"="+Nn+"&"):Ge+(on+"=redacted&")}}}else Ge=null;else Ge=fe;return"XMLHTTP REQ ("+A+") [attempt "+ie+"]: "+b+`
`+k+`
`+Ge})}function vt(h,b,k,A,ie,fe,Ge){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ie+"]: "+b+`
`+k+`
`+fe+" "+Ge})}function Rt(h,b,k,A){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Ws(h,k)+(A?" "+A:"")})}function _s(h,b){h.info(function(){return"TIMEOUT: "+b})}rt.prototype.info=function(){};function Ws(h,b){if(!h.g)return b;if(!b)return null;try{const fe=JSON.parse(b);if(fe){for(h=0;h<fe.length;h++)if(Array.isArray(fe[h])){var k=fe[h];if(!(k.length<2)){var A=k[1];if(Array.isArray(A)&&!(A.length<1)){var ie=A[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Ge=1;Ge<A.length;Ge++)A[Ge]=""}}}}return Ut(fe)}catch{return b}}var as={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ks={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bs;function $(){}x($,fs),$.prototype.g=function(){return new XMLHttpRequest},Bs=new $;function xe(h){return encodeURIComponent(String(h))}function Ce(h){var b=1;h=h.split(":");const k=[];for(;b>0&&h.length;)k.push(h.shift()),b--;return h.length&&k.push(h.join(":")),k}function Se(h,b,k,A){this.j=h,this.i=b,this.l=k,this.S=A||1,this.V=new Tt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var ot={},bt={};function Je(h,b,k){h.M=1,h.A=Qr(ls(b)),h.u=k,h.R=!0,_t(h,null)}function _t(h,b){h.F=Date.now(),fn(h),h.B=ls(h.A);var k=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),gn(k.i,"t",A),h.C=0,k=h.j.L,h.h=new ke,h.g=Gu(h.j,k?b:null,!h.u),h.P>0&&(h.O=new Dt(y(h.Y,h,h.g),h.P)),b=h.V,k=h.g,A=h.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(rs[0]=ie.toString()),ie=rs);for(let fe=0;fe<ie.length;fe++){const Ge=ct(k,ie[fe],A||b.handleEvent,!1,b.h||b);if(!Ge)break;b.g[Ge.key]=Ge}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),at(),pt(h.i,h.v,h.B,h.l,h.S,h.u)}Se.prototype.ba=function(h){h=h.target;const b=this.O;b&&is(h)==3?b.j():this.Y(h)},Se.prototype.Y=function(h){try{if(h==this.g)e:{const ts=is(this.g),Nn=this.g.ya(),Ls=this.g.ca();if(!(ts<3)&&(ts!=3||this.g&&(this.h.h||this.g.la()||Wt(this.g)))){this.K||ts!=4||Nn==7||(Nn==8||Ls<=0?at(3):at(2)),Mn(this);var b=this.g.ca();this.X=b;var k=jt(this);if(this.o=b==200,vt(this.i,this.v,this.B,this.l,this.S,ts,b),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ie=this.g;if((A=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(A)){var fe=A;break t}}fe=null}if(h=fe)Rt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,j(this,h);else{this.o=!1,this.m=3,ne(12),Fs(this),pn(this);break e}}if(this.R){h=!0;let on;for(;!this.K&&this.C<k.length;)if(on=un(this,k),on==bt){ts==4&&(this.m=4,ne(14),h=!1),Rt(this.i,this.l,null,"[Incomplete Response]");break}else if(on==ot){this.m=4,ne(15),Rt(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Rt(this.i,this.l,on,null),j(this,on);if(Cs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ts!=4||k.length!=0||this.h.h||(this.m=1,ne(16),h=!1),this.o=this.o&&h,!h)Rt(this.i,this.l,k,"[Invalid Chunked Response]"),Fs(this),pn(this);else if(k.length>0&&!this.W){this.W=!0;var Ge=this.j;Ge.g==this&&Ge.aa&&!Ge.P&&(Ge.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),xr(Ge),Ge.P=!0,ne(11))}}else Rt(this.i,this.l,k,null),j(this,k);ts==4&&Fs(this),this.o&&!this.K&&(ts==4?sl(this.j,this):(this.o=!1,fn(this)))}else xs(this.g),b==400&&k.indexOf("Unknown SID")>0?(this.m=3,ne(12)):(this.m=0,ne(13)),Fs(this),pn(this)}}}catch{}};function jt(h){if(!Cs(h))return h.g.la();const b=Wt(h.g);if(b==="")return"";let k="";const A=b.length,ie=is(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Fs(h),pn(h),"";h.h.i=new d.TextDecoder}for(let fe=0;fe<A;fe++)h.h.h=!0,k+=h.h.i.decode(b[fe],{stream:!(ie&&fe==A-1)});return b.length=0,h.h.g+=k,h.C=0,h.h.g}function Cs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function un(h,b){var k=h.C,A=b.indexOf(`
`,k);return A==-1?bt:(k=Number(b.substring(k,A)),isNaN(k)?ot:(A+=1,A+k>b.length?bt:(b=b.slice(A,A+k),h.C=A+k,b)))}Se.prototype.cancel=function(){this.K=!0,Fs(this)};function fn(h){h.T=Date.now()+h.H,kn(h,h.H)}function kn(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=We(y(h.aa,h),b)}function Mn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Se.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(_s(this.i,this.B),this.M!=2&&(at(),ne(17)),Fs(this),this.m=2,pn(this)):kn(this,this.T-h)};function pn(h){h.j.I==0||h.K||sl(h.j,h)}function Fs(h){Mn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,As(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function j(h,b){try{var k=h.j;if(k.I!=0&&(k.g==h||Fe(k.h,h))){if(!h.L&&Fe(k.h,h)&&k.I==3){try{var A=k.Ba.g.parse(b)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ie=A;if(ie[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)Wa(k),Zs(k);else break e;yn(k),ne(18)}}else k.xa=ie[1],0<k.xa-k.K&&ie[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=We(y(k.Va,k),6e3));me(k.h)<=1&&k.ta&&(k.ta=void 0)}else wr(k,11)}else if((h.L||k.g==h)&&Wa(k),!D(b))for(ie=k.Ba.g.parse(b),b=0;b<ie.length;b++){let Ls=ie[b];const on=Ls[0];if(!(on<=k.K))if(k.K=on,Ls=Ls[1],k.I==2)if(Ls[0]=="c"){k.M=Ls[1],k.ba=Ls[2];const Xr=Ls[3];Xr!=null&&(k.ka=Xr,k.j.info("VER="+k.ka));const Na=Ls[4];Na!=null&&(k.za=Na,k.j.info("SVER="+k.za));const da=Ls[5];da!=null&&typeof da=="number"&&da>0&&(A=1.5*da,k.O=A,k.j.info("backChannelRequestTimeoutMs_="+A)),A=k;const ha=h.g;if(ha){const bo=ha.g?ha.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var fe=A.h;fe.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(ze(fe,fe.h),fe.h=null))}if(A.G){const rl=ha.g?ha.g.getResponseHeader("X-HTTP-Session-Id"):null;rl&&(A.wa=rl,us(A.J,A.G,rl))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),A=k;var Ge=h;if(A.na=ua(A,A.L?A.ba:null,A.W),Ge.L){tt(A.h,Ge);var ts=Ge,Nn=A.O;Nn&&(ts.H=Nn),ts.D&&(Mn(ts),fn(ts)),A.g=Ge}else dr(A);k.i.length>0&&hn(k)}else Ls[0]!="stop"&&Ls[0]!="close"||wr(k,7);else k.I==3&&(Ls[0]=="stop"||Ls[0]=="close"?Ls[0]=="stop"?wr(k,7):sn(k):Ls[0]!="noop"&&k.l&&k.l.qa(Ls),k.A=0)}}at(4)}catch{}}var N=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function F(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function me(h){return h.h?1:h.g?h.g.size:0}function Fe(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function ze(h,b){h.g?h.g.add(b):h.h=b}function tt(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ze(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const k of h.g.values())b=b.concat(k.G);return b}return V(h.i)}var es=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function js(h,b){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const A=h[k].indexOf("=");let ie,fe=null;A>=0?(ie=h[k].substring(0,A),fe=h[k].substring(A+1)):ie=h[k],b(ie,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function cs(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof cs?(this.l=h.l,zs(this,h.j),this.o=h.o,this.g=h.g,jn(this,h.u),this.h=h.h,or(this,En(h.i)),this.m=h.m):h&&(b=String(h).match(es))?(this.l=!1,zs(this,b[1]||"",!0),this.o=In(b[2]||""),this.g=In(b[3]||"",!0),jn(this,b[4]),this.h=In(b[5]||"",!0),or(this,b[6]||"",!0),this.m=In(b[7]||"")):(this.l=!1,this.i=new $t(null,this.l))}cs.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(X(b,ge,!0),":");var k=this.g;return(k||b=="file")&&(h.push("//"),(b=this.o)&&h.push(X(b,ge,!0),"@"),h.push(xe(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(X(k,k.charAt(0)=="/"?Qe:Xe,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",X(k,Ht)),h.join("")},cs.prototype.resolve=function(h){const b=ls(this);let k=!!h.j;k?zs(b,h.j):k=!!h.o,k?b.o=h.o:k=!!h.g,k?b.g=h.g:k=h.u!=null;var A=h.h;if(k)jn(b,h.u);else if(k=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ie=b.h.lastIndexOf("/");ie!=-1&&(A=b.h.slice(0,ie+1)+A)}if(ie=A,ie==".."||ie==".")A="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){A=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const fe=[];for(let Ge=0;Ge<ie.length;){const ts=ie[Ge++];ts=="."?A&&Ge==ie.length&&fe.push(""):ts==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),A&&Ge==ie.length&&fe.push("")):(fe.push(ts),A=!0)}A=fe.join("/")}else A=ie}return k?b.h=A:k=h.i.toString()!=="",k?or(b,En(h.i)):k=!!h.m,k&&(b.m=h.m),b};function ls(h){return new cs(h)}function zs(h,b,k){h.j=k?In(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function jn(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function or(h,b,k){b instanceof $t?(h.i=b,yr(h.i,h.l)):(k||(b=X(b,ut)),h.i=new $t(b,h.l))}function us(h,b,k){h.i.set(b,k)}function Qr(h){return us(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function In(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function X(h,b,k){return typeof h=="string"?(h=encodeURI(h).replace(b,be),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function be(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var ge=/[#\/\?@]/g,Xe=/[#\?:]/g,Qe=/[#\?]/g,ut=/[#\?@]/g,Ht=/#/g;function $t(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Vt(h){h.g||(h.g=new Map,h.h=0,h.i&&js(h.i,function(b,k){h.add(decodeURIComponent(b.replace(/\+/g," ")),k)}))}n=$t.prototype,n.add=function(h,b){Vt(this),this.i=null,h=Fn(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(b),this.h+=1,this};function Tn(h,b){Vt(h),b=Fn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function At(h,b){return Vt(h),b=Fn(h,b),h.g.has(b)}n.forEach=function(h,b){Vt(this),this.g.forEach(function(k,A){k.forEach(function(ie){h.call(b,ie,A,this)},this)},this)};function Ps(h,b){Vt(h);let k=[];if(typeof b=="string")At(h,b)&&(k=k.concat(h.g.get(Fn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)k=k.concat(h[b]);return k}n.set=function(h,b){return Vt(this),this.i=null,h=Fn(this,h),At(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Ps(this,h),h.length>0?String(h[0]):b):b};function gn(h,b,k){Tn(h,b),k.length>0&&(h.i=null,h.g.set(Fn(h,b),V(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let A=0;A<b.length;A++){var k=b[A];const ie=xe(k);k=Ps(this,k);for(let fe=0;fe<k.length;fe++){let Ge=ie;k[fe]!==""&&(Ge+="="+xe(k[fe])),h.push(Ge)}}return this.i=h.join("&")};function En(h){const b=new $t;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Fn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function yr(h,b){b&&!h.j&&(Vt(h),h.i=null,h.g.forEach(function(k,A){const ie=A.toLowerCase();A!=ie&&(Tn(this,A),gn(this,ie,k))},h)),h.j=b}function Qt(h,b){const k=new rt;if(d.Image){const A=new Image;A.onload=_(dn,k,"TestLoadImage: loaded",!0,b,A),A.onerror=_(dn,k,"TestLoadImage: error",!1,b,A),A.onabort=_(dn,k,"TestLoadImage: abort",!1,b,A),A.ontimeout=_(dn,k,"TestLoadImage: timeout",!1,b,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else b(!1)}function Js(h,b){const k=new rt,A=new AbortController,ie=setTimeout(()=>{A.abort(),dn(k,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:A.signal}).then(fe=>{clearTimeout(ie),fe.ok?dn(k,"TestPingServer: ok",!0,b):dn(k,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ie),dn(k,"TestPingServer: error",!1,b)})}function dn(h,b,k,A,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),A(k)}catch{}}function $n(){this.g=new Pt}function Wn(h){this.i=h.Sb||null,this.h=h.ab||!1}x(Wn,fs),Wn.prototype.g=function(){return new Sn(this.i,this.h)};function Sn(h,b){st.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Sn,st),n=Sn.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,cr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,lr(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Gn(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Gn(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?lr(this):cr(this),this.readyState==3&&Gn(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,lr(this))},n.Na=function(h){this.g&&(this.response=h,lr(this))},n.ga=function(){this.g&&lr(this)};function lr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,cr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var k=b.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=b.next();return h.join(`\r
`)};function cr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Sn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function M(h){let b="";return Ve(h,function(k,A){b+=A,b+=":",b+=k,b+=`\r
`}),b}function J(h,b,k){e:{for(A in k){var A=!1;break e}A=!0}A||(k=M(k),typeof h=="string"?k!=null&&xe(k):us(h,b,k))}function Ne(h){st.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Ne,st);var et=/^https?$/i,kt=["POST","PUT"];n=Ne.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,k,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bs.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(fe){It(this,fe);return}if(h=k||"",k=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ie in A)k.set(ie,A[ie]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const fe of A.keys())k.set(fe,A.get(fe));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(k.keys()).find(fe=>fe.toLowerCase()=="content-type"),ie=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(kt,b,void 0)>=0)||A||ie||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Ge]of k)this.g.setRequestHeader(fe,Ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(fe){It(this,fe)}};function It(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,it(h),Gt(h)}function it(h){h.A||(h.A=!0,He(h,"complete"),He(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,He(this,"complete"),He(this,"abort"),Gt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gt(this,!0)),Ne.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ft(this):this.Xa())},n.Xa=function(){Ft(this)};function Ft(h){if(h.h&&typeof u<"u"){if(h.v&&is(h)==4)setTimeout(h.Ca.bind(h),0);else if(He(h,"readystatechange"),is(h)==4){h.h=!1;try{const fe=h.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var k;if(!(k=b)){var A;if(A=fe===0){let Ge=String(h.D).match(es)[1]||null;!Ge&&d.self&&d.self.location&&(Ge=d.self.location.protocol.slice(0,-1)),A=!et.test(Ge?Ge.toLowerCase():"")}k=A}if(k)He(h,"complete"),He(h,"success");else{h.o=6;try{var ie=is(h)>2?h.g.statusText:""}catch{ie=""}h.l=ie+" ["+h.ca()+"]",it(h)}}finally{Gt(h)}}}}function Gt(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,b||He(h,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function is(h){return h.g?h.g.readyState:0}n.ca=function(){try{return is(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Xs(b)}};function Wt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function xs(h){const b={};h=(h.g&&is(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(D(h[A]))continue;var k=Ce(h[A]);const ie=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const fe=b[ie]||[];b[ie]=fe,fe.push(k)}ee(b,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kn(h,b,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||b}function br(h){this.za=0,this.i=[],this.j=new rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Kn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Kn("baseRetryDelayMs",5e3,h),this.Za=Kn("retryDelaySeedMs",1e4,h),this.Ta=Kn("forwardChannelMaxRetries",2,h),this.va=Kn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new $n,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=br.prototype,n.ka=8,n.I=1,n.connect=function(h,b,k,A){ne(0),this.W=h,this.H=b||{},k&&A!==void 0&&(this.H.OSID=k,this.H.OAID=A),this.F=this.X,this.J=ua(this,null,this.W),hn(this)};function sn(h){if(Yn(h),h.I==3){var b=h.V++,k=ls(h.J);if(us(k,"SID",h.M),us(k,"RID",b),us(k,"TYPE","terminate"),Zn(h,k),b=new Se(h,h.j,b),b.M=2,b.A=Qr(ls(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=b.A,k=!0),k||(b.g=Gu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),fn(b)}ca(h)}function Zs(h){h.g&&(xr(h),h.g.cancel(),h.g=null)}function Yn(h){Zs(h),h.v&&(d.clearTimeout(h.v),h.v=null),Wa(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function hn(h){if(!F(h.h)&&!h.m){h.m=!0;var b=h.Ea;Me||E(),we||(Me(),we=!0),C.add(b,h),h.D=0}}function zn(h,b){return me(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=We(y(h.Ea,h,b),nl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ie=new Se(this,this.j,h);let fe=this.o;if(this.U&&(fe?(fe=L(fe),De(fe,this.U)):fe=this.U),this.u!==null||this.R||(ie.J=fe,fe=null),this.S)e:{for(var b=0,k=0;k<this.i.length;k++){t:{var A=this.i[k];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(b+=A,b>4096){b=k;break e}if(b===4096||k===this.i.length-1){b=k+1;break e}}b=1e3}else b=1e3;b=vr(this,ie,b),k=ls(this.J),us(k,"RID",h),us(k,"CVER",22),this.G&&us(k,"X-HTTP-Session-Id",this.G),Zn(this,k),fe&&(this.R?b="headers="+xe(M(fe))+"&"+b:this.u&&J(k,this.u,fe)),ze(this.h,ie),this.Ra&&us(k,"TYPE","init"),this.S?(us(k,"$req",b),us(k,"SID","null"),ie.U=!0,Je(ie,k,null)):Je(ie,k,b),this.I=2}}else this.I==3&&(h?ur(this,h):this.i.length==0||F(this.h)||ur(this))};function ur(h,b){var k;b?k=b.l:k=h.V++;const A=ls(h.J);us(A,"SID",h.M),us(A,"RID",k),us(A,"AID",h.K),Zn(h,A),h.u&&h.o&&J(A,h.u,h.o),k=new Se(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),b&&(h.i=b.G.concat(h.i)),b=vr(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ze(h.h,k),Je(k,A,b)}function Zn(h,b){h.H&&Ve(h.H,function(k,A){us(b,A,k)}),h.l&&Ve({},function(k,A){us(b,A,k)})}function vr(h,b,k){k=Math.min(h.i.length,k);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var ie=h.i;let ts=-1;for(;;){const Nn=["count="+k];ts==-1?k>0?(ts=ie[0].g,Nn.push("ofs="+ts)):ts=0:Nn.push("ofs="+ts);let Ls=!0;for(let on=0;on<k;on++){var fe=ie[on].g;const Xr=ie[on].map;if(fe-=ts,fe<0)ts=Math.max(0,ie[on].g-100),Ls=!1;else try{fe="req"+fe+"_"||"";try{var Ge=Xr instanceof Map?Xr:Object.entries(Xr);for(const[Na,da]of Ge){let ha=da;p(da)&&(ha=Ut(da)),Nn.push(fe+Na+"="+encodeURIComponent(ha))}}catch(Na){throw Nn.push(fe+"type="+encodeURIComponent("_badmap")),Na}}catch{A&&A(Xr)}}if(Ls){Ge=Nn.join("&");break e}}Ge=void 0}return h=h.i.splice(0,k),b.G=h,Ge}function dr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Me||E(),we||(Me(),we=!0),C.add(b,h),h.A=0}}function yn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=We(y(h.Da,h),nl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Ar(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=We(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ne(10),Zs(this),Ar(this))};function xr(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Ar(h){h.g=new Se(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=ls(h.na);us(b,"RID","rpc"),us(b,"SID",h.M),us(b,"AID",h.K),us(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&us(b,"TO",h.ia),us(b,"TYPE","xmlhttp"),Zn(h,b),h.u&&h.o&&J(b,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=Qr(ls(b)),k.u=null,k.R=!0,_t(k,h)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),yn(this),ne(19))};function Wa(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function sl(h,b){var k=null;if(h.g==b){Wa(h),xr(h),h.g=null;var A=2}else if(Fe(h.h,b))k=b.G,tt(h.h,b),A=1;else return;if(h.I!=0){if(b.o)if(A==1){k=b.u?b.u.length:0,b=Date.now()-b.F;var ie=h.D;A=_e(),He(A,new $e(A,k)),hn(h)}else dr(h);else if(ie=b.m,ie==3||ie==0&&b.X>0||!(A==1&&zn(h,b)||A==2&&yn(h)))switch(k&&k.length>0&&(b=h.h,b.i=b.i.concat(k)),ie){case 1:wr(h,5);break;case 4:wr(h,10);break;case 3:wr(h,6);break;default:wr(h,2)}}}function nl(h,b){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*b}function wr(h,b){if(h.j.info("Error code "+b),b==2){var k=y(h.bb,h),A=h.Ua;const ie=!A;A=new cs(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||zs(A,"https"),Qr(A),ie?Qt(A.toString(),k):Js(A.toString(),k)}else ne(2);h.I=0,h.l&&h.l.pa(b),ca(h),Yn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ne(2)):(this.j.info("Failed to ping google.com"),ne(1))};function ca(h){if(h.I=0,h.ja=[],h.l){const b=Ze(h.h);(b.length!=0||h.i.length!=0)&&(W(h.ja,b),W(h.ja,h.i),h.h.i.length=0,V(h.i),h.i.length=0),h.l.oa()}}function ua(h,b,k){var A=k instanceof cs?ls(k):new cs(k);if(A.g!="")b&&(A.g=b+"."+A.g),jn(A,A.u);else{var ie=d.location;A=ie.protocol,b=b?b+"."+ie.hostname:ie.hostname,ie=+ie.port;const fe=new cs(null);A&&zs(fe,A),b&&(fe.g=b),ie&&jn(fe,ie),k&&(fe.h=k),A=fe}return k=h.G,b=h.wa,k&&b&&us(A,k,b),us(A,"VER",h.ka),Zn(h,A),A}function Gu(h,b,k){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ne(new Wn({ab:k})):new Ne(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ku(){}n=Ku.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _i(){}_i.prototype.g=function(h,b){return new _r(h,b)};function _r(h,b){st.call(this),this.g=new br(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!D(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ga(this)}x(_r,st),_r.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_r.prototype.close=function(){sn(this.g)},_r.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=Ut(h),h=k);b.i.push(new N(b.Ya++,h)),b.I==3&&hn(b)},_r.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,_r.Z.N.call(this)};function Yu(h){G.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const k in b){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}x(Yu,G);function Qu(){de.call(this),this.status=1}x(Qu,de);function Ga(h){this.g=h}x(Ga,Ku),Ga.prototype.ra=function(){He(this.g,"a")},Ga.prototype.qa=function(h){He(this.g,new Yu(h))},Ga.prototype.pa=function(h){He(this.g,new Qu)},Ga.prototype.oa=function(){He(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,_r.prototype.send=_r.prototype.o,_r.prototype.open=_r.prototype.m,_r.prototype.close=_r.prototype.close,Xw=function(){return new _i},Qw=function(){return _e()},Yw=Ee,pg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},as.NO_ERROR=0,as.TIMEOUT=8,as.HTTP_ERROR=6,wh=as,ks.COMPLETE="complete",Kw=ks,qt.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",st.prototype.listen=st.prototype.J,nu=qt,Ne.prototype.listenOnce=Ne.prototype.K,Ne.prototype.getLastError=Ne.prototype.Ha,Ne.prototype.getLastErrorCode=Ne.prototype.ya,Ne.prototype.getStatus=Ne.prototype.ca,Ne.prototype.getResponseJson=Ne.prototype.La,Ne.prototype.getResponseText=Ne.prototype.la,Ne.prototype.send=Ne.prototype.ea,Ne.prototype.setWithCredentials=Ne.prototype.Fa,Gw=Ne}).apply(typeof sh<"u"?sh:typeof self<"u"?self:typeof window<"u"?window:{});class fr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fr.UNAUTHENTICATED=new fr(null),fr.GOOGLE_CREDENTIALS=new fr("google-credentials-uid"),fr.FIRST_PARTY=new fr("first-party-uid"),fr.MOCK_USER=new fr("mock-user");let ic="12.8.0";function dR(n){ic=n}const Yo=new Wg("@firebase/firestore");function Ul(){return Yo.logLevel}function dt(n,...e){if(Yo.logLevel<=ys.DEBUG){const t=e.map(ay);Yo.debug(`Firestore (${ic}): ${n}`,...t)}}function yi(n,...e){if(Yo.logLevel<=ys.ERROR){const t=e.map(ay);Yo.error(`Firestore (${ic}): ${n}`,...t)}}function Ql(n,...e){if(Yo.logLevel<=ys.WARN){const t=e.map(ay);Yo.warn(`Firestore (${ic}): ${n}`,...t)}}function ay(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ot(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Jw(n,i,t)}function Jw(n,e,t){let i=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw yi(i),new Error(i)}function Us(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Jw(e,l,i)}function Jt(n,e){return n}const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends $a{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Zw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fr.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class fR{constructor(e){this.t=e,this.currentUser=fr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Us(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new mi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new mi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new mi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Us(typeof i.accessToken=="string",31837,{l:i}),new Zw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Us(e===null||typeof e=="string",2055,{h:e}),new fr(e)}}class pR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new pR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Us(this.o===void 0,3512);const i=u=>{u.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,dt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Us(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new bx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class iy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function bs(n,e){return n<e?-1:n>e?1:0}function gg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Ip(l)===Ip(u)?bs(l,u):Ip(l)?1:-1}return bs(n.length,e.length)}const vR=55296,xR=57343;function Ip(n){const e=n.charCodeAt(0);return e>=vR&&e<=xR}function Xl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const vx="__name__";class Da{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ot(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ot(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Da.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Da?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Da.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return bs(e.length,t.length)}static compareSegments(e,t){const i=Da.isNumericId(e),l=Da.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Da.extractNumericId(e).compare(Da.extractNumericId(t)):gg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class nn extends Da{construct(e,t,i){return new nn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(Re.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new nn(t)}static emptyPath(){return new nn([])}}const wR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ar extends Da{construct(e,t,i){return new ar(e,t,i)}static isValidIdentifier(e){return wR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ar.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vx}static keyField(){return new ar([vx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new nt(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ar(t)}static emptyPath(){return new ar([])}}class St{constructor(e){this.path=e}static fromPath(e){return new St(nn.fromString(e))}static fromName(e){return new St(nn.fromString(e).popFirst(5))}static empty(){return new St(nn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new St(new nn(e.slice()))}}function e_(n,e,t){if(!t)throw new nt(Re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _R(n,e,t,i){if(e===!0&&i===!0)throw new nt(Re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function xx(n){if(!St.isDocumentKey(n))throw new nt(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function wx(n){if(St.isDocumentKey(n))throw new nt(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function t_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function nm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ot(12329,{type:typeof n})}function Nr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nm(n);throw new nt(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kR(n,e){if(e<=0)throw new nt(Re.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Un(n,e){const t={typeString:n};return e&&(t.value=e),t}function Lu(n,e){if(!t_(n))throw new nt(Re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(Re.INVALID_ARGUMENT,t);return!0}const _x=-62135596800,kx=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*kx);return new wt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<_x)throw new nt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kx}_compareTo(e){return this.seconds===e.seconds?bs(this.nanoseconds,e.nanoseconds):bs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Lu(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_x;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:Un("string",wt._jsonSchemaVersion),seconds:Un("number"),nanoseconds:Un("number")};class Kt{static fromTimestamp(e){return new Kt(e)}static min(){return new Kt(new wt(0,0))}static max(){return new Kt(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const vu=-1;function jR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=Kt.fromTimestamp(i===1e9?new wt(t+1,0):new wt(t,i));return new oo(l,St.empty(),e)}function TR(n){return new oo(n.readTime,n.key,vu)}class oo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oo(Kt.min(),St.empty(),vu)}static max(){return new oo(Kt.max(),St.empty(),vu)}}function ER(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=St.comparator(n.documentKey,e.documentKey),t!==0?t:bs(n.largestBatchId,e.largestBatchId))}const SR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oc(n){if(n.code!==Re.FAILED_PRECONDITION||n.message!==SR)throw n;dt("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Oe(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Oe?t:Oe.resolve(t)}catch(t){return Oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Oe.reject(t)}static resolve(e){return new Oe(((t,i)=>{t(e)}))}static reject(e){return new Oe(((t,i)=>{i(e)}))}static waitFor(e){return new Oe(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Oe.resolve(!1);for(const i of e)t=t.next((l=>l?Oe.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Oe(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((_=>{d[y]=_,++p,p===u&&i(d)}),(_=>l(_)))}}))}static doWhile(e,t){return new Oe(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function CR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function lc(n){return n.name==="IndexedDbTransactionError"}class rm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rm.ce=-1;const oy=-1;function am(n){return n==null}function Oh(n){return n===0&&1/n==-1/0}function RR(n){return typeof n=="number"&&Number.isInteger(n)&&!Oh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const s_="";function AR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jx(e)),e=MR(n.get(t),e);return jx(e)}function MR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case s_:t+="";break;default:t+=u}}return t}function jx(n){return n+s_+""}function Tx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function go(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function n_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mn{constructor(e,t){this.comparator=e,this.root=t||rr.EMPTY}insert(e,t){return new mn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rr.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nh(this.root,e,this.comparator,!1)}getReverseIterator(){return new nh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nh(this.root,e,this.comparator,!0)}}class nh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??rr.RED,this.left=l??rr.EMPTY,this.right=u??rr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new rr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return rr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return rr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ot(27949);return e+(this.isRed()?0:1)}}rr.EMPTY=null,rr.RED=!0,rr.BLACK=!1;rr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new rr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hn{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ex(this.data.getIterator())}getIteratorFrom(e){return new Ex(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Hn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Hn(this.comparator);return t.data=e,t}}class Ex{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Kr{constructor(e){this.fields=e,e.sort(ar.comparator)}static empty(){return new Kr([])}unionWith(e){let t=new Hn(ar.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Kr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class r_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ir{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new r_("Invalid base64 string: "+u):u}})(e);return new ir(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new ir(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ir.EMPTY_BYTE_STRING=new ir("");const IR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(Us(!!n,39018),typeof n=="string"){let e=0;const t=IR.exec(n);if(Us(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:An(n.seconds),nanos:An(n.nanos)}}function An(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?ir.fromBase64String(n):ir.fromUint8Array(n)}const a_="server_timestamp",i_="__type__",o_="__previous_value__",l_="__local_write_time__";function ly(n){return(n?.mapValue?.fields||{})[i_]?.stringValue===a_}function im(n){const e=n.mapValue.fields[o_];return ly(e)?im(e):e}function xu(n){const e=lo(n.mapValue.fields[l_].timestampValue);return new wt(e.seconds,e.nanos)}class DR{constructor(e,t,i,l,u,d,p,g,y,_,x){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=_,this.apiKey=x}}const Vh="(default)";class wu{constructor(e,t){this.projectId=e,this.database=t||Vh}static empty(){return new wu("","")}get isDefaultDatabase(){return this.database===Vh}isEqual(e){return e instanceof wu&&e.projectId===this.projectId&&e.database===this.database}}function PR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new nt(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wu(n.options.projectId,e)}const c_="__type__",LR="__max__",rh={mapValue:{}},u_="__vector__",Bh="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ly(n)?4:VR(n)?9007199254740991:OR(n)?10:11:Ot(28295,{value:n})}function qa(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xu(n).isEqual(xu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=lo(l.timestampValue),p=lo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return co(l.bytesValue).isEqual(co(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return An(l.geoPointValue.latitude)===An(u.geoPointValue.latitude)&&An(l.geoPointValue.longitude)===An(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return An(l.integerValue)===An(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=An(l.doubleValue),p=An(u.doubleValue);return d===p?Oh(d)===Oh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Xl(n.arrayValue.values||[],e.arrayValue.values||[],qa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Tx(d)!==Tx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!qa(d[g],p[g])))return!1;return!0})(n,e);default:return Ot(52216,{left:n})}}function _u(n,e){return(n.values||[]).find((t=>qa(t,e)))!==void 0}function Jl(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return bs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return bs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=An(u.integerValue||u.doubleValue),g=An(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Sx(n.timestampValue,e.timestampValue);case 4:return Sx(xu(n),xu(e));case 5:return gg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=co(u),g=co(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const _=bs(p[y],g[y]);if(_!==0)return _}return bs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=bs(An(u.latitude),An(d.latitude));return p!==0?p:bs(An(u.longitude),An(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Nx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Bh]?.arrayValue,_=g[Bh]?.arrayValue,x=bs(y?.values?.length||0,_?.values?.length||0);return x!==0?x:Nx(y,_)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===rh.mapValue&&d===rh.mapValue)return 0;if(u===rh.mapValue)return 1;if(d===rh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},_=Object.keys(y);g.sort(),_.sort();for(let x=0;x<g.length&&x<_.length;++x){const T=gg(g[x],_[x]);if(T!==0)return T;const V=Jl(p[g[x]],y[_[x]]);if(V!==0)return V}return bs(g.length,_.length)})(n.mapValue,e.mapValue);default:throw Ot(23264,{he:t})}}function Sx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return bs(n,e);const t=lo(n),i=lo(e),l=bs(t.seconds,i.seconds);return l!==0?l:bs(t.nanos,i.nanos)}function Nx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Jl(t[l],i[l]);if(u)return u}return bs(t.length,i.length)}function Zl(n){return yg(n)}function yg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return St.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=yg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${yg(t.fields[d])}`;return l+"}"})(n.mapValue):Ot(61005,{value:n})}function _h(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=im(n);return e?16+_h(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+_h(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return go(i.fields,((u,d)=>{l+=u.length+_h(d)})),l})(n.mapValue);default:throw Ot(13486,{value:n})}}function Cx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function bg(n){return!!n&&"integerValue"in n}function cy(n){return!!n&&"arrayValue"in n}function Rx(n){return!!n&&"nullValue"in n}function Ax(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kh(n){return!!n&&"mapValue"in n}function OR(n){return(n?.mapValue?.fields||{})[c_]?.stringValue===u_}function cu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return go(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=cu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cu(n.arrayValue.values[t]);return e}return{...n}}function VR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===LR}class Vr{constructor(e){this.value=e}static empty(){return new Vr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!kh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cu(t)}setAll(e){let t=ar.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=cu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());kh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];kh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){go(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Vr(cu(this.value))}}function d_(n){const e=[];return go(n.fields,((t,i)=>{const l=new ar([t]);if(kh(i)){const u=d_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Kr(e)}class pr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new pr(e,0,Kt.min(),Kt.min(),Kt.min(),Vr.empty(),0)}static newFoundDocument(e,t,i,l){return new pr(e,1,t,Kt.min(),i,l,0)}static newNoDocument(e,t){return new pr(e,2,t,Kt.min(),Kt.min(),Vr.empty(),0)}static newUnknownDocument(e,t){return new pr(e,3,t,Kt.min(),Kt.min(),Vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Uh{constructor(e,t){this.position=e,this.inclusive=t}}function Mx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=St.comparator(St.fromName(d.referenceValue),t.key):i=Jl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ix(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qa(n.position[t],e.position[t]))return!1;return!0}class ku{constructor(e,t="asc"){this.field=e,this.dir=t}}function BR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class h_{}class Bn extends h_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FR(e,t,i):t==="array-contains"?new HR(e,i):t==="in"?new $R(e,i):t==="not-in"?new WR(e,i):t==="array-contains-any"?new GR(e,i):new Bn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new zR(e,i):new qR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Jl(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ka extends h_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ka(e,t)}matches(e){return m_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function m_(n){return n.op==="and"}function f_(n){return UR(n)&&m_(n)}function UR(n){for(const e of n.filters)if(e instanceof ka)return!1;return!0}function vg(n){if(n instanceof Bn)return n.field.canonicalString()+n.op.toString()+Zl(n.value);if(f_(n))return n.filters.map((e=>vg(e))).join(",");{const e=n.filters.map((t=>vg(t))).join(",");return`${n.op}(${e})`}}function p_(n,e){return n instanceof Bn?(function(i,l){return l instanceof Bn&&i.op===l.op&&i.field.isEqual(l.field)&&qa(i.value,l.value)})(n,e):n instanceof ka?(function(i,l){return l instanceof ka&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&p_(d,l.filters[p])),!0):!1})(n,e):void Ot(19439)}function g_(n){return n instanceof Bn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Zl(t.value)}`})(n):n instanceof ka?(function(t){return t.op.toString()+" {"+t.getFilters().map(g_).join(" ,")+"}"})(n):"Filter"}class FR extends Bn{constructor(e,t,i){super(e,t,i),this.key=St.fromName(i.referenceValue)}matches(e){const t=St.comparator(e.key,this.key);return this.matchesComparison(t)}}class zR extends Bn{constructor(e,t){super(e,"in",t),this.keys=y_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qR extends Bn{constructor(e,t){super(e,"not-in",t),this.keys=y_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function y_(n,e){return(e.arrayValue?.values||[]).map((t=>St.fromName(t.referenceValue)))}class HR extends Bn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cy(t)&&_u(t.arrayValue,this.value)}}class $R extends Bn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&_u(this.value.arrayValue,t)}}class WR extends Bn{constructor(e,t){super(e,"not-in",t)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!_u(this.value.arrayValue,t)}}class GR extends Bn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>_u(this.value.arrayValue,i)))}}class KR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Dx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new KR(n,e,t,i,l,u,d)}function uy(n){const e=Jt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>vg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),am(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Zl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Zl(i))).join(",")),e.Te=t}return e.Te}function dy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!BR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!p_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ix(n.startAt,e.startAt)&&Ix(n.endAt,e.endAt)}function xg(n){return St.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class cc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function YR(n,e,t,i,l,u,d,p){return new cc(n,e,t,i,l,u,d,p)}function om(n){return new cc(n)}function Px(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function QR(n){return St.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function b_(n){return n.collectionGroup!==null}function uu(n){const e=Jt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Hn(ar.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new ku(u,i))})),t.has(ar.keyField().canonicalString())||e.Ie.push(new ku(ar.keyField(),i))}return e.Ie}function Ua(n){const e=Jt(n);return e.Ee||(e.Ee=XR(e,uu(n))),e.Ee}function XR(n,e){if(n.limitType==="F")return Dx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new ku(l.field,u)}));const t=n.endAt?new Uh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Uh(n.startAt.position,n.startAt.inclusive):null;return Dx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function wg(n,e){const t=n.filters.concat([e]);return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function JR(n,e){const t=n.explicitOrderBy.concat([e]);return new cc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Fh(n,e,t){return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function lm(n,e){return dy(Ua(n),Ua(e))&&n.limitType===e.limitType}function v_(n){return`${uy(Ua(n))}|lt:${n.limitType}`}function Fl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>g_(l))).join(", ")}]`),am(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Zl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Zl(l))).join(",")),`Target(${i})`})(Ua(n))}; limitType=${n.limitType})`}function cm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):St.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of uu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Mx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,uu(i),l)||i.endAt&&!(function(d,p,g){const y=Mx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,uu(i),l))})(n,e)}function ZR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function x_(n){return(e,t)=>{let i=!1;for(const l of uu(n)){const u=eA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function eA(n,e,t){const i=n.field.isKeyField()?St.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Jl(g,y):Ot(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ot(19790,{direction:n.dir})}}class el{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return n_(this.inner)}size(){return this.innerSize}}const tA=new mn(St.comparator);function bi(){return tA}const w_=new mn(St.comparator);function ru(...n){let e=w_;for(const t of n)e=e.insert(t.key,t);return e}function __(n){let e=w_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Bo(){return du()}function k_(){return du()}function du(){return new el((n=>n.toString()),((n,e)=>n.isEqual(e)))}const sA=new mn(St.comparator),nA=new Hn(St.comparator);function vs(...n){let e=nA;for(const t of n)e=e.add(t);return e}const rA=new Hn(bs);function aA(){return rA}function hy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function j_(n){return{integerValue:""+n}}function T_(n,e){return RR(e)?j_(e):hy(n,e)}class um{constructor(){this._=void 0}}function iA(n,e,t){return n instanceof ju?(function(l,u){const d={fields:{[i_]:{stringValue:a_},[l_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ly(u)&&(u=im(u)),u&&(d.fields[o_]=u),{mapValue:d}})(t,e):n instanceof Tu?S_(n,e):n instanceof Eu?N_(n,e):(function(l,u){const d=E_(l,u),p=Lx(d)+Lx(l.Ae);return bg(d)&&bg(l.Ae)?j_(p):hy(l.serializer,p)})(n,e)}function oA(n,e,t){return n instanceof Tu?S_(n,e):n instanceof Eu?N_(n,e):t}function E_(n,e){return n instanceof Su?(function(i){return bg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ju extends um{}class Tu extends um{constructor(e){super(),this.elements=e}}function S_(n,e){const t=C_(e);for(const i of n.elements)t.some((l=>qa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Eu extends um{constructor(e){super(),this.elements=e}}function N_(n,e){let t=C_(e);for(const i of n.elements)t=t.filter((l=>!qa(l,i)));return{arrayValue:{values:t}}}class Su extends um{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Lx(n){return An(n.integerValue||n.doubleValue)}function C_(n){return cy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class R_{constructor(e,t){this.field=e,this.transform=t}}function lA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Tu&&l instanceof Tu||i instanceof Eu&&l instanceof Eu?Xl(i.elements,l.elements,qa):i instanceof Su&&l instanceof Su?qa(i.Ae,l.Ae):i instanceof ju&&l instanceof ju})(n.transform,e.transform)}class cA{constructor(e,t){this.version=e,this.transformResults=t}}class Cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cr}static exists(e){return new Cr(void 0,e)}static updateTime(e){return new Cr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class dm{}function A_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new hm(n.key,Cr.none()):new Ou(n.key,n.data,Cr.none());{const t=n.data,i=Vr.empty();let l=new Hn(ar.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new yo(n.key,i,new Kr(l.toArray()),Cr.none())}}function uA(n,e,t){n instanceof Ou?(function(l,u,d){const p=l.value.clone(),g=Vx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof yo?(function(l,u,d){if(!jh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Vx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(M_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function hu(n,e,t,i){return n instanceof Ou?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=u.value.clone(),_=Bx(u.fieldTransforms,g,d);return y.setAll(_),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof yo?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=Bx(u.fieldTransforms,g,d),_=d.data;return _.setAll(M_(u)),_.setAll(y),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((x=>x.field)))})(n,e,t,i):(function(u,d,p){return jh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function dA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=E_(i.transform,l||null);u!=null&&(t===null&&(t=Vr.empty()),t.set(i.field,u))}return t||null}function Ox(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Xl(i,l,((u,d)=>lA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ou extends dm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yo extends dm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function M_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Vx(n,e,t){const i=new Map;Us(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,oA(d,p,t[l]))}return i}function Bx(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,iA(u,d,e))}return i}class hm extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hA extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&uA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=hu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=hu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=k_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=A_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(Kt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vs())}isEqual(e){return this.batchId===e.batchId&&Xl(this.mutations,e.mutations,((t,i)=>Ox(t,i)))&&Xl(this.baseMutations,e.baseMutations,((t,i)=>Ox(t,i)))}}class my{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Us(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return sA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new my(e,t,i,l)}}class fA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Ts;function gA(n){switch(n){case Re.OK:return Ot(64938);case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return Ot(15467,{code:n})}}function I_(n){if(n===void 0)return yi("GRPC error has no .code"),Re.UNKNOWN;switch(n){case Vn.OK:return Re.OK;case Vn.CANCELLED:return Re.CANCELLED;case Vn.UNKNOWN:return Re.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return Re.INTERNAL;case Vn.UNAVAILABLE:return Re.UNAVAILABLE;case Vn.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Vn.NOT_FOUND:return Re.NOT_FOUND;case Vn.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Vn.ABORTED:return Re.ABORTED;case Vn.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Vn.DATA_LOSS:return Re.DATA_LOSS;default:return Ot(39323,{code:n})}}(Ts=Vn||(Vn={}))[Ts.OK=0]="OK",Ts[Ts.CANCELLED=1]="CANCELLED",Ts[Ts.UNKNOWN=2]="UNKNOWN",Ts[Ts.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ts[Ts.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ts[Ts.NOT_FOUND=5]="NOT_FOUND",Ts[Ts.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ts[Ts.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ts[Ts.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ts[Ts.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ts[Ts.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ts[Ts.ABORTED=10]="ABORTED",Ts[Ts.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ts[Ts.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ts[Ts.INTERNAL=13]="INTERNAL",Ts[Ts.UNAVAILABLE=14]="UNAVAILABLE",Ts[Ts.DATA_LOSS=15]="DATA_LOSS";function yA(){return new TextEncoder}const bA=new ro([4294967295,4294967295],0);function Ux(n){const e=yA().encode(n),t=new Ww;return t.update(e),new Uint8Array(t.digest())}function Fx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ro([t,i],0),new ro([l,u],0)]}class fy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new au(`Invalid padding: ${t}`);if(i<0)throw new au(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new au(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new au(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ro.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ro.fromNumber(i)));return l.compare(bA)===1&&(l=new ro([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ux(e),[i,l]=Fx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new fy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Ux(e),[i,l]=Fx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class mm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new mm(Kt.min(),l,new mn(bs),bi(),vs())}}class Vu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Vu(i,t,vs(),vs(),vs())}}class Th{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class D_{constructor(e,t){this.targetId=e,this.Ce=t}}class P_{constructor(e,t,i=ir.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class zx{constructor(){this.ve=0,this.Fe=qx(),this.Me=ir.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=vs(),t=vs(),i=vs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Ot(38017,{changeType:u})}})),new Vu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=qx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Us(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class vA{constructor(e){this.Ge=e,this.ze=new Map,this.je=bi(),this.He=ah(),this.Je=ah(),this.Ze=new mn(bs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ot(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(xg(u))if(i===0){const d=new St(u.path);this.et(t,d,pr.newNoDocument(d,Kt.min()))}else Us(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=co(i).toUint8Array()}catch(g){if(g instanceof r_)return Ql("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new fy(d,l,u)}catch(g){return Ql(g instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&xg(p.target)){const g=new St(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,pr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=vs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new mm(e,t,this.Ze,this.je,i);return this.je=bi(),this.He=ah(),this.Je=ah(),this.Ze=new mn(bs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new zx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Hn(bs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Hn(bs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||dt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ah(){return new mn(St.comparator)}function qx(){return new mn(St.comparator)}const xA={asc:"ASCENDING",desc:"DESCENDING"},wA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_A={and:"AND",or:"OR"};class kA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function _g(n,e){return n.useProto3Json||am(e)?e:{value:e}}function zh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function L_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jA(n,e){return zh(n,e.toTimestamp())}function Fa(n){return Us(!!n,49232),Kt.fromTimestamp((function(t){const i=lo(t);return new wt(i.seconds,i.nanos)})(n))}function py(n,e){return kg(n,e).canonicalString()}function kg(n,e){const t=(function(l){return new nn(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function O_(n){const e=nn.fromString(n);return Us(z_(e),10190,{key:e.toString()}),e}function jg(n,e){return py(n.databaseId,e.path)}function Dp(n,e){const t=O_(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new St(B_(t))}function V_(n,e){return py(n.databaseId,e)}function TA(n){const e=O_(n);return e.length===4?nn.emptyPath():B_(e)}function Tg(n){return new nn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function B_(n){return Us(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Hx(n,e,t){return{name:jg(n,e),fields:t.value.mapValue.fields}}function EA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Ot(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,_){return y.useProto3Json?(Us(_===void 0||typeof _=="string",58123),ir.fromBase64String(_||"")):(Us(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),ir.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const _=y.code===void 0?Re.UNKNOWN:I_(y.code);return new nt(_,y.message||"")})(d);t=new P_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Dp(n,i.document.name),u=Fa(i.document.updateTime),d=i.document.createTime?Fa(i.document.createTime):Kt.min(),p=new Vr({mapValue:{fields:i.document.fields}}),g=pr.newFoundDocument(l,u,d,p),y=i.targetIds||[],_=i.removedTargetIds||[];t=new Th(y,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Dp(n,i.document),u=i.readTime?Fa(i.readTime):Kt.min(),d=pr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Th([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Dp(n,i.document),u=i.removedTargetIds||[];t=new Th([],u,l,null)}else{if(!("filter"in e))return Ot(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new pA(l,u),p=i.targetId;t=new D_(p,d)}}return t}function SA(n,e){let t;if(e instanceof Ou)t={update:Hx(n,e.key,e.value)};else if(e instanceof hm)t={delete:jg(n,e.key)};else if(e instanceof yo)t={update:Hx(n,e.key,e.data),updateMask:LA(e.fieldMask)};else{if(!(e instanceof hA))return Ot(16599,{dt:e.type});t={verify:jg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof ju)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Su)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Ot(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:jA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ot(27497)})(n,e.precondition)),t}function NA(n,e){return n&&n.length>0?(Us(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Fa(l.updateTime):Fa(u);return d.isEqual(Kt.min())&&(d=Fa(u)),new cA(d,l.transformResults||[])})(t,e)))):[]}function CA(n,e){return{documents:[V_(n,e.path)]}}function RA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=V_(n,l);const u=(function(y){if(y.length!==0)return F_(ka.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((_=>(function(T){return{field:zl(T.field),direction:IA(T.dir)}})(_)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=_g(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function AA(n){let e=TA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Us(i===1,65062);const _=t.from[0];_.allDescendants?l=_.collectionId:e=e.child(_.collectionId)}let u=[];t.where&&(u=(function(x){const T=U_(x);return T instanceof ka&&f_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(x){return x.map((T=>(function(W){return new ku(ql(W.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(W.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(x){let T;return T=typeof x=="object"?x.value:x,am(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(x){const T=!!x.before,V=x.values||[];return new Uh(V,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(x){const T=!x.before,V=x.values||[];return new Uh(V,T)})(t.endAt)),YR(e,l,d,u,p,"F",g,y)}function MA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function U_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ql(t.unaryFilter.field);return Bn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=ql(t.unaryFilter.field);return Bn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=ql(t.unaryFilter.field);return Bn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ql(t.unaryFilter.field);return Bn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Bn.create(ql(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ka.create(t.compositeFilter.filters.map((i=>U_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}})(t.compositeFilter.op))})(n):Ot(30097,{filter:n})}function IA(n){return xA[n]}function DA(n){return wA[n]}function PA(n){return _A[n]}function zl(n){return{fieldPath:n.canonicalString()}}function ql(n){return ar.fromServerFormat(n.fieldPath)}function F_(n){return n instanceof Bn?(function(t){if(t.op==="=="){if(Ax(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NAN"}};if(Rx(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ax(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NAN"}};if(Rx(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zl(t.field),op:DA(t.op),value:t.value}}})(n):n instanceof ka?(function(t){const i=t.getFilters().map((l=>F_(l)));return i.length===1?i[0]:{compositeFilter:{op:PA(t.op),filters:i}}})(n):Ot(54877,{filter:n})}function LA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function z_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function q_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Zi{constructor(e,t,i,l,u=Kt.min(),d=Kt.min(),p=ir.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class OA{constructor(e){this.yt=e}}function VA(n){const e=AA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fh(e,e.limit,"L"):e}class BA{constructor(){this.Sn=new UA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Oe.resolve()}getCollectionParents(e,t){return Oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Oe.resolve()}deleteFieldIndex(e,t){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,t){return Oe.resolve()}getDocumentsMatchingTarget(e,t){return Oe.resolve(null)}getIndexType(e,t){return Oe.resolve(0)}getFieldIndexes(e,t){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,t){return Oe.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,t){return Oe.resolve(oo.min())}updateCollectionGroup(e,t,i){return Oe.resolve()}updateIndexEntries(e,t){return Oe.resolve()}}class UA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Hn(nn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Hn(nn.comparator)).toArray()}}const $x={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},H_=41943040;class Or{static withCacheSize(e){return new Or(e,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Or.DEFAULT_COLLECTION_PERCENTILE=10,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Or.DEFAULT=new Or(H_,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Or.DISABLED=new Or(-1,0,0);class ec{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ec(0)}static ar(){return new ec(-1)}}const Wx="LruGarbageCollector",FA=1048576;function Gx([n,e],[t,i]){const l=bs(n,t);return l===0?bs(e,i):l}class zA{constructor(e){this.Pr=e,this.buffer=new Hn(Gx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Gx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){dt(Wx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){lc(t)?dt(Wx,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)}))}}class HA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Oe.resolve(rm.ce);const i=new zA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(dt("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve($x)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$x):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),l=this.params.maximumSequenceNumbersToCollect):l=x,d=Date.now(),this.nthSequenceNumber(e,l)))).next((x=>(i=x,p=Date.now(),this.removeTargets(e,i,t)))).next((x=>(u=x,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((x=>(y=Date.now(),Ul()<=ys.DEBUG&&dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${x} documents in `+(y-g)+`ms
Total Duration: ${y-_}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:x}))))}}function $A(n,e){return new HA(n,e)}class WA{constructor(){this.changes=new el((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class KA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&hu(i.mutation,l,Kr.empty(),wt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,vs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=vs()){const l=Bo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=ru();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Bo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,vs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=bi();const d=du(),p=(function(){return du()})();return t.forEach(((g,y)=>{const _=i.get(y.key);l.has(y.key)&&(_===void 0||_.mutation instanceof yo)?u=u.insert(y.key,y):_!==void 0?(d.set(y.key,_.mutation.getFieldMask()),hu(_.mutation,y,_.mutation.getFieldMask(),wt.now())):d.set(y.key,Kr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,_)=>d.set(y,_))),t.forEach(((y,_)=>p.set(y,new GA(_,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=du();let l=new mn(((d,p)=>d-p)),u=vs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let _=i.get(g)||Kr.empty();_=p.applyToLocalView(y,_),i.set(g,_);const x=(l.get(p.batchId)||vs()).add(g);l=l.insert(p.batchId,x)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,_=g.value,x=k_();_.forEach((T=>{if(!u.has(T)){const V=A_(t.get(T),i.get(T));V!==null&&x.set(T,V),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,x))}return Oe.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return QR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):b_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Oe.resolve(Bo());let p=vu,g=u;return d.next((y=>Oe.forEach(y,((_,x)=>(p<x.largestBatchId&&(p=x.largestBatchId),u.get(_)?Oe.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{g=g.insert(_,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,vs()))).next((_=>({batchId:p,changes:__(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new St(t)).next((i=>{let l=ru();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=ru();return this.indexManager.getCollectionParents(e,u).next((p=>Oe.forEach(p,(g=>{const y=(function(x,T){return new cc(T,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((_=>{_.forEach(((x,T)=>{d=d.insert(x,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const _=y.getKey();d.get(_)===null&&(d=d.insert(_,pr.newInvalidDocument(_)))}));let p=ru();return d.forEach(((g,y)=>{const _=u.get(g);_!==void 0&&hu(_.mutation,y,Kr.empty(),wt.now()),cm(t,y)&&(p=p.insert(g,y))})),p}))}}class YA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Fa(l.createTime)}})(t)),Oe.resolve()}getNamedQuery(e,t){return Oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:VA(l.bundledQuery),readTime:Fa(l.readTime)}})(t)),Oe.resolve()}}class QA{constructor(){this.overlays=new mn(St.comparator),this.Lr=new Map}getOverlay(e,t){return Oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Bo();return Oe.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Oe.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Oe.resolve()}getOverlaysForCollection(e,t,i){const l=Bo(),u=t.length+1,d=new St(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Oe.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new mn(((y,_)=>y-_));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let _=u.get(y.largestBatchId);_===null&&(_=Bo(),u=u.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const p=Bo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,_)=>p.set(y,_))),!(p.size()>=l)););return Oe.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new fA(t,i));let u=this.Lr.get(t);u===void 0&&(u=vs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class XA{constructor(){this.sessionToken=ir.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Oe.resolve()}}class gy{constructor(){this.kr=new Hn(Xn.Kr),this.qr=new Hn(Xn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Xn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Xn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new St(new nn([])),i=new Xn(t,e),l=new Xn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new St(new nn([])),i=new Xn(t,e),l=new Xn(t,e+1);let u=vs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Xn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Xn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return St.comparator(e.key,t.key)||bs(e.Hr,t.Hr)}static Ur(e,t){return bs(e.Hr,t.Hr)||St.comparator(e.key,t.key)}}class JA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Hn(Xn.Kr)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Xn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Oe.resolve(d)}lookupMutationBatch(e,t){return Oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Oe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?oy:this.Yn-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Xn(t,0),l=new Xn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Oe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Hn(bs);return t.forEach((l=>{const u=new Xn(l,0),d=new Xn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Oe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;St.isDocumentKey(u)||(u=u.child(""));const d=new Xn(new St(u),0);let p=new Hn(bs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Oe.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Us(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Oe.forEach(t.mutations,(l=>{const u=new Xn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Xn(t,0),l=this.Jr.firstAfterOrEqual(i);return Oe.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ZA{constructor(e){this.ti=e,this.docs=(function(){return new mn(St.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Oe.resolve(i?i.document.mutableCopy():pr.newInvalidDocument(t))}getEntries(e,t){let i=bi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():pr.newInvalidDocument(l))})),Oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=bi();const d=t.path,p=new St(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:_}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||ER(TR(_),i)<=0||(l.has(_.key)||cm(t,_))&&(u=u.insert(_.key,_.mutableCopy()))}return Oe.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Ot(9500)}ni(e,t){return Oe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new eM(this)}getSize(e){return Oe.resolve(this.size)}}class eM extends WA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class tM{constructor(e){this.persistence=e,this.ri=new el((t=>uy(t)),dy),this.lastRemoteSnapshotVersion=Kt.min(),this.highestTargetId=0,this.ii=0,this.si=new gy,this.targetCount=0,this.oi=ec._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ec(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Oe.resolve()}updateTargetData(e,t){return this.lr(t),Oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Oe.waitFor(u).next((()=>l))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Oe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Oe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Oe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Oe.resolve(i)}containsKey(e,t){return Oe.resolve(this.si.containsKey(t))}}class $_{constructor(e,t){this._i={},this.overlays={},this.ai=new rm(0),this.ui=!1,this.ui=!0,this.ci=new XA,this.referenceDelegate=e(this),this.li=new tM(this),this.indexManager=new BA,this.remoteDocumentCache=(function(l){return new ZA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new OA(t),this.Pi=new YA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new JA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){dt("MemoryPersistence","Starting transaction:",e);const l=new sM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Oe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sM extends NR{constructor(e){super(),this.currentSequenceNumber=e}}class yy{constructor(e){this.persistence=e,this.Ri=new gy,this.Ai=null}static Vi(e){return new yy(e)}get di(){if(this.Ai)return this.Ai;throw Ot(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Oe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.di,(i=>{const l=St.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Kt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class qh{constructor(e,t){this.persistence=e,this.fi=new el((i=>AR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=$A(this,t)}static Vi(e,t){return new qh(e,t)}Ti(){}Ii(e){return Oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Oe.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Oe.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,Kt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Oe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_h(e.data.value)),t}wr(e,t,i){return Oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Oe.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class by{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=vs(),l=vs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new by(e,t.fromCache,i,l)}}class nM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return AS()?8:CR(gr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new nM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ul()<=ys.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",Fl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Oe.resolve()):(Ul()<=ys.DEBUG&&dt("QueryEngine","Query:",Fl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ul()<=ys.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",Fl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ua(t))):Oe.resolve())}gs(e,t){if(Px(t))return Oe.resolve(null);let i=Ua(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Fh(t,null,"F"),i=Ua(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=vs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Fh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Px(t)||l.isEqual(Kt.min())?Oe.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Oe.resolve(null):(Ul()<=ys.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Fl(t)),this.Ds(e,d,t,jR(l,vu)).next((p=>p)))}))}bs(e,t){let i=new Hn(x_(e));return t.forEach(((l,u)=>{cm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ul()<=ys.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",Fl(t)),this.fs.getDocumentsMatchingQuery(e,t,oo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const vy="LocalStore",aM=3e8;class iM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new mn(bs),this.Fs=new el((u=>uy(u)),dy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function oM(n,e,t,i){return new iM(n,e,t,i)}async function W_(n,e){const t=Jt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=vs();for(const y of l){d.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}for(const y of u){p.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function lM(n,e){const t=Jt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,_){const x=y.batch,T=x.keys();let V=Oe.resolve();return T.forEach((W=>{V=V.next((()=>_.getEntry(g,W))).next((z=>{const U=y.docVersions.get(W);Us(U!==null,48541),z.version.compareTo(U)<0&&(x.applyToRemoteDocument(z,y),z.isValidDocument()&&(z.setReadTime(y.commitVersion),_.addEntry(z)))}))})),V.next((()=>p.mutationQueue.removeMutationBatch(g,x)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=vs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function G_(n){const e=Jt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function cM(n,e){const t=Jt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((_,x)=>{const T=l.get(x);if(!T)return;p.push(t.li.removeMatchingKeys(u,_.removedDocuments,x).next((()=>t.li.addMatchingKeys(u,_.addedDocuments,x))));let V=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(x)!==null?V=V.withResumeToken(ir.EMPTY_BYTE_STRING,Kt.min()).withLastLimboFreeSnapshotVersion(Kt.min()):_.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(_.resumeToken,i)),l=l.insert(x,V),(function(z,U,Z){return z.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=aM?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0})(T,V,_)&&p.push(t.li.updateTargetData(u,V))}));let g=bi(),y=vs();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,_))})),p.push(uM(u,d,e.documentUpdates).next((_=>{g=_.Bs,y=_.Ls}))),!i.isEqual(Kt.min())){const _=t.li.getLastRemoteSnapshotVersion(u).next((x=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(_)}return Oe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function uM(n,e,t){let i=vs(),l=vs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=bi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Kt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):dt(vy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function dM(n,e){const t=Jt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=oy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function hM(n,e){const t=Jt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Oe.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Eg(n,e,t){const i=Jt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!lc(d))throw d;dt(vy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Kx(n,e,t){const i=Jt(n);let l=Kt.min(),u=vs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,_){const x=Jt(g),T=x.Fs.get(_);return T!==void 0?Oe.resolve(x.vs.get(T)):x.li.getTargetData(y,_)})(i,d,Ua(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Kt.min(),t?u:vs()))).next((p=>(mM(i,ZR(e),p),{documents:p,ks:u})))))}function mM(n,e,t){let i=n.Ms.get(e)||Kt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Yx{constructor(){this.activeTargetIds=aA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fM{constructor(){this.vo=new Yx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pM{Mo(e){}shutdown(){}}const Qx="ConnectivityMonitor";class Xx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){dt(Qx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){dt(Qx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ih=null;function Sg(){return ih===null?ih=(function(){return 268435456+Math.round(2147483648*Math.random())})():ih++,"0x"+ih.toString(16)}const Pp="RestConnection",gM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class yM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Vh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Sg(),p=this.Qo(e,t.toUriEncodedString());dt(Pp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),_=fo(y);return this.zo(e,p,g,i,_).then((x=>(dt(Pp,`Received RPC '${e}' ${d}: `,x),x)),(x=>{throw Ql(Pp,`RPC '${e}' ${d} failed with error: `,x,"url: ",p,"request:",i),x}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ic})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=gM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class bM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const mr="WebChannelConnection",Qc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Kl extends yM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Kl.c_){const e=Qw();Qc(e,Yw.STAT_EVENT,(t=>{t.stat===pg.PROXY?dt(mr,"STAT_EVENT: detected buffering proxy"):t.stat===pg.NOPROXY&&dt(mr,"STAT_EVENT: detected no buffering proxy")})),Kl.c_=!0}}zo(e,t,i,l,u){const d=Sg();return new Promise(((p,g)=>{const y=new Gw;y.setWithCredentials(!0),y.listenOnce(Kw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case wh.NO_ERROR:const x=y.getResponseJson();dt(mr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(x)),p(x);break;case wh.TIMEOUT:dt(mr,`RPC '${e}' ${d} timed out`),g(new nt(Re.DEADLINE_EXCEEDED,"Request time out"));break;case wh.HTTP_ERROR:const T=y.getStatus();if(dt(mr,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let V=y.getResponseJson();Array.isArray(V)&&(V=V[0]);const W=V?.error;if(W&&W.status&&W.message){const z=(function(Z){const K=Z.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(K)>=0?K:Re.UNKNOWN})(W.status);g(new nt(z,W.message))}else g(new nt(Re.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(Re.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{dt(mr,`RPC '${e}' ${d} completed.`)}}));const _=JSON.stringify(l);dt(mr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",_,i,15)}))}T_(e,t,i){const l=Sg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");dt(mr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const _=d.createWebChannel(y,p);this.I_(_);let x=!1,T=!1;const V=new bM({Ho:W=>{T?dt(mr,`Not sending because RPC '${e}' stream ${l} is closed:`,W):(x||(dt(mr,`Opening RPC '${e}' stream ${l} transport.`),_.open(),x=!0),dt(mr,`RPC '${e}' stream ${l} sending:`,W),_.send(W))},Jo:()=>_.close()});return Qc(_,nu.EventType.OPEN,(()=>{T||(dt(mr,`RPC '${e}' stream ${l} transport opened.`),V.i_())})),Qc(_,nu.EventType.CLOSE,(()=>{T||(T=!0,dt(mr,`RPC '${e}' stream ${l} transport closed`),V.o_(),this.E_(_))})),Qc(_,nu.EventType.ERROR,(W=>{T||(T=!0,Ql(mr,`RPC '${e}' stream ${l} transport errored. Name:`,W.name,"Message:",W.message),V.o_(new nt(Re.UNAVAILABLE,"The operation could not be completed")))})),Qc(_,nu.EventType.MESSAGE,(W=>{if(!T){const z=W.data[0];Us(!!z,16349);const U=z,Z=U?.error||U[0]?.error;if(Z){dt(mr,`RPC '${e}' stream ${l} received error:`,Z);const K=Z.status;let se=(function(we){const C=Vn[we];if(C!==void 0)return I_(C)})(K),he=Z.message;se===void 0&&(se=Re.INTERNAL,he="Unknown error status: "+K+" with message "+Z.message),T=!0,V.o_(new nt(se,he)),_.close()}else dt(mr,`RPC '${e}' stream ${l} received:`,z),V.__(z)}})),Kl.u_(),setTimeout((()=>{V.s_()}),0),V}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Xw()}}function vM(n){return new Kl(n)}function Lp(){return typeof document<"u"?document:null}function fm(n){return new kA(n,!0)}Kl.c_=!1;class K_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&dt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Jx="PersistentStream";class Y_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new K_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Re.RESOURCE_EXHAUSTED?(yi(t.toString()),yi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(Re.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return dt(Jx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(dt(Jx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xM extends Y_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=EA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Kt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Kt.min():d.readTime?Fa(d.readTime):Kt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Tg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=xg(g)?{documents:CA(u,g)}:{query:RA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=L_(u,d.resumeToken);const y=_g(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(Kt.min())>0){p.readTime=zh(u,d.snapshotVersion.toTimestamp());const y=_g(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=MA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Tg(this.serializer),t.removeTarget=e,this.K_(t)}}class wM extends Y_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Us(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Us(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Us(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=NA(e.writeResults,e.commitTime),i=Fa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Tg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>SA(this.serializer,i)))};this.K_(t)}}class _M{}class kM extends _M{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,kg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(Re.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,kg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new nt(Re.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function jM(n,e,t,i){return new kM(n,e,t,i)}class TM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(yi(t),this.aa=!1):dt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Qo="RemoteStore";class EM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{tl(this)&&(dt(Qo,"Restarting streams for network reachability change."),await(async function(g){const y=Jt(g);y.Ea.add(4),await Bu(y),y.Va.set("Unknown"),y.Ea.delete(4),await pm(y)})(this))}))})),this.Va=new TM(i,l)}}async function pm(n){if(tl(n))for(const e of n.Ra)await e(!0)}async function Bu(n){for(const e of n.Ra)await e(!1)}function Q_(n,e){const t=Jt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ky(t)?_y(t):uc(t).O_()&&wy(t,e))}function xy(n,e){const t=Jt(n),i=uc(t);t.Ia.delete(e),i.O_()&&X_(t,e),t.Ia.size===0&&(i.O_()?i.L_():tl(t)&&t.Va.set("Unknown"))}function wy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Kt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}uc(n).Z_(e)}function X_(n,e){n.da.$e(e),uc(n).X_(e)}function _y(n){n.da=new vA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),uc(n).start(),n.Va.ua()}function ky(n){return tl(n)&&!uc(n).x_()&&n.Ia.size>0}function tl(n){return Jt(n).Ea.size===0}function J_(n){n.da=void 0}async function SM(n){n.Va.set("Online")}async function NM(n){n.Ia.forEach(((e,t)=>{wy(n,e)}))}async function CM(n,e){J_(n),ky(n)?(n.Va.ha(e),_y(n)):n.Va.set("Unknown")}async function RM(n,e,t){if(n.Va.set("Online"),e instanceof P_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){dt(Qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Hh(n,i)}else if(e instanceof Th?n.da.Xe(e):e instanceof D_?n.da.st(e):n.da.tt(e),!t.isEqual(Kt.min()))try{const i=await G_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const _=u.Ia.get(y);_&&u.Ia.set(y,_.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const _=u.Ia.get(g);if(!_)return;u.Ia.set(g,_.withResumeToken(ir.EMPTY_BYTE_STRING,_.snapshotVersion)),X_(u,g);const x=new Zi(_.target,g,y,_.sequenceNumber);wy(u,x)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){dt(Qo,"Failed to raise snapshot:",i),await Hh(n,i)}}async function Hh(n,e,t){if(!lc(e))throw e;n.Ea.add(1),await Bu(n),n.Va.set("Offline"),t||(t=()=>G_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{dt(Qo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await pm(n)}))}function Z_(n,e){return e().catch((t=>Hh(n,t,e)))}async function gm(n){const e=Jt(n),t=ho(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:oy;for(;AM(e);)try{const l=await dM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MM(e,l)}catch(l){await Hh(e,l)}ek(e)&&tk(e)}function AM(n){return tl(n)&&n.Ta.length<10}function MM(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ek(n){return tl(n)&&!ho(n).x_()&&n.Ta.length>0}function tk(n){ho(n).start()}async function IM(n){ho(n).ra()}async function DM(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function PM(n,e,t){const i=n.Ta.shift(),l=my.from(i,e,t);await Z_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await gm(n)}async function LM(n,e){e&&ho(n).Y_&&await(async function(i,l){if((function(d){return gA(d)&&d!==Re.ABORTED})(l.code)){const u=i.Ta.shift();ho(i).B_(),await Z_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await gm(i)}})(n,e),ek(n)&&tk(n)}async function Zx(n,e){const t=Jt(n);t.asyncQueue.verifyOperationInProgress(),dt(Qo,"RemoteStore received new credentials");const i=tl(t);t.Ea.add(3),await Bu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await pm(t)}async function OM(n,e){const t=Jt(n);e?(t.Ea.delete(2),await pm(t)):e||(t.Ea.add(2),await Bu(t),t.Va.set("Unknown"))}function uc(n){return n.ma||(n.ma=(function(t,i,l){const u=Jt(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:SM.bind(null,n),Yo:NM.bind(null,n),t_:CM.bind(null,n),J_:RM.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),ky(n)?_y(n):n.Va.set("Unknown")):(await n.ma.stop(),J_(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,i,l){const u=Jt(t);return u.sa(),new wM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:IM.bind(null,n),t_:LM.bind(null,n),ta:DM.bind(null,n),na:PM.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await gm(n)):(await n.fa.stop(),n.Ta.length>0&&(dt(Qo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class jy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new jy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ty(n,e){if(yi("AsyncQueue",`${e}: ${n}`),lc(n))return new nt(Re.UNAVAILABLE,`${e}: ${n}`);throw n}class Yl{static emptySet(e){return new Yl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||St.comparator(t.key,i.key):(t,i)=>St.comparator(t.key,i.key),this.keyedMap=ru(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Yl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class e2{constructor(){this.ga=new mn(St.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ot(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class tc{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new tc(e,t,Yl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class VM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class BM{constructor(){this.queries=t2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Jt(t),u=l.queries;l.queries=t2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(Re.ABORTED,"Firestore shutting down"))}}function t2(){return new el((n=>v_(n)),lm)}async function Ey(n,e){const t=Jt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new VM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ty(d,`Initialization of query '${Fl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ny(t)}async function Sy(n,e){const t=Jt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function UM(n,e){const t=Jt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ny(t)}function FM(n,e,t){const i=Jt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ny(n){n.Ca.forEach((e=>{e.next()}))}var Ng,s2;(s2=Ng||(Ng={})).Ma="default",s2.Cache="cache";class Cy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new tc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=tc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ng.Cache}}class sk{constructor(e){this.key=e}}class nk{constructor(e){this.key=e}}class zM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=vs(),this.mutatedKeys=vs(),this.eu=x_(e),this.tu=new Yl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new e2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((_,x)=>{const T=l.get(_),V=cm(this.query,x)?x:null,W=!!T&&this.mutatedKeys.has(T.key),z=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let U=!1;T&&V?T.data.isEqual(V.data)?W!==z&&(i.track({type:3,doc:V}),U=!0):this.su(T,V)||(i.track({type:2,doc:V}),U=!0,(g&&this.eu(V,g)>0||y&&this.eu(V,y)<0)&&(p=!0)):!T&&V?(i.track({type:0,doc:V}),U=!0):T&&!V&&(i.track({type:1,doc:T}),U=!0,(g||y)&&(p=!0)),U&&(V?(d=d.add(V),u=z?u.add(_):u.delete(_)):(d=d.delete(_),u=u.delete(_)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),u=u.delete(_.key),i.track({type:1,doc:_})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((_,x)=>(function(V,W){const z=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Vt:U})}};return z(V)-z(W)})(_.type,x.type)||this.eu(_.doc,x.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new tc(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new e2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=vs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new nk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new sk(i))})),t}cu(e){this.Za=e.ks,this.Ya=vs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return tc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ry="SyncEngine";class qM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class HM{constructor(e){this.key=e,this.hu=!1}}class $M{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new el((p=>v_(p)),lm),this.Iu=new Map,this.Eu=new Set,this.Ru=new mn(St.comparator),this.Au=new Map,this.Vu=new gy,this.du={},this.mu=new Map,this.fu=ec.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WM(n,e,t=!0){const i=ck(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await rk(i,e,t,!0),l}async function GM(n,e){const t=ck(n);await rk(t,e,!0,!1)}async function rk(n,e,t,i){const l=await hM(n.localStore,Ua(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await KM(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&Q_(n.remoteStore,l),p}async function KM(n,e,t,i,l){n.pu=(x,T,V)=>(async function(z,U,Z,K){let se=U.view.ru(Z);se.Ss&&(se=await Kx(z.localStore,U.query,!1).then((({documents:C})=>U.view.ru(C,se))));const he=K&&K.targetChanges.get(U.targetId),Me=K&&K.targetMismatches.get(U.targetId)!=null,we=U.view.applyChanges(se,z.isPrimaryClient,he,Me);return r2(z,U.targetId,we.au),we.snapshot})(n,x,T,V);const u=await Kx(n.localStore,e,!0),d=new zM(e,u.ks),p=d.ru(u.documents),g=Vu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);r2(n,t,y.au);const _=new qM(e,t,d);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function YM(n,e,t){const i=Jt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!lm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Eg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&xy(i.remoteStore,l.targetId),Cg(i,l.targetId)})).catch(oc)):(Cg(i,l.targetId),await Eg(i.localStore,l.targetId,!0))}async function QM(n,e){const t=Jt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),xy(t.remoteStore,i.targetId))}async function XM(n,e,t){const i=r3(n);try{const l=await(function(d,p){const g=Jt(d),y=wt.now(),_=p.reduce(((V,W)=>V.add(W.key)),vs());let x,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(V=>{let W=bi(),z=vs();return g.xs.getEntries(V,_).next((U=>{W=U,W.forEach(((Z,K)=>{K.isValidDocument()||(z=z.add(Z))}))})).next((()=>g.localDocuments.getOverlayedDocuments(V,W))).next((U=>{x=U;const Z=[];for(const K of p){const se=dA(K,x.get(K.key).overlayedDocument);se!=null&&Z.push(new yo(K.key,se,d_(se.value.mapValue),Cr.exists(!0)))}return g.mutationQueue.addMutationBatch(V,y,Z,p)})).next((U=>{T=U;const Z=U.applyToLocalDocumentSet(x,z);return g.documentOverlayCache.saveOverlays(V,U.batchId,Z)}))})).then((()=>({batchId:T.batchId,changes:__(x)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new mn(bs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Uu(i,l.changes),await gm(i.remoteStore)}catch(l){const u=Ty(l,"Failed to persist write");t.reject(u)}}async function ak(n,e){const t=Jt(n);try{const i=await cM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Us(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Us(d.hu,14607):l.removedDocuments.size>0&&(Us(d.hu,42227),d.hu=!1))})),await Uu(t,i,e)}catch(i){await oc(i)}}function n2(n,e,t){const i=Jt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Jt(d);g.onlineState=p;let y=!1;g.queries.forEach(((_,x)=>{for(const T of x.ba)T.va(p)&&(y=!0)})),y&&Ny(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function JM(n,e,t){const i=Jt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new mn(St.comparator);d=d.insert(u,pr.newNoDocument(u,Kt.min()));const p=vs().add(u),g=new mm(Kt.min(),new Map,new mn(bs),d,p);await ak(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ay(i)}else await Eg(i.localStore,e,!1).then((()=>Cg(i,e,t))).catch(oc)}async function ZM(n,e){const t=Jt(n),i=e.batch.batchId;try{const l=await lM(t.localStore,e);ok(t,i,null),ik(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Uu(t,l)}catch(l){await oc(l)}}async function e3(n,e,t){const i=Jt(n);try{const l=await(function(d,p){const g=Jt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let _;return g.mutationQueue.lookupMutationBatch(y,p).next((x=>(Us(x!==null,37113),_=x.keys(),g.mutationQueue.removeMutationBatch(y,x)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,_,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_))).next((()=>g.localDocuments.getDocuments(y,_)))}))})(i.localStore,e);ok(i,e,t),ik(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Uu(i,l)}catch(l){await oc(l)}}function ik(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ok(n,e,t){const i=Jt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Cg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||lk(n,i)}))}function lk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(xy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ay(n))}function r2(n,e,t){for(const i of t)i instanceof sk?(n.Vu.addReference(i.key,e),t3(n,i)):i instanceof nk?(dt(Ry,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||lk(n,i.key)):Ot(19791,{wu:i})}function t3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(dt(Ry,"New document in limbo: "+t),n.Eu.add(i),Ay(n))}function Ay(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new St(nn.fromString(e)),i=n.fu.next();n.Au.set(i,new HM(t)),n.Ru=n.Ru.insert(t,i),Q_(n.remoteStore,new Zi(Ua(om(t.path)),i,"TargetPurposeLimboResolution",rm.ce))}}async function Uu(n,e,t){const i=Jt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const _=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,_?"current":"not-current")}if(y){l.push(y);const _=by.Es(g.targetId,y);u.push(_)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const _=Jt(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Oe.forEach(y,(T=>Oe.forEach(T.Ts,(V=>_.persistence.referenceDelegate.addReference(x,T.targetId,V))).next((()=>Oe.forEach(T.Is,(V=>_.persistence.referenceDelegate.removeReference(x,T.targetId,V)))))))))}catch(x){if(!lc(x))throw x;dt(vy,"Failed to update sequence numbers: "+x)}for(const x of y){const T=x.targetId;if(!x.fromCache){const V=_.vs.get(T),W=V.snapshotVersion,z=V.withLastLimboFreeSnapshotVersion(W);_.vs=_.vs.insert(T,z)}}})(i.localStore,u))}async function s3(n,e){const t=Jt(n);if(!t.currentUser.isEqual(e)){dt(Ry,"User change. New user:",e.toKey());const i=await W_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(Re.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Uu(t,i.Ns)}}function n3(n,e){const t=Jt(n),i=t.Au.get(e);if(i&&i.hu)return vs().add(i.key);{let l=vs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function ck(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ak.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=n3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JM.bind(null,e),e.Pu.J_=UM.bind(null,e.eventManager),e.Pu.yu=FM.bind(null,e.eventManager),e}function r3(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e3.bind(null,e),e}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return oM(this.persistence,new rM,e.initialUser,this.serializer)}Cu(e){return new $_(yy.Vi,this.serializer)}Du(e){return new fM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class a3 extends $h{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Us(this.persistence.referenceDelegate instanceof qh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new qA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Or.withCacheSize(this.cacheSizeBytes):Or.DEFAULT;return new $_((i=>qh.Vi(i,t)),this.serializer)}}class Rg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>n2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=s3.bind(null,this.syncEngine),await OM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BM})()}createDatastore(e){const t=fm(e.databaseInfo.databaseId),i=vM(e.databaseInfo);return jM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new EM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>n2(this.syncEngine,t,0)),(function(){return Xx.v()?new Xx:new pM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,_){const x=new $M(l,u,d,p,g,y);return _&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Jt(t);dt(Qo,"RemoteStore shutting down."),i.Ea.add(5),await Bu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Rg.provider={build:()=>new Rg};class My{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):yi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mo="FirestoreClient";class i3{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=fr.UNAUTHENTICATED,this.clientId=iy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{dt(mo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(dt(mo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ty(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Op(n,e){n.asyncQueue.verifyOperationInProgress(),dt(mo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await W_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function a2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await o3(n);dt(mo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Zx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Zx(e.remoteStore,l))),n._onlineComponents=e}async function o3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){dt(mo,"Using user provided OfflineComponentProvider");try{await Op(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Re.FAILED_PRECONDITION||l.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Ql("Error using user provided cache. Falling back to memory cache: "+t),await Op(n,new $h)}}else dt(mo,"Using default OfflineComponentProvider"),await Op(n,new a3(void 0));return n._offlineComponents}async function uk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(dt(mo,"Using user provided OnlineComponentProvider"),await a2(n,n._uninitializedComponentsProvider._online)):(dt(mo,"Using default OnlineComponentProvider"),await a2(n,new Rg))),n._onlineComponents}function l3(n){return uk(n).then((e=>e.syncEngine))}async function Wh(n){const e=await uk(n),t=e.eventManager;return t.onListen=WM.bind(null,e.syncEngine),t.onUnlisten=YM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=GM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=QM.bind(null,e.syncEngine),t}function c3(n,e,t,i){const l=new My(i),u=new Cy(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ey(await Wh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Sy(await Wh(n),u)))}}function u3(n,e,t={}){const i=new mi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const _=new My({next:T=>{_.Nu(),d.enqueueAndForget((()=>Sy(u,x)));const V=T.docs.has(p);!V&&T.fromCache?y.reject(new nt(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):V&&T.fromCache&&g&&g.source==="server"?y.reject(new nt(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),x=new Cy(om(p.path),_,{includeMetadataChanges:!0,Ka:!0});return Ey(u,x)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function d3(n,e,t={}){const i=new mi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const _=new My({next:T=>{_.Nu(),d.enqueueAndForget((()=>Sy(u,x))),T.fromCache&&g.source==="server"?y.reject(new nt(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),x=new Cy(p,_,{includeMetadataChanges:!0,Ka:!0});return Ey(u,x)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function h3(n,e){const t=new mi;return n.asyncQueue.enqueueAndForget((async()=>XM(await l3(n),e,t))),t.promise}function dk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const m3="ComponentProvider",i2=new Map;function f3(n,e,t,i,l){return new DR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,dk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const hk="firestore.googleapis.com",o2=!0;class l2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hk,this.ssl=o2}else this.host=e.host,this.ssl=e.ssl??o2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=H_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FA)throw new nt(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_R("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ym{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new hR;switch(i.type){case"firstParty":return new gR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=i2.get(t);i&&(dt(m3,"Removing Datastore"),i2.delete(t),i.terminate())})(this),Promise.resolve()}}function p3(n,e,t,i={}){n=Nr(n,ym);const l=fo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Hg(`https://${p}`),$g("Firestore",!0)),u.host!==hk&&u.host!==p&&Ql("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!$o(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,_;if(typeof i.mockUserToken=="string")y=i.mockUserToken,_=fr.MOCK_USER;else{y=iw(i.mockUserToken,n._app?.options.projectId);const x=i.mockUserToken.sub||i.mockUserToken.user_id;if(!x)throw new nt(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new fr(x)}n._authCredentials=new mR(new Zw(y,_))}}class wi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wi(this.firestore,e,this._query)}}class xn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xn(this.firestore,e,this._key)}toJSON(){return{type:xn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Lu(t,xn._jsonSchema))return new xn(e,i||null,new St(nn.fromString(t.referencePath)))}}xn._jsonSchemaVersion="firestore/documentReference/1.0",xn._jsonSchema={type:Un("string",xn._jsonSchemaVersion),referencePath:Un("string")};class ao extends wi{constructor(e,t,i){super(e,t,om(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xn(this.firestore,null,new St(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function Bt(n,e,...t){if(n=Qs(n),e_("collection","path",e),n instanceof ym){const i=nn.fromString(e,...t);return wx(i),new ao(n,null,i)}{if(!(n instanceof xn||n instanceof ao))throw new nt(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return wx(i),new ao(n.firestore,null,i)}}function qe(n,e,...t){if(n=Qs(n),arguments.length===1&&(e=iy.newId()),e_("doc","path",e),n instanceof ym){const i=nn.fromString(e,...t);return xx(i),new xn(n,null,new St(i))}{if(!(n instanceof xn||n instanceof ao))throw new nt(Re.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return xx(i),new xn(n.firestore,n instanceof ao?n.converter:null,new St(i))}}const c2="AsyncQueue";class u2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new K_(this,"async_queue_retry"),this._c=()=>{const i=Lp();i&&dt(c2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Lp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Lp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new mi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!lc(e))throw e;dt(c2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,yi("INTERNAL UNHANDLED ERROR: ",d2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=jy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Ot(47125,{Pc:d2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function d2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ha extends ym{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new u2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new u2(e),this._firestoreClient=void 0,await e}}}function g3(n,e){const t=typeof n=="object"?n:Yg(),i=typeof n=="string"?n:Vh,l=Zh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=nw("firestore");u&&p3(l,...u)}return l}function Fu(n){if(n._terminated)throw new nt(Re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||y3(n),n._firestoreClient}function y3(n){const e=n._freezeSettings(),t=f3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new i3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(ir.fromBase64String(e))}catch(t){throw new nt(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ia(ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ia._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Lu(e,ia._jsonSchema))return ia.fromBase64String(e.bytes)}}ia._jsonSchemaVersion="firestore/bytes/1.0",ia._jsonSchema={type:Un("string",ia._jsonSchemaVersion),bytes:Un("string")};class bm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ar(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zu{constructor(e){this._methodName=e}}class za{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return bs(this._lat,e._lat)||bs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:za._jsonSchemaVersion}}static fromJSON(e){if(Lu(e,za._jsonSchema))return new za(e.latitude,e.longitude)}}za._jsonSchemaVersion="firestore/geoPoint/1.0",za._jsonSchema={type:Un("string",za._jsonSchemaVersion),latitude:Un("number"),longitude:Un("number")};class xa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Lu(e,xa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xa(e.vectorValues);throw new nt(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xa._jsonSchemaVersion="firestore/vectorValue/1.0",xa._jsonSchema={type:Un("string",xa._jsonSchemaVersion),vectorValues:Un("object")};const b3=/^__.*__$/;class v3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ou(e,this.data,t,this.fieldTransforms)}}class mk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new yo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot(40011,{dataSource:n})}}class Iy{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Iy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Gh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(fk(this.dataSource)&&b3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class x3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||fm(e)}createContext(e,t,i,l=!1){return new Iy({dataSource:e,methodName:t,targetDoc:i,path:ar.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(n){const e=n._freezeSettings(),t=fm(n._databaseId);return new x3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Oy("Data must be an object, but it was:",d,i);const p=yk(i,d);let g,y;if(u.merge)g=new Kr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const _=[];for(const x of u.mergeFields){const T=Xo(e,x,t);if(!d.contains(T))throw new nt(Re.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);xk(_,T)||_.push(T)}g=new Kr(_),y=d.fieldTransforms.filter((x=>g.covers(x.field)))}else g=null,y=d.fieldTransforms;return new v3(new Vr(p),g,y)}class vm extends zu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vm}}class Py extends zu{_toFieldTransform(e){return new R_(e.path,new ju)}isEqual(e){return e instanceof Py}}class Ly extends zu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Su(e.serializer,T_(e.serializer,this.Vc));return new R_(e.path,t)}isEqual(e){return e instanceof Ly&&this.Vc===e.Vc}}function pk(n,e,t,i){const l=n.createContext(1,e,t);Oy("Data must be an object, but it was:",l,i);const u=[],d=Vr.empty();go(i,((g,y)=>{const _=vk(e,g,t);y=Qs(y);const x=l.childContextForFieldPath(_);if(y instanceof vm)u.push(_);else{const T=Hu(y,x);T!=null&&(u.push(_),d.set(_,T))}}));const p=new Kr(u);return new mk(d,p,l.fieldTransforms)}function gk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Xo(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Xo(e,u[T])),g.push(u[T+1]);const y=[],_=Vr.empty();for(let T=p.length-1;T>=0;--T)if(!xk(y,p[T])){const V=p[T];let W=g[T];W=Qs(W);const z=d.childContextForFieldPath(V);if(W instanceof vm)y.push(V);else{const U=Hu(W,z);U!=null&&(y.push(V),_.set(V,U))}}const x=new Kr(y);return new mk(_,x,d.fieldTransforms)}function w3(n,e,t,i=!1){return Hu(t,n.createContext(i?4:3,e))}function Hu(n,e){if(bk(n=Qs(n)))return Oy("Unsupported field value:",e,n),yk(n,e);if(n instanceof zu)return(function(i,l){if(!fk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Hu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Qs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return T_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=wt.fromDate(i);return{timestampValue:zh(l.serializer,u)}}if(i instanceof wt){const u=new wt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zh(l.serializer,u)}}if(i instanceof za)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ia)return{bytesValue:L_(l.serializer,i._byteString)};if(i instanceof xn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:py(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof xa)return(function(d,p){const g=d instanceof xa?d.toArray():d;return{mapValue:{fields:{[c_]:{stringValue:u_},[Bh]:{arrayValue:{values:g.map((_=>{if(typeof _!="number")throw p.createError("VectorValues must only contain numeric values.");return hy(p.serializer,_)}))}}}}}})(i,l);if(q_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${nm(i)}`)})(n,e)}function yk(n,e){const t={};return n_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):go(n,((i,l)=>{const u=Hu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function bk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof wt||n instanceof za||n instanceof ia||n instanceof xn||n instanceof zu||n instanceof xa||q_(n))}function Oy(n,e,t){if(!bk(t)||!t_(t)){const i=nm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Xo(n,e,t){if((e=Qs(e))instanceof bm)return e._internalPath;if(typeof e=="string")return vk(n,e);throw Gh("Field path arguments must be of type string or ",n,!1,void 0,t)}const _3=new RegExp("[~\\*/\\[\\]]");function vk(n,e,t){if(e.search(_3)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bm(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new nt(Re.INVALID_ARGUMENT,p+n+g)}function xk(n,e){return n.some((t=>t.isEqual(e)))}class k3{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return An(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ot(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return go(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Bh].arrayValue?.values?.map((i=>An(i.doubleValue)));return new xa(t)}convertGeoPoint(e){return new za(An(e.latitude),An(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=im(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(xu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=nn.fromString(e);Us(z_(i),9688,{name:e});const l=new wu(i.get(1),i.get(3)),u=new St(i.popFirst(5));return l.isEqual(t)||yi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Vy extends k3{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new xn(this.firestore,null,t)}}function Tr(){return new Py("serverTimestamp")}function Uo(n){return new Ly("increment",n)}const h2="@firebase/firestore",m2="4.10.0";function f2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class wk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Xo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class j3 extends wk{data(){return super.data()}}function _k(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class By{}class Uy extends By{}function Ds(n,e,...t){let i=[];e instanceof By&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Fy)).length,p=u.filter((g=>g instanceof xm)).length;if(d>1||d>0&&p>0)throw new nt(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class xm extends Uy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new xm(e,t,i)}_apply(e){const t=this._parse(e);return kk(e._query,t),new wi(e.firestore,e.converter,wg(e._query,t))}_parse(e){const t=qu(e.firestore);return(function(u,d,p,g,y,_,x){let T;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new nt(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){g2(x,_);const W=[];for(const z of x)W.push(p2(g,u,z));T={arrayValue:{values:W}}}else T=p2(g,u,x)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||g2(x,_),T=w3(p,d,x,_==="in"||_==="not-in");return Bn.create(y,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ms(n,e,t){const i=e,l=Xo("where",n);return xm._create(l,i,t)}class Fy extends By{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ka.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)kk(d,g),d=wg(d,g)})(e._query,t),new wi(e.firestore,e.converter,wg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zy extends Uy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new nt(Re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(Re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ku(u,d)})(e._query,this._field,this._direction);return new wi(e.firestore,e.converter,JR(e._query,t))}}function Kh(n,e="asc"){const t=e,i=Xo("orderBy",n);return zy._create(i,t)}class qy extends Uy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new qy(e,t,i)}_apply(e){return new wi(e.firestore,e.converter,Fh(e._query,this._limit,this._limitType))}}function Yh(n){return kR("limit",n),qy._create("limit",n,"F")}function p2(n,e,t){if(typeof(t=Qs(t))=="string"){if(t==="")throw new nt(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!b_(e)&&t.indexOf("/")!==-1)throw new nt(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(nn.fromString(t));if(!St.isDocumentKey(i))throw new nt(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Cx(n,new St(i))}if(t instanceof xn)return Cx(n,t._key);throw new nt(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nm(t)}.`)}function g2(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Hy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class iu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fo extends wk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Xo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Fo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Fo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fo._jsonSchema={type:Un("string",Fo._jsonSchemaVersion),bundleSource:Un("string","DocumentSnapshot"),bundleName:Un("string"),bundle:Un("string")};class Eh extends Fo{data(e={}){return super.data(e)}}class zo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new iu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Eh(this._firestore,this._userDataWriter,i.key,i,new iu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,_=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),_=d.indexOf(p.doc.key)),{type:T3(p.type),doc:g,oldIndex:y,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function T3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:n})}}zo._jsonSchemaVersion="firestore/querySnapshot/1.0",zo._jsonSchema={type:Un("string",zo._jsonSchemaVersion),bundleSource:Un("string","QuerySnapshot"),bundleName:Un("string"),bundle:Un("string")};class E3{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,t,i){this._verifyNotCommitted();const l=Vp(e,this._firestore),u=Hy(l.converter,t,i),d=Dy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Cr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Vp(e,this._firestore);let d;return d=typeof(t=Qs(t))=="string"||t instanceof bm?gk(this._dataReader,"WriteBatch.update",u._key,t,i,l):pk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Cr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vp(e,this._firestore);return this._mutations=this._mutations.concat(new hm(t._key,Cr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(Re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Vp(n,e){if((n=Qs(n)).firestore!==e)throw new nt(Re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Rs(n){n=Nr(n,xn);const e=Nr(n.firestore,Ha),t=Fu(e);return u3(t,n._key).then((i=>Tk(e,n,i)))}function Es(n){n=Nr(n,wi);const e=Nr(n.firestore,Ha),t=Fu(e),i=new Vy(e);return _k(n._query),d3(t,n._query).then((l=>new zo(e,i,n,l)))}function Ss(n,e,t){n=Nr(n,xn);const i=Nr(n.firestore,Ha),l=Hy(n.converter,e,t),u=qu(i);return $u(i,[Dy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Cr.none())])}function Pa(n,e,t,...i){n=Nr(n,xn);const l=Nr(n.firestore,Ha),u=qu(l);let d;return d=typeof(e=Qs(e))=="string"||e instanceof bm?gk(u,"updateDoc",n._key,e,t,i):pk(u,"updateDoc",n._key,e),$u(l,[d.toMutation(n._key,Cr.exists(!0))])}function Er(n){return $u(Nr(n.firestore,Ha),[new hm(n._key,Cr.none())])}function wa(n,e){const t=Nr(n.firestore,Ha),i=qe(n),l=Hy(n.converter,e),u=qu(n.firestore);return $u(t,[Dy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Cr.exists(!1))]).then((()=>i))}function jk(n,...e){n=Qs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||f2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(f2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof xn)d=Nr(n.firestore,Ha),p=om(n._key.path),u={next:y=>{e[i]&&e[i](Tk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=Nr(n,wi);d=Nr(y.firestore,Ha),p=y._query;const _=new Vy(d);u={next:x=>{e[i]&&e[i](new zo(d,_,y,x))},error:e[i+1],complete:e[i+2]},_k(n._query)}const g=Fu(d);return c3(g,p,l,u)}function $u(n,e){const t=Fu(n);return h3(t,e)}function Tk(n,e,t){const i=t.docs.get(e._key),l=new Vy(n);return new Fo(n,l,e._key,i,new iu(t.hasPendingWrites,t.fromCache),e.converter)}function y2(n){return n=Nr(n,Ha),Fu(n),new E3(n,(e=>$u(n,e)))}(function(e,t=!0){dR(Zo),Wo(new io("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ha(new fR(i.getProvider("auth-internal")),new yR(d,i.getProvider("app-check-internal")),PR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Oa(h2,m2,e),Oa(h2,m2,"esm2020")})();var S3="firebase",N3="12.8.0";Oa(S3,N3,"app");const Ek="firebasestorage.googleapis.com",Sk="storageBucket",C3=120*1e3,R3=600*1e3;class _n extends $a{constructor(e,t,i=0){super(Bp(e),`Firebase Storage: ${t} (${Bp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Bp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var wn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(wn||(wn={}));function Bp(n){return"storage/"+n}function $y(){const n="An unknown error occurred, please check the error payload for server response.";return new _n(wn.UNKNOWN,n)}function A3(n){return new _n(wn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function M3(n){return new _n(wn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function I3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new _n(wn.UNAUTHENTICATED,n)}function D3(){return new _n(wn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function P3(n){return new _n(wn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function L3(){return new _n(wn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function O3(){return new _n(wn.CANCELED,"User canceled the upload/download.")}function V3(n){return new _n(wn.INVALID_URL,"Invalid URL '"+n+"'.")}function B3(n){return new _n(wn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function U3(){return new _n(wn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Sk+"' property when initializing the app?")}function F3(){return new _n(wn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function z3(){return new _n(wn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function q3(n){return new _n(wn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ag(n){return new _n(wn.INVALID_ARGUMENT,n)}function Nk(){return new _n(wn.APP_DELETED,"The Firebase app was deleted.")}function H3(n){return new _n(wn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mu(n,e){return new _n(wn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Xc(n){throw new _n(wn.INTERNAL_ERROR,"Internal error: "+n)}class Sr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Sr.makeFromUrl(e,t)}catch{return new Sr(e,"")}if(i.path==="")return i;throw B3(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(he){he.path.charAt(he.path.length-1)==="/"&&(he.path_=he.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(he){he.path_=decodeURIComponent(he.path)}const _="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",V=new RegExp(`^https?://${x}/${_}/b/${l}/o${T}`,"i"),W={bucket:1,path:3},z=t===Ek?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",Z=new RegExp(`^https?://${z}/${l}/${U}`,"i"),se=[{regex:p,indices:g,postModify:u},{regex:V,indices:W,postModify:y},{regex:Z,indices:{bucket:1,path:2},postModify:y}];for(let he=0;he<se.length;he++){const Me=se[he],we=Me.regex.exec(e);if(we){const C=we[Me.indices.bucket];let E=we[Me.indices.path];E||(E=""),i=new Sr(C,E),Me.postModify(i);break}}if(i==null)throw V3(e);return i}}class $3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function W3(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function _(...U){y||(y=!0,e.apply(null,U))}function x(U){l=setTimeout(()=>{l=null,n(V,g())},U)}function T(){u&&clearTimeout(u)}function V(U,...Z){if(y){T();return}if(U){T(),_.call(null,U,...Z);return}if(g()||d){T(),_.call(null,U,...Z);return}i<64&&(i*=2);let se;p===1?(p=2,se=0):se=(i+Math.random())*1e3,x(se)}let W=!1;function z(U){W||(W=!0,T(),!y&&(l!==null?(U||(p=2),clearTimeout(l),x(0)):U||(p=1)))}return x(0),u=setTimeout(()=>{d=!0,z(!0)},t),z}function G3(n){n(!1)}function K3(n){return n!==void 0}function Y3(n){return typeof n=="object"&&!Array.isArray(n)}function Wy(n){return typeof n=="string"||n instanceof String}function b2(n){return Gy()&&n instanceof Blob}function Gy(){return typeof Blob<"u"}function Mg(n,e,t,i){if(i<e)throw Ag(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Ag(`Invalid value for '${n}'. Expected ${t} or less.`)}function wm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Ck(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var qo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(qo||(qo={}));function Q3(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class X3{constructor(e,t,i,l,u,d,p,g,y,_,x,T=!0,V=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=_,this.connectionFactory_=x,this.retry=T,this.isUsingEmulator=V,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((W,z)=>{this.resolve_=W,this.reject_=z,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new oh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===qo.NO_ERROR,g=u.getStatus();if(!p||Q3(g,this.additionalRetryCodes_)&&this.retry){const _=u.getErrorCode()===qo.ABORT;i(!1,new oh(!1,null,_));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new oh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());K3(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=$y();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Nk():O3();d(g)}else{const g=L3();d(g)}};this.canceled_?t(!1,new oh(!1,null,!0)):this.backoffId_=W3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&G3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function J3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Z3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function eI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function tI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function sI(n,e,t,i,l,u,d=!0,p=!1){const g=Ck(n.urlParams),y=n.url+g,_=Object.assign({},n.headers);return eI(_,e),J3(_,t),Z3(_,u),tI(_,i),new X3(y,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function nI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rI(...n){const e=nI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Gy())return new Blob(n);throw new _n(wn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function aI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function iI(n){if(typeof atob>"u")throw q3("base-64");return atob(n)}const La={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Up{constructor(e,t){this.data=e,this.contentType=t||null}}function oI(n,e){switch(n){case La.RAW:return new Up(Rk(e));case La.BASE64:case La.BASE64URL:return new Up(Ak(n,e));case La.DATA_URL:return new Up(cI(e),uI(e))}throw $y()}function Rk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function lI(n){let e;try{e=decodeURIComponent(n)}catch{throw mu(La.DATA_URL,"Malformed data URL.")}return Rk(e)}function Ak(n,e){switch(n){case La.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw mu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case La.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw mu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=iI(e)}catch(l){throw l.message.includes("polyfill")?l:mu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Mk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw mu(La.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=dI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function cI(n){const e=new Mk(n);return e.base64?Ak(La.BASE64,e.rest):lI(e.rest)}function uI(n){return new Mk(n).contentType}function dI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ji{constructor(e,t){let i=0,l="";b2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(b2(this.data_)){const i=this.data_,l=aI(i,e,t);return l===null?null:new Ji(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ji(i,!0)}}static getBlob(...e){if(Gy()){const t=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(rI.apply(null,t))}else{const t=e.map(d=>Wy(d)?oI(La.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ji(l,!0)}}uploadData(){return this.data_}}function Ky(n){let e;try{e=JSON.parse(n)}catch{return null}return Y3(e)?e:null}function hI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function mI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Ik(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function fI(n,e){return e}class jr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||fI}}let lh=null;function pI(n){return!Wy(n)||n.length<2?n:Ik(n)}function Dk(){if(lh)return lh;const n=[];n.push(new jr("bucket")),n.push(new jr("generation")),n.push(new jr("metageneration")),n.push(new jr("name","fullPath",!0));function e(u,d){return pI(d)}const t=new jr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new jr("size");return l.xform=i,n.push(l),n.push(new jr("timeCreated")),n.push(new jr("updated")),n.push(new jr("md5Hash",null,!0)),n.push(new jr("cacheControl",null,!0)),n.push(new jr("contentDisposition",null,!0)),n.push(new jr("contentEncoding",null,!0)),n.push(new jr("contentLanguage",null,!0)),n.push(new jr("contentType",null,!0)),n.push(new jr("metadata","customMetadata",!0)),lh=n,lh}function gI(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new Sr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function yI(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return gI(i,n),i}function Pk(n,e,t){const i=Ky(e);return i===null?null:yI(n,i,t)}function bI(n,e,t,i){const l=Ky(e);if(l===null||!Wy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const _=n.bucket,x=n.fullPath,T="/b/"+d(_)+"/o/"+d(x),V=wm(T,t,i),W=Ck({alt:"media",token:y});return V+W})[0]}function vI(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const v2="prefixes",x2="items";function xI(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[v2])for(const l of t[v2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new Sr(e,u));i.prefixes.push(d)}if(t[x2])for(const l of t[x2]){const u=n._makeStorageReference(new Sr(e,l.name));i.items.push(u)}return i}function wI(n,e,t){const i=Ky(t);return i===null?null:xI(n,e,i)}class Yy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Qy(n){if(!n)throw $y()}function _I(n,e){function t(i,l){const u=Pk(n,l,e);return Qy(u!==null),u}return t}function kI(n,e){function t(i,l){const u=wI(n,e,l);return Qy(u!==null),u}return t}function jI(n,e){function t(i,l){const u=Pk(n,l,e);return Qy(u!==null),bI(u,l,n.host,n._protocol)}return t}function Xy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=D3():l=I3():t.getStatus()===402?l=M3(n.bucket):t.getStatus()===403?l=P3(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function TI(n){const e=Xy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=A3(n.path)),u.serverResponse=l.serverResponse,u}return t}function EI(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=wm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,_=new Yy(p,g,kI(n,e.bucket),y);return _.urlParams=u,_.errorHandler=Xy(e),_}function SI(n,e,t){const i=e.fullServerUrl(),l=wm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Yy(l,u,jI(n,t),d);return p.errorHandler=TI(e),p}function NI(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function CI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=NI(null,e)),i}function RI(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let se="";for(let he=0;he<2;he++)se=se+Math.random().toString().slice(2);return se}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=CI(e,i,l),_=vI(y,t),x="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",V=Ji.getBlob(x,i,T);if(V===null)throw F3();const W={name:y.fullPath},z=wm(u,n.host,n._protocol),U="POST",Z=n.maxUploadRetryTime,K=new Yy(z,U,_I(n,t),Z);return K.urlParams=W,K.headers=d,K.body=V.uploadData(),K.errorHandler=Xy(e),K}class AI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Xc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Xc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Xc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Xc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Xc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class MI extends AI{initXhr(){this.xhr_.responseType="text"}}function Jy(){return new MI}class Jo{constructor(e,t){this._service=e,t instanceof Sr?this._location=t:this._location=Sr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Jo(e,t)}get root(){const e=new Sr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ik(this._location.path)}get storage(){return this._service}get parent(){const e=hI(this._location.path);if(e===null)return null;const t=new Sr(this._location.bucket,e);return new Jo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw H3(e)}}function II(n,e,t){n._throwIfRoot("uploadBytes");const i=RI(n.storage,n._location,Dk(),new Ji(e,!0),t);return n.storage.makeRequestWithTokens(i,Jy).then(l=>({metadata:l,ref:n}))}function DI(n){const e={prefixes:[],items:[]};return Lk(n,e).then(()=>e)}async function Lk(n,e,t){const l=await PI(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Lk(n,e,l.nextPageToken)}function PI(n,e){e!=null&&typeof e.maxResults=="number"&&Mg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=EI(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Jy)}function LI(n){n._throwIfRoot("getDownloadURL");const e=SI(n.storage,n._location,Dk());return n.storage.makeRequestWithTokens(e,Jy).then(t=>{if(t===null)throw z3();return t})}function OI(n,e){const t=mI(n._location.path,e),i=new Sr(n._location.bucket,t);return new Jo(n.storage,i)}function VI(n){return/^[A-Za-z]+:\/\//.test(n)}function BI(n,e){return new Jo(n,e)}function Ok(n,e){if(n instanceof Zy){const t=n;if(t._bucket==null)throw U3();const i=new Jo(t,t._bucket);return e!=null?Ok(i,e):i}else return e!==void 0?OI(n,e):n}function UI(n,e){if(e&&VI(e)){if(n instanceof Zy)return BI(n,e);throw Ag("To use ref(service, url), the first argument must be a Storage instance.")}else return Ok(n,e)}function w2(n,e){const t=e?.[Sk];return t==null?null:Sr.makeFromBucketSpec(t,n)}function FI(n,e,t,i={}){n.host=`${e}:${t}`;const l=fo(e);l&&(Hg(`https://${n.host}/b`),$g("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:iw(u,n.app.options.projectId))}class Zy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Ek,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=C3,this._maxUploadRetryTime=R3,this._requests=new Set,l!=null?this._bucket=Sr.makeFromBucketSpec(l,this._host):this._bucket=w2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Sr.makeFromBucketSpec(this._url,e):this._bucket=w2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new $3(Nk());{const d=sI(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const _2="@firebase/storage",k2="0.14.0";const Vk="storage";function Fp(n,e,t){return n=Qs(n),II(n,e,t)}function j2(n){return n=Qs(n),DI(n)}function Ho(n){return n=Qs(n),LI(n)}function eo(n,e){return n=Qs(n),UI(n,e)}function zI(n=Yg(),e){n=Qs(n);const i=Zh(n,Vk).getImmediate({identifier:e}),l=nw("storage");return l&&qI(i,...l),i}function qI(n,e,t,i={}){FI(n,e,t,i)}function HI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Zy(t,i,l,e,Zo)}function $I(){Wo(new io(Vk,HI,"PUBLIC").setMultipleInstances(!0)),Oa(_2,k2,""),Oa(_2,k2,"esm2020")}$I();const Bk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},eb=Kg(Bk),Do=$w(eb),pe=g3(eb),to=zI(eb),WI=Kg(Bk,"secondary"),UP=$w(WI),GI="EYdciKDOi3UYBLk1u8hHams5tmO2",Uk=v.createContext();function Br(){return v.useContext(Uk)}function KI({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,_]=v.useState(!0);v.useEffect(()=>{let K=null;const se=ZC(Do,he=>{if(t(he),K&&(K(),K=null),he)if(he.uid===GI)l(!0),d(!1),g(null),_(!1);else{l(!1);const Me=Ds(Bt(pe,"clients"),ms("uid","==",he.uid)),we=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const E=await Rs(qe(pe,"clients",C));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};K=jk(Me,async C=>{if(C.empty)await we();else{const E=C.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}_(!1)},async C=>{console.error("Error listening to client data:",C),await we(),_(!1)})}else l(!1),d(!1),g(null),_(!1)});return()=>{se(),K&&K()}},[]);const Z={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(se=>se?{...se,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const se=await Rs(qe(pe,"clients",K));if(se.exists()){const he={id:se.id,...se.data()};return d(!0),g(he),he}}catch(se){console.error("resolveClient direct read failed:",se)}if(e){const se=Ds(Bt(pe,"clients"),ms("uid","==",e.uid)),he=await Es(se);if(!he.empty){const Me={id:he.docs[0].id,...he.docs[0].data()};return d(!0),g(Me),Me}}return null},login:async(K,se,he=!0)=>(await ox(Do,he?mg:sy),await QC(Do,K,se)),signup:async(K,se,he)=>{await ox(Do,mg);const Me=await YC(Do,se.trim().toLowerCase(),he),we=Me.user,C=qe(Bt(pe,"clients")),E={uid:we.uid,name:K.trim(),email:se.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:wt.now()};await Ss(C,E),d(!0),g({id:C.id,...E});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Me},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return e4(Do)},resetPassword:K=>KC(Do,K),loading:y};return r.jsx(Uk.Provider,{value:Z,children:n})}const Fk=v.createContext();function Sa(){return v.useContext(Fk)}function YI({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Fk.Provider,{value:p,children:n})}const zk=v.createContext();function _m(){return v.useContext(zk)}const QI=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],XI=[5,10],JI=1;function ZI({children:n}){const{clientData:e,loading:t}=Br(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!QI.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:XI,FREE_RANDOMISER_WEEKLY_LIMIT:JI}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(zk.Provider,{value:i,children:n})}function eD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function tD({className:n=""}){const{isDark:e,toggleTheme:t}=Sa();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function sD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[_,x]=v.useState(!1),[T,V]=v.useState(!1),{login:W,resetPassword:z,currentUser:U,isAdmin:Z,isClient:K,clientData:se,loading:he}=Br(),Me=Jn();if(v.useEffect(()=>{!he&&U&&(Z?Me("/dashboard"):K?Me(eD(se)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[he,U,Z,K,se,Me]),he||U)return null;const we=async E=>{E.preventDefault(),p(""),y(!0);try{await W(n,t,l)}catch(R){p(R.message||"Failed to log in"),y(!1)}},C=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await z(n.trim()),V(!0)}catch(R){R.code==="auth/user-not-found"?p("No account found with this email"):p(R.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(tD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:_?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{x(!1),V(!1),p("")},children:"Back to Log In"})]}):_?r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:we,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Dl({feature:n,children:e}){const{canAccess:t,loading:i}=_m(),l=Jn();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function la({active:n}){const e=Jn(),{clientData:t}=Br(),{isPremium:i}=_m(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function ja({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),_=v.useCallback(T=>{if(!g.current||l)return;const V=T.touches[0].clientY-p.current;V>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((V-20)*.35,80)))},[l]),x=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:_,onTouchEnd:x,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Wu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const tb=Wu(60,100,100,85,96),qk=Wu(60,100,100,78,94),nD=Wu(60,100,100,82,94);Wu(60,50,50,38,46);const T2=Wu(60,40,40,30,37),rD="/login/assets/first_workout-B8SFkzJX.PNG",aD="/login/assets/workouts_10-Z5R3u0xH.PNG",iD="/login/assets/workouts_25-CzxSlcAj.PNG",oD="/login/assets/workouts_50-BpzWup3V.PNG",lD="/login/assets/workouts_100-D7_r6tn1.PNG",cD="/login/assets/streak_2-CsRr-XA9.PNG",uD="/login/assets/streak_4-BHO09tbw.PNG",dD="/login/assets/streak_8-DX2UWMko.PNG",hD="/login/assets/first_pb-aVf_CNWy.PNG",mD="/login/assets/pbs_5-Cippawgg.PNG",fD="/login/assets/pbs_10-CZgGh9Kv.PNG",pD="/login/assets/pbs_100-C67b1wfS.PNG",gD="/login/assets/nutrition_7-CHVV11fj.PNG",yD="/login/assets/leaderboard_join-BLoId4Hz.PNG",bD="/login/assets/habits_7-Dvki70KO.PNG",fu=[{id:"first_workout",img:rD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:aD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:iD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:oD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:lD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:cD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:uD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:dD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:hD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:mD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:fD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:pD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:gD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:yD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:bD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function vD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,_]=v.useState(!1),x=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Me=we=>we.preventDefault();return document.addEventListener("touchmove",Me,{passive:!1}),document.addEventListener("wheel",Me,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Me),document.removeEventListener("wheel",Me),document.body.style.overflow=""}},[t]);const V=v.useMemo(()=>t?n.filter(Me=>document.querySelector(Me.selector)):[],[t]),W=V[i],z=i===V.length-1,U=W?.selector,Z=v.useCallback(()=>{if(!U)return;const Me=document.querySelector(U);if(!Me){d(null);return}const we=Me.getBoundingClientRect(),C=8;d({top:we.top-C,left:we.left-C,width:we.width+C*2,height:we.height+C*2});const E=window.innerHeight-we.bottom;g(E<260?"above":"below")},[U]);if(v.useEffect(()=>{if(!t||!U)return;_(!0);const Me=document.querySelector(U);if(Me){document.body.style.overflow="",Me.scrollIntoView({behavior:"smooth",block:"center"});let we=null,C=0,E=0;const R=60,O=()=>{E++;const D=Me.getBoundingClientRect(),Ue=Math.round(D.top);if(we!==null&&Ue===we?C++:C=0,we=Ue,C>=3||E>=R){T.current&&(document.body.style.overflow="hidden"),Z(),_(!1);return}I=requestAnimationFrame(O)};let I;const H=setTimeout(()=>{I=requestAnimationFrame(O)},120);return()=>{clearTimeout(H),I&&cancelAnimationFrame(I),T.current&&(document.body.style.overflow="hidden")}}},[t,i,U,Z]),v.useEffect(()=>{if(!t)return;const Me=()=>{x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(Z)};return window.addEventListener("scroll",Me,!0),window.addEventListener("resize",Me),()=>{window.removeEventListener("scroll",Me,!0),window.removeEventListener("resize",Me),x.current&&cancelAnimationFrame(x.current)}},[t,Z]),!t||!W||V.length===0)return null;const K=()=>{z?e():l(i+1)},se=()=>{i>0&&l(i-1)},he=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Me=>{Me.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:K}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:V.map((Me,we)=>r.jsx("span",{className:`st-dot${we===i?" active":""}${we<i?" done":""}`},we))}),r.jsx("h3",{className:"st-title",children:W.title}),r.jsx("p",{className:"st-body",children:W.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:se,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:W.cta||(z?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:he,children:"Skip tour"})]})]})}const zp=[10,25,50,100,200,500,1e3],Wi=5;function Jc(n){return n.toISOString().split("T")[0]}function xD(n){let e=0;for(const t of zp){if(n<t)return{prev:e,next:t};e=t}return{prev:zp[zp.length-1],next:n+100}}const wD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},_D={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},qp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Hp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Zc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function kD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function jD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Br(),{isDark:d,toggleTheme:p}=Sa(),{isPremium:g}=_m(),y=Jn(),[_,x]=v.useState({hours:0,minutes:0,seconds:0}),[T,V]=v.useState(0),[W,z]=v.useState(0),[U,Z]=v.useState(""),[K,se]=v.useState(0),[he,Me]=v.useState(0),[we,C]=v.useState(!1),[E,R]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[O,I]=v.useState(null),[H,D]=v.useState(0),[Ue,lt]=v.useState(null),[B,re]=v.useState(!1),[Te,Ve]=v.useState(!1),[ee,L]=v.useState(0),[ae,De]=v.useState(0),[Pe,Ke]=v.useState([]),[Be,gt]=v.useState([]),[Nt,ct]=v.useState(null),[Zt,Vs]=v.useState(!1),ft=v.useRef(null),[ht,ce]=v.useState([]),[os,Yt]=v.useState(null),[Ct,yt]=v.useState(null),st=v.useRef(null),[He,zt]=v.useState(0),[Ns,$s]=v.useState(0),[Dt,Tt]=v.useState(0),[rs,As]=v.useState(0),[Ut,Xs]=v.useState(null),Pt=v.useCallback((M,J="info")=>{Xs({message:M,type:J}),setTimeout(()=>Xs(null),4e3)},[]),[fs,qt]=v.useState([]),[ve,G]=v.useState(!1),[de,Ee]=v.useState(""),[Le,_e]=v.useState(null),[Ye,at]=v.useState(null),[Y,ne]=v.useState(!1),[$e,We]=v.useState(new Set),[rt,pt]=v.useState(new Set),[vt,Rt]=v.useState({}),[_s,Ws]=v.useState({}),[as,ks]=v.useState({}),[Bs,$]=v.useState({}),[xe,Ce]=v.useState({}),[Se,ke]=v.useState({}),ot=v.useRef(null),bt=v.useRef(null),Je=v.useRef({}),[_t,jt]=v.useState([]),[Cs,un]=v.useState(!1),fn=v.useRef(null),[kn,Mn]=v.useState([]),[pn,Fs]=v.useState(""),[j,N]=v.useState(!1),[P,F]=v.useState(null),[me,Fe]=v.useState([]),[ze,tt]=v.useState(null),[Ze,es]=v.useState(!1),js=v.useRef(!1),cs=(()=>{const M=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&M.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),M.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),M})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let M=t?.tourComplete||js.current;if(!M&&t?.id)try{M=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(we&&t&&!M){const J=setTimeout(()=>es(!0),600);return()=>clearTimeout(J)}},[we,t]),v.useEffect(()=>{if(t)try{const M=sessionStorage.getItem(`cbDash_${t.id}`);if(M){const J=JSON.parse(M);z(J.programmePct??0),Z(J.programmeName??""),se(J.totalWorkouts??0),Me(J.habitWeekPct??0),R(J.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),I(J.nutritionTargetData??null),D(J.todayHabitsCount??0),lt(J.nextSession??null),re(J.hasProgramme??!1),Ve(J.programmeComplete??!1),L(J.weeklyWorkouts??0),De(J.pbCount??0),Ke(J.topPBs??[]),gt(J.leaderboardTop3??[]),ce(J.unlockedBadges??[]),st.current=J.unlockedBadges??[],zt(J.streakWeeks??0),C(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&ct(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const M=Ds(Bt(pe,"notifications"),ms("toId","==",t.id)),J=jk(M,Ne=>{const et=Ne.docs.map(kt=>({id:kt.id,...kt.data()}));et.sort((kt,It)=>{const it=kt.createdAt?.toMillis?.()||0;return(It.createdAt?.toMillis?.()||0)-it}),jt(et.slice(0,50))},Ne=>{console.error("Notification listener error:",Ne),Ne.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>J()},[t]),v.useEffect(()=>{const M=J=>{fn.current&&!fn.current.contains(J.target)&&un(!1)};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),v.useEffect(()=>{if(!t)return;const M=t.id;(async()=>{try{const[J,Ne,et]=await Promise.all([Es(Ds(Bt(pe,"buddies"),ms("user1","==",M))),Es(Ds(Bt(pe,"buddies"),ms("user2","==",M))),Es(Bt(pe,"clients"))]),kt=new Set;[...J.docs,...Ne.docs].forEach(it=>{const Ft=it.data();kt.add(Ft.user1===M?Ft.user2:Ft.user1)});const It={};et.docs.forEach(it=>{It[it.id]=it.data()}),Mn(Array.from(kt).filter(it=>It[it]).map(it=>({id:it,name:It[it].name,photoURL:It[it].photoURL||null})))}catch(J){console.error("Error loading buddies for mentions:",J)}})()},[t]);const ls=_t.filter(M=>!M.read).length,zs=async()=>{const M=_t.filter(Ne=>!Ne.read);if(!M.length)return;const J=y2(pe);M.forEach(Ne=>J.update(qe(pe,"notifications",Ne.id),{read:!0})),await J.commit()},jn=async()=>{if(!_t.length)return;const M=y2(pe);_t.forEach(J=>M.delete(qe(pe,"notifications",J.id))),await M.commit()},or=async(M,J,Ne={})=>{if(!(!t||M===t.id))try{await wa(Bt(pe,"notifications"),{toId:M,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:J,read:!1,createdAt:Tr(),...Ne})}catch(et){console.error("Notification create error:",et),et.code==="permission-denied"&&Pt("Notifications blocked  check Firestore rules","error")}},us=(M,J)=>{const Ne=J==="compose"?ot.current?.selectionStart:null,kt=(Ne!=null?M.slice(0,Ne):M).match(/@(\w*)$/);if(kt){N(!0),F(J),Fs(kt[1].toLowerCase());const It=kn.filter(it=>it.name&&it.name.toLowerCase().includes(kt[1].toLowerCase())).slice(0,5);Fe(It)}else N(!1),Fe([])},Qr=(M,J)=>{if(J==="compose"){const Ne=ot.current,et=de,kt=Ne?.selectionStart??et.length,It=et.slice(0,kt),it=et.slice(kt),Ft=It.replace(/@\w*$/,`@${M.name} `);Ee(Ft+it),setTimeout(()=>{Ne?.focus(),Ne.selectionStart=Ne.selectionEnd=Ft.length},0)}else{const et=(_s[J]||"").replace(/@\w*$/,`@${M.name} `);Ws(kt=>({...kt,[J]:et}))}N(!1),Fe([])},In=M=>M&&M.split(/(@\w[\w\s]*?\s)/g).map((Ne,et)=>Ne.startsWith("@")&&kn.some(kt=>Ne.trim()===`@${kt.name}`)?r.jsx("span",{className:"mention-highlight",children:Ne.trim()},et):Ne),X=async M=>{const J=M.target.files?.[0];if(!(!J||!t)){if(!J.type.startsWith("image/")){Pt("Please select an image file","error");return}if(J.size>5*1024*1024){Pt("Image must be under 5MB","error");return}Vs(!0);try{const Ne=await new Promise(It=>{const it=new Image;it.onload=()=>{const Ft=document.createElement("canvas"),Gt=400;let is=it.width,Wt=it.height;is>Wt?(Wt=Wt/is*Gt,is=Gt):(is=is/Wt*Gt,Wt=Gt),Ft.width=is,Ft.height=Wt,Ft.getContext("2d").drawImage(it,0,0,is,Wt),Ft.toBlob(xs=>It(xs),"image/jpeg",.75)},it.src=URL.createObjectURL(J)}),et=eo(to,`profilePhotos/${t.id}`);await Fp(et,Ne);const kt=await Ho(et);await Pa(qe(pe,"clients",t.id),{photoURL:kt}),ct(kt),l({photoURL:kt}),Pt("Profile photo updated!","success")}catch(Ne){console.error("Photo upload error:",Ne),Pt("Failed to upload photo","error")}Vs(!1),ft.current&&(ft.current.value="")}};v.useEffect(()=>{const M=()=>{const Ne=new Date,et=new Date(Ne);et.setHours(23,59,59,999);const kt=et-Ne,It=Math.floor(kt/(1e3*60*60)),it=Math.floor(kt%(1e3*60*60)/(1e3*60)),Ft=Math.floor(kt%(1e3*60)/1e3);x({hours:It,minutes:it,seconds:Ft}),V(60-Ft)};M();const J=setInterval(M,1e3);return()=>clearInterval(J)},[]),v.useEffect(()=>{const M=setInterval(()=>{As(J=>(J+1)%qp.length)},8e3);return()=>clearInterval(M)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let J=null,Ne=0,et=[],kt=!1,It=null;try{const it=Jc(new Date),Ft=await Rs(qe(pe,"clientProgrammes",t.id));if(Ft.exists()){const dr=Ft.data(),yn=wD[dr.templateId];if(re(!0),yn){const xr=dr.completedSessions||{},Ar=Object.keys(xr).length,Wa=yn.duration*yn.daysPerWeek;z(Wa>0?Math.round(Ar/Wa*100):0);const sl=dr.templateId.replace(/_/g," ").replace(/\b\w/g,ca=>ca.toUpperCase());Z(sl);const nl=_D[dr.templateId];let wr=!1;for(let ca=1;ca<=yn.duration&&!wr;ca++)for(let ua=0;ua<yn.daysPerWeek&&!wr;ua++)xr[`w${ca}d${ua}`]||(lt({week:ca,dayIdx:ua,label:nl?.[ua]||`Day ${ua+1}`}),wr=!0);wr||(Ve(!0),kt=!0)}}const Gt=Bt(pe,"workoutLogs"),is=Ds(Gt,ms("clientId","==",t.id));J=await Es(is),se(J.docs.length);const Wt=new Date,xs=Wt.getDay(),Kn=xs===0?6:xs-1,br=new Date(Wt);br.setDate(Wt.getDate()-Kn),br.setHours(0,0,0,0);const sn=br.getTime(),Zs=J.docs.filter(dr=>{const yn=dr.data().completedAt;return yn?(yn.toDate?yn.toDate().getTime():new Date(yn).getTime())>=sn:!1}).length;L(Zs);const Yn=Bt(pe,"habitLogs"),hn=Ds(Yn,ms("clientId","==",t.id),ms("date","==",it)),zn=await Es(hn);let ur=0;if(!zn.empty){const dr=zn.docs[0].data().habits||{};ur=Object.values(dr).filter(Boolean).length}Me(Math.round(ur/Wi*100)),D(ur);const Zn=await Rs(qe(pe,"nutritionTargets",t.id));Zn.exists()&&(I(Zn.data()),It=Zn.data());const vr=await Rs(qe(pe,"nutritionLogs",`${t.id}_${it}`));if(vr.exists()){const yn=(vr.data().entries||[]).reduce((xr,Ar)=>({protein:xr.protein+(Ar.protein||0),carbs:xr.carbs+(Ar.carbs||0),fats:xr.fats+(Ar.fats||0),calories:xr.calories+(Ar.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});R(yn)}}catch(it){console.error("Error loading dashboard stats:",it)}try{let it=[];const Ft=await Rs(qe(pe,"coreBuddyPBs",t.id));if(Ft.exists()){const Gt=Ft.data().exercises||{};De(Object.keys(Gt).length),Ne=Object.keys(Gt).length,it=Object.entries(Gt).sort(([,is],[,Wt])=>(Wt.weight||0)-(is.weight||0)).slice(0,3).map(([is,Wt])=>({name:is,weight:Wt.weight,reps:Wt.reps}))}et=it,Ke(it)}catch(it){console.error("PB fetch error:",it)}try{const it=Bt(pe,"clients"),Ft=Ds(it,ms("leaderboardOptIn","==",!0)),is=(await Es(Ft)).docs.map(Wt=>({id:Wt.id,name:Wt.data().name,photoURL:Wt.data().photoURL||null}));gt(is.slice(0,3))}catch(it){console.error("Leaderboard preview error:",it)}try{let it=0;if(J){const sn=J.docs.map(Zs=>Zs.data().date).filter(Boolean).sort().reverse();if(sn.length>0){const Zs=new Date;let Yn=new Date(Zs);e:for(let hn=0;hn<52;hn++){const zn=new Date(Yn),ur=zn.getDay(),Zn=ur===0?6:ur-1;zn.setDate(zn.getDate()-Zn),zn.setHours(0,0,0,0);const vr=new Date(zn);vr.setDate(vr.getDate()+7);const dr=Jc(zn),yn=Jc(vr);if(sn.some(Ar=>Ar>=dr&&Ar<yn))it++;else{if(hn>0)break e;break}Yn.setDate(Yn.getDate()-7)}}}zt(it);let Ft=0;for(let sn=0;sn<30;sn++){const Zs=new Date;Zs.setDate(Zs.getDate()-sn);const Yn=Jc(Zs);try{const hn=await Es(Ds(Bt(pe,"habitLogs"),ms("clientId","==",t.id),ms("date","==",Yn)));if(hn.empty)break;{const zn=hn.docs[0].data().habits||{};if(Object.values(zn).filter(Boolean).length>=Wi)Ft++;else break}}catch{break}}$s(Ft);let Gt=0;for(let sn=0;sn<30;sn++){const Zs=new Date;Zs.setDate(Zs.getDate()-sn);const Yn=Jc(Zs);try{const hn=await Rs(qe(pe,"nutritionLogs",`${t.id}_${Yn}`));if(hn.exists()&&(hn.data().entries||[]).length>0)if(It){const ur=(hn.data().entries||[]).reduce((Zn,vr)=>({protein:Zn.protein+(vr.protein||0),carbs:Zn.carbs+(vr.carbs||0),fats:Zn.fats+(vr.fats||0)}),{protein:0,carbs:0,fats:0});if(ur.protein>=(It.protein||0)&&ur.carbs>=(It.carbs||0)&&ur.fats>=(It.fats||0))Gt++;else break}else Gt++;else break}catch{break}}Tt(Gt);const is=J?J.docs.length:0,Wt=[],xs=sn=>Wt.push(sn);is>=1&&xs("first_workout"),is>=10&&xs("workouts_10"),is>=25&&xs("workouts_25"),is>=50&&xs("workouts_50"),is>=100&&xs("workouts_100"),it>=2&&xs("streak_2"),it>=4&&xs("streak_4"),it>=8&&xs("streak_8"),Ne>=1&&xs("first_pb"),Ne>=5&&xs("pbs_5"),Ne>=10&&xs("pbs_10"),Ne>=100&&xs("pbs_100"),Gt>=7&&xs("nutrition_7"),t.leaderboardOptIn&&xs("leaderboard_join"),Ft>=7&&xs("habits_7"),ce(Wt);const Kn=st.current;if(Kn!==null){const sn=Wt.filter(Zs=>!Kn.includes(Zs));if(sn.length>0){const Zs=fu.find(Yn=>Yn.id===sn[sn.length-1]);Zs&&setTimeout(()=>yt(Zs),600)}}st.current=Wt;const br={};Wt.forEach(sn=>{br[sn]={unlockedAt:new Date().toISOString()}}),Ss(qe(pe,"achievements",t.id),{badges:br,progress:{streakWeeks:it,pbCount:Ne,nutritionStreak:Gt,habitStreak:Ft},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(it){console.error("Achievement computation error:",it)}C(!0)})()},[n,t]),v.useEffect(()=>{if(!(!we||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:W,programmeName:U,totalWorkouts:K,habitWeekPct:he,nutritionTotals:E,nutritionTargetData:O,todayHabitsCount:H,nextSession:Ue,hasProgramme:B,programmeComplete:Te,weeklyWorkouts:ee,pbCount:ae,topPBs:Pe,leaderboardTop3:Be,unlockedBadges:ht,streakWeeks:He}))}catch{}},[we,W,U,K,he,E,O,H,Ue,B,Te,ee,ae,Pe,Be,ht,He,t]);const be=v.useCallback(async()=>{if(js.current=!0,es(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Pa(qe(pe,"clients",t.id),{tourComplete:!0})}catch(M){console.error("Failed to save tour completion:",M)}}},[t,l]),ge=M=>{const J=M.currentTarget,Ne=J.querySelector(".ripple");Ne&&Ne.remove();const et=J.getBoundingClientRect(),kt=Math.max(et.width,et.height),It=M.clientX-et.left-kt/2,it=M.clientY-et.top-kt/2,Ft=document.createElement("span");Ft.className="ripple",Ft.style.cssText=`width:${kt}px;height:${kt}px;left:${It}px;top:${it}px;`,J.appendChild(Ft),setTimeout(()=>Ft.remove(),600)},Xe=t?.name?.split(" ")[0]||"there",{prev:Qe,next:ut}=xD(K),Ht=ut>Qe?Math.round((K-Qe)/(ut-Qe)*100):100,$t=[{label:"Programme",value:`${W}%`,pct:W,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:Ht,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${he}%`,pct:he,color:"#38B6FF",size:"normal"}],Vt=M=>!O||!O[M]?0:Math.min(Math.round(E[M]/O[M]*100),100),Tn=(()=>{const M=new Date().getHours();return we&&H>=Wi&&E.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:M>=5&&M<12?{main:"Rise and grind,",sub:"let's get after it!"}:M>=12&&M<17?{main:"Oye",sub:"crack on and make it count!"}:M>=17&&M<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),At=we?B&&Ue&&!Te?{label:"NEXT SESSION",message:`Week ${Ue.week}, Day ${Ue.dayIdx+1}  ${Ue.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:W,ringLabel:`${W}%`}:H<Wi?{label:"DAILY HABITS",message:`${H}/${Wi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:he,ringLabel:`${H}/${Wi}`}:E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:B?Te?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,Ps=v.useCallback(async()=>{if(t){G(!0);try{const M=await Es(Ds(Bt(pe,"posts"),ms("authorId","==",t.id),Kh("createdAt","desc"),Yh(30)));qt(M.docs.map(Ne=>({id:Ne.id,...Ne.data()})));const J=await Es(Ds(Bt(pe,"postLikes"),ms("userId","==",t.id)));We(new Set(J.docs.map(Ne=>Ne.data().postId)))}catch(M){console.error("Error loading journey:",M)}finally{G(!1)}}},[t]);v.useEffect(()=>{we&&t&&Ps()},[we,t,Ps]);const gn=M=>{const J=M.target.files?.[0];if(J){if(!J.type.startsWith("image/")){Pt("Please select an image file","error");return}if(J.size>10*1024*1024){Pt("Image must be under 10MB","error");return}_e(J),at(URL.createObjectURL(J))}},En=()=>{_e(null),Ye&&URL.revokeObjectURL(Ye),at(null),bt.current&&(bt.current.value="")},Fn=async()=>{if(!(!de.trim()&&!Le||Y||!t)){ne(!0);try{let M=null;if(Le){const et=await kD(Le),kt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,It=eo(to,`postImages/${t.id}/${kt}`);await Fp(It,et),M=await Ho(It)}await wa(Bt(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:de.trim(),type:M?"image":"text",imageURL:M||null,createdAt:Tr(),likeCount:0,commentCount:0});const Ne=de.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ne){const et=new Set;Ne.forEach(kt=>{const It=kt.slice(1).trim(),it=kn.find(Ft=>Ft.name&&Ft.name.toLowerCase()===It.toLowerCase());it&&!et.has(it.id)&&(et.add(it.id),or(it.id,"mention",{}))})}Ee(""),En(),ot.current&&(ot.current.style.height="auto"),await Ps(),Pt("Posted!","success")}catch(M){console.error("Error posting:",M),Pt(M?.message||"Failed to post","error")}finally{ne(!1)}}},yr=async M=>{if(window.confirm("Delete this post?"))try{await Er(qe(pe,"posts",M)),qt(J=>J.filter(Ne=>Ne.id!==M)),Pt("Post deleted","info")}catch(J){console.error("Delete error:",J),Pt("Failed to delete","error")}},Qt=async M=>{if(!t)return;const J=t.id,Ne=`${M}_${J}`,et=$e.has(M),kt=new Set($e);et?kt.delete(M):kt.add(M),We(kt),qt(It=>It.map(it=>it.id===M?{...it,likeCount:Math.max(0,(it.likeCount||0)+(et?-1:1))}:it));try{if(et)await Er(qe(pe,"postLikes",Ne)),await Pa(qe(pe,"posts",M),{likeCount:Uo(-1)});else{await Ss(qe(pe,"postLikes",Ne),{postId:M,userId:J,createdAt:Tr()}),await Pa(qe(pe,"posts",M),{likeCount:Uo(1)});const It=fs.find(it=>it.id===M);It&&or(It.authorId,"like",{postId:M})}}catch(It){console.error("Like error:",It),Ps()}},Js=async M=>{try{const J=await Es(Ds(Bt(pe,"postComments"),ms("postId","==",M),Kh("createdAt","asc"),Yh(50)));Rt(Ne=>({...Ne,[M]:J.docs.map(et=>({id:et.id,...et.data()}))}))}catch(J){console.error("Error loading comments:",J)}},dn=M=>{const J=new Set(rt);J.has(M)?J.delete(M):(J.add(M),vt[M]||Js(M)),pt(J)},$n=async M=>{const J=(_s[M]||"").trim(),Ne=xe[M];if(!(!J&&!Ne||!t)){ks(et=>({...et,[M]:!0}));try{let et=null;if(Ne){const Gt=eo(to,`comment-images/${Date.now()}_${Ne.name}`);await Fp(Gt,Ne),et=await Ho(Gt)}const kt={postId:M,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:J||"",createdAt:Tr()};et&&(kt.imageURL=et);const It=Bs[M];It&&(kt.replyToId=It.id,kt.replyToName=It.authorName),await wa(Bt(pe,"postComments"),kt),await Pa(qe(pe,"posts",M),{commentCount:Uo(1)});const it=fs.find(Gt=>Gt.id===M);it&&or(it.authorId,"comment",{postId:M});const Ft=J.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ft){const Gt=new Set;Ft.forEach(is=>{const Wt=is.slice(1).trim(),xs=kn.find(Kn=>Kn.name&&Kn.name.toLowerCase()===Wt.toLowerCase());xs&&!Gt.has(xs.id)&&(Gt.add(xs.id),or(xs.id,"mention",{postId:M}))})}Ws(Gt=>({...Gt,[M]:""})),Ce(Gt=>({...Gt,[M]:null})),ke(Gt=>({...Gt,[M]:null})),$(Gt=>({...Gt,[M]:null})),Je.current[M]&&(Je.current[M].value=""),qt(Gt=>Gt.map(is=>is.id===M?{...is,commentCount:(is.commentCount||0)+1}:is)),await Js(M)}catch(et){console.error("Comment error:",et),Pt("Failed to comment","error")}finally{ks(et=>({...et,[M]:!1}))}}},Wn=async(M,J)=>{try{await Er(qe(pe,"postComments",J)),await Pa(qe(pe,"posts",M),{commentCount:Uo(-1)}),Rt(Ne=>({...Ne,[M]:(Ne[M]||[]).filter(et=>et.id!==J)})),qt(Ne=>Ne.map(et=>et.id===M?{...et,commentCount:Math.max((et.commentCount||1)-1,0)}:et))}catch(Ne){console.error("Delete comment error:",Ne),Pt("Failed to delete comment","error")}},Sn=(M,J)=>{const Ne=J.target.files?.[0];if(!Ne)return;if(Ne.size>5*1024*1024){Pt("Image must be under 5MB","error");return}Ce(kt=>({...kt,[M]:Ne}));const et=new FileReader;et.onload=kt=>ke(It=>({...It,[M]:kt.target.result})),et.readAsDataURL(Ne)},Gn=M=>{Ce(J=>({...J,[M]:null})),ke(J=>({...J,[M]:null})),Je.current[M]&&(Je.current[M].value="")},lr=M=>{Ee(M.target.value),M.target.style.height="auto",M.target.style.height=Math.min(M.target.scrollHeight,120)+"px",us(M.target.value,"compose")},cr=(M,J)=>{Ws(Ne=>({...Ne,[M]:J})),us(J,M)};return r.jsx(ja,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:fn,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{un(!Cs),Cs||zs()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),ls>0&&r.jsx("span",{className:"header-notif-badge",children:ls>9?"9+":ls})]}),Cs&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),_t.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:jn,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:_t.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):_t.map(M=>r.jsxs("div",{className:`notif-item${M.read?"":" unread"}`,onClick:()=>{if(un(!1),M.type==="buddy_request"||M.type==="buddy_accept")y("/client/core-buddy/buddies");else if((M.type==="like"||M.type==="comment")&&M.postId){if(!rt.has(M.postId)){const J=new Set(rt);J.add(M.postId),pt(J),vt[M.postId]||Js(M.postId)}setTimeout(()=>{const J=document.getElementById(`post-${M.postId}`);J&&J.scrollIntoView({behavior:"smooth",block:"center"})},150)}else M.type==="like"||M.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):M.type==="mention"&&y(`/client/core-buddy/profile/${M.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:M.fromPhotoURL?r.jsx("img",{src:M.fromPhotoURL,alt:""}):r.jsx("span",{children:(M.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:M.fromName})," ",M.type==="buddy_request"&&"sent you a buddy request",M.type==="buddy_accept"&&"accepted your buddy request",M.type==="like"&&"liked your post",M.type==="comment"&&"commented on your post",M.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Hp(M.createdAt)})]})]},M.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:tb.map((M,J)=>{const Ne=J<T;return r.jsx("line",{x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,className:`ring-tick ${Ne?"elapsed":"remaining"}`,strokeWidth:M.thick?"3":"2"},J)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>ft.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:Nt||"/Logo.webp",alt:Nt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Zt?" uploading":""}`,children:Zt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:ft,type:"file",accept:"image/*",onChange:X,style:{display:"none"}})]}),!Nt&&!Zt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>ft.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(_.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(_.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(_.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[qp[rs].text," ",r.jsx("strong",{children:qp[rs].bold})]},rs)]}),r.jsx("div",{className:"cb-stats-row",children:$t.map(M=>{const J=(M.size==="large",38),Ne=2*Math.PI*J,et=Ne-M.pct/100*Ne;return r.jsxs("div",{className:`cb-stat-item${M.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:J}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:J,style:{stroke:M.color},strokeDasharray:Ne,strokeDashoffset:et})]}),r.jsx("span",{className:"cb-stat-value",style:{color:M.color},children:M.value})]}),r.jsx("span",{className:"cb-stat-label",children:M.label})]},M.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[Tn.main," ",r.jsx("strong",{children:Xe}),"  ",Tn.sub]}),At&&r.jsxs("button",{className:"cb-nudge-card",onClick:At.action||void 0,style:At.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-At.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:At.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:At.label}),r.jsx("span",{className:"cb-nudge-title",children:At.message}),At.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[At.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:M=>{ge(M),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{ge(M),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Vt("protein"),color:"#14b8a6"},{label:"C",pct:Vt("carbs"),color:"var(--color-primary)"},{label:"F",pct:Vt("fats"),color:"#eab308"},{label:"Cal",pct:Vt("calories"),color:"#38B6FF"}].map(M=>{const Ne=2*Math.PI*38,et=Ne-M.pct/100*Ne;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:M.color},strokeDasharray:Ne,strokeDashoffset:et})]}),r.jsx("span",{style:{color:M.color},children:M.label})]},M.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:M=>{ge(M),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ee," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[K," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{ge(M),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Wi},(M,J)=>r.jsx("span",{className:`cb-habit-dot${J<H?" done":""}`},J))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[H,"/",Wi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{ge(M),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Pe.length>0?r.jsx("div",{className:"cb-pb-preview",children:Pe.slice(0,2).map(M=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:M.name}),r.jsxs("span",{className:"cb-pb-value",children:[M.weight,"kg"]})]},M.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{ge(M),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Be.length>0?r.jsx("div",{className:"cb-lb-preview",children:Be.map((M,J)=>{const Ne=["#FFD700","#A8B4C0","#CD7F32"][J],et=M.name?M.name.split(" ").map(It=>It[0]).join("").slice(0,2).toUpperCase():"?",kt=M.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${kt?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ne},children:M.photoURL?r.jsx("img",{src:M.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:et})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Ne},children:["#",J+1]})]},M.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{ge(M),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:fu.map(M=>{const J=ht.includes(M.id);return r.jsx("button",{className:`cb-badge${J?" unlocked":" locked"}`,onClick:()=>Yt(M),children:r.jsx("img",{src:M.img,alt:M.name,className:"cb-badge-img"})},M.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[ht.length,"/",fu.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:Nt?r.jsx("img",{src:Nt,alt:""}):r.jsx("span",{children:Zc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:ot,placeholder:"Share your progress... (use @ to mention)",value:de,onChange:lr,rows:1,maxLength:500}),j&&P==="compose"&&me.length>0&&r.jsx("div",{className:"mention-dropdown",children:me.map(M=>r.jsxs("button",{className:"mention-option",onClick:()=>Qr(M,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:M.photoURL?r.jsx("img",{src:M.photoURL,alt:""}):r.jsx("span",{children:Zc(M.name)})}),r.jsx("span",{children:M.name})]},M.id))}),Ye&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Ye,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:En,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>bt.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:bt,type:"file",accept:"image/*",onChange:gn,hidden:!0}),(de.trim()||Le)&&r.jsx("button",{className:"journey-post-btn",onClick:Fn,disabled:Y,children:Y?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ve?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):fs.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:fs.map(M=>r.jsxs("div",{id:`post-${M.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:M.authorPhotoURL?r.jsx("img",{src:M.authorPhotoURL,alt:""}):r.jsx("span",{children:Zc(M.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:M.authorName}),r.jsx("span",{className:"journey-post-time",children:Hp(M.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>yr(M.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),M.type==="workout_summary"&&M.metadata?r.jsxs("div",{className:"journey-card journey-card-workout",children:[r.jsx("div",{className:"journey-card-accent"}),r.jsx("div",{className:"journey-card-glow"}),r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:M.metadata.title}),M.metadata.subtitle&&r.jsx("p",{className:"journey-card-subtitle",children:M.metadata.subtitle}),M.metadata.stats?.length>0&&r.jsx("div",{className:"journey-card-stats",children:M.metadata.stats.map((J,Ne)=>r.jsxs("div",{className:"journey-card-stat",children:[r.jsx("span",{className:"journey-card-stat-val",children:J.value}),r.jsx("span",{className:"journey-card-stat-label",children:J.label})]},Ne))}),M.metadata.quote&&r.jsxs("p",{className:"journey-card-quote",children:["",M.metadata.quote,""]}),r.jsx("div",{className:"journey-card-footer",children:"Mind Core Fitness"})]}):M.type==="badge_earned"&&M.metadata?r.jsxs("div",{className:"journey-card journey-card-badge",children:[r.jsx("div",{className:"journey-card-accent"}),r.jsx("div",{className:"journey-card-glow"}),r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:M.metadata.title}),M.metadata.badges?.length>0&&r.jsx("div",{className:"journey-card-badges",children:M.metadata.badges.map((J,Ne)=>r.jsx("span",{className:"journey-card-badge-tag",children:J},Ne))}),r.jsx("div",{className:"journey-card-footer",children:"Mind Core Fitness"})]}):r.jsxs(r.Fragment,{children:[M.content&&r.jsx("p",{className:"journey-post-content",children:In(M.content)}),M.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:M.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${$e.has(M.id)?" liked":""}`,onClick:()=>Qt(M.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:$e.has(M.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:M.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${rt.has(M.id)?" active":""}`,onClick:()=>dn(M.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:M.commentCount||0})]})]}),rt.has(M.id)&&r.jsxs("div",{className:"journey-comments",children:[vt[M.id]?.length>0?vt[M.id].map(J=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:J.authorPhotoURL?r.jsx("img",{src:J.authorPhotoURL,alt:""}):r.jsx("span",{children:Zc(J.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:J.authorName}),J.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),J.replyToName]}),J.content&&r.jsx("span",{className:"journey-comment-text",children:In(J.content)}),J.imageURL&&r.jsx("img",{className:"journey-comment-image",src:J.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Hp(J.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>$(Ne=>({...Ne,[M.id]:{id:J.id,authorName:J.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Wn(M.id,J.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},J.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Bs[M.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Bs[M.id].authorName})]}),r.jsx("button",{onClick:()=>$(J=>({...J,[M.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Se[M.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:Se[M.id],alt:"Preview"}),r.jsx("button",{onClick:()=>Gn(M.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>Je.current[M.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:J=>{Je.current[M.id]=J},type:"file",accept:"image/*",onChange:J=>Sn(M.id,J),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:_s[M.id]||"",onChange:J=>cr(M.id,J.target.value),onKeyDown:J=>{J.key==="Enter"&&$n(M.id)},maxLength:300}),j&&P===M.id&&me.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:me.map(J=>r.jsxs("button",{className:"mention-option",onClick:()=>Qr(J,M.id),children:[r.jsx("div",{className:"mention-option-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:""}):r.jsx("span",{children:Zc(J.name)})}),r.jsx("span",{children:J.name})]},J.id))}),r.jsx("button",{onClick:()=>$n(M.id),disabled:!(_s[M.id]||"").trim()&&!xe[M.id]||as[M.id],children:as[M.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},M.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),os&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Yt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:M=>M.stopPropagation(),children:[r.jsx("img",{src:os.img,alt:os.name,className:`cb-badge-overlay-img${ht.includes(os.id)?"":" cb-badge-overlay-img-locked"}`}),ht.includes(os.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Yt(null),children:"Tap to close"})]})}),r.jsx(la,{active:"home"}),Ut&&r.jsxs("div",{className:`toast-notification ${Ut.type}`,children:[Ut.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Ut.message]}),r.jsx(vD,{steps:cs,active:Ze,onFinish:be}),Ct&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>yt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(M,J)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][J%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},J))}),r.jsxs("div",{className:"cb-celebration-content",onClick:M=>M.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:Ct.img,alt:Ct.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:Ct.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>yt(null),children:"Tap to continue"})]})]})]})})}const $p=new Map;function Gi(){return new Date().toISOString().split("T")[0]}const E2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],TD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function ED(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function SD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Sa(),p=Jn(),[g,y]=v.useState("loading"),[_,x]=v.useState(null),[T,V]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[W,z]=v.useState(null),[U,Z]=v.useState(Gi()),[K,se]=v.useState({entries:[],water:0}),[he,Me]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[we,C]=v.useState(!1),[E,R]=v.useState(!1),[O,I]=v.useState(()=>{const j=new Date;return{year:j.getFullYear(),month:j.getMonth()}}),[H,D]=v.useState(ED),[Ue,lt]=v.useState(null),[B,re]=v.useState(null),[Te,Ve]=v.useState(!1),[ee,L]=v.useState(null),[ae,De]=v.useState(""),[Pe,Ke]=v.useState(!1),[Be,gt]=v.useState(""),[Nt,ct]=v.useState([]),[Zt,Vs]=v.useState(!1),[ft,ht]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ce,os]=v.useState(null),[Yt,Ct]=v.useState("100"),[yt,st]=v.useState(0),[He,zt]=v.useState("weight"),[Ns,$s]=v.useState(0),[Dt,Tt]=v.useState(null);v.useRef(null);const rs=v.useRef(!1),As=v.useRef(null),Ut=v.useRef(null),Xs=v.useRef(null),Pt=v.useCallback((j,N="info")=>{Tt({message:j,type:N}),setTimeout(()=>Tt(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await Rs(qe(pe,"nutritionTargets",t.id));N.exists()?(x(N.data()),y("dashboard")):y("setup")}catch(N){console.error("Error loading nutrition data:",N),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await Rs(qe(pe,"nutritionLogs",`${t.id}_${U}`));if(N.exists()){const P=N.data();se({entries:P.entries||[],water:P.water||0})}else se({entries:[],water:0})}catch(N){console.error("Error loading log:",N),se({entries:[],water:0})}})()},[t?.id,U]),v.useEffect(()=>{const j=K.entries.reduce((N,P)=>({protein:N.protein+(P.protein||0),carbs:N.carbs+(P.carbs||0),fats:N.fats+(P.fats||0),calories:N.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Me(j)},[K.entries]);const fs=async j=>{try{await Ss(qe(pe,"nutritionLogs",`${t.id}_${U}`),{clientId:t.id,date:U,entries:j.entries,water:j.water,updatedAt:wt.now()})}catch(N){console.error("Error saving nutrition log:",N)}},qt=U===Gi(),ve=(j,N)=>new Date(j,N+1,0).getDate(),G=(j,N)=>new Date(j,N,1).getDay(),de=["January","February","March","April","May","June","July","August","September","October","November","December"],Ee=["Su","Mo","Tu","We","Th","Fr","Sa"],Le=()=>{let j=parseFloat(T.weight);T.weightUnit==="lbs"&&(j*=.453592);let N;T.heightUnit==="cm"?N=parseFloat(T.height):N=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let F=T.gender==="male"?10*j+6.25*N-5*P+5:10*j+6.25*N-5*P-161;const Fe=F*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],ze={low:100,moderate:200,high:300,daily:400},tt=Math.round(Fe+ze[T.trainingFrequency]);let Ze=tt,es,js;switch(T.goal){case"lose":Ze=tt*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),es=2.2,js=.3;break;case"build":Ze=tt*1.1,es=2,js=.22;break;default:es=1.8,js=.25}Ze=Math.max(Ze,T.gender==="male"?1400:1100);const cs=Math.round(j*es),ls=Math.round(Ze*js/9),zs=Math.max(0,Math.round((Ze-cs*4-ls*9)/4));z({calories:Math.round(Ze),protein:cs,carbs:zs,fats:ls,bmr:Math.round(F),neat:Math.round(Fe),exerciseAdd:ze[T.trainingFrequency],tdee:Math.round(tt)})},_e=async()=>{if(W)try{const j={clientId:t.id,calories:W.calories,protein:W.protein,carbs:W.carbs,fats:W.fats,waterGoal:8,goal:T.goal,updatedAt:wt.now()};await Ss(qe(pe,"nutritionTargets",t.id),j),x(j),y("dashboard"),Pt("Macro targets saved!","success")}catch(j){console.error("Error saving targets:",j),Pt("Failed to save targets. Please try again.","error")}},Ye=()=>{const j=T.weight&&parseFloat(T.weight)>0,N=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return j&&N&&P},at="nut_favourite_foods",Y=()=>{try{return JSON.parse(localStorage.getItem(at)||"[]")}catch{return[]}},ne=j=>Y().some(N=>N.name.toLowerCase()===(j||"").toLowerCase()),$e=j=>{const N=Y(),P=N.findIndex(F=>F.name.toLowerCase()===j.name.toLowerCase());P>=0?N.splice(P,1):N.unshift({name:j.name,protein:j.protein,carbs:j.carbs,fats:j.fats,calories:j.calories,serving:j.serving,per100g:j.per100g||null,servingUnit:j.servingUnit||"g",portion:j.portion||null}),localStorage.setItem(at,JSON.stringify(N)),$s(F=>F+1)},We=j=>{const N=[...K.entries,{...j,meal:H,id:Date.now(),addedAt:new Date().toISOString()}],P={...K,entries:N};se(P),fs(P),re(null),os(null),Ct("100"),st(0),zt("weight"),ht({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Pt("Food added!","success")},rt=j=>{const N=K.entries.filter(F=>F.id!==j),P={...K,entries:N};se(P),fs(P)},pt=v.useRef(null),vt=async()=>{Ve(!0);const j=document.querySelector("#barcode-reader");if(!j){Ve(!1),Pt("Scanner container not found.","error");return}if(!pt.current)try{const P=await Rr(()=>import("./quagga.min-BbicSfvA.js").then(F=>F.q),[]);pt.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),Ve(!1),Pt("Could not load scanner.","error");return}const N=pt.current;N.init({inputStream:{type:"LiveStream",target:j,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),Ve(!1),Pt("Could not access camera. Check permissions.","error");return}N.start(),rs.current=!0}),N.onDetected(P=>{const F=P.codeResult.decodedCodes?.filter(Fe=>Fe.error!==void 0)?.map(Fe=>Fe.error)||[];if((F.length>0?F.reduce((Fe,ze)=>Fe+ze,0)/F.length:1)<.15){const Fe=P.codeResult.code;N.offDetected(),L(Fe)}})},Rt=()=>{const j=pt.current;rs.current&&j&&(j.stop(),j.offDetected(),rs.current=!1),Ve(!1)},_s=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Ws=j=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((j||"").replace(/\s/g,"")),as=j=>{if(!j)return{value:100,unit:"g"};const N=j.toLowerCase().replace(/\s/g,""),P=N.match(/([\d.]+)/),F=P?parseFloat(P[1]):100;return Ws(j)?/cl/.test(N)?{value:F*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(N)&&!/ml/.test(N)?{value:F*1e3,unit:"ml"}:{value:F,unit:"ml"}:{value:F,unit:"g"}},ks=j=>{if(Ws(j.serving_size)||Ws(j.quantity))return"ml";const N=j.product_name||j.product_name_en||"";return _s.test(N)?"ml":"g"},Bs=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],$=(j,N)=>{const P=j||"",F=P.match(/\((\d+\.?\d*)\s*g\)/i),me=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(F&&me){const tt=parseFloat(F[1]);let Ze=me[1].replace(/^\d+\s*/,"").trim();if(Ze&&tt>0)return{label:Ze,weight:tt}}const Fe=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Fe){const tt=parseFloat(Fe[1]);let Ze=Fe[2].replace(/^\d+\s*/,"").trim();if(Ze&&tt>0)return{label:Ze,weight:tt}}const ze=N||"";for(const{pattern:tt,label:Ze,weight:es}of Bs)if(tt.test(ze))return{label:Ze,weight:es};return null},xe=j=>{const N=j.nutriments||{},P=ks(j),F=as(j.serving_size),me=P==="ml"?F.unit==="ml"?F.value:100:F.value,Fe=j.product_name||j.product_name_en||"Unknown Product",ze=$(j.serving_size,Fe);return{name:Fe,brand:j.brands||"",image:j.image_small_url||j.image_url||null,servingSize:j.serving_size||"100g",servingValue:me,servingUnit:P,portion:ze,protein:Math.round(N.proteins_100g||N.proteins||0),carbs:Math.round(N.carbohydrates_100g||N.carbohydrates||0),fats:Math.round(N.fat_100g||N.fat||0),calories:Math.round(N["energy-kcal_100g"]||N["energy-kcal"]||(N.energy_100g?N.energy_100g/4.184:0)),per100g:!0}},Ce=async j=>{Ke(!0);try{const N=`https://world.openfoodfacts.org/api/v2/product/${j}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(N);if(!P.ok)throw new Error(`HTTP ${P.status}`);const F=await P.json();if(F.status==="success"||F.status===1||F.product){const me=xe(F.product);me.calories===0&&me.protein===0&&me.carbs===0?Pt("Product found but no nutrition data available.","error"):(os(me),me.portion?(st(1),Ct(String(me.portion.weight)),zt("portion")):(st(0),Ct(String(me.servingValue||100)),zt("weight")),De(""))}else Pt("Product not found. Try search or manual entry.","error")}catch(N){console.error("Barcode lookup error:",N),Pt("Failed to look up product. Check your connection.","error")}Ke(!1)},Se=(j,N,P)=>{const F=j.toLowerCase().trim(),me=N.toLowerCase().trim(),Fe=P.toLowerCase().trim();let ze=0;return(F===Fe||F===Fe+"s"||F+"s"===Fe)&&(ze+=100),(F.endsWith(" "+Fe)||F.endsWith(" "+Fe+"s"))&&(ze+=40),(F.startsWith(Fe+" ")||F.startsWith(Fe+"s "))&&(ze+=15),Fe.split(/\s+/).some(Ze=>me===Ze||me.startsWith(Ze))&&(ze+=30),ze+=Math.max(0,30-F.length),ze},ke=async()=>{if(!Be.trim())return;As.current&&As.current.abort();const j=new AbortController;As.current=j;const N=Be.trim().toLowerCase(),P=N.split(/\s+/).filter(Boolean);if($p.has(N)){ct($p.get(N));return}Vs(!0);try{const me=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Be.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Fe=await fetch(me,{signal:j.signal});if(!Fe.ok)throw new Error(`HTTP ${Fe.status}`);const tt=((await Fe.json()).products||[]).map(Ze=>xe(Ze)).filter(Ze=>Ze.name!=="Unknown Product"&&(Ze.calories>0||Ze.protein>0)).filter(Ze=>{const es=(Ze.name+" "+Ze.brand).toLowerCase();return P.every(js=>es.includes(js))}).sort((Ze,es)=>Se(es.name,es.brand,N)-Se(Ze.name,Ze.brand,N)).slice(0,10);$p.set(N,tt),ct(tt),tt.length===0&&Pt("No results found. Try a different search.","info")}catch(F){if(F.name==="AbortError")return;console.error("Search error:",F),Pt("Search failed. Check your connection.","error")}Vs(!1)};v.useEffect(()=>{if(Ut.current&&clearTimeout(Ut.current),!(!Be.trim()||B!=="search"||ce))return Ut.current=setTimeout(()=>{ke()},700),()=>clearTimeout(Ut.current)},[Be]);const ot=()=>{const j={...K,water:K.water+1};se(j),fs(j)},bt=()=>{if(K.water<=0)return;const j={...K,water:K.water-1};se(j),fs(j)},Je={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},_t=80,jt=2*Math.PI*_t,Cs=(j,N,P,F,me)=>{const Fe=F>0?Math.min(100,Math.round(P/F*100)):0,ze=jt-Fe/100*jt,tt=Je[me]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:_t}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:_t,style:{stroke:tt},strokeDasharray:jt,strokeDashoffset:ze})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:tt},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",F,j==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:tt},children:N})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:tt},children:[Fe,"%"]})]})};if(v.useEffect(()=>{if(!ee)return;const j=setTimeout(()=>{const N=ee;Rt(),L(null),Ce(N)},1500);return()=>clearTimeout(j)},[ee]),v.useEffect(()=>()=>{const j=pt.current;if(rs.current&&j){try{j.stop(),j.offDetected()}catch{}rs.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{V(j=>({...j,gender:"male"})),z(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{V(j=>({...j,gender:"female"})),z(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:j=>{V(N=>({...N,age:j.target.value})),z(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:j=>{V(N=>({...N,weight:j.target.value})),z(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{V(j=>({...j,weightUnit:"kg"})),z(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{V(j=>({...j,weightUnit:"lbs"})),z(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:j=>{V(N=>({...N,height:j.target.value})),z(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:j=>{V(N=>({...N,heightFeet:j.target.value})),z(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:j=>{V(N=>({...N,heightInches:j.target.value})),z(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{V(j=>({...j,heightUnit:"cm"})),z(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{V(j=>({...j,heightUnit:"ft"})),z(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:j=>{V(N=>({...N,dailyActivity:j.target.value})),z(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:j=>{V(N=>({...N,trainingFrequency:j.target.value})),z(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{V(j=>({...j,goal:"lose"})),z(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{V(j=>({...j,goal:"maintain"})),z(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{V(j=>({...j,goal:"build"})),z(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{V(j=>({...j,deficitLevel:"light"})),z(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{V(j=>({...j,deficitLevel:"moderate"})),z(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{V(j=>({...j,deficitLevel:"harsh"})),z(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Le,disabled:!Ye(),children:"Calculate Macros"})]}),W&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[Cs("Protein","Protein",W.protein,W.protein,"ring-protein"),Cs("Carbs","Carbs",W.carbs,W.carbs,"ring-carbs"),Cs("Fats","Fats",W.fats,W.fats,"ring-fats"),Cs("Calories","Calories",W.calories,W.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[W.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[W.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",W.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[W.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:_e,children:"Set as My Daily Targets"})]})]}),Dt&&r.jsx("div",{className:`toast-notification ${Dt.type}`,children:Dt.message})]});const un=j=>{const N=new Date(j+"T12:00:00"),P=N.getDay(),F=new Date(N);F.setDate(N.getDate()-(P+6)%7);const me=[];for(let Fe=0;Fe<7;Fe++){const ze=new Date(F);ze.setDate(F.getDate()+Fe),me.push(ze.toISOString().split("T")[0])}return me},fn=["M","T","W","T","F","S","S"],kn=(j,N="search")=>{D(j),N==="scan"?(re("scan"),os(null)):N==="manual"?(re("manual"),ht({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):N==="favourites"?re("favourites"):(re("search"),ct([]),gt(""))},Mn=un(U),pn=new Date(U+"T12:00:00"),Fs=`${de[pn.getMonth()]} ${pn.getFullYear()}`;return r.jsx(ja,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),z(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const j=new Date(U+"T12:00:00");j.setDate(j.getDate()-7);const N=j.toISOString().split("T")[0];Z(N)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!we),I({year:pn.getFullYear(),month:pn.getMonth()})},children:Fs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const j=new Date(U+"T12:00:00");j.setDate(j.getDate()+7);const N=j.toISOString().split("T")[0];N<=Gi()&&Z(N)},"aria-label":"Next week",disabled:Mn[6]>=Gi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:Mn.map((j,N)=>{const P=new Date(j+"T12:00:00").getDate(),F=j===U,me=j>Gi(),Fe=j===Gi();return r.jsxs("button",{className:`nut-week-day${F?" selected":""}${Fe?" today":""}${me?" future":""}`,disabled:me,onClick:()=>Z(j),children:[r.jsx("span",{className:"nut-week-day-letter",children:fn[N]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},j)})})]}),we&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>I(j=>{let N=j.month-1,P=j.year;return N<0&&(N=11,P--),{year:P,month:N}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[de[O.month]," ",O.year]}),r.jsx("button",{onClick:()=>I(j=>{let N=j.month+1,P=j.year;return N>11&&(N=0,P++),{year:P,month:N}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ee.map(j=>r.jsx("span",{children:j},j))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(G(O.year,O.month))].map((j,N)=>r.jsx("span",{},`e${N}`)),[...Array(ve(O.year,O.month))].map((j,N)=>{const P=N+1,F=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,me=F>Gi(),Fe=F===U,ze=F===Gi();return r.jsx("button",{className:`nut-cal-day${Fe?" selected":""}${ze?" today":""}${me?" future":""}`,disabled:me,onClick:()=>{Z(F),C(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Cs("Protein","Protein",he.protein,_.protein,"ring-protein"),Cs("Carbs","Carbs",he.carbs,_.carbs,"ring-carbs"),Cs("Fats","Fats",he.fats,_.fats,"ring-fats"),Cs("Calories","kCal",he.calories,_.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[qt&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>R(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",_?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:E2.map(j=>{const N=K.entries.filter(F=>(F.meal||"snacks")===j.key),P=N.reduce((F,me)=>({protein:F.protein+(me.protein||0),carbs:F.carbs+(me.carbs||0),fats:F.fats+(me.fats||0),calories:F.calories+(me.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${j.key}`,children:TD[j.key]}),r.jsx("span",{className:"nut-meal-card-title",children:j.label}),N.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),qt&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>lt(Ue===j.key?null:j.key),"aria-label":`Add to ${j.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),N.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,_.protein>0?P.protein/_.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,_.carbs>0?P.carbs/_.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,_.fats>0?P.fats/_.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,_.calories>0?P.calories/_.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),N.length>0&&r.jsx("div",{className:"nut-log-list",children:N.map(F=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:F.name}),F.serving&&r.jsx("span",{className:"nut-log-item-serving",children:F.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[F.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[F.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[F.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:F.calories})]}),qt&&r.jsx("button",{className:"nut-log-delete",onClick:()=>rt(F.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},F.id))}),N.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:qt?"Tap + to add food":"No entries"})})]},j.key)})})})]})}),Ue&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>lt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",E2.find(j=>j.key===Ue)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const j=Ue;lt(null),kn(j,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const j=Ue;lt(null),kn(j,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const j=Ue;lt(null),kn(j,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const j=Ue;lt(null),kn(j,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>R(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>R(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(_?.waterGoal||8)].map((j,N)=>r.jsx("div",{className:`nut-water-glass ${N<K.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:N<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},N))}),r.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",_?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:bt,disabled:K.water<=0,children:"-"}),r.jsx("button",{onClick:ot,children:"+"})]})]})]})}),B&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Rt(),L(null),re(null),os(null)},children:r.jsxs("div",{className:"nut-modal",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:B==="scan"?"Scan Barcode":B==="search"?"Search Food":B==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{Rt(),L(null),re(null),os(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B==="scan"&&!ce&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Te&&!ee&&r.jsx("div",{className:"nut-scan-line"}),ee&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:ee})]})]}),!Te&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:vt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Te&&!ee&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:ae,onChange:j=>De(j.target.value),onKeyDown:j=>j.key==="Enter"&&ae.trim()&&Ce(ae.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>ae.trim()&&Ce(ae.trim()),disabled:!ae.trim()||Pe,children:Pe?"...":"Look Up"})]})]}),B==="scan"&&ce&&(()=>{const j=ce.servingUnit||"g",N=ce.portion,P=He==="portion"&&N?yt*N.weight:parseFloat(Yt)||0,F=P/100,me=j==="ml"?[100,200,250,500]:[50,100,150,200],Fe=He==="portion"&&N?`${yt} ${N.label}${yt!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[ce.image&&r.jsx("img",{src:ce.image,alt:ce.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ce.name)?" active":""}`,onClick:()=>$e({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ce.brand&&r.jsx("p",{className:"nut-product-brand",children:ce.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:He==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&st(1)},children:"Portions"}),r.jsxs("button",{className:He==="weight"?"active":"",onClick:()=>{zt("weight"),Ct(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),He==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(Math.max(1,yt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:yt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,yt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(yt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Yt,onChange:ze=>Ct(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Yt===String(ze)?" active":""}`,onClick:()=>Ct(String(ze)),children:[ze,j]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*F),"p / ",Math.round(ce.carbs*F),"c / ",Math.round(ce.fats*F),"f / ",Math.round(ce.calories*F)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{os(null),re("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>We({name:ce.name,protein:Math.round(ce.protein*F),carbs:Math.round(ce.carbs*F),fats:Math.round(ce.fats*F),calories:Math.round(ce.calories*F),serving:Fe}),children:"Add"})]})]})})(),B==="search"&&!ce&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Xs,value:Be,onChange:j=>gt(j.target.value),onKeyDown:j=>{j.key==="Enter"&&(clearTimeout(Ut.current),ke())},onFocus:()=>setTimeout(()=>Xs.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ke,disabled:Zt,children:Zt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[Nt.map((j,N)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{os(j),j.portion?(st(1),Ct(String(j.portion.weight)),zt("portion")):(st(0),Ct(String(j.servingValue||100)),zt("weight"))},children:[j.image&&r.jsx("img",{src:j.image,alt:j.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:j.name}),j.brand&&r.jsx("span",{className:"nut-search-item-brand",children:j.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[j.calories," cal  ",j.protein,"p  ",j.carbs,"c  ",j.fats,"f per 100",j.servingUnit||"g"]})]})]},N)),Nt.length===0&&Be&&!Zt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),B==="search"&&ce&&(()=>{const j=ce.servingUnit||"g",N=ce.portion,P=He==="portion"&&N?yt*N.weight:parseFloat(Yt)||0,F=P/100,me=j==="ml"?[100,200,250,500]:[50,100,150,200],Fe=He==="portion"&&N?`${yt} ${N.label}${yt!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[ce.image&&r.jsx("img",{src:ce.image,alt:ce.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ce.name)?" active":""}`,onClick:()=>$e({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ce.brand&&r.jsx("p",{className:"nut-product-brand",children:ce.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:He==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&st(1)},children:"Portions"}),r.jsxs("button",{className:He==="weight"?"active":"",onClick:()=>{zt("weight"),Ct(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),He==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(Math.max(1,yt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:yt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,yt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(yt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Yt,onChange:ze=>Ct(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Yt===String(ze)?" active":""}`,onClick:()=>Ct(String(ze)),children:[ze,j]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*F),"p / ",Math.round(ce.carbs*F),"c / ",Math.round(ce.fats*F),"f / ",Math.round(ce.calories*F)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>os(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>We({name:ce.name,protein:Math.round(ce.protein*F),carbs:Math.round(ce.carbs*F),fats:Math.round(ce.fats*F),calories:Math.round(ce.calories*F),serving:Fe}),children:"Add"})]})]})})(),B==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:ft.name,onChange:j=>ht(N=>({...N,name:j.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:ft.serving,onChange:j=>ht(N=>({...N,serving:j.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:ft.protein,onChange:j=>ht(N=>({...N,protein:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:ft.carbs,onChange:j=>ht(N=>({...N,carbs:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:ft.fats,onChange:j=>ht(N=>({...N,fats:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:ft.calories,onChange:j=>ht(N=>({...N,calories:j.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!ft.name.trim(),onClick:()=>We({name:ft.name,protein:parseFloat(ft.protein)||0,carbs:parseFloat(ft.carbs)||0,fats:parseFloat(ft.fats)||0,calories:parseFloat(ft.calories)||0,serving:ft.serving||""}),children:"Add Food"})]}),B==="favourites"&&!ce&&(()=>{const j=Y(),N=P=>{if(P.per100g){const F=P.per100g;os({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:F.protein,carbs:F.carbs,fats:F.fats,calories:F.calories,per100g:!0}),P.portion?(st(1),Ct(String(P.portion.weight)),zt("portion")):(st(0),Ct("100"),zt("weight"))}else We({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:j.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:j.map((P,F)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:me=>{me.stopPropagation(),$e(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>N(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},F))})})})(),B==="favourites"&&ce&&(()=>{const j=ce.servingUnit||"g",N=ce.portion,P=He==="portion"&&N?yt*N.weight:parseFloat(Yt)||0,F=P/100,me=j==="ml"?[100,200,250,500]:[50,100,150,200],Fe=He==="portion"&&N?`${yt} ${N.label}${yt!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ce.name)?" active":""}`,onClick:()=>$e({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:He==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&st(1)},children:"Portions"}),r.jsxs("button",{className:He==="weight"?"active":"",onClick:()=>{zt("weight"),Ct(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),He==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(Math.max(1,yt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:yt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,yt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>st(yt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Yt,onChange:ze=>Ct(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Yt===String(ze)?" active":""}`,onClick:()=>Ct(String(ze)),children:[ze,j]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*F),"p / ",Math.round(ce.carbs*F),"c / ",Math.round(ce.fats*F),"f / ",Math.round(ce.calories*F)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>os(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>We({name:ce.name,protein:Math.round(ce.protein*F),carbs:Math.round(ce.carbs*F),fats:Math.round(ce.fats*F),calories:Math.round(ce.calories*F),serving:Fe}),children:"Add"})]})]})})()]})}),r.jsx(la,{active:"nutrition"}),Dt&&r.jsx("div",{className:`toast-notification ${Dt.type}`,children:Dt.message})]})})}async function sb(n){const{type:e="workout",title:t="Workout Complete!",subtitle:i,stats:l=[],quote:u,userName:d,badges:p=[]}=n,g=1080,y=1080,_=document.createElement("canvas");_.width=g,_.height=y;const x=_.getContext("2d"),T=e!=="badge",V=T?"#A12F3A":"#D4A017",W=T?"#c9485b":"#ffc107",z=x.createLinearGradient(0,0,g,y);T?(z.addColorStop(0,"#2d0a10"),z.addColorStop(.4,"#1a0608"),z.addColorStop(1,"#0d0304")):(z.addColorStop(0,"#2a1f00"),z.addColorStop(.4,"#1a1400"),z.addColorStop(1,"#0d0a00")),x.fillStyle=z,x.fillRect(0,0,g,y);const U=x.createRadialGradient(g/2,y*.38,60,g/2,y*.38,g*.55);U.addColorStop(0,T?"rgba(161, 47, 58, 0.25)":"rgba(212, 160, 23, 0.2)"),U.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=U,x.fillRect(0,0,g,y);const Z=60,K=70,se=g-120,he=y-140,Me=40;x.save(),x.shadowColor="rgba(0, 0, 0, 0.5)",x.shadowBlur=60,x.shadowOffsetY=12,Po(x,Z,K,se,he,Me),x.fillStyle="rgba(20, 20, 22, 0.92)",x.fill(),x.restore(),x.save(),Po(x,Z,K,se,he,Me),x.strokeStyle="rgba(255, 255, 255, 0.06)",x.lineWidth=1.5,x.stroke(),x.restore(),x.save(),Po(x,Z,K,se,5,{tl:Me,tr:Me,bl:0,br:0});const we=x.createLinearGradient(Z,0,Z+se,0);we.addColorStop(0,V),we.addColorStop(.5,W),we.addColorStop(1,V),x.fillStyle=we,x.fill(),x.restore();const C=72,E=g/2,R=K+130,O=x.createRadialGradient(E,R,C*.8,E,R,C*1.8);O.addColorStop(0,T?"rgba(161, 47, 58, 0.15)":"rgba(212, 160, 23, 0.12)"),O.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=O,x.fillRect(E-C*2,R-C*2,C*4,C*4),x.beginPath(),x.arc(E,R,C,0,Math.PI*2),x.fillStyle="rgba(255, 255, 255, 0.04)",x.fill(),x.beginPath(),x.arc(E,R,C,0,Math.PI*2),x.strokeStyle=W,x.lineWidth=3,x.stroke(),x.beginPath(),x.arc(E,R,C+6,0,Math.PI*2),x.strokeStyle="rgba(255, 255, 255, 0.08)",x.lineWidth=1,x.stroke();try{const Ue=await ND("/Logo.webp");x.save(),x.beginPath(),x.arc(E,R,C-4,0,Math.PI*2),x.clip();const lt=(C-4)*2;x.drawImage(Ue,E-C+4,R-C+4,lt,lt),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=W,x.font="bold 44px 'Montserrat', sans-serif",x.fillText("MCF",E,R)}let I=R+C+50;if(x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle="#ffffff",x.font="bold 50px 'Montserrat', sans-serif",x.fillText(t.toUpperCase(),g/2,I),i&&(I+=46,x.fillStyle="rgba(255, 255, 255, 0.55)",x.font="500 28px 'Montserrat', sans-serif",x.fillText(i,g/2,I)),I+=50,e==="badge"&&p.length>0){x.font="bold 26px 'Montserrat', sans-serif";const Ue=52,lt=32,B=14,re=p.map(ee=>x.measureText(ee).width+lt*2),Te=re.reduce((ee,L)=>ee+L,0)+B*(p.length-1);let Ve=(g-Te)/2;for(let ee=0;ee<p.length;ee++){const L=re[ee];Po(x,Ve,I,L,Ue,Ue/2),x.fillStyle=T?"rgba(161, 47, 58, 0.2)":"rgba(212, 160, 23, 0.15)",x.fill(),Po(x,Ve,I,L,Ue,Ue/2),x.strokeStyle=T?"rgba(161, 47, 58, 0.5)":"rgba(255, 193, 7, 0.35)",x.lineWidth=1.5,x.stroke(),x.fillStyle=W,x.font="bold 26px 'Montserrat', sans-serif",x.fillText(p[ee],Ve+L/2,I+Ue/2+9),Ve+=L+B}I+=Ue+20}else if(l.length>0){const B=Math.min(220,(se-80-16*(l.length-1))/l.length),re=B*l.length+16*(l.length-1);let Te=(g-re)/2;for(let Ve=0;Ve<l.length;Ve++)Po(x,Te,I,B,90,18),x.fillStyle="rgba(255, 255, 255, 0.05)",x.fill(),Po(x,Te,I,B,90,18),x.strokeStyle="rgba(255, 255, 255, 0.08)",x.lineWidth=1,x.stroke(),x.fillStyle="#ffffff",x.font="bold 44px 'Montserrat', sans-serif",x.fillText(String(l[Ve].value),Te+B/2,I+42),x.fillStyle="rgba(255, 255, 255, 0.4)",x.font="600 18px 'Montserrat', sans-serif",x.fillText(l[Ve].label.toUpperCase(),Te+B/2,I+72),Te+=B+16;I+=100}u&&(I+=30,x.fillStyle="rgba(255, 255, 255, 0.28)",x.font="italic 24px 'Montserrat', sans-serif",x.fillText(`${u}`,g/2,I));const H=K+he-40;x.strokeStyle="rgba(255, 255, 255, 0.06)",x.lineWidth=1,x.beginPath(),x.moveTo(Z+60,H-24),x.lineTo(Z+se-60,H-24),x.stroke(),x.fillStyle="rgba(255, 255, 255, 0.3)",x.font="600 20px 'Montserrat', sans-serif";const D=[d,"Mind Core Fitness"].filter(Boolean);return x.fillText(D.join("    "),g/2,H),new Promise(Ue=>{_.toBlob(lt=>Ue(lt),"image/png")})}function Po(n,e,t,i,l,u){const d=typeof u=="number"?{tl:u,tr:u,br:u,bl:u}:{tl:0,tr:0,br:0,bl:0,...u};n.beginPath(),n.moveTo(e+d.tl,t),n.lineTo(e+i-d.tr,t),n.quadraticCurveTo(e+i,t,e+i,t+d.tr),n.lineTo(e+i,t+l-d.br),n.quadraticCurveTo(e+i,t+l,e+i-d.br,t+l),n.lineTo(e+d.bl,t+l),n.quadraticCurveTo(e,t+l,e,t+l-d.bl),n.lineTo(e,t+d.tl),n.quadraticCurveTo(e,t,e+d.tl,t),n.closePath()}function ND(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}const CD=700,Ig=42,Pl=2*Math.PI*Ig,S2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Dg({title:n,subtitle:e,stats:t,onDone:i,onShareJourney:l,userName:u,buttonLabel:d="Done"}){const[p,g]=v.useState("hold"),[y,_]=v.useState(!1),[x,T]=v.useState(!1),[V,W]=v.useState(!1),[z,U]=v.useState(null),Z=v.useRef(null),K=v.useRef(null),se=v.useRef(null),he=v.useRef(!1),Me=v.useRef(!1),we=v.useRef(S2[Math.floor(Math.random()*S2.length)]),C=v.useRef([...Array(80)].map((B,re)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][re%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:re%3}))),E=v.useCallback(()=>{if(he.current)return;he.current=!0,Me.current=!1,_(!0),se.current=performance.now(),Z.current&&(Z.current.style.strokeDashoffset=Pl);const B=re=>{const Te=re-se.current,Ve=Math.min(Te/CD,1);Z.current&&(Z.current.style.strokeDashoffset=Pl-Ve*Pl),Ve<1?K.current=requestAnimationFrame(B):(he.current=!1,Me.current=!0,K.current=null,_(!1),navigator.vibrate&&navigator.vibrate(50),g("celebrate"))};K.current=requestAnimationFrame(B)},[]),R=v.useCallback(()=>{he.current&&(he.current=!1,K.current&&(cancelAnimationFrame(K.current),K.current=null),Z.current&&(Z.current.style.strokeDashoffset=Pl),_(!1))},[]),O=v.useCallback(()=>{T(!0),setTimeout(()=>{i?.()},300)},[i]),I=v.useCallback(()=>{const B=[n||"Workout Complete!"];return e&&B.push(e),t?.length&&B.push(t.map(re=>`${re.value} ${re.label}`).join(" | ")),B.push("#MindCoreFitness"),B.join(`
`)},[n,e,t]),H=v.useCallback(async()=>{if(!(V||!l))try{await l({type:"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:we.current}),W(!0),U("Posted to Journey!"),setTimeout(()=>U(null),2500)}catch{U("Failed to post"),setTimeout(()=>U(null),2500)}},[V,l,n,e,t]),[D,Ue]=v.useState(!1),lt=v.useCallback(async()=>{Ue(!0);try{const B=await sb({type:"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:we.current,userName:u}),re=I();if(navigator.share&&navigator.canShare?.({files:[new File([B],"workout.png",{type:"image/png"})]})){const Te=new File([B],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:re,files:[Te]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:re}):(await navigator.clipboard.writeText(re),U("Copied to clipboard!"),setTimeout(()=>U(null),2500))}catch{try{await navigator.clipboard.writeText(I()),U("Copied to clipboard!"),setTimeout(()=>U(null),2500)}catch{}}finally{Ue(!1)}},[n,e,t,u,I]);return p==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("h2",{className:"wc-hold-title",children:"You Crushed It!"}),e&&r.jsx("p",{className:"wc-hold-subtitle",children:e}),t&&t.length>0&&r.jsx("div",{className:"wc-hold-stats",children:t.map((B,re)=>r.jsxs("div",{className:"wc-hold-stat",children:[r.jsx("span",{className:"wc-hold-stat-val",children:B.value}),r.jsx("span",{className:"wc-hold-stat-label",children:B.label})]},re))}),r.jsx("p",{className:"wc-hold-hint",children:"Hold to finish"}),r.jsxs("div",{className:`wc-hold-ring-touch ${y?"wc-holding":""}`,onPointerDown:B=>{B.preventDefault(),E()},onPointerUp:R,onPointerLeave:R,onPointerCancel:R,onClick:B=>{B.stopPropagation(),Me.current&&(Me.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:B=>{(B.key==="Enter"||B.key===" ")&&(B.preventDefault(),g("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Ig}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:Z,cx:"50",cy:"50",r:Ig,style:{strokeDasharray:Pl,strokeDashoffset:Pl}})]}),r.jsx("div",{className:"wc-hold-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M5 3h14v2h3v4a3 3 0 0 1-3 3h-1.07A7.001 7.001 0 0 1 13 16.93V20h3v2H8v-2h3v-3.07A7.001 7.001 0 0 1 5.07 12H5a3 3 0 0 1-3-3V5h3V3zm0 4H4v2a1 1 0 0 0 1 1V7zm14 0v3a1 1 0 0 0 1-1V7h-1z"})})})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${x?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:C.current.map((B,re)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${B.shape}`,style:{"--x":`${B.x}%`,"--delay":`${B.delay}s`,"--color":B.color,"--drift":`${B.drift}px`,"--spin":`${B.spin}deg`,"--duration":`${B.duration}s`,width:`${B.width}px`,height:`${B.height}px`}},re))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:we.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((B,re)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:B.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:B.label})]},re))}),r.jsxs("div",{className:"wc-share-row",children:[l&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${V?"wc-share-done":""}`,onClick:H,disabled:V,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),V?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:lt,disabled:D,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),D?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:O,children:d}),z&&r.jsx("div",{className:"wc-share-toast",children:z})]})]})}const N2="/login/assets/randomiser-glq9YJkL.jpg",RD="/login/assets/programme-card-workout-CnNzTYkz.webp",AD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",MD="/login/assets/mg-arms-BeOQU3wx.jpg",ID=60,Wp=5,DD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],PD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},LD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},OD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Gp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Kp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:AD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],eu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:MD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],C2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},R2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Yp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ll=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Qp=[5,10,15,20,30];function VD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function BD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function UD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Sa(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=_m(),_=Jn(),[x,T]=v.useState("menu"),[V,W]=v.useState(["bodyweight"]),[z,U]=v.useState("core"),[Z,K]=v.useState("intermediate"),[se,he]=v.useState(p?15:5),[Me,we]=v.useState([]),[C,E]=v.useState(!1),R=v.useRef(!1),O=v.useRef([]),[I,H]=v.useState([]),[D,Ue]=v.useState(2),[lt,B]=v.useState(Ll[1]),[re,Te]=v.useState(1),[Ve,ee]=v.useState(0),[L,ae]=v.useState("work"),[De,Pe]=v.useState(0),[Ke,Be]=v.useState(!1),[gt,Nt]=v.useState(0),[ct,Zt]=v.useState(!1),[Vs,ft]=v.useState(!1),[ht,ce]=v.useState(null),os=v.useRef(null);v.useRef(null),v.useRef(null);const[Yt,Ct]=v.useState(null),yt=v.useCallback((X,be="info")=>{Ct({message:X,type:be}),setTimeout(()=>Ct(null),3e3)},[]),st=v.useCallback(async X=>{if(!t)return;const be=X&&typeof X=="object"&&X.type;await wa(Bt(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:be?"":X,type:be?X.type:"text",imageURL:null,createdAt:Tr(),likeCount:0,commentCount:0,...be?{metadata:{title:X.title,subtitle:X.subtitle,stats:X.stats,quote:X.quote,badges:X.badges}}:{}})},[t]),[He,zt]=v.useState(null),[Ns,$s]=v.useState(null),[Dt,Tt]=v.useState(0),[rs,As]=v.useState(0),[Ut,Xs]=v.useState([]),[Pt,fs]=v.useState(""),[qt,ve]=v.useState(""),[G,de]=v.useState(!1),[Ee,Le]=v.useState(0),[_e,Ye]=v.useState(!1),[at,Y]=v.useState({}),ne=v.useRef(null),$e=v.useRef(null),[We,rt]=v.useState([]),[pt,vt]=v.useState(null),[Rt,_s]=v.useState(0),[Ws,as]=v.useState(0),[ks,Bs]=v.useState(0),[$,xe]=v.useState(0),[Ce,Se]=v.useState(0),[ke,ot]=v.useState(0),[bt,Je]=v.useState({beginner:0,intermediate:0,advanced:0}),_t=p?Qp:Qp.filter(X=>g.includes(X)),jt=!p&&Rt>=y,[Cs,un]=v.useState(null),[fn,kn]=v.useState(""),[Mn,pn]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&_("/")},[n,e,i,_]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const be=Bt(pe,"workoutLogs"),ge=Ds(be,ms("clientId","==",t.id)),Qe=(await Es(ge)).docs.map(Qt=>Qt.data()),ut=Qe.filter(Qt=>Qt.type!=="programme");xe(ut.length);const Ht=ut.reduce((Qt,Js)=>Qt+(Js.duration||0),0);Se(Ht);const $t={beginner:0,intermediate:0,advanced:0};ut.forEach(Qt=>{Qt.level&&$t[Qt.level]!==void 0&&$t[Qt.level]++}),Je($t);const Vt=new Date,Tn=Vt.getDay(),At=Tn===0?-6:1-Tn,Ps=new Date(Vt);Ps.setDate(Vt.getDate()+At),Ps.setHours(0,0,0,0);const gn=Ps.getTime(),En=Qe.filter(Qt=>{const Js=Qt.completedAt;return Js?(Js.toDate?Js.toDate().getTime():new Date(Js).getTime())>=gn:!1});_s(En.filter(Qt=>Qt.type!=="programme").length);let Fn=0;if(t)try{const Qt=await Rs(qe(pe,"clientProgrammes",t.id));if(Qt.exists()){const Js=Qt.data(),dn=Js.templateId;Fn=En.filter(Sn=>Sn.type==="programme"&&Sn.programmeId===dn).length,un(dn);const $n=Kp.find(Sn=>Sn.id===dn);$n&&kn($n.name);const Wn=LD[dn];if(Wn){const Sn=Object.keys(Js.completedSessions||{}).length,Gn=Wn.duration*Wn.daysPerWeek;Bs(Gn>0?Math.round(Sn/Gn*100):0)}}else un(null),kn(""),Bs(0)}catch{}as(Fn);const yr=ut.map(Qt=>Qt.completedAt).filter(Boolean).map(Qt=>Qt.toDate?Qt.toDate().getTime():new Date(Qt).getTime()).sort((Qt,Js)=>Js-Qt);if(yr.length===0)ot(0);else{const Qt=new Set;yr.forEach(Gn=>{const lr=new Date(Gn),cr=lr.getDay(),M=cr===0?-6:1-cr,J=new Date(lr);J.setDate(lr.getDate()+M),J.setHours(0,0,0,0),Qt.add(J.getTime())});const Js=[...Qt].sort((Gn,lr)=>lr-Gn);let dn=0;const $n=new Date(Vt),Wn=Vt.getDay()===0?-6:1-Vt.getDay();$n.setDate(Vt.getDate()+Wn),$n.setHours(0,0,0,0);let Sn=$n.getTime();Js.includes(Sn)||(Sn-=10080*60*1e3);for(let Gn=0;Gn<200&&Js.includes(Sn);Gn++)dn++,Sn-=10080*60*1e3;ot(dn)}}catch(be){console.error("Error loading workout stats:",be)}finally{pn(!0)}})()},[n,t,x]);const Fs=()=>{const X=[];let be;z==="mix"?be=["core","upper","lower"]:z==="fullbody"?be=["upper","lower"]:be=[z];for(const ge of V)for(const Xe of be)X.push(`exercises/${ge}/${Xe}`);return X},j=async()=>{if(R.current){for(;R.current;)await new Promise(X=>setTimeout(X,200));return O.current}R.current=!0,E(!0);try{const X=Fs(),be=[];for(const ut of X)try{const Ht=eo(to,ut),$t=await j2(Ht);be.push(...$t.items)}catch{console.warn(`Folder ${ut} not found, skipping.`)}if(be.length===0&&V.includes("bodyweight")&&z==="core")try{const ut=eo(to,"core"),Ht=await j2(ut);be.push(...Ht.items)}catch{console.warn("Legacy core/ folder not found either.")}if(be.length===0){const ut=V.map($t=>R2.find(Vt=>Vt.key===$t)?.label).join(" + "),Ht=Yp.find($t=>$t.key===z)?.label;return yt(`No exercises found for ${ut} / ${Ht}. Upload videos to Firebase Storage.`,"error"),R.current=!1,E(!1),[]}const ge=new Set,Xe=be.filter(ut=>{const Ht=ut.name.replace(/\.(mp4|gif)$/i,"");return ge.has(Ht)?!1:(ge.add(Ht),!0)}),Qe=await Promise.all(Xe.map(async ut=>{const Ht=await Ho(ut),$t=VD(ut.name.replace(/\.(mp4|gif)$/i,"")),Vt=/\.gif$/i.test(ut.name);return{name:$t,videoUrl:Ht,isGif:Vt}}));return O.current=Qe,we(Qe),R.current=!1,E(!1),Qe}catch(X){console.error("Error loading exercises:",X);const be=X.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${X.message||X.code||"Unknown error"}`;return yt(be,"error"),R.current=!1,E(!1),[]}},N=async()=>{if(jt)return;T("spinning"),O.current=[];const X=await j();if(X.length===0){T("setup");return}const be=Ll.find(Tn=>Tn.key===Z);B(be);const ge=be.work+be.rest,Xe=se*60,Qe=Math.floor(Xe/ge);let ut,Ht;Qe<=6?(ut=Math.max(3,Math.floor(Qe/2)),Ht=Math.floor(Qe/ut)):Qe<=12?(ut=Math.min(6,Math.floor(Qe/2)),Ht=Math.floor(Qe/ut)):(ut=Math.min(10,Math.floor(Qe/2)),Ht=Math.floor(Qe/ut)),Ht=Math.max(2,Ht);const $t=BD(X),Vt=$t.slice(0,Math.min(ut,$t.length));H(Vt),Ue(Ht),setTimeout(()=>T("preview"),2e3)},P=()=>{T("countdown"),Nt(3)};v.useEffect(()=>{if(x!=="countdown")return;if(gt<=0){T("workout"),Te(1),ee(0),ae("work"),Pe(lt.work),Be(!1),or();return}jn();const X=setTimeout(()=>Nt(be=>be-1),1e3);return()=>clearTimeout(X)},[gt,x]),v.useEffect(()=>{if(x!=="workout"||Ke)return;if(De<=0){F();return}De<=3&&jn();const X=setTimeout(()=>Pe(be=>be-1),1e3);return()=>clearTimeout(X)},[De,x,Ke]);const F=()=>{if(L==="work")ae("rest"),Pe(lt.rest);else{const X=Ve+1;if(X>=I.length){const be=re+1;if(be>D){Zt(!0),me();return}Te(be),ee(0)}else ee(X);ae("work"),Pe(lt.work),or()}},me=async()=>{if(n)try{await wa(Bt(pe,"workoutLogs"),{clientId:t.id,level:Z,duration:se,equipment:V,focus:z,exerciseCount:I.length,rounds:D,exercises:I.map(X=>X.name),completedAt:wt.now()}),_s(X=>X+1),xe(X=>X+1),Se(X=>X+se),Je(X=>({...X,[Z]:(X[Z]||0)+1}))}catch(X){console.error("Error saving workout log:",X)}},Fe=async(X,be,ge)=>{if(!(!t||!be))try{const Xe=t.id,Qe=await Rs(qe(pe,"coreBuddyPBs",Xe)),Ht=(Qe.exists()?Qe.data():null)?.exercises||{},$t=Ht[X];let Vt=!1;if($t?(be>($t.weight||0)||be===($t.weight||0)&&ge>($t.reps||0))&&(Vt=!0):Vt=!0,Vt){const Tn={...Ht,[X]:{weight:be,reps:ge,achievedAt:wt.now()}};await Ss(qe(pe,"coreBuddyPBs",Xe),{clientId:t.id,exercises:Tn,updatedAt:wt.now()}),yt(`New PB! ${be}kg  ${ge} reps`,"success"),jn(),await ze(X,be)}}catch(Xe){console.error("Error checking PB:",Xe)}},ze=async(X,be)=>{if(t)try{const ge=await Rs(qe(pe,"coreBuddyTargets",t.id));if(!ge.exists())return;const Qe=(ge.data().targets||{})[X];if(!Qe||be<Qe.targetWeight)return;const ut=await Rs(qe(pe,"coreBuddyAchievements",t.id)),Ht=ut.exists()?ut.data():{clientId:t.id,badges:[],totalVolume:0};if(Ht.badges.some(At=>At.type==="pb_target"&&At.exercise===X&&At.targetWeight===Qe.targetWeight))return;const Vt={type:"pb_target",exercise:X,group:PD[X]||"push",targetWeight:Qe.targetWeight,achievedAt:wt.now()},Tn=[...Ht.badges,Vt];await Ss(qe(pe,"coreBuddyAchievements",t.id),{...Ht,badges:Tn,updatedAt:wt.now()}),rt(At=>[...At,Vt])}catch(ge){console.error("Error checking target badge:",ge)}},tt=async X=>{if(!(!t||X<=0))try{const be=await Rs(qe(pe,"coreBuddyAchievements",t.id)),ge=be.exists()?be.data():{clientId:t.id,badges:[],totalVolume:0},Xe=ge.totalVolume||0,Qe=Xe+X,ut=[];DD.forEach($t=>{Qe>=$t.threshold&&Xe<$t.threshold&&(ge.badges.some(Tn=>Tn.type==="volume_milestone"&&Tn.milestone===$t.threshold)||ut.push({type:"volume_milestone",milestone:$t.threshold,label:$t.label,achievedAt:wt.now()}))});const Ht=[...ge.badges,...ut];await Ss(qe(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Ht,totalVolume:Math.round(Qe),updatedAt:wt.now()}),ut.length>0&&rt($t=>[...$t,...ut])}catch(be){console.error("Error updating volume:",be)}},Ze=async X=>{if($s(X),X.interval){const Xe=[];for(const Qe of X.exercises){let ut=null,Ht=!1;if(Qe.storagePath)try{const $t=eo(to,Qe.storagePath);ut=await Ho($t),Ht=/\.gif$/i.test(Qe.storagePath)}catch{}Xe.push({name:Qe.name,videoUrl:ut,isGif:Ht})}H(Xe),Ue(X.rounds),B({work:X.work,rest:X.rest}),T("preview");return}const be={};for(const Xe of X.exercises)if(Xe.storagePath)try{const Qe=eo(to,Xe.storagePath);be[Xe.name]={url:await Ho(Qe),isGif:/\.gif$/i.test(Xe.storagePath)}}catch{}Y(be);const ge=X.exercises.map(Xe=>({name:Xe.name,type:Xe.type,targetSets:Xe.sets,targetReps:Xe.reps||0,targetTime:Xe.time||0,sets:[]}));Xs(ge),Tt(0),As(0),fs(""),ve(""),Ye(!1),de(!1),Le(0),rt([]),vt(null),T("muscle_workout")},es=()=>{const X=ne.current;X&&(X.paused?(X.play(),Ye(!0)):(X.pause(),Ye(!1)))};v.useEffect(()=>{if(x!=="muscle_workout"||!G||Ee<=0){x==="muscle_workout"&&G&&Ee<=0&&(de(!1),jn());return}return $e.current=setTimeout(()=>Le(X=>X-1),1e3),()=>clearTimeout($e.current)},[x,G,Ee]);const js=async()=>{const X=Ut[Dt];let be={};if(X.type==="weighted"){const Qe=parseFloat(Pt)||0,ut=parseInt(qt)||0;if(ut===0){yt("Enter your reps","error");return}be={weight:Qe,reps:ut}}else if(X.type==="reps"){const Qe=parseInt(qt)||0;if(Qe===0){yt("Enter your reps","error");return}be={reps:Qe}}else if(X.type==="timed"){const Qe=X.targetTime-Ee;be={time:Math.max(Qe,1)}}const ge=[...Ut];ge[Dt]={...X,sets:[...X.sets,be]},Xs(ge),X.type==="weighted"&&be.weight>0&&await Fe(X.name,be.weight,be.reps);const Xe=X.sets.length+1;if(Xe<X.targetSets)As(Xe),ve(""),de(!1),Le(0);else if(Dt+1<Ut.length){const Qe=Dt+1;Tt(Qe),As(0),fs(""),ve(""),Ye(!1),de(!1),Le(0)}else await cs(ge),ft(!0)},cs=async X=>{if(!(!n||!t))try{const be=X.reduce((Xe,Qe)=>Xe+Qe.sets.reduce((ut,Ht)=>ut+(Ht.weight||0)*(Ht.reps||0),0),0),ge=X.reduce((Xe,Qe)=>Xe+Qe.sets.length,0);await wa(Bt(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:He,sessionId:Ns?.id,sessionName:Ns?.name,exerciseCount:X.length,totalSets:ge,duration:Math.round(ge*1.5),volume:Math.round(be),exercises:X.map(Xe=>({name:Xe.name,type:Xe.type,sets:Xe.sets})),completedAt:wt.now()}),be>0&&await tt(be),We.length>0&&vt({badges:[...We]})}catch(be){console.error("Error saving muscle group workout log:",be)}},ls=v.useRef(null),zs=()=>(ls.current||(ls.current=new(window.AudioContext||window.webkitAudioContext)),ls.current),jn=()=>{try{const X=zs(),be=X.createOscillator(),ge=X.createGain();be.connect(ge),ge.connect(X.destination),be.frequency.value=880,ge.gain.value=.3,be.start(X.currentTime),be.stop(X.currentTime+.15)}catch{}},or=()=>{try{const X=zs(),be=X.createOscillator(),ge=X.createGain();be.connect(ge),ge.connect(X.destination),be.frequency.value=1200,ge.gain.value=.4,be.start(X.currentTime),be.stop(X.currentTime+.3)}catch{}};v.useEffect(()=>{if(x!=="workout"||L!=="work"||!I[Ve]?.isGif)return;const be=setInterval(()=>{const ge=os.current;if(!ge)return;const Xe=ge.getAttribute("src");ge.removeAttribute("src"),setTimeout(()=>{os.current&&os.current.setAttribute("src",Xe)},0)},4e3);return()=>clearInterval(be)},[x,L,Ve,re,I]);const us=(X,be,ge)=>{const Xe=Math.round(X/be*ID);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:nD.map((Qe,ut)=>r.jsx("line",{x1:Qe.x1,y1:Qe.y1,x2:Qe.x2,y2:Qe.y2,className:ut<Xe?`wk-tick-filled ${ge}`:"wk-tick-empty",strokeWidth:Qe.thick?"3":"2"},ut))})},Qr=()=>{const X=I.length*D;return((re-1)*I.length+Ve+(L==="rest"?.5:0))/X},In=Yt&&r.jsx("div",{className:`toast-notification ${Yt.type}`,children:Yt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>_("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(x==="menu")return r.jsx(ja,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>_("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:N2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Kp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Kp.map((X,be)=>X.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>_("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${be*.06}s`},children:[r.jsx("img",{src:X.image,alt:X.name,className:"wk-prog-img"}),be===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>_("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${be*.06}s`},children:[r.jsx("img",{src:RD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:OD[X.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[X.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:X.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:X.name.toUpperCase()}),r.jsxs("p",{children:[X.daysPerWeek,"x per week  ",X.focus==="fullbody"?"Full Body":X.focus.charAt(0).toUpperCase()+X.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),be===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>_("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[eu.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:eu.map((X,be)=>r.jsx("button",{className:`wk-muscle-hero-card${X.image?" wk-muscle-thumb":""}`,onClick:()=>{zt(X.key),T("muscle_sessions")},style:{animationDelay:`${be*.05}s`},children:X.image?r.jsx("img",{src:X.image,alt:X.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:N2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Gp[X.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:X.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[C2[X.key]?.length||0," sessions"]})]})]})]})},X.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>_("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(la,{active:"workouts"}),In]})});if(x==="setup"){const X=Yp.find(ge=>ge.key===z)?.label||z,be=Ll.find(ge=>ge.key===Z)?.label||Z;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${$}`,pct:$>0?Math.min(Math.round($/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Rt}/${Wp}`,pct:Math.round(Math.min(Rt,Wp)/Wp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${ke}`,pct:ke>0?Math.min(Math.round(ke/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ge=>{const Qe=2*Math.PI*38,ut=Qe-ge.pct/100*Qe;return r.jsxs("div",{className:`wk-stat-item${ge.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ge.color},strokeDasharray:Qe,strokeDashoffset:ut})]}),r.jsx("span",{className:"wk-stat-value",style:{color:ge.color},children:ge.value})]}),r.jsx("span",{className:"wk-stat-label",children:ge.label})]},ge.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Yp.map(ge=>r.jsxs("button",{className:`wk-equip-btn${z===ge.key?" active":""}${ge.key==="mix"?" wk-mix-btn":""}`,onClick:()=>U(ge.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ge.icon})}),r.jsx("span",{children:ge.label})]},ge.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ll.map(ge=>r.jsxs("button",{className:`wk-level-card wk-level-${ge.key}${Z===ge.key?" active":""}`,onClick:()=>K(ge.key),children:[r.jsx("span",{className:"wk-level-name",children:ge.label}),r.jsx("span",{className:"wk-level-desc",children:ge.desc})]},ge.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Qp.map(ge=>{const Xe=!_t.includes(ge);return r.jsxs("button",{className:`wk-time-btn${se===ge?" active":""}${Xe?" locked":""}`,onClick:()=>!Xe&&he(ge),disabled:Xe,children:[r.jsx("span",{className:"wk-time-num",children:ge}),r.jsx("span",{className:"wk-time-unit",children:Xe?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},ge)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:R2.map(ge=>{const Xe=V.includes(ge.key);return r.jsxs("button",{className:`wk-equip-btn${Xe?" active":""}`,onClick:()=>{W(Qe=>Xe&&Qe.length===1?Qe:Xe?Qe.filter(ut=>ut!==ge.key):[...Qe,ge.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ge.icon})}),r.jsx("span",{children:ge.label})]},ge.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[X,"  ",be,"  ",se," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[jt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:N,disabled:C||jt,children:C?"Loading exercises...":jt?"Limit Reached":"Randomise Workout"})]}),In]})}if(x==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:qk.map((X,be)=>r.jsx("line",{x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,className:"wk-spin-tick",strokeWidth:X.thick?"3.5":"2",style:{animationDelay:`${be*.03}s`}},be))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),In]});if(x==="preview"){const X=Ns?.interval?{work:Ns.work,rest:Ns.rest}:Ll.find(ge=>ge.key===Z),be=I.length*D*(X.work+X.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(Ns?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Ns?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Ns.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(be/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[X.work,"/",X.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:I.map((ge,Xe)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Xe*.06}s`},onClick:()=>ce(ge),children:[r.jsx("span",{className:"wk-preview-num",children:Xe+1}),r.jsx("div",{className:"wk-preview-thumb",children:ge.isGif?r.jsx("img",{src:ge.videoUrl,alt:ge.name,loading:"lazy"}):r.jsx("video",{src:`${ge.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:ge.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Xe))}),ht&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>ce(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:ge=>ge.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>ce(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:ht.isGif?r.jsx("img",{src:ht.videoUrl,alt:ht.name}):r.jsx("video",{src:ht.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:ht.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Ns?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>N(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:P,children:"Start Workout"})]})]})]})}if(x==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:gt}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(x==="workout"){const X=I[Ve],be=L==="work"?lt.work:lt.rest,ge=L==="rest"?Ve+1<I.length?I[Ve+1]:re<D?I[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?X.isGif?r.jsx("img",{ref:os,className:"wk-video",src:X.videoUrl,alt:X.name},X.videoUrl):r.jsx("video",{className:"wk-video",src:X.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},X.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),ge&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",ge.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Ve+1," / ",I.length]}),r.jsx("h2",{className:"wk-exercise-name",children:X.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",re," of ",D]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[us(De,be,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:De}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Be(!Ke),children:Ke?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Pe(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${Qr()*100}%`}})}),ct&&(()=>{const Xe=Ll.find(ut=>ut.key===Z),Qe=I.length*D*(Xe.work+Xe.rest);return r.jsx(Dg,{title:"Workout Complete!",stats:[{value:Math.ceil(Qe/60),label:"Minutes"},{value:I.length*D,label:"Intervals"},{value:D,label:"Rounds"}],onShareJourney:st,userName:t?.name,onDone:()=>{Zt(!1),$s(null),zt(null),T("menu")}})})()]})}if(x==="muscle_sessions"){const X=eu.find(ge=>ge.key===He),be=C2[He]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Gp[He]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X?.icon})})}),r.jsxs("h2",{children:[X?.label," Workouts"]}),r.jsxs("p",{children:[be.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:be.map((ge,Xe)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{$s(ge),T("muscle_overview")},style:{animationDelay:`${Xe*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:ge.name}),r.jsx("p",{children:ge.desc}),r.jsx("div",{className:"mg-session-meta",children:ge.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[ge.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[ge.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[ge.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Qe=ge.exercises.map($t=>$t.sets||0),ut=Math.min(...Qe),Ht=Math.max(...Qe);return ut===Ht?`${ut} sets each`:`${ut}-${Ht} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ge.id))})]}),In]})}if(x==="muscle_overview"){const X=Ns;if(!X)return null;const be=eu.find(ge=>ge.key===He);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Gp[He]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:be?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:X.name}),X.level&&r.jsx("span",{className:"mg-overview-level",children:X.level})]}),r.jsx("p",{className:"mg-overview-desc",children:X.desc})]}),X.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:X.overview})]}),X.tips&&X.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:X.tips.map((ge,Xe)=>r.jsx("li",{children:ge},Xe))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",X.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:X.exercises.map((ge,Xe)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Xe+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:ge.name}),X.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[X.work,"s work / ",X.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[ge.sets," sets  ",ge.reps?`${ge.reps} reps`:`${ge.time}s`,ge.type==="weighted"&&"  weighted"]})]})]},Xe))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Ze(X),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),In]})}if(x==="muscle_workout"){const X=Ns;if(!X)return null;const be=X.exercises[Dt],ge=Ut[Dt];if(!be||!ge)return null;const Xe=ge.sets.length,Qe=X.exercises.length,ut=X.exercises.reduce((At,Ps)=>At+(Ps.sets||0),0),$t=Ut.reduce((At,Ps)=>At+Ps.sets.length,0)/ut*100,Vt=at[be.name];be.type==="timed"&&Ee===0&&!G&&Xe===rs&&setTimeout(()=>Le(be.time),0);const Tn=Xe+1<be.sets?"Log Set":Dt+1<Qe?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${$t}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Dt+1,"/",Qe]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[Vt?r.jsxs("div",{className:"mg-video-container",onClick:es,children:[Vt.isGif?r.jsx("img",{className:"mg-video",src:Vt.url,alt:be.name}):r.jsx("video",{ref:ne,className:"mg-video",src:Vt.url,loop:!0,muted:!0,playsInline:!0},be.name),!_e&&!Vt.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:be.name}),r.jsx("span",{className:`mg-ex-type-badge ${be.type}`,children:be.type==="weighted"?"Weight + Reps":be.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Xe+1," of ",be.sets]}),be.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",be.reps," reps"]}),be.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",be.time,"s"]})]}),be.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Pt,onChange:At=>fs(At.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:qt,onChange:At=>ve(At.target.value),placeholder:"0"})]})]}),be.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:qt,onChange:At=>ve(At.target.value),placeholder:"0"})]})}),be.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Ee,"s"]})}),G?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>de(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Ee===0&&Le(be.time),de(!0)},children:Ee<be.time&&Ee>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:js,children:Tn}),ge.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:ge.sets.map((At,Ps)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Ps+1,": ",At.weight!=null?`${At.weight}kg  ${At.reps}`:At.reps!=null?`${At.reps} reps`:`${At.time}s`]})]},Ps))})]})]}),In,Vs&&(()=>{const At=Ut.reduce((Fn,yr)=>Fn+yr.sets.length,0),Ps=Ut.reduce((Fn,yr)=>Fn+yr.sets.reduce((Qt,Js)=>Qt+(Js.weight||0)*(Js.reps||0),0),0),gn=eu.find(Fn=>Fn.key===He)?.label||"",En=[{value:Ut.length,label:"Exercises"},{value:At,label:"Sets"}];return Ps>0&&En.push({value:Math.round(Ps).toLocaleString(),label:"Volume (kg)"}),r.jsx(Dg,{title:`${gn} Complete!`,subtitle:Ns?.name,stats:En,onShareJourney:st,userName:t?.name,onDone:()=>{ft(!1),$s(null),zt(null),vt(null),T("menu")}})})(),pt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>vt(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:pt.badges.length===1?"Badge Earned!":`${pt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:pt.badges.map((At,Ps)=>r.jsx("div",{className:"mg-badge-celebration-item",children:At.type==="pb_target"?`${At.exercise}  ${At.targetWeight}kg`:At.label},Ps))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async At=>{At.stopPropagation();const Ps=pt.badges.map(gn=>gn.type==="pb_target"?`PB Target Hit: ${gn.exercise}  ${gn.targetWeight}kg`:gn.label);await st({type:"badge_earned",title:pt.badges.length===1?"Badge Earned!":`${pt.badges.length} Badges Earned!`,badges:Ps}),yt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async At=>{At.stopPropagation();const Ps=pt.badges.map(En=>En.type==="pb_target"?`PB Target Hit: ${En.exercise}  ${En.targetWeight}kg`:En.label),gn=`Badge Earned! ${Ps.join(", ")}
#MindCoreFitness`;try{const En=await sb({type:"badge",title:"Badge Earned!",badges:Ps,userName:t?.name});navigator.share&&navigator.canShare?.({files:[new File([En],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:gn,files:[new File([En],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:gn}):(await navigator.clipboard.writeText(gn),yt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(gn),yt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const FD=60,zD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},qD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],A2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function ch(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const HD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function $D(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Sa(),p=Jn(),g=Ea(),[y,_]=v.useState("loading"),[x,T]=v.useState(null),V=v.useRef(!1),[W,z]=v.useState(null),[U,Z]=v.useState(!1),[K,se]=v.useState(1),[he,Me]=v.useState(0),[we,C]=v.useState(0),[E,R]=v.useState(0),[O,I]=v.useState([]),[H,D]=v.useState(""),[Ue,lt]=v.useState(""),[B,re]=v.useState(!1),[Te,Ve]=v.useState(0),ee=v.useRef(null),[L,ae]=v.useState({}),[De,Pe]=v.useState(!1),Ke=v.useRef(null),[Be,gt]=v.useState(null),[Nt,ct]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[Zt,Vs]=v.useState(null),ft=v.useCallback((ve,G="info")=>{Vs({message:ve,type:G}),setTimeout(()=>Vs(null),4e3)},[]),ht=v.useCallback(async ve=>{if(!t)return;const G=ve&&typeof ve=="object"&&ve.type;await wa(Bt(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:G?"":ve,type:G?ve.type:"text",imageURL:null,createdAt:Tr(),likeCount:0,commentCount:0,...G?{metadata:{title:ve.title,subtitle:ve.subtitle,stats:ve.stats,quote:ve.quote,badges:ve.badges}}:{}})},[t]),ce=v.useRef(null),os=()=>(ce.current||(ce.current=new(window.AudioContext||window.webkitAudioContext)),ce.current),Yt=()=>{try{const ve=os(),G=ve.createOscillator(),de=ve.createGain();G.connect(de),de.connect(ve.destination),G.frequency.value=1200,de.gain.value=.4,G.start(ve.currentTime),G.stop(ve.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const G=qe(pe,"clientProgrammes",t.id),de=await Rs(G);de.exists()&&z(de.data());const Ee=g.state?.templateId;if(Ee&&!V.current){const Le=A2.find(_e=>_e.id===Ee);if(Le){V.current=!0,T(Le),_("overview");return}}de.exists()?_("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(G){console.error("Error loading programme:",G),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!B||Te<=0){B&&Te<=0&&(re(!1),Yt());return}return ee.current=setTimeout(()=>Ve(ve=>ve-1),1e3),()=>clearTimeout(ee.current)},[B,Te]);const Ct=async ve=>{if(t)try{await Ss(qe(pe,"clientProgrammes",t.id),ve),z(ve)}catch(G){console.error("Error saving programme:",G),ft("Failed to save. Check Firestore rules for clientProgrammes.","error")}},yt=async ve=>{const G={templateId:ve.id,startDate:wt.now(),completedSessions:{}};await Ct(G),_("dashboard")},st=async()=>{if(t)try{await Er(qe(pe,"clientProgrammes",t.id)),z(null),_("browse")}catch(ve){console.error("Error quitting programme:",ve)}},He=()=>W?A2.find(ve=>ve.id===W.templateId):null,zt=()=>{if(!W?.startDate)return 1;const ve=W.startDate.toDate?W.startDate.toDate():new Date(W.startDate),de=new Date-ve,Ee=Math.floor(de/(1e3*60*60*24));return Math.floor(Ee/7)+1},Ns=()=>{if(!W)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ve=W.completedSessions||{},G=Object.keys(ve).length,de=He();if(!de)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ee=de.duration*de.daysPerWeek,Le=zt(),_e=Math.min(Le,de.duration);let Ye=0;for(let Y=0;Y<de.daysPerWeek;Y++)ve[`w${_e}d${Y}`]&&Ye++;if(G>=Ee)return{currentWeek:de.duration,completedThisWeek:de.daysPerWeek,nextDay:-1,totalCompleted:G,totalSessions:Ee,complete:!0};if(Le>de.duration)return{currentWeek:de.duration,completedThisWeek:Ye,nextDay:-1,totalCompleted:G,totalSessions:Ee,complete:!0};let at=-1;for(let Y=0;Y<de.daysPerWeek;Y++)if(!ve[`w${_e}d${Y}`]){at=Y;break}return{currentWeek:_e,completedThisWeek:Ye,nextDay:at,nextWeek:_e,totalCompleted:G,totalSessions:Ee}},$s=ve=>{const G=zt();return ve<G},Dt=(ve,G,de)=>{if(!W||ve<=1)return null;const Ee=`w${ve-1}d${G}`,Le=W.completedSessions?.[Ee];if(!Le)return null;const _e=Le.exercises?.find(Ye=>Ye.name===de);return _e?.sets?.length?_e.sets[_e.sets.length-1]:null},Tt=(ve,G)=>{const de=He();if(!de)return;se(ve),Me(G),C(0),R(0),I([]),lt(""),re(!1),Ve(0),Pe(!1),ae({});const Ee=de.days[G],Le=Ee.exercises.map(Y=>{const ne=ch(Y,ve,de);return{name:Y.name,type:Y.type,pbKey:Y.pbKey,targetSets:ne.sets,targetReps:ne.reps,targetTime:ne.time,sets:[]}});I(Le);const _e=Ee.exercises[0],Ye=Dt(ve,G,_e.name);Ye?.weight&&_e.type==="weighted"?D(String(Ye.weight)):D(""),(async()=>{const Y={};for(const ne of Ee.exercises)if(ne.storagePath)try{const $e=eo(to,ne.storagePath),We=await Ho($e);Y[ne.name]={url:We,isGif:/\.gif$/i.test(ne.storagePath)}}catch($e){console.warn(`Video not found for ${ne.name}:`,$e)}ae(Y)})(),_("session")},rs=async()=>{He();const ve=O[we];if(!ve)return;let G={};if(ve.type==="weighted"){const Le=parseFloat(H)||0,_e=parseInt(Ue)||0;if(_e===0){ft("Enter your reps","error");return}G={weight:Le,reps:_e}}else if(ve.type==="reps"){const Le=parseInt(Ue)||0;if(Le===0){ft("Enter your reps","error");return}G={reps:Le}}else if(ve.type==="timed"){const Le=ve.targetTime-Te;G={time:Math.max(Le,1)}}const de=[...O];de[we]={...ve,sets:[...ve.sets,G]},I(de),ve.type==="weighted"&&G.weight>0&&await Xs(ve.name,G.weight,G.reps);const Ee=ve.sets.length+1;if(Ee<ve.targetSets)R(Ee),D(G.weight?String(G.weight):""),lt(""),re(!1),Ve(0);else if(we+1<O.length){const Le=we+1;C(Le),R(0),Pe(!1);const Ye=He()?.days[he]?.exercises[Le],at=Dt(K,he,Ye?.name);at?.weight&&Ye?.type==="weighted"?D(String(at.weight)):D(""),lt(""),re(!1),Ve(0)}else await As(de)},As=async ve=>{if(!W||!t)return;const G=`w${K}d${he}`,de={...W.completedSessions,[G]:{completedAt:new Date().toISOString(),exercises:ve.map(_e=>({name:_e.name,type:_e.type,sets:_e.sets}))}},Ee={...W,completedSessions:de};await Ct(Ee);const Le=ve.reduce((_e,Ye)=>_e+Ye.sets.reduce((at,Y)=>at+(Y.weight||0)*(Y.reps||0),0),0);Le>0&&await Ut(Le);try{const _e=He();await wa(Bt(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:_e?.id,programmeName:_e?.name,week:K,day:he+1,exerciseCount:ve.length,duration:Math.round(ve.reduce((Ye,at)=>Ye+at.sets.length*1.5,0)),volume:Math.round(Le),completedAt:wt.now()})}catch(_e){console.error("Error saving workout log:",_e)}Nt.length>0&&(gt({badges:[...Nt]}),ct([])),Z(!0)},Ut=async ve=>{if(t)try{const G=await Rs(qe(pe,"coreBuddyAchievements",t.id)),de=G.exists()?G.data():{clientId:t.id,badges:[],totalVolume:0},Ee=de.totalVolume||0,Le=Ee+ve,_e=[];qD.forEach(at=>{Le>=at.threshold&&Ee<at.threshold&&(de.badges.some(ne=>ne.type==="volume_milestone"&&ne.milestone===at.threshold)||_e.push({type:"volume_milestone",milestone:at.threshold,label:at.label,achievedAt:wt.now()}))});const Ye=[...de.badges,..._e];await Ss(qe(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Ye,totalVolume:Math.round(Le),updatedAt:wt.now()}),_e.length>0&&ct(at=>[...at,..._e])}catch(G){console.error("Error updating volume:",G)}},Xs=async(ve,G,de)=>{if(t)try{const Ee=t.id,Le=await Rs(qe(pe,"coreBuddyPBs",Ee)),Ye=(Le.exists()?Le.data():null)?.exercises||{},at=Ye[ve];let Y=!1;if(at?(G>(at.weight||0)||G===(at.weight||0)&&de>(at.reps||0))&&(Y=!0):Y=!0,Y){const ne={...Ye,[ve]:{weight:G,reps:de,achievedAt:wt.now()}};await Ss(qe(pe,"coreBuddyPBs",Ee),{clientId:t.id,exercises:ne,updatedAt:wt.now()}),ft(`New PB! ${G}kg  ${de} reps`,"success"),Yt(),await Pt(ve,G)}}catch(Ee){console.error("Error checking PB:",Ee)}},Pt=async(ve,G)=>{if(t)try{const de=await Rs(qe(pe,"coreBuddyTargets",t.id));if(!de.exists())return;const Le=(de.data().targets||{})[ve];if(!Le||G<Le.targetWeight)return;const _e=await Rs(qe(pe,"coreBuddyAchievements",t.id)),Ye=_e.exists()?_e.data():{clientId:t.id,badges:[],totalVolume:0};if(Ye.badges.some($e=>$e.type==="pb_target"&&$e.exercise===ve&&$e.targetWeight===Le.targetWeight))return;const Y={type:"pb_target",exercise:ve,group:zD[ve]||"push",targetWeight:Le.targetWeight,achievedAt:wt.now()},ne=[...Ye.badges,Y];await Ss(qe(pe,"coreBuddyAchievements",t.id),{...Ye,badges:ne,updatedAt:wt.now()}),ct($e=>[...$e,Y])}catch(de){console.error("Error checking target badge:",de)}},fs=Zt&&r.jsxs("div",{className:`toast-notification ${Zt.type}`,children:[Zt.type==="success"&&r.jsx("span",{children:" "}),Zt.message]}),qt=(ve,G)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:G,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&x){const ve=x;return r.jsx(ja,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[qt(ve.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:HD[ve.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ve.name}),r.jsx("p",{className:"pg-overview-desc",children:ve.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.duration*ve.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ve.days.map((G,de)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:G.name}),r.jsx("span",{className:"pg-day-label",children:G.label})]}),r.jsx("div",{className:"pg-day-exercises",children:G.exercises.map((Ee,Le)=>{const _e=ch(Ee,1,ve);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Ee.name}),r.jsx("span",{className:"pg-day-ex-target",children:Ee.type==="timed"?`${_e.sets}${_e.time}s`:`${_e.sets}${_e.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ee.type}`,children:Ee.type==="weighted"?"WT":Ee.type==="timed"?"TMR":"BW"})]},Le)})})]},de))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ve.repProg," reps/week",ve.timeProg?`, +${ve.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>yt(ve),children:"Start Programme"})]}),fs]})})}if(y==="dashboard"){const ve=He();if(!ve)return _("browse"),null;const G=Ns(),de=W?.completedSessions||{},Ee=G.totalSessions?Math.round(G.totalCompleted/G.totalSessions*100):0;return Math.round(G.totalCompleted/(G.totalSessions||1)*FD),r.jsx(ja,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[qt("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ee/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Ee,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ve.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Ee,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",G.currentWeek," of ",ve.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ve.duration},(Le,_e)=>{const Ye=_e+1,at=$s(Ye);return r.jsxs("div",{className:`pg-week-row${Ye===G.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",Ye]}),r.jsx("div",{className:"pg-week-days",children:ve.days.map((Y,ne)=>{const $e=`w${Ye}d${ne}`,We=!!de[$e],rt=!We&&at,pt=!We&&!rt&&Ye===G.currentWeek&&!G.complete;return r.jsx("button",{className:`pg-day-dot${We?" done":""}${rt?" missed":""}${pt?" next":""}`,disabled:!pt,onClick:()=>{pt&&Tt(Ye,ne)},children:We?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):rt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:Y.name.replace("Day ","")})},ne)})})]},_e)})}),!G.complete&&(()=>{const Le=ve.days.map((_e,Ye)=>({day:_e,d:Ye})).filter(({d:_e})=>!de[`w${G.currentWeek}d${_e}`]);return Le.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Le.length===ve.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",G.currentWeek,"  ",Le.length," session",Le.length!==1?"s":""," left this week"]}),Le.map(({day:_e,d:Ye})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[_e.name,": ",_e.label]}),_e.exercises.map((at,Y)=>{const ne=ch(at,G.currentWeek,ve);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:at.name}),r.jsx("span",{className:"pg-next-ex-target",children:at.type==="timed"?`${ne.sets}${ne.time}s`:`${ne.sets}${ne.reps}`})]},Y)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>Tt(G.currentWeek,Ye),children:["Start ",_e.name]})]},Ye))]})})(),G.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",G.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:st,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&st()},children:"Quit Programme"})]}),r.jsx(la,{active:"workouts"}),fs]})})}if(y==="session"){const ve=He();if(!ve)return null;const G=ve.days[he],de=G.exercises[we],Ee=ch(de,K,ve),Le=O[we],_e=Le?.sets?.length||0,Ye=G.exercises.length,at=(we+_e/Ee.sets)/Ye,Y=L[de.name],ne=Dt(K,he,de.name);de.type==="timed"&&Te===0&&!B&&_e===E&&setTimeout(()=>Ve(Ee.time),0);const $e=()=>{Y?.isGif?Pe(!De):Ke.current&&(De?Ke.current.pause():Ke.current.play(),Pe(!De))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${at*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&_("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[we+1," / ",Ye]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",K,"  ",G.name]})]})]}),Y&&r.jsxs("div",{className:"pg-video-container",onClick:$e,children:[Y.isGif?r.jsx("img",{className:"pg-video",src:Y.url,alt:de.name}):r.jsx("video",{ref:Ke,className:"pg-video",src:Y.url,loop:!0,muted:!0,playsInline:!0},de.name),!De&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:de.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${de.type}`,children:de.type==="weighted"?"Weight + Reps":de.type==="timed"?"Timed":"Reps Only"}),de.type==="weighted"&&ne&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[ne.weight,"kg x ",ne.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",_e+1," of ",Ee.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",de.type==="timed"?`${Ee.time}s hold`:`${Ee.reps} reps`]})]}),de.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:H,onChange:We=>D(We.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ue,onChange:We=>lt(We.target.value),placeholder:String(Ee.reps),className:"pg-input"})]})]}),de.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ue,onChange:We=>lt(We.target.value),placeholder:String(Ee.reps),className:"pg-input"})]})}),de.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Te,"s"]})}),B?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>re(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Te===0&&Ve(Ee.time),re(!0)},children:Te<Ee.time&&Te>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:rs,disabled:de.type==="timed"&&B,children:_e+1<Ee.sets?"Log Set":we+1<Ye?"Log Set  Next Exercise":"Log Set  Complete"}),Le?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Le.sets.map((We,rt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",rt+1,": ",We.weight!==void 0?`${We.weight}kg  ${We.reps}`:We.time!==void 0?`${We.time}s`:`${We.reps} reps`]})]},rt))})]}),U&&(()=>{const rt=He()?.days[he],pt=O.reduce((_s,Ws)=>_s+Ws.sets.length,0),vt=O.reduce((_s,Ws)=>_s+Ws.sets.reduce((as,ks)=>as+(ks.weight||0)*(ks.reps||0),0),0),Rt=[{value:O.length,label:"Exercises"},{value:pt,label:"Sets"}];return vt>0&&Rt.push({value:Math.round(vt).toLocaleString(),label:"Volume (kg)"}),r.jsx(Dg,{title:"Session Complete!",subtitle:`Week ${K}  ${rt?.name}: ${rt?.label}`,stats:Rt,buttonLabel:"Back to Programme",onShareJourney:ht,userName:t?.name,onDone:()=>{Z(!1),_("dashboard")}})})(),Be&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>gt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:We=>We.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Be.badges.length===1?"Badge Earned!":`${Be.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Be.badges.map((We,rt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:We.type==="pb_target"?`${We.exercise}  ${We.targetWeight}kg`:We.label},rt))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async We=>{We.stopPropagation();const rt=Be.badges.map(pt=>pt.type==="pb_target"?`PB Target Hit: ${pt.exercise}  ${pt.targetWeight}kg`:pt.label);await ht({type:"badge_earned",title:Be.badges.length===1?"Badge Earned!":`${Be.badges.length} Badges Earned!`,badges:rt}),ft("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async We=>{We.stopPropagation();const rt=Be.badges.map(vt=>vt.type==="pb_target"?`PB Target Hit: ${vt.exercise}  ${vt.targetWeight}kg`:vt.label),pt=`Badge Earned! ${rt.join(", ")}
#MindCoreFitness`;try{const vt=await sb({type:"badge",title:"Badge Earned!",badges:rt,userName:t?.name});navigator.share&&navigator.canShare?.({files:[new File([vt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:pt,files:[new File([vt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:pt}):(await navigator.clipboard.writeText(pt),ft("Copied!","success"))}catch{try{await navigator.clipboard.writeText(pt),ft("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>gt(null),children:"Tap to dismiss"})]})}),fs]})}return null}const WD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},GD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Xp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function KD(n){return WD[n]||"push"}function YD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function QD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function XD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Sa(),p=Jn(),[g,y]=v.useState(!0),[_,x]=v.useState(null),[T,V]=v.useState({}),[W,z]=v.useState([]),[U,Z]=v.useState(null),[K,se]=v.useState(0),[he,Me]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[re,Te,Ve,ee]=await Promise.all([Rs(qe(pe,"coreBuddyAchievements",t.id)),Rs(qe(pe,"coreBuddyPBs",t.id)),Rs(qe(pe,"achievements",t.id)),Es(Ds(Bt(pe,"workoutLogs"),ms("clientId","==",t.id)))]);re.exists()&&x(re.data()),Te.exists()&&V(Te.data().exercises||{}),Ve.exists()&&(z(Object.keys(Ve.data().badges||{})),Me(Ve.data().progress||{})),se(ee.docs.length)}catch(re){console.error("Error loading achievements:",re)}y(!1)})()},[t]);const we=_?.badges||[],C=_?.totalVolume||0,E=we.filter(B=>B.type==="pb_target"),R=we.filter(B=>B.type==="volume_milestone"),O={push:[],pull:[],lower:[],core:[]};E.forEach(B=>{const re=B.group||KD(B.exercise);O[re]&&O[re].push(B)});const I=Xp.find(B=>C<B.threshold),H=Xp.filter(B=>C>=B.threshold).pop()?.threshold||0,D=I?(C-H)/(I.threshold-H):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const Ue=we.length+W.length,lt=Ue>0||C>0||K>0;return r.jsx(ja,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Ue}),r.jsx("span",{className:"ach-stat-label",children:Ue===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:YD(C)}),r.jsxs("span",{className:"ach-stat-label",children:[QD(C)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!lt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(B=>{const re=fu.filter(ee=>ee.category===B.key);if(re.length===0)return null;const Te=(()=>{switch(B.key){case"workouts":return K;case"streaks":return he.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return he.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return he.habitStreak||0;default:return 0}})(),Ve=re.filter(ee=>W.includes(ee.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:B.iconPath})}),B.title]}),r.jsx("div",{className:"ach-workout-carousel",children:re.map(ee=>{const L=W.includes(ee.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>Z(ee),children:[r.jsx("img",{src:ee.img,alt:ee.name,className:"ach-workout-badge-img"}),!L&&ee.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Te/ee.threshold*100,100)}%`}})})]},ee.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Ve,"/",re.length," unlocked"]})]},B.key)}),U&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>Z(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:B=>B.stopPropagation(),children:[r.jsx("img",{src:U.img,alt:U.name,className:`ach-badge-overlay-img${W.includes(U.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:U.desc}),W.includes(U.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>Z(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:qk.map((B,re)=>{const Te=re<Math.round(D*60);return r.jsx("line",{x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,className:Te?"ach-tick-filled":"ach-tick-empty",strokeWidth:B.thick?"3":"2"},re)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),I&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:I.label})," (",(I.threshold-C).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Xp.map((B,re)=>{const Te=C>=B.threshold,Ve=R.find(ee=>ee.milestone===B.threshold);return r.jsxs("div",{className:`ach-milestone ${Te?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:B.icon})}),r.jsx("span",{className:"ach-milestone-label",children:B.label}),Ve?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Ve.achievedAt.toDate?Ve.achievedAt.toDate():new Date(Ve.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},re)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(O).map(([B,re])=>{if(re.length===0)return null;const Te=GD[B];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Te.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Te.color},children:Te.label}),r.jsx("span",{className:"ach-group-count",children:re.length})]}),r.jsx("div",{className:"ach-badge-grid",children:re.map((Ve,ee)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ee*.06}s`,"--group-color":Te.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Te.color,boxShadow:`0 0 12px ${Te.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Te.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Te.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Ve.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Te.color},children:[Ve.targetWeight,"kg"]}),Ve.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Ve.achievedAt.toDate?Ve.achievedAt.toDate():new Date(Ve.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ee))})]},B)})]})]}),r.jsx(la,{active:"home"})]})})}const JD=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],ZD="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",eP="#e91e63",tP=700,Pg=42,Ol=2*Math.PI*Pg,uh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function sP(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Jp(n){return n.toISOString().split("T")[0]}function nP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function rP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u,accent:d}=Sa(),p=Jn(),[g,y]=v.useState({}),[_,x]=v.useState([]),[T,V]=v.useState(!0),[W,z]=v.useState(!1),[U,Z]=v.useState(0),[K,se]=v.useState(null),[he,Me]=v.useState(null),[we,C]=v.useState(!1),[E,R]=v.useState(!1),[O,I]=v.useState(!1),[H,D]=v.useState(!1),[Ue,lt]=v.useState(""),[B,re]=v.useState(null),[Te,Ve]=v.useState([]),[ee,L]=v.useState(null),ae=v.useRef(null),De=v.useRef(null),Pe=v.useRef(null),Ke=v.useRef(null),Be=v.useRef(!1),gt=v.useRef({}),Nt=v.useRef([]),ct=v.useRef([]),Zt=v.useRef(null),Vs=v.useRef(uh[Math.floor(Math.random()*uh.length)]),ft=v.useCallback((G,de="info")=>{se({message:G,type:de}),setTimeout(()=>se(null),3e3)},[]),ht=new Date,ce=Jp(ht),os=sP(ht),Yt=nP(os),Ct=["M","T","W","T","F","S","S"],yt=[...JD.filter(G=>!Te.includes(G.key)),..._.map(G=>({key:`custom_${G.id}`,label:G.label,icon:ZD,color:eP,isCustom:!0,id:G.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const de=Bt(pe,"habitLogs"),Ee=Ds(de,ms("clientId","==",t.id)),Le=await Es(Ee),_e={};Le.docs.forEach(ne=>{const $e=ne.data();_e[$e.date]={...$e,_id:ne.id}}),y(_e);const Ye=await Rs(qe(pe,"customHabits",t.id));if(Ye.exists()){const ne=Ye.data();x(ne.habits||[]),Ve(ne.hiddenDefaults||[])}let at=0;const Y=new Date(ht);for(;;){const ne=Jp(Y),$e=_e[ne];if($e)if(Object.values($e.habits||{}).filter(Boolean).length>=3)at++,Y.setDate(Y.getDate()-1);else break;else if(ne===ce)Y.setDate(Y.getDate()-1);else break}Z(at)}catch(de){console.error("Error loading habit logs:",de)}finally{V(!1)}})()},[n,t]);const st=g[ce]||{habits:{}};v.useEffect(()=>{Object.values(st.habits||{}).filter(Boolean).length<yt.length&&O&&I(!1)},[yt.length,st.habits]);const He=async G=>{if(!(!n||W||st.habits?.[G])){Nt.current=[...Array(10)].map((Ee,Le)=>{const _e=Le/10*2*Math.PI,Ye=18+Math.random()*20;return{tx:Math.cos(_e)*Ye,ty:Math.sin(_e)*Ye,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),Me(G),setTimeout(()=>Me(null),700),navigator.vibrate&&navigator.vibrate(50),z(!0);try{const Le={...st.habits||{},[G]:!0},_e=st._id||`${t.id}_${ce}`;y(at=>({...at,[ce]:{clientId:t.id,date:ce,habits:Le,_id:_e}})),await Ss(qe(pe,"habitLogs",_e),{clientId:t.id,date:ce,habits:Le}),Object.values(Le).filter(Boolean).length===yt.length&&!O&&(Vs.current=uh[Math.floor(Math.random()*uh.length)],ct.current=[...Array(80)].map((at,Y)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Y%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Y%3})),setTimeout(()=>{C(!0),I(!0),setTimeout(()=>Zt.current?.focus(),1100)},400))}catch(Ee){console.error("Error saving habit:",Ee),ft("Failed to save. Try again.","error"),y(Le=>({...Le,[ce]:{...Le[ce],habits:{...Le[ce]?.habits||{},[G]:!1}}}))}finally{z(!1)}}},zt=async G=>{if(!(!n||W)){z(!0);try{const Ee={...st.habits||{},[G]:!1},Le=st._id||`${t.id}_${ce}`;await Ss(qe(pe,"habitLogs",Le),{clientId:t.id,date:ce,habits:Ee}),y(_e=>({..._e,[ce]:{clientId:t.id,date:ce,habits:Ee,_id:Le}}))}catch(de){console.error("Error undoing habit:",de),ft("Failed to undo. Try again.","error")}finally{z(!1)}}},Ns=G=>{if(st.habits?.[G]||!1||W||Ke.current)return;Ke.current=G,L(G),De.current=performance.now();const Ee=gt.current[G];Ee&&(Ee.style.strokeDashoffset=Ol);const Le=_e=>{const Ye=_e-De.current,at=Math.min(Ye/tP,1),Y=gt.current[G];Y&&(Y.style.strokeDashoffset=Ol-at*Ol),at<1?Pe.current=requestAnimationFrame(Le):(Ke.current=null,Be.current=!0,Pe.current=null,L(null),He(G))};Pe.current=requestAnimationFrame(Le)},$s=()=>{if(!Ke.current)return;const G=Ke.current;Ke.current=null,Pe.current&&(cancelAnimationFrame(Pe.current),Pe.current=null),ae.current&&(clearTimeout(ae.current),ae.current=null),gt.current[G]&&(gt.current[G].style.strokeDashoffset=Ol),L(null),De.current=null};v.useEffect(()=>()=>{Pe.current&&cancelAnimationFrame(Pe.current),ae.current&&clearTimeout(ae.current)},[]);const Dt=()=>{R(!0),setTimeout(()=>{C(!1),R(!1)},300)},Tt=async()=>{const G=Ue.trim();if(!G)return;if(!t?.id){ft("Still loading, try again","error");return}const de=Date.now().toString(36),Ee=[..._,{id:de,label:G}];try{await Ss(qe(pe,"customHabits",t.id),{clientId:t.id,habits:Ee,hiddenDefaults:Te},{merge:!0}),x(Ee),lt(""),D(!1),ft(`Added "${G}"`,"success")}catch(Le){console.error("Error adding custom habit:",Le),ft(Le?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Le?.message||"Unknown error"}`,"error")}},rs=async G=>{if(!t?.id)return;const de=_.filter(Ee=>Ee.id!==G);try{await Ss(qe(pe,"customHabits",t.id),{clientId:t.id,habits:de,hiddenDefaults:Te},{merge:!0}),x(de),re(null),ft("Habit removed","success")}catch(Ee){console.error("Error deleting habit:",Ee),ft("Failed to remove","error")}},As=async G=>{if(!t?.id)return;const de=[...Te,G];try{await Ss(qe(pe,"customHabits",t.id),{clientId:t.id,habits:_,hiddenDefaults:de},{merge:!0}),Ve(de),re(null),ft("Habit removed","success")}catch(Ee){console.error("Error hiding default habit:",Ee),ft("Failed to remove","error")}},Ut=Yt.map(G=>{const de=Jp(G),Ee=g[de],Le=Ee?Object.values(Ee.habits||{}).filter(Boolean).length:0;return{date:G,dateStr:de,completed:Le,total:yt.length}}),Xs=Ut.reduce((G,de)=>G+de.completed,0),Pt=Ut.reduce((G,de)=>G+de.total,0),fs=Pt>0?Math.round(Xs/Pt*100):0,qt=Object.values(st.habits||{}).filter(Boolean).length,ve=yt.length>0?Math.round(qt/yt.length*100):0;return r.jsx(ja,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||T?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-ve/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[ve,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:U}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[yt.map(G=>{const de=st.habits?.[G.key]||!1,Ee=he===G.key,Le=ee===G.key;return r.jsxs("div",{className:`cbc-habit-tile ${de?"cbc-habit-done":""} ${Ee?"cbc-habit-just-checked":""}`,style:{"--habit-color":G.color},children:[r.jsx("button",{className:"cbc-habit-delete",onClick:_e=>{_e.stopPropagation(),re(G.isCustom?{type:"custom",id:G.id,label:G.label}:{type:"default",key:G.key,label:G.label})},"aria-label":`Remove ${G.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${Le?"cbc-holding":""} ${de?"cbc-ring-completed":""}`,onPointerDown:_e=>{de||(_e.preventDefault(),Ns(G.key))},onPointerUp:$s,onPointerLeave:$s,onPointerCancel:$s,onClick:_e=>{if(_e.stopPropagation(),Be.current){Be.current=!1;return}de&&zt(G.key)},role:"button",tabIndex:0,"aria-label":de?`Undo ${G.label}`:`Press and hold to complete ${G.label}`,onKeyDown:_e=>{(_e.key==="Enter"||_e.key===" ")&&(_e.preventDefault(),de?zt(G.key):He(G.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Pg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:_e=>{_e&&(gt.current[G.key]=_e)},cx:"50",cy:"50",r:Pg,style:{stroke:G.color,strokeDasharray:Ol,strokeDashoffset:de?0:Ol}})]}),de&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":G.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:G.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:G.icon})})}),Ee&&r.jsx("div",{className:"cbc-particles",children:Nt.current.map((_e,Ye)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${_e.tx}px`,"--ty":`${_e.ty}px`,"--size":`${_e.size}px`,"--particle-color":G.color,animationDuration:`${_e.duration}s`}},Ye))})]}),r.jsx("span",{className:"cbc-habit-label",children:G.label}),de?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},G.key)}),r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>D(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:Ut.map((G,de)=>{const Ee=G.dateStr===ce,Le=G.total>0?G.completed/G.total:0,_e=38,Ye=2*Math.PI*_e,at=Ye-Le*Ye;return r.jsxs("div",{className:`cbc-day-ring ${Ee?"cbc-day-today":""} ${G.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:_e}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:_e,strokeDasharray:Ye,strokeDashoffset:at})]}),r.jsx("span",{className:"cbc-day-label",children:Ct[de]}),r.jsxs("span",{className:"cbc-day-count",children:[G.completed,"/",G.total]})]},de)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${fs}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Xs," / ",Pt," habits this week (",fs,"%)"]})]})]})]}),r.jsx(la,{active:"home"}),H&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>D(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:G=>G.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Ue,onChange:G=>lt(G.target.value),maxLength:30,autoFocus:!0,onKeyDown:G=>G.key==="Enter"&&Tt()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{D(!1),lt("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:Tt,disabled:!Ue.trim(),children:"Add"})]})]})}),B&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>re(null),children:r.jsxs("div",{className:"cbc-modal",onClick:G=>G.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',B.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>re(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>B.type==="custom"?rs(B.id):As(B.key),children:"Remove"})]})]})}),we&&r.jsxs("div",{className:`cbc-celeb-overlay ${E?"cbc-celeb-dismissing":""}`,onClick:Dt,role:"dialog","aria-modal":"true","aria-label":"All habits complete celebration",children:[r.jsx("div",{className:"cbc-celeb-confetti","aria-hidden":"true",children:ct.current.map((G,de)=>r.jsx("span",{className:`cbc-celeb-confetti-piece cbc-confetti-shape-${G.shape}`,style:{"--x":`${G.x}%`,"--delay":`${G.delay}s`,"--color":G.color,"--drift":`${G.drift}px`,"--spin":`${G.spin}deg`,"--duration":`${G.duration}s`,width:`${G.width}px`,height:`${G.height}px`}},de))}),r.jsxs("div",{className:"cbc-celeb-content",onClick:G=>G.stopPropagation(),children:[r.jsx("div",{className:"cbc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"cbc-celeb-logo-img"})}),r.jsx("h2",{className:"cbc-celeb-heading",children:"All Habits Complete!"}),r.jsx("p",{className:"cbc-celeb-subtext",children:Vs.current}),r.jsxs("p",{className:"cbc-celeb-stats",children:[qt,"/",yt.length," habits  Day ",U||1]}),r.jsx("button",{ref:Zt,className:"cbc-celeb-btn",onClick:Dt,children:"Keep Going"})]})]}),K&&r.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function M2(n,e){return[n,e].sort().join("_")}function aP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Br(),{isDark:l,toggleTheme:u}=Sa(),d=Jn(),[p,g]=v.useState("buddies"),[y,_]=v.useState([]),[x,T]=v.useState([]),[V,W]=v.useState([]),[z,U]=v.useState(""),[Z,K]=v.useState([]),[se,he]=v.useState([]),[Me,we]=v.useState(!0),[C,E]=v.useState(null),[R,O]=v.useState(null),I=v.useCallback((ee,L="info")=>{O({message:ee,type:L}),setTimeout(()=>O(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const H=v.useCallback(async()=>{if(t){we(!0);try{const ee=t.id,ae=(await Es(Bt(pe,"clients"))).docs.map(ct=>({id:ct.id,...ct.data()}));he(ae);const De=Object.fromEntries(ae.map(ct=>[ct.id,ct])),Pe=await Es(Ds(Bt(pe,"buddies"),ms("user1","==",ee))),Ke=await Es(Ds(Bt(pe,"buddies"),ms("user2","==",ee))),Be=new Set;[...Pe.docs,...Ke.docs].forEach(ct=>{const Zt=ct.data(),Vs=Zt.user1===ee?Zt.user2:Zt.user1;Be.add(Vs)}),_(Array.from(Be).map(ct=>De[ct]).filter(Boolean));const gt=await Es(Ds(Bt(pe,"buddyRequests"),ms("toId","==",ee),ms("status","==","pending")));T(gt.docs.map(ct=>({reqId:ct.id,...ct.data(),fromClient:De[ct.data().fromId]})).filter(ct=>ct.fromClient));const Nt=await Es(Ds(Bt(pe,"buddyRequests"),ms("fromId","==",ee),ms("status","==","pending")));W(Nt.docs.map(ct=>({reqId:ct.id,...ct.data(),toClient:De[ct.data().toId]})).filter(ct=>ct.toClient))}catch(ee){console.error("Error fetching buddy data:",ee),I("Failed to load buddies","error")}finally{we(!1)}}},[t,I]);v.useEffect(()=>{H()},[H]),v.useEffect(()=>{if(!z.trim()||!t){K([]);return}const ee=z.toLowerCase(),L=t.id,ae=new Set(y.map(Be=>Be.id)),De=new Set(V.map(Be=>Be.toId)),Pe=new Set(x.map(Be=>Be.fromId)),Ke=se.filter(Be=>Be.id===L||!Be.name||!Be.coreBuddyAccess&&Be.clientType!=="core_buddy"?!1:Be.name.toLowerCase().includes(ee)).map(Be=>({...Be,isBuddy:ae.has(Be.id),isPendingOut:De.has(Be.id),isPendingIn:Pe.has(Be.id)})).slice(0,20);K(Ke)},[z,se,y,V,x,t]);const D=async(ee,L)=>{if(!(!t||ee===t.id))try{await wa(Bt(pe,"notifications"),{toId:ee,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:Tr()})}catch(ae){console.error("Notification error:",ae),ae.code==="permission-denied"&&I("Notifications blocked  check Firestore rules","error")}},Ue=async ee=>{E(ee);try{const L=`${t.id}_${ee}`;await Ss(qe(pe,"buddyRequests",L),{fromId:t.id,toId:ee,status:"pending",createdAt:Tr()}),await D(ee,"buddy_request"),I("Buddy request sent!","success"),await H()}catch(L){console.error("Error sending request:",L),I("Failed to send request","error")}finally{E(null)}},lt=async ee=>{E(ee.reqId);try{const L=M2(ee.fromId,t.id);await Ss(qe(pe,"buddies",L),{user1:[ee.fromId,t.id].sort()[0],user2:[ee.fromId,t.id].sort()[1],connectedAt:Tr()}),await Er(qe(pe,"buddyRequests",ee.reqId)),await D(ee.fromId,"buddy_accept"),I("Buddy added!","success"),await H()}catch(L){console.error("Error accepting request:",L),I("Failed to accept","error")}finally{E(null)}},B=async ee=>{E(ee.reqId);try{await Er(qe(pe,"buddyRequests",ee.reqId)),I("Request declined","info"),await H()}catch(L){console.error("Error declining:",L),I("Failed to decline","error")}finally{E(null)}},re=async ee=>{E(ee.reqId);try{await Er(qe(pe,"buddyRequests",ee.reqId)),I("Request cancelled","info"),await H()}catch(L){console.error("Error cancelling:",L),I("Failed to cancel","error")}finally{E(null)}},Te=async ee=>{E(ee);try{const L=M2(t.id,ee);await Er(qe(pe,"buddies",L)),I("Buddy removed","info"),await H()}catch(L){console.error("Error removing buddy:",L),I("Failed to remove buddy","error")}finally{E(null)}},Ve=x.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(ja,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Ve>0&&r.jsx("span",{className:"bdy-tab-badge",children:Ve})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Me?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:dh(ee.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:ee.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Te(ee.id)},disabled:C===ee.id,"aria-label":"Remove buddy",children:C===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[x.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:x.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.fromClient.photoURL?r.jsx("img",{src:ee.fromClient.photoURL,alt:ee.fromClient.name}):r.jsx("span",{children:dh(ee.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>lt(ee),disabled:C===ee.reqId,children:C===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>B(ee),disabled:C===ee.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ee.reqId))})]}),V.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:V.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.toClient?.photoURL?r.jsx("img",{src:ee.toClient.photoURL,alt:ee.toClient.name}):r.jsx("span",{children:dh(ee.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>re(ee),disabled:C===ee.reqId,children:C===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ee.reqId))})]}),x.length===0&&V.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:z,onChange:ee=>U(ee.target.value),autoFocus:!0}),z&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>U(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),z.trim()&&Z.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',z,'"']})}),Z.length>0&&r.jsx("div",{className:"bdy-list",children:Z.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:dh(ee.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.name}),ee.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ee.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):ee.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ee.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const ae=x.find(De=>De.fromId===ee.id);ae&&lt(ae)},disabled:!!C,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),Ue(ee.id)},disabled:C===ee.id,children:C===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ee.id))})]})]})]}),r.jsx(la,{}),R&&r.jsxs("div",{className:`toast-notification ${R.type}`,children:[r.jsx("span",{className:"toast-icon",children:R.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):R.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:R.message})]})]})})}function hh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Zp(n,e){return[n,e].sort().join("_")}const iP=5;function eg(n){return n.toISOString().split("T")[0]}function oP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const lP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function I2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function cP(){const{userId:n}=gE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Br(),{isDark:u,toggleTheme:d}=Sa(),p=Jn(),[g,y]=v.useState(null),[_,x]=v.useState("none"),[T,V]=v.useState(null),[W,z]=v.useState(!0),[U,Z]=v.useState(!1),[K,se]=v.useState(null),[he,Me]=v.useState([]),[we,C]=v.useState(!1),[E,R]=v.useState(new Set),[O,I]=v.useState(new Set),[H,D]=v.useState({}),[Ue,lt]=v.useState({}),[B,re]=v.useState({}),[Te,Ve]=v.useState(!0),[ee,L]=v.useState(0),[ae,De]=v.useState(0),[Pe,Ke]=v.useState(0),[Be,gt]=v.useState(0),[Nt,ct]=v.useState([]),[Zt,Vs]=v.useState([]),[ft,ht]=v.useState(null),[ce,os]=v.useState(null),[Yt,Ct]=v.useState(0),[yt,st]=v.useState([]),[He,zt]=v.useState(!1),[Ns,$s]=v.useState(null),[Dt,Tt]=v.useState([]),rs=v.useCallback((Y,ne="info")=>{se({message:Y,type:ne}),setTimeout(()=>se(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Y=!1;return(async()=>{z(!0);try{const We=(await Es(Bt(pe,"clients"))).docs.map(Rt=>({id:Rt.id,...Rt.data()})).find(Rt=>Rt.id===n);if(!We){Y||z(!1);return}Y||y(We);const rt=i.id,pt=Zp(rt,n);if((await Rs(qe(pe,"buddies",pt))).exists())Y||x("buddy");else{const Rt=`${rt}_${n}`,_s=await Rs(qe(pe,"buddyRequests",Rt));if(_s.exists()&&_s.data().status==="pending")Y||(x("pending_out"),V(Rt));else{const Ws=`${n}_${rt}`,as=await Rs(qe(pe,"buddyRequests",Ws));as.exists()&&as.data().status==="pending"?Y||(x("pending_in"),V(Ws)):Y||x("none")}}}catch(ne){console.error("Error loading profile:",ne)}finally{Y||z(!1)}})(),()=>{Y=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Y=!1;return(async()=>{Ve(!0);try{const[ne,$e,We,rt]=await Promise.all([Es(Ds(Bt(pe,"workoutLogs"),ms("clientId","==",n))),Rs(qe(pe,"coreBuddyAchievements",n)),Rs(qe(pe,"coreBuddyPBs",n)),Rs(qe(pe,"clientProgrammes",n))]);if(Y)return;const pt=ne.docs.length;L(pt),$e.exists()&&De($e.data().totalVolume||0);let vt=0;const Rt=ne.docs.map(as=>as.data().date).filter(Boolean).sort().reverse();if(Rt.length>0){const as=new Date;let ks=new Date(as);for(let Bs=0;Bs<52;Bs++){const $=new Date(ks),xe=$.getDay(),Ce=xe===0?6:xe-1;$.setDate($.getDate()-Ce),$.setHours(0,0,0,0);const Se=new Date($);Se.setDate(Se.getDate()+7);const ke=eg($),ot=eg(Se);if(Rt.some(Je=>Je>=ke&&Je<ot))vt++;else{if(Bs>0)break;break}ks.setDate(ks.getDate()-7)}}if(Y||Ke(vt),We.exists()){const as=We.data().exercises||{},ks=Object.entries(as).sort(([,Bs],[,$])=>($.weight||0)-(Bs.weight||0)).slice(0,3).map(([Bs,$])=>({name:Bs,weight:$.weight,reps:$.reps}));Y||ct(ks)}if(rt.exists()){const as=rt.data(),ks=lP[as.templateId];if(ks){const Bs=Object.keys(as.completedSessions||{}).length,$=ks.duration*ks.daysPerWeek;Y||(os(as.templateId.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase())),Ct($>0?Math.round(Bs/$*100):0))}}const _s=await Rs(qe(pe,"achievements",n));if(!Y&&_s.exists()){const as=_s.data().badges||{};Vs(Object.keys(as))}let Ws=0;for(let as=0;as<30;as++){const ks=new Date;ks.setDate(ks.getDate()-as);const Bs=eg(ks);try{const $=await Es(Ds(Bt(pe,"habitLogs"),ms("clientId","==",n),ms("date","==",Bs)));if($.empty)break;{const xe=$.docs[0].data().habits||{};if(Object.values(xe).filter(Boolean).length>=iP)Ws++;else break}}catch{break}}Y||gt(Ws)}catch(ne){console.error("Error loading buddy stats:",ne)}finally{Y||Ve(!1)}})(),()=>{Y=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Y=i.id;(async()=>{try{const[ne,$e,We]=await Promise.all([Es(Ds(Bt(pe,"buddies"),ms("user1","==",Y))),Es(Ds(Bt(pe,"buddies"),ms("user2","==",Y))),Es(Bt(pe,"clients"))]),rt=new Set;[...ne.docs,...$e.docs].forEach(vt=>{const Rt=vt.data();rt.add(Rt.user1===Y?Rt.user2:Rt.user1)});const pt={};We.docs.forEach(vt=>{pt[vt.id]=vt.data()}),st(Array.from(rt).filter(vt=>pt[vt]).map(vt=>({id:vt,name:pt[vt].name,photoURL:pt[vt].photoURL||null})))}catch(ne){console.error("Error loading buddies for mentions:",ne)}})()},[i]);const As=async(Y,ne,$e={})=>{if(!(!i||Y===i.id))try{await wa(Bt(pe,"notifications"),{toId:Y,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:ne,read:!1,createdAt:Tr(),...$e})}catch(We){console.error("Notification error:",We),We.code==="permission-denied"&&rs("Notifications blocked  check Firestore rules","error")}},Ut=async()=>{Z(!0);try{const Y=`${i.id}_${n}`;await Ss(qe(pe,"buddyRequests",Y),{fromId:i.id,toId:n,status:"pending",createdAt:Tr()}),await As(n,"buddy_request"),x("pending_out"),V(Y),rs("Buddy request sent!","success")}catch(Y){console.error(Y),rs("Failed to send request","error")}finally{Z(!1)}},Xs=async()=>{if(T){Z(!0);try{const Y=Zp(i.id,n);await Ss(qe(pe,"buddies",Y),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Tr()}),await Er(qe(pe,"buddyRequests",T)),await As(n,"buddy_accept"),x("buddy"),rs("Buddy added!","success")}catch(Y){console.error(Y),rs("Failed to accept","error")}finally{Z(!1)}}},Pt=async()=>{if(T){Z(!0);try{await Er(qe(pe,"buddyRequests",T)),x("none"),rs(_==="pending_out"?"Request cancelled":"Request declined","info")}catch(Y){console.error(Y),rs("Failed","error")}finally{Z(!1)}}},fs=async()=>{Z(!0);try{const Y=Zp(i.id,n);await Er(qe(pe,"buddies",Y)),x("none"),rs("Buddy removed","info")}catch(Y){console.error(Y),rs("Failed to remove","error")}finally{Z(!1)}},qt=v.useCallback(async()=>{if(n){C(!0);try{const Y=await Es(Ds(Bt(pe,"posts"),ms("authorId","==",n),Kh("createdAt","desc"),Yh(30)));if(Me(Y.docs.map(ne=>({id:ne.id,...ne.data()}))),i){const ne=await Es(Ds(Bt(pe,"postLikes"),ms("userId","==",i.id)));R(new Set(ne.docs.map($e=>$e.data().postId)))}}catch(Y){console.error("Error loading journey:",Y)}finally{C(!1)}}},[n,i]);v.useEffect(()=>{!W&&g&&qt()},[W,g,qt]);const ve=async Y=>{if(window.confirm("Delete this post?"))try{await Er(qe(pe,"posts",Y)),Me(ne=>ne.filter($e=>$e.id!==Y)),rs("Post deleted","info")}catch(ne){console.error("Delete error:",ne),rs("Failed to delete","error")}},G=async Y=>{if(!i)return;const ne=i.id,$e=`${Y}_${ne}`,We=E.has(Y),rt=new Set(E);We?rt.delete(Y):rt.add(Y),R(rt),Me(pt=>pt.map(vt=>vt.id===Y?{...vt,likeCount:Math.max(0,(vt.likeCount||0)+(We?-1:1))}:vt));try{if(We)await Er(qe(pe,"postLikes",$e)),await Pa(qe(pe,"posts",Y),{likeCount:Uo(-1)});else{await Ss(qe(pe,"postLikes",$e),{postId:Y,userId:ne,createdAt:Tr()}),await Pa(qe(pe,"posts",Y),{likeCount:Uo(1)});const pt=he.find(vt=>vt.id===Y);pt&&As(pt.authorId,"like",{postId:Y})}}catch(pt){console.error("Like error:",pt),qt()}},de=async Y=>{try{const ne=await Es(Ds(Bt(pe,"postComments"),ms("postId","==",Y),Kh("createdAt","asc"),Yh(50)));D($e=>({...$e,[Y]:ne.docs.map(We=>({id:We.id,...We.data()}))}))}catch(ne){console.error("Error loading comments:",ne)}},Ee=Y=>{const ne=new Set(O);ne.has(Y)?ne.delete(Y):(ne.add(Y),H[Y]||de(Y)),I(ne)},Le=(Y,ne)=>{const $e=Y.match(/@(\w*)$/);if($e){zt(!0),$s(ne);const We=yt.filter(rt=>rt.name&&rt.name.toLowerCase().includes($e[1].toLowerCase())).slice(0,5);Tt(We)}else zt(!1),Tt([])},_e=(Y,ne)=>{const We=(Ue[ne]||"").replace(/@\w*$/,`@${Y.name} `);lt(rt=>({...rt,[ne]:We})),zt(!1),Tt([])},Ye=(Y,ne)=>{lt($e=>({...$e,[Y]:ne})),Le(ne,Y)},at=async Y=>{const ne=(Ue[Y]||"").trim();if(!(!ne||!i)){re($e=>({...$e,[Y]:!0}));try{await wa(Bt(pe,"postComments"),{postId:Y,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:ne,createdAt:Tr()}),await Pa(qe(pe,"posts",Y),{commentCount:Uo(1)});const $e=he.find(rt=>rt.id===Y);$e&&As($e.authorId,"comment",{postId:Y});const We=ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(We){const rt=new Set;We.forEach(pt=>{const vt=pt.slice(1).trim(),Rt=yt.find(_s=>_s.name&&_s.name.toLowerCase()===vt.toLowerCase());Rt&&!rt.has(Rt.id)&&(rt.add(Rt.id),As(Rt.id,"mention",{postId:Y}))})}lt(rt=>({...rt,[Y]:""})),Me(rt=>rt.map(pt=>pt.id===Y?{...pt,commentCount:(pt.commentCount||0)+1}:pt)),await de(Y)}catch($e){console.error("Comment error:",$e),rs("Failed to comment","error")}finally{re($e=>({...$e,[Y]:!1}))}}};return l||W||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(ja,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:hh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[_==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:Ut,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),_==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Pt,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),_==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Xs,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Pt,disabled:U,children:"Decline"})]}),_==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:fs,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Te?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:ee}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[oP(ae),r.jsx("span",{className:"prf-stat-unit",children:ae>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[ae>=1e6?"Million kg":ae>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Pe,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ce||Be>0)&&r.jsxs("div",{className:"prf-info-row",children:[ce&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ce}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Yt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Yt,"% complete"]})]})]}),Be>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Be," day",Be!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),Nt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:Nt.map((Y,ne)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:ne===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ne+1}`}),r.jsx("span",{className:"prf-pb-name",children:Y.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Y.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Y.reps]})]},ne))})]}),Zt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Zt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Zt.map(Y=>{const ne=fu.find($e=>$e.id===Y);return ne?r.jsx("button",{className:"prf-badge-chip",onClick:()=>ht(ne),children:r.jsx("img",{src:ne.img,alt:ne.name,className:"prf-badge-chip-img"})},Y):null})})]}),ft&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>ht(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Y=>Y.stopPropagation(),children:[r.jsx("img",{src:ft.img,alt:ft.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:ft.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>ht(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),we?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):he.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:he.map(Y=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Y.authorPhotoURL?r.jsx("img",{src:Y.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(Y.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Y.authorName}),r.jsx("span",{className:"journey-post-time",children:I2(Y.createdAt)})]}),Y.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>ve(Y.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Y.content&&r.jsx("p",{className:"journey-post-content",children:Y.content}),Y.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Y.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(Y.id)?" liked":""}`,onClick:()=>G(Y.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Y.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Y.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${O.has(Y.id)?" active":""}`,onClick:()=>Ee(Y.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Y.commentCount||0})]})]}),O.has(Y.id)&&r.jsxs("div",{className:"journey-comments",children:[H[Y.id]?.length>0?H[Y.id].map(ne=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${ne.authorId}`),children:ne.authorPhotoURL?r.jsx("img",{src:ne.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(ne.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:ne.authorName}),r.jsx("span",{className:"journey-comment-text",children:ne.content})]}),r.jsx("span",{className:"journey-comment-time",children:I2(ne.createdAt)})]})]},ne.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ue[Y.id]||"",onChange:ne=>Ye(Y.id,ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&at(Y.id)},maxLength:300}),He&&Ns===Y.id&&Dt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Dt.map(ne=>r.jsxs("button",{className:"mention-option",onClick:()=>_e(ne,Y.id),children:[r.jsx("div",{className:"mention-option-avatar",children:ne.photoURL?r.jsx("img",{src:ne.photoURL,alt:""}):r.jsx("span",{children:hh(ne.name)})}),r.jsx("span",{children:ne.name})]},ne.id))}),r.jsx("button",{onClick:()=>at(Y.id),disabled:!(Ue[Y.id]||"").trim()||B[Y.id],children:B[Y.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Y.id))})]})]}),r.jsx(la,{}),K&&r.jsxs("div",{className:`toast-notification ${K.type}`,children:[r.jsx("span",{className:"toast-icon",children:K.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:K.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(la,{})]})}function uP(){const n=Jn(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Br(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,_]=v.useState(!1),[x,T]=v.useState(null),[V,W]=v.useState(!1),[z,U]=v.useState(null),Z=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(la,{active:"home"})]});v.useEffect(()=>{Z.current&&Z.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&se([])},[]);const se=async E=>{_(!0),T(null);try{const O=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(O.error){T(O.error);return}const I={role:"assistant",content:O.reply};d(H=>[...H,I]),O.profileData&&(await C(O.profileData),U(O.profileData),W(!0))}catch(R){console.error("Buddy chat error:",R),T("Something went wrong  try sending again.")}finally{_(!1)}},he=()=>{const E=p.trim();if(!E||y)return;const R={role:"user",content:E},O=[...u,R];d(O),g(""),K.current&&K.current.focus(),se(O)},Me=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),he())},we=E=>{const R=E?.experience||"beginner";return R==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:R==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},C=async E=>{try{const R=await i();if(!R)return;await Ss(qe(pe,"onboardingSubmissions",R.id),{clientId:R.id,clientName:R.name,email:R.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:Tr()});const O=E.goals||[];await Pa(qe(pe,"clients",R.id),{fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience,dob:E.dob})}catch(R){console.error("Save profile error:",R)}};return r.jsx(ja,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,R)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},R)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),x&&r.jsxs("div",{className:"buddy-chat-error",children:[x,r.jsx("button",{onClick:()=>se(u),children:"Retry"})]}),r.jsx("div",{ref:Z})]}),V?r.jsx("div",{className:"buddy-chat-done",children:z?(()=>{const E=we(z);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:Me,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:he,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(la,{active:"home"})]})})}const ga=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function dP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ya(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function hP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function mP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function mh(n,e){if(!e)return"-";switch(n.unit){case"weight":return mP(e.weight,e.reps);case"time":return hP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Vl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function fP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(z=>{const U=z.benchmarks?.[e];if(!U)return 0;switch(t){case"weight":return(U.weight||0)*(U.reps||0);case"time":return U.time||0;case"reps":return U.reps||0;case"distance":return U.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,_=p-y*2,x=g-y*2,T=i.map((z,U)=>{const Z=y+U/(i.length-1)*_,K=y+x-(z-u)/d*x;return{x:Z,y:K,value:z}}),V=T.map((z,U)=>`${U===0?"M":"L"} ${z.x} ${z.y}`).join(" "),W=V+` L ${T[T.length-1].x} ${y+x} L ${T[0].x} ${y+x} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((z,U)=>r.jsx("circle",{cx:z.x,cy:z.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((z,U)=>r.jsxs("span",{className:"pb-trend-label",children:[z.month.split("-")[1],"/",z.month.split("-")[0].slice(2)]},U))})]})}function pP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[_,x]=v.useState(!1),[T,V]=v.useState(!1),[W,z]=v.useState(!1),[U,Z]=v.useState({}),[K,se]=v.useState({}),[he,Me]=v.useState({}),[we,C]=v.useState({}),[E,R]=v.useState({}),[O,I]=v.useState(!1),[H,D]=v.useState({}),[Ue,lt]=v.useState([]),[B,re]=v.useState(null),[Te,Ve]=v.useState(null),[ee,L]=v.useState(!1),[ae,De]=v.useState(""),[Pe,Ke]=v.useState(""),Be=v.useRef(null),gt=v.useRef(0),Nt=v.useRef(0),ct=v.useRef("right"),Zt=v.useCallback($=>{y(xe=>{const Ce=Math.max(0,Math.min(ga.length-1,$));return Ce===xe?xe:(ct.current=Ce>xe?"right":"left",Ce)})},[]),{currentUser:Vs,isClient:ft,clientData:ht,loading:ce}=Br(),{isDark:os}=Sa(),Yt=Jn(),Ct=v.useCallback(($,xe="info")=>{Ve({message:$,type:xe}),setTimeout(()=>Ve(null),4e3)},[]);v.useEffect(()=>{!ce&&(!Vs||!ft)&&Yt("/")},[Vs,ft,ce,Yt]),v.useEffect(()=>{ht&&yt()},[ht]);const yt=async()=>{try{const $=Ds(Bt(pe,"juniorPBs"),ms("clientId","==",ht.id)),Ce=(await Es($)).docs.map(Je=>({id:Je.id,...Je.data()}));Ce.sort((Je,_t)=>Je.month.localeCompare(_t.month)),i(Ce);const Se=Ds(Bt(pe,"juniorPBTargets"),ms("clientId","==",ht.id)),ke=await Es(Se);if(!ke.empty){const Je=ke.docs[0].data();Me(Je.targets||{}),C(Je.metricTargets||{}),R(Je.targets||{}),D(Je.metricTargets||{})}const ot=Ds(Bt(pe,"juniorAchievements"),ms("clientId","==",ht.id)),bt=await Es(ot);bt.empty||lt(bt.docs[0].data().badges||[])}catch($){console.error("Error fetching junior personal bests:",$)}u(!1)},st=dP(),He=t.find($=>$.month===st),zt=t.filter($=>$.month<st),Ns=zt.length>0?zt[zt.length-1]:null;v.useEffect(()=>{He?(Z(He.benchmarks||{}),se(He.bodyMetrics||{})):(Z({}),se({}))},[He?.id]);const $s=async($,xe)=>{const Ce=[];if($==="strength"?ga.forEach(Se=>{const ke=he[Se.key];if(!ke)return;const ot=xe[Se.key];if(!ot)return;let bt;if(ke.targetType==="time"){if(!ke.targetValue)return;const Je=ke.startValue||0,_t=ot.time||0,jt=ke.targetValue-Je;bt=jt===0?_t>=ke.targetValue?1:0:Math.max(0,(_t-Je)/jt)}else if(ke.targetType==="reps"){if(!ke.targetReps)return;const Je=ke.startReps||0,_t=ot.reps||0,jt=ke.targetReps-Je;bt=jt===0?_t>=ke.targetReps?1:0:Math.max(0,(_t-Je)/jt)}else if(ke.targetType==="distance"){if(!ke.targetDistance)return;const Je=ke.startDistance||0,_t=ot.distance||0,jt=ke.targetDistance-Je;bt=jt===0?_t>=ke.targetDistance?1:0:Math.max(0,(_t-Je)/jt)}else{if(!ke.targetWeight&&!ke.targetReps)return;const Je=(ke.startWeight||0)*(ke.startReps||0),_t=(ke.targetWeight||0)*(ke.targetReps||0),jt=(ot.weight||0)*(ot.reps||0),Cs=_t-Je;bt=Cs===0?jt>=_t?1:0:Math.max(0,(jt-Je)/Cs)}if(bt>=1){let Je,_t;ke.targetType==="time"?(Je=Ue.some(jt=>jt.type==="strength"&&jt.key===Se.key&&jt.targetValue===ke.targetValue),_t=`${Se.name} ${ke.targetValue}s`):ke.targetType==="reps"?(Je=Ue.some(jt=>jt.type==="strength"&&jt.key===Se.key&&jt.targetReps===ke.targetReps),_t=`${Se.name} ${ke.targetReps} reps`):ke.targetType==="distance"?(Je=Ue.some(jt=>jt.type==="strength"&&jt.key===Se.key&&jt.targetDistance===ke.targetDistance),_t=`${Se.name} ${ke.targetDistance}cm`):(Je=Ue.some(jt=>jt.type==="strength"&&jt.key===Se.key&&jt.targetWeight===ke.targetWeight&&jt.targetReps===ke.targetReps),_t=`${Se.name} ${ke.targetWeight}kg  ${ke.targetReps}`),Je||Ce.push({type:"strength",key:Se.key,...ke.targetType==="time"?{targetType:"time",targetValue:ke.targetValue}:ke.targetType==="reps"?{targetType:"reps",targetReps:ke.targetReps}:ke.targetType==="distance"?{targetType:"distance",targetDistance:ke.targetDistance}:{targetWeight:ke.targetWeight,targetReps:ke.targetReps},achievedMonth:st,label:_t})}}):Lo.forEach(Se=>{const ke=we[Se.key];if(!ke||!ke.targetValue)return;const ot=xe[Se.key];if(ot==null)return;const bt=ke.startValue||0,Je=ke.targetValue,_t=Je-bt;(_t===0?ot===Je?1:0:Math.max(0,(ot-bt)/_t))>=1&&(Ue.some(un=>un.type==="metric"&&un.key===Se.key&&un.targetValue===Je)||Ce.push({type:"metric",key:Se.key,targetValue:Je,achievedMonth:st,label:`${Se.name} ${Je}${Se.suffix}`}))}),Ce.length>0){const Se=[...Ue,...Ce];await Ss(qe(pe,"juniorAchievements",ht.id),{clientId:ht.id,badges:Se,updatedAt:wt.now()}),lt(Se),re(Ce),setTimeout(()=>re(null),5e3)}},Dt=($,xe)=>{if($==="strength"){const Ce=he[xe];if(!Ce)return!1;switch(ga.find(ke=>ke.key===xe)?.unit){case"time":return Ue.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetValue===Ce.targetValue);case"reps":return Ue.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetReps===Ce.targetReps);case"distance":return Ue.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetDistance===Ce.targetDistance);default:return!Ce.targetWeight&&!Ce.targetReps?!1:Ue.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetWeight===Ce.targetWeight&&ke.targetReps===Ce.targetReps)}}else{const Ce=we[xe];return!Ce||!Ce.targetValue?!1:Ue.some(Se=>Se.type==="metric"&&Se.key===xe&&Se.targetValue===Ce.targetValue)}},Tt=async()=>{p(!0);try{const $=`${ht.id}_${st}`,xe=He||{};await Ss(qe(pe,"juniorPBs",$),{clientId:ht.id,month:st,benchmarks:U,bodyMetrics:xe.bodyMetrics||K||{},createdAt:xe.createdAt||wt.now(),updatedAt:wt.now()}),await $s("strength",U),Ct("Benchmarks saved!","success"),x(!1),await yt()}catch($){console.error("Error saving benchmarks:",$),Ct("Failed to save. Please try again.","error")}p(!1)},rs=async()=>{p(!0);try{const $=`${ht.id}_${st}`,xe=He||{};await Ss(qe(pe,"juniorPBs",$),{clientId:ht.id,month:st,benchmarks:xe.benchmarks||U||{},bodyMetrics:K,createdAt:xe.createdAt||wt.now(),updatedAt:wt.now()}),await $s("metric",K),Ct("Body metrics saved!","success"),V(!1),await yt()}catch($){console.error("Error saving metrics:",$),Ct("Failed to save. Please try again.","error")}p(!1)},As=($,xe,Ce)=>{Z(Se=>({...Se,[$]:{...Se[$],[xe]:Ce===""?"":parseFloat(Ce)}}))},Ut=($,xe)=>{se(Ce=>({...Ce,[$]:xe===""?"":parseFloat(xe)}))},Xs=($,xe,Ce)=>{R(Se=>({...Se,[$]:{...Se[$],[xe]:Ce===""?"":parseFloat(Ce)}}))},Pt=async()=>{p(!0);try{const $=`targets_${ht.id}`,xe=He?.benchmarks||{},Ce={};ga.forEach(Se=>{const ke=xe[Se.key];switch(Se.unit){case"time":E[Se.key]?.targetValue&&(Ce[Se.key]={targetType:"time",targetValue:E[Se.key].targetValue,startValue:ke?.time||0});break;case"reps":E[Se.key]?.targetReps&&(Ce[Se.key]={targetType:"reps",targetReps:E[Se.key].targetReps,startReps:ke?.reps||0});break;case"distance":E[Se.key]?.targetDistance&&(Ce[Se.key]={targetType:"distance",targetDistance:E[Se.key].targetDistance,startDistance:ke?.distance||0});break;default:(E[Se.key]?.targetWeight||E[Se.key]?.targetReps)&&(Ce[Se.key]={targetWeight:E[Se.key].targetWeight||0,targetReps:E[Se.key].targetReps||0,startWeight:ke?.weight||0,startReps:ke?.reps||0})}}),await Ss(qe(pe,"juniorPBTargets",$),{clientId:ht.id,targets:Ce,metricTargets:we,updatedAt:wt.now()}),Me(Ce),R(Ce),Ct("Targets saved!","success"),z(!1)}catch($){console.error("Error saving targets:",$),Ct("Failed to save targets.","error")}p(!1)},fs=($,xe)=>{D(Ce=>({...Ce,[$]:{...Ce[$],targetValue:xe===""?"":parseFloat(xe)}}))},qt=async()=>{p(!0);try{const $=`targets_${ht.id}`,xe={};Lo.forEach(Ce=>{if(H[Ce.key]?.targetValue){const Se=He?.bodyMetrics?.[Ce.key]||0;xe[Ce.key]={targetValue:H[Ce.key].targetValue,startValue:Se}}}),await Ss(qe(pe,"juniorPBTargets",$),{clientId:ht.id,targets:he,metricTargets:xe,updatedAt:wt.now()}),C(xe),D(xe),Ct("Metric targets saved!","success"),I(!1)}catch($){console.error("Error saving metric targets:",$),Ct("Failed to save targets.","error")}p(!1)},ve=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const $=qe(pe,"juniorPBTargets",`targets_${ht.id}`);await Er($),Me({}),C({}),R({}),D({}),Ct("All goals have been reset","success")}catch($){console.error("Error resetting targets:",$),Ct("Failed to reset goals","error")}p(!1)}},G=($,xe)=>{const Ce=he[$];if(!Ce||!xe)return null;if(Ce.targetType==="time"){if(!Ce.targetValue)return null;const Je=Ce.startValue||0,_t=Ce.targetValue,jt=xe.time||0,Cs=_t-Je;return Cs<=0?jt>=_t?1:0:Math.max(0,Math.min((jt-Je)/Cs,1))}if(Ce.targetType==="reps"){if(!Ce.targetReps)return null;const Je=Ce.startReps||0,_t=Ce.targetReps,jt=xe.reps||0,Cs=_t-Je;return Cs<=0?jt>=_t?1:0:Math.max(0,Math.min((jt-Je)/Cs,1))}if(Ce.targetType==="distance"){if(!Ce.targetDistance)return null;const Je=Ce.startDistance||0,_t=Ce.targetDistance,jt=xe.distance||0,Cs=_t-Je;return Cs<=0?jt>=_t?1:0:Math.max(0,Math.min((jt-Je)/Cs,1))}if(!Ce.targetWeight&&!Ce.targetReps)return null;const Se=(Ce.startWeight||0)*(Ce.startReps||0),ke=(Ce.targetWeight||0)*(Ce.targetReps||0),ot=(xe.weight||0)*(xe.reps||0),bt=ke-Se;return bt<=0?ot>=ke?1:0:Math.max(0,Math.min((ot-Se)/bt,1))},de=$=>{const xe=we[$];if(!xe||!xe.targetValue)return null;const Ce=He?.bodyMetrics?.[$];if(Ce==null)return null;const Se=xe.startValue||0,ke=xe.targetValue,ot=ke-Se;return ot===0?Ce===ke?1:0:Math.max(0,Math.min((Ce-Se)/ot,1))},Ee=$=>{gt.current=$.touches[0].clientX,Nt.current=0},Le=$=>{Nt.current=$.touches[0].clientX-gt.current},_e=()=>{Nt.current<-50?Zt(g+1):Nt.current>50&&Zt(g-1),Nt.current=0},Ye=$=>{const xe=He?.bodyMetrics?.[$],Ce=Ns?.bodyMetrics?.[$];return xe==null||Ce==null?null:parseFloat((xe-Ce).toFixed(2))},at=t.find($=>$.month===ae),Y=t.find($=>$.month===Pe);if(ce||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Vs||!ft||!ht)return null;const ne=ga[g],$e=He?.benchmarks?.[ne.key],We=Ns?.benchmarks?.[ne.key],rt=Vl(ne,$e),pt=Vl(ne,We),vt=tg(rt,pt),Rt=G(ne.key,$e),_s=Rt!==null,Ws=Rt!==null&&Rt>=1,as=_s?Math.round(Rt*60):rt>0?15:0,ks=he[ne.key],Bs=$=>$?$.targetType==="time"?`${$.startValue||0}s  ${$.targetValue}s`:$.targetType==="reps"?`${$.startReps||0}  ${$.targetReps} reps`:$.targetType==="distance"?`${$.startDistance||0}  ${$.targetDistance}cm`:`${$.startWeight||0}kg${$.startReps||0}  ${$.targetWeight}kg${$.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Yt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!_&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Be,onTouchStart:Ee,onTouchMove:Le,onTouchEnd:_e,children:[r.jsx("div",{className:`pb-ring-container slide-from-${ct.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:tb.map(($,xe)=>{const Ce=xe<Math.round(as);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:`pb-ring-tick ${Ce?Ws?"hit":"filled":"empty"}`,strokeWidth:$.thick?"3":"2"},xe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ne.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ne.name,Dt("strength",ne.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:$e?mh(ne,$e):"-"}),vt!==null&&r.jsxs("div",{className:`pb-ring-change ${vt>=0?"positive":"negative"}`,children:[vt>=0?"+":"",vt.toFixed(1),"%"]}),vt===null&&$e&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ks&&r.jsx("div",{className:`pb-ring-target ${Ws?"hit":""}`,children:Ws?"Target hit!":Bs(ks)}),!ks&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ga.map(($,xe)=>r.jsx("button",{className:`pb-dot ${xe===g?"active":""}`,onClick:()=>Zt(xe)},xe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Zt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Zt(g+1),disabled:g===ga.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(fP,{data:t,exerciseKey:ne.key,unit:ne.unit})]})]}),!_&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:He?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>z(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ve,disabled:d,children:"Reset All Goals"})]}),_&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ya(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Z(He?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ga.map($=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[$.key]?.weight??"",onChange:xe=>As($.key,"weight",xe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[$.key]?.reps??"",onChange:xe=>As($.key,"reps",xe.target.value),placeholder:"0"})]})]}):$.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:U[$.key]?.reps??"",onChange:xe=>As($.key,"reps",xe.target.value),placeholder:"0"})]})}):$.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:U[$.key]?.distance??"",onChange:xe=>As($.key,"distance",xe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[$.key]?.time??"",onChange:xe=>As($.key,"time",xe.target.value),placeholder:"0"})]})})]},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Z(He?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Tt,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{z(!1),R(he)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ga.map($=>{const xe=He?.benchmarks?.[$.key];let Ce="-";if(xe)switch($.unit){case"weight":(xe.weight||xe.reps)&&(Ce=`${xe.weight||0}kg  ${xe.reps||0}`);break;case"time":xe.time&&(Ce=`${xe.time}s`);break;case"reps":xe.reps&&(Ce=`${xe.reps} reps`);break;case"distance":xe.distance&&(Ce=`${xe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ce]})]}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[$.key]?.targetWeight??"",onChange:Se=>Xs($.key,"targetWeight",Se.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[$.key]?.targetReps??"",onChange:Se=>Xs($.key,"targetReps",Se.target.value),placeholder:"0"})]})]}):$.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[$.key]?.targetReps??"",onChange:Se=>Xs($.key,"targetReps",Se.target.value),placeholder:"0"})]})}):$.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[$.key]?.targetDistance??"",onChange:Se=>Xs($.key,"targetDistance",Se.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[$.key]?.targetValue??"",onChange:Se=>Xs($.key,"targetValue",Se.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{z(!1),R(he)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Pt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ya(st)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map($=>{const xe=He?.bodyMetrics?.[$.key],Ce=Ye($.key),Se=we[$.key],ke=de($.key),ot=ke!==null&&ke>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[$.name,Dt("metric",$.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Se&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Se.targetValue," ",$.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:xe!=null?`${xe} ${$.suffix}`:"-"}),Ce!==null&&r.jsxs("span",{className:`pb-metric-change ${Ce>0?"up":Ce<0?"down":"same"}`,children:[Ce>0?"+":"",Ce," ",$.suffix]})]})]}),ke!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ot?"hit":""}`,style:{width:`${Math.round(ke*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ot?"hit":""}`,children:ot?"Hit!":`${Math.round(ke*100)}%`})]})]},$.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:He?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ve,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ya(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),se(He?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map($=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[$.name," (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[$.key]??"",onChange:xe=>Ut($.key,xe.target.value),placeholder:"0"})]})},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),se(He?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:rs,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),D(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map($=>{const xe=He?.bodyMetrics?.[$.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",xe!=null?`${xe} ${$.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[$.key]?.targetValue??"",onChange:Ce=>fs($.key,Ce.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),D(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:qt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ue.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ue].reverse().map(($,xe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:$.label}),r.jsx("span",{className:"pb-achievement-date",children:ya($.achievedMonth)})]})]},xe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),Ke(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ae,onChange:$=>De($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:ya($.month)},$.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Pe,onChange:$=>Ke($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:ya($.month)},$.month))})]})]}),at&&Y&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ya(ae).split(" ")[0]}),r.jsx("span",{children:ya(Pe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ga.map($=>{const xe=at.benchmarks?.[$.key],Ce=Y.benchmarks?.[$.key],Se=Vl($,xe),ke=Vl($,Ce),ot=tg(ke,Se);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:xe?mh($,xe):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ce?mh($,Ce):"-"}),r.jsx("span",{className:`pb-compare-change ${ot!==null?ot>=0?"positive":"negative":""}`,children:ot!==null?`${ot>=0?"+":""}${ot.toFixed(1)}%`:"-"})]},$.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ya(ae).split(" ")[0]}),r.jsx("span",{children:ya(Pe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map($=>{const xe=at.bodyMetrics?.[$.key],Ce=Y.bodyMetrics?.[$.key],Se=xe!=null&&Ce!=null?parseFloat((Ce-xe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:xe!=null?`${xe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ce!=null?`${Ce}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Se!==null?Se>0?"positive":Se<0?"negative":"neutral":""}`,children:Se!==null?`${Se>0?"+":""}${Se} ${$.suffix}`:"-"})]},$.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map(($,xe)=>{const Ce=t.filter(Se=>Se.month<$.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ya($.month)}),$.benchmarks&&Object.keys($.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ga.map(Se=>{const ke=$.benchmarks[Se.key];if(!ke)return null;const ot=Ce?.benchmarks?.[Se.key],bt=Vl(Se,ke),Je=Vl(Se,ot),_t=tg(bt,Je);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Se.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:mh(Se,ke)}),_t!==null&&r.jsxs("span",{className:`pb-timeline-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]})]})]},Se.key)})]}),$.bodyMetrics&&Object.keys($.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(Se=>{const ke=$.bodyMetrics[Se.key];if(ke==null)return null;const ot=Ce?.bodyMetrics?.[Se.key],bt=ot!=null?parseFloat((ke-ot).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Se.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ke," ",Se.suffix]}),bt!==null&&r.jsxs("span",{className:`pb-timeline-change ${bt>0?"positive":bt<0?"negative":"neutral"}`,children:[bt>0?"+":"",bt," ",Se.suffix]})]})]},Se.key)})]})]})]},$.id)})})]})})]}),B&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>re(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:B.length===1?"Target Achieved!":`${B.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:B.map(($,xe)=>r.jsx("div",{className:"pb-celebration-badge",children:$.label},xe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Te&&r.jsxs("div",{className:`toast-notification ${Te.type}`,children:[r.jsx("span",{className:"toast-icon",children:Te.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Te.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ve(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),ht?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Hk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Hk.filter(n=>n.storagePath!==null);const gP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],$k={};Hk.forEach(n=>{$k[n.name]=n.group});function yP(n){return $k[n]||null}const Ia=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Oo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function bP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ba(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function fh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function D2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Bl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function sg(n,e){return!e||e===0?null:(n-e)/e*100}function vP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(z=>{const U=z.benchmarks?.[e];return U?t==="time"?U.time||0:(U.weight||0)*(U.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,_=p-y*2,x=g-y*2,T=i.map((z,U)=>{const Z=y+U/(i.length-1)*_,K=y+x-(z-u)/d*x;return{x:Z,y:K,value:z}}),V=T.map((z,U)=>`${U===0?"M":"L"} ${z.x} ${z.y}`).join(" "),W=V+` L ${T[T.length-1].x} ${y+x} L ${T[0].x} ${y+x} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradient)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((z,U)=>r.jsx("circle",{cx:z.x,cy:z.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((z,U)=>r.jsxs("span",{className:"pb-trend-label",children:[z.month.split("-")[1],"/",z.month.split("-")[0].slice(2)]},U))})]})}function xP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[_,x]=v.useState(!1),[T,V]=v.useState(!1),[W,z]=v.useState(!1),[U,Z]=v.useState({}),[K,se]=v.useState({}),[he,Me]=v.useState({}),[we,C]=v.useState({}),[E,R]=v.useState({}),[O,I]=v.useState(!1),[H,D]=v.useState({}),[Ue,lt]=v.useState([]),[B,re]=v.useState(null),[Te,Ve]=v.useState(null),[ee,L]=v.useState(!1),[ae,De]=v.useState(""),[Pe,Ke]=v.useState(""),[Be,gt]=v.useState({}),[Nt,ct]=v.useState({}),[Zt,Vs]=v.useState(null),[ft,ht]=v.useState(null),[ce,os]=v.useState(""),[Yt,Ct]=v.useState({}),yt=v.useRef(null),st=v.useRef(0),He=v.useRef(0),zt=v.useRef("right"),Ns=v.useCallback(j=>{y(N=>{const P=Math.max(0,Math.min(Ia.length-1,j));return P===N?N:(zt.current=P>N?"right":"left",P)})},[]),{currentUser:$s,isClient:Dt,clientData:Tt,loading:rs}=Br(),{isDark:As}=Sa(),Ut=Jn(),[Xs]=lS(),Pt=Xs.get("mode")==="corebuddy",fs=!Pt&&(!Tt?.clientType||Tt.clientType==="block"),qt=v.useCallback((j,N="info")=>{Ve({message:j,type:N}),setTimeout(()=>Ve(null),4e3)},[]);v.useEffect(()=>{!rs&&(!$s||!Dt)&&Ut("/")},[$s,Dt,rs,Ut]),v.useEffect(()=>{Tt&&(fs?ve():(async()=>{try{const[N,P,F]=await Promise.all([Rs(qe(pe,"coreBuddyPBs",Tt.id)),Rs(qe(pe,"coreBuddyTargets",Tt.id)),Rs(qe(pe,"coreBuddyAchievements",Tt.id))]);N.exists()&&gt(N.data().exercises||{}),P.exists()&&ct(P.data().targets||{}),F.exists()&&Vs(F.data())}catch(N){console.error("Error loading Core Buddy PBs:",N)}u(!1)})())},[Tt]);const ve=async()=>{try{const j=Ds(Bt(pe,"personalBests"),ms("clientId","==",Tt.id)),P=(await Es(j)).docs.map(tt=>({id:tt.id,...tt.data()}));P.sort((tt,Ze)=>tt.month.localeCompare(Ze.month)),i(P);const F=Ds(Bt(pe,"personalBestTargets"),ms("clientId","==",Tt.id)),me=await Es(F);if(!me.empty){const tt=me.docs[0].data();Me(tt.targets||{}),C(tt.metricTargets||{}),R(tt.targets||{}),D(tt.metricTargets||{})}const Fe=Ds(Bt(pe,"achievements"),ms("clientId","==",Tt.id)),ze=await Es(Fe);ze.empty||lt(ze.docs[0].data().badges||[])}catch(j){console.error("Error fetching personal bests:",j)}u(!1)},G=async()=>{if(!ft||!ce||!Tt)return;const j=parseFloat(ce),N=Be[ft];if(!N||j<=N.weight){qt("Target must be higher than current PB","error");return}p(!0);try{const P={...Nt,[ft]:{targetWeight:j,setAt:wt.now(),currentPBWhenSet:N.weight}};await Ss(qe(pe,"coreBuddyTargets",Tt.id),{clientId:Tt.id,targets:P,updatedAt:wt.now()}),ct(P),ht(null),os(""),qt("Target set!","success")}catch(P){console.error("Error saving target:",P),qt("Failed to save target","error")}p(!1)},de=j=>{if(!Zt?.badges)return!1;const N=Nt[j];return N?Zt.badges.some(P=>P.type==="pb_target"&&P.exercise===j&&P.targetWeight===N.targetWeight):!1},Ee=j=>{const N=Nt[j];if(!N)return null;const P=Be[j];if(!P)return 0;const F=N.currentPBWhenSet||0,me=N.targetWeight,Fe=me-F;return Fe<=0?P.weight>=me?1:0:Math.max(0,Math.min((P.weight-F)/Fe,1))},Le=bP(),_e=t.find(j=>j.month===Le),Ye=t.filter(j=>j.month<Le),at=Ye.length>0?Ye[Ye.length-1]:null;v.useEffect(()=>{_e?(Z(_e.benchmarks||{}),se(_e.bodyMetrics||{})):(Z({}),se({}))},[_e?.id]);const Y=async(j,N)=>{const P=[];if(j==="strength"?Ia.forEach(F=>{const me=he[F.key];if(!me)return;const Fe=N[F.key];if(!Fe)return;let ze;if(me.targetType==="time"){if(!me.targetValue)return;const tt=me.startValue||0,Ze=Fe.time||0,es=me.targetValue-tt;ze=es===0?Ze>=me.targetValue?1:0:Math.max(0,(Ze-tt)/es)}else{if(!me.targetWeight&&!me.targetReps)return;const tt=(me.startWeight||0)*(me.startReps||0),Ze=(me.targetWeight||0)*(me.targetReps||0),es=(Fe.weight||0)*(Fe.reps||0),js=Ze-tt;ze=js===0?es>=Ze?1:0:Math.max(0,(es-tt)/js)}if(ze>=1&&!(me.targetType==="time"?Ue.some(Ze=>Ze.type==="strength"&&Ze.key===F.key&&Ze.targetValue===me.targetValue):Ue.some(Ze=>Ze.type==="strength"&&Ze.key===F.key&&Ze.targetWeight===me.targetWeight&&Ze.targetReps===me.targetReps))){const Ze=me.targetType==="time"?`${F.name} ${me.targetValue}s`:`${F.name} ${me.targetWeight}kg  ${me.targetReps}`;P.push({type:"strength",key:F.key,...me.targetType==="time"?{targetType:"time",targetValue:me.targetValue}:{targetWeight:me.targetWeight,targetReps:me.targetReps},achievedMonth:Le,label:Ze})}}):Oo.forEach(F=>{const me=we[F.key];if(!me||!me.targetValue)return;const Fe=N[F.key];if(Fe==null)return;const ze=me.startValue||0,tt=me.targetValue,Ze=tt-ze;(Ze===0?Fe===tt?1:0:Math.max(0,(Fe-ze)/Ze))>=1&&(Ue.some(cs=>cs.type==="metric"&&cs.key===F.key&&cs.targetValue===tt)||P.push({type:"metric",key:F.key,targetValue:tt,achievedMonth:Le,label:`${F.name} ${tt}${F.suffix}`}))}),P.length>0){const F=[...Ue,...P];await Ss(qe(pe,"achievements",Tt.id),{clientId:Tt.id,badges:F,updatedAt:wt.now()}),lt(F),re(P),setTimeout(()=>re(null),5e3)}},ne=(j,N)=>{if(j==="strength"){const P=he[N];return P?P.targetType==="time"?Ue.some(F=>F.type==="strength"&&F.key===N&&F.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:Ue.some(F=>F.type==="strength"&&F.key===N&&F.targetWeight===P.targetWeight&&F.targetReps===P.targetReps):!1}else{const P=we[N];return!P||!P.targetValue?!1:Ue.some(F=>F.type==="metric"&&F.key===N&&F.targetValue===P.targetValue)}},$e=async()=>{p(!0);try{const j=`${Tt.id}_${Le}`,N=_e||{};await Ss(qe(pe,"personalBests",j),{clientId:Tt.id,month:Le,benchmarks:U,bodyMetrics:N.bodyMetrics||K||{},createdAt:N.createdAt||wt.now(),updatedAt:wt.now()}),await Y("strength",U),qt("Benchmarks saved!","success"),x(!1),await ve()}catch(j){console.error("Error saving benchmarks:",j),qt("Failed to save. Please try again.","error")}p(!1)},We=async()=>{p(!0);try{const j=`${Tt.id}_${Le}`,N=_e||{};await Ss(qe(pe,"personalBests",j),{clientId:Tt.id,month:Le,benchmarks:N.benchmarks||U||{},bodyMetrics:K,createdAt:N.createdAt||wt.now(),updatedAt:wt.now()}),await Y("metric",K),qt("Body metrics saved!","success"),V(!1),await ve()}catch(j){console.error("Error saving metrics:",j),qt("Failed to save. Please try again.","error")}p(!1)},rt=(j,N,P)=>{Z(F=>({...F,[j]:{...F[j],[N]:P===""?"":parseFloat(P)}}))},pt=(j,N)=>{se(P=>({...P,[j]:N===""?"":parseFloat(N)}))},vt=(j,N,P)=>{R(F=>({...F,[j]:{...F[j],[N]:P===""?"":parseFloat(P)}}))},Rt=async()=>{p(!0);try{const j=`targets_${Tt.id}`,N=_e?.benchmarks||{},P={};Ia.forEach(F=>{const me=N[F.key];F.unit==="time"?E[F.key]?.targetValue&&(P[F.key]={targetType:"time",targetValue:E[F.key].targetValue,startValue:me?.time||0}):(E[F.key]?.targetWeight||E[F.key]?.targetReps)&&(P[F.key]={targetWeight:E[F.key].targetWeight||0,targetReps:E[F.key].targetReps||0,startWeight:me?.weight||0,startReps:me?.reps||0})}),await Ss(qe(pe,"personalBestTargets",j),{clientId:Tt.id,targets:P,metricTargets:we,updatedAt:wt.now()}),Me(P),R(P),qt("Targets saved!","success"),z(!1)}catch(j){console.error("Error saving targets:",j),qt("Failed to save targets.","error")}p(!1)},_s=(j,N)=>{D(P=>({...P,[j]:{...P[j],targetValue:N===""?"":parseFloat(N)}}))},Ws=async()=>{p(!0);try{const j=`targets_${Tt.id}`,N={};Oo.forEach(P=>{if(H[P.key]?.targetValue){const F=_e?.bodyMetrics?.[P.key]||0;N[P.key]={targetValue:H[P.key].targetValue,startValue:F}}}),await Ss(qe(pe,"personalBestTargets",j),{clientId:Tt.id,targets:he,metricTargets:N,updatedAt:wt.now()}),C(N),D(N),qt("Metric targets saved!","success"),I(!1)}catch(j){console.error("Error saving metric targets:",j),qt("Failed to save targets.","error")}p(!1)},as=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const j=qe(pe,"personalBestTargets",`targets_${Tt.id}`);await Er(j),Me({}),C({}),R({}),D({}),qt("All goals have been reset","success")}catch(j){console.error("Error resetting targets:",j),qt("Failed to reset goals","error")}p(!1)}},ks=(j,N)=>{const P=he[j];if(!P||!N)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const tt=P.startValue||0,Ze=P.targetValue,es=N.time||0,js=Ze-tt;return js<=0?es>=Ze?1:0:Math.max(0,Math.min((es-tt)/js,1))}if(!P.targetWeight&&!P.targetReps)return null;const F=(P.startWeight||0)*(P.startReps||0),me=(P.targetWeight||0)*(P.targetReps||0),Fe=(N.weight||0)*(N.reps||0),ze=me-F;return ze<=0?Fe>=me?1:0:Math.max(0,Math.min((Fe-F)/ze,1))},Bs=j=>{const N=we[j];if(!N||!N.targetValue)return null;const P=_e?.bodyMetrics?.[j];if(P==null)return null;const F=N.startValue||0,me=N.targetValue,Fe=me-F;return Fe===0?P===me?1:0:Math.max(0,Math.min((P-F)/Fe,1))},$=j=>{st.current=j.touches[0].clientX,He.current=0},xe=j=>{He.current=j.touches[0].clientX-st.current},Ce=()=>{He.current<-50?Ns(g+1):He.current>50&&Ns(g-1),He.current=0},Se=j=>{const N=_e?.bodyMetrics?.[j],P=at?.bodyMetrics?.[j];return N==null||P==null?null:parseFloat((N-P).toFixed(2))},ke=t.find(j=>j.month===ae),ot=t.find(j=>j.month===Pe);if(rs||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!$s||!Dt||!Tt)return null;if(fs&&Tt?.isJunior)return r.jsx(pP,{});const bt=Ia[g],Je=_e?.benchmarks?.[bt.key],_t=at?.benchmarks?.[bt.key],jt=Bl(bt,Je),Cs=Bl(bt,_t),un=sg(jt,Cs),fn=ks(bt.key,Je),kn=fn!==null,Mn=fn!==null&&fn>=1,pn=kn?Math.round(fn*60):jt>0?15:0,Fs=he[bt.key];return r.jsx(ja,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Ut(Pt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:fs?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!fs&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Be).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const j={},N=[];return Object.entries(Be).forEach(([P,F])=>{const me=yP(P);me?(j[me]||(j[me]=[]),j[me].push([P,F])):N.push([P,F])}),Object.values(j).forEach(P=>P.sort(([F],[me])=>F.localeCompare(me))),N.sort(([P],[F])=>P.localeCompare(F)),r.jsxs(r.Fragment,{children:[gP.map(P=>{const F=j[P.key];if(!F||F.length===0)return null;const me=!!Yt[P.key],Fe=F.reduce((ze,[,tt])=>!ze||tt.weight>ze.weight?tt:ze,null);return r.jsxs("div",{className:`pb-cb-group ${me?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Ct(ze=>({...ze,[P.key]:!ze[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[F.length," PB",F.length!==1?"s":""]}),Fe&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Fe.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${me?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:me?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:F.map(([ze,tt],Ze)=>{const es=Nt[ze],js=Ee(ze),cs=js!==null&&js>=1,ls=de(ze),zs=js!==null?Math.round(js*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${Ze*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:T2.map((jn,or)=>{const us=or<zs;return r.jsx("line",{x1:jn.x1,y1:jn.y1,x2:jn.x2,y2:jn.y2,className:`pb-ring-tick ${us?cs?"hit":"filled":"empty"}`,style:us&&!cs?{stroke:P.color}:void 0,strokeWidth:jn.thick?"2":"1.5"},or)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:ls?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ze}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[tt.weight,"kg  ",tt.reps]}),tt.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(tt.achievedAt.toDate?tt.achievedAt.toDate():new Date(tt.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),es&&cs&&!ls&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ls&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{ht(ze),os("")},children:es?cs&&ls?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),es&&!cs&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[tt.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",es.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((js||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((js||0)*100),"%"]})]}),es&&cs&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ze)})})})]},P.key)}),N.length>0&&(()=>{const P=!!Yt.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Ct(F=>({...F,other:!F.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[N.length," PB",N.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:N.map(([F,me],Fe)=>{const ze=Nt[F],tt=Ee(F),Ze=tt!==null&&tt>=1,es=de(F),js=tt!==null?Math.round(tt*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Fe*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:T2.map((cs,ls)=>{const zs=ls<js;return r.jsx("line",{x1:cs.x1,y1:cs.y1,x2:cs.x2,y2:cs.y2,className:`pb-ring-tick ${zs?Ze?"hit":"filled":"empty"}`,strokeWidth:cs.thick?"2":"1.5"},ls)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:es?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:F}),r.jsxs("div",{className:"pb-cb-card-value",children:[me.weight,"kg  ",me.reps]}),me.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(me.achievedAt.toDate?me.achievedAt.toDate():new Date(me.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ze&&Ze&&!es&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),es&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{ht(F),os("")},children:ze?Ze&&es?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ze&&!Ze&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[me.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ze.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((tt||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((tt||0)*100),"%"]})]}),ze&&Ze&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},F)})})})]})})()]})})()}),Object.keys(Be).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>Ut("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),ft&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>ht(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:j=>j.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:ft}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Be[ft]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ce,onChange:j=>os(j.target.value),placeholder:String((Be[ft]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>ht(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:G,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),fs&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!_&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:yt,onTouchStart:$,onTouchMove:xe,onTouchEnd:Ce,children:[r.jsx("div",{className:`pb-ring-container slide-from-${zt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:tb.map((j,N)=>{const P=N<Math.round(pn);return r.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,className:`pb-ring-tick ${P?Mn?"hit":"filled":"empty"}`,strokeWidth:j.thick?"3":"2"},N)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:bt.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[bt.name,ne("strength",bt.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Je?bt.unit==="time"?fh(Je.time):D2(Je.weight,Je.reps):"-"}),un!==null&&r.jsxs("div",{className:`pb-ring-change ${un>=0?"positive":"negative"}`,children:[un>=0?"+":"",un.toFixed(1),"%"]}),un===null&&Je&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Fs&&r.jsx("div",{className:`pb-ring-target ${Mn?"hit":""}`,children:Mn?"Target hit!":Fs.targetType==="time"?`${Fs.startValue||0}s  ${Fs.targetValue}s`:`${Fs.startWeight||0}kg${Fs.startReps||0}  ${Fs.targetWeight}kg${Fs.targetReps}`}),!Fs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Ia.map((j,N)=>r.jsx("button",{className:`pb-dot ${N===g?"active":""}`,onClick:()=>Ns(N)},N))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ns(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ns(g+1),disabled:g===Ia.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(vP,{data:t,exerciseKey:bt.key,unit:bt.unit})]})]}),!_&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:_e?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>z(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:as,disabled:d,children:"Reset All Goals"})]}),_&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ba(Le)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Z(_e?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Ia.map(j=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),j.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[j.key]?.weight??"",onChange:N=>rt(j.key,"weight",N.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[j.key]?.reps??"",onChange:N=>rt(j.key,"reps",N.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[j.key]?.time??"",onChange:N=>rt(j.key,"time",N.target.value),placeholder:"0"})]})})]},j.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Z(_e?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:$e,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{z(!1),R(he)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ia.map(j=>{const N=_e?.benchmarks?.[j.key];let P="-";return N&&(j.unit==="time"&&N.time?P=`${N.time}s`:(N.weight||N.reps)&&(P=`${N.weight||0}kg  ${N.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),j.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[j.key]?.targetWeight??"",onChange:F=>vt(j.key,"targetWeight",F.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[j.key]?.targetReps??"",onChange:F=>vt(j.key,"targetReps",F.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[j.key]?.targetValue??"",onChange:F=>vt(j.key,"targetValue",F.target.value),placeholder:"0"})]})})]},j.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{z(!1),R(he)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Rt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ba(Le)}),r.jsx("div",{className:"pb-metrics-list",children:Oo.map(j=>{const N=_e?.bodyMetrics?.[j.key],P=Se(j.key),F=we[j.key],me=Bs(j.key),Fe=me!==null&&me>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[j.name,ne("metric",j.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),F&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",F.targetValue," ",j.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:N!=null?`${N} ${j.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",j.suffix]})]})]}),me!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Fe?"hit":""}`,style:{width:`${Math.round(me*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Fe?"hit":""}`,children:Fe?"Hit!":`${Math.round(me*100)}%`})]})]},j.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:_e?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(we).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(we).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:as,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ba(Le)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),se(_e?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Oo.map(j=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[j.name," (",j.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[j.key]??"",onChange:N=>pt(j.key,N.target.value),placeholder:"0"})]})},j.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),se(_e?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:We,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),D(we)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Oo.map(j=>{const N=_e?.bodyMetrics?.[j.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",N!=null?`${N} ${j.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",j.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[j.key]?.targetValue??"",onChange:P=>_s(j.key,P.target.value),placeholder:"0"})]})})]},j.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),D(we)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ws,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ue.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ue].reverse().map((j,N)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:j.label}),r.jsx("span",{className:"pb-achievement-date",children:ba(j.achievedMonth)})]})]},N))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),Ke(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ae,onChange:j=>De(j.target.value),children:t.map(j=>r.jsx("option",{value:j.month,children:ba(j.month)},j.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Pe,onChange:j=>Ke(j.target.value),children:t.map(j=>r.jsx("option",{value:j.month,children:ba(j.month)},j.month))})]})]}),ke&&ot&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ba(ae).split(" ")[0]}),r.jsx("span",{children:ba(Pe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Ia.map(j=>{const N=ke.benchmarks?.[j.key],P=ot.benchmarks?.[j.key],F=Bl(j,N),me=Bl(j,P),Fe=sg(me,F);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:j.name}),r.jsx("span",{className:"pb-compare-val",children:N?j.unit==="time"?fh(N.time):`${N.weight}x${N.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?j.unit==="time"?fh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Fe!==null?Fe>=0?"positive":"negative":""}`,children:Fe!==null?`${Fe>=0?"+":""}${Fe.toFixed(1)}%`:"-"})]},j.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ba(ae).split(" ")[0]}),r.jsx("span",{children:ba(Pe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Oo.map(j=>{const N=ke.bodyMetrics?.[j.key],P=ot.bodyMetrics?.[j.key],F=N!=null&&P!=null?parseFloat((P-N).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:j.name}),r.jsx("span",{className:"pb-compare-val",children:N!=null?`${N}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${F!==null?F>0?"positive":F<0?"negative":"neutral":""}`,children:F!==null?`${F>0?"+":""}${F} ${j.suffix}`:"-"})]},j.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((j,N)=>{const P=t.find(F=>F.month<j.month&&t.indexOf(F)===t.indexOf(j)-1)||t.filter(F=>F.month<j.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ba(j.month)}),j.benchmarks&&Object.keys(j.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Ia.map(F=>{const me=j.benchmarks[F.key];if(!me)return null;const Fe=P?.benchmarks?.[F.key],ze=Bl(F,me),tt=Bl(F,Fe),Ze=sg(ze,tt);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:F.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:F.unit==="time"?fh(me.time):D2(me.weight,me.reps)}),Ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ze>=0?"positive":"negative"}`,children:[Ze>=0?"+":"",Ze.toFixed(1),"%"]})]})]},F.key)})]}),j.bodyMetrics&&Object.keys(j.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Oo.map(F=>{const me=j.bodyMetrics[F.key];if(me==null)return null;const Fe=P?.bodyMetrics?.[F.key],ze=Fe!=null?parseFloat((me-Fe).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:F.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[me," ",F.suffix]}),ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${ze>0?"positive":ze<0?"negative":"neutral"}`,children:[ze>0?"+":"",ze," ",F.suffix]})]})]},F.key)})]})]})]},j.id)})})]})})]})]}),B&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>re(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:B.length===1?"Target Achieved!":`${B.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:B.map((j,N)=>r.jsx("div",{className:"pb-celebration-badge",children:j.label},N))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Te&&r.jsxs("div",{className:`toast-notification ${Te.type}`,children:[r.jsx("span",{className:"toast-icon",children:Te.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Te.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ve(null),children:""})]}),fs&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ut("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ut("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ut("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Tt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ut("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Pt&&r.jsx(la,{active:"progress"})]})})}const wP=v.lazy(()=>Rr(()=>import("./Dashboard-ChH7y0b8.js"),__vite__mapDeps([0,1]))),_P=v.lazy(()=>Rr(()=>import("./AddClient-DWWf72eQ.js"),__vite__mapDeps([2,3]))),kP=v.lazy(()=>Rr(()=>import("./ClientDashboard-Dme-BXET.js"),[])),jP=v.lazy(()=>Rr(()=>import("./ClientForms-lf5OhHp1.js"),__vite__mapDeps([4,5]))),TP=v.lazy(()=>Rr(()=>import("./ClientTools-BbRCjf0I.js"),__vite__mapDeps([6,7]))),EP=v.lazy(()=>Rr(()=>import("./MacroCalculator-BNUY6BR9.js"),__vite__mapDeps([8,7]))),SP=v.lazy(()=>Rr(()=>import("./ProteinSnacks-CsA9tRsY.js"),__vite__mapDeps([9,7]))),NP=v.lazy(()=>Rr(()=>import("./DailyMotivation-DTt7yusu.js"),__vite__mapDeps([10,7]))),CP=v.lazy(()=>Rr(()=>import("./CircuitDashboard-BpEA_YGB.js"),__vite__mapDeps([11,12]))),RP=v.lazy(()=>Rr(()=>import("./CircuitBooking-C6YzQ8iS.js"),__vite__mapDeps([13,14,12]))),AP=v.lazy(()=>Rr(()=>import("./Leaderboard-ZRomYbo5.js"),__vite__mapDeps([15,16]))),MP=v.lazy(()=>Rr(()=>import("./UpgradePage-D4OGWk6u.js"),__vite__mapDeps([17,18,19]))),IP=v.lazy(()=>Rr(()=>import("./SignUp-Cmk13ZcS.js"),[])),DP=v.lazy(()=>Rr(()=>import("./Onboarding-NeeqJzxB.js"),__vite__mapDeps([20,18,21])));function PP({children:n}){const{pathname:e}=Ea();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function LP(){const n=Jn();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function OP(){return r.jsx(YI,{children:r.jsx(KI,{children:r.jsx(ZI,{children:r.jsxs(nS,{basename:"/login",children:[r.jsx(LP,{}),r.jsx(PP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(ME,{children:[r.jsx(tn,{path:"/",element:r.jsx(sD,{})}),r.jsx(tn,{path:"/dashboard",element:r.jsx(wP,{})}),r.jsx(tn,{path:"/add-client",element:r.jsx(_P,{})}),r.jsx(tn,{path:"/client",element:r.jsx(kP,{})}),r.jsx(tn,{path:"/client/forms",element:r.jsx(jP,{})}),r.jsx(tn,{path:"/client/tools",element:r.jsx(TP,{})}),r.jsx(tn,{path:"/client/tools/macros",element:r.jsx(EP,{})}),r.jsx(tn,{path:"/client/tools/snacks",element:r.jsx(SP,{})}),r.jsx(tn,{path:"/client/tools/motivation",element:r.jsx(NP,{})}),r.jsx(tn,{path:"/client/personal-bests",element:r.jsx(xP,{})}),r.jsx(tn,{path:"/client/circuit",element:r.jsx(CP,{})}),r.jsx(tn,{path:"/client/circuit/booking",element:r.jsx(RP,{})}),r.jsx(tn,{path:"/client/core-buddy",element:r.jsx(jD,{})}),r.jsx(tn,{path:"/client/core-buddy/nutrition",element:r.jsx(Dl,{feature:"nutrition",children:r.jsx(SD,{})})}),r.jsx(tn,{path:"/client/core-buddy/workouts",element:r.jsx(UD,{})}),r.jsx(tn,{path:"/client/core-buddy/programmes",element:r.jsx(Dl,{feature:"programmes",children:r.jsx($D,{})})}),r.jsx(tn,{path:"/client/core-buddy/achievements",element:r.jsx(Dl,{feature:"achievements",children:r.jsx(XD,{})})}),r.jsx(tn,{path:"/client/core-buddy/consistency",element:r.jsx(Dl,{feature:"consistency",children:r.jsx(rP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddies",element:r.jsx(Dl,{feature:"buddies",children:r.jsx(aP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddy",element:r.jsx(uP,{})}),r.jsx(tn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(cP,{})}),r.jsx(tn,{path:"/client/leaderboard",element:r.jsx(Dl,{feature:"leaderboard",children:r.jsx(AP,{})})}),r.jsx(tn,{path:"/signup",element:r.jsx(IP,{})}),r.jsx(tn,{path:"/onboarding",element:r.jsx(DP,{})}),r.jsx(tn,{path:"/upgrade",element:r.jsx(MP,{})}),r.jsx(tn,{path:"*",element:r.jsx(RE,{to:"/",replace:!0})})]})})})]})})})})}AT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(OP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Tr as A,la as C,ja as P,wt as T,wa as a,Er as b,Bt as c,pe as d,qe as e,YC as f,Es as g,e4 as h,Ss as i,r as j,Rs as k,Br as l,Sa as m,Jn as n,Kh as o,tb as p,Ds as q,v as r,UP as s,_m as t,Pa as u,tD as v,ms as w,eD as x,VP as y,lS as z};
