const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DVZmKOVY.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-CiteS8CF.css","assets/AddClient-CT6H96gW.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-Dn9WfetL.js","assets/ClientDashboard-CSizO3dZ.css","assets/ClientForms-DKP15MSV.js","assets/ClientForms-QNtUjQJR.css","assets/ClientTools-B_NHKQ6R.js","assets/ClientTools-Bezn5TAX.css","assets/MacroCalculator-BssN6zrR.js","assets/ProteinSnacks-BJKddTQs.js","assets/DailyMotivation-C0JEZePn.js","assets/CircuitDashboard-lMbDFBP8.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BmptGwmy.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-vyMMXtSi.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-CpFRoILC.js","assets/Leaderboard-Bul59-ui.css","assets/UpgradePage-D0Y_nWSD.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-COYPjotf.css","assets/Onboarding-B9Ti3YVo.js","assets/Onboarding-Cu4GeezY.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var Tg={exports:{}},Qc={};var Hb;function CT(){if(Hb)return Qc;Hb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var g in l)g!=="key"&&(u[g]=l[g])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Qc.Fragment=e,Qc.jsx=t,Qc.jsxs=t,Qc}var qb;function NT(){return qb||(qb=1,Tg.exports=CT()),Tg.exports}var a=NT(),Sg={exports:{}},Ot={};var $b;function AT(){if($b)return Ot;$b=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),T=Symbol.iterator;function R(V){return V===null||typeof V!="object"?null:(V=T&&V[T]||V["@@iterator"],typeof V=="function"?V:null)}var q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,U={};function K(V,ce,je){this.props=V,this.context=ce,this.refs=U,this.updater=je||q}K.prototype.isReactComponent={},K.prototype.setState=function(V,ce){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ce,"setState")},K.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function Y(){}Y.prototype=K.prototype;function ee(V,ce,je){this.props=V,this.context=ce,this.refs=U,this.updater=je||q}var ye=ee.prototype=new Y;ye.constructor=ee,G(ye,K.prototype),ye.isPureReactComponent=!0;var ke=Array.isArray;function ve(){}var I={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function O(V,ce,je){var Se=je.ref;return{$$typeof:s,type:V,key:ce,ref:Se!==void 0?Se:null,props:je}}function B(V,ce){return O(V.type,ce,V.props)}function D(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function L(V){var ce={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(je){return ce[je]})}var A=/\/+/g;function Le(V,ce){return typeof V=="object"&&V!==null&&V.key!=null?L(""+V.key):ce.toString(36)}function st(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ve,ve):(V.status="pending",V.then(function(ce){V.status==="pending"&&(V.status="fulfilled",V.value=ce)},function(ce){V.status==="pending"&&(V.status="rejected",V.reason=ce)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function te(V,ce,je,Se,_e){var Pe=typeof V;(Pe==="undefined"||Pe==="boolean")&&(V=null);var ze=!1;if(V===null)ze=!0;else switch(Pe){case"bigint":case"string":case"number":ze=!0;break;case"object":switch(V.$$typeof){case s:case e:ze=!0;break;case b:return ze=V._init,te(ze(V._payload),ce,je,Se,_e)}}if(ze)return _e=_e(V),ze=Se===""?"."+Le(V,0):Se,ke(_e)?(je="",ze!=null&&(je=ze.replace(A,"$&/")+"/"),te(_e,ce,je,"",function(Qt){return Qt})):_e!=null&&(D(_e)&&(_e=B(_e,je+(_e.key==null||V&&V.key===_e.key?"":(""+_e.key).replace(A,"$&/")+"/")+ze)),ce.push(_e)),1;ze=0;var Ye=Se===""?".":Se+":";if(ke(V))for(var Je=0;Je<V.length;Je++)Se=V[Je],Pe=Ye+Le(Se,Je),ze+=te(Se,ce,je,Pe,_e);else if(Je=R(V),typeof Je=="function")for(V=Je.call(V),Je=0;!(Se=V.next()).done;)Se=Se.value,Pe=Ye+Le(Se,Je++),ze+=te(Se,ce,je,Pe,_e);else if(Pe==="object"){if(typeof V.then=="function")return te(st(V),ce,je,Se,_e);throw ce=String(V),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return ze}function Te(V,ce,je){if(V==null)return V;var Se=[],_e=0;return te(V,Se,"","",function(Pe){return ce.call(je,Pe,_e++)}),Se}function He(V){if(V._status===-1){var ce=V._result;ce=ce(),ce.then(function(je){(V._status===0||V._status===-1)&&(V._status=1,V._result=je)},function(je){(V._status===0||V._status===-1)&&(V._status=2,V._result=je)}),V._status===-1&&(V._status=0,V._result=ce)}if(V._status===1)return V._result.default;throw V._result}var Ae=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},We={map:Te,forEach:function(V,ce,je){Te(V,function(){ce.apply(this,arguments)},je)},count:function(V){var ce=0;return Te(V,function(){ce++}),ce},toArray:function(V){return Te(V,function(ce){return ce})||[]},only:function(V){if(!D(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Ot.Activity=k,Ot.Children=We,Ot.Component=K,Ot.Fragment=t,Ot.Profiler=l,Ot.PureComponent=ee,Ot.StrictMode=i,Ot.Suspense=y,Ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Ot.__COMPILER_RUNTIME={__proto__:null,c:function(V){return I.H.useMemoCache(V)}},Ot.cache=function(V){return function(){return V.apply(null,arguments)}},Ot.cacheSignal=function(){return null},Ot.cloneElement=function(V,ce,je){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Se=G({},V.props),_e=V.key;if(ce!=null)for(Pe in ce.key!==void 0&&(_e=""+ce.key),ce)!E.call(ce,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&ce.ref===void 0||(Se[Pe]=ce[Pe]);var Pe=arguments.length-2;if(Pe===1)Se.children=je;else if(1<Pe){for(var ze=Array(Pe),Ye=0;Ye<Pe;Ye++)ze[Ye]=arguments[Ye+2];Se.children=ze}return O(V.type,_e,Se)},Ot.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:u,_context:V},V},Ot.createElement=function(V,ce,je){var Se,_e={},Pe=null;if(ce!=null)for(Se in ce.key!==void 0&&(Pe=""+ce.key),ce)E.call(ce,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(_e[Se]=ce[Se]);var ze=arguments.length-2;if(ze===1)_e.children=je;else if(1<ze){for(var Ye=Array(ze),Je=0;Je<ze;Je++)Ye[Je]=arguments[Je+2];_e.children=Ye}if(V&&V.defaultProps)for(Se in ze=V.defaultProps,ze)_e[Se]===void 0&&(_e[Se]=ze[Se]);return O(V,Pe,_e)},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(V){return{$$typeof:g,render:V}},Ot.isValidElement=D,Ot.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:He}},Ot.memo=function(V,ce){return{$$typeof:p,type:V,compare:ce===void 0?null:ce}},Ot.startTransition=function(V){var ce=I.T,je={};I.T=je;try{var Se=V(),_e=I.S;_e!==null&&_e(je,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(ve,Ae)}catch(Pe){Ae(Pe)}finally{ce!==null&&je.types!==null&&(ce.types=je.types),I.T=ce}},Ot.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Ot.use=function(V){return I.H.use(V)},Ot.useActionState=function(V,ce,je){return I.H.useActionState(V,ce,je)},Ot.useCallback=function(V,ce){return I.H.useCallback(V,ce)},Ot.useContext=function(V){return I.H.useContext(V)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(V,ce){return I.H.useDeferredValue(V,ce)},Ot.useEffect=function(V,ce){return I.H.useEffect(V,ce)},Ot.useEffectEvent=function(V){return I.H.useEffectEvent(V)},Ot.useId=function(){return I.H.useId()},Ot.useImperativeHandle=function(V,ce,je){return I.H.useImperativeHandle(V,ce,je)},Ot.useInsertionEffect=function(V,ce){return I.H.useInsertionEffect(V,ce)},Ot.useLayoutEffect=function(V,ce){return I.H.useLayoutEffect(V,ce)},Ot.useMemo=function(V,ce){return I.H.useMemo(V,ce)},Ot.useOptimistic=function(V,ce){return I.H.useOptimistic(V,ce)},Ot.useReducer=function(V,ce,je){return I.H.useReducer(V,ce,je)},Ot.useRef=function(V){return I.H.useRef(V)},Ot.useState=function(V){return I.H.useState(V)},Ot.useSyncExternalStore=function(V,ce,je){return I.H.useSyncExternalStore(V,ce,je)},Ot.useTransition=function(){return I.H.useTransition()},Ot.version="19.2.4",Ot}var Wb;function Xp(){return Wb||(Wb=1,Sg.exports=AT()),Sg.exports}var w=Xp(),Cg={exports:{}},Xc={},Ng={exports:{}},Ag={};var Gb;function RT(){return Gb||(Gb=1,(function(s){function e(te,Te){var He=te.length;te.push(Te);e:for(;0<He;){var Ae=He-1>>>1,We=te[Ae];if(0<l(We,Te))te[Ae]=Te,te[He]=We,He=Ae;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var Te=te[0],He=te.pop();if(He!==Te){te[0]=He;e:for(var Ae=0,We=te.length,V=We>>>1;Ae<V;){var ce=2*(Ae+1)-1,je=te[ce],Se=ce+1,_e=te[Se];if(0>l(je,He))Se<We&&0>l(_e,je)?(te[Ae]=_e,te[Se]=He,Ae=Se):(te[Ae]=je,te[ce]=He,Ae=ce);else if(Se<We&&0>l(_e,He))te[Ae]=_e,te[Se]=He,Ae=Se;else break e}}return Te}function l(te,Te){var He=te.sortIndex-Te.sortIndex;return He!==0?He:te.id-Te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var y=[],p=[],b=1,k=null,T=3,R=!1,q=!1,G=!1,U=!1,K=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function ye(te){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=te)i(p),Te.sortIndex=Te.expirationTime,e(y,Te);else break;Te=t(p)}}function ke(te){if(G=!1,ye(te),!q)if(t(y)!==null)q=!0,ve||(ve=!0,L());else{var Te=t(p);Te!==null&&st(ke,Te.startTime-te)}}var ve=!1,I=-1,E=5,O=-1;function B(){return U?!0:!(s.unstable_now()-O<E)}function D(){if(U=!1,ve){var te=s.unstable_now();O=te;var Te=!0;try{e:{q=!1,G&&(G=!1,Y(I),I=-1),R=!0;var He=T;try{t:{for(ye(te),k=t(y);k!==null&&!(k.expirationTime>te&&B());){var Ae=k.callback;if(typeof Ae=="function"){k.callback=null,T=k.priorityLevel;var We=Ae(k.expirationTime<=te);if(te=s.unstable_now(),typeof We=="function"){k.callback=We,ye(te),Te=!0;break t}k===t(y)&&i(y),ye(te)}else i(y);k=t(y)}if(k!==null)Te=!0;else{var V=t(p);V!==null&&st(ke,V.startTime-te),Te=!1}}break e}finally{k=null,T=He,R=!1}Te=void 0}}finally{Te?L():ve=!1}}}var L;if(typeof ee=="function")L=function(){ee(D)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Le=A.port2;A.port1.onmessage=D,L=function(){Le.postMessage(null)}}else L=function(){K(D,0)};function st(te,Te){I=K(function(){te(s.unstable_now())},Te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(te){te.callback=null},s.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<te?Math.floor(1e3/te):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(te){switch(T){case 1:case 2:case 3:var Te=3;break;default:Te=T}var He=T;T=Te;try{return te()}finally{T=He}},s.unstable_requestPaint=function(){U=!0},s.unstable_runWithPriority=function(te,Te){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var He=T;T=te;try{return Te()}finally{T=He}},s.unstable_scheduleCallback=function(te,Te,He){var Ae=s.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?Ae+He:Ae):He=Ae,te){case 1:var We=-1;break;case 2:We=250;break;case 5:We=1073741823;break;case 4:We=1e4;break;default:We=5e3}return We=He+We,te={id:b++,callback:Te,priorityLevel:te,startTime:He,expirationTime:We,sortIndex:-1},He>Ae?(te.sortIndex=He,e(p,te),t(y)===null&&te===t(p)&&(G?(Y(I),I=-1):G=!0,st(ke,He-Ae))):(te.sortIndex=We,e(y,te),q||R||(q=!0,ve||(ve=!0,L()))),te},s.unstable_shouldYield=B,s.unstable_wrapCallback=function(te){var Te=T;return function(){var He=T;T=Te;try{return te.apply(this,arguments)}finally{T=He}}}})(Ag)),Ag}var Kb;function IT(){return Kb||(Kb=1,Ng.exports=RT()),Ng.exports}var Rg={exports:{}},Gs={};var Yb;function MT(){if(Yb)return Gs;Yb=1;var s=Xp();function e(y){var p="https://react.dev/errors/"+y;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(y,p,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:y,containerInfo:p,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(y,p){if(y==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Gs.createPortal=function(y,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(y,p,null,b)},Gs.flushSync=function(y){var p=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=p,i.p=b,i.d.f()}},Gs.preconnect=function(y,p){typeof y=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(y,p))},Gs.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},Gs.preinit=function(y,p){if(typeof y=="string"&&p&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,R=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?i.d.S(y,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:k,integrity:T,fetchPriority:R}):b==="script"&&i.d.X(y,{crossOrigin:k,integrity:T,fetchPriority:R,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Gs.preinitModule=function(y,p){if(typeof y=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=g(p.as,p.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(y)},Gs.preload=function(y,p){if(typeof y=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,k=g(b,p.crossOrigin);i.d.L(y,b,{crossOrigin:k,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Gs.preloadModule=function(y,p){if(typeof y=="string")if(p){var b=g(p.as,p.crossOrigin);i.d.m(y,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(y)},Gs.requestFormReset=function(y){i.d.r(y)},Gs.unstable_batchedUpdates=function(y,p){return y(p)},Gs.useFormState=function(y,p,b){return d.H.useFormState(y,p,b)},Gs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Gs.version="19.2.4",Gs}var Qb;function DT(){if(Qb)return Rg.exports;Qb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rg.exports=MT(),Rg.exports}var Xb;function LT(){if(Xb)return Xc;Xb=1;var s=IT(),e=Xp(),t=DT();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(u(n)!==n)throw Error(i(188))}function p(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===c)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,j=f.child;j;){if(j===o){x=!0,o=f,c=m;break}if(j===c){x=!0,c=f,o=m;break}j=j.sibling}if(!x){for(j=m.child;j;){if(j===o){x=!0,o=m,c=f;break}if(j===c){x=!0,c=m,o=f;break}j=j.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,T=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),q=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Le(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case K:return"Profiler";case U:return"StrictMode";case ke:return"Suspense";case ve:return"SuspenseList";case O:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case q:return"Portal";case ee:return n.displayName||"Context";case Y:return(n._context.displayName||"Context")+".Consumer";case ye:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case I:return r=n.displayName||null,r!==null?r:Le(n.type)||"Memo";case E:r=n._payload,n=n._init;try{return Le(n(r))}catch{}}return null}var st=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He={pending:!1,data:null,method:null,action:null},Ae=[],We=-1;function V(n){return{current:n}}function ce(n){0>We||(n.current=Ae[We],Ae[We]=null,We--)}function je(n,r){We++,Ae[We]=n.current,n.current=r}var Se=V(null),_e=V(null),Pe=V(null),ze=V(null);function Ye(n,r){switch(je(Pe,r),je(_e,n),je(Se,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?hb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=hb(r),n=fb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ce(Se),je(Se,n)}function Je(){ce(Se),ce(_e),ce(Pe)}function Qt(n){n.memoizedState!==null&&je(ze,n);var r=Se.current,o=fb(r,n.type);r!==o&&(je(_e,n),je(Se,o))}function Rt(n){_e.current===n&&(ce(Se),ce(_e)),ze.current===n&&(ce(ze),Wc._currentValue=He)}var Sn,on;function qt(n){if(Sn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Sn=r&&r[1]||"",on=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sn+n+on}var Tt=!1;function gn(n,r){if(!n||Tt)return"";Tt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(me){var he=me}Reflect.construct(n,[],Ee)}else{try{Ee.call()}catch(me){he=me}n.call(Ee.prototype)}}else{try{throw Error()}catch(me){he=me}(Ee=n())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(me){if(me&&he&&typeof me.stack=="string")return[me.stack,he.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],j=m[1];if(x&&j){var z=x.split(`
`),oe=j.split(`
`);for(f=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;f<oe.length&&!oe[f].includes("DetermineComponentFrameRoot");)f++;if(c===z.length||f===oe.length)for(c=z.length-1,f=oe.length-1;1<=c&&0<=f&&z[c]!==oe[f];)f--;for(;1<=c&&0<=f;c--,f--)if(z[c]!==oe[f]){if(c!==1||f!==1)do if(c--,f--,0>f||z[c]!==oe[f]){var be=`
`+z[c].replace(" at new "," at ");return n.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",n.displayName)),be}while(1<=c&&0<=f);break}}}finally{Tt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?qt(o):""}function St(n,r){switch(n.tag){case 26:case 27:case 5:return qt(n.type);case 16:return qt("Lazy");case 13:return n.child!==r&&r!==null?qt("Suspense Fallback"):qt("Suspense");case 19:return qt("SuspenseList");case 0:case 15:return gn(n.type,!1);case 11:return gn(n.type.render,!1);case 1:return gn(n.type,!0);case 31:return qt("Activity");default:return""}}function ut(n){try{var r="",o=null;do r+=St(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var le=Object.prototype.hasOwnProperty,pt=s.unstable_scheduleCallback,Ht=s.unstable_cancelCallback,it=s.unstable_shouldYield,yt=s.unstable_requestPaint,mt=s.unstable_now,wt=s.unstable_getCurrentPriorityLevel,Bt=s.unstable_ImmediatePriority,fs=s.unstable_UserBlockingPriority,rn=s.unstable_NormalPriority,Jn=s.unstable_LowPriority,Fn=s.unstable_IdlePriority,Ln=s.log,On=s.unstable_setDisableYieldValue,cn=null,Gt=null;function Dt(n){if(typeof Ln=="function"&&On(n),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(cn,n)}catch{}}var It=Math.clz32?Math.clz32:re,Z=Math.log,C=Math.LN2;function re(n){return n>>>=0,n===0?32:31-(Z(n)/C|0)|0}var Re=256,Ie=262144,De=4194304;function Fe(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Oe(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var j=c&134217727;return j!==0?(c=j&~m,c!==0?f=Fe(c):(x&=j,x!==0?f=Fe(x):o||(o=j&~n,o!==0&&(f=Fe(o))))):(j=c&~m,j!==0?f=Fe(j):x!==0?f=Fe(x):o||(o=c&~n,o!==0&&(f=Fe(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Lt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function xt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=De;return De<<=1,(De&62914560)===0&&(De=4194304),n}function un(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function dn(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Pn(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var j=n.entanglements,z=n.expirationTimes,oe=n.hiddenUpdates;for(o=x&~o;0<o;){var be=31-It(o),Ee=1<<be;j[be]=0,z[be]=-1;var he=oe[be];if(he!==null)for(oe[be]=null,be=0;be<he.length;be++){var me=he[be];me!==null&&(me.lane&=-536870913)}o&=~Ee}c!==0&&ms(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function ms(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-It(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function ue(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-It(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Me(n,r){var o=r&-r;return o=(o&42)!==0?1:Ge(o),(o&(n.suspendedLanes|r))!==0?0:o}function Ge(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ct(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function et(){var n=Te.p;return n!==0?n:(n=window.event,n===void 0?32:Ob(n.type))}function $t(n,r){var o=Te.p;try{return Te.p=n,r()}finally{Te.p=o}}var hn=Math.random().toString(36).slice(2),Nt="__reactFiber$"+hn,Ct="__reactProps$"+hn,vn="__reactContainer$"+hn,Ss="__reactEvents$"+hn,ni="__reactListeners$"+hn,bi="__reactHandles$"+hn,Pr="__reactResources$"+hn,js="__reactMarker$"+hn;function hr(n){delete n[Nt],delete n[Ct],delete n[Ss],delete n[ni],delete n[bi]}function Gn(n){var r=n[Nt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[vn]||o[Nt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=wb(n);n!==null;){if(o=n[Nt])return o;n=wb(n)}return r}n=o,o=n.parentNode}return null}function os(n){if(n=n[Nt]||n[vn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ls(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Vn(n){var r=n[Pr];return r||(r=n[Pr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function bn(n){n[js]=!0}var Zn=new Set,xr={};function Hs(n,r){Kn(n,r),Kn(n+"Capture",r)}function Kn(n,r){for(xr[n]=r,n=0;n<r.length;n++)Zn.add(r[n])}var _r=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),es={},Vr={};function P(n){return le.call(Vr,n)?!0:le.call(es,n)?!1:_r.test(n)?Vr[n]=!0:(es[n]=!0,!1)}function H(n,r,o){if(P(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function ae(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function ne(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function $e(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Qe(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ke(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function ot(n){if(!n._valueTracker){var r=Qe(n)?"checked":"value";n._valueTracker=Ke(n,r,""+n[r])}}function At(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=Qe(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function Cn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Cs=/[\n"\\]/g;function Yn(n){return n.replace(Cs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ms(n,r,o,c,f,m,x,j){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+$e(r)):n.value!==""+$e(r)&&(n.value=""+$e(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Ds(n,x,$e(r)):o!=null?Ds(n,x,$e(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?n.name=""+$e(j):n.removeAttribute("name")}function si(n,r,o,c,f,m,x,j){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ot(n);return}o=o!=null?""+$e(o):"",r=r!=null?""+$e(r):o,j||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=j?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),ot(n)}function Ds(n,r,o){r==="number"&&Cn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function er(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+$e(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function wi(n,r,o){if(r!=null&&(r=""+$e(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+$e(o):""}function kr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(st(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=$e(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ot(n)}function Ns(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var _a=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bi(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||_a.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function ri(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Bi(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Bi(n,m,r[m])}function xi(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ur=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jr(n){return Ur.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function qs(){}var $s=null;function Ls(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var S=null,Q=null;function Ce(n){var r=os(n);if(r&&(n=r.stateNode)){var o=n[Ct]||null;e:switch(n=r.stateNode,r.type){case"input":if(Ms(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[Ct]||null;if(!f)throw Error(i(90));Ms(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&At(c)}break e;case"textarea":wi(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&er(n,!!o.multiple,r,!1)}}}var M=!1;function F(n,r,o){if(M)return n(r,o);M=!0;try{var c=n(r);return c}finally{if(M=!1,(S!==null||Q!==null)&&(Ud(),S&&(r=S,n=Q,Q=S=null,Ce(r),n)))for(r=0;r<n.length;r++)Ce(n[r])}}function $(n,r){var o=n.stateNode;if(o===null)return null;var c=o[Ct]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var X=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),de=!1;if(X)try{var pe={};Object.defineProperty(pe,"passive",{get:function(){de=!0}}),window.addEventListener("test",pe,pe),window.removeEventListener("test",pe,pe)}catch{de=!1}var Ve=null,tt=null,nt=null;function vt(){if(nt)return nt;var n,r=tt,o=r.length,c,f="value"in Ve?Ve.value:Ve.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return nt=f.slice(n,1<c?1-c:void 0)}function _t(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Xt(){return!0}function Hn(){return!1}function rt(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var j in n)n.hasOwnProperty(j)&&(o=n[j],this[j]=o?o(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Xt:Hn,this.isPropagationStopped=Hn,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),r}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=rt(wn),gt=k({},wn,{view:0,detail:0}),mn=rt(gt),Qn,tr,Ws,As=k({},gt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ka,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ws&&(Ws&&n.type==="mousemove"?(Qn=n.screenX-Ws.screenX,tr=n.screenY-Ws.screenY):tr=Qn=0,Ws=n),Qn)},movementY:function(n){return"movementY"in n?n.movementY:tr}}),nr=rt(As),Er=k({},As,{dataTransfer:0}),go=rt(Er),rl=k({},gt,{relatedTarget:0}),ii=rt(rl),fc=k({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),Yu=rt(fc),il=k({},wn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qu=rt(il),Xu=k({},wn,{data:0}),_i=rt(Xu),Ju={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ed={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function td(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=ed[n])?!!r[n]:!1}function ka(){return td}var sr=k({},gt,{key:function(n){if(n.key){var r=Ju[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=_t(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Zu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ka,charCode:function(n){return n.type==="keypress"?_t(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?_t(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nd=rt(sr),sd=k({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fi=rt(sd),h=k({},gt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ka}),v=rt(h),_=k({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=rt(_),se=k({},As,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=rt(se),Ue=k({},wn,{newState:0,oldState:0}),Vt=rt(Ue),cs=[9,13,27,32],xn=X&&"CompositionEvent"in window,qn=null;X&&"documentMode"in document&&(qn=document.documentMode);var Br=X&&"TextEvent"in window&&!qn,ki=X&&(!xn||qn&&8<qn&&11>=qn),ai=" ",oi=!1;function po(n,r){switch(n){case"keyup":return cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function al(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ol=!1;function Jj(n,r){switch(n){case"compositionend":return al(r);case"keypress":return r.which!==32?null:(oi=!0,ai);case"textInput":return n=r.data,n===ai&&oi?null:n;default:return null}}function Zj(n,r){if(ol)return n==="compositionend"||!xn&&po(n,r)?(n=vt(),nt=tt=Ve=null,ol=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ki&&r.locale!=="ko"?null:r.data;default:return null}}var eE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!eE[n.type]:r==="textarea"}function j0(n,r,o,c){S?Q?Q.push(c):Q=[c]:S=c,r=Wd(r,"onChange"),0<r.length&&(o=new fn("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var mc=null,gc=null;function tE(n){ab(n,0)}function rd(n){var r=ls(n);if(At(r))return n}function E0(n,r){if(n==="change")return r}var T0=!1;if(X){var Mf;if(X){var Df="oninput"in document;if(!Df){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),Df=typeof S0.oninput=="function"}Mf=Df}else Mf=!1;T0=Mf&&(!document.documentMode||9<document.documentMode)}function C0(){mc&&(mc.detachEvent("onpropertychange",N0),gc=mc=null)}function N0(n){if(n.propertyName==="value"&&rd(gc)){var r=[];j0(r,gc,n,Ls(n)),F(tE,r)}}function nE(n,r,o){n==="focusin"?(C0(),mc=r,gc=o,mc.attachEvent("onpropertychange",N0)):n==="focusout"&&C0()}function sE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rd(gc)}function rE(n,r){if(n==="click")return rd(r)}function iE(n,r){if(n==="input"||n==="change")return rd(r)}function aE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Tr=typeof Object.is=="function"?Object.is:aE;function pc(n,r){if(Tr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!le.call(r,f)||!Tr(n[f],r[f]))return!1}return!0}function A0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function R0(n,r){var o=A0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=A0(o)}}function I0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?I0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function M0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Cn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Cn(n.document)}return r}function Lf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var oE=X&&"documentMode"in document&&11>=document.documentMode,ll=null,Of=null,yc=null,Pf=!1;function D0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||ll==null||ll!==Cn(c)||(c=ll,"selectionStart"in c&&Lf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),yc&&pc(yc,c)||(yc=c,c=Wd(Of,"onSelect"),0<c.length&&(r=new fn("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=ll)))}function yo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var cl={animationend:yo("Animation","AnimationEnd"),animationiteration:yo("Animation","AnimationIteration"),animationstart:yo("Animation","AnimationStart"),transitionrun:yo("Transition","TransitionRun"),transitionstart:yo("Transition","TransitionStart"),transitioncancel:yo("Transition","TransitionCancel"),transitionend:yo("Transition","TransitionEnd")},Vf={},L0={};X&&(L0=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function vo(n){if(Vf[n])return Vf[n];if(!cl[n])return n;var r=cl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in L0)return Vf[n]=r[o];return n}var O0=vo("animationend"),P0=vo("animationiteration"),V0=vo("animationstart"),lE=vo("transitionrun"),cE=vo("transitionstart"),uE=vo("transitioncancel"),U0=vo("transitionend"),B0=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function li(n,r){B0.set(n,r),Hs(r,[n])}var id=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},zr=[],ul=0,Bf=0;function ad(){for(var n=ul,r=Bf=ul=0;r<n;){var o=zr[r];zr[r++]=null;var c=zr[r];zr[r++]=null;var f=zr[r];zr[r++]=null;var m=zr[r];if(zr[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&z0(o,f,m)}}function od(n,r,o,c){zr[ul++]=n,zr[ul++]=r,zr[ul++]=o,zr[ul++]=c,Bf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function zf(n,r,o,c){return od(n,r,o,c),ld(n)}function bo(n,r){return od(n,null,null,r),ld(n)}function z0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-It(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ld(n){if(50<Uc)throw Uc=0,Qm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var dl={};function dE(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(n,r,o,c){return new dE(n,r,o,c)}function Ff(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Hi(n,r){var o=n.alternate;return o===null?(o=Sr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function F0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function cd(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")Ff(n)&&(x=1);else if(typeof n=="string")x=pT(n,o,Se.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case O:return n=Sr(31,o,r,f),n.elementType=O,n.lanes=m,n;case G:return wo(o.children,f,m,r);case U:x=8,f|=24;break;case K:return n=Sr(12,o,r,f|2),n.elementType=K,n.lanes=m,n;case ke:return n=Sr(13,o,r,f),n.elementType=ke,n.lanes=m,n;case ve:return n=Sr(19,o,r,f),n.elementType=ve,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ee:x=10;break e;case Y:x=9;break e;case ye:x=11;break e;case I:x=14;break e;case E:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Sr(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function wo(n,r,o,c){return n=Sr(7,n,c,r),n.lanes=o,n}function Hf(n,r,o){return n=Sr(6,n,null,r),n.lanes=o,n}function H0(n){var r=Sr(18,null,null,0);return r.stateNode=n,r}function qf(n,r,o){return r=Sr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var q0=new WeakMap;function Fr(n,r){if(typeof n=="object"&&n!==null){var o=q0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:ut(r)},q0.set(n,r),r)}return{value:n,source:r,stack:ut(r)}}var hl=[],fl=0,ud=null,vc=0,Hr=[],qr=0,ja=null,ji=1,Ei="";function qi(n,r){hl[fl++]=vc,hl[fl++]=ud,ud=n,vc=r}function $0(n,r,o){Hr[qr++]=ji,Hr[qr++]=Ei,Hr[qr++]=ja,ja=n;var c=ji;n=Ei;var f=32-It(c)-1;c&=~(1<<f),o+=1;var m=32-It(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,ji=1<<32-It(r)+f|o<<f|c,Ei=m+n}else ji=1<<m|o<<f|c,Ei=n}function $f(n){n.return!==null&&(qi(n,1),$0(n,1,0))}function Wf(n){for(;n===ud;)ud=hl[--fl],hl[fl]=null,vc=hl[--fl],hl[fl]=null;for(;n===ja;)ja=Hr[--qr],Hr[qr]=null,Ei=Hr[--qr],Hr[qr]=null,ji=Hr[--qr],Hr[qr]=null}function W0(n,r){Hr[qr++]=ji,Hr[qr++]=Ei,Hr[qr++]=ja,ji=r.id,Ei=r.overflow,ja=n}var Os=null,Un=null,an=!1,Ea=null,$r=!1,Gf=Error(i(519));function Ta(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(Fr(r,n)),Gf}function G0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Nt]=n,r[Ct]=c,o){case"dialog":Yt("cancel",r),Yt("close",r);break;case"iframe":case"object":case"embed":Yt("load",r);break;case"video":case"audio":for(o=0;o<zc.length;o++)Yt(zc[o],r);break;case"source":Yt("error",r);break;case"img":case"image":case"link":Yt("error",r),Yt("load",r);break;case"details":Yt("toggle",r);break;case"input":Yt("invalid",r),si(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Yt("invalid",r);break;case"textarea":Yt("invalid",r),kr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ub(r.textContent,o)?(c.popover!=null&&(Yt("beforetoggle",r),Yt("toggle",r)),c.onScroll!=null&&Yt("scroll",r),c.onScrollEnd!=null&&Yt("scrollend",r),c.onClick!=null&&(r.onclick=qs),r=!0):r=!1,r||Ta(n,!0)}function K0(n){for(Os=n.return;Os;)switch(Os.tag){case 5:case 31:case 13:$r=!1;return;case 27:case 3:$r=!0;return;default:Os=Os.return}}function ml(n){if(n!==Os)return!1;if(!an)return K0(n),an=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||dg(n.type,n.memoizedProps)),o=!o),o&&Un&&Ta(n),K0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=bb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=bb(n)}else r===27?(r=Un,Ba(n.type)?(n=pg,pg=null,Un=n):Un=r):Un=Os?Gr(n.stateNode.nextSibling):null;return!0}function xo(){Un=Os=null,an=!1}function Kf(){var n=Ea;return n!==null&&(pr===null?pr=n:pr.push.apply(pr,n),Ea=null),n}function bc(n){Ea===null?Ea=[n]:Ea.push(n)}var Yf=V(null),_o=null,$i=null;function Sa(n,r,o){je(Yf,r._currentValue),r._currentValue=o}function Wi(n){n._currentValue=Yf.current,ce(Yf)}function Qf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Xf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var j=m;m=f;for(var z=0;z<r.length;z++)if(j.context===r[z]){m.lanes|=o,j=m.alternate,j!==null&&(j.lanes|=o),Qf(m.return,o,n),c||(x=null);break e}m=j.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Qf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function gl(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var j=f.type;Tr(f.pendingProps.value,x.value)||(n!==null?n.push(j):n=[j])}}else if(f===ze.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Wc):n=[Wc])}f=f.return}n!==null&&Xf(r,n,o,c),r.flags|=262144}function dd(n){for(n=n.firstContext;n!==null;){if(!Tr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ko(n){_o=n,$i=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ps(n){return Y0(_o,n)}function hd(n,r){return _o===null&&ko(n),Y0(n,r)}function Y0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},$i===null){if(n===null)throw Error(i(308));$i=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else $i=$i.next=r;return o}var hE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},fE=s.unstable_scheduleCallback,mE=s.unstable_NormalPriority,gs={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new hE,data:new Map,refCount:0}}function wc(n){n.refCount--,n.refCount===0&&fE(mE,function(){n.controller.abort()})}var xc=null,Zf=0,pl=0,yl=null;function gE(n,r){if(xc===null){var o=xc=[];Zf=0,pl=ng(),yl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Zf++,r.then(Q0,Q0),r}function Q0(){if(--Zf===0&&xc!==null){yl!==null&&(yl.status="fulfilled");var n=xc;xc=null,pl=0,yl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function pE(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var X0=te.S;te.S=function(n,r){D1=mt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&gE(n,r),X0!==null&&X0(n,r)};var jo=V(null);function em(){var n=jo.current;return n!==null?n:Mn.pooledCache}function fd(n,r){r===null?je(jo,jo.current):je(jo,r.pool)}function J0(){var n=em();return n===null?null:{parent:gs._currentValue,pool:n}}var vl=Error(i(460)),tm=Error(i(474)),md=Error(i(542)),gd={then:function(){}};function Z0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function ev(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(qs,qs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n;default:if(typeof r.status=="string")r.then(qs,qs);else{if(n=Mn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n}throw To=r,vl}}function Eo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(To=o,vl):o}}var To=null;function tv(){if(To===null)throw Error(i(459));var n=To;return To=null,n}function nv(n){if(n===vl||n===md)throw Error(i(483))}var bl=null,_c=0;function pd(n){var r=_c;return _c+=1,bl===null&&(bl=[]),ev(bl,n,r)}function kc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function yd(n,r){throw r.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function sv(n){function r(J,W){if(n){var ie=J.deletions;ie===null?(J.deletions=[W],J.flags|=16):ie.push(W)}}function o(J,W){if(!n)return null;for(;W!==null;)r(J,W),W=W.sibling;return null}function c(J){for(var W=new Map;J!==null;)J.key!==null?W.set(J.key,J):W.set(J.index,J),J=J.sibling;return W}function f(J,W){return J=Hi(J,W),J.index=0,J.sibling=null,J}function m(J,W,ie){return J.index=ie,n?(ie=J.alternate,ie!==null?(ie=ie.index,ie<W?(J.flags|=67108866,W):ie):(J.flags|=67108866,W)):(J.flags|=1048576,W)}function x(J){return n&&J.alternate===null&&(J.flags|=67108866),J}function j(J,W,ie,xe){return W===null||W.tag!==6?(W=Hf(ie,J.mode,xe),W.return=J,W):(W=f(W,ie),W.return=J,W)}function z(J,W,ie,xe){var ht=ie.type;return ht===G?be(J,W,ie.props.children,xe,ie.key):W!==null&&(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&Eo(ht)===W.type)?(W=f(W,ie.props),kc(W,ie),W.return=J,W):(W=cd(ie.type,ie.key,ie.props,null,J.mode,xe),kc(W,ie),W.return=J,W)}function oe(J,W,ie,xe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=qf(ie,J.mode,xe),W.return=J,W):(W=f(W,ie.children||[]),W.return=J,W)}function be(J,W,ie,xe,ht){return W===null||W.tag!==7?(W=wo(ie,J.mode,xe,ht),W.return=J,W):(W=f(W,ie),W.return=J,W)}function Ee(J,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Hf(""+W,J.mode,ie),W.return=J,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case R:return ie=cd(W.type,W.key,W.props,null,J.mode,ie),kc(ie,W),ie.return=J,ie;case q:return W=qf(W,J.mode,ie),W.return=J,W;case E:return W=Eo(W),Ee(J,W,ie)}if(st(W)||L(W))return W=wo(W,J.mode,ie,null),W.return=J,W;if(typeof W.then=="function")return Ee(J,pd(W),ie);if(W.$$typeof===ee)return Ee(J,hd(J,W),ie);yd(J,W)}return null}function he(J,W,ie,xe){var ht=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ht!==null?null:j(J,W,""+ie,xe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case R:return ie.key===ht?z(J,W,ie,xe):null;case q:return ie.key===ht?oe(J,W,ie,xe):null;case E:return ie=Eo(ie),he(J,W,ie,xe)}if(st(ie)||L(ie))return ht!==null?null:be(J,W,ie,xe,null);if(typeof ie.then=="function")return he(J,W,pd(ie),xe);if(ie.$$typeof===ee)return he(J,W,hd(J,ie),xe);yd(J,ie)}return null}function me(J,W,ie,xe,ht){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return J=J.get(ie)||null,j(W,J,""+xe,ht);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case R:return J=J.get(xe.key===null?ie:xe.key)||null,z(W,J,xe,ht);case q:return J=J.get(xe.key===null?ie:xe.key)||null,oe(W,J,xe,ht);case E:return xe=Eo(xe),me(J,W,ie,xe,ht)}if(st(xe)||L(xe))return J=J.get(ie)||null,be(W,J,xe,ht,null);if(typeof xe.then=="function")return me(J,W,ie,pd(xe),ht);if(xe.$$typeof===ee)return me(J,W,ie,hd(W,xe),ht);yd(W,xe)}return null}function Ze(J,W,ie,xe){for(var ht=null,pn=null,at=W,zt=W=0,Zt=null;at!==null&&zt<ie.length;zt++){at.index>zt?(Zt=at,at=null):Zt=at.sibling;var yn=he(J,at,ie[zt],xe);if(yn===null){at===null&&(at=Zt);break}n&&at&&yn.alternate===null&&r(J,at),W=m(yn,W,zt),pn===null?ht=yn:pn.sibling=yn,pn=yn,at=Zt}if(zt===ie.length)return o(J,at),an&&qi(J,zt),ht;if(at===null){for(;zt<ie.length;zt++)at=Ee(J,ie[zt],xe),at!==null&&(W=m(at,W,zt),pn===null?ht=at:pn.sibling=at,pn=at);return an&&qi(J,zt),ht}for(at=c(at);zt<ie.length;zt++)Zt=me(at,J,zt,ie[zt],xe),Zt!==null&&(n&&Zt.alternate!==null&&at.delete(Zt.key===null?zt:Zt.key),W=m(Zt,W,zt),pn===null?ht=Zt:pn.sibling=Zt,pn=Zt);return n&&at.forEach(function($a){return r(J,$a)}),an&&qi(J,zt),ht}function bt(J,W,ie,xe){if(ie==null)throw Error(i(151));for(var ht=null,pn=null,at=W,zt=W=0,Zt=null,yn=ie.next();at!==null&&!yn.done;zt++,yn=ie.next()){at.index>zt?(Zt=at,at=null):Zt=at.sibling;var $a=he(J,at,yn.value,xe);if($a===null){at===null&&(at=Zt);break}n&&at&&$a.alternate===null&&r(J,at),W=m($a,W,zt),pn===null?ht=$a:pn.sibling=$a,pn=$a,at=Zt}if(yn.done)return o(J,at),an&&qi(J,zt),ht;if(at===null){for(;!yn.done;zt++,yn=ie.next())yn=Ee(J,yn.value,xe),yn!==null&&(W=m(yn,W,zt),pn===null?ht=yn:pn.sibling=yn,pn=yn);return an&&qi(J,zt),ht}for(at=c(at);!yn.done;zt++,yn=ie.next())yn=me(at,J,zt,yn.value,xe),yn!==null&&(n&&yn.alternate!==null&&at.delete(yn.key===null?zt:yn.key),W=m(yn,W,zt),pn===null?ht=yn:pn.sibling=yn,pn=yn);return n&&at.forEach(function(ST){return r(J,ST)}),an&&qi(J,zt),ht}function Rn(J,W,ie,xe){if(typeof ie=="object"&&ie!==null&&ie.type===G&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case R:e:{for(var ht=ie.key;W!==null;){if(W.key===ht){if(ht=ie.type,ht===G){if(W.tag===7){o(J,W.sibling),xe=f(W,ie.props.children),xe.return=J,J=xe;break e}}else if(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&Eo(ht)===W.type){o(J,W.sibling),xe=f(W,ie.props),kc(xe,ie),xe.return=J,J=xe;break e}o(J,W);break}else r(J,W);W=W.sibling}ie.type===G?(xe=wo(ie.props.children,J.mode,xe,ie.key),xe.return=J,J=xe):(xe=cd(ie.type,ie.key,ie.props,null,J.mode,xe),kc(xe,ie),xe.return=J,J=xe)}return x(J);case q:e:{for(ht=ie.key;W!==null;){if(W.key===ht)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(J,W.sibling),xe=f(W,ie.children||[]),xe.return=J,J=xe;break e}else{o(J,W);break}else r(J,W);W=W.sibling}xe=qf(ie,J.mode,xe),xe.return=J,J=xe}return x(J);case E:return ie=Eo(ie),Rn(J,W,ie,xe)}if(st(ie))return Ze(J,W,ie,xe);if(L(ie)){if(ht=L(ie),typeof ht!="function")throw Error(i(150));return ie=ht.call(ie),bt(J,W,ie,xe)}if(typeof ie.then=="function")return Rn(J,W,pd(ie),xe);if(ie.$$typeof===ee)return Rn(J,W,hd(J,ie),xe);yd(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(J,W.sibling),xe=f(W,ie),xe.return=J,J=xe):(o(J,W),xe=Hf(ie,J.mode,xe),xe.return=J,J=xe),x(J)):o(J,W)}return function(J,W,ie,xe){try{_c=0;var ht=Rn(J,W,ie,xe);return bl=null,ht}catch(at){if(at===vl||at===md)throw at;var pn=Sr(29,at,null,J.mode);return pn.lanes=xe,pn.return=J,pn}}}var So=sv(!0),rv=sv(!1),Ca=!1;function nm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Na(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Aa(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(_n&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ld(n),z0(n,null,o),r}return od(n,c,r,o),ld(n)}function jc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}function rm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var im=!1;function Ec(){if(im){var n=yl;if(n!==null)throw n}}function Tc(n,r,o,c){im=!1;var f=n.updateQueue;Ca=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,j=f.shared.pending;if(j!==null){f.shared.pending=null;var z=j,oe=z.next;z.next=null,x===null?m=oe:x.next=oe,x=z;var be=n.alternate;be!==null&&(be=be.updateQueue,j=be.lastBaseUpdate,j!==x&&(j===null?be.firstBaseUpdate=oe:j.next=oe,be.lastBaseUpdate=z))}if(m!==null){var Ee=f.baseState;x=0,be=oe=z=null,j=m;do{var he=j.lane&-536870913,me=he!==j.lane;if(me?(Jt&he)===he:(c&he)===he){he!==0&&he===pl&&(im=!0),be!==null&&(be=be.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Ze=n,bt=j;he=r;var Rn=o;switch(bt.tag){case 1:if(Ze=bt.payload,typeof Ze=="function"){Ee=Ze.call(Rn,Ee,he);break e}Ee=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=bt.payload,he=typeof Ze=="function"?Ze.call(Rn,Ee,he):Ze,he==null)break e;Ee=k({},Ee,he);break e;case 2:Ca=!0}}he=j.callback,he!==null&&(n.flags|=64,me&&(n.flags|=8192),me=f.callbacks,me===null?f.callbacks=[he]:me.push(he))}else me={lane:he,tag:j.tag,payload:j.payload,callback:j.callback,next:null},be===null?(oe=be=me,z=Ee):be=be.next=me,x|=he;if(j=j.next,j===null){if(j=f.shared.pending,j===null)break;me=j,j=me.next,me.next=null,f.lastBaseUpdate=me,f.shared.pending=null}}while(!0);be===null&&(z=Ee),f.baseState=z,f.firstBaseUpdate=oe,f.lastBaseUpdate=be,m===null&&(f.shared.lanes=0),La|=x,n.lanes=x,n.memoizedState=Ee}}function iv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function av(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)iv(o[n],r)}var wl=V(null),vd=V(0);function ov(n,r){n=ta,je(vd,n),je(wl,r),ta=n|r.baseLanes}function am(){je(vd,ta),je(wl,wl.current)}function om(){ta=vd.current,ce(wl),ce(vd)}var Cr=V(null),Wr=null;function Ra(n){var r=n.alternate;je(us,us.current&1),je(Cr,n),Wr===null&&(r===null||wl.current!==null||r.memoizedState!==null)&&(Wr=n)}function lm(n){je(us,us.current),je(Cr,n),Wr===null&&(Wr=n)}function lv(n){n.tag===22?(je(us,us.current),je(Cr,n),Wr===null&&(Wr=n)):Ia()}function Ia(){je(us,us.current),je(Cr,Cr.current)}function Nr(n){ce(Cr),Wr===n&&(Wr=null),ce(us)}var us=V(0);function bd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mg(o)||gg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Gi=0,Ut=null,Nn=null,ps=null,wd=!1,xl=!1,Co=!1,xd=0,Sc=0,_l=null,yE=0;function ts(){throw Error(i(321))}function cm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Tr(n[o],r[o]))return!1;return!0}function um(n,r,o,c,f,m){return Gi=m,Ut=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,te.H=n===null||n.memoizedState===null?$v:Em,Co=!1,m=o(c,f),Co=!1,xl&&(m=uv(r,o,c,f)),cv(n),m}function cv(n){te.H=Ac;var r=Nn!==null&&Nn.next!==null;if(Gi=0,ps=Nn=Ut=null,wd=!1,Sc=0,_l=null,r)throw Error(i(300));n===null||ys||(n=n.dependencies,n!==null&&dd(n)&&(ys=!0))}function uv(n,r,o,c){Ut=n;var f=0;do{if(xl&&(_l=null),Sc=0,xl=!1,25<=f)throw Error(i(301));if(f+=1,ps=Nn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}te.H=Wv,m=r(o,c)}while(xl);return m}function vE(){var n=te.H,r=n.useState()[0];return r=typeof r.then=="function"?Cc(r):r,n=n.useState()[0],(Nn!==null?Nn.memoizedState:null)!==n&&(Ut.flags|=1024),r}function dm(){var n=xd!==0;return xd=0,n}function hm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fm(n){if(wd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}wd=!1}Gi=0,ps=Nn=Ut=null,xl=!1,Sc=xd=0,_l=null}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Ut.memoizedState=ps=n:ps=ps.next=n,ps}function ds(){if(Nn===null){var n=Ut.alternate;n=n!==null?n.memoizedState:null}else n=Nn.next;var r=ps===null?Ut.memoizedState:ps.next;if(r!==null)ps=r,Nn=n;else{if(n===null)throw Ut.alternate===null?Error(i(467)):Error(i(310));Nn=n,n={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},ps===null?Ut.memoizedState=ps=n:ps=ps.next=n}return ps}function _d(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cc(n){var r=Sc;return Sc+=1,_l===null&&(_l=[]),n=ev(_l,n,r),r=Ut,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,te.H=r===null||r.memoizedState===null?$v:Em),n}function kd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Cc(n);if(n.$$typeof===ee)return Ps(n)}throw Error(i(438,String(n)))}function mm(n){var r=null,o=Ut.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Ut.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=_d(),Ut.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=B;return r.index++,o}function Ki(n,r){return typeof r=="function"?r(n):r}function jd(n){var r=ds();return gm(r,Nn,n)}function gm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var j=x=null,z=null,oe=r,be=!1;do{var Ee=oe.lane&-536870913;if(Ee!==oe.lane?(Jt&Ee)===Ee:(Gi&Ee)===Ee){var he=oe.revertLane;if(he===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Ee===pl&&(be=!0);else if((Gi&he)===he){oe=oe.next,he===pl&&(be=!0);continue}else Ee={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},z===null?(j=z=Ee,x=m):z=z.next=Ee,Ut.lanes|=he,La|=he;Ee=oe.action,Co&&o(m,Ee),m=oe.hasEagerState?oe.eagerState:o(m,Ee)}else he={lane:Ee,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},z===null?(j=z=he,x=m):z=z.next=he,Ut.lanes|=Ee,La|=Ee;oe=oe.next}while(oe!==null&&oe!==r);if(z===null?x=m:z.next=j,!Tr(m,n.memoizedState)&&(ys=!0,be&&(o=yl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=z,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function pm(n){var r=ds(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);Tr(m,r.memoizedState)||(ys=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function dv(n,r,o){var c=Ut,f=ds(),m=an;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!Tr((Nn||f).memoizedState,o);if(x&&(f.memoizedState=o,ys=!0),f=f.queue,bm(mv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,kl(9,{destroy:void 0},fv.bind(null,c,f,o,r),null),Mn===null)throw Error(i(349));m||(Gi&127)!==0||hv(c,r,o)}return o}function hv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Ut.updateQueue,r===null?(r=_d(),Ut.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function fv(n,r,o,c){r.value=o,r.getSnapshot=c,gv(r)&&pv(n)}function mv(n,r,o){return o(function(){gv(r)&&pv(n)})}function gv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Tr(n,o)}catch{return!0}}function pv(n){var r=bo(n,2);r!==null&&yr(r,n,2)}function ym(n){var r=rr();if(typeof n=="function"){var o=n;if(n=o(),Co){Dt(!0);try{o()}finally{Dt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:n},r}function yv(n,r,o,c){return n.baseState=o,gm(n,Nn,typeof c=="function"?c:Ki)}function bE(n,r,o,c,f){if(Sd(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};te.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,vv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function vv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=te.T,x={};te.T=x;try{var j=o(f,c),z=te.S;z!==null&&z(x,j),bv(n,r,j)}catch(oe){vm(n,r,oe)}finally{m!==null&&x.types!==null&&(m.types=x.types),te.T=m}}else try{m=o(f,c),bv(n,r,m)}catch(oe){vm(n,r,oe)}}function bv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){wv(n,r,c)},function(c){return vm(n,r,c)}):wv(n,r,o)}function wv(n,r,o){r.status="fulfilled",r.value=o,xv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,vv(n,o)))}function vm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,xv(r),r=r.next;while(r!==c)}n.action=null}function xv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function _v(n,r){return r}function kv(n,r){if(an){var o=Mn.formState;if(o!==null){e:{var c=Ut;if(an){if(Un){t:{for(var f=Un,m=$r;f.nodeType!==8;){if(!m){f=null;break t}if(f=Gr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Un=Gr(f.nextSibling),c=f.data==="F!";break e}}Ta(c)}c=!1}c&&(r=o[0])}}return o=rr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_v,lastRenderedState:r},o.queue=c,o=Fv.bind(null,Ut,c),c.dispatch=o,c=ym(!1),m=jm.bind(null,Ut,!1,c.queue),c=rr(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=bE.bind(null,Ut,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function jv(n){var r=ds();return Ev(r,Nn,n)}function Ev(n,r,o){if(r=gm(n,r,_v)[0],n=jd(Ki)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Cc(r)}catch(x){throw x===vl?md:x}else c=r;r=ds();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Ut.flags|=2048,kl(9,{destroy:void 0},wE.bind(null,f,o),null)),[c,m,n]}function wE(n,r){n.action=r}function Tv(n){var r=ds(),o=Nn;if(o!==null)return Ev(r,o,n);ds(),r=r.memoizedState,o=ds();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function kl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Ut.updateQueue,r===null&&(r=_d(),Ut.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Sv(){return ds().memoizedState}function Ed(n,r,o,c){var f=rr();Ut.flags|=n,f.memoizedState=kl(1|r,{destroy:void 0},o,c===void 0?null:c)}function Td(n,r,o,c){var f=ds();c=c===void 0?null:c;var m=f.memoizedState.inst;Nn!==null&&c!==null&&cm(c,Nn.memoizedState.deps)?f.memoizedState=kl(r,m,o,c):(Ut.flags|=n,f.memoizedState=kl(1|r,m,o,c))}function Cv(n,r){Ed(8390656,8,n,r)}function bm(n,r){Td(2048,8,n,r)}function xE(n){Ut.flags|=4;var r=Ut.updateQueue;if(r===null)r=_d(),Ut.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Nv(n){var r=ds().memoizedState;return xE({ref:r,nextImpl:n}),function(){if((_n&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Av(n,r){return Td(4,2,n,r)}function Rv(n,r){return Td(4,4,n,r)}function Iv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Mv(n,r,o){o=o!=null?o.concat([n]):null,Td(4,4,Iv.bind(null,r,n),o)}function wm(){}function Dv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&cm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Lv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&cm(r,c[1]))return c[0];if(c=n(),Co){Dt(!0);try{n()}finally{Dt(!1)}}return o.memoizedState=[c,r],c}function xm(n,r,o){return o===void 0||(Gi&1073741824)!==0&&(Jt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=O1(),Ut.lanes|=n,La|=n,o)}function Ov(n,r,o,c){return Tr(o,r)?o:wl.current!==null?(n=xm(n,o,c),Tr(n,r)||(ys=!0),n):(Gi&42)===0||(Gi&1073741824)!==0&&(Jt&261930)===0?(ys=!0,n.memoizedState=o):(n=O1(),Ut.lanes|=n,La|=n,r)}function Pv(n,r,o,c,f){var m=Te.p;Te.p=m!==0&&8>m?m:8;var x=te.T,j={};te.T=j,jm(n,!1,r,o);try{var z=f(),oe=te.S;if(oe!==null&&oe(j,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var be=pE(z,c);Nc(n,r,be,Ir(n))}else Nc(n,r,c,Ir(n))}catch(Ee){Nc(n,r,{then:function(){},status:"rejected",reason:Ee},Ir())}finally{Te.p=m,x!==null&&j.types!==null&&(x.types=j.types),te.T=x}}function _E(){}function _m(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Vv(n).queue;Pv(n,f,r,He,o===null?_E:function(){return Uv(n),o(c)})}function Vv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:He,baseState:He,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:He},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Uv(n){var r=Vv(n);r.next===null&&(r=n.alternate.memoizedState),Nc(n,r.next.queue,{},Ir())}function km(){return Ps(Wc)}function Bv(){return ds().memoizedState}function zv(){return ds().memoizedState}function kE(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ir();n=Na(o);var c=Aa(r,n,o);c!==null&&(yr(c,r,o),jc(c,r,o)),r={cache:Jf()},n.payload=r;return}r=r.return}}function jE(n,r,o){var c=Ir();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Sd(n)?Hv(r,o):(o=zf(n,r,o,c),o!==null&&(yr(o,n,c),qv(o,r,c)))}function Fv(n,r,o){var c=Ir();Nc(n,r,o,c)}function Nc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Sd(n))Hv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,j=m(x,o);if(f.hasEagerState=!0,f.eagerState=j,Tr(j,x))return od(n,r,f,0),Mn===null&&ad(),!1}catch{}if(o=zf(n,r,f,c),o!==null)return yr(o,n,c),qv(o,r,c),!0}return!1}function jm(n,r,o,c){if(c={lane:2,revertLane:ng(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Sd(n)){if(r)throw Error(i(479))}else r=zf(n,o,c,2),r!==null&&yr(r,n,2)}function Sd(n){var r=n.alternate;return n===Ut||r!==null&&r===Ut}function Hv(n,r){xl=wd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function qv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ue(n,o)}}var Ac={readContext:Ps,use:kd,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useLayoutEffect:ts,useInsertionEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useSyncExternalStore:ts,useId:ts,useHostTransitionStatus:ts,useFormState:ts,useActionState:ts,useOptimistic:ts,useMemoCache:ts,useCacheRefresh:ts};Ac.useEffectEvent=ts;var $v={readContext:Ps,use:kd,useCallback:function(n,r){return rr().memoizedState=[n,r===void 0?null:r],n},useContext:Ps,useEffect:Cv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,Ed(4194308,4,Iv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return Ed(4194308,4,n,r)},useInsertionEffect:function(n,r){Ed(4,2,n,r)},useMemo:function(n,r){var o=rr();r=r===void 0?null:r;var c=n();if(Co){Dt(!0);try{n()}finally{Dt(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=rr();if(o!==void 0){var f=o(r);if(Co){Dt(!0);try{o(r)}finally{Dt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=jE.bind(null,Ut,n),[c.memoizedState,n]},useRef:function(n){var r=rr();return n={current:n},r.memoizedState=n},useState:function(n){n=ym(n);var r=n.queue,o=Fv.bind(null,Ut,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:wm,useDeferredValue:function(n,r){var o=rr();return xm(o,n,r)},useTransition:function(){var n=ym(!1);return n=Pv.bind(null,Ut,n.queue,!0,!1),rr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Ut,f=rr();if(an){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Mn===null)throw Error(i(349));(Jt&127)!==0||hv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Cv(mv.bind(null,c,m,n),[n]),c.flags|=2048,kl(9,{destroy:void 0},fv.bind(null,c,m,o,r),null),o},useId:function(){var n=rr(),r=Mn.identifierPrefix;if(an){var o=Ei,c=ji;o=(c&~(1<<32-It(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=xd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=yE++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:kv,useActionState:kv,useOptimistic:function(n){var r=rr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=jm.bind(null,Ut,!0,o),o.dispatch=r,[n,r]},useMemoCache:mm,useCacheRefresh:function(){return rr().memoizedState=kE.bind(null,Ut)},useEffectEvent:function(n){var r=rr(),o={impl:n};return r.memoizedState=o,function(){if((_n&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Em={readContext:Ps,use:kd,useCallback:Dv,useContext:Ps,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:jd,useRef:Sv,useState:function(){return jd(Ki)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return Ov(o,Nn.memoizedState,n,r)},useTransition:function(){var n=jd(Ki)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:jv,useActionState:jv,useOptimistic:function(n,r){var o=ds();return yv(o,Nn,n,r)},useMemoCache:mm,useCacheRefresh:zv};Em.useEffectEvent=Nv;var Wv={readContext:Ps,use:kd,useCallback:Dv,useContext:Ps,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:pm,useRef:Sv,useState:function(){return pm(Ki)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return Nn===null?xm(o,n,r):Ov(o,Nn.memoizedState,n,r)},useTransition:function(){var n=pm(Ki)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:Tv,useActionState:Tv,useOptimistic:function(n,r){var o=ds();return Nn!==null?yv(o,Nn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mm,useCacheRefresh:zv};Wv.useEffectEvent=Nv;function Tm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Ir(),f=Na(c);f.payload=r,o!=null&&(f.callback=o),r=Aa(n,f,c),r!==null&&(yr(r,n,c),jc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Ir(),f=Na(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Aa(n,f,c),r!==null&&(yr(r,n,c),jc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Ir(),c=Na(o);c.tag=2,r!=null&&(c.callback=r),r=Aa(n,c,o),r!==null&&(yr(r,n,o),jc(r,n,o))}};function Gv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!pc(o,c)||!pc(f,m):!0}function Kv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function No(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Yv(n){id(n)}function Qv(n){console.error(n)}function Xv(n){id(n)}function Cd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Cm(n,r,o){return o=Na(o),o.tag=3,o.payload={element:null},o.callback=function(){Cd(n,r)},o}function Zv(n){return n=Na(n),n.tag=3,n}function e1(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Jv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Jv(r,o,c),typeof f!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function EE(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&gl(r,o,f,!0),o=Cr.current,o!==null){switch(o.tag){case 31:case 13:return Wr===null?Bd():o.alternate===null&&ns===0&&(ns=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Zm(n,c,f)),!1;case 22:return o.flags|=65536,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Zm(n,c,f)),!1}throw Error(i(435,o.tag))}return Zm(n,c,f),Bd(),!1}if(an)return r=Cr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Gf&&(n=Error(i(422),{cause:c}),bc(Fr(n,o)))):(c!==Gf&&(r=Error(i(423),{cause:c}),bc(Fr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Fr(c,o),f=Cm(n.stateNode,c,f),rm(n,f),ns!==4&&(ns=2)),!1;var m=Error(i(520),{cause:c});if(m=Fr(m,o),Vc===null?Vc=[m]:Vc.push(m),ns!==4&&(ns=2),r===null)return!0;c=Fr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Cm(o.stateNode,c,n),rm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Oa===null||!Oa.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Zv(f),e1(f,n,o,c),rm(o,f),!1}o=o.return}while(o!==null);return!1}var Nm=Error(i(461)),ys=!1;function Vs(n,r,o,c){r.child=n===null?rv(r,null,o,c):So(r,n.child,o,c)}function t1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var j in c)j!=="ref"&&(x[j]=c[j])}else x=c;return ko(r),c=um(n,r,o,x,m,f),j=dm(),n!==null&&!ys?(hm(n,r,f),Yi(n,r,f)):(an&&j&&$f(r),r.flags|=1,Vs(n,r,c,f),r.child)}function n1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Ff(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,s1(n,r,m,c,f)):(n=cd(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Pm(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:pc,o(x,c)&&n.ref===r.ref)return Yi(n,r,f)}return r.flags|=1,n=Hi(m,c),n.ref=r.ref,n.return=r,r.child=n}function s1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(pc(m,c)&&n.ref===r.ref)if(ys=!1,r.pendingProps=c=m,Pm(n,f))(n.flags&131072)!==0&&(ys=!0);else return r.lanes=n.lanes,Yi(n,r,f)}return Am(n,r,o,c,f)}function r1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return i1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&fd(r,m!==null?m.cachePool:null),m!==null?ov(r,m):am(),lv(r);else return c=r.lanes=536870912,i1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(fd(r,m.cachePool),ov(r,m),Ia(),r.memoizedState=null):(n!==null&&fd(r,null),am(),Ia());return Vs(n,r,f,o),r.child}function Rc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function i1(n,r,o,c,f){var m=em();return m=m===null?null:{parent:gs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&fd(r,null),am(),lv(r),n!==null&&gl(n,r,c,!0),r.childLanes=f,null}function Nd(n,r){return r=Rd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function a1(n,r,o){return So(r,n.child,null,o),n=Nd(r,r.pendingProps),n.flags|=2,Nr(r),r.memoizedState=null,n}function TE(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(an){if(c.mode==="hidden")return n=Nd(r,c),r.lanes=536870912,Rc(null,n);if(lm(r),(n=Un)?(n=vb(n,$r),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ja!==null?{id:ji,overflow:Ei}:null,retryLane:536870912,hydrationErrors:null},o=H0(n),o.return=r,r.child=o,Os=r,Un=null)):n=null,n===null)throw Ta(r);return r.lanes=536870912,null}return Nd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(lm(r),f)if(r.flags&256)r.flags&=-257,r=a1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ys||gl(n,r,o,!1),f=(o&n.childLanes)!==0,ys||f){if(c=Mn,c!==null&&(x=Me(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,bo(n,x),yr(c,n,x),Nm;Bd(),r=a1(n,r,o)}else n=m.treeContext,Un=Gr(x.nextSibling),Os=r,an=!0,Ea=null,$r=!1,n!==null&&W0(r,n),r=Nd(r,c),r.flags|=4096;return r}return n=Hi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Ad(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Am(n,r,o,c,f){return ko(r),o=um(n,r,o,c,void 0,f),c=dm(),n!==null&&!ys?(hm(n,r,f),Yi(n,r,f)):(an&&c&&$f(r),r.flags|=1,Vs(n,r,o,f),r.child)}function o1(n,r,o,c,f,m){return ko(r),r.updateQueue=null,o=uv(r,c,o,f),cv(n),c=dm(),n!==null&&!ys?(hm(n,r,m),Yi(n,r,m)):(an&&c&&$f(r),r.flags|=1,Vs(n,r,o,m),r.child)}function l1(n,r,o,c,f){if(ko(r),r.stateNode===null){var m=dl,x=o.contextType;typeof x=="object"&&x!==null&&(m=Ps(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},nm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Ps(x):dl,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(Tm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Sm.enqueueReplaceState(m,m.state,null),Tc(r,c,m,f),Ec(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var j=r.memoizedProps,z=No(o,j);m.props=z;var oe=m.context,be=o.contextType;x=dl,typeof be=="object"&&be!==null&&(x=Ps(be));var Ee=o.getDerivedStateFromProps;be=typeof Ee=="function"||typeof m.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,be||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j||oe!==x)&&Kv(r,m,c,x),Ca=!1;var he=r.memoizedState;m.state=he,Tc(r,c,m,f),Ec(),oe=r.memoizedState,j||he!==oe||Ca?(typeof Ee=="function"&&(Tm(r,o,Ee,c),oe=r.memoizedState),(z=Ca||Gv(r,o,z,c,he,oe,x))?(be||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=oe),m.props=c,m.state=oe,m.context=x,c=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,sm(n,r),x=r.memoizedProps,be=No(o,x),m.props=be,Ee=r.pendingProps,he=m.context,oe=o.contextType,z=dl,typeof oe=="object"&&oe!==null&&(z=Ps(oe)),j=o.getDerivedStateFromProps,(oe=typeof j=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==Ee||he!==z)&&Kv(r,m,c,z),Ca=!1,he=r.memoizedState,m.state=he,Tc(r,c,m,f),Ec();var me=r.memoizedState;x!==Ee||he!==me||Ca||n!==null&&n.dependencies!==null&&dd(n.dependencies)?(typeof j=="function"&&(Tm(r,o,j,c),me=r.memoizedState),(be=Ca||Gv(r,o,be,c,he,me,z)||n!==null&&n.dependencies!==null&&dd(n.dependencies))?(oe||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,me,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,me,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&he===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&he===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=me),m.props=c,m.state=me,m.context=z,c=be):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&he===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&he===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Ad(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=So(r,n.child,null,f),r.child=So(r,null,o,f)):Vs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Yi(n,r,f),n}function c1(n,r,o,c){return xo(),r.flags|=256,Vs(n,r,o,c),r.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:J0()}}function Mm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Rr),n}function u1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(us.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(an){if(f?Ra(r):Ia(),(n=Un)?(n=vb(n,$r),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ja!==null?{id:ji,overflow:Ei}:null,retryLane:536870912,hydrationErrors:null},o=H0(n),o.return=r,r.child=o,Os=r,Un=null)):n=null,n===null)throw Ta(r);return gg(n)?r.lanes=32:r.lanes=536870912,null}var j=c.children;return c=c.fallback,f?(Ia(),f=r.mode,j=Rd({mode:"hidden",children:j},f),c=wo(c,f,o,null),j.return=r,c.return=r,j.sibling=c,r.child=j,c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Rc(null,c)):(Ra(r),Dm(r,j))}var z=n.memoizedState;if(z!==null&&(j=z.dehydrated,j!==null)){if(m)r.flags&256?(Ra(r),r.flags&=-257,r=Lm(n,r,o)):r.memoizedState!==null?(Ia(),r.child=n.child,r.flags|=128,r=null):(Ia(),j=c.fallback,f=r.mode,c=Rd({mode:"visible",children:c.children},f),j=wo(j,f,o,null),j.flags|=2,c.return=r,j.return=r,c.sibling=j,r.child=c,So(r,n.child,null,o),c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,r=Rc(null,c));else if(Ra(r),gg(j)){if(x=j.nextSibling&&j.nextSibling.dataset,x)var oe=x.dgst;x=oe,c=Error(i(419)),c.stack="",c.digest=x,bc({value:c,source:null,stack:null}),r=Lm(n,r,o)}else if(ys||gl(n,r,o,!1),x=(o&n.childLanes)!==0,ys||x){if(x=Mn,x!==null&&(c=Me(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,bo(n,c),yr(x,n,c),Nm;mg(j)||Bd(),r=Lm(n,r,o)}else mg(j)?(r.flags|=192,r.child=n.child,r=null):(n=z.treeContext,Un=Gr(j.nextSibling),Os=r,an=!0,Ea=null,$r=!1,n!==null&&W0(r,n),r=Dm(r,c.children),r.flags|=4096);return r}return f?(Ia(),j=c.fallback,f=r.mode,z=n.child,oe=z.sibling,c=Hi(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,oe!==null?j=Hi(oe,j):(j=wo(j,f,o,null),j.flags|=2),j.return=r,c.return=r,c.sibling=j,r.child=c,Rc(null,c),c=r.child,j=n.child.memoizedState,j===null?j=Im(o):(f=j.cachePool,f!==null?(z=gs._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=J0(),j={baseLanes:j.baseLanes|o,cachePool:f}),c.memoizedState=j,c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Rc(n.child,c)):(Ra(r),o=n.child,n=o.sibling,o=Hi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Dm(n,r){return r=Rd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Rd(n,r){return n=Sr(22,n,null,r),n.lanes=0,n}function Lm(n,r,o){return So(r,n.child,null,o),n=Dm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function d1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qf(n.return,r,o)}function Om(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function h1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=us.current,j=(x&2)!==0;if(j?(x=x&1|2,r.flags|=128):x&=1,je(us,x),Vs(n,r,c,o),c=an?vc:0,!j&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&d1(n,o,r);else if(n.tag===19)d1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&bd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Om(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&bd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Om(r,!0,o,null,m,c);break;case"together":Om(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Yi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),La|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(gl(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Hi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Hi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Pm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&dd(n)))}function SE(n,r,o){switch(r.tag){case 3:Ye(r,r.stateNode.containerInfo),Sa(r,gs,n.memoizedState.cache),xo();break;case 27:case 5:Qt(r);break;case 4:Ye(r,r.stateNode.containerInfo);break;case 10:Sa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ra(r),r.flags|=128,null):(o&r.child.childLanes)!==0?u1(n,r,o):(Ra(r),n=Yi(n,r,o),n!==null?n.sibling:null);Ra(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(gl(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return h1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),je(us,us.current),c)break;return null;case 22:return r.lanes=0,r1(n,r,o,r.pendingProps);case 24:Sa(r,gs,n.memoizedState.cache)}return Yi(n,r,o)}function f1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ys=!0;else{if(!Pm(n,o)&&(r.flags&128)===0)return ys=!1,SE(n,r,o);ys=(n.flags&131072)!==0}else ys=!1,an&&(r.flags&1048576)!==0&&$0(r,vc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=Eo(r.elementType),r.type=n,typeof n=="function")Ff(n)?(c=No(n,c),r.tag=1,r=l1(null,r,n,c,o)):(r.tag=0,r=Am(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===ye){r.tag=11,r=t1(null,r,n,c,o);break e}else if(f===I){r.tag=14,r=n1(null,r,n,c,o);break e}}throw r=Le(n)||n,Error(i(306,r,""))}}return r;case 0:return Am(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=No(c,r.pendingProps),l1(n,r,c,f,o);case 3:e:{if(Ye(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,sm(n,r),Tc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,Sa(r,gs,c),c!==m.cache&&Xf(r,[gs],o,!0),Ec(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=c1(n,r,c,o);break e}else if(c!==f){f=Fr(Error(i(424)),r),bc(f),r=c1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Un=Gr(n.firstChild),Os=r,an=!0,Ea=null,$r=!0,o=rv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(xo(),c===f){r=Yi(n,r,o);break e}Vs(n,r,c,o)}r=r.child}return r;case 26:return Ad(n,r),n===null?(o=jb(r.type,null,r.pendingProps,null))?r.memoizedState=o:an||(o=r.type,n=r.pendingProps,c=Gd(Pe.current).createElement(o),c[Nt]=r,c[Ct]=n,Us(c,o,n),bn(c),r.stateNode=c):r.memoizedState=jb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Qt(r),n===null&&an&&(c=r.stateNode=xb(r.type,r.pendingProps,Pe.current),Os=r,$r=!0,f=Un,Ba(r.type)?(pg=f,Un=Gr(c.firstChild)):Un=f),Vs(n,r,r.pendingProps.children,o),Ad(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&an&&((f=c=Un)&&(c=sT(c,r.type,r.pendingProps,$r),c!==null?(r.stateNode=c,Os=r,Un=Gr(c.firstChild),$r=!1,f=!0):f=!1),f||Ta(r)),Qt(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,dg(f,m)?c=null:x!==null&&dg(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=um(n,r,vE,null,null,o),Wc._currentValue=f),Ad(n,r),Vs(n,r,c,o),r.child;case 6:return n===null&&an&&((n=o=Un)&&(o=rT(o,r.pendingProps,$r),o!==null?(r.stateNode=o,Os=r,Un=null,n=!0):n=!1),n||Ta(r)),null;case 13:return u1(n,r,o);case 4:return Ye(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=So(r,null,c,o):Vs(n,r,c,o),r.child;case 11:return t1(n,r,r.type,r.pendingProps,o);case 7:return Vs(n,r,r.pendingProps,o),r.child;case 8:return Vs(n,r,r.pendingProps.children,o),r.child;case 12:return Vs(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Sa(r,r.type,c.value),Vs(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,ko(r),f=Ps(f),c=c(f),r.flags|=1,Vs(n,r,c,o),r.child;case 14:return n1(n,r,r.type,r.pendingProps,o);case 15:return s1(n,r,r.type,r.pendingProps,o);case 19:return h1(n,r,o);case 31:return TE(n,r,o);case 22:return r1(n,r,o,r.pendingProps);case 24:return ko(r),c=Ps(gs),n===null?(f=em(),f===null&&(f=Mn,m=Jf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},nm(r),Sa(r,gs,f)):((n.lanes&o)!==0&&(sm(n,r),Tc(r,null,null,o),Ec()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Sa(r,gs,c)):(c=m.cache,Sa(r,gs,c),c!==f.cache&&Xf(r,[gs],o,!0))),Vs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Qi(n){n.flags|=4}function Vm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(B1())n.flags|=8192;else throw To=gd,tm}else n.flags&=-16777217}function m1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Nb(r))if(B1())n.flags|=8192;else throw To=gd,tm}function Id(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?lt():536870912,n.lanes|=r,Sl|=r)}function Ic(n,r){if(!an)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Bn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function CE(n,r,o){var c=r.pendingProps;switch(Wf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(r),null;case 1:return Bn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Wi(gs),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(ml(r)?Qi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Kf())),Bn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Qi(r),m!==null?(Bn(r),m1(r,m)):(Bn(r),Vm(r,f,null,c,o))):m?m!==n.memoizedState?(Qi(r),Bn(r),m1(r,m)):(Bn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Qi(r),Bn(r),Vm(r,f,n,c,o)),null;case 27:if(Rt(r),o=Pe.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}n=Se.current,ml(r)?G0(r):(n=xb(f,c,o),r.stateNode=n,Qi(r))}return Bn(r),null;case 5:if(Rt(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}if(m=Se.current,ml(r))G0(r);else{var x=Gd(Pe.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[Nt]=r,m[Ct]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Us(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Qi(r)}}return Bn(r),Vm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Qi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Pe.current,ml(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Os,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Nt]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ub(n.nodeValue,o)),n||Ta(r,!0)}else n=Gd(n).createTextNode(c),n[Nt]=r,r.stateNode=n}return Bn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=ml(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Nt]=r}else xo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),n=!1}else o=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Nr(r),r):(Nr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Bn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=ml(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Nt]=r}else xo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),f=!1}else f=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Nr(r),r):(Nr(r),null)}return Nr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Id(r,r.updateQueue),Bn(r),null);case 4:return Je(),n===null&&ag(r.stateNode.containerInfo),Bn(r),null;case 10:return Wi(r.type),Bn(r),null;case 19:if(ce(us),c=r.memoizedState,c===null)return Bn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Ic(c,!1);else{if(ns!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=bd(n),m!==null){for(r.flags|=128,Ic(c,!1),n=m.updateQueue,r.updateQueue=n,Id(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)F0(o,n),o=o.sibling;return je(us,us.current&1|2),an&&qi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&mt()>Pd&&(r.flags|=128,f=!0,Ic(c,!1),r.lanes=4194304)}else{if(!f)if(n=bd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Id(r,n),Ic(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!an)return Bn(r),null}else 2*mt()-c.renderingStartTime>Pd&&o!==536870912&&(r.flags|=128,f=!0,Ic(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=mt(),n.sibling=null,o=us.current,je(us,f?o&1|2:o&1),an&&qi(r,c.treeForkCount),n):(Bn(r),null);case 22:case 23:return Nr(r),om(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Bn(r),r.subtreeFlags&6&&(r.flags|=8192)):Bn(r),o=r.updateQueue,o!==null&&Id(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&ce(jo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Wi(gs),Bn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function NE(n,r){switch(Wf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Wi(gs),Je(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Rt(r),null;case 31:if(r.memoizedState!==null){if(Nr(r),r.alternate===null)throw Error(i(340));xo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Nr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));xo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ce(us),null;case 4:return Je(),null;case 10:return Wi(r.type),null;case 22:case 23:return Nr(r),om(),n!==null&&ce(jo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Wi(gs),null;case 25:return null;default:return null}}function g1(n,r){switch(Wf(r),r.tag){case 3:Wi(gs),Je();break;case 26:case 27:case 5:Rt(r);break;case 4:Je();break;case 31:r.memoizedState!==null&&Nr(r);break;case 13:Nr(r);break;case 19:ce(us);break;case 10:Wi(r.type);break;case 22:case 23:Nr(r),om(),n!==null&&ce(jo);break;case 24:Wi(gs)}}function Mc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(j){Tn(r,r.return,j)}}function Ma(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,j=x.destroy;if(j!==void 0){x.destroy=void 0,f=r;var z=o,oe=j;try{oe()}catch(be){Tn(f,z,be)}}}c=c.next}while(c!==m)}}catch(be){Tn(r,r.return,be)}}function p1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{av(r,o)}catch(c){Tn(n,n.return,c)}}}function y1(n,r,o){o.props=No(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){Tn(n,r,c)}}function Dc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){Tn(n,r,f)}}function Ti(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Tn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Tn(n,r,f)}else o.current=null}function v1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Tn(n,n.return,f)}}function Um(n,r,o){try{var c=n.stateNode;XE(c,n.type,o,r),c[Ct]=r}catch(f){Tn(n,n.return,f)}}function b1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ba(n.type)||n.tag===4}function Bm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||b1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ba(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=qs));else if(c!==4&&(c===27&&Ba(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(zm(n,r,o),n=n.sibling;n!==null;)zm(n,r,o),n=n.sibling}function Md(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ba(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Md(n,r,o),n=n.sibling;n!==null;)Md(n,r,o),n=n.sibling}function w1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Us(r,c,o),r[Nt]=n,r[Ct]=o}catch(m){Tn(n,n.return,m)}}var Xi=!1,vs=!1,Fm=!1,x1=typeof WeakSet=="function"?WeakSet:Set,Rs=null;function AE(n,r){if(n=n.containerInfo,cg=eh,n=M0(n),Lf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,j=-1,z=-1,oe=0,be=0,Ee=n,he=null;t:for(;;){for(var me;Ee!==o||f!==0&&Ee.nodeType!==3||(j=x+f),Ee!==m||c!==0&&Ee.nodeType!==3||(z=x+c),Ee.nodeType===3&&(x+=Ee.nodeValue.length),(me=Ee.firstChild)!==null;)he=Ee,Ee=me;for(;;){if(Ee===n)break t;if(he===o&&++oe===f&&(j=x),he===m&&++be===c&&(z=x),(me=Ee.nextSibling)!==null)break;Ee=he,he=Ee.parentNode}Ee=me}o=j===-1||z===-1?null:{start:j,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ug={focusedElem:n,selectionRange:o},eh=!1,Rs=r;Rs!==null;)if(r=Rs,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rs=n;else for(;Rs!==null;){switch(r=Rs,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Ze=No(o.type,f);n=c.getSnapshotBeforeUpdate(Ze,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(bt){Tn(o,o.return,bt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Rs=n;break}Rs=r.return}}function _1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Zi(n,o),c&4&&Mc(5,o);break;case 1:if(Zi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){Tn(o,o.return,x)}else{var f=No(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){Tn(o,o.return,x)}}c&64&&p1(o),c&512&&Dc(o,o.return);break;case 3:if(Zi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{av(n,r)}catch(x){Tn(o,o.return,x)}}break;case 27:r===null&&c&4&&w1(o);case 26:case 5:Zi(n,o),r===null&&c&4&&v1(o),c&512&&Dc(o,o.return);break;case 12:Zi(n,o);break;case 31:Zi(n,o),c&4&&E1(n,o);break;case 13:Zi(n,o),c&4&&T1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=UE.bind(null,o),iT(n,o))));break;case 22:if(c=o.memoizedState!==null||Xi,!c){r=r!==null&&r.memoizedState!==null||vs,f=Xi;var m=vs;Xi=c,(vs=r)&&!m?ea(n,o,(o.subtreeFlags&8772)!==0):Zi(n,o),Xi=f,vs=m}break;case 30:break;default:Zi(n,o)}}function k1(n){var r=n.alternate;r!==null&&(n.alternate=null,k1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&hr(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $n=null,fr=!1;function Ji(n,r,o){for(o=o.child;o!==null;)j1(n,r,o),o=o.sibling}function j1(n,r,o){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(cn,o)}catch{}switch(o.tag){case 26:vs||Ti(o,r),Ji(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:vs||Ti(o,r);var c=$n,f=fr;Ba(o.type)&&($n=o.stateNode,fr=!1),Ji(n,r,o),Hc(o.stateNode),$n=c,fr=f;break;case 5:vs||Ti(o,r);case 6:if(c=$n,f=fr,$n=null,Ji(n,r,o),$n=c,fr=f,$n!==null)if(fr)try{($n.nodeType===9?$n.body:$n.nodeName==="HTML"?$n.ownerDocument.body:$n).removeChild(o.stateNode)}catch(m){Tn(o,r,m)}else try{$n.removeChild(o.stateNode)}catch(m){Tn(o,r,m)}break;case 18:$n!==null&&(fr?(n=$n,pb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Ll(n)):pb($n,o.stateNode));break;case 4:c=$n,f=fr,$n=o.stateNode.containerInfo,fr=!0,Ji(n,r,o),$n=c,fr=f;break;case 0:case 11:case 14:case 15:Ma(2,o,r),vs||Ma(4,o,r),Ji(n,r,o);break;case 1:vs||(Ti(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&y1(o,r,c)),Ji(n,r,o);break;case 21:Ji(n,r,o);break;case 22:vs=(c=vs)||o.memoizedState!==null,Ji(n,r,o),vs=c;break;default:Ji(n,r,o)}}function E1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ll(n)}catch(o){Tn(r,r.return,o)}}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ll(n)}catch(o){Tn(r,r.return,o)}}function RE(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new x1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new x1),r;default:throw Error(i(435,n.tag))}}function Dd(n,r){var o=RE(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=BE.bind(null,n,c);c.then(f,f)}})}function mr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,j=x;e:for(;j!==null;){switch(j.tag){case 27:if(Ba(j.type)){$n=j.stateNode,fr=!1;break e}break;case 5:$n=j.stateNode,fr=!1;break e;case 3:case 4:$n=j.stateNode.containerInfo,fr=!0;break e}j=j.return}if($n===null)throw Error(i(160));j1(m,x,f),$n=null,fr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)S1(r,n),r=r.sibling}var ci=null;function S1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:mr(r,n),gr(n),c&4&&(Ma(3,n,n.return),Mc(3,n),Ma(5,n,n.return));break;case 1:mr(r,n),gr(n),c&512&&(vs||o===null||Ti(o,o.return)),c&64&&Xi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ci;if(mr(r,n),gr(n),c&512&&(vs||o===null||Ti(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[js]||m[Nt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,c,o),m[Nt]=n,bn(m),c=m;break e;case"link":var x=Sb("link","href",f).get(c+(o.href||""));if(x){for(var j=0;j<x.length;j++)if(m=x[j],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;case"meta":if(x=Sb("meta","content",f).get(c+(o.content||""))){for(j=0;j<x.length;j++)if(m=x[j],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(j,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Nt]=n,bn(m),c=m}n.stateNode=c}else Cb(f,n.type,n.stateNode);else n.stateNode=Tb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Cb(f,n.type,n.stateNode):Tb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Um(n,n.memoizedProps,o.memoizedProps)}break;case 27:mr(r,n),gr(n),c&512&&(vs||o===null||Ti(o,o.return)),o!==null&&c&4&&Um(n,n.memoizedProps,o.memoizedProps);break;case 5:if(mr(r,n),gr(n),c&512&&(vs||o===null||Ti(o,o.return)),n.flags&32){f=n.stateNode;try{Ns(f,"")}catch(Ze){Tn(n,n.return,Ze)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Um(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Fm=!0);break;case 6:if(mr(r,n),gr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Ze){Tn(n,n.return,Ze)}}break;case 3:if(Qd=null,f=ci,ci=Kd(r.containerInfo),mr(r,n),ci=f,gr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ll(r.containerInfo)}catch(Ze){Tn(n,n.return,Ze)}Fm&&(Fm=!1,C1(n));break;case 4:c=ci,ci=Kd(n.stateNode.containerInfo),mr(r,n),gr(n),ci=c;break;case 12:mr(r,n),gr(n);break;case 31:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 13:mr(r,n),gr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Od=mt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 22:f=n.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,oe=Xi,be=vs;if(Xi=oe||f,vs=be||z,mr(r,n),vs=be,Xi=oe,gr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||Xi||vs||Ao(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{j=z.stateNode;var Ee=z.memoizedProps.style,he=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;j.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(Ze){Tn(z,z.return,Ze)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(Ze){Tn(z,z.return,Ze)}}}else if(r.tag===18){if(o===null){z=r;try{var me=z.stateNode;f?yb(me,!0):yb(z.stateNode,!1)}catch(Ze){Tn(z,z.return,Ze)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Dd(n,o))));break;case 19:mr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 30:break;case 21:break;default:mr(r,n),gr(n)}}function gr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(b1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Bm(n);Md(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Ns(x,""),o.flags&=-33);var j=Bm(n);Md(n,j,x);break;case 3:case 4:var z=o.stateNode.containerInfo,oe=Bm(n);zm(n,oe,z);break;default:throw Error(i(161))}}catch(be){Tn(n,n.return,be)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function C1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;C1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Zi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)_1(n,r.alternate,r),r=r.sibling}function Ao(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Ma(4,r,r.return),Ao(r);break;case 1:Ti(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&y1(r,r.return,o),Ao(r);break;case 27:Hc(r.stateNode);case 26:case 5:Ti(r,r.return),Ao(r);break;case 22:r.memoizedState===null&&Ao(r);break;case 30:Ao(r);break;default:Ao(r)}n=n.sibling}}function ea(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:ea(f,m,o),Mc(4,m);break;case 1:if(ea(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(oe){Tn(c,c.return,oe)}if(c=m,f=c.updateQueue,f!==null){var j=c.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)iv(z[f],j)}catch(oe){Tn(c,c.return,oe)}}o&&x&64&&p1(m),Dc(m,m.return);break;case 27:w1(m);case 26:case 5:ea(f,m,o),o&&c===null&&x&4&&v1(m),Dc(m,m.return);break;case 12:ea(f,m,o);break;case 31:ea(f,m,o),o&&x&4&&E1(f,m);break;case 13:ea(f,m,o),o&&x&4&&T1(f,m);break;case 22:m.memoizedState===null&&ea(f,m,o),Dc(m,m.return);break;case 30:break;default:ea(f,m,o)}r=r.sibling}}function Hm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&wc(o))}function qm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&wc(n))}function ui(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N1(n,r,o,c),r=r.sibling}function N1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ui(n,r,o,c),f&2048&&Mc(9,r);break;case 1:ui(n,r,o,c);break;case 3:ui(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&wc(n)));break;case 12:if(f&2048){ui(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,j=m.onPostCommit;typeof j=="function"&&j(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(z){Tn(r,r.return,z)}}else ui(n,r,o,c);break;case 31:ui(n,r,o,c);break;case 13:ui(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?ui(n,r,o,c):Lc(n,r):m._visibility&2?ui(n,r,o,c):(m._visibility|=2,jl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Hm(x,r);break;case 24:ui(n,r,o,c),f&2048&&qm(r.alternate,r);break;default:ui(n,r,o,c)}}function jl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,j=o,z=c,oe=x.flags;switch(x.tag){case 0:case 11:case 15:jl(m,x,j,z,f),Mc(8,x);break;case 23:break;case 22:var be=x.stateNode;x.memoizedState!==null?be._visibility&2?jl(m,x,j,z,f):Lc(m,x):(be._visibility|=2,jl(m,x,j,z,f)),f&&oe&2048&&Hm(x.alternate,x);break;case 24:jl(m,x,j,z,f),f&&oe&2048&&qm(x.alternate,x);break;default:jl(m,x,j,z,f)}r=r.sibling}}function Lc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Lc(o,c),f&2048&&Hm(c.alternate,c);break;case 24:Lc(o,c),f&2048&&qm(c.alternate,c);break;default:Lc(o,c)}r=r.sibling}}var Oc=8192;function El(n,r,o){if(n.subtreeFlags&Oc)for(n=n.child;n!==null;)A1(n,r,o),n=n.sibling}function A1(n,r,o){switch(n.tag){case 26:El(n,r,o),n.flags&Oc&&n.memoizedState!==null&&yT(o,ci,n.memoizedState,n.memoizedProps);break;case 5:El(n,r,o);break;case 3:case 4:var c=ci;ci=Kd(n.stateNode.containerInfo),El(n,r,o),ci=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Oc,Oc=16777216,El(n,r,o),Oc=c):El(n,r,o));break;default:El(n,r,o)}}function R1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Pc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,M1(c,n)}R1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)I1(n),n=n.sibling}function I1(n){switch(n.tag){case 0:case 11:case 15:Pc(n),n.flags&2048&&Ma(9,n,n.return);break;case 3:Pc(n);break;case 12:Pc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Ld(n)):Pc(n);break;default:Pc(n)}}function Ld(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Rs=c,M1(c,n)}R1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Ma(8,r,r.return),Ld(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ld(r));break;default:Ld(r)}n=n.sibling}}function M1(n,r){for(;Rs!==null;){var o=Rs;switch(o.tag){case 0:case 11:case 15:Ma(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:wc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Rs=c;else e:for(o=n;Rs!==null;){c=Rs;var f=c.sibling,m=c.return;if(k1(c),c===o){Rs=null;break e}if(f!==null){f.return=m,Rs=f;break e}Rs=m}}}var IE={getCacheForType:function(n){var r=Ps(gs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Ps(gs).controller.signal}},ME=typeof WeakMap=="function"?WeakMap:Map,_n=0,Mn=null,Kt=null,Jt=0,En=0,Ar=null,Da=!1,Tl=!1,$m=!1,ta=0,ns=0,La=0,Ro=0,Wm=0,Rr=0,Sl=0,Vc=null,pr=null,Gm=!1,Od=0,D1=0,Pd=1/0,Vd=null,Oa=null,Es=0,Pa=null,Cl=null,na=0,Km=0,Ym=null,L1=null,Uc=0,Qm=null;function Ir(){return(_n&2)!==0&&Jt!==0?Jt&-Jt:te.T!==null?ng():et()}function O1(){if(Rr===0)if((Jt&536870912)===0||an){var n=Ie;Ie<<=1,(Ie&3932160)===0&&(Ie=262144),Rr=n}else Rr=536870912;return n=Cr.current,n!==null&&(n.flags|=32),Rr}function yr(n,r,o){(n===Mn&&(En===2||En===9)||n.cancelPendingCommit!==null)&&(Nl(n,0),Va(n,Jt,Rr,!1)),dn(n,o),((_n&2)===0||n!==Mn)&&(n===Mn&&((_n&2)===0&&(Ro|=o),ns===4&&Va(n,Jt,Rr,!1)),Si(n))}function P1(n,r,o){if((_n&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Lt(n,r),f=c?OE(n,r):Jm(n,r,!0),m=c;do{if(f===0){Tl&&!c&&Va(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!DE(o)){f=Jm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var j=n;f=Vc;var z=j.current.memoizedState.isDehydrated;if(z&&(Nl(j,x).flags|=256),x=Jm(j,x,!1),x!==2){if($m&&!z){j.errorRecoveryDisabledLanes|=m,Ro|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Nl(n,0),Va(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Va(c,r,Rr,!Da);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Od+300-mt(),10<f)){if(Va(c,r,Rr,!Da),Oe(c,0,!0)!==0)break e;na=r,c.timeoutHandle=mb(V1.bind(null,c,o,pr,Vd,Gm,r,Rr,Ro,Sl,Da,m,"Throttled",-0,0),f);break e}V1(c,o,pr,Vd,Gm,r,Rr,Ro,Sl,Da,m,null,-0,0)}}break}while(!0);Si(n)}function V1(n,r,o,c,f,m,x,j,z,oe,be,Ee,he,me){if(n.timeoutHandle=-1,Ee=r.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qs},A1(r,m,Ee);var Ze=(m&62914560)===m?Od-mt():(m&4194048)===m?D1-mt():0;if(Ze=vT(Ee,Ze),Ze!==null){na=m,n.cancelPendingCommit=Ze(W1.bind(null,n,r,m,o,c,f,x,j,z,be,Ee,null,he,me)),Va(n,m,x,!oe);return}}W1(n,r,m,o,c,f,x,j,z)}function DE(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Tr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Va(n,r,o,c){r&=~Wm,r&=~Ro,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-It(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&ms(n,o,r)}function Ud(){return(_n&6)===0?(Bc(0),!1):!0}function Xm(){if(Kt!==null){if(En===0)var n=Kt.return;else n=Kt,$i=_o=null,fm(n),bl=null,_c=0,n=Kt;for(;n!==null;)g1(n.alternate,n),n=n.return;Kt=null}}function Nl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,eT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),na=0,Xm(),Mn=n,Kt=o=Hi(n.current,null),Jt=r,En=0,Ar=null,Da=!1,Tl=Lt(n,r),$m=!1,Sl=Rr=Wm=Ro=La=ns=0,pr=Vc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-It(c),m=1<<f;r|=n[f],c&=~m}return ta=r,ad(),o}function U1(n,r){Ut=null,te.H=Ac,r===vl||r===md?(r=tv(),En=3):r===tm?(r=tv(),En=4):En=r===Nm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ar=r,Kt===null&&(ns=1,Cd(n,Fr(r,n.current)))}function B1(){var n=Cr.current;return n===null?!0:(Jt&4194048)===Jt?Wr===null:(Jt&62914560)===Jt||(Jt&536870912)!==0?n===Wr:!1}function z1(){var n=te.H;return te.H=Ac,n===null?Ac:n}function F1(){var n=te.A;return te.A=IE,n}function Bd(){ns=4,Da||(Jt&4194048)!==Jt&&Cr.current!==null||(Tl=!0),(La&134217727)===0&&(Ro&134217727)===0||Mn===null||Va(Mn,Jt,Rr,!1)}function Jm(n,r,o){var c=_n;_n|=2;var f=z1(),m=F1();(Mn!==n||Jt!==r)&&(Vd=null,Nl(n,r)),r=!1;var x=ns;e:do try{if(En!==0&&Kt!==null){var j=Kt,z=Ar;switch(En){case 8:Xm(),x=6;break e;case 3:case 2:case 9:case 6:Cr.current===null&&(r=!0);var oe=En;if(En=0,Ar=null,Al(n,j,z,oe),o&&Tl){x=0;break e}break;default:oe=En,En=0,Ar=null,Al(n,j,z,oe)}}LE(),x=ns;break}catch(be){U1(n,be)}while(!0);return r&&n.shellSuspendCounter++,$i=_o=null,_n=c,te.H=f,te.A=m,Kt===null&&(Mn=null,Jt=0,ad()),x}function LE(){for(;Kt!==null;)H1(Kt)}function OE(n,r){var o=_n;_n|=2;var c=z1(),f=F1();Mn!==n||Jt!==r?(Vd=null,Pd=mt()+500,Nl(n,r)):Tl=Lt(n,r);e:do try{if(En!==0&&Kt!==null){r=Kt;var m=Ar;t:switch(En){case 1:En=0,Ar=null,Al(n,r,m,1);break;case 2:case 9:if(Z0(m)){En=0,Ar=null,q1(r);break}r=function(){En!==2&&En!==9||Mn!==n||(En=7),Si(n)},m.then(r,r);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Z0(m)?(En=0,Ar=null,q1(r)):(En=0,Ar=null,Al(n,r,m,7));break;case 5:var x=null;switch(Kt.tag){case 26:x=Kt.memoizedState;case 5:case 27:var j=Kt;if(x?Nb(x):j.stateNode.complete){En=0,Ar=null;var z=j.sibling;if(z!==null)Kt=z;else{var oe=j.return;oe!==null?(Kt=oe,zd(oe)):Kt=null}break t}}En=0,Ar=null,Al(n,r,m,5);break;case 6:En=0,Ar=null,Al(n,r,m,6);break;case 8:Xm(),ns=6;break e;default:throw Error(i(462))}}PE();break}catch(be){U1(n,be)}while(!0);return $i=_o=null,te.H=c,te.A=f,_n=o,Kt!==null?0:(Mn=null,Jt=0,ad(),ns)}function PE(){for(;Kt!==null&&!it();)H1(Kt)}function H1(n){var r=f1(n.alternate,n,ta);n.memoizedProps=n.pendingProps,r===null?zd(n):Kt=r}function q1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=o1(o,r,r.pendingProps,r.type,void 0,Jt);break;case 11:r=o1(o,r,r.pendingProps,r.type.render,r.ref,Jt);break;case 5:fm(r);default:g1(o,r),r=Kt=F0(r,ta),r=f1(o,r,ta)}n.memoizedProps=n.pendingProps,r===null?zd(n):Kt=r}function Al(n,r,o,c){$i=_o=null,fm(r),bl=null,_c=0;var f=r.return;try{if(EE(n,f,r,o,Jt)){ns=1,Cd(n,Fr(o,n.current)),Kt=null;return}}catch(m){if(f!==null)throw Kt=f,m;ns=1,Cd(n,Fr(o,n.current)),Kt=null;return}r.flags&32768?(an||c===1?n=!0:Tl||(Jt&536870912)!==0?n=!1:(Da=n=!0,(c===2||c===9||c===3||c===6)&&(c=Cr.current,c!==null&&c.tag===13&&(c.flags|=16384))),$1(r,n)):zd(r)}function zd(n){var r=n;do{if((r.flags&32768)!==0){$1(r,Da);return}n=r.return;var o=CE(r.alternate,r,ta);if(o!==null){Kt=o;return}if(r=r.sibling,r!==null){Kt=r;return}Kt=r=n}while(r!==null);ns===0&&(ns=5)}function $1(n,r){do{var o=NE(n.alternate,n);if(o!==null){o.flags&=32767,Kt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Kt=n;return}Kt=n=o}while(n!==null);ns=6,Kt=null}function W1(n,r,o,c,f,m,x,j,z){n.cancelPendingCommit=null;do Fd();while(Es!==0);if((_n&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Bf,Pn(n,o,m,x,j,z),n===Mn&&(Kt=Mn=null,Jt=0),Cl=r,Pa=n,na=o,Km=m,Ym=f,L1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,zE(rn,function(){return X1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=te.T,te.T=null,f=Te.p,Te.p=2,x=_n,_n|=4;try{AE(n,r,o)}finally{_n=x,Te.p=f,te.T=c}}Es=1,G1(),K1(),Y1()}}function G1(){if(Es===1){Es=0;var n=Pa,r=Cl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=te.T,te.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{S1(r,n);var m=ug,x=M0(n.containerInfo),j=m.focusedElem,z=m.selectionRange;if(x!==j&&j&&j.ownerDocument&&I0(j.ownerDocument.documentElement,j)){if(z!==null&&Lf(j)){var oe=z.start,be=z.end;if(be===void 0&&(be=oe),"selectionStart"in j)j.selectionStart=oe,j.selectionEnd=Math.min(be,j.value.length);else{var Ee=j.ownerDocument||document,he=Ee&&Ee.defaultView||window;if(he.getSelection){var me=he.getSelection(),Ze=j.textContent.length,bt=Math.min(z.start,Ze),Rn=z.end===void 0?bt:Math.min(z.end,Ze);!me.extend&&bt>Rn&&(x=Rn,Rn=bt,bt=x);var J=R0(j,bt),W=R0(j,Rn);if(J&&W&&(me.rangeCount!==1||me.anchorNode!==J.node||me.anchorOffset!==J.offset||me.focusNode!==W.node||me.focusOffset!==W.offset)){var ie=Ee.createRange();ie.setStart(J.node,J.offset),me.removeAllRanges(),bt>Rn?(me.addRange(ie),me.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),me.addRange(ie))}}}}for(Ee=[],me=j;me=me.parentNode;)me.nodeType===1&&Ee.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Ee.length;j++){var xe=Ee[j];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}eh=!!cg,ug=cg=null}finally{_n=f,Te.p=c,te.T=o}}n.current=r,Es=2}}function K1(){if(Es===2){Es=0;var n=Pa,r=Cl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=te.T,te.T=null;var c=Te.p;Te.p=2;var f=_n;_n|=4;try{_1(n,r.alternate,r)}finally{_n=f,Te.p=c,te.T=o}}Es=3}}function Y1(){if(Es===4||Es===3){Es=0,yt();var n=Pa,r=Cl,o=na,c=L1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,Cl=Pa=null,Q1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Oa=null),ct(o),r=r.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(cn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=te.T,f=Te.p,Te.p=2,te.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var j=c[x];m(j.value,{componentStack:j.stack})}}finally{te.T=r,Te.p=f}}(na&3)!==0&&Fd(),Si(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Qm?Uc++:(Uc=0,Qm=n):Uc=0,Bc(0)}}function Q1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,wc(r)))}function Fd(){return G1(),K1(),Y1(),X1()}function X1(){if(Es!==5)return!1;var n=Pa,r=Km;Km=0;var o=ct(na),c=te.T,f=Te.p;try{Te.p=32>o?32:o,te.T=null,o=Ym,Ym=null;var m=Pa,x=na;if(Es=0,Cl=Pa=null,na=0,(_n&6)!==0)throw Error(i(331));var j=_n;if(_n|=4,I1(m.current),N1(m,m.current,x,o),_n=j,Bc(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(cn,m)}catch{}return!0}finally{Te.p=f,te.T=c,Q1(n,r)}}function J1(n,r,o){r=Fr(o,r),r=Cm(n.stateNode,r,2),n=Aa(n,r,2),n!==null&&(dn(n,2),Si(n))}function Tn(n,r,o){if(n.tag===3)J1(n,n,o);else for(;r!==null;){if(r.tag===3){J1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Oa===null||!Oa.has(c))){n=Fr(o,n),o=Zv(2),c=Aa(r,o,2),c!==null&&(e1(o,c,r,n),dn(c,2),Si(c));break}}r=r.return}}function Zm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new ME;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||($m=!0,f.add(o),n=VE.bind(null,n,r,o),r.then(n,n))}function VE(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Mn===n&&(Jt&o)===o&&(ns===4||ns===3&&(Jt&62914560)===Jt&&300>mt()-Od?(_n&2)===0&&Nl(n,0):Wm|=o,Sl===Jt&&(Sl=0)),Si(n)}function Z1(n,r){r===0&&(r=lt()),n=bo(n,r),n!==null&&(dn(n,r),Si(n))}function UE(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Z1(n,o)}function BE(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Z1(n,o)}function zE(n,r){return pt(n,r)}var Hd=null,Rl=null,eg=!1,qd=!1,tg=!1,Ua=0;function Si(n){n!==Rl&&n.next===null&&(Rl===null?Hd=Rl=n:Rl=Rl.next=n),qd=!0,eg||(eg=!0,HE())}function Bc(n,r){if(!tg&&qd){tg=!0;do for(var o=!1,c=Hd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,j=c.pingedLanes;m=(1<<31-It(42|n)+1)-1,m&=f&~(x&~j),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,sb(c,m))}else m=Jt,m=Oe(c,c===Mn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Lt(c,m)||(o=!0,sb(c,m));c=c.next}while(o);tg=!1}}function FE(){eb()}function eb(){qd=eg=!1;var n=0;Ua!==0&&ZE()&&(n=Ua);for(var r=mt(),o=null,c=Hd;c!==null;){var f=c.next,m=tb(c,r);m===0?(c.next=null,o===null?Hd=f:o.next=f,f===null&&(Rl=o)):(o=c,(n!==0||(m&3)!==0)&&(qd=!0)),c=f}Es!==0&&Es!==5||Bc(n),Ua!==0&&(Ua=0)}function tb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-It(m),j=1<<x,z=f[x];z===-1?((j&o)===0||(j&c)!==0)&&(f[x]=xt(j,r)):z<=r&&(n.expiredLanes|=j),m&=~j}if(r=Mn,o=Jt,o=Oe(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(En===2||En===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Ht(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Lt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Ht(c),ct(o)){case 2:case 8:o=fs;break;case 32:o=rn;break;case 268435456:o=Fn;break;default:o=rn}return c=nb.bind(null,n),o=pt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Ht(c),n.callbackPriority=2,n.callbackNode=null,2}function nb(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Fd()&&n.callbackNode!==o)return null;var c=Jt;return c=Oe(n,n===Mn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(P1(n,c,r),tb(n,mt()),n.callbackNode!=null&&n.callbackNode===o?nb.bind(null,n):null)}function sb(n,r){if(Fd())return null;P1(n,r,!0)}function HE(){tT(function(){(_n&6)!==0?pt(Bt,FE):eb()})}function ng(){if(Ua===0){var n=pl;n===0&&(n=Re,Re<<=1,(Re&261888)===0&&(Re=256)),Ua=n}return Ua}function rb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:jr(""+n)}function ib(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function qE(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=rb((f[Ct]||null).action),x=c.submitter;x&&(r=(r=x[Ct]||null)?rb(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var j=new fn("action","action",null,c,f);n.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ua!==0){var z=x?ib(f,x):new FormData(f);_m(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(j.preventDefault(),z=x?ib(f,x):new FormData(f),_m(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var sg=0;sg<Uf.length;sg++){var rg=Uf[sg],$E=rg.toLowerCase(),WE=rg[0].toUpperCase()+rg.slice(1);li($E,"on"+WE)}li(O0,"onAnimationEnd"),li(P0,"onAnimationIteration"),li(V0,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(lE,"onTransitionRun"),li(cE,"onTransitionStart"),li(uE,"onTransitionCancel"),li(U0,"onTransitionEnd"),Kn("onMouseEnter",["mouseout","mouseover"]),Kn("onMouseLeave",["mouseout","mouseover"]),Kn("onPointerEnter",["pointerout","pointerover"]),Kn("onPointerLeave",["pointerout","pointerover"]),Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zc));function ab(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var j=c[x],z=j.instance,oe=j.currentTarget;if(j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=oe;try{m(f)}catch(be){id(be)}f.currentTarget=null,m=z}else for(x=0;x<c.length;x++){if(j=c[x],z=j.instance,oe=j.currentTarget,j=j.listener,z!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=oe;try{m(f)}catch(be){id(be)}f.currentTarget=null,m=z}}}}function Yt(n,r){var o=r[Ss];o===void 0&&(o=r[Ss]=new Set);var c=n+"__bubble";o.has(c)||(ob(r,n,2,!1),o.add(c))}function ig(n,r,o){var c=0;r&&(c|=4),ob(o,n,c,r)}var $d="_reactListening"+Math.random().toString(36).slice(2);function ag(n){if(!n[$d]){n[$d]=!0,Zn.forEach(function(o){o!=="selectionchange"&&(GE.has(o)||ig(o,!1,n),ig(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[$d]||(r[$d]=!0,ig("selectionchange",!1,r))}}function ob(n,r,o,c){switch(Ob(r)){case 2:var f=xT;break;case 8:f=_T;break;default:f=xg}o=f.bind(null,r,o,n),f=void 0,!de||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function og(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var j=c.stateNode.containerInfo;if(j===f)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;j!==null;){if(x=Gn(j),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=m=x;continue e}j=j.parentNode}}c=c.return}F(function(){var oe=m,be=Ls(o),Ee=[];e:{var he=B0.get(n);if(he!==void 0){var me=fn,Ze=n;switch(n){case"keypress":if(_t(o)===0)break e;case"keydown":case"keyup":me=nd;break;case"focusin":Ze="focus",me=ii;break;case"focusout":Ze="blur",me=ii;break;case"beforeblur":case"afterblur":me=ii;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=go;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=v;break;case O0:case P0:case V0:me=Yu;break;case U0:me=N;break;case"scroll":case"scrollend":me=mn;break;case"wheel":me=fe;break;case"copy":case"cut":case"paste":me=Qu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Fi;break;case"toggle":case"beforetoggle":me=Vt}var bt=(r&4)!==0,Rn=!bt&&(n==="scroll"||n==="scrollend"),J=bt?he!==null?he+"Capture":null:he;bt=[];for(var W=oe,ie;W!==null;){var xe=W;if(ie=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ie===null||J===null||(xe=$(W,J),xe!=null&&bt.push(Fc(W,xe,ie))),Rn)break;W=W.return}0<bt.length&&(he=new me(he,Ze,null,o,be),Ee.push({event:he,listeners:bt}))}}if((r&7)===0){e:{if(he=n==="mouseover"||n==="pointerover",me=n==="mouseout"||n==="pointerout",he&&o!==$s&&(Ze=o.relatedTarget||o.fromElement)&&(Gn(Ze)||Ze[vn]))break e;if((me||he)&&(he=be.window===be?be:(he=be.ownerDocument)?he.defaultView||he.parentWindow:window,me?(Ze=o.relatedTarget||o.toElement,me=oe,Ze=Ze?Gn(Ze):null,Ze!==null&&(Rn=u(Ze),bt=Ze.tag,Ze!==Rn||bt!==5&&bt!==27&&bt!==6)&&(Ze=null)):(me=null,Ze=oe),me!==Ze)){if(bt=nr,xe="onMouseLeave",J="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(bt=Fi,xe="onPointerLeave",J="onPointerEnter",W="pointer"),Rn=me==null?he:ls(me),ie=Ze==null?he:ls(Ze),he=new bt(xe,W+"leave",me,o,be),he.target=Rn,he.relatedTarget=ie,xe=null,Gn(be)===oe&&(bt=new bt(J,W+"enter",Ze,o,be),bt.target=ie,bt.relatedTarget=Rn,xe=bt),Rn=xe,me&&Ze)t:{for(bt=KE,J=me,W=Ze,ie=0,xe=J;xe;xe=bt(xe))ie++;xe=0;for(var ht=W;ht;ht=bt(ht))xe++;for(;0<ie-xe;)J=bt(J),ie--;for(;0<xe-ie;)W=bt(W),xe--;for(;ie--;){if(J===W||W!==null&&J===W.alternate){bt=J;break t}J=bt(J),W=bt(W)}bt=null}else bt=null;me!==null&&lb(Ee,he,me,bt,!1),Ze!==null&&Rn!==null&&lb(Ee,Rn,Ze,bt,!0)}}e:{if(he=oe?ls(oe):window,me=he.nodeName&&he.nodeName.toLowerCase(),me==="select"||me==="input"&&he.type==="file")var pn=E0;else if(k0(he))if(T0)pn=iE;else{pn=sE;var at=nE}else me=he.nodeName,!me||me.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?oe&&xi(oe.elementType)&&(pn=E0):pn=rE;if(pn&&(pn=pn(n,oe))){j0(Ee,pn,o,be);break e}at&&at(n,he,oe),n==="focusout"&&oe&&he.type==="number"&&oe.memoizedProps.value!=null&&Ds(he,"number",he.value)}switch(at=oe?ls(oe):window,n){case"focusin":(k0(at)||at.contentEditable==="true")&&(ll=at,Of=oe,yc=null);break;case"focusout":yc=Of=ll=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,D0(Ee,o,be);break;case"selectionchange":if(oE)break;case"keydown":case"keyup":D0(Ee,o,be)}var zt;if(xn)e:{switch(n){case"compositionstart":var Zt="onCompositionStart";break e;case"compositionend":Zt="onCompositionEnd";break e;case"compositionupdate":Zt="onCompositionUpdate";break e}Zt=void 0}else ol?po(n,o)&&(Zt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Zt="onCompositionStart");Zt&&(ki&&o.locale!=="ko"&&(ol||Zt!=="onCompositionStart"?Zt==="onCompositionEnd"&&ol&&(zt=vt()):(Ve=be,tt="value"in Ve?Ve.value:Ve.textContent,ol=!0)),at=Wd(oe,Zt),0<at.length&&(Zt=new _i(Zt,n,null,o,be),Ee.push({event:Zt,listeners:at}),zt?Zt.data=zt:(zt=al(o),zt!==null&&(Zt.data=zt)))),(zt=Br?Jj(n,o):Zj(n,o))&&(Zt=Wd(oe,"onBeforeInput"),0<Zt.length&&(at=new _i("onBeforeInput","beforeinput",null,o,be),Ee.push({event:at,listeners:Zt}),at.data=zt)),qE(Ee,n,oe,o,be)}ab(Ee,r)})}function Fc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Wd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=$(n,o),f!=null&&c.unshift(Fc(n,f,m)),f=$(n,r),f!=null&&c.push(Fc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function KE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function lb(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var j=o,z=j.alternate,oe=j.stateNode;if(j=j.tag,z!==null&&z===c)break;j!==5&&j!==26&&j!==27||oe===null||(z=oe,f?(oe=$(o,m),oe!=null&&x.unshift(Fc(o,oe,z))):f||(oe=$(o,m),oe!=null&&x.push(Fc(o,oe,z)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var YE=/\r\n?/g,QE=/\u0000|\uFFFD/g;function cb(n){return(typeof n=="string"?n:""+n).replace(YE,`
`).replace(QE,"")}function ub(n,r){return r=cb(r),cb(n)===r}function An(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ns(n,""+c);break;case"className":ae(n,"class",c);break;case"tabIndex":ae(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ae(n,o,c);break;case"style":ri(n,c,m);break;case"data":if(r!=="object"){ae(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=jr(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&An(n,r,"name",f.name,f,null),An(n,r,"formEncType",f.formEncType,f,null),An(n,r,"formMethod",f.formMethod,f,null),An(n,r,"formTarget",f.formTarget,f,null)):(An(n,r,"encType",f.encType,f,null),An(n,r,"method",f.method,f,null),An(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=jr(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=qs);break;case"onScroll":c!=null&&Yt("scroll",n);break;case"onScrollEnd":c!=null&&Yt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=jr(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Yt("beforetoggle",n),Yt("toggle",n),H(n,"popover",c);break;case"xlinkActuate":ne(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ne(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ne(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ne(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ne(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ne(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ne(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ne(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ne(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":H(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=zi.get(o)||o,H(n,o,c))}}function lg(n,r,o,c,f,m){switch(o){case"style":ri(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Ns(n,c):(typeof c=="number"||typeof c=="bigint")&&Ns(n,""+c);break;case"onScroll":c!=null&&Yt("scroll",n);break;case"onScrollEnd":c!=null&&Yt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=qs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[Ct]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):H(n,o,c)}}}function Us(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yt("error",n),Yt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:An(n,r,m,x,o,null)}}f&&An(n,r,"srcSet",o.srcSet,o,null),c&&An(n,r,"src",o.src,o,null);return;case"input":Yt("invalid",n);var j=m=x=f=null,z=null,oe=null;for(c in o)if(o.hasOwnProperty(c)){var be=o[c];if(be!=null)switch(c){case"name":f=be;break;case"type":x=be;break;case"checked":z=be;break;case"defaultChecked":oe=be;break;case"value":m=be;break;case"defaultValue":j=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(i(137,r));break;default:An(n,r,c,be,o,null)}}si(n,m,j,z,oe,x,f,!1);return;case"select":Yt("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(j=o[f],j!=null))switch(f){case"value":m=j;break;case"defaultValue":x=j;break;case"multiple":c=j;default:An(n,r,f,j,o,null)}r=m,o=x,n.multiple=!!c,r!=null?er(n,!!c,r,!1):o!=null&&er(n,!!c,o,!0);return;case"textarea":Yt("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(j=o[x],j!=null))switch(x){case"value":c=j;break;case"defaultValue":f=j;break;case"children":m=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(91));break;default:An(n,r,x,j,o,null)}kr(n,c,f,m);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":An(n,r,z,c,o,null));return;case"dialog":Yt("beforetoggle",n),Yt("toggle",n),Yt("cancel",n),Yt("close",n);break;case"iframe":case"object":Yt("load",n);break;case"video":case"audio":for(c=0;c<zc.length;c++)Yt(zc[c],n);break;case"image":Yt("error",n),Yt("load",n);break;case"details":Yt("toggle",n);break;case"embed":case"source":case"link":Yt("error",n),Yt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in o)if(o.hasOwnProperty(oe)&&(c=o[oe],c!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:An(n,r,oe,c,o,null)}return;default:if(xi(r)){for(be in o)o.hasOwnProperty(be)&&(c=o[be],c!==void 0&&lg(n,r,be,c,o,void 0));return}}for(j in o)o.hasOwnProperty(j)&&(c=o[j],c!=null&&An(n,r,j,c,o,null))}function XE(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,j=null,z=null,oe=null,be=null;for(me in o){var Ee=o[me];if(o.hasOwnProperty(me)&&Ee!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":z=Ee;default:c.hasOwnProperty(me)||An(n,r,me,null,c,Ee)}}for(var he in c){var me=c[he];if(Ee=o[he],c.hasOwnProperty(he)&&(me!=null||Ee!=null))switch(he){case"type":m=me;break;case"name":f=me;break;case"checked":oe=me;break;case"defaultChecked":be=me;break;case"value":x=me;break;case"defaultValue":j=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:me!==Ee&&An(n,r,he,me,c,Ee)}}Ms(n,x,j,z,oe,be,m,f);return;case"select":me=x=j=he=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":me=z;default:c.hasOwnProperty(m)||An(n,r,m,null,c,z)}for(f in c)if(m=c[f],z=o[f],c.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":he=m;break;case"defaultValue":j=m;break;case"multiple":x=m;default:m!==z&&An(n,r,f,m,c,z)}r=j,o=x,c=me,he!=null?er(n,!!o,he,!1):!!c!=!!o&&(r!=null?er(n,!!o,r,!0):er(n,!!o,o?[]:"",!1));return;case"textarea":me=he=null;for(j in o)if(f=o[j],o.hasOwnProperty(j)&&f!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:An(n,r,j,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":he=f;break;case"defaultValue":me=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&An(n,r,x,f,c,m)}wi(n,he,me);return;case"option":for(var Ze in o)he=o[Ze],o.hasOwnProperty(Ze)&&he!=null&&!c.hasOwnProperty(Ze)&&(Ze==="selected"?n.selected=!1:An(n,r,Ze,null,c,he));for(z in c)he=c[z],me=o[z],c.hasOwnProperty(z)&&he!==me&&(he!=null||me!=null)&&(z==="selected"?n.selected=he&&typeof he!="function"&&typeof he!="symbol":An(n,r,z,he,c,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in o)he=o[bt],o.hasOwnProperty(bt)&&he!=null&&!c.hasOwnProperty(bt)&&An(n,r,bt,null,c,he);for(oe in c)if(he=c[oe],me=o[oe],c.hasOwnProperty(oe)&&he!==me&&(he!=null||me!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,r));break;default:An(n,r,oe,he,c,me)}return;default:if(xi(r)){for(var Rn in o)he=o[Rn],o.hasOwnProperty(Rn)&&he!==void 0&&!c.hasOwnProperty(Rn)&&lg(n,r,Rn,void 0,c,he);for(be in c)he=c[be],me=o[be],!c.hasOwnProperty(be)||he===me||he===void 0&&me===void 0||lg(n,r,be,he,c,me);return}}for(var J in o)he=o[J],o.hasOwnProperty(J)&&he!=null&&!c.hasOwnProperty(J)&&An(n,r,J,null,c,he);for(Ee in c)he=c[Ee],me=o[Ee],!c.hasOwnProperty(Ee)||he===me||he==null&&me==null||An(n,r,Ee,he,c,me)}function db(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function JE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,j=f.duration;if(m&&j&&db(x)){for(x=0,j=f.responseEnd,c+=1;c<o.length;c++){var z=o[c],oe=z.startTime;if(oe>j)break;var be=z.transferSize,Ee=z.initiatorType;be&&db(Ee)&&(z=z.responseEnd,x+=be*(z<j?1:(j-oe)/(z-oe)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cg=null,ug=null;function Gd(n){return n.nodeType===9?n:n.ownerDocument}function hb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function dg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hg=null;function ZE(){var n=window.event;return n&&n.type==="popstate"?n===hg?!1:(hg=n,!0):(hg=null,!1)}var mb=typeof setTimeout=="function"?setTimeout:void 0,eT=typeof clearTimeout=="function"?clearTimeout:void 0,gb=typeof Promise=="function"?Promise:void 0,tT=typeof queueMicrotask=="function"?queueMicrotask:typeof gb<"u"?function(n){return gb.resolve(null).then(n).catch(nT)}:mb;function nT(n){setTimeout(function(){throw n})}function Ba(n){return n==="head"}function pb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Ll(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Hc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Hc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,j=m.nodeName;m[js]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Hc(n.ownerDocument.body);o=f}while(o);Ll(r)}function yb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function fg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fg(o),hr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function sT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[js])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Gr(n.nextSibling),n===null)break}return null}function rT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Gr(n.nextSibling),n===null))return null;return n}function vb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Gr(n.nextSibling),n===null))return null;return n}function mg(n){return n.data==="$?"||n.data==="$~"}function gg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function iT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Gr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var pg=null;function bb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Gr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function wb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function xb(n,r,o){switch(r=Gd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Hc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);hr(n)}var Kr=new Map,_b=new Set;function Kd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var sa=Te.d;Te.d={f:aT,r:oT,D:lT,C:cT,L:uT,m:dT,X:fT,S:hT,M:mT};function aT(){var n=sa.f(),r=Ud();return n||r}function oT(n){var r=os(n);r!==null&&r.tag===5&&r.type==="form"?Uv(r):sa.r(n)}var Il=typeof document>"u"?null:document;function kb(n,r,o){var c=Il;if(c&&typeof r=="string"&&r){var f=Yn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),_b.has(f)||(_b.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Us(r,"link",n),bn(r),c.head.appendChild(r)))}}function lT(n){sa.D(n),kb("dns-prefetch",n,null)}function cT(n,r){sa.C(n,r),kb("preconnect",n,r)}function uT(n,r,o){sa.L(n,r,o);var c=Il;if(c&&n&&r){var f='link[rel="preload"][as="'+Yn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Yn(o.imageSizes)+'"]')):f+='[href="'+Yn(n)+'"]';var m=f;switch(r){case"style":m=Ml(n);break;case"script":m=Dl(n)}Kr.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),Kr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(qc(m))||r==="script"&&c.querySelector($c(m))||(r=c.createElement("link"),Us(r,"link",n),bn(r),c.head.appendChild(r)))}}function dT(n,r){sa.m(n,r);var o=Il;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Dl(n)}if(!Kr.has(m)&&(n=k({rel:"modulepreload",href:n},r),Kr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector($c(m)))return}c=o.createElement("link"),Us(c,"link",n),bn(c),o.head.appendChild(c)}}}function hT(n,r,o){sa.S(n,r,o);var c=Il;if(c&&n){var f=Vn(c).hoistableStyles,m=Ml(n);r=r||"default";var x=f.get(m);if(!x){var j={loading:0,preload:null};if(x=c.querySelector(qc(m)))j.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=Kr.get(m))&&yg(n,o);var z=x=c.createElement("link");bn(z),Us(z,"link",n),z._p=new Promise(function(oe,be){z.onload=oe,z.onerror=be}),z.addEventListener("load",function(){j.loading|=1}),z.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Yd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:j},f.set(m,x)}}}function fT(n,r){sa.X(n,r);var o=Il;if(o&&n){var c=Vn(o).hoistableScripts,f=Dl(n),m=c.get(f);m||(m=o.querySelector($c(f)),m||(n=k({src:n,async:!0},r),(r=Kr.get(f))&&vg(n,r),m=o.createElement("script"),bn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function mT(n,r){sa.M(n,r);var o=Il;if(o&&n){var c=Vn(o).hoistableScripts,f=Dl(n),m=c.get(f);m||(m=o.querySelector($c(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=Kr.get(f))&&vg(n,r),m=o.createElement("script"),bn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function jb(n,r,o,c){var f=(f=Pe.current)?Kd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Ml(o.href),o=Vn(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Ml(o.href);var m=Vn(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(qc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),Kr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Kr.set(n,o),m||gT(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Dl(o),o=Vn(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Ml(n){return'href="'+Yn(n)+'"'}function qc(n){return'link[rel="stylesheet"]['+n+"]"}function Eb(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function gT(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Us(r,"link",o),bn(r),n.head.appendChild(r))}function Dl(n){return'[src="'+Yn(n)+'"]'}function $c(n){return"script[async]"+n}function Tb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(c)return r.instance=c,bn(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),bn(c),Us(c,"style",f),Yd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Ml(o.href);var m=n.querySelector(qc(f));if(m)return r.state.loading|=4,r.instance=m,bn(m),m;c=Eb(o),(f=Kr.get(f))&&yg(c,f),m=(n.ownerDocument||n).createElement("link"),bn(m);var x=m;return x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),r.state.loading|=4,Yd(m,o.precedence,n),r.instance=m;case"script":return m=Dl(o.src),(f=n.querySelector($c(m)))?(r.instance=f,bn(f),f):(c=o,(f=Kr.get(m))&&(c=k({},o),vg(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),bn(f),Us(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Yd(c,o.precedence,n));return r.instance}function Yd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var j=c[x];if(j.dataset.precedence===r)m=j;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Qd=null;function Sb(n,r,o){if(Qd===null){var c=new Map,f=Qd=new Map;f.set(o,c)}else f=Qd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[js]||m[Nt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var j=c.get(x);j?j.push(m):c.set(x,[m])}}return c}function Cb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function pT(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Nb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function yT(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Ml(c.href),m=r.querySelector(qc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Xd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,bn(m);return}m=r.ownerDocument||r,c=Eb(c),(f=Kr.get(f))&&yg(c,f),m=m.createElement("link"),bn(m);var x=m;x._p=new Promise(function(j,z){x.onload=j,x.onerror=z}),Us(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Xd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var bg=0;function vT(n,r){return n.stylesheets&&n.count===0&&Zd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&bg===0&&(bg=62500*JE());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>bg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Jd=null;function Zd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Jd=new Map,r.forEach(bT,n),Jd=null,Xd.call(n))}function bT(n,r){if(!(r.state.loading&4)){var o=Jd.get(n);if(o)var c=o.get(null);else{o=new Map,Jd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Xd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Wc={$$typeof:ee,Provider:null,Consumer:null,_currentValue:He,_currentValue2:He,_threadCount:0};function wT(n,r,o,c,f,m,x,j,z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=un(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=un(0),this.hiddenUpdates=un(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Ab(n,r,o,c,f,m,x,j,z,oe,be,Ee){return n=new wT(n,r,o,x,z,oe,be,Ee,j),r=1,m===!0&&(r|=24),m=Sr(3,null,null,r),n.current=m,m.stateNode=n,r=Jf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},nm(m),n}function Rb(n){return n?(n=dl,n):dl}function Ib(n,r,o,c,f,m){f=Rb(f),c.context===null?c.context=f:c.pendingContext=f,c=Na(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Aa(n,c,r),o!==null&&(yr(o,n,r),jc(o,n,r))}function Mb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function wg(n,r){Mb(n,r),(n=n.alternate)&&Mb(n,r)}function Db(n){if(n.tag===13||n.tag===31){var r=bo(n,67108864);r!==null&&yr(r,n,67108864),wg(n,67108864)}}function Lb(n){if(n.tag===13||n.tag===31){var r=Ir();r=Ge(r);var o=bo(n,r);o!==null&&yr(o,n,r),wg(n,r)}}var eh=!0;function xT(n,r,o,c){var f=te.T;te.T=null;var m=Te.p;try{Te.p=2,xg(n,r,o,c)}finally{Te.p=m,te.T=f}}function _T(n,r,o,c){var f=te.T;te.T=null;var m=Te.p;try{Te.p=8,xg(n,r,o,c)}finally{Te.p=m,te.T=f}}function xg(n,r,o,c){if(eh){var f=_g(c);if(f===null)og(n,r,c,th,o),Pb(n,c);else if(jT(f,n,r,o,c))c.stopPropagation();else if(Pb(n,c),r&4&&-1<kT.indexOf(n)){for(;f!==null;){var m=os(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Fe(m.pendingLanes);if(x!==0){var j=m;for(j.pendingLanes|=2,j.entangledLanes|=2;x;){var z=1<<31-It(x);j.entanglements[1]|=z,x&=~z}Si(m),(_n&6)===0&&(Pd=mt()+500,Bc(0))}}break;case 31:case 13:j=bo(m,2),j!==null&&yr(j,m,2),Ud(),wg(m,2)}if(m=_g(c),m===null&&og(n,r,c,th,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else og(n,r,c,null,o)}}function _g(n){return n=Ls(n),kg(n)}var th=null;function kg(n){if(th=null,n=Gn(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=g(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return th=n,null}function Ob(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wt()){case Bt:return 2;case fs:return 8;case rn:case Jn:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var jg=!1,za=null,Fa=null,Ha=null,Gc=new Map,Kc=new Map,qa=[],kT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(n,r){switch(n){case"focusin":case"focusout":za=null;break;case"dragenter":case"dragleave":Fa=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":Gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(r.pointerId)}}function Yc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=os(r),r!==null&&Db(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function jT(n,r,o,c,f){switch(r){case"focusin":return za=Yc(za,n,r,o,c,f),!0;case"dragenter":return Fa=Yc(Fa,n,r,o,c,f),!0;case"mouseover":return Ha=Yc(Ha,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Gc.set(m,Yc(Gc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Kc.set(m,Yc(Kc.get(m)||null,n,r,o,c,f)),!0}return!1}function Vb(n){var r=Gn(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,$t(n.priority,function(){Lb(o)});return}}else if(r===31){if(r=g(o),r!==null){n.blockedOn=r,$t(n.priority,function(){Lb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=_g(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);$s=c,o.target.dispatchEvent(c),$s=null}else return r=os(o),r!==null&&Db(r),n.blockedOn=o,!1;r.shift()}return!0}function Ub(n,r,o){nh(n)&&o.delete(r)}function ET(){jg=!1,za!==null&&nh(za)&&(za=null),Fa!==null&&nh(Fa)&&(Fa=null),Ha!==null&&nh(Ha)&&(Ha=null),Gc.forEach(Ub),Kc.forEach(Ub)}function sh(n,r){n.blockedOn===r&&(n.blockedOn=null,jg||(jg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,ET)))}var rh=null;function Bb(n){rh!==n&&(rh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){rh===n&&(rh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kg(c||o)===null)continue;break}var m=os(o);m!==null&&(n.splice(r,3),r-=3,_m(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Ll(n){function r(z){return sh(z,n)}za!==null&&sh(za,n),Fa!==null&&sh(Fa,n),Ha!==null&&sh(Ha,n),Gc.forEach(r),Kc.forEach(r);for(var o=0;o<qa.length;o++){var c=qa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<qa.length&&(o=qa[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&qa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[Ct]||null;if(typeof m=="function")x||Bb(o);else if(x){var j=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[Ct]||null)j=x.formAction;else if(kg(f)!==null)continue}else j=x.action;typeof j=="function"?o[c+1]=j:(o.splice(c,3),c-=3),Bb(o)}}}function zb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Eg(n){this._internalRoot=n}ih.prototype.render=Eg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Ir();Ib(o,c,n,r,null,null)},ih.prototype.unmount=Eg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Ib(n.current,2,null,n,null,null),Ud(),r[vn]=null}};function ih(n){this._internalRoot=n}ih.prototype.unstable_scheduleHydration=function(n){if(n){var r=et();n={blockedOn:null,target:n,priority:r};for(var o=0;o<qa.length&&r!==0&&r<qa[o].priority;o++);qa.splice(o,0,n),o===0&&Vb(n)}};var Fb=e.version;if(Fb!=="19.2.4")throw Error(i(527,Fb,"19.2.4"));Te.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var TT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{cn=ah.inject(TT),Gt=ah}catch{}}return Xc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Yv,m=Qv,x=Xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Ab(n,1,!1,null,null,o,c,null,f,m,x,zb),n[vn]=r.current,ag(n),new Eg(r)},Xc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Yv,x=Qv,j=Xv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Ab(n,1,!0,r,o??null,c,f,z,m,x,j,zb),r.context=Rb(null),o=r.current,c=Ir(),c=Ge(c),f=Na(c),f.callback=null,Aa(o,f,c),o=c,r.current.lanes=o,dn(r,o),Si(r),n[vn]=r.current,ag(n),new ih(r)},Xc.version="19.2.4",Xc}var Jb;function OT(){if(Jb)return Cg.exports;Jb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cg.exports=LT(),Cg.exports}var PT=OT();const VT="modulepreload",UT=function(s){return"/login/"+s},Zb={},Js=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=y(t.map(p=>{if(p=UT(p),p in Zb)return;Zb[p]=!0;const b=p.endsWith(".css"),k=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${k}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":VT,b||(T.as="script"),T.crossOrigin="",T.href=p,g&&T.setAttribute("nonce",g),document.head.appendChild(T),b)return new Promise((R,q)=>{T.addEventListener("load",R),T.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&u(g.reason);return e().catch(u)})};var e2="popstate";function BT(s={}){function e(i,l){let{pathname:u,search:d,hash:g}=i.location;return pp("",{pathname:u,search:d,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:bu(l)}return FT(e,t,null,s)}function Wn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Zr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zT(){return Math.random().toString(36).substring(2,10)}function t2(s,e){return{usr:s.state,key:s.key,idx:e}}function pp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?sc(e):e,state:t,key:e&&e.key||i||zT()}}function bu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function sc(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function FT(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,g="POP",y=null,p=b();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function b(){return(d.state||{idx:null}).idx}function k(){g="POP";let U=b(),K=U==null?null:U-p;p=U,y&&y({action:g,location:G.location,delta:K})}function T(U,K){g="PUSH";let Y=pp(G.location,U,K);p=b()+1;let ee=t2(Y,p),ye=G.createHref(Y);try{d.pushState(ee,"",ye)}catch(ke){if(ke instanceof DOMException&&ke.name==="DataCloneError")throw ke;l.location.assign(ye)}u&&y&&y({action:g,location:G.location,delta:1})}function R(U,K){g="REPLACE";let Y=pp(G.location,U,K);p=b();let ee=t2(Y,p),ye=G.createHref(Y);d.replaceState(ee,"",ye),u&&y&&y({action:g,location:G.location,delta:0})}function q(U){return HT(U)}let G={get action(){return g},get location(){return s(l,d)},listen(U){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(e2,k),y=U,()=>{l.removeEventListener(e2,k),y=null}},createHref(U){return e(l,U)},createURL:q,encodeLocation(U){let K=q(U);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:T,replace:R,go(U){return d.go(U)}};return G}function HT(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Wn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:bu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function px(s,e,t="/"){return qT(s,e,t,!1)}function qT(s,e,t,i){let l=typeof e=="string"?sc(e):e,u=fa(l.pathname||"/",t);if(u==null)return null;let d=yx(s);$T(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let p=nS(u);g=eS(d[y],p,i)}return g}function yx(s,e=[],t=[],i="",l=!1){let u=(d,g,y=l,p)=>{let b={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;Wn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let k=ca([i,b.relativePath]),T=t.concat(b);d.children&&d.children.length>0&&(Wn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),yx(d.children,e,T,k,y)),!(d.path==null&&!d.index)&&e.push({path:k,score:JT(k,d.index),routesMeta:T})};return s.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))u(d,g);else for(let y of vx(d.path))u(d,g,!0,y)}),e}function vx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=vx(i.join("/")),g=[];return g.push(...d.map(y=>y===""?u:[u,y].join("/"))),l&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function $T(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:ZT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var WT=/^:[\w-]+$/,GT=3,KT=2,YT=1,QT=10,XT=-2,n2=s=>s==="*";function JT(s,e){let t=s.split("/"),i=t.length;return t.some(n2)&&(i+=XT),e&&(i+=KT),t.filter(l=>!n2(l)).reduce((l,u)=>l+(WT.test(u)?GT:u===""?YT:QT),i)}function ZT(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function eS(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let g=0;g<i.length;++g){let y=i[g],p=g===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",k=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:p},b),T=y.route;if(!k&&p&&t&&!i[i.length-1].route.index&&(k=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:ca([u,k.pathname]),pathnameBase:aS(ca([u,k.pathnameBase])),route:T}),k.pathnameBase!=="/"&&(u=ca([u,k.pathnameBase]))}return d}function Mh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=tS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:i.reduce((p,{paramName:b,isOptional:k},T)=>{if(b==="*"){let q=g[T]||"";d=u.slice(0,u.length-q.length).replace(/(.)\/+$/,"$1")}const R=g[T];return k&&!R?p[b]=void 0:p[b]=(R||"").replace(/%2F/g,"/"),p},{}),pathname:u,pathnameBase:d,pattern:s}}function tS(s,e=!1,t=!0){Zr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(i.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function nS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function fa(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var sS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?sc(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=s2(t.substring(1),"/"):u=s2(t,e)):u=e,{pathname:u,search:oS(i),hash:lS(l)}}function s2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ig(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function iS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jp(s){let e=iS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Zp(s,e,t,i=!1){let l;typeof s=="string"?l=sc(s):(l={...s},Wn(!l.pathname||!l.pathname.includes("?"),Ig("?","pathname","search",l)),Wn(!l.pathname||!l.pathname.includes("#"),Ig("#","pathname","hash",l)),Wn(!l.search||!l.search.includes("#"),Ig("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,g;if(d==null)g=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),k-=1;l.pathname=T.join("/")}g=k>=0?e[k]:"/"}let y=rS(l,g),p=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(p||b)&&(y.pathname+="/"),y}var ca=s=>s.join("/").replace(/\/\/+/g,"/"),aS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),oS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,lS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,cS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function uS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function dS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var bx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function wx(s,e){let t=s;if(typeof t!="string"||!sS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(bx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),g=fa(d.pathname,e);d.origin===u.origin&&g!=null?t=g+d.search+d.hash:l=!0}catch{Zr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var xx=["POST","PUT","PATCH","DELETE"];new Set(xx);var hS=["GET",...xx];new Set(hS);var rc=w.createContext(null);rc.displayName="DataRouter";var nf=w.createContext(null);nf.displayName="DataRouterState";var fS=w.createContext(!1),_x=w.createContext({isTransitioning:!1});_x.displayName="ViewTransition";var mS=w.createContext(new Map);mS.displayName="Fetchers";var gS=w.createContext(null);gS.displayName="Await";var Lr=w.createContext(null);Lr.displayName="Navigation";var Iu=w.createContext(null);Iu.displayName="Location";var yi=w.createContext({outlet:null,matches:[],isDataRoute:!1});yi.displayName="Route";var ey=w.createContext(null);ey.displayName="RouteError";var kx="REACT_ROUTER_ERROR",pS="REDIRECT",yS="ROUTE_ERROR_RESPONSE";function vS(s){if(s.startsWith(`${kx}:${pS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function bS(s){if(s.startsWith(`${kx}:${yS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new cS(e.status,e.statusText,e.data)}catch{}}function wS(s,{relative:e}={}){Wn(ic(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Lr),{hash:l,pathname:u,search:d}=Mu(s,{relative:e}),g=u;return t!=="/"&&(g=u==="/"?t:ca([t,u])),i.createHref({pathname:g,search:d,hash:l})}function ic(){return w.useContext(Iu)!=null}function Vi(){return Wn(ic(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Iu).location}var jx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ex(s){w.useContext(Lr).static||w.useLayoutEffect(s)}function Zs(){let{isDataRoute:s}=w.useContext(yi);return s?DS():xS()}function xS(){Wn(ic(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(rc),{basename:e,navigator:t}=w.useContext(Lr),{matches:i}=w.useContext(yi),{pathname:l}=Vi(),u=JSON.stringify(Jp(i)),d=w.useRef(!1);return Ex(()=>{d.current=!0}),w.useCallback((y,p={})=>{if(Zr(d.current,jx),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=Zp(y,JSON.parse(u),l,p.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ca([e,b.pathname])),(p.replace?t.replace:t.push)(b,p.state,p)},[e,t,u,l,s])}w.createContext(null);function _S(){let{matches:s}=w.useContext(yi),e=s[s.length-1];return e?e.params:{}}function Mu(s,{relative:e}={}){let{matches:t}=w.useContext(yi),{pathname:i}=Vi(),l=JSON.stringify(Jp(t));return w.useMemo(()=>Zp(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function kS(s,e){return Tx(s,e)}function Tx(s,e,t,i,l){Wn(ic(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Lr),{matches:d}=w.useContext(yi),g=d[d.length-1],y=g?g.params:{},p=g?g.pathname:"/",b=g?g.pathnameBase:"/",k=g&&g.route;{let Y=k&&k.path||"";Cx(p,!k||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let T=Vi(),R;if(e){let Y=typeof e=="string"?sc(e):e;Wn(b==="/"||Y.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),R=Y}else R=T;let q=R.pathname||"/",G=q;if(b!=="/"){let Y=b.replace(/^\//,"").split("/");G="/"+q.replace(/^\//,"").split("/").slice(Y.length).join("/")}let U=px(s,{pathname:G});Zr(k||U!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Zr(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=CS(U&&U.map(Y=>Object.assign({},Y,{params:Object.assign({},y,Y.params),pathname:ca([b,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?b:ca([b,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&K?w.createElement(Iu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},K):K}function jS(){let s=MS(),e=uS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var ES=w.createElement(jS,null),Sx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=bS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(yi.Provider,{value:this.props.routeContext},w.createElement(ey.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(TS,{error:s},e):e}};Sx.contextType=fS;var Mg=new WeakMap;function TS({children:s,error:e}){let{basename:t}=w.useContext(Lr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=vS(e.digest);if(i){let l=Mg.get(e);if(l)throw l;let u=wx(i.location,t);if(bx&&!Mg.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Mg.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function SS({routeContext:s,match:e,children:t}){let i=w.useContext(rc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(yi.Provider,{value:s},t)}function CS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);Wn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let g=!1,y=-1;if(t)for(let b=0;b<u.length;b++){let k=u[b];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(y=b),k.route.id){let{loaderData:T,errors:R}=t,q=k.route.loader&&!T.hasOwnProperty(k.route.id)&&(!R||R[k.route.id]===void 0);if(k.route.lazy||q){g=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}let p=t&&i?(b,k)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:dS(t.matches),errorInfo:k})}:void 0;return u.reduceRight((b,k,T)=>{let R,q=!1,G=null,U=null;t&&(R=d&&k.route.id?d[k.route.id]:void 0,G=k.route.errorElement||ES,g&&(y<0&&T===0?(Cx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,U=null):y===T&&(q=!0,U=k.route.hydrateFallbackElement||null)));let K=e.concat(u.slice(0,T+1)),Y=()=>{let ee;return R?ee=G:q?ee=U:k.route.Component?ee=w.createElement(k.route.Component,null):k.route.element?ee=k.route.element:ee=b,w.createElement(SS,{match:k,routeContext:{outlet:b,matches:K,isDataRoute:t!=null},children:ee})};return t&&(k.route.ErrorBoundary||k.route.errorElement||T===0)?w.createElement(Sx,{location:t.location,revalidation:t.revalidation,component:G,error:R,children:Y(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:p}):Y()},null)}function ty(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function NS(s){let e=w.useContext(rc);return Wn(e,ty(s)),e}function AS(s){let e=w.useContext(nf);return Wn(e,ty(s)),e}function RS(s){let e=w.useContext(yi);return Wn(e,ty(s)),e}function ny(s){let e=RS(s),t=e.matches[e.matches.length-1];return Wn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function IS(){return ny("useRouteId")}function MS(){let s=w.useContext(ey),e=AS("useRouteError"),t=ny("useRouteError");return s!==void 0?s:e.errors?.[t]}function DS(){let{router:s}=NS("useNavigate"),e=ny("useNavigate"),t=w.useRef(!1);return Ex(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Zr(t.current,jx),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var r2={};function Cx(s,e,t){!e&&!r2[s]&&(r2[s]=!0,Zr(!1,t))}w.memo(LS);function LS({routes:s,future:e,state:t,onError:i}){return Tx(s,void 0,t,i,e)}function Nx({to:s,replace:e,state:t,relative:i}){Wn(ic(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Lr);Zr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(yi),{pathname:d}=Vi(),g=Zs(),y=Zp(s,Jp(u),d,i==="path"),p=JSON.stringify(y);return w.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:i})},[g,p,i,e,t]),null}function In(s){Wn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function OS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Wn(!ic(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:g,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[g,l,u,d]);typeof t=="string"&&(t=sc(t));let{pathname:p="/",search:b="",hash:k="",state:T=null,key:R="default"}=t,q=w.useMemo(()=>{let G=fa(p,g);return G==null?null:{location:{pathname:G,search:b,hash:k,state:T,key:R},navigationType:i}},[g,p,b,k,T,R,i]);return Zr(q!=null,`<Router basename="${g}"> is not able to match the URL "${p}${b}${k}" because it does not start with the basename, so the <Router> won't render anything.`),q==null?null:w.createElement(Lr.Provider,{value:y},w.createElement(Iu.Provider,{children:e,value:q}))}function PS({children:s,location:e}){return kS(yp(s),e)}function yp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,yp(i.props.children,u));return}Wn(i.type===In,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Wn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=yp(i.props.children,u)),t.push(d)}),t}var xh="get",_h="application/x-www-form-urlencoded";function sf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function VS(s){return sf(s)&&s.tagName.toLowerCase()==="button"}function US(s){return sf(s)&&s.tagName.toLowerCase()==="form"}function BS(s){return sf(s)&&s.tagName.toLowerCase()==="input"}function zS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function FS(s,e){return s.button===0&&(!e||e==="_self")&&!zS(s)}function vp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function HS(s,e){let t=vp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var oh=null;function qS(){if(oh===null)try{new FormData(document.createElement("form"),0),oh=!1}catch{oh=!0}return oh}var $S=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(s){return s!=null&&!$S.has(s)?(Zr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_h}"`),null):s}function WS(s,e){let t,i,l,u,d;if(US(s)){let g=s.getAttribute("action");i=g?fa(g,e):null,t=s.getAttribute("method")||xh,l=Dg(s.getAttribute("enctype"))||_h,u=new FormData(s)}else if(VS(s)||BS(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||g.getAttribute("action");if(i=y?fa(y,e):null,t=s.getAttribute("formmethod")||g.getAttribute("method")||xh,l=Dg(s.getAttribute("formenctype"))||Dg(g.getAttribute("enctype"))||_h,u=new FormData(g,s),!qS()){let{name:p,type:b,value:k}=s;if(b==="image"){let T=p?`${p}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else p&&u.append(p,k)}}else{if(sf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xh,i=null,l=_h,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function GS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&fa(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function KS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function QS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await KS(u,t);return d.links?d.links():[]}return[]}));return eC(i.flat(1).filter(YS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function i2(s,e,t,i,l,u){let d=(y,p)=>t[p]?y.route.id!==t[p].route.id:!0,g=(y,p)=>t[p].pathname!==y.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==y.params["*"];return u==="assets"?e.filter((y,p)=>d(y,p)||g(y,p)):u==="data"?e.filter((y,p)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,p)||g(y,p))return!0;if(y.route.shouldRevalidate){let k=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function XS(s,e,{includeHydrateFallback:t}={}){return JS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function JS(s){return[...new Set(s)]}function ZS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function eC(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(ZS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Ax(){let s=w.useContext(rc);return sy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function tC(){let s=w.useContext(nf);return sy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ry=w.createContext(void 0);ry.displayName="FrameworkContext";function Rx(){let s=w.useContext(ry);return sy(s,"You must render this element inside a <HydratedRouter> element"),s}function nC(s,e){let t=w.useContext(ry),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:g,onBlur:y,onMouseEnter:p,onMouseLeave:b,onTouchStart:k}=e,T=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let G=K=>{K.forEach(Y=>{d(Y.isIntersecting)})},U=new IntersectionObserver(G,{threshold:.5});return T.current&&U.observe(T.current),()=>{U.disconnect()}}},[s]),w.useEffect(()=>{if(i){let G=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(G)}}},[i]);let R=()=>{l(!0)},q=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,T,{}]:[u,T,{onFocus:Jc(g,R),onBlur:Jc(y,q),onMouseEnter:Jc(p,R),onMouseLeave:Jc(b,q),onTouchStart:Jc(k,R)}]:[!1,T,{}]}function Jc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function sC({page:s,...e}){let{router:t}=Ax(),i=w.useMemo(()=>px(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(iC,{page:s,matches:i,...e}):null}function rC(s){let{manifest:e,routeModules:t}=Rx(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return QS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function iC({page:s,matches:e,...t}){let i=Vi(),{future:l,manifest:u,routeModules:d}=Rx(),{basename:g}=Ax(),{loaderData:y,matches:p}=tC(),b=w.useMemo(()=>i2(s,e,p,u,i,"data"),[s,e,p,u,i]),k=w.useMemo(()=>i2(s,e,p,u,i,"assets"),[s,e,p,u,i]),T=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let G=new Set,U=!1;if(e.forEach(Y=>{let ee=u.routes[Y.route.id];!ee||!ee.hasLoader||(!b.some(ye=>ye.route.id===Y.route.id)&&Y.route.id in y&&d[Y.route.id]?.shouldRevalidate||ee.hasClientLoader?U=!0:G.add(Y.route.id))}),G.size===0)return[];let K=GS(s,g,l.unstable_trailingSlashAwareDataRequests,"data");return U&&G.size>0&&K.searchParams.set("_routes",e.filter(Y=>G.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[K.pathname+K.search]},[g,l.unstable_trailingSlashAwareDataRequests,y,i,u,b,e,s,d]),R=w.useMemo(()=>XS(k,u),[k,u]),q=rC(k);return w.createElement(w.Fragment,null,T.map(G=>w.createElement("link",{key:G,rel:"prefetch",as:"fetch",href:G,...t})),R.map(G=>w.createElement("link",{key:G,rel:"modulepreload",href:G,...t})),q.map(({key:G,link:U})=>w.createElement("link",{key:G,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function aC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var oC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oC&&(window.__reactRouterVersion="7.13.0")}catch{}function lC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=BT({window:i,v5Compat:!0}));let u=l.current,[d,g]=w.useState({action:u.action,location:u.location}),y=w.useCallback(p=>{t===!1?g(p):w.startTransition(()=>g(p))},[t]);return w.useLayoutEffect(()=>u.listen(y),[u,y]),w.createElement(OS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Ix=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mx=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:g,target:y,to:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T,...R},q){let{basename:G,unstable_useTransitions:U}=w.useContext(Lr),K=typeof p=="string"&&Ix.test(p),Y=wx(p,G);p=Y.to;let ee=wS(p,{relative:l}),[ye,ke,ve]=nC(i,R),I=hC(p,{replace:d,state:g,target:y,preventScrollReset:b,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:T,unstable_useTransitions:U});function E(B){e&&e(B),B.defaultPrevented||I(B)}let O=w.createElement("a",{...R,...ve,href:Y.absoluteURL||ee,onClick:Y.isExternal||u?e:E,ref:aC(q,ke),target:y,"data-discover":!K&&t==="render"?"true":void 0});return ye&&!K?w.createElement(w.Fragment,null,O,w.createElement(sC,{page:ee})):O});Mx.displayName="Link";var cC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:g,children:y,...p},b){let k=Mu(d,{relative:p.relative}),T=Vi(),R=w.useContext(nf),{navigator:q,basename:G}=w.useContext(Lr),U=R!=null&&yC(k)&&g===!0,K=q.encodeLocation?q.encodeLocation(k).pathname:k.pathname,Y=T.pathname,ee=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),ee=ee?ee.toLowerCase():null,K=K.toLowerCase()),ee&&G&&(ee=fa(ee,G)||ee);const ye=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let ke=Y===K||!l&&Y.startsWith(K)&&Y.charAt(ye)==="/",ve=ee!=null&&(ee===K||!l&&ee.startsWith(K)&&ee.charAt(K.length)==="/"),I={isActive:ke,isPending:ve,isTransitioning:U},E=ke?e:void 0,O;typeof i=="function"?O=i(I):O=[i,ke?"active":null,ve?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let B=typeof u=="function"?u(I):u;return w.createElement(Mx,{...p,"aria-current":E,className:O,ref:b,style:B,to:d,viewTransition:g},typeof y=="function"?y(I):y)});cC.displayName="NavLink";var uC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=xh,action:g,onSubmit:y,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T,...R},q)=>{let{unstable_useTransitions:G}=w.useContext(Lr),U=gC(),K=pC(g,{relative:p}),Y=d.toLowerCase()==="get"?"get":"post",ee=typeof g=="string"&&Ix.test(g),ye=ke=>{if(y&&y(ke),ke.defaultPrevented)return;ke.preventDefault();let ve=ke.nativeEvent.submitter,I=ve?.getAttribute("formmethod")||d,E=()=>U(ve||ke.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:l,state:u,relative:p,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:T});G&&t!==!1?w.startTransition(()=>E()):E()};return w.createElement("form",{ref:q,method:Y,action:K,onSubmit:i?y:ye,...R,"data-discover":!ee&&s==="render"?"true":void 0})});uC.displayName="Form";function dC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Dx(s){let e=w.useContext(rc);return Wn(e,dC(s)),e}function hC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:y}={}){let p=Zs(),b=Vi(),k=Mu(s,{relative:u});return w.useCallback(T=>{if(FS(T,e)){T.preventDefault();let R=t!==void 0?t:bu(b)===bu(k),q=()=>p(s,{replace:R,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g});y?w.startTransition(()=>q()):q()}},[b,p,k,t,i,e,s,l,u,d,g,y])}function IO(s){Zr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(vp(s)),t=w.useRef(!1),i=Vi(),l=w.useMemo(()=>HS(i.search,t.current?null:e.current),[i.search]),u=Zs(),d=w.useCallback((g,y)=>{const p=vp(typeof g=="function"?g(new URLSearchParams(l)):g);t.current=!0,u("?"+p,y)},[u,l]);return[l,d]}var fC=0,mC=()=>`__${String(++fC)}__`;function gC(){let{router:s}=Dx("useSubmit"),{basename:e}=w.useContext(Lr),t=IS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:g,method:y,encType:p,formData:b,body:k}=WS(u,e);if(d.navigate===!1){let T=d.fetcherKey||mC();await i(T,t,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,flushSync:d.flushSync})}else await l(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:k,formMethod:d.method||y,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function pC(s,{relative:e}={}){let{basename:t}=w.useContext(Lr),i=w.useContext(yi);Wn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Mu(s||".",{relative:e})},d=Vi();if(s==null){u.search=d.search;let g=new URLSearchParams(u.search),y=g.getAll("index");if(y.some(b=>b==="")){g.delete("index"),y.filter(k=>k).forEach(k=>g.append("index",k));let b=g.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ca([t,u.pathname])),bu(u)}function yC(s,{relative:e}={}){let t=w.useContext(_x);Wn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Dx("useViewTransitionState"),l=Mu(s,{relative:e});if(!t.isTransitioning)return!1;let u=fa(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=fa(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Mh(l.pathname,d)!=null||Mh(l.pathname,u)!=null}const vC=()=>{};var a2={};const Lx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},bC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],g=s[t++],y=((l&7)<<18|(u&63)<<12|(d&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Ox={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,g=d?s[l+1]:0,y=l+2<s.length,p=y?s[l+2]:0,b=u>>2,k=(u&3)<<4|g>>4;let T=(g&15)<<2|p>>6,R=p&63;y||(R=64,d||(T=64)),i.push(t[b],t[k],t[T],t[R])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Lx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):bC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],g=l<s.length?t[s.charAt(l)]:0;++l;const p=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||g==null||p==null||k==null)throw new wC;const T=u<<2|g>>4;if(i.push(T),p!==64){const R=g<<4&240|p>>2;if(i.push(R),k!==64){const q=p<<6&192|k;i.push(q)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class wC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xC=function(s){const e=Lx(s);return Ox.encodeByteArray(e,!0)},Dh=function(s){return xC(s).replace(/\./g,"")},Px=function(s){try{return Ox.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _C(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kC=()=>_C().__FIREBASE_DEFAULTS__,jC=()=>{if(typeof process>"u"||typeof a2>"u")return;const s=a2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},EC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Px(s[1]);return e&&JSON.parse(e)},rf=()=>{try{return vC()||kC()||jC()||EC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Vx=s=>rf()?.emulatorHosts?.[s],Ux=s=>{const e=Vx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Bx=()=>rf()?.config,zx=s=>rf()?.[`_${s}`];class TC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function uo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iy(s){return(await fetch(s,{credentials:"include"})).ok}function Fx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const du={};function SC(){const s={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?s.emulator.push(e):s.prod.push(e);return s}function CC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let o2=!1;function ay(s,e){if(typeof window>"u"||typeof document>"u"||!uo(window.location.host)||du[s]===e||du[s]||o2)return;du[s]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=SC().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function g(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function y(T,R){T.setAttribute("width","24"),T.setAttribute("id",R),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{o2=!0,d()},T}function b(T,R){T.setAttribute("id",R),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function k(){const T=CC(i),R=t("text"),q=document.getElementById(R)||document.createElement("span"),G=t("learnmore"),U=document.getElementById(G)||document.createElement("a"),K=t("preprendIcon"),Y=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const ee=T.element;g(ee),b(U,G);const ye=p();y(Y,K),ee.append(Y,q,U,ye),document.body.appendChild(ee)}u?(q.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,q.innerText="Preview backend running in this workspace."),q.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function AC(){const s=rf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function RC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function MC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DC(){const s=Xs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function LC(){return!AC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Hx(){try{return typeof indexedDB=="object"}catch{return!1}}function qx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function OC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const PC="FirebaseError";class vi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=PC,Object.setPrototypeOf(this,vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qo.prototype.create)}}class Qo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?VC(u,i):"Error",g=`${this.serviceName}: ${d} (${l}).`;return new vi(l,g,i)}}function VC(s,e){return s.replace(UC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const UC=/\{\$([^}]+)}/g;function BC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ma(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(l2(u)&&l2(d)){if(!ma(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function l2(s){return s!==null&&typeof s=="object"}function Du(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function iu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function au(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function zC(s,e){const t=new FC(s,e);return t.subscribe.bind(t)}class FC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Lg),l.error===void 0&&(l.error=Lg),l.complete===void 0&&(l.complete=Lg);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Lg(){}function jn(s){return s&&s._delegate?s._delegate:s}class ei{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Do="[DEFAULT]";class qC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new TC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WC(e))try{this.getOrInitializeService({instanceIdentifier:Do})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Do){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Do){return this.instances.has(e)}getOptions(e=Do){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(u);i===g&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:$C(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Do){return this.component?this.component.multipleInstances?e:Do:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $C(s){return s===Do?void 0:s}function WC(s){return s.instantiationMode==="EAGER"}class GC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var en;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(en||(en={}));const KC={debug:en.DEBUG,verbose:en.VERBOSE,info:en.INFO,warn:en.WARN,error:en.ERROR,silent:en.SILENT},YC=en.INFO,QC={[en.DEBUG]:"log",[en.VERBOSE]:"log",[en.INFO]:"info",[en.WARN]:"warn",[en.ERROR]:"error"},XC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=QC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oy{constructor(e){this.name=e,this._logLevel=YC,this._logHandler=XC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in en))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,en.DEBUG,...e),this._logHandler(this,en.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,en.VERBOSE,...e),this._logHandler(this,en.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,en.INFO,...e),this._logHandler(this,en.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,en.WARN,...e),this._logHandler(this,en.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,en.ERROR,...e),this._logHandler(this,en.ERROR,...e)}}const JC=(s,e)=>e.some(t=>s instanceof t);let c2,u2;function ZC(){return c2||(c2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eN(){return u2||(u2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $x=new WeakMap,bp=new WeakMap,Wx=new WeakMap,Og=new WeakMap,ly=new WeakMap;function tN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ua(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&$x.set(t,s)}).catch(()=>{}),ly.set(e,s),e}function nN(s){if(bp.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});bp.set(s,e)}let wp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return bp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Wx.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ua(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function sN(s){wp=s(wp)}function rN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Pg(this),e,...t);return Wx.set(i,e.sort?e.sort():[e]),ua(i)}:eN().includes(s)?function(...e){return s.apply(Pg(this),e),ua($x.get(this))}:function(...e){return ua(s.apply(Pg(this),e))}}function iN(s){return typeof s=="function"?rN(s):(s instanceof IDBTransaction&&nN(s),JC(s,ZC())?new Proxy(s,wp):s)}function ua(s){if(s instanceof IDBRequest)return tN(s);if(Og.has(s))return Og.get(s);const e=iN(s);return e!==s&&(Og.set(s,e),ly.set(e,s)),e}const Pg=s=>ly.get(s);function af(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),g=ua(d);return i&&d.addEventListener("upgradeneeded",y=>{i(ua(d.result),y.oldVersion,y.newVersion,ua(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{u&&y.addEventListener("close",()=>u()),l&&y.addEventListener("versionchange",p=>l(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}function Vg(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ua(t).then(()=>{})}const aN=["get","getKey","getAll","getAllKeys","count"],oN=["put","add","delete","clear"],Ug=new Map;function d2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=oN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||aN.includes(t)))return;const u=async function(d,...g){const y=this.transaction(d,l?"readwrite":"readonly");let p=y.store;return i&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),l&&y.done]))[0]};return Ug.set(e,u),u}sN(s=>({...s,get:(e,t,i)=>d2(e,t)||s.get(e,t,i),has:(e,t)=>!!d2(e,t)||s.has(e,t)}));class lN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function cN(s){return s.getComponent()?.type==="VERSION"}const xp="@firebase/app",h2="0.14.7";const ga=new oy("@firebase/app"),uN="@firebase/app-compat",dN="@firebase/analytics-compat",hN="@firebase/analytics",fN="@firebase/app-check-compat",mN="@firebase/app-check",gN="@firebase/auth",pN="@firebase/auth-compat",yN="@firebase/database",vN="@firebase/data-connect",bN="@firebase/database-compat",wN="@firebase/functions",xN="@firebase/functions-compat",_N="@firebase/installations",kN="@firebase/installations-compat",jN="@firebase/messaging",EN="@firebase/messaging-compat",TN="@firebase/performance",SN="@firebase/performance-compat",CN="@firebase/remote-config",NN="@firebase/remote-config-compat",AN="@firebase/storage",RN="@firebase/storage-compat",IN="@firebase/firestore",MN="@firebase/ai",DN="@firebase/firestore-compat",LN="firebase",ON="12.8.0";const _p="[DEFAULT]",PN={[xp]:"fire-core",[uN]:"fire-core-compat",[hN]:"fire-analytics",[dN]:"fire-analytics-compat",[mN]:"fire-app-check",[fN]:"fire-app-check-compat",[gN]:"fire-auth",[pN]:"fire-auth-compat",[yN]:"fire-rtdb",[vN]:"fire-data-connect",[bN]:"fire-rtdb-compat",[wN]:"fire-fn",[xN]:"fire-fn-compat",[_N]:"fire-iid",[kN]:"fire-iid-compat",[jN]:"fire-fcm",[EN]:"fire-fcm-compat",[TN]:"fire-perf",[SN]:"fire-perf-compat",[CN]:"fire-rc",[NN]:"fire-rc-compat",[AN]:"fire-gcs",[RN]:"fire-gcs-compat",[IN]:"fire-fst",[DN]:"fire-fst-compat",[MN]:"fire-vertex","fire-js":"fire-js",[LN]:"fire-js-all"};const Lh=new Map,VN=new Map,kp=new Map;function f2(s,e){try{s.container.addComponent(e)}catch(t){ga.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function mi(s){const e=s.name;if(kp.has(e))return ga.debug(`There were multiple attempts to register component ${e}.`),!1;kp.set(e,s);for(const t of Lh.values())f2(t,s);for(const t of VN.values())f2(t,s);return!0}function Xo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Mr(s){return s==null?!1:s.settings!==void 0}const UN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eo=new Qo("app","Firebase",UN);class BN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eo.create("app-deleted",{appName:this._name})}}const Jo=ON;function cy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:_p,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw eo.create("bad-app-name",{appName:String(l)});if(t||(t=Bx()),!t)throw eo.create("no-options");const u=Lh.get(l);if(u){if(ma(t,u.options)&&ma(i,u.config))return u;throw eo.create("duplicate-app",{appName:l})}const d=new GC(l);for(const y of kp.values())d.addComponent(y);const g=new BN(t,i,d);return Lh.set(l,g),g}function Lu(s=_p){const e=Lh.get(s);if(!e&&s===_p&&Bx())return cy();if(!e)throw eo.create("no-app",{appName:s});return e}function wr(s,e,t){let i=PN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ga.warn(d.join(" "));return}mi(new ei(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const zN="firebase-heartbeat-database",FN=1,wu="firebase-heartbeat-store";let Bg=null;function Gx(){return Bg||(Bg=af(zN,FN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(wu)}catch(t){console.warn(t)}}}}).catch(s=>{throw eo.create("idb-open",{originalErrorMessage:s.message})})),Bg}async function HN(s){try{const t=(await Gx()).transaction(wu),i=await t.objectStore(wu).get(Kx(s));return await t.done,i}catch(e){if(e instanceof vi)ga.warn(e.message);else{const t=eo.create("idb-get",{originalErrorMessage:e?.message});ga.warn(t.message)}}}async function m2(s,e){try{const i=(await Gx()).transaction(wu,"readwrite");await i.objectStore(wu).put(e,Kx(s)),await i.done}catch(t){if(t instanceof vi)ga.warn(t.message);else{const i=eo.create("idb-set",{originalErrorMessage:t?.message});ga.warn(i.message)}}}function Kx(s){return`${s.name}!${s.options.appId}`}const qN=1024,$N=30;class WN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new KN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=g2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>$N){const l=YN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ga.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=g2(),{heartbeatsToSend:t,unsentEntries:i}=GN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ga.warn(e),""}}}function g2(){return new Date().toISOString().substring(0,10)}function GN(s,e=qN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),p2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),p2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class KN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Hx()?qx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await HN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function p2(s){return Dh(JSON.stringify({version:2,heartbeats:s})).length}function YN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function QN(s){mi(new ei("platform-logger",e=>new lN(e),"PRIVATE")),mi(new ei("heartbeat",e=>new WN(e),"PRIVATE")),wr(xp,h2,s),wr(xp,h2,"esm2020"),wr("fire-js","")}QN("");function Yx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const XN=Yx,Qx=new Qo("auth","Firebase",Yx());const Oh=new oy("@firebase/auth");function JN(s,...e){Oh.logLevel<=en.WARN&&Oh.warn(`Auth (${Jo}): ${s}`,...e)}function kh(s,...e){Oh.logLevel<=en.ERROR&&Oh.error(`Auth (${Jo}): ${s}`,...e)}function gi(s,...e){throw uy(s,...e)}function Ri(s,...e){return uy(s,...e)}function Xx(s,e,t){const i={...XN(),[e]:t};return new Qo("auth","Firebase",i).create(e,{appName:s.name})}function da(s){return Xx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Qx.create(s,...e)}function jt(s,e,...t){if(!s)throw uy(e,...t)}function ia(s){const e="INTERNAL ASSERTION FAILED: "+s;throw kh(e),new Error(e)}function pa(s,e){s||ia(e)}function jp(){return typeof self<"u"&&self.location?.href||""}function ZN(){return y2()==="http:"||y2()==="https:"}function y2(){return typeof self<"u"&&self.location?.protocol||null}function eA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZN()||IC()||"connection"in navigator)?navigator.onLine:!0}function tA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,pa(t>e,"Short delay should be less than long delay!"),this.isMobile=NC()||MC()}get(){return eA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dy(s,e){pa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Jx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ia("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ia("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ia("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const sA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rA=new Ou(3e4,6e4);function ba(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function wa(s,e,t,i,l={}){return Zx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const g=Du({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:y,...u};return RC()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&uo(s.emulatorConfig.host)&&(p.credentials="include"),Jx.fetch()(await e_(s,s.config.apiHost,t,g),p)})}async function Zx(s,e,t){s._canInitEmulator=!1;const i={...nA,...e};try{const l=new aA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw lh(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const g=u.ok?d.errorMessage:d.error.message,[y,p]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw lh(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw lh(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw lh(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Xx(s,b,p);gi(s,b)}}catch(l){if(l instanceof vi)throw l;gi(s,"network-request-failed",{message:String(l)})}}async function Pu(s,e,t,i,l={}){const u=await wa(s,e,t,i,l);return"mfaPendingCredential"in u&&gi(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function e_(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?dy(s.config,l):`${s.config.apiScheme}://${l}`;return sA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function iA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ri(this.auth,"network-request-failed")),rA.get())})}}function lh(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ri(s,e,i);return l.customData._tokenResponse=t,l}function v2(s){return s!==void 0&&s.enterprise!==void 0}class oA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return iA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function lA(s,e){return wa(s,"GET","/v2/recaptchaConfig",ba(s,e))}async function cA(s,e){return wa(s,"POST","/v1/accounts:delete",e)}async function Ph(s,e){return wa(s,"POST","/v1/accounts:lookup",e)}function hu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uA(s,e=!1){const t=jn(s),i=await t.getIdToken(e),l=hy(i);jt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:hu(zg(l.auth_time)),issuedAtTime:hu(zg(l.iat)),expirationTime:hu(zg(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function zg(s){return Number(s)*1e3}function hy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return kh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Px(t);return l?JSON.parse(l):(kh("Failed to decode base64 JWT payload"),null)}catch(l){return kh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function b2(s){const e=hy(s);return jt(e,"internal-error"),jt(typeof e.exp<"u","internal-error"),jt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function xu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof vi&&dA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function dA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class hA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ep{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hu(this.lastLoginAt),this.creationTime=hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(s){const e=s.auth,t=await s.getIdToken(),i=await xu(s,Ph(e,{idToken:t}));jt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?t_(l.providerUserInfo):[],d=mA(s.providerData,u),g=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,p=g?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(s,b)}async function fA(s){const e=jn(s);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function t_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function gA(s,e){const t=await Zx(s,{},async()=>{const i=Du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await e_(s,l,"/v1/token",`key=${u}`),g=await s._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:i};return s.emulatorConfig&&uo(s.emulatorConfig.host)&&(y.credentials="include"),Jx.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pA(s,e){return wa(s,"POST","/v2/accounts:revokeToken",ba(s,e))}class Hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){jt(e.idToken,"internal-error"),jt(typeof e.idToken<"u","internal-error"),jt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):b2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){jt(e.length!==0,"internal-error");const t=b2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(jt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await gA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Hl;return i&&(jt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(jt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(jt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hl,this.toJSON())}_performRefresh(){return ia("not implemented")}}function Wa(s,e){jt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class di{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new hA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Ep(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await xu(this,this.stsTokenManager.getToken(this.auth,e));return jt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return uA(this,e)}reload(){return fA(this)}_assign(e){this!==e&&(jt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new di({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){jt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(da(this.auth));const e=await this.getIdToken();return await xu(this,cA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,p=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:k,emailVerified:T,isAnonymous:R,providerData:q,stsTokenManager:G}=t;jt(k&&G,e,"internal-error");const U=Hl.fromJSON(this.name,G);jt(typeof k=="string",e,"internal-error"),Wa(i,e.name),Wa(l,e.name),jt(typeof T=="boolean",e,"internal-error"),jt(typeof R=="boolean",e,"internal-error"),Wa(u,e.name),Wa(d,e.name),Wa(g,e.name),Wa(y,e.name),Wa(p,e.name),Wa(b,e.name);const K=new di({uid:k,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:u,tenantId:g,stsTokenManager:U,createdAt:p,lastLoginAt:b});return q&&Array.isArray(q)&&(K.providerData=q.map(Y=>({...Y}))),y&&(K._redirectEventId=y),K}static async _fromIdTokenResponse(e,t,i=!1){const l=new Hl;l.updateFromServerResponse(t);const u=new di({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Vh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];jt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?t_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,g=new Hl;g.updateFromIdToken(i);const y=new di({uid:l.localId,auth:e,stsTokenManager:g,isAnonymous:d}),p={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(y,p),y}}const w2=new Map;function aa(s){pa(s instanceof Function,"Expected a class definition");let e=w2.get(s);return e?(pa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,w2.set(s,e),e)}class n_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}n_.type="NONE";const x2=n_;function jh(s,e,t){return`firebase:${s}:${e}:${t}`}class ql{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=jh(this.userKey,l.apiKey,u),this.fullPersistenceKey=jh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?di._fromGetAccountInfoResponse(this.auth,t,e):null}return di._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ql(aa(x2),e,i);const l=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=l[0]||aa(x2);const d=jh(i,e.config.apiKey,e.name);let g=null;for(const p of t)try{const b=await p._get(d);if(b){let k;if(typeof b=="string"){const T=await Ph(e,{idToken:b}).catch(()=>{});if(!T)break;k=await di._fromGetAccountInfoResponse(e,T,b)}else k=di._fromJSON(e,b);p!==u&&(g=k),u=p;break}}catch{}const y=l.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!y.length?new ql(u,e,i):(u=y[0],g&&await u._set(d,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(d)}catch{}})),new ql(u,e,i))}}function _2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(a_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(s_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(l_(e))return"Blackberry";if(c_(e))return"Webos";if(r_(e))return"Safari";if((e.includes("chrome/")||i_(e))&&!e.includes("edge/"))return"Chrome";if(o_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function s_(s=Xs()){return/firefox\//i.test(s)}function r_(s=Xs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function i_(s=Xs()){return/crios\//i.test(s)}function a_(s=Xs()){return/iemobile/i.test(s)}function o_(s=Xs()){return/android/i.test(s)}function l_(s=Xs()){return/blackberry/i.test(s)}function c_(s=Xs()){return/webos/i.test(s)}function fy(s=Xs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function yA(s=Xs()){return fy(s)&&!!window.navigator?.standalone}function vA(){return DC()&&document.documentMode===10}function u_(s=Xs()){return fy(s)||o_(s)||c_(s)||l_(s)||/windows phone/i.test(s)||a_(s)}function d_(s,e=[]){let t;switch(s){case"Browser":t=_2(Xs());break;case"Worker":t=`${_2(Xs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jo}/${i}`}class bA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,g)=>{try{const y=e(u);d(y)}catch(y){g(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function wA(s,e={}){return wa(s,"GET","/v2/passwordPolicy",ba(s,e))}const xA=6;class _A{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class kA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new k2(this),this.idTokenSubscription=new k2(this),this.beforeStateQueue=new bA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=aa(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ql.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await di._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&g?.user&&(i=g.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return jt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=tA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(da(this));const t=e?jn(e):null;return t&&jt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&jt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(aa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wA(this),t=new _A(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await pA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&aa(e)||this._popupRedirectResolver;jt(t,this,"argument-error"),this.redirectPersistenceManager=await ql.create(this,[aa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(jt(g,this,"internal-error"),g.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return jt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=d_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&JN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ho(s){return jn(s)}class k2{constructor(e){this.auth=e,this.observer=null,this.addObserver=zC(t=>this.observer=t)}get next(){return jt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jA(s){of=s}function h_(s){return of.loadJS(s)}function EA(){return of.recaptchaEnterpriseScript}function TA(){return of.gapiScript}function SA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class CA{constructor(){this.enterprise=new NA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class NA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const AA="recaptcha-enterprise",f_="NO_RECAPTCHA";class RA{constructor(e){this.type=AA,this.auth=ho(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,g)=>{lA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const p=new oA(y);return u.tenantId==null?u._agentRecaptchaConfig=p:u._tenantRecaptchaConfigs[u.tenantId]=p,d(p.siteKey)}}).catch(y=>{g(y)})})}function l(u,d,g){const y=window.grecaptcha;v2(y)?y.enterprise.ready(()=>{y.enterprise.execute(u,{action:e}).then(p=>{d(p)}).catch(()=>{d(f_)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new CA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(g=>{if(!t&&v2(window.grecaptcha))l(g,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=EA();y.length!==0&&(y+=g),h_(y).then(()=>{l(g,u,d)}).catch(p=>{d(p)})}}).catch(g=>{d(g)})})}}async function j2(s,e,t,i=!1,l=!1){const u=new RA(s);let d;if(l)d=f_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,p=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return i?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function Uh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await j2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await j2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function IA(s,e){const t=Xo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ma(u,e??{}))return l;gi(l,"already-initialized")}return t.initialize({options:e})}function MA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(aa);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function DA(s,e,t){const i=ho(s);jt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=m_(e),{host:d,port:g}=LA(e),y=g===null?"":`:${g}`,p={url:`${u}//${d}${y}/`},b=Object.freeze({host:d,port:g,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){jt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),jt(ma(p,i.config.emulator)&&ma(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,uo(d)?(iy(`${u}//${d}${y}`),ay("Auth",!0)):OA()}function m_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function LA(s){const e=m_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:E2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:E2(d)}}}function E2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function OA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class my{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ia("not implemented")}_getIdTokenResponse(e){return ia("not implemented")}_linkToIdToken(e,t){return ia("not implemented")}_getReauthenticationResolver(e){return ia("not implemented")}}async function PA(s,e){return wa(s,"POST","/v1/accounts:signUp",e)}async function VA(s,e){return Pu(s,"POST","/v1/accounts:signInWithPassword",ba(s,e))}async function g_(s,e){return wa(s,"POST","/v1/accounts:sendOobCode",ba(s,e))}async function UA(s,e){return g_(s,e)}async function BA(s,e){return g_(s,e)}async function zA(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",ba(s,e))}async function FA(s,e){return Pu(s,"POST","/v1/accounts:signInWithEmailLink",ba(s,e))}class _u extends my{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new _u(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new _u(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,t,"signInWithPassword",VA);case"emailLink":return zA(e,{email:this._email,oobCode:this._password});default:gi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,i,"signUpPassword",PA);case"emailLink":return FA(e,{idToken:t,email:this._email,oobCode:this._password});default:gi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function $l(s,e){return Pu(s,"POST","/v1/accounts:signInWithIdp",ba(s,e))}const HA="http://localhost";class Bo extends my{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Bo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Bo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return $l(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,$l(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$l(e,t)}buildRequest(){const e={requestUri:HA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Du(t)}return e}}function qA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $A(s){const e=iu(au(s)).link,t=e?iu(au(e)).deep_link_id:null,i=iu(au(s)).deep_link_id;return(i?iu(au(i)).link:null)||i||t||e||s}class gy{constructor(e){const t=iu(au(e)),i=t.apiKey??null,l=t.oobCode??null,u=qA(t.mode??null);jt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=$A(e);try{return new gy(t)}catch{return null}}}class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,t){return _u._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=gy.parseLink(t);return jt(i,"argument-error"),_u._fromEmailAndCode(e,i.code,i.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class p_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vu extends p_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ka extends Vu{constructor(){super("facebook.com")}static credential(e){return Bo._fromParams({providerId:Ka.PROVIDER_ID,signInMethod:Ka.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ka.credentialFromTaggedObject(e)}static credentialFromError(e){return Ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ka.credential(e.oauthAccessToken)}catch{return null}}}Ka.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ka.PROVIDER_ID="facebook.com";class Ya extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Bo._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ya.credential(t,i)}catch{return null}}}Ya.GOOGLE_SIGN_IN_METHOD="google.com";Ya.PROVIDER_ID="google.com";class Qa extends Vu{constructor(){super("github.com")}static credential(e){return Bo._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qa.credential(e.oauthAccessToken)}catch{return null}}}Qa.GITHUB_SIGN_IN_METHOD="github.com";Qa.PROVIDER_ID="github.com";class Xa extends Vu{constructor(){super("twitter.com")}static credential(e,t){return Bo._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xa.credential(t,i)}catch{return null}}}Xa.TWITTER_SIGN_IN_METHOD="twitter.com";Xa.PROVIDER_ID="twitter.com";async function WA(s,e){return Pu(s,"POST","/v1/accounts:signUp",ba(s,e))}class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await di._fromIdTokenResponse(e,i,l),d=T2(i);return new zo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=T2(i);return new zo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function T2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Bh extends vi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Bh(e,t,i,l)}}function y_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(s,u,e,i):u})}async function GA(s,e,t=!1){const i=await xu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return zo._forOperation(s,"link",i)}async function KA(s,e,t=!1){const{auth:i}=s;if(Mr(i.app))return Promise.reject(da(i));const l="reauthenticate";try{const u=await xu(s,y_(i,l,e,s),t);jt(u.idToken,i,"internal-error");const d=hy(u.idToken);jt(d,i,"internal-error");const{sub:g}=d;return jt(s.uid===g,i,"user-mismatch"),zo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&gi(i,"user-mismatch"),u}}async function v_(s,e,t=!1){if(Mr(s.app))return Promise.reject(da(s));const i="signIn",l=await y_(s,i,e),u=await zo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function YA(s,e){return v_(ho(s),e)}async function b_(s){const e=ho(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function QA(s,e,t){const i=ho(s);await Uh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",BA)}async function XA(s,e,t){if(Mr(s.app))return Promise.reject(da(s));const i=ho(s),d=await Uh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",WA).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&b_(s),y}),g=await zo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(g.user),g}function JA(s,e,t){return Mr(s.app)?Promise.reject(da(s)):YA(jn(s),ac.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&b_(s),i})}async function MO(s,e){const t=jn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await UA(t.auth,l);u!==s.email&&await s.reload()}function S2(s,e){return jn(s).setPersistence(e)}function ZA(s,e,t,i){return jn(s).onIdTokenChanged(e,t,i)}function e4(s,e,t){return jn(s).beforeAuthStateChanged(e,t)}function t4(s,e,t,i){return jn(s).onAuthStateChanged(e,t,i)}function n4(s){return jn(s).signOut()}const zh="__sak";class w_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const s4=1e3,r4=10;class x_ extends w_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=u_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,g,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);vA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,r4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},s4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}x_.type="LOCAL";const Tp=x_;class __ extends w_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}__.type="SESSION";const py=__;function i4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new lf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const g=Array.from(d).map(async p=>p(t.origin,u)),y=await i4(g);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function yy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class a4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((g,y)=>{const p=yy("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const T=k;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),g(T.data.response);break;default:clearTimeout(b),clearTimeout(u),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ii(){return window}function o4(s){Ii().location.href=s}function k_(){return typeof Ii().WorkerGlobalScope<"u"&&typeof Ii().importScripts=="function"}async function l4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function c4(){return navigator?.serviceWorker?.controller||null}function u4(){return k_()?self:null}const j_="firebaseLocalStorageDb",d4=1,Fh="firebaseLocalStorage",E_="fbase_key";class Uu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(s,e){return s.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function h4(){const s=indexedDB.deleteDatabase(j_);return new Uu(s).toPromise()}function Sp(){const s=indexedDB.open(j_,d4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Fh,{keyPath:E_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Fh)?e(i):(i.close(),await h4(),e(await Sp()))})})}async function C2(s,e,t){const i=cf(s,!0).put({[E_]:e,value:t});return new Uu(i).toPromise()}async function f4(s,e){const t=cf(s,!1).get(e),i=await new Uu(t).toPromise();return i===void 0?null:i.value}function N2(s,e){const t=cf(s,!0).delete(e);return new Uu(t).toPromise()}const m4=800,g4=3;class T_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>g4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return k_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(u4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await l4(),!this.activeServiceWorker)return;this.sender=new a4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||c4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await C2(e,zh,"1"),await N2(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>f4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>N2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=cf(l,!1).getAll();return new Uu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),m4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}T_.type="LOCAL";const p4=T_;new Ou(3e4,6e4);function y4(s,e){return e?aa(e):(jt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class vy extends my{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $l(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $l(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $l(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function v4(s){return v_(s.auth,new vy(s),s.bypassAuthState)}function b4(s){const{auth:e,user:t}=s;return jt(t,e,"internal-error"),KA(t,new vy(s),s.bypassAuthState)}async function w4(s){const{auth:e,user:t}=s;return jt(t,e,"internal-error"),GA(t,new vy(s),s.bypassAuthState)}class S_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:g}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return v4;case"linkViaPopup":case"linkViaRedirect":return w4;case"reauthViaPopup":case"reauthViaRedirect":return b4;default:gi(this.auth,"internal-error")}}resolve(e){pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const x4=new Ou(2e3,1e4);class Fl extends S_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Fl.currentPopupAction&&Fl.currentPopupAction.cancel(),Fl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return jt(e,this.auth,"internal-error"),e}async onExecution(){pa(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ri(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ri(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ri(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,x4.get())};e()}}Fl.currentPopupAction=null;const _4="pendingRedirect",Eh=new Map;class k4 extends S_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Eh.get(this.auth._key());if(!e){try{const i=await j4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Eh.set(this.auth._key(),e)}return this.bypassAuthState||Eh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j4(s,e){const t=S4(e),i=T4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function E4(s,e){Eh.set(s._key(),e)}function T4(s){return aa(s._redirectPersistence)}function S4(s){return jh(_4,s.config.apiKey,s.name)}async function C4(s,e,t=!1){if(Mr(s.app))return Promise.reject(da(s));const i=ho(s),l=y4(i,e),d=await new k4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const N4=600*1e3;class A4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!C_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ri(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N4&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function C_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function R4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return C_(s);default:return!1}}async function I4(s,e={}){return wa(s,"GET","/v1/projects",e)}const M4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,D4=/^https?/;async function L4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await I4(s);for(const t of e)try{if(O4(t))return}catch{}gi(s,"unauthorized-domain")}function O4(s){const e=jp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!D4.test(t))return!1;if(M4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const P4=new Ou(3e4,6e4);function R2(){const s=Ii().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function V4(s){return new Promise((e,t)=>{function i(){R2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{R2(),t(Ri(s,"network-request-failed"))},timeout:P4.get()})}if(Ii().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ii().gapi?.load)i();else{const l=SA("iframefcb");return Ii()[l]=()=>{gapi.load?i():t(Ri(s,"network-request-failed"))},h_(`${TA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function U4(s){return Th=Th||V4(s),Th}const B4=new Ou(5e3,15e3),z4="__/auth/iframe",F4="emulator/auth/iframe",H4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $4(s){const e=s.config;jt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dy(e,F4):`https://${s.config.authDomain}/${z4}`,i={apiKey:e.apiKey,appName:s.name,v:Jo},l=q4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Du(i).slice(1)}`}async function W4(s){const e=await U4(s),t=Ii().gapi;return jt(t,s,"internal-error"),e.open({where:document.body,url:$4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:H4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ri(s,"network-request-failed"),g=Ii().setTimeout(()=>{u(d)},B4.get());function y(){Ii().clearTimeout(g),l(i)}i.ping(y).then(y,()=>{u(d)})}))}const G4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},K4=500,Y4=600,Q4="_blank",X4="http://localhost";class I2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function J4(s,e,t,i=K4,l=Y4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let g="";const y={...G4,width:i.toString(),height:l.toString(),top:u,left:d},p=Xs().toLowerCase();t&&(g=i_(p)?Q4:t),s_(p)&&(e=e||X4,y.scrollbars="yes");const b=Object.entries(y).reduce((T,[R,q])=>`${T}${R}=${q},`,"");if(yA(p)&&g!=="_self")return Z4(e||"",g),new I2(null);const k=window.open(e||"",g,b);jt(k,s,"popup-blocked");try{k.focus()}catch{}return new I2(k)}function Z4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const eR="__/auth/handler",tR="emulator/auth/handler",nR=encodeURIComponent("fac");async function M2(s,e,t,i,l,u){jt(s.config.authDomain,s,"auth-domain-config-required"),jt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Jo,eventId:l};if(e instanceof p_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",BC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,k]of Object.entries({}))d[b]=k}if(e instanceof Vu){const b=e.getScopes().filter(k=>k!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const y=await s._getAppCheckToken(),p=y?`#${nR}=${encodeURIComponent(y)}`:"";return`${sR(s)}?${Du(g).slice(1)}${p}`}function sR({config:s}){return s.emulator?dy(s,tR):`https://${s.authDomain}/${eR}`}const Fg="webStorageSupport";class rR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=py,this._completeRedirectFn=C4,this._overrideRedirectResult=E4}async _openPopup(e,t,i,l){pa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await M2(e,t,i,jp(),l);return J4(e,u,yy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await M2(e,t,i,jp(),l);return o4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(pa(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await W4(e),i=new A4(e);return t.register("authEvent",l=>(jt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fg,{type:Fg},l=>{const u=l?.[0]?.[Fg];u!==void 0&&t(!!u),gi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=L4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return u_()||r_()||fy()}}const iR=rR;var D2="@firebase/auth",L2="1.12.0";class aR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){jt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function oR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lR(s){mi(new ei("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=i.options;jt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:g,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:d_(s)},p=new kA(i,l,u,y);return MA(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),mi(new ei("auth-internal",e=>{const t=ho(e.getProvider("auth").getImmediate());return(i=>new aR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(D2,L2,oR(s)),wr(D2,L2,"esm2020")}const cR=300,uR=zx("authIdTokenMaxAge")||cR;let O2=null;const dR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>uR)return;const l=t?.token;O2!==l&&(O2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function N_(s=Lu()){const e=Xo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=IA(s,{popupRedirectResolver:iR,persistence:[p4,Tp,py]}),i=zx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=dR(u.toString());e4(t,d,()=>d(t.currentUser)),ZA(t,g=>d(g))}}const l=Vx("auth");return l&&DA(t,`http://${l}`),t}function hR(){return document.getElementsByTagName("head")?.[0]??document}jA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ri("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",hR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lR("Browser");var P2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var to,A_;(function(){var s;function e(I,E){function O(){}O.prototype=E.prototype,I.F=E.prototype,I.prototype=new O,I.prototype.constructor=I,I.D=function(B,D,L){for(var A=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)A[Le-2]=arguments[Le];return E.prototype[D].apply(B,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(I,E,O){O||(O=0);const B=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)B[D]=E.charCodeAt(O++)|E.charCodeAt(O++)<<8|E.charCodeAt(O++)<<16|E.charCodeAt(O++)<<24;else for(D=0;D<16;++D)B[D]=E[O++]|E[O++]<<8|E[O++]<<16|E[O++]<<24;E=I.g[0],O=I.g[1],D=I.g[2];let L=I.g[3],A;A=E+(L^O&(D^L))+B[0]+3614090360&4294967295,E=O+(A<<7&4294967295|A>>>25),A=L+(D^E&(O^D))+B[1]+3905402710&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(O^L&(E^O))+B[2]+606105819&4294967295,D=L+(A<<17&4294967295|A>>>15),A=O+(E^D&(L^E))+B[3]+3250441966&4294967295,O=D+(A<<22&4294967295|A>>>10),A=E+(L^O&(D^L))+B[4]+4118548399&4294967295,E=O+(A<<7&4294967295|A>>>25),A=L+(D^E&(O^D))+B[5]+1200080426&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(O^L&(E^O))+B[6]+2821735955&4294967295,D=L+(A<<17&4294967295|A>>>15),A=O+(E^D&(L^E))+B[7]+4249261313&4294967295,O=D+(A<<22&4294967295|A>>>10),A=E+(L^O&(D^L))+B[8]+1770035416&4294967295,E=O+(A<<7&4294967295|A>>>25),A=L+(D^E&(O^D))+B[9]+2336552879&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(O^L&(E^O))+B[10]+4294925233&4294967295,D=L+(A<<17&4294967295|A>>>15),A=O+(E^D&(L^E))+B[11]+2304563134&4294967295,O=D+(A<<22&4294967295|A>>>10),A=E+(L^O&(D^L))+B[12]+1804603682&4294967295,E=O+(A<<7&4294967295|A>>>25),A=L+(D^E&(O^D))+B[13]+4254626195&4294967295,L=E+(A<<12&4294967295|A>>>20),A=D+(O^L&(E^O))+B[14]+2792965006&4294967295,D=L+(A<<17&4294967295|A>>>15),A=O+(E^D&(L^E))+B[15]+1236535329&4294967295,O=D+(A<<22&4294967295|A>>>10),A=E+(D^L&(O^D))+B[1]+4129170786&4294967295,E=O+(A<<5&4294967295|A>>>27),A=L+(O^D&(E^O))+B[6]+3225465664&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^O&(L^E))+B[11]+643717713&4294967295,D=L+(A<<14&4294967295|A>>>18),A=O+(L^E&(D^L))+B[0]+3921069994&4294967295,O=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(O^D))+B[5]+3593408605&4294967295,E=O+(A<<5&4294967295|A>>>27),A=L+(O^D&(E^O))+B[10]+38016083&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^O&(L^E))+B[15]+3634488961&4294967295,D=L+(A<<14&4294967295|A>>>18),A=O+(L^E&(D^L))+B[4]+3889429448&4294967295,O=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(O^D))+B[9]+568446438&4294967295,E=O+(A<<5&4294967295|A>>>27),A=L+(O^D&(E^O))+B[14]+3275163606&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^O&(L^E))+B[3]+4107603335&4294967295,D=L+(A<<14&4294967295|A>>>18),A=O+(L^E&(D^L))+B[8]+1163531501&4294967295,O=D+(A<<20&4294967295|A>>>12),A=E+(D^L&(O^D))+B[13]+2850285829&4294967295,E=O+(A<<5&4294967295|A>>>27),A=L+(O^D&(E^O))+B[2]+4243563512&4294967295,L=E+(A<<9&4294967295|A>>>23),A=D+(E^O&(L^E))+B[7]+1735328473&4294967295,D=L+(A<<14&4294967295|A>>>18),A=O+(L^E&(D^L))+B[12]+2368359562&4294967295,O=D+(A<<20&4294967295|A>>>12),A=E+(O^D^L)+B[5]+4294588738&4294967295,E=O+(A<<4&4294967295|A>>>28),A=L+(E^O^D)+B[8]+2272392833&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^O)+B[11]+1839030562&4294967295,D=L+(A<<16&4294967295|A>>>16),A=O+(D^L^E)+B[14]+4259657740&4294967295,O=D+(A<<23&4294967295|A>>>9),A=E+(O^D^L)+B[1]+2763975236&4294967295,E=O+(A<<4&4294967295|A>>>28),A=L+(E^O^D)+B[4]+1272893353&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^O)+B[7]+4139469664&4294967295,D=L+(A<<16&4294967295|A>>>16),A=O+(D^L^E)+B[10]+3200236656&4294967295,O=D+(A<<23&4294967295|A>>>9),A=E+(O^D^L)+B[13]+681279174&4294967295,E=O+(A<<4&4294967295|A>>>28),A=L+(E^O^D)+B[0]+3936430074&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^O)+B[3]+3572445317&4294967295,D=L+(A<<16&4294967295|A>>>16),A=O+(D^L^E)+B[6]+76029189&4294967295,O=D+(A<<23&4294967295|A>>>9),A=E+(O^D^L)+B[9]+3654602809&4294967295,E=O+(A<<4&4294967295|A>>>28),A=L+(E^O^D)+B[12]+3873151461&4294967295,L=E+(A<<11&4294967295|A>>>21),A=D+(L^E^O)+B[15]+530742520&4294967295,D=L+(A<<16&4294967295|A>>>16),A=O+(D^L^E)+B[2]+3299628645&4294967295,O=D+(A<<23&4294967295|A>>>9),A=E+(D^(O|~L))+B[0]+4096336452&4294967295,E=O+(A<<6&4294967295|A>>>26),A=L+(O^(E|~D))+B[7]+1126891415&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~O))+B[14]+2878612391&4294967295,D=L+(A<<15&4294967295|A>>>17),A=O+(L^(D|~E))+B[5]+4237533241&4294967295,O=D+(A<<21&4294967295|A>>>11),A=E+(D^(O|~L))+B[12]+1700485571&4294967295,E=O+(A<<6&4294967295|A>>>26),A=L+(O^(E|~D))+B[3]+2399980690&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~O))+B[10]+4293915773&4294967295,D=L+(A<<15&4294967295|A>>>17),A=O+(L^(D|~E))+B[1]+2240044497&4294967295,O=D+(A<<21&4294967295|A>>>11),A=E+(D^(O|~L))+B[8]+1873313359&4294967295,E=O+(A<<6&4294967295|A>>>26),A=L+(O^(E|~D))+B[15]+4264355552&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~O))+B[6]+2734768916&4294967295,D=L+(A<<15&4294967295|A>>>17),A=O+(L^(D|~E))+B[13]+1309151649&4294967295,O=D+(A<<21&4294967295|A>>>11),A=E+(D^(O|~L))+B[4]+4149444226&4294967295,E=O+(A<<6&4294967295|A>>>26),A=L+(O^(E|~D))+B[11]+3174756917&4294967295,L=E+(A<<10&4294967295|A>>>22),A=D+(E^(L|~O))+B[2]+718787259&4294967295,D=L+(A<<15&4294967295|A>>>17),A=O+(L^(D|~E))+B[9]+3951481745&4294967295,I.g[0]=I.g[0]+E&4294967295,I.g[1]=I.g[1]+(D+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+L&4294967295}i.prototype.v=function(I,E){E===void 0&&(E=I.length);const O=E-this.blockSize,B=this.C;let D=this.h,L=0;for(;L<E;){if(D==0)for(;L<=O;)l(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<E;)if(B[D++]=I.charCodeAt(L++),D==this.blockSize){l(this,B),D=0;break}}else for(;L<E;)if(B[D++]=I[L++],D==this.blockSize){l(this,B),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var E=1;E<I.length-8;++E)I[E]=0;E=this.o*8;for(var O=I.length-8;O<I.length;++O)I[O]=E&255,E/=256;for(this.v(I),I=Array(16),E=0,O=0;O<4;++O)for(let B=0;B<32;B+=8)I[E++]=this.g[O]>>>B&255;return I};function u(I,E){var O=g;return Object.prototype.hasOwnProperty.call(O,I)?O[I]:O[I]=E(I)}function d(I,E){this.h=E;const O=[];let B=!0;for(let D=I.length-1;D>=0;D--){const L=I[D]|0;B&&L==E||(O[D]=L,B=!1)}this.g=O}var g={};function y(I){return-128<=I&&I<128?u(I,function(E){return new d([E|0],E<0?-1:0)}):new d([I|0],I<0?-1:0)}function p(I){if(isNaN(I)||!isFinite(I))return k;if(I<0)return U(p(-I));const E=[];let O=1;for(let B=0;I>=O;B++)E[B]=I/O|0,O*=4294967296;return new d(E,0)}function b(I,E){if(I.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(I.charAt(0)=="-")return U(b(I.substring(1),E));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=p(Math.pow(E,8));let B=k;for(let L=0;L<I.length;L+=8){var D=Math.min(8,I.length-L);const A=parseInt(I.substring(L,L+D),E);D<8?(D=p(Math.pow(E,D)),B=B.j(D).add(p(A))):(B=B.j(O),B=B.add(p(A)))}return B}var k=y(0),T=y(1),R=y(16777216);s=d.prototype,s.m=function(){if(G(this))return-U(this).m();let I=0,E=1;for(let O=0;O<this.g.length;O++){const B=this.i(O);I+=(B>=0?B:4294967296+B)*E,E*=4294967296}return I},s.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(q(this))return"0";if(G(this))return"-"+U(this).toString(I);const E=p(Math.pow(I,6));var O=this;let B="";for(;;){const D=ye(O,E).g;O=K(O,D.j(E));let L=((O.g.length>0?O.g[0]:O.h)>>>0).toString(I);if(O=D,q(O))return L+B;for(;L.length<6;)L="0"+L;B=L+B}},s.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function q(I){if(I.h!=0)return!1;for(let E=0;E<I.g.length;E++)if(I.g[E]!=0)return!1;return!0}function G(I){return I.h==-1}s.l=function(I){return I=K(this,I),G(I)?-1:q(I)?0:1};function U(I){const E=I.g.length,O=[];for(let B=0;B<E;B++)O[B]=~I.g[B];return new d(O,~I.h).add(T)}s.abs=function(){return G(this)?U(this):this},s.add=function(I){const E=Math.max(this.g.length,I.g.length),O=[];let B=0;for(let D=0;D<=E;D++){let L=B+(this.i(D)&65535)+(I.i(D)&65535),A=(L>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);B=A>>>16,L&=65535,A&=65535,O[D]=A<<16|L}return new d(O,O[O.length-1]&-2147483648?-1:0)};function K(I,E){return I.add(U(E))}s.j=function(I){if(q(this)||q(I))return k;if(G(this))return G(I)?U(this).j(U(I)):U(U(this).j(I));if(G(I))return U(this.j(U(I)));if(this.l(R)<0&&I.l(R)<0)return p(this.m()*I.m());const E=this.g.length+I.g.length,O=[];for(var B=0;B<2*E;B++)O[B]=0;for(B=0;B<this.g.length;B++)for(let D=0;D<I.g.length;D++){const L=this.i(B)>>>16,A=this.i(B)&65535,Le=I.i(D)>>>16,st=I.i(D)&65535;O[2*B+2*D]+=A*st,Y(O,2*B+2*D),O[2*B+2*D+1]+=L*st,Y(O,2*B+2*D+1),O[2*B+2*D+1]+=A*Le,Y(O,2*B+2*D+1),O[2*B+2*D+2]+=L*Le,Y(O,2*B+2*D+2)}for(I=0;I<E;I++)O[I]=O[2*I+1]<<16|O[2*I];for(I=E;I<2*E;I++)O[I]=0;return new d(O,0)};function Y(I,E){for(;(I[E]&65535)!=I[E];)I[E+1]+=I[E]>>>16,I[E]&=65535,E++}function ee(I,E){this.g=I,this.h=E}function ye(I,E){if(q(E))throw Error("division by zero");if(q(I))return new ee(k,k);if(G(I))return E=ye(U(I),E),new ee(U(E.g),U(E.h));if(G(E))return E=ye(I,U(E)),new ee(U(E.g),E.h);if(I.g.length>30){if(G(I)||G(E))throw Error("slowDivide_ only works with positive integers.");for(var O=T,B=E;B.l(I)<=0;)O=ke(O),B=ke(B);var D=ve(O,1),L=ve(B,1);for(B=ve(B,2),O=ve(O,2);!q(B);){var A=L.add(B);A.l(I)<=0&&(D=D.add(O),L=A),B=ve(B,1),O=ve(O,1)}return E=K(I,D.j(E)),new ee(D,E)}for(D=k;I.l(E)>=0;){for(O=Math.max(1,Math.floor(I.m()/E.m())),B=Math.ceil(Math.log(O)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),L=p(O),A=L.j(E);G(A)||A.l(I)>0;)O-=B,L=p(O),A=L.j(E);q(L)&&(L=T),D=D.add(L),I=K(I,A)}return new ee(D,I)}s.B=function(I){return ye(this,I).h},s.and=function(I){const E=Math.max(this.g.length,I.g.length),O=[];for(let B=0;B<E;B++)O[B]=this.i(B)&I.i(B);return new d(O,this.h&I.h)},s.or=function(I){const E=Math.max(this.g.length,I.g.length),O=[];for(let B=0;B<E;B++)O[B]=this.i(B)|I.i(B);return new d(O,this.h|I.h)},s.xor=function(I){const E=Math.max(this.g.length,I.g.length),O=[];for(let B=0;B<E;B++)O[B]=this.i(B)^I.i(B);return new d(O,this.h^I.h)};function ke(I){const E=I.g.length+1,O=[];for(let B=0;B<E;B++)O[B]=I.i(B)<<1|I.i(B-1)>>>31;return new d(O,I.h)}function ve(I,E){const O=E>>5;E%=32;const B=I.g.length-O,D=[];for(let L=0;L<B;L++)D[L]=E>0?I.i(L+O)>>>E|I.i(L+O+1)<<32-E:I.i(L+O);return new d(D,I.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,A_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=p,d.fromString=b,to=d}).apply(typeof P2<"u"?P2:typeof self<"u"?self:typeof window<"u"?window:{});var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var R_,ou,I_,Sh,Cp,M_,D_,L_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ch=="object"&&ch];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var N=0;N<h.length-1;N++){var se=h[N];if(!(se in _))break e;_=_[se]}h=h[h.length-1],N=_[h],v=v(N),v!=N&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},d=this||self;function g(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,_){return h.call.apply(h.bind,arguments)}function p(h,v,_){return p=y,p.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function k(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(N,se,fe){for(var Ue=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Ue[Vt-2]=arguments[Vt];return v.prototype[se].apply(N,Ue)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const v=h.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=h[N];return _}return[]}function q(h,v){for(let N=1;N<arguments.length;N++){const se=arguments[N];var _=typeof se;if(_=_!="object"?_:se?Array.isArray(se)?"array":_:"null",_=="array"||_=="object"&&typeof se.length=="number"){_=h.length||0;const fe=se.length||0;h.length=_+fe;for(let Ue=0;Ue<fe;Ue++)h[_+Ue]=se[Ue]}else h.push(se)}}class G{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function U(h){d.setTimeout(()=>{throw h},0)}function K(){var h=I;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Y{constructor(){this.h=this.g=null}add(v,_){const N=ee.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var ee=new G(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ke,ve=!1,I=new Y,E=()=>{const h=Promise.resolve(void 0);ke=()=>{h.then(O)}};function O(){for(var h;h=K();){try{h.h.call(h.g)}catch(_){U(_)}var v=ee;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}ve=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Le(h,v){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}k(Le,D),Le.prototype.init=function(h,v){const _=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var st="closure_listenable_"+(Math.random()*1e6|0),te=0;function Te(h,v,_,N,se){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=se,this.key=++te,this.da=this.fa=!1}function He(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ae(h,v,_){for(const N in h)v.call(_,h[N],N,h)}function We(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function V(h){const v={};for(const _ in h)v[_]=h[_];return v}const ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(h,v){let _,N;for(let se=1;se<arguments.length;se++){N=arguments[se];for(_ in N)h[_]=N[_];for(let fe=0;fe<ce.length;fe++)_=ce[fe],Object.prototype.hasOwnProperty.call(N,_)&&(h[_]=N[_])}}function Se(h){this.src=h,this.g={},this.h=0}Se.prototype.add=function(h,v,_,N,se){const fe=h.toString();h=this.g[fe],h||(h=this.g[fe]=[],this.h++);const Ue=Pe(h,v,N,se);return Ue>-1?(v=h[Ue],_||(v.fa=!1)):(v=new Te(v,this.src,fe,!!N,se),v.fa=_,h.push(v)),v};function _e(h,v){const _=v.type;if(_ in h.g){var N=h.g[_],se=Array.prototype.indexOf.call(N,v,void 0),fe;(fe=se>=0)&&Array.prototype.splice.call(N,se,1),fe&&(He(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Pe(h,v,_,N){for(let se=0;se<h.length;++se){const fe=h[se];if(!fe.da&&fe.listener==v&&fe.capture==!!_&&fe.ha==N)return se}return-1}var ze="closure_lm_"+(Math.random()*1e6|0),Ye={};function Je(h,v,_,N,se){if(Array.isArray(v)){for(let fe=0;fe<v.length;fe++)Je(h,v[fe],_,N,se);return null}return _=ut(_),h&&h[st]?h.J(v,_,g(N)?!!N.capture:!1,se):Qt(h,v,_,!1,N,se)}function Qt(h,v,_,N,se,fe){if(!v)throw Error("Invalid event type");const Ue=g(se)?!!se.capture:!!se;let Vt=gn(h);if(Vt||(h[ze]=Vt=new Se(h)),_=Vt.add(v,_,N,Ue,fe),_.proxy)return _;if(N=Rt(),_.proxy=N,N.src=h,N.listener=_,h.addEventListener)L||(se=Ue),se===void 0&&(se=!1),h.addEventListener(v.toString(),N,se);else if(h.attachEvent)h.attachEvent(qt(v.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Rt(){function h(_){return v.call(h.src,h.listener,_)}const v=Tt;return h}function Sn(h,v,_,N,se){if(Array.isArray(v))for(var fe=0;fe<v.length;fe++)Sn(h,v[fe],_,N,se);else N=g(N)?!!N.capture:!!N,_=ut(_),h&&h[st]?(h=h.i,fe=String(v).toString(),fe in h.g&&(v=h.g[fe],_=Pe(v,_,N,se),_>-1&&(He(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[fe],h.h--)))):h&&(h=gn(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Pe(v,_,N,se)),(_=h>-1?v[h]:null)&&on(_))}function on(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[st])_e(v.i,h);else{var _=h.type,N=h.proxy;v.removeEventListener?v.removeEventListener(_,N,h.capture):v.detachEvent?v.detachEvent(qt(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=gn(v))?(_e(_,h),_.h==0&&(_.src=null,v[ze]=null)):He(h)}}}function qt(h){return h in Ye?Ye[h]:Ye[h]="on"+h}function Tt(h,v){if(h.da)h=!0;else{v=new Le(v,this);const _=h.listener,N=h.ha||h.src;h.fa&&on(h),h=_.call(N,v)}return h}function gn(h){return h=h[ze],h instanceof Se?h:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function ut(h){return typeof h=="function"?h:(h[St]||(h[St]=function(v){return h.handleEvent(v)}),h[St])}function le(){B.call(this),this.i=new Se(this),this.M=this,this.G=null}k(le,B),le.prototype[st]=!0,le.prototype.removeEventListener=function(h,v,_,N){Sn(this,h,v,_,N)};function pt(h,v){var _,N=h.G;if(N)for(_=[];N;N=N.G)_.push(N);if(h=h.M,N=v.type||v,typeof v=="string")v=new D(v,h);else if(v instanceof D)v.target=v.target||h;else{var se=v;v=new D(N,h),je(v,se)}se=!0;let fe,Ue;if(_)for(Ue=_.length-1;Ue>=0;Ue--)fe=v.g=_[Ue],se=Ht(fe,N,!0,v)&&se;if(fe=v.g=h,se=Ht(fe,N,!0,v)&&se,se=Ht(fe,N,!1,v)&&se,_)for(Ue=0;Ue<_.length;Ue++)fe=v.g=_[Ue],se=Ht(fe,N,!1,v)&&se}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let N=0;N<_.length;N++)He(_[N]);delete h.g[v],h.h--}}this.G=null},le.prototype.J=function(h,v,_,N){return this.i.add(String(h),v,!1,_,N)},le.prototype.K=function(h,v,_,N){return this.i.add(String(h),v,!0,_,N)};function Ht(h,v,_,N){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let se=!0;for(let fe=0;fe<v.length;++fe){const Ue=v[fe];if(Ue&&!Ue.da&&Ue.capture==_){const Vt=Ue.listener,cs=Ue.ha||Ue.src;Ue.fa&&_e(h.i,Ue),se=Vt.call(cs,N)!==!1&&se}}return se&&!N.defaultPrevented}function it(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function yt(h){h.g=it(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class mt extends B{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wt(h){B.call(this),this.h=h,this.g={}}k(wt,B);var Bt=[];function fs(h){Ae(h.g,function(v,_){this.g.hasOwnProperty(_)&&on(v)},h),h.g={}}wt.prototype.N=function(){wt.Z.N.call(this),fs(this)},wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rn=d.JSON.stringify,Jn=d.JSON.parse,Fn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ln(){}function On(){}var cn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gt(){D.call(this,"d")}k(Gt,D);function Dt(){D.call(this,"c")}k(Dt,D);var It={},Z=null;function C(){return Z=Z||new le}It.Ia="serverreachability";function re(h){D.call(this,It.Ia,h)}k(re,D);function Re(h){const v=C();pt(v,new re(v))}It.STAT_EVENT="statevent";function Ie(h,v){D.call(this,It.STAT_EVENT,h),this.stat=v}k(Ie,D);function De(h){const v=C();pt(v,new Ie(v,h))}It.Ja="timingevent";function Fe(h,v){D.call(this,It.Ja,h),this.size=v}k(Fe,D);function Oe(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Lt(){this.g=!0}Lt.prototype.ua=function(){this.g=!1};function xt(h,v,_,N,se,fe){h.info(function(){if(h.g)if(fe){var Ue="",Vt=fe.split("&");for(let xn=0;xn<Vt.length;xn++){var cs=Vt[xn].split("=");if(cs.length>1){const qn=cs[0];cs=cs[1];const Br=qn.split("_");Ue=Br.length>=2&&Br[1]=="type"?Ue+(qn+"="+cs+"&"):Ue+(qn+"=redacted&")}}}else Ue=null;else Ue=fe;return"XMLHTTP REQ ("+N+") [attempt "+se+"]: "+v+`
`+_+`
`+Ue})}function lt(h,v,_,N,se,fe,Ue){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+se+"]: "+v+`
`+_+`
`+fe+" "+Ue})}function un(h,v,_,N){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Pn(h,_)+(N?" "+N:"")})}function dn(h,v){h.info(function(){return"TIMEOUT: "+v})}Lt.prototype.info=function(){};function Pn(h,v){if(!h.g)return v;if(!v)return null;try{const fe=JSON.parse(v);if(fe){for(h=0;h<fe.length;h++)if(Array.isArray(fe[h])){var _=fe[h];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var se=N[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Ue=1;Ue<N.length;Ue++)N[Ue]=""}}}}return rn(fe)}catch{return v}}var ms={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Me;function Ge(){}k(Ge,Ln),Ge.prototype.g=function(){return new XMLHttpRequest},Me=new Ge;function ct(h){return encodeURIComponent(String(h))}function et(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function $t(h,v,_,N){this.j=h,this.i=v,this.l=_,this.S=N||1,this.V=new wt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new hn}function hn(){this.i=null,this.g="",this.h=!1}var Nt={},Ct={};function vn(h,v,_){h.M=1,h.A=At(ne(v)),h.u=_,h.R=!0,Ss(h,null)}function Ss(h,v){h.F=Date.now(),js(h),h.B=ne(h.A);var _=h.B,N=h.S;Array.isArray(N)||(N=[String(N)]),xi(_.i,"t",N),h.C=0,_=h.j.L,h.h=new hn,h.g=ed(h.j,_?v:null,!h.u),h.P>0&&(h.O=new mt(p(h.Y,h,h.g),h.P)),v=h.V,_=h.g,N=h.ba;var se="readystatechange";Array.isArray(se)||(se&&(Bt[0]=se.toString()),se=Bt);for(let fe=0;fe<se.length;fe++){const Ue=Je(_,se[fe],N||v.handleEvent,!1,v.h||v);if(!Ue)break;v.g[Ue.key]=Ue}v=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Re(),xt(h.i,h.v,h.B,h.l,h.S,h.u)}$t.prototype.ba=function(h){h=h.target;const v=this.O;v&&Hn(h)==3?v.j():this.Y(h)},$t.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Hn(this.g),cs=this.g.ya(),xn=this.g.ca();if(!(Vt<3)&&(Vt!=3||this.g&&(this.h.h||this.g.la()||rt(this.g)))){this.K||Vt!=4||cs==7||(cs==8||xn<=0?Re(3):Re(2)),Gn(this);var v=this.g.ca();this.X=v;var _=ni(this);if(this.o=v==200,lt(this.i,this.v,this.B,this.l,this.S,Vt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,se=this.g;if((N=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var fe=N;break t}}fe=null}if(h=fe)un(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vn(this,h);else{this.o=!1,this.m=3,De(12),ls(this),os(this);break e}}if(this.R){h=!0;let qn;for(;!this.K&&this.C<_.length;)if(qn=Pr(this,_),qn==Ct){Vt==4&&(this.m=4,De(14),h=!1),un(this.i,this.l,null,"[Incomplete Response]");break}else if(qn==Nt){this.m=4,De(15),un(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else un(this.i,this.l,qn,null),Vn(this,qn);if(bi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||_.length!=0||this.h.h||(this.m=1,De(16),h=!1),this.o=this.o&&h,!h)un(this.i,this.l,_,"[Invalid Chunked Response]"),ls(this),os(this);else if(_.length>0&&!this.W){this.W=!0;var Ue=this.j;Ue.g==this&&Ue.aa&&!Ue.P&&(Ue.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),fc(Ue),Ue.P=!0,De(11))}}else un(this.i,this.l,_,null),Vn(this,_);Vt==4&&ls(this),this.o&&!this.K&&(Vt==4?Qu(this.j,this):(this.o=!1,js(this)))}else wn(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,De(12)):(this.m=0,De(13)),ls(this),os(this)}}}catch{}};function ni(h){if(!bi(h))return h.g.la();const v=rt(h.g);if(v==="")return"";let _="";const N=v.length,se=Hn(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ls(h),os(h),"";h.h.i=new d.TextDecoder}for(let fe=0;fe<N;fe++)h.h.h=!0,_+=h.h.i.decode(v[fe],{stream:!(se&&fe==N-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function bi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Pr(h,v){var _=h.C,N=v.indexOf(`
`,_);return N==-1?Ct:(_=Number(v.substring(_,N)),isNaN(_)?Nt:(N+=1,N+_>v.length?Ct:(v=v.slice(N,N+_),h.C=N+_,v)))}$t.prototype.cancel=function(){this.K=!0,ls(this)};function js(h){h.T=Date.now()+h.H,hr(h,h.H)}function hr(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Oe(p(h.aa,h),v)}function Gn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}$t.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(dn(this.i,this.B),this.M!=2&&(Re(),De(17)),ls(this),this.m=2,os(this)):hr(this,this.T-h)};function os(h){h.j.I==0||h.K||Qu(h.j,h)}function ls(h){Gn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,fs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Vn(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||Kn(_.h,h))){if(!h.L&&Kn(_.h,h)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var se=N;if(se[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)il(_),Qn(_);else break e;ii(_),De(18)}}else _.xa=se[1],0<_.xa-_.K&&se[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Oe(p(_.Va,_),6e3));Hs(_.h)<=1&&_.ta&&(_.ta=void 0)}else _i(_,11)}else if((h.L||_.g==h)&&il(_),!A(v))for(se=_.Ba.g.parse(v),v=0;v<se.length;v++){let xn=se[v];const qn=xn[0];if(!(qn<=_.K))if(_.K=qn,xn=xn[1],_.I==2)if(xn[0]=="c"){_.M=xn[1],_.ba=xn[2];const Br=xn[3];Br!=null&&(_.ka=Br,_.j.info("VER="+_.ka));const ki=xn[4];ki!=null&&(_.za=ki,_.j.info("SVER="+_.za));const ai=xn[5];ai!=null&&typeof ai=="number"&&ai>0&&(N=1.5*ai,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const oi=h.g;if(oi){const po=oi.g?oi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(po){var fe=N.h;fe.g||po.indexOf("spdy")==-1&&po.indexOf("quic")==-1&&po.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(_r(fe,fe.h),fe.h=null))}if(N.G){const al=oi.g?oi.g.getResponseHeader("X-HTTP-Session-Id"):null;al&&(N.wa=al,ot(N.J,N.G,al))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Ue=h;if(N.na=Zu(N,N.L?N.ba:null,N.W),Ue.L){es(N.h,Ue);var Vt=Ue,cs=N.O;cs&&(Vt.H=cs),Vt.D&&(Gn(Vt),js(Vt)),N.g=Ue}else rl(N);_.i.length>0&&Ws(_)}else xn[0]!="stop"&&xn[0]!="close"||_i(_,7);else _.I==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?_i(_,7):mn(_):xn[0]!="noop"&&_.l&&_.l.qa(xn),_.A=0)}}Re(4)}catch{}}var bn=class{constructor(h,v){this.g=h,this.map=v}};function Zn(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function xr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Hs(h){return h.h?1:h.g?h.g.size:0}function Kn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function _r(h,v){h.g?h.g.add(v):h.h=v}function es(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Zn.prototype.cancel=function(){if(this.i=Vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Vr(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return R(h.i)}var P=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function H(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const N=h[_].indexOf("=");let se,fe=null;N>=0?(se=h[_].substring(0,N),fe=h[_].substring(N+1)):se=h[_],v(se,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function ae(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof ae?(this.l=h.l,$e(this,h.j),this.o=h.o,this.g=h.g,Qe(this,h.u),this.h=h.h,Ke(this,zi(h.i)),this.m=h.m):h&&(v=String(h).match(P))?(this.l=!1,$e(this,v[1]||"",!0),this.o=Cn(v[2]||""),this.g=Cn(v[3]||"",!0),Qe(this,v[4]),this.h=Cn(v[5]||"",!0),Ke(this,v[6]||"",!0),this.m=Cn(v[7]||"")):(this.l=!1,this.i=new kr(null,this.l))}ae.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Cs(v,Ms,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Cs(v,Ms,!0),"@"),h.push(ct(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(Cs(_,_.charAt(0)=="/"?Ds:si,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",Cs(_,wi)),h.join("")},ae.prototype.resolve=function(h){const v=ne(this);let _=!!h.j;_?$e(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var N=h.h;if(_)Qe(v,h.u);else if(_=!!h.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var se=v.h.lastIndexOf("/");se!=-1&&(N=v.h.slice(0,se+1)+N)}if(se=N,se==".."||se==".")N="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){N=se.lastIndexOf("/",0)==0,se=se.split("/");const fe=[];for(let Ue=0;Ue<se.length;){const Vt=se[Ue++];Vt=="."?N&&Ue==se.length&&fe.push(""):Vt==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),N&&Ue==se.length&&fe.push("")):(fe.push(Vt),N=!0)}N=fe.join("/")}else N=se}return _?v.h=N:_=h.i.toString()!=="",_?Ke(v,zi(h.i)):_=!!h.m,_&&(v.m=h.m),v};function ne(h){return new ae(h)}function $e(h,v,_){h.j=_?Cn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Qe(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Ke(h,v,_){v instanceof kr?(h.i=v,jr(h.i,h.l)):(_||(v=Cs(v,er)),h.i=new kr(v,h.l))}function ot(h,v,_){h.i.set(v,_)}function At(h){return ot(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Cn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Cs(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,Yn),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Yn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ms=/[#\/\?@]/g,si=/[#\?:]/g,Ds=/[#\?]/g,er=/[#\?@]/g,wi=/#/g;function kr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Ns(h){h.g||(h.g=new Map,h.h=0,h.i&&H(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=kr.prototype,s.add=function(h,v){Ns(this),this.i=null,h=Ur(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function _a(h,v){Ns(h),v=Ur(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Bi(h,v){return Ns(h),v=Ur(h,v),h.g.has(v)}s.forEach=function(h,v){Ns(this),this.g.forEach(function(_,N){_.forEach(function(se){h.call(v,se,N,this)},this)},this)};function ri(h,v){Ns(h);let _=[];if(typeof v=="string")Bi(h,v)&&(_=_.concat(h.g.get(Ur(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Ns(this),this.i=null,h=Ur(this,h),Bi(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=ri(this,h),h.length>0?String(h[0]):v):v};function xi(h,v,_){_a(h,v),_.length>0&&(h.i=null,h.g.set(Ur(h,v),R(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const se=ct(_);_=ri(this,_);for(let fe=0;fe<_.length;fe++){let Ue=se;_[fe]!==""&&(Ue+="="+ct(_[fe])),h.push(Ue)}}return this.i=h.join("&")};function zi(h){const v=new kr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Ur(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function jr(h,v){v&&!h.j&&(Ns(h),h.i=null,h.g.forEach(function(_,N){const se=N.toLowerCase();N!=se&&(_a(this,N),xi(this,se,_))},h)),h.j=v}function qs(h,v){const _=new Lt;if(d.Image){const N=new Image;N.onload=b(Ls,_,"TestLoadImage: loaded",!0,v,N),N.onerror=b(Ls,_,"TestLoadImage: error",!1,v,N),N.onabort=b(Ls,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(Ls,_,"TestLoadImage: timeout",!1,v,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else v(!1)}function $s(h,v){const _=new Lt,N=new AbortController,se=setTimeout(()=>{N.abort(),Ls(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:N.signal}).then(fe=>{clearTimeout(se),fe.ok?Ls(_,"TestPingServer: ok",!0,v):Ls(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),Ls(_,"TestPingServer: error",!1,v)})}function Ls(h,v,_,N,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),N(_)}catch{}}function S(){this.g=new Fn}function Q(h){this.i=h.Sb||null,this.h=h.ab||!1}k(Q,Ln),Q.prototype.g=function(){return new Ce(this.i,this.h)};function Ce(h,v){le.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Ce,le),s=Ce.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,$(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,F(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,$(this)),this.g&&(this.readyState=3,$(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;M(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function M(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?F(this):$(this),this.readyState==3&&M(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,F(this))},s.Na=function(h){this.g&&(this.response=h,F(this))},s.ga=function(){this.g&&F(this)};function F(h){h.readyState=4,h.l=null,h.j=null,h.B=null,$(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function $(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ce.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function X(h){let v="";return Ae(h,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function de(h,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=X(_),typeof h=="string"?_!=null&&ct(_):ot(h,v,_))}function pe(h){le.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(pe,le);var Ve=/^https?$/i,tt=["POST","PUT"];s=pe.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Me.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(fe){nt(this,fe);return}if(h=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var se in N)_.set(se,N[se]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const fe of N.keys())_.set(fe,N.get(fe));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(fe=>fe.toLowerCase()=="content-type"),se=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(tt,v,void 0)>=0)||N||se||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Ue]of _)this.g.setRequestHeader(fe,Ue);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(fe){nt(this,fe)}};function nt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,vt(h),Xt(h)}function vt(h){h.A||(h.A=!0,pt(h,"complete"),pt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,pt(this,"complete"),pt(this,"abort"),Xt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),pe.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?_t(this):this.Xa())},s.Xa=function(){_t(this)};function _t(h){if(h.h&&typeof u<"u"){if(h.v&&Hn(h)==4)setTimeout(h.Ca.bind(h),0);else if(pt(h,"readystatechange"),Hn(h)==4){h.h=!1;try{const fe=h.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=fe===0){let Ue=String(h.D).match(P)[1]||null;!Ue&&d.self&&d.self.location&&(Ue=d.self.location.protocol.slice(0,-1)),N=!Ve.test(Ue?Ue.toLowerCase():"")}_=N}if(_)pt(h,"complete"),pt(h,"success");else{h.o=6;try{var se=Hn(h)>2?h.g.statusText:""}catch{se=""}h.l=se+" ["+h.ca()+"]",vt(h)}}finally{Xt(h)}}}}function Xt(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||pt(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hn(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Hn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Jn(v)}};function rt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function wn(h){const v={};h=(h.g&&Hn(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(A(h[N]))continue;var _=et(h[N]);const se=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const fe=v[se]||[];v[se]=fe,fe.push(_)}We(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function fn(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function gt(h){this.za=0,this.i=[],this.j=new Lt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=fn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=fn("baseRetryDelayMs",5e3,h),this.Za=fn("retryDelaySeedMs",1e4,h),this.Ta=fn("forwardChannelMaxRetries",2,h),this.va=fn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Zn(h&&h.concurrentRequestLimit),this.Ba=new S,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=gt.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,N){De(0),this.W=h,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Zu(this,null,this.W),Ws(this)};function mn(h){if(tr(h),h.I==3){var v=h.V++,_=ne(h.J);if(ot(_,"SID",h.M),ot(_,"RID",v),ot(_,"TYPE","terminate"),Er(h,_),v=new $t(h,h.j,v),v.M=2,v.A=At(ne(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=ed(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}Ju(h)}function Qn(h){h.g&&(fc(h),h.g.cancel(),h.g=null)}function tr(h){Qn(h),h.v&&(d.clearTimeout(h.v),h.v=null),il(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Ws(h){if(!xr(h.h)&&!h.m){h.m=!0;var v=h.Ea;ke||E(),ve||(ke(),ve=!0),I.add(v,h),h.D=0}}function As(h,v){return Hs(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Oe(p(h.Ea,h,v),Xu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const se=new $t(this,this.j,h);let fe=this.o;if(this.U&&(fe?(fe=V(fe),je(fe,this.U)):fe=this.U),this.u!==null||this.R||(se.J=fe,fe=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=go(this,se,v),_=ne(this.J),ot(_,"RID",h),ot(_,"CVER",22),this.G&&ot(_,"X-HTTP-Session-Id",this.G),Er(this,_),fe&&(this.R?v="headers="+ct(X(fe))+"&"+v:this.u&&de(_,this.u,fe)),_r(this.h,se),this.Ra&&ot(_,"TYPE","init"),this.S?(ot(_,"$req",v),ot(_,"SID","null"),se.U=!0,vn(se,_,null)):vn(se,_,v),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||xr(this.h)||nr(this))};function nr(h,v){var _;v?_=v.l:_=h.V++;const N=ne(h.J);ot(N,"SID",h.M),ot(N,"RID",_),ot(N,"AID",h.K),Er(h,N),h.u&&h.o&&de(N,h.u,h.o),_=new $t(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=go(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),_r(h.h,_),vn(_,N,v)}function Er(h,v){h.H&&Ae(h.H,function(_,N){ot(v,N,_)}),h.l&&Ae({},function(_,N){ot(v,N,_)})}function go(h,v,_){_=Math.min(h.i.length,_);const N=h.l?p(h.l.Ka,h.l,h):null;e:{var se=h.i;let Vt=-1;for(;;){const cs=["count="+_];Vt==-1?_>0?(Vt=se[0].g,cs.push("ofs="+Vt)):Vt=0:cs.push("ofs="+Vt);let xn=!0;for(let qn=0;qn<_;qn++){var fe=se[qn].g;const Br=se[qn].map;if(fe-=Vt,fe<0)Vt=Math.max(0,se[qn].g-100),xn=!1;else try{fe="req"+fe+"_"||"";try{var Ue=Br instanceof Map?Br:Object.entries(Br);for(const[ki,ai]of Ue){let oi=ai;g(ai)&&(oi=rn(ai)),cs.push(fe+ki+"="+encodeURIComponent(oi))}}catch(ki){throw cs.push(fe+"type="+encodeURIComponent("_badmap")),ki}}catch{N&&N(Br)}}if(xn){Ue=cs.join("&");break e}}Ue=void 0}return h=h.i.splice(0,_),v.G=h,Ue}function rl(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;ke||E(),ve||(ke(),ve=!0),I.add(v,h),h.A=0}}function ii(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Oe(p(h.Da,h),Xu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Yu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Oe(p(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,De(10),Qn(this),Yu(this))};function fc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Yu(h){h.g=new $t(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=ne(h.na);ot(v,"RID","rpc"),ot(v,"SID",h.M),ot(v,"AID",h.K),ot(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ot(v,"TO",h.ia),ot(v,"TYPE","xmlhttp"),Er(h,v),h.u&&h.o&&de(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=At(ne(v)),_.u=null,_.R=!0,Ss(_,h)}s.Va=function(){this.C!=null&&(this.C=null,Qn(this),ii(this),De(19))};function il(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Qu(h,v){var _=null;if(h.g==v){il(h),fc(h),h.g=null;var N=2}else if(Kn(h.h,v))_=v.G,es(h.h,v),N=1;else return;if(h.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var se=h.D;N=C(),pt(N,new Fe(N,_)),Ws(h)}else rl(h);else if(se=v.m,se==3||se==0&&v.X>0||!(N==1&&As(h,v)||N==2&&ii(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),se){case 1:_i(h,5);break;case 4:_i(h,10);break;case 3:_i(h,6);break;default:_i(h,2)}}}function Xu(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function _i(h,v){if(h.j.info("Error code "+v),v==2){var _=p(h.bb,h),N=h.Ua;const se=!N;N=new ae(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||$e(N,"https"),At(N),se?qs(N.toString(),_):$s(N.toString(),_)}else De(2);h.I=0,h.l&&h.l.pa(v),Ju(h),tr(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function Ju(h){if(h.I=0,h.ja=[],h.l){const v=Vr(h.h);(v.length!=0||h.i.length!=0)&&(q(h.ja,v),q(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function Zu(h,v,_){var N=_ instanceof ae?ne(_):new ae(_);if(N.g!="")v&&(N.g=v+"."+N.g),Qe(N,N.u);else{var se=d.location;N=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;const fe=new ae(null);N&&$e(fe,N),v&&(fe.g=v),se&&Qe(fe,se),_&&(fe.h=_),N=fe}return _=h.G,v=h.wa,_&&v&&ot(N,_,v),ot(N,"VER",h.ka),Er(h,N),N}function ed(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new pe(new Q({ab:_})):new pe(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function td(){}s=td.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ka(){}ka.prototype.g=function(h,v){return new sr(h,v)};function sr(h,v){le.call(this),this.g=new gt(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Fi(this)}k(sr,le),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){mn(this.g)},sr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=rn(h),h=_);v.i.push(new bn(v.Ya++,h)),v.I==3&&Ws(v)},sr.prototype.N=function(){this.g.l=null,delete this.j,mn(this.g),delete this.g,sr.Z.N.call(this)};function nd(h){Gt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}k(nd,Gt);function sd(){Dt.call(this),this.status=1}k(sd,Dt);function Fi(h){this.g=h}k(Fi,td),Fi.prototype.ra=function(){pt(this.g,"a")},Fi.prototype.qa=function(h){pt(this.g,new nd(h))},Fi.prototype.pa=function(h){pt(this.g,new sd)},Fi.prototype.oa=function(){pt(this.g,"b")},ka.prototype.createWebChannel=ka.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,L_=function(){return new ka},D_=function(){return C()},M_=It,Cp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Sh=ms,ue.COMPLETE="complete",I_=ue,On.EventType=cn,cn.OPEN="a",cn.CLOSE="b",cn.ERROR="c",cn.MESSAGE="d",le.prototype.listen=le.prototype.J,ou=On,pe.prototype.listenOnce=pe.prototype.K,pe.prototype.getLastError=pe.prototype.Ha,pe.prototype.getLastErrorCode=pe.prototype.ya,pe.prototype.getStatus=pe.prototype.ca,pe.prototype.getResponseJson=pe.prototype.La,pe.prototype.getResponseText=pe.prototype.la,pe.prototype.send=pe.prototype.ea,pe.prototype.setWithCredentials=pe.prototype.Fa,R_=pe}).apply(typeof ch<"u"?ch:typeof self<"u"?self:typeof window<"u"?window:{});class Ys{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ys.UNAUTHENTICATED=new Ys(null),Ys.GOOGLE_CREDENTIALS=new Ys("google-credentials-uid"),Ys.FIRST_PARTY=new Ys("first-party-uid"),Ys.MOCK_USER=new Ys("mock-user");let oc="12.8.0";function fR(s){oc=s}const Fo=new oy("@firebase/firestore");function Vl(){return Fo.logLevel}function Xe(s,...e){if(Fo.logLevel<=en.DEBUG){const t=e.map(by);Fo.debug(`Firestore (${oc}): ${s}`,...t)}}function ya(s,...e){if(Fo.logLevel<=en.ERROR){const t=e.map(by);Fo.error(`Firestore (${oc}): ${s}`,...t)}}function Yl(s,...e){if(Fo.logLevel<=en.WARN){const t=e.map(by);Fo.warn(`Firestore (${oc}): ${s}`,...t)}}function by(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function Et(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,O_(s,i,t)}function O_(s,e,t){let i=`FIRESTORE (${oc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ya(i),new Error(i)}function kn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||O_(e,l,i)}function Pt(s,e){return s}const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ha{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class P_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ys.UNAUTHENTICATED)))}shutdown(){}}class gR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=Ys.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let u=new ha;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ha,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=u;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},g=y=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>g(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?g(y):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ha)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(kn(typeof i.accessToken=="string",31837,{l:i}),new P_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kn(e===null||typeof e=="string",2055,{h:e}),new Ys(e)}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ys.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class vR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new yR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ys.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){kn(this.o===void 0,3512);const i=u=>{u.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Xe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new V2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(kn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new V2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function wR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=wR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function nn(s,e){return s<e?-1:s>e?1:0}function Np(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Hg(l)===Hg(u)?nn(l,u):Hg(l)?1:-1}return nn(s.length,e.length)}const xR=55296,_R=57343;function Hg(s){const e=s.charCodeAt(0);return e>=xR&&e<=_R}function Ql(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const U2="__name__";class Ni{constructor(e,t,i){t===void 0?t=0:t>e.length&&Et(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Et(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ni.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ni?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ni.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return nn(e.length,t.length)}static compareSegments(e,t){const i=Ni.isNumericId(e),l=Ni.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ni.extractNumericId(e).compare(Ni.extractNumericId(t)):Np(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return to.fromString(e.substring(4,e.length-2))}}class Dn extends Ni{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new qe(we.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const kR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Ni{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return kR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===U2}static keyField(){return new zs([U2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new qe(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const g=e[l];if(g==="\\"){if(l+1===e.length)throw new qe(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new qe(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else g==="`"?(d=!d,l++):g!=="."||d?(i+=g,l++):(u(),l++)}if(u(),d)throw new qe(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Dn.fromString(e))}static fromName(e){return new ft(Dn.fromString(e).popFirst(5))}static empty(){return new ft(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Dn(e.slice()))}}function V_(s,e,t){if(!t)throw new qe(we.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function jR(s,e,t,i){if(e===!0&&i===!0)throw new qe(we.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function B2(s){if(!ft.isDocumentKey(s))throw new qe(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function z2(s){if(ft.isDocumentKey(s))throw new qe(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function U_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Et(12329,{type:typeof s})}function cr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new qe(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(s);throw new qe(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ER(s,e){if(e<=0)throw new qe(we.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function Bu(s,e){if(!U_(s))throw new qe(we.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new qe(we.INVALID_ARGUMENT,t);return!0}const F2=-62135596800,H2=1e6;class Ft{static now(){return Ft.fromMillis(Date.now())}static fromDate(e){return Ft.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*H2);return new Ft(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new qe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new qe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F2)throw new qe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/H2}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ft._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Bu(e,Ft._jsonSchema))return new Ft(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-F2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ft._jsonSchemaVersion="firestore/timestamp/1.0",Ft._jsonSchema={type:ks("string",Ft._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};class Mt{static fromTimestamp(e){return new Mt(e)}static min(){return new Mt(new Ft(0,0))}static max(){return new Mt(new Ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ku=-1;function TR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Mt.fromTimestamp(i===1e9?new Ft(t+1,0):new Ft(t,i));return new ro(l,ft.empty(),e)}function SR(s){return new ro(s.readTime,s.key,ku)}class ro{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ro(Mt.min(),ft.empty(),ku)}static max(){return new ro(Mt.max(),ft.empty(),ku)}}function CR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(s.documentKey,e.documentKey),t!==0?t:nn(s.largestBatchId,e.largestBatchId))}const NR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function lc(s){if(s.code!==we.FAILED_PRECONDITION||s.message!==NR)throw s;Xe("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let l=0,u=0,d=!1;e.forEach((g=>{++l,g.next((()=>{++u,d&&u===l&&t()}),(y=>i(y)))})),d=!0,u===l&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((l=>l?Ne.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,l)=>{const u=e.length,d=new Array(u);let g=0;for(let y=0;y<u;y++){const p=y;t(e[p]).next((b=>{d[p]=b,++g,g===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Ne(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function RR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cc(s){return s.name==="IndexedDbTransactionError"}class df{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const xy=-1;function hf(s){return s==null}function Hh(s){return s===0&&1/s==-1/0}function IR(s){return typeof s=="number"&&Number.isInteger(s)&&!Hh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const B_="";function MR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=q2(e)),e=DR(s.get(t),e);return q2(e)}function DR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case B_:t+="";break;default:t+=u}}return t}function q2(s){return s+B_+""}function $2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function fo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function z_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Xn{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new Xn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new Xn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uh(this.root,e,this.comparator,!1)}getReverseIterator(){return new uh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uh(this.root,e,this.comparator,!0)}}class uh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=l??Bs.EMPTY,this.right=u??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Bs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Bs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Et(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw Et(57766)}get value(){throw Et(16141)}get color(){throw Et(16727)}get left(){throw Et(29726)}get right(){throw Et(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Xn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new W2(this.data.getIterator())}getIteratorFrom(e){return new W2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class W2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Dr{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Dr([])}unionWith(e){let t=new Ts(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Dr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class F_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new F_("Invalid base64 string: "+u):u}})(e);return new Fs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const LR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function io(s){if(kn(!!s,39018),typeof s=="string"){let e=0;const t=LR.exec(s);if(kn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function ao(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}const H_="server_timestamp",q_="__type__",$_="__previous_value__",W_="__local_write_time__";function _y(s){return(s?.mapValue?.fields||{})[q_]?.stringValue===H_}function ff(s){const e=s.mapValue.fields[$_];return _y(e)?ff(e):e}function ju(s){const e=io(s.mapValue.fields[W_].timestampValue);return new Ft(e.seconds,e.nanos)}class OR{constructor(e,t,i,l,u,d,g,y,p,b,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=y,this.useFetchStreams=p,this.isUsingEmulator=b,this.apiKey=k}}const qh="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||qh}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===qh}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}function PR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new qe(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(s.options.projectId,e)}const G_="__type__",VR="__max__",dh={mapValue:{}},K_="__vector__",$h="value";function oo(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?_y(s)?4:BR(s)?9007199254740991:UR(s)?10:11:Et(28295,{value:s})}function Oi(s,e){if(s===e)return!0;const t=oo(s);if(t!==oo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ju(s).isEqual(ju(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=io(l.timestampValue),g=io(u.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return ao(l.bytesValue).isEqual(ao(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=hs(l.doubleValue),g=hs(u.doubleValue);return d===g?Hh(d)===Hh(g):isNaN(d)&&isNaN(g)}return!1})(s,e);case 9:return Ql(s.arrayValue.values||[],e.arrayValue.values||[],Oi);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},g=u.mapValue.fields||{};if($2(d)!==$2(g))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(g[y]===void 0||!Oi(d[y],g[y])))return!1;return!0})(s,e);default:return Et(52216,{left:s})}}function Tu(s,e){return(s.values||[]).find((t=>Oi(t,e)))!==void 0}function Xl(s,e){if(s===e)return 0;const t=oo(s),i=oo(e);if(t!==i)return nn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const g=hs(u.integerValue||u.doubleValue),y=hs(d.integerValue||d.doubleValue);return g<y?-1:g>y?1:g===y?0:isNaN(g)?isNaN(y)?0:-1:1})(s,e);case 3:return G2(s.timestampValue,e.timestampValue);case 4:return G2(ju(s),ju(e));case 5:return Np(s.stringValue,e.stringValue);case 6:return(function(u,d){const g=ao(u),y=ao(d);return g.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const g=u.split("/"),y=d.split("/");for(let p=0;p<g.length&&p<y.length;p++){const b=nn(g[p],y[p]);if(b!==0)return b}return nn(g.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const g=nn(hs(u.latitude),hs(d.latitude));return g!==0?g:nn(hs(u.longitude),hs(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return K2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const g=u.fields||{},y=d.fields||{},p=g[$h]?.arrayValue,b=y[$h]?.arrayValue,k=nn(p?.values?.length||0,b?.values?.length||0);return k!==0?k:K2(p,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===dh.mapValue&&d===dh.mapValue)return 0;if(u===dh.mapValue)return 1;if(d===dh.mapValue)return-1;const g=u.fields||{},y=Object.keys(g),p=d.fields||{},b=Object.keys(p);y.sort(),b.sort();for(let k=0;k<y.length&&k<b.length;++k){const T=Np(y[k],b[k]);if(T!==0)return T;const R=Xl(g[y[k]],p[b[k]]);if(R!==0)return R}return nn(y.length,b.length)})(s.mapValue,e.mapValue);default:throw Et(23264,{he:t})}}function G2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return nn(s,e);const t=io(s),i=io(e),l=nn(t.seconds,i.seconds);return l!==0?l:nn(t.nanos,i.nanos)}function K2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Xl(t[l],i[l]);if(u)return u}return nn(t.length,i.length)}function Jl(s){return Ap(s)}function Ap(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=io(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return ao(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ft.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Ap(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Ap(t.fields[d])}`;return l+"}"})(s.mapValue):Et(61005,{value:s})}function Ch(s){switch(oo(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(s);return e?16+Ch(e):16;case 5:return 2*s.stringValue.length;case 6:return ao(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Ch(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return fo(i.fields,((u,d)=>{l+=u.length+Ch(d)})),l})(s.mapValue);default:throw Et(13486,{value:s})}}function Y2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Rp(s){return!!s&&"integerValue"in s}function ky(s){return!!s&&"arrayValue"in s}function Q2(s){return!!s&&"nullValue"in s}function X2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Nh(s){return!!s&&"mapValue"in s}function UR(s){return(s?.mapValue?.fields||{})[G_]?.stringValue===K_}function fu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return fo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=fu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fu(s.arrayValue.values[t]);return e}return{...s}}function BR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===VR}class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fu(t)}setAll(e){let t=zs.emptyPath(),i={},l=[];e.forEach(((d,g)=>{if(!t.isImmediateParentOf(g)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=g.popLast()}d?i[g.lastSegment()]=fu(d):l.push(g.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Oi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Nh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){fo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new br(fu(this.value))}}function Y_(s){const e=[];return fo(s.fields,((t,i)=>{const l=new zs([t]);if(Nh(i)){const u=Y_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Dr(e)}class Qs{constructor(e,t,i,l,u,d,g){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=g}static newInvalidDocument(e){return new Qs(e,0,Mt.min(),Mt.min(),Mt.min(),br.empty(),0)}static newFoundDocument(e,t,i,l){return new Qs(e,1,t,Mt.min(),i,l,0)}static newNoDocument(e,t){return new Qs(e,2,t,Mt.min(),Mt.min(),br.empty(),0)}static newUnknownDocument(e,t){return new Qs(e,3,t,Mt.min(),Mt.min(),br.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function J2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=ft.comparator(ft.fromName(d.referenceValue),t.key):i=Xl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Z2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Oi(s.position[t],e.position[t]))return!1;return!0}class Su{constructor(e,t="asc"){this.field=e,this.dir=t}}function zR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Q_{}class ws extends Q_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new HR(e,t,i):t==="array-contains"?new WR(e,i):t==="in"?new GR(e,i):t==="not-in"?new KR(e,i):t==="array-contains-any"?new YR(e,i):new ws(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qR(e,i):new $R(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xl(t,this.value)):t!==null&&oo(this.value)===oo(t)&&this.matchesComparison(Xl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pi extends Q_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pi(e,t)}matches(e){return X_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function X_(s){return s.op==="and"}function J_(s){return FR(s)&&X_(s)}function FR(s){for(const e of s.filters)if(e instanceof pi)return!1;return!0}function Ip(s){if(s instanceof ws)return s.field.canonicalString()+s.op.toString()+Jl(s.value);if(J_(s))return s.filters.map((e=>Ip(e))).join(",");{const e=s.filters.map((t=>Ip(t))).join(",");return`${s.op}(${e})`}}function Z_(s,e){return s instanceof ws?(function(i,l){return l instanceof ws&&i.op===l.op&&i.field.isEqual(l.field)&&Oi(i.value,l.value)})(s,e):s instanceof pi?(function(i,l){return l instanceof pi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,g)=>u&&Z_(d,l.filters[g])),!0):!1})(s,e):void Et(19439)}function ek(s){return s instanceof ws?(function(t){return`${t.field.canonicalString()} ${t.op} ${Jl(t.value)}`})(s):s instanceof pi?(function(t){return t.op.toString()+" {"+t.getFilters().map(ek).join(" ,")+"}"})(s):"Filter"}class HR extends ws{constructor(e,t,i){super(e,t,i),this.key=ft.fromName(i.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class qR extends ws{constructor(e,t){super(e,"in",t),this.keys=tk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class $R extends ws{constructor(e,t){super(e,"not-in",t),this.keys=tk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function tk(s,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class WR extends ws{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ky(t)&&Tu(t.arrayValue,this.value)}}class GR extends ws{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Tu(this.value.arrayValue,t)}}class KR extends ws{constructor(e,t){super(e,"not-in",t)}matches(e){if(Tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Tu(this.value.arrayValue,t)}}class YR extends ws{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ky(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Tu(this.value.arrayValue,i)))}}class QR{constructor(e,t=null,i=[],l=[],u=null,d=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=g,this.Te=null}}function ew(s,e=null,t=[],i=[],l=null,u=null,d=null){return new QR(s,e,t,i,l,u,d)}function jy(s){const e=Pt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ip(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),hf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Jl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Jl(i))).join(",")),e.Te=t}return e.Te}function Ey(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!zR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Z_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Z2(s.startAt,e.startAt)&&Z2(s.endAt,e.endAt)}function Mp(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class uc{constructor(e,t=null,i=[],l=[],u=null,d="F",g=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=g,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function XR(s,e,t,i,l,u,d,g){return new uc(s,e,t,i,l,u,d,g)}function mf(s){return new uc(s)}function tw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function JR(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function nk(s){return s.collectionGroup!==null}function mu(s){const e=Pt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Ts(zs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Su(u,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Su(zs.keyField(),i))}return e.Ie}function Mi(s){const e=Pt(s);return e.Ee||(e.Ee=ZR(e,mu(s))),e.Ee}function ZR(s,e){if(s.limitType==="F")return ew(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Su(l.field,u)}));const t=s.endAt?new Wh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Wh(s.startAt.position,s.startAt.inclusive):null;return ew(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Dp(s,e){const t=s.filters.concat([e]);return new uc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function eI(s,e){const t=s.explicitOrderBy.concat([e]);return new uc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Gh(s,e,t){return new uc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function gf(s,e){return Ey(Mi(s),Mi(e))&&s.limitType===e.limitType}function sk(s){return`${jy(Mi(s))}|lt:${s.limitType}`}function Ul(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>ek(l))).join(", ")}]`),hf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Jl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Jl(l))).join(",")),`Target(${i})`})(Mi(s))}; limitType=${s.limitType})`}function pf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ft.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of mu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,g,y){const p=J2(d,g,y);return d.inclusive?p<=0:p<0})(i.startAt,mu(i),l)||i.endAt&&!(function(d,g,y){const p=J2(d,g,y);return d.inclusive?p>=0:p>0})(i.endAt,mu(i),l))})(s,e)}function tI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function rk(s){return(e,t)=>{let i=!1;for(const l of mu(s)){const u=nI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function nI(s,e,t){const i=s.field.isKeyField()?ft.comparator(e.key,t.key):(function(u,d,g){const y=d.data.field(u),p=g.data.field(u);return y!==null&&p!==null?Xl(y,p):Et(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Et(19790,{direction:s.dir})}}class Zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){fo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return z_(this.inner)}size(){return this.innerSize}}const sI=new Xn(ft.comparator);function va(){return sI}const ik=new Xn(ft.comparator);function lu(...s){let e=ik;for(const t of s)e=e.insert(t.key,t);return e}function ak(s){let e=ik;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Lo(){return gu()}function ok(){return gu()}function gu(){return new Zo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const rI=new Xn(ft.comparator),iI=new Ts(ft.comparator);function sn(...s){let e=iI;for(const t of s)e=e.add(t);return e}const aI=new Ts(nn);function oI(){return aI}function Ty(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hh(e)?"-0":e}}function lk(s){return{integerValue:""+s}}function ck(s,e){return IR(e)?lk(e):Ty(s,e)}class yf{constructor(){this._=void 0}}function lI(s,e,t){return s instanceof Cu?(function(l,u){const d={fields:{[q_]:{stringValue:H_},[W_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&_y(u)&&(u=ff(u)),u&&(d.fields[$_]=u),{mapValue:d}})(t,e):s instanceof Zl?dk(s,e):s instanceof ec?hk(s,e):(function(l,u){const d=uk(l,u),g=nw(d)+nw(l.Ae);return Rp(d)&&Rp(l.Ae)?lk(g):Ty(l.serializer,g)})(s,e)}function cI(s,e,t){return s instanceof Zl?dk(s,e):s instanceof ec?hk(s,e):t}function uk(s,e){return s instanceof Nu?(function(i){return Rp(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Cu extends yf{}class Zl extends yf{constructor(e){super(),this.elements=e}}function dk(s,e){const t=fk(e);for(const i of s.elements)t.some((l=>Oi(l,i)))||t.push(i);return{arrayValue:{values:t}}}class ec extends yf{constructor(e){super(),this.elements=e}}function hk(s,e){let t=fk(e);for(const i of s.elements)t=t.filter((l=>!Oi(l,i)));return{arrayValue:{values:t}}}class Nu extends yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nw(s){return hs(s.integerValue||s.doubleValue)}function fk(s){return ky(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class vf{constructor(e,t){this.field=e,this.transform=t}}function uI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Zl&&l instanceof Zl||i instanceof ec&&l instanceof ec?Ql(i.elements,l.elements,Oi):i instanceof Nu&&l instanceof Nu?Oi(i.Ae,l.Ae):i instanceof Cu&&l instanceof Cu})(s.transform,e.transform)}class dI{constructor(e,t){this.version=e,this.transformResults=t}}class ur{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ah(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class bf{}function mk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new wf(s.key,ur.none()):new zu(s.key,s.data,ur.none());{const t=s.data,i=br.empty();let l=new Ts(zs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new mo(s.key,i,new Dr(l.toArray()),ur.none())}}function hI(s,e,t){s instanceof zu?(function(l,u,d){const g=l.value.clone(),y=rw(l.fieldTransforms,u,d.transformResults);g.setAll(y),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):s instanceof mo?(function(l,u,d){if(!Ah(l.precondition,u))return void u.convertToUnknownDocument(d.version);const g=rw(l.fieldTransforms,u,d.transformResults),y=u.data;y.setAll(gk(l)),y.setAll(g),u.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function pu(s,e,t,i){return s instanceof zu?(function(u,d,g,y){if(!Ah(u.precondition,d))return g;const p=u.value.clone(),b=iw(u.fieldTransforms,y,d);return p.setAll(b),d.convertToFoundDocument(d.version,p).setHasLocalMutations(),null})(s,e,t,i):s instanceof mo?(function(u,d,g,y){if(!Ah(u.precondition,d))return g;const p=iw(u.fieldTransforms,y,d),b=d.data;return b.setAll(gk(u)),b.setAll(p),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,d,g){return Ah(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(s,e,t)}function fI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=uk(i.transform,l||null);u!=null&&(t===null&&(t=br.empty()),t.set(i.field,u))}return t||null}function sw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Ql(i,l,((u,d)=>uI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class zu extends bf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class mo extends bf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function gk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function rw(s,e,t){const i=new Map;kn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,g=e.data.field(u.field);i.set(u.field,cI(d,g,t[l]))}return i}function iw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,lI(u,d,e))}return i}class wf extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mI extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&hI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ok();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let g=this.applyToLocalView(d,u.mutatedFields);g=t.has(l.key)?null:g;const y=mk(d,g);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(Mt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),sn())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,((t,i)=>sw(t,i)))&&Ql(this.baseMutations,e.baseMutations,((t,i)=>sw(t,i)))}}class Sy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){kn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return rI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Sy(e,t,i,l)}}class pI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class yI{constructor(e,t){this.count=e,this.unchangedNames=t}}var bs,ln;function vI(s){switch(s){case we.OK:return Et(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return Et(15467,{code:s})}}function pk(s){if(s===void 0)return ya("GRPC error has no .code"),we.UNKNOWN;switch(s){case bs.OK:return we.OK;case bs.CANCELLED:return we.CANCELLED;case bs.UNKNOWN:return we.UNKNOWN;case bs.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case bs.INTERNAL:return we.INTERNAL;case bs.UNAVAILABLE:return we.UNAVAILABLE;case bs.UNAUTHENTICATED:return we.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case bs.NOT_FOUND:return we.NOT_FOUND;case bs.ALREADY_EXISTS:return we.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return we.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case bs.ABORTED:return we.ABORTED;case bs.OUT_OF_RANGE:return we.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return we.UNIMPLEMENTED;case bs.DATA_LOSS:return we.DATA_LOSS;default:return Et(39323,{code:s})}}(ln=bs||(bs={}))[ln.OK=0]="OK",ln[ln.CANCELLED=1]="CANCELLED",ln[ln.UNKNOWN=2]="UNKNOWN",ln[ln.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ln[ln.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ln[ln.NOT_FOUND=5]="NOT_FOUND",ln[ln.ALREADY_EXISTS=6]="ALREADY_EXISTS",ln[ln.PERMISSION_DENIED=7]="PERMISSION_DENIED",ln[ln.UNAUTHENTICATED=16]="UNAUTHENTICATED",ln[ln.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ln[ln.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ln[ln.ABORTED=10]="ABORTED",ln[ln.OUT_OF_RANGE=11]="OUT_OF_RANGE",ln[ln.UNIMPLEMENTED=12]="UNIMPLEMENTED",ln[ln.INTERNAL=13]="INTERNAL",ln[ln.UNAVAILABLE=14]="UNAVAILABLE",ln[ln.DATA_LOSS=15]="DATA_LOSS";function bI(){return new TextEncoder}const wI=new to([4294967295,4294967295],0);function aw(s){const e=bI().encode(s),t=new A_;return t.update(e),new Uint8Array(t.digest())}function ow(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new to([t,i],0),new to([l,u],0)]}class Cy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(i<0)throw new cu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=to.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(to.fromNumber(i)));return l.compare(wI)===1&&(l=new to([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Cy(u,l,t);return i.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Fu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new xf(Mt.min(),l,new Xn(nn),va(),sn())}}class Fu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Fu(i,t,sn(),sn(),sn())}}class Rh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class yk{constructor(e,t){this.targetId=e,this.Ce=t}}class vk{constructor(e,t,i=Fs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class lw{constructor(){this.ve=0,this.Fe=cw(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=sn(),t=sn(),i=sn();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Et(38017,{changeType:u})}})),new Fu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=cw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,kn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class xI{constructor(e){this.Ge=e,this.ze=new Map,this.je=va(),this.He=hh(),this.Je=hh(),this.Ze=new Xn(nn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Et(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Mp(u))if(i===0){const d=new ft(u.path);this.et(t,d,Qs.newNoDocument(d,Mt.min()))}else kn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const g=this.ut(e),y=g?this.ct(g,e,d):1;if(y!==0){this.it(t);const p=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,g;try{d=ao(i).toUint8Array()}catch(y){if(y instanceof F_)return Yl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{g=new Cy(d,l,u)}catch(y){return Yl(y instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return g.ge===0?null:g}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(g)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const g=this.ot(d);if(g){if(u.current&&Mp(g.target)){const y=new ft(g.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Qs.newNoDocument(y,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=sn();this.Je.forEach(((u,d)=>{let g=!0;d.forEachWhile((y=>{const p=this.ot(y);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new xf(e,t,this.Ze,this.je,i);return this.je=va(),this.He=hh(),this.Je=hh(),this.Ze=new Xn(nn),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new lw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(nn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(nn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Xe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function hh(){return new Xn(ft.comparator)}function cw(){return new Xn(ft.comparator)}const _I={asc:"ASCENDING",desc:"DESCENDING"},kI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jI={and:"AND",or:"OR"};class EI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lp(s,e){return s.useProto3Json||hf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function TI(s,e){return Kh(s,e.toTimestamp())}function Di(s){return kn(!!s,49232),Mt.fromTimestamp((function(t){const i=io(t);return new Ft(i.seconds,i.nanos)})(s))}function Ny(s,e){return Op(s,e).canonicalString()}function Op(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function wk(s){const e=Dn.fromString(s);return kn(Ek(e),10190,{key:e.toString()}),e}function Pp(s,e){return Ny(s.databaseId,e.path)}function qg(s,e){const t=wk(e);if(t.get(1)!==s.databaseId.projectId)throw new qe(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new qe(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ft(_k(t))}function xk(s,e){return Ny(s.databaseId,e)}function SI(s){const e=wk(s);return e.length===4?Dn.emptyPath():_k(e)}function Vp(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function _k(s){return kn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function uw(s,e,t){return{name:Pp(s,e),fields:t.value.mapValue.fields}}function CI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Et(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(p,b){return p.useProto3Json?(kn(b===void 0||typeof b=="string",58123),Fs.fromBase64String(b||"")):(kn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Fs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(p){const b=p.code===void 0?we.UNKNOWN:pk(p.code);return new qe(b,p.message||"")})(d);t=new vk(i,l,u,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=qg(s,i.document.name),u=Di(i.document.updateTime),d=i.document.createTime?Di(i.document.createTime):Mt.min(),g=new br({mapValue:{fields:i.document.fields}}),y=Qs.newFoundDocument(l,u,d,g),p=i.targetIds||[],b=i.removedTargetIds||[];t=new Rh(p,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=qg(s,i.document),u=i.readTime?Di(i.readTime):Mt.min(),d=Qs.newNoDocument(l,u),g=i.removedTargetIds||[];t=new Rh([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=qg(s,i.document),u=i.removedTargetIds||[];t=new Rh([],u,l,null)}else{if(!("filter"in e))return Et(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new yI(l,u),g=i.targetId;t=new yk(g,d)}}return t}function NI(s,e){let t;if(e instanceof zu)t={update:uw(s,e.key,e.value)};else if(e instanceof wf)t={delete:Pp(s,e.key)};else if(e instanceof mo)t={update:uw(s,e.key,e.data),updateMask:VI(e.fieldMask)};else{if(!(e instanceof mI))return Et(16599,{dt:e.type});t={verify:Pp(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const g=d.transform;if(g instanceof Cu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Zl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof ec)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof Nu)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw Et(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:TI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Et(27497)})(s,e.precondition)),t}function AI(s,e){return s&&s.length>0?(kn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Di(l.updateTime):Di(u);return d.isEqual(Mt.min())&&(d=Di(u)),new dI(d,l.transformResults||[])})(t,e)))):[]}function RI(s,e){return{documents:[xk(s,e.path)]}}function II(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=xk(s,l);const u=(function(p){if(p.length!==0)return jk(pi.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(p){if(p.length!==0)return p.map((b=>(function(T){return{field:Bl(T.field),direction:LI(T.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const g=Lp(s,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:l}}function MI(s){let e=SI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){kn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(k){const T=kk(k);return T instanceof pi&&J_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((T=>(function(q){return new Su(zl(q.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(q.direction))})(T)))})(t.orderBy));let g=null;t.limit&&(g=(function(k){let T;return T=typeof k=="object"?k.value:k,hf(T)?null:T})(t.limit));let y=null;t.startAt&&(y=(function(k){const T=!!k.before,R=k.values||[];return new Wh(R,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(k){const T=!k.before,R=k.values||[];return new Wh(R,T)})(t.endAt)),XR(e,l,d,u,g,"F",y,p)}function DI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Et(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function kk(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=zl(t.unaryFilter.field);return ws.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=zl(t.unaryFilter.field);return ws.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=zl(t.unaryFilter.field);return ws.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=zl(t.unaryFilter.field);return ws.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Et(61313);default:return Et(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ws.create(zl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Et(58110);default:return Et(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return pi.create(t.compositeFilter.filters.map((i=>kk(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Et(1026)}})(t.compositeFilter.op))})(s):Et(30097,{filter:s})}function LI(s){return _I[s]}function OI(s){return kI[s]}function PI(s){return jI[s]}function Bl(s){return{fieldPath:s.canonicalString()}}function zl(s){return zs.fromServerFormat(s.fieldPath)}function jk(s){return s instanceof ws?(function(t){if(t.op==="=="){if(X2(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(X2(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NOT_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bl(t.field),op:OI(t.op),value:t.value}}})(s):s instanceof pi?(function(t){const i=t.getFilters().map((l=>jk(l)));return i.length===1?i[0]:{compositeFilter:{op:PI(t.op),filters:i}}})(s):Et(54877,{filter:s})}function VI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ek(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Tk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Za{constructor(e,t,i,l,u=Mt.min(),d=Mt.min(),g=Fs.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=y}withSequenceNumber(e){return new Za(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class UI{constructor(e){this.yt=e}}function BI(s){const e=MI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Gh(e,e.limit,"L"):e}class zI{constructor(){this.Sn=new FI}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(ro.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(ro.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class FI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Dn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Dn.comparator)).toArray()}}const dw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sk=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(Sk,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class tc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new tc(0)}static ar(){return new tc(-1)}}const hw="LruGarbageCollector",HI=1048576;function fw([s,e],[t,i]){const l=nn(s,t);return l===0?nn(e,i):l}class qI{constructor(e){this.Pr=e,this.buffer=new Ts(fw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();fw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $I{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Xe(hw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cc(t)?Xe(hw,"Ignoring IndexedDB error during garbage collection: ",t):await lc(t)}await this.Ar(3e5)}))}}class WI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(df.ce);const i=new qI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(dw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,g,y,p;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,g=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(p=Date.now(),Vl()<=en.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(g-d)+`ms
	Removed ${u} targets in `+(y-g)+`ms
	Removed ${k} documents in `+(p-y)+`ms
Total Duration: ${p-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function GI(s,e){return new WI(s,e)}class KI{constructor(){this.changes=new Zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class YI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class QI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&pu(i.mutation,l,Dr.empty(),Ft.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=sn()){const l=Lo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=lu();return u.forEach(((g,y)=>{d=d.insert(g,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Lo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,sn())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,g)=>{t.set(d,g)}))}))}computeViews(e,t,i,l){let u=va();const d=gu(),g=(function(){return gu()})();return t.forEach(((y,p)=>{const b=i.get(p.key);l.has(p.key)&&(b===void 0||b.mutation instanceof mo)?u=u.insert(p.key,p):b!==void 0?(d.set(p.key,b.mutation.getFieldMask()),pu(b.mutation,p,b.mutation.getFieldMask(),Ft.now())):d.set(p.key,Dr.empty())})),this.recalculateAndSaveOverlays(e,u).next((y=>(y.forEach(((p,b)=>d.set(p,b))),t.forEach(((p,b)=>g.set(p,new YI(b,d.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const i=gu();let l=new Xn(((d,g)=>d-g)),u=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const g of d)g.keys().forEach((y=>{const p=t.get(y);if(p===null)return;let b=i.get(y)||Dr.empty();b=g.applyToLocalView(p,b),i.set(y,b);const k=(l.get(g.batchId)||sn()).add(y);l=l.insert(g.batchId,k)}))})).next((()=>{const d=[],g=l.getReverseIterator();for(;g.hasNext();){const y=g.getNext(),p=y.key,b=y.value,k=ok();b.forEach((T=>{if(!u.has(T)){const R=mk(t.get(T),i.get(T));R!==null&&k.set(T,R),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,p,k))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return JR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ne.resolve(Lo());let g=ku,y=u;return d.next((p=>Ne.forEach(p,((b,k)=>(g<k.largestBatchId&&(g=k.largestBatchId),u.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{y=y.insert(b,T)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,y,p,sn()))).next((b=>({batchId:g,changes:ak(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((i=>{let l=lu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=lu();return this.indexManager.getCollectionParents(e,u).next((g=>Ne.forEach(g,(y=>{const p=(function(k,T){return new uc(T,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,y.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,l).next((b=>{b.forEach(((k,T)=>{d=d.insert(k,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((y,p)=>{const b=p.getKey();d.get(b)===null&&(d=d.insert(b,Qs.newInvalidDocument(b)))}));let g=lu();return d.forEach(((y,p)=>{const b=u.get(y);b!==void 0&&pu(b.mutation,p,Dr.empty(),Ft.now()),pf(t,p)&&(g=g.insert(y,p))})),g}))}}class XI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Di(l.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:BI(l.bundledQuery),readTime:Di(l.readTime)}})(t)),Ne.resolve()}}class JI{constructor(){this.overlays=new Xn(ft.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Lo();return Ne.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const l=Lo(),u=t.length+1,d=new ft(t.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const y=g.getNext().value,p=y.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&y.largestBatchId>i&&l.set(y.getKey(),y)}return Ne.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Xn(((p,b)=>p-b));const d=this.overlays.getIterator();for(;d.hasNext();){const p=d.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let b=u.get(p.largestBatchId);b===null&&(b=Lo(),u=u.insert(p.largestBatchId,b)),b.set(p.getKey(),p)}}const g=Lo(),y=u.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((p,b)=>g.set(p,b))),!(g.size()>=l)););return Ne.resolve(g)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new pI(t,i));let u=this.Lr.get(t);u===void 0&&(u=sn(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class ZI{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class Ay{constructor(){this.kr=new Ts(Is.Kr),this.qr=new Ts(Is.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Is(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Is(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1);let u=sn();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Is(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Is{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ft.comparator(e.key,t.key)||nn(e.Hr,t.Hr)}static Ur(e,t){return nn(e.Hr,t.Hr)||ft.comparator(e.key,t.key)}}class eM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Is.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new gI(u,t,i,l);this.mutationQueue.push(d);for(const g of l)this.Jr=this.Jr.add(new Is(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ne.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?xy:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Is(t,0),l=new Is(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const g=this.Zr(d.Hr);u.push(g)})),Ne.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(nn);return t.forEach((l=>{const u=new Is(l,0),d=new Is(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(g=>{i=i.add(g.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ft.isDocumentKey(u)||(u=u.child(""));const d=new Is(new ft(u),0);let g=new Ts(nn);return this.Jr.forEachWhile((y=>{const p=y.key.path;return!!i.isPrefixOf(p)&&(p.length===l&&(g=g.add(y.Hr)),!0)}),d),Ne.resolve(this.Yr(g))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){kn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(l=>{const u=new Is(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Is(t,0),l=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class tM{constructor(e){this.ti=e,this.docs=(function(){return new Xn(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():Qs.newInvalidDocument(t))}getEntries(e,t){let i=va();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Qs.newInvalidDocument(l))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=va();const d=t.path,g=new ft(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(g);for(;y.hasNext();){const{key:p,value:{document:b}}=y.getNext();if(!d.isPrefixOf(p.path))break;p.path.length>d.length+1||CR(SR(b),i)<=0||(l.has(b.key)||pf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return Ne.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Et(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new nM(this)}getSize(e){return Ne.resolve(this.size)}}class nM extends KI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class sM{constructor(e){this.persistence=e,this.ri=new Zo((t=>jy(t)),Ey),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.ii=0,this.si=new Ay,this.targetCount=0,this.oi=tc._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new tc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),l++)})),Ne.waitFor(u).next((()=>l))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ne.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class Ck{constructor(e,t){this._i={},this.overlays={},this.ai=new df(0),this.ui=!1,this.ui=!0,this.ci=new ZI,this.referenceDelegate=e(this),this.li=new sM(this),this.indexManager=new zI,this.remoteDocumentCache=(function(l){return new tM(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new UI(t),this.Pi=new XI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new JI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new eM(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Xe("MemoryPersistence","Starting transaction:",e);const l=new rM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class rM extends AR{constructor(e){super(),this.currentSequenceNumber=e}}class Ry{constructor(e){this.persistence=e,this.Ri=new Ay,this.Ai=null}static Vi(e){return new Ry(e)}get di(){if(this.Ai)return this.Ai;throw Et(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const l=ft.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Mt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new Zo((i=>MR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=GI(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ne.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((g=>{g||(i++,u.removeEntry(d,Mt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ch(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ne.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Iy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=sn(),l=sn();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Iy(e,t.fromCache,i,l)}}class iM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class aM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return LC()?8:RR(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new iM;return this.ys(e,t,d).next((g=>{if(u.result=g,this.As)return this.ws(e,t,d,g.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Vl()<=en.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Ul(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(Vl()<=en.DEBUG&&Xe("QueryEngine","Query:",Ul(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Vl()<=en.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Ul(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mi(t))):Ne.resolve())}gs(e,t){if(tw(t))return Ne.resolve(null);let i=Mi(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=Mi(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=sn(...u);return this.fs.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,i).next((y=>{const p=this.bs(t,g);return this.Ss(t,p,d,y.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,p,t,y)}))))})))))}ps(e,t,i,l){return tw(t)||l.isEqual(Mt.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ne.resolve(null):(Vl()<=en.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Ul(t)),this.Ds(e,d,t,TR(l,ku)).next((g=>g)))}))}bs(e,t){let i=new Ts(rk(e));return t.forEach(((l,u)=>{pf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Vl()<=en.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Ul(t)),this.fs.getDocumentsMatchingQuery(e,t,ro.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const My="LocalStore",oM=3e8;class lM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Xn(nn),this.Fs=new Zo((u=>jy(u)),Ey),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function cM(s,e,t,i){return new lM(s,e,t,i)}async function Nk(s,e){const t=Pt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],g=[];let y=sn();for(const p of l){d.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}for(const p of u){g.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((p=>({Ns:p,removedBatchIds:d,addedBatchIds:g})))}))}))}function uM(s,e){const t=Pt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(g,y,p,b){const k=p.batch,T=k.keys();let R=Ne.resolve();return T.forEach((q=>{R=R.next((()=>b.getEntry(y,q))).next((G=>{const U=p.docVersions.get(q);kn(U!==null,48541),G.version.compareTo(U)<0&&(k.applyToRemoteDocument(G,p),G.isValidDocument()&&(G.setReadTime(p.commitVersion),b.addEntry(G)))}))})),R.next((()=>g.mutationQueue.removeMutationBatch(y,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(g){let y=sn();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(y=y.add(g.batch.mutations[p].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Ak(s){const e=Pt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function dM(s,e){const t=Pt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const g=[];e.targetChanges.forEach(((b,k)=>{const T=l.get(k);if(!T)return;g.push(t.li.removeMatchingKeys(u,b.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,k))));let R=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?R=R.withResumeToken(Fs.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),l=l.insert(k,R),(function(G,U,K){return G.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=oM?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(T,R,b)&&g.push(t.li.updateTargetData(u,R))}));let y=va(),p=sn();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),g.push(hM(u,d,e.documentUpdates).next((b=>{y=b.Bs,p=b.Ls}))),!i.isEqual(Mt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));g.push(b)}return Ne.waitFor(g).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,y,p))).next((()=>y))})).then((u=>(t.vs=l,u)))}function hM(s,e,t){let i=sn(),l=sn();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=va();return t.forEach(((g,y)=>{const p=u.get(g);y.isFoundDocument()!==p.isFoundDocument()&&(l=l.add(g)),y.isNoDocument()&&y.version.isEqual(Mt.min())?(e.removeEntry(g,y.readTime),d=d.insert(g,y)):!p.isValidDocument()||y.version.compareTo(p.version)>0||y.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(y),d=d.insert(g,y)):Xe(My,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function fM(s,e){const t=Pt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=xy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function mM(s,e){const t=Pt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ne.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Za(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Up(s,e,t){const i=Pt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!cc(d))throw d;Xe(My,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function mw(s,e,t){const i=Pt(s);let l=Mt.min(),u=sn();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,p,b){const k=Pt(y),T=k.Fs.get(b);return T!==void 0?Ne.resolve(k.vs.get(T)):k.li.getTargetData(p,b)})(i,d,Mi(e)).next((g=>{if(g)return l=g.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,g.targetId).next((y=>{u=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Mt.min(),t?u:sn()))).next((g=>(gM(i,tI(e),g),{documents:g,ks:u})))))}function gM(s,e,t){let i=s.Ms.get(e)||Mt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class gw{constructor(){this.activeTargetIds=oI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pM{constructor(){this.vo=new gw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new gw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class yM{Mo(e){}shutdown(){}}const pw="ConnectivityMonitor";class yw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Xe(pw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Xe(pw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let fh=null;function Bp(){return fh===null?fh=(function(){return 268435456+Math.round(2147483648*Math.random())})():fh++,"0x"+fh.toString(16)}const $g="RestConnection",vM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class bM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===qh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Bp(),g=this.Qo(e,t.toUriEncodedString());Xe($g,`Sending RPC '${e}' ${d}:`,g,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,u);const{host:p}=new URL(g),b=uo(p);return this.zo(e,g,y,i,b).then((k=>(Xe($g,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Yl($g,`RPC '${e}' ${d} failed with error: `,k,"url: ",g,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+oc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=vM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class wM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ks="WebChannelConnection",Zc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Wl extends bM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Wl.c_){const e=D_();Zc(e,M_.STAT_EVENT,(t=>{t.stat===Cp.PROXY?Xe(Ks,"STAT_EVENT: detected buffering proxy"):t.stat===Cp.NOPROXY&&Xe(Ks,"STAT_EVENT: detected no buffering proxy")})),Wl.c_=!0}}zo(e,t,i,l,u){const d=Bp();return new Promise(((g,y)=>{const p=new R_;p.setWithCredentials(!0),p.listenOnce(I_.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Sh.NO_ERROR:const k=p.getResponseJson();Xe(Ks,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),g(k);break;case Sh.TIMEOUT:Xe(Ks,`RPC '${e}' ${d} timed out`),y(new qe(we.DEADLINE_EXCEEDED,"Request time out"));break;case Sh.HTTP_ERROR:const T=p.getStatus();if(Xe(Ks,`RPC '${e}' ${d} failed with status:`,T,"response text:",p.getResponseText()),T>0){let R=p.getResponseJson();Array.isArray(R)&&(R=R[0]);const q=R?.error;if(q&&q.status&&q.message){const G=(function(K){const Y=K.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(Y)>=0?Y:we.UNKNOWN})(q.status);y(new qe(G,q.message))}else y(new qe(we.UNKNOWN,"Server responded with status "+p.getStatus()))}else y(new qe(we.UNAVAILABLE,"Connection failed."));break;default:Et(9055,{l_:e,streamId:d,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Xe(Ks,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Xe(Ks,`RPC '${e}' ${d} sending request:`,l),p.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Bp(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Go(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const p=u.join("");Xe(Ks,`Creating RPC '${e}' stream ${l}: ${p}`,g);const b=d.createWebChannel(p,g);this.I_(b);let k=!1,T=!1;const R=new wM({Ho:q=>{T?Xe(Ks,`Not sending because RPC '${e}' stream ${l} is closed:`,q):(k||(Xe(Ks,`Opening RPC '${e}' stream ${l} transport.`),b.open(),k=!0),Xe(Ks,`RPC '${e}' stream ${l} sending:`,q),b.send(q))},Jo:()=>b.close()});return Zc(b,ou.EventType.OPEN,(()=>{T||(Xe(Ks,`RPC '${e}' stream ${l} transport opened.`),R.i_())})),Zc(b,ou.EventType.CLOSE,(()=>{T||(T=!0,Xe(Ks,`RPC '${e}' stream ${l} transport closed`),R.o_(),this.E_(b))})),Zc(b,ou.EventType.ERROR,(q=>{T||(T=!0,Yl(Ks,`RPC '${e}' stream ${l} transport errored. Name:`,q.name,"Message:",q.message),R.o_(new qe(we.UNAVAILABLE,"The operation could not be completed")))})),Zc(b,ou.EventType.MESSAGE,(q=>{if(!T){const G=q.data[0];kn(!!G,16349);const U=G,K=U?.error||U[0]?.error;if(K){Xe(Ks,`RPC '${e}' stream ${l} received error:`,K);const Y=K.status;let ee=(function(ve){const I=bs[ve];if(I!==void 0)return pk(I)})(Y),ye=K.message;ee===void 0&&(ee=we.INTERNAL,ye="Unknown error status: "+Y+" with message "+K.message),T=!0,R.o_(new qe(ee,ye)),b.close()}else Xe(Ks,`RPC '${e}' stream ${l} received:`,G),R.__(G)}})),Wl.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return L_()}}function xM(s){return new Wl(s)}function Wg(){return typeof document<"u"?document:null}function _f(s){return new EI(s,!0)}Wl.c_=!1;class Rk{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Xe("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const vw="PersistentStream";class Ik{constructor(e,t,i,l,u,d,g,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(ya(t.toString()),ya("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new qe(we.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Xe(vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Xe(vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _M extends Ik{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=CI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Mt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Mt.min():d.readTime?Di(d.readTime):Mt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Vp(this.serializer),t.addTarget=(function(u,d){let g;const y=d.target;if(g=Mp(y)?{documents:RI(u,y)}:{query:II(u,y).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=bk(u,d.resumeToken);const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}else if(d.snapshotVersion.compareTo(Mt.min())>0){g.readTime=Kh(u,d.snapshotVersion.toTimestamp());const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const i=DI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Vp(this.serializer),t.removeTarget=e,this.K_(t)}}class kM extends Ik{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return kn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,kn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){kn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=AI(e.writeResults,e.commitTime),i=Di(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vp(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>NI(this.serializer,i)))};this.K_(t)}}class jM{}class EM extends jM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new qe(we.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Op(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new qe(we.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.jo(e,Op(t,i),l,d,g,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new qe(we.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function TM(s,e,t,i){return new EM(s,e,t,i)}class SM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ya(t),this.aa=!1):Xe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ho="RemoteStore";class CM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{el(this)&&(Xe(Ho,"Restarting streams for network reachability change."),await(async function(y){const p=Pt(y);p.Ea.add(4),await Hu(p),p.Va.set("Unknown"),p.Ea.delete(4),await kf(p)})(this))}))})),this.Va=new SM(i,l)}}async function kf(s){if(el(s))for(const e of s.Ra)await e(!0)}async function Hu(s){for(const e of s.Ra)await e(!1)}function Mk(s,e){const t=Pt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Py(t)?Oy(t):dc(t).O_()&&Ly(t,e))}function Dy(s,e){const t=Pt(s),i=dc(t);t.Ia.delete(e),i.O_()&&Dk(t,e),t.Ia.size===0&&(i.O_()?i.L_():el(t)&&t.Va.set("Unknown"))}function Ly(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Mt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dc(s).Z_(e)}function Dk(s,e){s.da.$e(e),dc(s).X_(e)}function Oy(s){s.da=new xI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),dc(s).start(),s.Va.ua()}function Py(s){return el(s)&&!dc(s).x_()&&s.Ia.size>0}function el(s){return Pt(s).Ea.size===0}function Lk(s){s.da=void 0}async function NM(s){s.Va.set("Online")}async function AM(s){s.Ia.forEach(((e,t)=>{Ly(s,e)}))}async function RM(s,e){Lk(s),Py(s)?(s.Va.ha(e),Oy(s)):s.Va.set("Unknown")}async function IM(s,e,t){if(s.Va.set("Online"),e instanceof vk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const g of u.targetIds)l.Ia.has(g)&&(await l.remoteSyncer.rejectListen(g,d),l.Ia.delete(g),l.da.removeTarget(g))})(s,e)}catch(i){Xe(Ho,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(s,i)}else if(e instanceof Rh?s.da.Xe(e):e instanceof yk?s.da.st(e):s.da.tt(e),!t.isEqual(Mt.min()))try{const i=await Ak(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const g=u.da.Tt(d);return g.targetChanges.forEach(((y,p)=>{if(y.resumeToken.approximateByteSize()>0){const b=u.Ia.get(p);b&&u.Ia.set(p,b.withResumeToken(y.resumeToken,d))}})),g.targetMismatches.forEach(((y,p)=>{const b=u.Ia.get(y);if(!b)return;u.Ia.set(y,b.withResumeToken(Fs.EMPTY_BYTE_STRING,b.snapshotVersion)),Dk(u,y);const k=new Za(b.target,y,p,b.sequenceNumber);Ly(u,k)})),u.remoteSyncer.applyRemoteEvent(g)})(s,t)}catch(i){Xe(Ho,"Failed to raise snapshot:",i),await Qh(s,i)}}async function Qh(s,e,t){if(!cc(e))throw e;s.Ea.add(1),await Hu(s),s.Va.set("Offline"),t||(t=()=>Ak(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Xe(Ho,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await kf(s)}))}function Ok(s,e){return e().catch((t=>Qh(s,t,e)))}async function jf(s){const e=Pt(s),t=lo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xy;for(;MM(e);)try{const l=await fM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,DM(e,l)}catch(l){await Qh(e,l)}Pk(e)&&Vk(e)}function MM(s){return el(s)&&s.Ta.length<10}function DM(s,e){s.Ta.push(e);const t=lo(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Pk(s){return el(s)&&!lo(s).x_()&&s.Ta.length>0}function Vk(s){lo(s).start()}async function LM(s){lo(s).ra()}async function OM(s){const e=lo(s);for(const t of s.Ta)e.ea(t.mutations)}async function PM(s,e,t){const i=s.Ta.shift(),l=Sy.from(i,e,t);await Ok(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await jf(s)}async function VM(s,e){e&&lo(s).Y_&&await(async function(i,l){if((function(d){return vI(d)&&d!==we.ABORTED})(l.code)){const u=i.Ta.shift();lo(i).B_(),await Ok(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await jf(i)}})(s,e),Pk(s)&&Vk(s)}async function bw(s,e){const t=Pt(s);t.asyncQueue.verifyOperationInProgress(),Xe(Ho,"RemoteStore received new credentials");const i=el(t);t.Ea.add(3),await Hu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kf(t)}async function UM(s,e){const t=Pt(s);e?(t.Ea.delete(2),await kf(t)):e||(t.Ea.add(2),await Hu(t),t.Va.set("Unknown"))}function dc(s){return s.ma||(s.ma=(function(t,i,l){const u=Pt(t);return u.sa(),new _M(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:NM.bind(null,s),Yo:AM.bind(null,s),t_:RM.bind(null,s),J_:IM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Py(s)?Oy(s):s.Va.set("Unknown")):(await s.ma.stop(),Lk(s))}))),s.ma}function lo(s){return s.fa||(s.fa=(function(t,i,l){const u=Pt(t);return u.sa(),new kM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:LM.bind(null,s),t_:VM.bind(null,s),ta:OM.bind(null,s),na:PM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await jf(s)):(await s.fa.stop(),s.Ta.length>0&&(Xe(Ho,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Vy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new ha,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,g=new Vy(e,t,d,l,u);return g.start(i),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uy(s,e){if(ya("AsyncQueue",`${e}: ${s}`),cc(s))return new qe(we.UNAVAILABLE,`${e}: ${s}`);throw s}class Gl{static emptySet(e){return new Gl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ft.comparator(t.key,i.key):(t,i)=>ft.comparator(t.key,i.key),this.keyedMap=lu(),this.sortedSet=new Xn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Gl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Gl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class ww{constructor(){this.ga=new Xn(ft.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Et(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class nc{constructor(e,t,i,l,u,d,g,y,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=y,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((g=>{d.push({type:0,doc:g})})),new nc(e,t,Gl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class BM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class zM{constructor(){this.queries=xw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Pt(t),u=l.queries;l.queries=xw(),u.forEach(((d,g)=>{for(const y of g.ba)y.onError(i)}))})(this,new qe(we.ABORTED,"Firestore shutting down"))}}function xw(){return new Zo((s=>sk(s)),gf)}async function By(s,e){const t=Pt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new BM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const g=Uy(d,`Initialization of query '${Ul(e.query)}' failed`);return void e.onError(g)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Fy(t)}async function zy(s,e){const t=Pt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function FM(s,e){const t=Pt(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const g of d.ba)g.Fa(l)&&(i=!0);d.wa=l}}i&&Fy(t)}function HM(s,e,t){const i=Pt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Fy(s){s.Ca.forEach((e=>{e.next()}))}var zp,_w;(_w=zp||(zp={})).Ma="default",_w.Cache="cache";class Hy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new nc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zp.Cache}}class Uk{constructor(e){this.key=e}}class Bk{constructor(e){this.key=e}}class qM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=sn(),this.mutatedKeys=sn(),this.eu=rk(e),this.tu=new Gl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new ww,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,g=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,p=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,k)=>{const T=l.get(b),R=pf(this.query,k)?k:null,q=!!T&&this.mutatedKeys.has(T.key),G=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let U=!1;T&&R?T.data.isEqual(R.data)?q!==G&&(i.track({type:3,doc:R}),U=!0):this.su(T,R)||(i.track({type:2,doc:R}),U=!0,(y&&this.eu(R,y)>0||p&&this.eu(R,p)<0)&&(g=!0)):!T&&R?(i.track({type:0,doc:R}),U=!0):T&&!R&&(i.track({type:1,doc:T}),U=!0,(y||p)&&(g=!0)),U&&(R?(d=d.add(R),u=G?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:g,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,k)=>(function(R,q){const G=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Et(20277,{Vt:U})}};return G(R)-G(q)})(b.type,k.type)||this.eu(b.doc,k.doc))),this.ou(i),l=l??!1;const g=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,p=y!==this.Xa;return this.Xa=y,d.length!==0||p?{snapshot:new nc(this.query,e.tu,u,d,e.mutatedKeys,y===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ww,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=sn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Bk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Uk(i))})),t}cu(e){this.Za=e.ks,this.Ya=sn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return nc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const qy="SyncEngine";class $M{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class WM{constructor(e){this.key=e,this.hu=!1}}class GM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Zo((g=>sk(g)),gf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Xn(ft.comparator),this.Au=new Map,this.Vu=new Ay,this.du={},this.mu=new Map,this.fu=tc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KM(s,e,t=!0){const i=Wk(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await zk(i,e,t,!0),l}async function YM(s,e){const t=Wk(s);await zk(t,e,!0,!1)}async function zk(s,e,t,i){const l=await mM(s.localStore,Mi(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let g;return i&&(g=await QM(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Mk(s.remoteStore,l),g}async function QM(s,e,t,i,l){s.pu=(k,T,R)=>(async function(G,U,K,Y){let ee=U.view.ru(K);ee.Ss&&(ee=await mw(G.localStore,U.query,!1).then((({documents:I})=>U.view.ru(I,ee))));const ye=Y&&Y.targetChanges.get(U.targetId),ke=Y&&Y.targetMismatches.get(U.targetId)!=null,ve=U.view.applyChanges(ee,G.isPrimaryClient,ye,ke);return jw(G,U.targetId,ve.au),ve.snapshot})(s,k,T,R);const u=await mw(s.localStore,e,!0),d=new qM(e,u.ks),g=d.ru(u.documents),y=Fu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),p=d.applyChanges(g,s.isPrimaryClient,y);jw(s,t,p.au);const b=new $M(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function XM(s,e,t){const i=Pt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!gf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Up(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Dy(i.remoteStore,l.targetId),Fp(i,l.targetId)})).catch(lc)):(Fp(i,l.targetId),await Up(i.localStore,l.targetId,!0))}async function JM(s,e){const t=Pt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Dy(t.remoteStore,i.targetId))}async function ZM(s,e,t){const i=a6(s);try{const l=await(function(d,g){const y=Pt(d),p=Ft.now(),b=g.reduce(((R,q)=>R.add(q.key)),sn());let k,T;return y.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let q=va(),G=sn();return y.xs.getEntries(R,b).next((U=>{q=U,q.forEach(((K,Y)=>{Y.isValidDocument()||(G=G.add(K))}))})).next((()=>y.localDocuments.getOverlayedDocuments(R,q))).next((U=>{k=U;const K=[];for(const Y of g){const ee=fI(Y,k.get(Y.key).overlayedDocument);ee!=null&&K.push(new mo(Y.key,ee,Y_(ee.value.mapValue),ur.exists(!0)))}return y.mutationQueue.addMutationBatch(R,p,K,g)})).next((U=>{T=U;const K=U.applyToLocalDocumentSet(k,G);return y.documentOverlayCache.saveOverlays(R,U.batchId,K)}))})).then((()=>({batchId:T.batchId,changes:ak(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,g,y){let p=d.du[d.currentUser.toKey()];p||(p=new Xn(nn)),p=p.insert(g,y),d.du[d.currentUser.toKey()]=p})(i,l.batchId,t),await qu(i,l.changes),await jf(i.remoteStore)}catch(l){const u=Uy(l,"Failed to persist write");t.reject(u)}}async function Fk(s,e){const t=Pt(s);try{const i=await dM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(kn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?kn(d.hu,14607):l.removedDocuments.size>0&&(kn(d.hu,42227),d.hu=!1))})),await qu(t,i,e)}catch(i){await lc(i)}}function kw(s,e,t){const i=Pt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const g=d.view.va(e);g.snapshot&&l.push(g.snapshot)})),(function(d,g){const y=Pt(d);y.onlineState=g;let p=!1;y.queries.forEach(((b,k)=>{for(const T of k.ba)T.va(g)&&(p=!0)})),p&&Fy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function e6(s,e,t){const i=Pt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Xn(ft.comparator);d=d.insert(u,Qs.newNoDocument(u,Mt.min()));const g=sn().add(u),y=new xf(Mt.min(),new Map,new Xn(nn),d,g);await Fk(i,y),i.Ru=i.Ru.remove(u),i.Au.delete(e),$y(i)}else await Up(i.localStore,e,!1).then((()=>Fp(i,e,t))).catch(lc)}async function t6(s,e){const t=Pt(s),i=e.batch.batchId;try{const l=await uM(t.localStore,e);qk(t,i,null),Hk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await qu(t,l)}catch(l){await lc(l)}}async function n6(s,e,t){const i=Pt(s);try{const l=await(function(d,g){const y=Pt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let b;return y.mutationQueue.lookupMutationBatch(p,g).next((k=>(kn(k!==null,37113),b=k.keys(),y.mutationQueue.removeMutationBatch(p,k)))).next((()=>y.mutationQueue.performConsistencyCheck(p))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(p,b,g))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,b))).next((()=>y.localDocuments.getDocuments(p,b)))}))})(i.localStore,e);qk(i,e,t),Hk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await qu(i,l)}catch(l){await lc(l)}}function Hk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function qk(s,e,t){const i=Pt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Fp(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||$k(s,i)}))}function $k(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Dy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),$y(s))}function jw(s,e,t){for(const i of t)i instanceof Uk?(s.Vu.addReference(i.key,e),s6(s,i)):i instanceof Bk?(Xe(qy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||$k(s,i.key)):Et(19791,{wu:i})}function s6(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Xe(qy,"New document in limbo: "+t),s.Eu.add(i),$y(s))}function $y(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ft(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new WM(t)),s.Ru=s.Ru.insert(t,i),Mk(s.remoteStore,new Za(Mi(mf(t.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function qu(s,e,t){const i=Pt(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((g,y)=>{d.push(i.pu(y,e,t).then((p=>{if((p||t)&&i.isPrimaryClient){const b=p?!p.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(p){l.push(p);const b=Iy.Es(y.targetId,p);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,p){const b=Pt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ne.forEach(p,(T=>Ne.forEach(T.Ts,(R=>b.persistence.referenceDelegate.addReference(k,T.targetId,R))).next((()=>Ne.forEach(T.Is,(R=>b.persistence.referenceDelegate.removeReference(k,T.targetId,R)))))))))}catch(k){if(!cc(k))throw k;Xe(My,"Failed to update sequence numbers: "+k)}for(const k of p){const T=k.targetId;if(!k.fromCache){const R=b.vs.get(T),q=R.snapshotVersion,G=R.withLastLimboFreeSnapshotVersion(q);b.vs=b.vs.insert(T,G)}}})(i.localStore,u))}async function r6(s,e){const t=Pt(s);if(!t.currentUser.isEqual(e)){Xe(qy,"User change. New user:",e.toKey());const i=await Nk(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((g=>{g.forEach((y=>{y.reject(new qe(we.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await qu(t,i.Ns)}}function i6(s,e){const t=Pt(s),i=t.Au.get(e);if(i&&i.hu)return sn().add(i.key);{let l=sn();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const g=t.Tu.get(d);l=l.unionWith(g.view.nu)}return l}}function Wk(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=i6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e6.bind(null,e),e.Pu.J_=FM.bind(null,e.eventManager),e.Pu.yu=HM.bind(null,e.eventManager),e}function a6(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n6.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return cM(this.persistence,new aM,e.initialUser,this.serializer)}Cu(e){return new Ck(Ry.Vi,this.serializer)}Du(e){return new pM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class o6 extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){kn(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new $I(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new Ck((i=>Yh.Vi(i,t)),this.serializer)}}class Hp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=r6.bind(null,this.syncEngine),await UM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new zM})()}createDatastore(e){const t=_f(e.databaseInfo.databaseId),i=xM(e.databaseInfo);return TM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,g){return new CM(i,l,u,d,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>kw(this.syncEngine,t,0)),(function(){return yw.v()?new yw:new yM})())}createSyncEngine(e,t){return(function(l,u,d,g,y,p,b){const k=new GM(l,u,d,g,y,p);return b&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Pt(t);Xe(Ho,"RemoteStore shutting down."),i.Ea.add(5),await Hu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hp.provider={build:()=>new Hp};class Wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ya("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const co="FirestoreClient";class l6{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Ys.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Xe(co,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Xe(co,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ha;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Uy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gg(s,e){s.asyncQueue.verifyOperationInProgress(),Xe(co,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Nk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Ew(s,e){s.asyncQueue.verifyOperationInProgress();const t=await c6(s);Xe(co,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>bw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>bw(e.remoteStore,l))),s._onlineComponents=e}async function c6(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Xe(co,"Using user provided OfflineComponentProvider");try{await Gg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===we.FAILED_PRECONDITION||l.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Yl("Error using user provided cache. Falling back to memory cache: "+t),await Gg(s,new Xh)}}else Xe(co,"Using default OfflineComponentProvider"),await Gg(s,new o6(void 0));return s._offlineComponents}async function Gk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Xe(co,"Using user provided OnlineComponentProvider"),await Ew(s,s._uninitializedComponentsProvider._online)):(Xe(co,"Using default OnlineComponentProvider"),await Ew(s,new Hp))),s._onlineComponents}function u6(s){return Gk(s).then((e=>e.syncEngine))}async function Jh(s){const e=await Gk(s),t=e.eventManager;return t.onListen=KM.bind(null,e.syncEngine),t.onUnlisten=XM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=YM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=JM.bind(null,e.syncEngine),t}function d6(s,e,t,i){const l=new Wy(i),u=new Hy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>By(await Jh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>zy(await Jh(s),u)))}}function h6(s,e,t={}){const i=new ha;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Wy({next:T=>{b.Nu(),d.enqueueAndForget((()=>zy(u,k)));const R=T.docs.has(g);!R&&T.fromCache?p.reject(new qe(we.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&T.fromCache&&y&&y.source==="server"?p.reject(new qe(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),k=new Hy(mf(g.path),b,{includeMetadataChanges:!0,Ka:!0});return By(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function f6(s,e,t={}){const i=new ha;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Wy({next:T=>{b.Nu(),d.enqueueAndForget((()=>zy(u,k))),T.fromCache&&y.source==="server"?p.reject(new qe(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),k=new Hy(g,b,{includeMetadataChanges:!0,Ka:!0});return By(u,k)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function m6(s,e){const t=new ha;return s.asyncQueue.enqueueAndForget((async()=>ZM(await u6(s),e,t))),t.promise}function Kk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const g6="ComponentProvider",Tw=new Map;function p6(s,e,t,i,l){return new OR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Kk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Yk="firestore.googleapis.com",Sw=!0;class Cw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new qe(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Yk,this.ssl=Sw}else this.host=e.host,this.ssl=e.ssl??Sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HI)throw new qe(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Kk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new mR;switch(i.type){case"firstParty":return new vR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new qe(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Tw.get(t);i&&(Xe(g6,"Removing Datastore"),Tw.delete(t),i.terminate())})(this),Promise.resolve()}}function y6(s,e,t,i={}){s=cr(s,Ef);const l=uo(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},g=`${e}:${t}`;l&&(iy(`https://${g}`),ay("Firestore",!0)),u.host!==Yk&&u.host!==g&&Yl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...u,host:g,ssl:l,emulatorOptions:i};if(!ma(y,d)&&(s._setSettings(y),i.mockUserToken)){let p,b;if(typeof i.mockUserToken=="string")p=i.mockUserToken,b=Ys.MOCK_USER;else{p=Fx(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new qe(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ys(k)}s._authCredentials=new gR(new P_(p,b))}}class xa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new xa(this.firestore,e,this._query)}}class rs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new no(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Bu(t,rs._jsonSchema))return new rs(e,i||null,new ft(Dn.fromString(t.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:ks("string",rs._jsonSchemaVersion),referencePath:ks("string")};class no extends xa{constructor(e,t,i){super(e,t,mf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new ft(e))}withConverter(e){return new no(this.firestore,e,this._path)}}function dt(s,e,...t){if(s=jn(s),V_("collection","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return z2(i),new no(s,null,i)}{if(!(s instanceof rs||s instanceof no))throw new qe(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return z2(i),new no(s.firestore,null,i)}}function Be(s,e,...t){if(s=jn(s),arguments.length===1&&(e=wy.newId()),V_("doc","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return B2(i),new rs(s,null,new ft(i))}{if(!(s instanceof rs||s instanceof no))throw new qe(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return B2(i),new rs(s.firestore,s instanceof no?s.converter:null,new ft(i))}}const Nw="AsyncQueue";class Aw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rk(this,"async_queue_retry"),this._c=()=>{const i=Wg();i&&Xe(Nw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ha;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!cc(e))throw e;Xe(Nw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ya("INTERNAL UNHANDLED ERROR: ",Rw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Vy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Et(47125,{Pc:Rw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Rw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Pi extends Ef{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Aw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Aw(e),this._firestoreClient=void 0,await e}}}function v6(s,e){const t=typeof s=="object"?s:Lu(),i=typeof s=="string"?s:qh,l=Xo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Ux("firestore");u&&y6(l,...u)}return l}function $u(s){if(s._terminated)throw new qe(we.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||b6(s),s._firestoreClient}function b6(s){const e=s._freezeSettings(),t=p6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new l6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xr(Fs.fromBase64String(e))}catch(t){throw new qe(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Xr(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Xr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Bu(e,Xr._jsonSchema))return Xr.fromBase64String(e.bytes)}}Xr._jsonSchemaVersion="firestore/bytes/1.0",Xr._jsonSchema={type:ks("string",Xr._jsonSchemaVersion),bytes:ks("string")};class Tf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new qe(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tl{constructor(e){this._methodName=e}}class Li{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new qe(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new qe(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Li._jsonSchemaVersion}}static fromJSON(e){if(Bu(e,Li._jsonSchema))return new Li(e.latitude,e.longitude)}}Li._jsonSchemaVersion="firestore/geoPoint/1.0",Li._jsonSchema={type:ks("string",Li._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};class fi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Bu(e,fi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fi(e.vectorValues);throw new qe(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fi._jsonSchemaVersion="firestore/vectorValue/1.0",fi._jsonSchema={type:ks("string",fi._jsonSchemaVersion),vectorValues:ks("object")};const w6=/^__.*__$/;class x6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new mo(e,this.data,this.fieldMask,t,this.fieldTransforms):new zu(e,this.data,t,this.fieldTransforms)}}class Qk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new mo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Et(40011,{dataSource:s})}}class Sf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Xk(this.dataSource)&&w6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class _6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_f(e)}createContext(e,t,i,l=!1){return new Sf({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wu(s){const e=s._freezeSettings(),t=_f(s._databaseId);return new _6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Gy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Jy("Data must be an object, but it was:",d,i);const g=tj(i,d);let y,p;if(u.merge)y=new Dr(d.fieldMask),p=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const k of u.mergeFields){const T=qo(e,k,t);if(!d.contains(T))throw new qe(we.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);rj(b,T)||b.push(T)}y=new Dr(b),p=d.fieldTransforms.filter((k=>y.covers(k.field)))}else y=null,p=d.fieldTransforms;return new x6(new br(g),y,p)}class Cf extends tl{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}function Jk(s,e,t){return new Sf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ky extends tl{_toFieldTransform(e){return new vf(e.path,new Cu)}isEqual(e){return e instanceof Ky}}class Yy extends tl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Jk(this,e,!0),i=this.Ac.map((u=>nl(u,t))),l=new Zl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Yy&&ma(this.Ac,e.Ac)}}class Qy extends tl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Jk(this,e,!0),i=this.Ac.map((u=>nl(u,t))),l=new ec(i);return new vf(e.path,l)}isEqual(e){return e instanceof Qy&&ma(this.Ac,e.Ac)}}class Xy extends tl{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Nu(e.serializer,ck(e.serializer,this.Vc));return new vf(e.path,t)}isEqual(e){return e instanceof Xy&&this.Vc===e.Vc}}function Zk(s,e,t,i){const l=s.createContext(1,e,t);Jy("Data must be an object, but it was:",l,i);const u=[],d=br.empty();fo(i,((y,p)=>{const b=sj(e,y,t);p=jn(p);const k=l.childContextForFieldPath(b);if(p instanceof Cf)u.push(b);else{const T=nl(p,k);T!=null&&(u.push(b),d.set(b,T))}}));const g=new Dr(u);return new Qk(d,g,l.fieldTransforms)}function ej(s,e,t,i,l,u){const d=s.createContext(1,e,t),g=[qo(e,i,t)],y=[l];if(u.length%2!=0)throw new qe(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)g.push(qo(e,u[T])),y.push(u[T+1]);const p=[],b=br.empty();for(let T=g.length-1;T>=0;--T)if(!rj(p,g[T])){const R=g[T];let q=y[T];q=jn(q);const G=d.childContextForFieldPath(R);if(q instanceof Cf)p.push(R);else{const U=nl(q,G);U!=null&&(p.push(R),b.set(R,U))}}const k=new Dr(p);return new Qk(b,k,d.fieldTransforms)}function k6(s,e,t,i=!1){return nl(t,s.createContext(i?4:3,e))}function nl(s,e){if(nj(s=jn(s)))return Jy("Unsupported field value:",e,s),tj(s,e);if(s instanceof tl)return(function(i,l){if(!Xk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const g of i){let y=nl(g,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),u.push(y),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=jn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ck(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Ft.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ft){const u=new Ft(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Li)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Xr)return{bytesValue:bk(l.serializer,i._byteString)};if(i instanceof rs){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ny(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof fi)return(function(d,g){const y=d instanceof fi?d.toArray():d;return{mapValue:{fields:{[G_]:{stringValue:K_},[$h]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw g.createError("VectorValues must only contain numeric values.");return Ty(g.serializer,b)}))}}}}}})(i,l);if(Tk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${uf(i)}`)})(s,e)}function tj(s,e){const t={};return z_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fo(s,((i,l)=>{const u=nl(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function nj(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Ft||s instanceof Li||s instanceof Xr||s instanceof rs||s instanceof tl||s instanceof fi||Tk(s))}function Jy(s,e,t){if(!nj(t)||!U_(t)){const i=uf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function qo(s,e,t){if((e=jn(e))instanceof Tf)return e._internalPath;if(typeof e=="string")return sj(s,e);throw Zh("Field path arguments must be of type string or ",s,!1,void 0,t)}const j6=new RegExp("[~\\*/\\[\\]]");function sj(s,e,t){if(e.search(j6)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Tf(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Zh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let y="";return(u||d)&&(y+=" (found",u&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new qe(we.INVALID_ARGUMENT,g+s+y)}function rj(s,e){return s.some((t=>t.isEqual(e)))}class E6{convertValue(e,t="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ao(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return fo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new fi(t)}convertGeoPoint(e){return new Li(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ju(e));default:return null}}convertTimestamp(e){const t=io(e);return new Ft(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);kn(Ek(i),9688,{name:e});const l=new Eu(i.get(1),i.get(3)),u=new ft(i.popFirst(5));return l.isEqual(t)||ya(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Zy extends E6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rs(this.firestore,null,t)}}function xs(){return new Ky("serverTimestamp")}function T6(...s){return new Yy("arrayUnion",s)}function S6(...s){return new Qy("arrayRemove",s)}function hi(s){return new Xy("increment",s)}const Iw="@firebase/firestore",Mw="4.10.0";function Dw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class ij{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new C6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class C6 extends ij{data(){return super.data()}}function aj(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new qe(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e0{}class t0 extends e0{}function tn(s,e,...t){let i=[];e instanceof e0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((y=>y instanceof n0)).length,g=u.filter((y=>y instanceof Nf)).length;if(d>1||d>0&&g>0)throw new qe(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Nf extends t0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return oj(e._query,t),new xa(e.firestore,e.converter,Dp(e._query,t))}_parse(e){const t=Wu(e.firestore);return(function(u,d,g,y,p,b,k){let T;if(p.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new qe(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Ow(k,b);const q=[];for(const G of k)q.push(Lw(y,u,G));T={arrayValue:{values:q}}}else T=Lw(y,u,k)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Ow(k,b),T=k6(g,d,k,b==="in"||b==="not-in");return ws.create(p,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function kt(s,e,t){const i=e,l=qo("where",s);return Nf._create(l,i,t)}class n0 extends e0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:pi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const g=u.getFlattenedFilters();for(const y of g)oj(d,y),d=Dp(d,y)})(e._query,t),new xa(e.firestore,e.converter,Dp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class s0 extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new s0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new qe(we.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new qe(we.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Su(u,d)})(e._query,this._field,this._direction);return new xa(e.firestore,e.converter,eI(e._query,t))}}function $o(s,e="asc"){const t=e,i=qo("orderBy",s);return s0._create(i,t)}class r0 extends t0{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new r0(e,t,i)}_apply(e){return new xa(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function Wo(s){return ER("limit",s),r0._create("limit",s,"F")}function Lw(s,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new qe(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nk(e)&&t.indexOf("/")!==-1)throw new qe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!ft.isDocumentKey(i))throw new qe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Y2(s,new ft(i))}if(t instanceof rs)return Y2(s,t._key);throw new qe(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Ow(s,e){if(!Array.isArray(s)||s.length===0)throw new qe(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oj(s,e){const t=(function(l,u){for(const d of l)for(const g of d.getFlattenedFilters())if(u.indexOf(g.op)>=0)return g.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new qe(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function i0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class uu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Po extends ij{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Po._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Po._jsonSchemaVersion="firestore/documentSnapshot/1.0",Po._jsonSchema={type:ks("string",Po._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class Ih extends Po{data(e={}){return super.data(e)}}class Vo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new uu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ih(this._firestore,this._userDataWriter,i.key,i,new uu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new qe(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((g=>{const y=new Ih(l._firestore,l._userDataWriter,g.doc.key,g.doc,new uu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);return g.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((g=>u||g.type!==3)).map((g=>{const y=new Ih(l._firestore,l._userDataWriter,g.doc.key,g.doc,new uu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);let p=-1,b=-1;return g.type!==0&&(p=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:N6(g.type),doc:y,oldIndex:p,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function N6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Et(61501,{type:s})}}Vo._jsonSchemaVersion="firestore/querySnapshot/1.0",Vo._jsonSchema={type:ks("string",Vo._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class A6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wu(e)}set(e,t,i){this._verifyNotCommitted();const l=Kg(e,this._firestore),u=i0(l.converter,t,i),d=Gy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,ur.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Kg(e,this._firestore);let d;return d=typeof(t=jn(t))=="string"||t instanceof Tf?ej(this._dataReader,"WriteBatch.update",u._key,t,i,l):Zk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,ur.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kg(e,this._firestore);return this._mutations=this._mutations.concat(new wf(t._key,ur.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new qe(we.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kg(s,e){if((s=jn(s)).firestore!==e)throw new qe(we.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function _s(s){s=cr(s,rs);const e=cr(s.firestore,Pi),t=$u(e);return h6(t,s._key).then((i=>cj(e,s,i)))}function Wt(s){s=cr(s,xa);const e=cr(s.firestore,Pi),t=$u(e),i=new Zy(e);return aj(s._query),f6(t,s._query).then((l=>new Vo(e,i,s,l)))}function ss(s,e,t){s=cr(s,rs);const i=cr(s.firestore,Pi),l=i0(s.converter,e,t),u=Wu(i);return Gu(i,[Gy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,ur.none())])}function zn(s,e,t,...i){s=cr(s,rs);const l=cr(s.firestore,Pi),u=Wu(l);let d;return d=typeof(e=jn(e))=="string"||e instanceof Tf?ej(u,"updateDoc",s._key,e,t,i):Zk(u,"updateDoc",s._key,e),Gu(l,[d.toMutation(s._key,ur.exists(!0))])}function ar(s){return Gu(cr(s.firestore,Pi),[new wf(s._key,ur.none())])}function or(s,e){const t=cr(s.firestore,Pi),i=Be(s),l=i0(s.converter,e),u=Wu(s.firestore);return Gu(t,[Gy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,ur.exists(!1))]).then((()=>i))}function lj(s,...e){s=jn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Dw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dw(e[i])){const p=e[i];e[i]=p.next?.bind(p),e[i+1]=p.error?.bind(p),e[i+2]=p.complete?.bind(p)}let u,d,g;if(s instanceof rs)d=cr(s.firestore,Pi),g=mf(s._key.path),u={next:p=>{e[i]&&e[i](cj(d,s,p))},error:e[i+1],complete:e[i+2]};else{const p=cr(s,xa);d=cr(p.firestore,Pi),g=p._query;const b=new Zy(d);u={next:k=>{e[i]&&e[i](new Vo(d,b,p,k))},error:e[i+1],complete:e[i+2]},aj(s._query)}const y=$u(d);return d6(y,g,l,u)}function Gu(s,e){const t=$u(s);return m6(t,e)}function cj(s,e,t){const i=t.docs.get(e._key),l=new Zy(s);return new Po(s,l,e._key,i,new uu(t.hasPendingWrites,t.fromCache),e.converter)}function Pw(s){return s=cr(s,Pi),$u(s),new A6(s,(e=>Gu(s,e)))}(function(e,t=!0){fR(Jo),mi(new ei("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),g=new Pi(new pR(i.getProvider("auth-internal")),new bR(d,i.getProvider("app-check-internal")),PR(d,l),d);return u={useFetchStreams:t,...u},g._setSettings(u),g}),"PUBLIC").setMultipleInstances(!0)),wr(Iw,Mw,e),wr(Iw,Mw,"esm2020")})();var R6="firebase",I6="12.8.0";wr(R6,I6,"app");const uj="firebasestorage.googleapis.com",dj="storageBucket",M6=120*1e3,D6=600*1e3;class as extends vi{constructor(e,t,i=0){super(Yg(e),`Firebase Storage: ${t} (${Yg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,as.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var is;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(is||(is={}));function Yg(s){return"storage/"+s}function a0(){const s="An unknown error occurred, please check the error payload for server response.";return new as(is.UNKNOWN,s)}function L6(s){return new as(is.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function O6(s){return new as(is.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function P6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new as(is.UNAUTHENTICATED,s)}function V6(){return new as(is.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function U6(s){return new as(is.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function B6(){return new as(is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function z6(){return new as(is.CANCELED,"User canceled the upload/download.")}function F6(s){return new as(is.INVALID_URL,"Invalid URL '"+s+"'.")}function H6(s){return new as(is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function q6(){return new as(is.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dj+"' property when initializing the app?")}function $6(){return new as(is.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function W6(){return new as(is.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function G6(s){return new as(is.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qp(s){return new as(is.INVALID_ARGUMENT,s)}function hj(){return new as(is.APP_DELETED,"The Firebase app was deleted.")}function K6(s){return new as(is.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function yu(s,e){return new as(is.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function eu(s){throw new as(is.INTERNAL_ERROR,"Internal error: "+s)}class lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=lr.makeFromUrl(e,t)}catch{return new lr(e,"")}if(i.path==="")return i;throw H6(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ye){ye.path.charAt(ye.path.length-1)==="/"&&(ye.path_=ye.path_.slice(0,-1))}const d="(/(.*))?$",g=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function p(ye){ye.path_=decodeURIComponent(ye.path)}const b="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",R=new RegExp(`^https?://${k}/${b}/b/${l}/o${T}`,"i"),q={bucket:1,path:3},G=t===uj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",K=new RegExp(`^https?://${G}/${l}/${U}`,"i"),ee=[{regex:g,indices:y,postModify:u},{regex:R,indices:q,postModify:p},{regex:K,indices:{bucket:1,path:2},postModify:p}];for(let ye=0;ye<ee.length;ye++){const ke=ee[ye],ve=ke.regex.exec(e);if(ve){const I=ve[ke.indices.bucket];let E=ve[ke.indices.path];E||(E=""),i=new lr(I,E),ke.postModify(i);break}}if(i==null)throw F6(e);return i}}class Y6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Q6(s,e,t){let i=1,l=null,u=null,d=!1,g=0;function y(){return g===2}let p=!1;function b(...U){p||(p=!0,e.apply(null,U))}function k(U){l=setTimeout(()=>{l=null,s(R,y())},U)}function T(){u&&clearTimeout(u)}function R(U,...K){if(p){T();return}if(U){T(),b.call(null,U,...K);return}if(y()||d){T(),b.call(null,U,...K);return}i<64&&(i*=2);let ee;g===1?(g=2,ee=0):ee=(i+Math.random())*1e3,k(ee)}let q=!1;function G(U){q||(q=!0,T(),!p&&(l!==null?(U||(g=2),clearTimeout(l),k(0)):U||(g=1)))}return k(0),u=setTimeout(()=>{d=!0,G(!0)},t),G}function X6(s){s(!1)}function J6(s){return s!==void 0}function Z6(s){return typeof s=="object"&&!Array.isArray(s)}function o0(s){return typeof s=="string"||s instanceof String}function Vw(s){return l0()&&s instanceof Blob}function l0(){return typeof Blob<"u"}function $p(s,e,t,i){if(i<e)throw qp(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw qp(`Invalid value for '${s}'. Expected ${t} or less.`)}function Af(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function fj(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Uo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Uo||(Uo={}));function eD(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class tD{constructor(e,t,i,l,u,d,g,y,p,b,k,T=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=g,this.errorCallback_=y,this.timeout_=p,this.progressCallback_=b,this.connectionFactory_=k,this.retry=T,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((q,G)=>{this.resolve_=q,this.reject_=G,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new mh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=g=>{const y=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,p)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const g=u.getErrorCode()===Uo.NO_ERROR,y=u.getStatus();if(!g||eD(y,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Uo.ABORT;i(!1,new mh(!1,null,b));return}const p=this.successCodes_.indexOf(y)!==-1;i(!0,new mh(p,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,g=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(g,g.getResponse());J6(y)?u(y):u()}catch(y){d(y)}else if(g!==null){const y=a0();y.serverResponse=g.getErrorText(),this.errorCallback_?d(this.errorCallback_(g,y)):d(y)}else if(l.canceled){const y=this.appDelete_?hj():z6();d(y)}else{const y=B6();d(y)}};this.canceled_?t(!1,new mh(!1,null,!0)):this.backoffId_=Q6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&X6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function nD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function sD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function rD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function iD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function aD(s,e,t,i,l,u,d=!0,g=!1){const y=fj(s.urlParams),p=s.url+y,b=Object.assign({},s.headers);return rD(b,e),nD(b,t),sD(b,u),iD(b,i),new tD(p,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,g)}function oD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function lD(...s){const e=oD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(l0())return new Blob(s);throw new as(is.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function uD(s){if(typeof atob>"u")throw G6("base-64");return atob(s)}const Ai={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Qg{constructor(e,t){this.data=e,this.contentType=t||null}}function dD(s,e){switch(s){case Ai.RAW:return new Qg(mj(e));case Ai.BASE64:case Ai.BASE64URL:return new Qg(gj(s,e));case Ai.DATA_URL:return new Qg(fD(e),mD(e))}throw a0()}function mj(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function hD(s){let e;try{e=decodeURIComponent(s)}catch{throw yu(Ai.DATA_URL,"Malformed data URL.")}return mj(e)}function gj(s,e){switch(s){case Ai.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw yu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ai.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw yu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=uD(e)}catch(l){throw l.message.includes("polyfill")?l:yu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class pj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw yu(Ai.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=gD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function fD(s){const e=new pj(s);return e.base64?gj(Ai.BASE64,e.rest):hD(e.rest)}function mD(s){return new pj(s).contentType}function gD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Ja{constructor(e,t){let i=0,l="";Vw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Vw(this.data_)){const i=this.data_,l=cD(i,e,t);return l===null?null:new Ja(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ja(i,!0)}}static getBlob(...e){if(l0()){const t=e.map(i=>i instanceof Ja?i.data_:i);return new Ja(lD.apply(null,t))}else{const t=e.map(d=>o0(d)?dD(Ai.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let g=0;g<d.length;g++)l[u++]=d[g]}),new Ja(l,!0)}}uploadData(){return this.data_}}function c0(s){let e;try{e=JSON.parse(s)}catch{return null}return Z6(e)?e:null}function pD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function yD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function yj(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function vD(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||vD}}let gh=null;function bD(s){return!o0(s)||s.length<2?s:yj(s)}function vj(){if(gh)return gh;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(u,d){return bD(d)}const t=new ir("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),gh=s,gh}function wD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new lr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function xD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return wD(i,s),i}function bj(s,e,t){const i=c0(e);return i===null?null:xD(s,i,t)}function _D(s,e,t,i){const l=c0(e);if(l===null||!o0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(p=>{const b=s.bucket,k=s.fullPath,T="/b/"+d(b)+"/o/"+d(k),R=Af(T,t,i),q=fj({alt:"media",token:p});return R+q})[0]}function kD(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Uw="prefixes",Bw="items";function jD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Uw])for(const l of t[Uw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new lr(e,u));i.prefixes.push(d)}if(t[Bw])for(const l of t[Bw]){const u=s._makeStorageReference(new lr(e,l.name));i.items.push(u)}return i}function ED(s,e,t){const i=c0(t);return i===null?null:jD(s,e,i)}class u0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function d0(s){if(!s)throw a0()}function TD(s,e){function t(i,l){const u=bj(s,l,e);return d0(u!==null),u}return t}function SD(s,e){function t(i,l){const u=ED(s,e,l);return d0(u!==null),u}return t}function CD(s,e){function t(i,l){const u=bj(s,l,e);return d0(u!==null),_D(u,l,s.host,s._protocol)}return t}function h0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=V6():l=P6():t.getStatus()===402?l=O6(s.bucket):t.getStatus()===403?l=U6(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function ND(s){const e=h0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=L6(s.path)),u.serverResponse=l.serverResponse,u}return t}function AD(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),g=Af(d,s.host,s._protocol),y="GET",p=s.maxOperationRetryTime,b=new u0(g,y,SD(s,e.bucket),p);return b.urlParams=u,b.errorHandler=h0(e),b}function RD(s,e,t){const i=e.fullServerUrl(),l=Af(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,g=new u0(l,u,CD(s,t),d);return g.errorHandler=ND(e),g}function ID(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function MD(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=ID(null,e)),i}function DD(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function g(){let ee="";for(let ye=0;ye<2;ye++)ee=ee+Math.random().toString().slice(2);return ee}const y=g();d["Content-Type"]="multipart/related; boundary="+y;const p=MD(e,i,l),b=kD(p,t),k="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+p.contentType+`\r
\r
`,T=`\r
--`+y+"--",R=Ja.getBlob(k,i,T);if(R===null)throw $6();const q={name:p.fullPath},G=Af(u,s.host,s._protocol),U="POST",K=s.maxUploadRetryTime,Y=new u0(G,U,TD(s,t),K);return Y.urlParams=q,Y.headers=d,Y.body=R.uploadData(),Y.errorHandler=h0(e),Y}class LD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Uo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Uo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Uo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw eu("cannot .send() more than once");if(uo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw eu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw eu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw eu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw eu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class OD extends LD{initXhr(){this.xhr_.responseType="text"}}function f0(){return new OD}class Go{constructor(e,t){this._service=e,t instanceof lr?this._location=t:this._location=lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Go(e,t)}get root(){const e=new lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yj(this._location.path)}get storage(){return this._service}get parent(){const e=pD(this._location.path);if(e===null)return null;const t=new lr(this._location.bucket,e);return new Go(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw K6(e)}}function PD(s,e,t){s._throwIfRoot("uploadBytes");const i=DD(s.storage,s._location,vj(),new Ja(e,!0),t);return s.storage.makeRequestWithTokens(i,f0).then(l=>({metadata:l,ref:s}))}function VD(s){const e={prefixes:[],items:[]};return wj(s,e).then(()=>e)}async function wj(s,e,t){const l=await UD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await wj(s,e,l.nextPageToken)}function UD(s,e){e!=null&&typeof e.maxResults=="number"&&$p("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=AD(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,f0)}function BD(s){s._throwIfRoot("getDownloadURL");const e=RD(s.storage,s._location,vj());return s.storage.makeRequestWithTokens(e,f0).then(t=>{if(t===null)throw W6();return t})}function zD(s,e){const t=yD(s._location.path,e),i=new lr(s._location.bucket,t);return new Go(s.storage,i)}function FD(s){return/^[A-Za-z]+:\/\//.test(s)}function HD(s,e){return new Go(s,e)}function xj(s,e){if(s instanceof m0){const t=s;if(t._bucket==null)throw q6();const i=new Go(t,t._bucket);return e!=null?xj(i,e):i}else return e!==void 0?zD(s,e):s}function qD(s,e){if(e&&FD(e)){if(s instanceof m0)return HD(s,e);throw qp("To use ref(service, url), the first argument must be a Storage instance.")}else return xj(s,e)}function zw(s,e){const t=e?.[dj];return t==null?null:lr.makeFromBucketSpec(t,s)}function $D(s,e,t,i={}){s.host=`${e}:${t}`;const l=uo(e);l&&(iy(`https://${s.host}/b`),ay("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:Fx(u,s.app.options.projectId))}class m0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=uj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=M6,this._maxUploadRetryTime=D6,this._requests=new Set,l!=null?this._bucket=lr.makeFromBucketSpec(l,this._host):this._bucket=zw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=lr.makeFromBucketSpec(this._url,e):this._bucket=zw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Go(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new Y6(hj());{const d=aD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Fw="@firebase/storage",Hw="0.14.0";const _j="storage";function vu(s,e,t){return s=jn(s),PD(s,e,t)}function qw(s){return s=jn(s),VD(s)}function so(s){return s=jn(s),BD(s)}function oa(s,e){return s=jn(s),qD(s,e)}function WD(s=Lu(),e){s=jn(s);const i=Xo(s,_j).getImmediate({identifier:e}),l=Ux("storage");return l&&GD(i,...l),i}function GD(s,e,t,i={}){$D(s,e,t,i)}function KD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new m0(t,i,l,e,Jo)}function YD(){mi(new ei(_j,KD,"PUBLIC").setMultipleInstances(!0)),wr(Fw,Hw,""),wr(Fw,Hw,"esm2020")}YD();const kj={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},g0=cy(kj),Io=N_(g0),ge=v6(g0),la=WD(g0),QD=cy(kj,"secondary"),LO=N_(QD),XD="EYdciKDOi3UYBLk1u8hHams5tmO2",jj=w.createContext();function Or(){return w.useContext(jj)}function JD({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[g,y]=w.useState(null),[p,b]=w.useState(!0);w.useEffect(()=>{let Y=null;const ee=t4(Io,ye=>{if(t(ye),Y&&(Y(),Y=null),ye)if(ye.uid===XD)l(!0),d(!1),y(null),b(!1);else{l(!1);const ke=tn(dt(ge,"clients"),kt("uid","==",ye.uid)),ve=async()=>{const I=localStorage.getItem("mcf_clientId");if(I)try{const E=await _s(Be(ge,"clients",I));E.exists()&&(d(!0),y({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};Y=lj(ke,async I=>{if(I.empty)await ve();else{const E=I.docs[0];d(!0),y({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}b(!1)},async I=>{console.error("Error listening to client data:",I),await ve(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{ee(),Y&&Y()}},[]);const K={currentUser:e,isAdmin:i,isClient:u,clientData:g,updateClientData:Y=>{y(ee=>ee?{...ee,...Y}:Y)},resolveClient:async()=>{if(g)return g;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const ee=await _s(Be(ge,"clients",Y));if(ee.exists()){const ye={id:ee.id,...ee.data()};return d(!0),y(ye),ye}}catch(ee){console.error("resolveClient direct read failed:",ee)}if(e){const ee=tn(dt(ge,"clients"),kt("uid","==",e.uid)),ye=await Wt(ee);if(!ye.empty){const ke={id:ye.docs[0].id,...ye.docs[0].data()};return d(!0),y(ke),ke}}return null},login:async(Y,ee,ye=!0)=>(await S2(Io,ye?Tp:py),await JA(Io,Y,ee)),signup:async(Y,ee,ye)=>{await S2(Io,Tp);const ke=await XA(Io,ee.trim().toLowerCase(),ye),ve=ke.user,I=Be(dt(ge,"clients")),E={uid:ve.uid,name:Y.trim(),email:ee.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Ft.now()};await ss(I,E),d(!0),y({id:I.id,...E});try{localStorage.setItem("mcf_clientId",I.id)}catch{}return ke},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return n4(Io)},resetPassword:Y=>QA(Io,Y),loading:p};return a.jsx(jj.Provider,{value:K,children:s})}const Ej=w.createContext();function Ui(){return w.useContext(Ej)}function ZD({children:s}){const[e,t]=w.useState(()=>{const k=localStorage.getItem("theme");return k?k==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red"),[u,d]=w.useState(()=>localStorage.getItem("mono")==="true");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]),w.useEffect(()=>{document.documentElement.setAttribute("data-mono",u?"true":"false"),localStorage.setItem("mono",u?"true":"false")},[u]);const b={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:k=>l(k),isMono:u,toggleMono:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),d(!u),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)}};return a.jsx(Ej.Provider,{value:b,children:s})}const Tj=w.createContext();function hc(){return w.useContext(Tj)}const e3=["nutrition","buddies"],t3=[5,10],n3=2,s3=1;function r3({children:s}){const{clientData:e,loading:t}=Or(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",g=l==="premium"||!!d;function y(p){return g?!0:!e3.includes(p)}return{tier:l,subscriptionStatus:u,isPremium:g,canAccess:y,loading:t,FREE_RANDOMISER_DURATIONS:t3,FREE_RANDOMISER_WEEKLY_LIMIT:n3,FREE_HABIT_LIMIT:s3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(Tj.Provider,{value:i,children:s})}function i3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function a3({className:s=""}){const{isDark:e,toggleTheme:t}=Ui();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function o3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,g]=w.useState(""),[y,p]=w.useState(!1),[b,k]=w.useState(!1),[T,R]=w.useState(!1),{login:q,resetPassword:G,currentUser:U,isAdmin:K,isClient:Y,clientData:ee,loading:ye}=Or(),ke=Zs();if(w.useEffect(()=>{if(!ye&&U){if(!U.emailVerified&&ee?.signupSource==="self_signup"){ke("/signup");return}K?ke("/dashboard"):Y?ke(i3(ee)):(p(!1),g("No account found. Please sign up or contact your trainer."))}},[ye,U,K,Y,ee,ke]),ye||U)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const ve=async E=>{E.preventDefault(),g(""),p(!0);try{await q(s,t,l)}catch(O){g(O.message||"Failed to log in"),p(!1)}},I=async E=>{if(E.preventDefault(),g(""),!s.trim()){g("Please enter your email address");return}p(!0);try{await G(s.trim()),R(!0)}catch(O){O.code==="auth/user-not-found"?g("No account found with this email"):g(O.message||"Failed to send reset email")}p(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(a3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),R(!1),g("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:I,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),g("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:ve,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:E=>e(E.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),g("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>ke("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function ph({feature:s,children:e}){const{canAccess:t,loading:i}=hc();return i||t(s)?e:a.jsx(Nx,{to:"/upgrade",replace:!0})}function ti({active:s}){const e=Zs(),{clientData:t}=Or(),{isPremium:i}=hc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function sl({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),g=w.useRef(0),y=w.useRef(!1),p=w.useCallback(T=>{window.scrollY<=0&&(g.current=T.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(T=>{if(!y.current||l)return;const R=T.touches[0].clientY-g.current;R>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((R-20)*.35,80)))},[l]),k=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:p,onTouchMove:b,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Ku(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const g=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(g),y1:t+i*Math.sin(g),x2:e+l*Math.cos(g),y2:t+l*Math.sin(g),thick:d%5===0})}return u}const Sj=Ku(60,100,100,85,96),l3=Ku(60,100,100,78,94),c3=Ku(60,100,100,82,94);Ku(60,50,50,38,46);const OO=Ku(60,40,40,30,37);function u3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[g,y]=w.useState("below"),[p,b]=w.useState(!1),k=w.useRef(null),T=w.useRef(t);T.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const ke=ve=>ve.preventDefault();return document.addEventListener("touchmove",ke,{passive:!1}),document.addEventListener("wheel",ke,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ke),document.removeEventListener("wheel",ke),document.body.style.overflow=""}},[t]);const R=w.useMemo(()=>t?s.filter(ke=>document.querySelector(ke.selector)):[],[t]),q=R[i],G=i===R.length-1,U=q?.selector,K=w.useCallback(()=>{if(!U)return;const ke=document.querySelector(U);if(!ke){d(null);return}const ve=ke.getBoundingClientRect(),I=8;d({top:ve.top-I,left:ve.left-I,width:ve.width+I*2,height:ve.height+I*2});const E=window.innerHeight-ve.bottom;y(E<260?"above":"below")},[U]);if(w.useEffect(()=>{if(!t||!U)return;b(!0);const ke=document.querySelector(U);if(ke){document.body.style.overflow="",ke.scrollIntoView({behavior:"smooth",block:"center"});let ve=null,I=0,E=0;const O=60,B=()=>{E++;const A=ke.getBoundingClientRect(),Le=Math.round(A.top);if(ve!==null&&Le===ve?I++:I=0,ve=Le,I>=3||E>=O){T.current&&(document.body.style.overflow="hidden"),K(),b(!1);return}D=requestAnimationFrame(B)};let D;const L=setTimeout(()=>{D=requestAnimationFrame(B)},120);return()=>{clearTimeout(L),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,U,K]),w.useEffect(()=>{if(!t)return;const ke=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(K)};return window.addEventListener("scroll",ke,!0),window.addEventListener("resize",ke),()=>{window.removeEventListener("scroll",ke,!0),window.removeEventListener("resize",ke),k.current&&cancelAnimationFrame(k.current)}},[t,K]),!t||!q||R.length===0)return null;const Y=()=>{G?e():l(i+1)},ee=()=>{i>0&&l(i-1)},ye=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:ke=>{ke.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:Y}),u&&a.jsx("div",{className:`st-spotlight${p?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${g}${p?" st-transitioning":""}`,style:{top:g==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:g==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:R.map((ke,ve)=>a.jsx("span",{className:`st-dot${ve===i?" active":""}${ve<i?" done":""}`},ve))}),a.jsx("h3",{className:"st-title",children:q.title}),a.jsx("p",{className:"st-body",children:q.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:ee,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:q.cta||(G?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:ye,children:"Skip tour"})]})]})}const d3="/login/assets/first_workout-B8SFkzJX.PNG",h3="/login/assets/workouts_10-Z5R3u0xH.PNG",f3="/login/assets/workouts_25-CzxSlcAj.PNG",m3="/login/assets/workouts_50-BpzWup3V.PNG",g3="/login/assets/workouts_100-D7_r6tn1.PNG",p3="/login/assets/streak_2-CsRr-XA9.PNG",y3="/login/assets/streak_4-BHO09tbw.PNG",v3="/login/assets/streak_8-DX2UWMko.PNG",b3="/login/assets/nutrition_7-CHVV11fj.PNG",w3="/login/assets/leaderboard_join-BLoId4Hz.PNG",x3="/login/assets/habits_7-Dvki70KO.PNG",_3="/login/assets/starter_streak-CCltAfrC.PNG",k3="/login/assets/consistency_king-Cho2jxBt.PNG",j3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",E3="/login/assets/minute_master-hA2RLkIL.PNG",T3="/login/assets/habit_machine--nFXaIUW.PNG",S3="/login/assets/iron_will-Dh2dTaie.PNG",Jr=[{id:"first_workout",img:d3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:h3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:f3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:m3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:g3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:p3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:y3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:v3,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:b3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:w3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:x3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:_3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:k3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:j3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:E3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:T3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:S3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],$w=3,Ww=5,C3=["trained","protein","steps","sleep","water"];function Xg(s){return s.toISOString().split("T")[0]}const Jg=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],tu={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Zg(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function nu(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function N3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(g=>t(g),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function A3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Or(),{isDark:d,toggleTheme:g}=Ui(),{isPremium:y,FREE_HABIT_LIMIT:p}=hc(),b=Zs(),[k,T]=w.useState(y?Ww:p),R=k,[q,G]=w.useState({hours:0,minutes:0,seconds:0}),[U,K]=w.useState(0),[Y,ee]=w.useState(0),[ye,ke]=w.useState(0),[ve,I]=w.useState(!1),[E,O]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[B,D]=w.useState(null),[L,A]=w.useState(0),[Le,st]=w.useState(0),[te,Te]=w.useState($w),[He,Ae]=w.useState(!1),[We,V]=w.useState(!1),[ce,je]=w.useState([]),[Se,_e]=w.useState(null),[Pe,ze]=w.useState(!1),Ye=w.useRef(null),[Je,Qt]=w.useState(0),[Rt,Sn]=w.useState(0),[on,qt]=w.useState(null),Tt=w.useCallback((S,Q="info")=>{qt({message:S,type:Q}),setTimeout(()=>qt(null),4e3)},[]),[gn,St]=w.useState([]),[ut,le]=w.useState(!1),[pt,Ht]=w.useState(""),[it,yt]=w.useState(null),[mt,wt]=w.useState(null),[Bt,fs]=w.useState(!1),[rn,Jn]=w.useState(new Set),[Fn,Ln]=w.useState(new Set),[On,cn]=w.useState({}),[Gt,Dt]=w.useState({}),[It,Z]=w.useState({}),[C,re]=w.useState({}),[Re,Ie]=w.useState({}),[De,Fe]=w.useState({}),Oe=w.useRef(null),Lt=w.useRef(null),xt=w.useRef({}),[lt,un]=w.useState([]),[dn,Pn]=w.useState(!1),ms=w.useRef(null),[ue,Me]=w.useState([]),[Ge,ct]=w.useState(""),[et,$t]=w.useState(!1),[hn,Nt]=w.useState(null),[Ct,vn]=w.useState([]),[Ss,ni]=w.useState(null),[bi,Pr]=w.useState(!1),js=w.useRef(!1),[hr,Gn]=w.useState(null),[os,ls]=w.useState(!1),Vn=w.useRef(!1),bn=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return y&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let S=t?.tourComplete||Vn.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(ve&&t&&!S){const Q=setTimeout(()=>ls(!0),600);return()=>clearTimeout(Q)}},[ve,t]),w.useEffect(()=>{if(!(!ve||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>V(!0),1500);return()=>clearTimeout(S)}}},[ve,t]),w.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const Q=JSON.parse(S);ee(Q.totalWorkouts??0),ke(Q.habitWeekPct??0),O(Q.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(Q.nutritionTargetData??null),A(Q.todayHabitsCount??0),Q.realHabitCount&&T(Q.realHabitCount),st(Q.weeklyWorkouts??0),Te(Q.weeklyWorkoutTarget??$w),je(Q.leaderboardTop3??[]),Qt(Q.streakWeeks??0),I(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&_e(t.photoURL),t?.weeklyWorkoutTarget&&Te(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const S=tn(dt(ge,"notifications"),kt("toId","==",t.id)),Q=lj(S,Ce=>{const M=Ce.docs.map(F=>({id:F.id,...F.data()}));M.sort((F,$)=>{const X=F.createdAt?.toMillis?.()||0;return($.createdAt?.toMillis?.()||0)-X}),un(M.slice(0,50))},Ce=>{console.error("Notification listener error:",Ce),Ce.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Q()},[t]),w.useEffect(()=>{const S=Q=>{ms.current&&!ms.current.contains(Q.target)&&Pn(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),w.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[Q,Ce,M]=await Promise.all([Wt(tn(dt(ge,"buddies"),kt("user1","==",S))),Wt(tn(dt(ge,"buddies"),kt("user2","==",S))),Wt(dt(ge,"clients"))]),F=new Set;[...Q.docs,...Ce.docs].forEach(X=>{const de=X.data();F.add(de.user1===S?de.user2:de.user1)});const $={};M.docs.forEach(X=>{$[X.id]=X.data()}),Me(Array.from(F).filter(X=>$[X]).map(X=>({id:X,name:$[X].name,photoURL:$[X].photoURL||null})))}catch(Q){console.error("Error loading buddies for mentions:",Q)}})()},[t]);const Zn=lt.filter(S=>!S.read).length,xr=async()=>{const S=lt.filter(Ce=>!Ce.read);if(!S.length)return;const Q=Pw(ge);S.forEach(Ce=>Q.update(Be(ge,"notifications",Ce.id),{read:!0})),await Q.commit()},Hs=async()=>{if(!lt.length)return;const S=Pw(ge);lt.forEach(Q=>S.delete(Be(ge,"notifications",Q.id))),await S.commit()},Kn=async(S,Q,Ce={})=>{if(!(!t||S===t.id))try{await or(dt(ge,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Q,read:!1,createdAt:xs(),...Ce})}catch(M){console.error("Notification create error:",M),M.code==="permission-denied"&&Tt("Notifications blocked  check Firestore rules","error")}},_r=(S,Q)=>{const Ce=Q==="compose"?Oe.current?.selectionStart:null,F=(Ce!=null?S.slice(0,Ce):S).match(/@(\w*)$/);if(F){$t(!0),Nt(Q),ct(F[1].toLowerCase());const $=ue.filter(X=>X.name&&X.name.toLowerCase().includes(F[1].toLowerCase())).slice(0,5);vn($)}else $t(!1),vn([])},es=(S,Q)=>{if(Q==="compose"){const Ce=Oe.current,M=pt,F=Ce?.selectionStart??M.length,$=M.slice(0,F),X=M.slice(F),de=$.replace(/@\w*$/,`@${S.name} `);Ht(de+X),setTimeout(()=>{Ce?.focus(),Ce.selectionStart=Ce.selectionEnd=de.length},0)}else{const M=(Gt[Q]||"").replace(/@\w*$/,`@${S.name} `);Dt(F=>({...F,[Q]:M}))}$t(!1),vn([])},Vr=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((Ce,M)=>Ce.startsWith("@")&&ue.some(F=>Ce.trim()===`@${F.name}`)?a.jsx("span",{className:"mention-highlight",children:Ce.trim()},M):Ce),P=async S=>{const Q=S.target.files?.[0];if(!(!Q||!t)){if(!Q.type.startsWith("image/")){Tt("Please select an image file","error");return}if(Q.size>5*1024*1024){Tt("Image must be under 5MB","error");return}ze(!0);try{const Ce=await new Promise($=>{const X=new Image;X.onload=()=>{const de=document.createElement("canvas"),pe=400;let Ve=X.width,tt=X.height;Ve>tt?(tt=tt/Ve*pe,Ve=pe):(Ve=Ve/tt*pe,tt=pe),de.width=Ve,de.height=tt,de.getContext("2d").drawImage(X,0,0,Ve,tt),de.toBlob(nt=>$(nt),"image/jpeg",.75)},X.src=URL.createObjectURL(Q)}),M=oa(la,`profilePhotos/${t.id}`);await vu(M,Ce);const F=await so(M);await zn(Be(ge,"clients",t.id),{photoURL:F}),_e(F),l({photoURL:F}),Tt("Profile photo updated!","success")}catch(Ce){console.error("Photo upload error:",Ce),Tt("Failed to upload photo","error")}ze(!1),Ye.current&&(Ye.current.value="")}};w.useEffect(()=>{const S=()=>{const Ce=new Date,M=new Date(Ce);M.setHours(23,59,59,999);const F=M-Ce,$=Math.floor(F/(1e3*60*60)),X=Math.floor(F%(1e3*60*60)/(1e3*60)),de=Math.floor(F%(1e3*60)/1e3);G({hours:$,minutes:X,seconds:de}),K(60-de)};S();const Q=setInterval(S,1e3);return()=>clearInterval(Q)},[]),w.useEffect(()=>{const S=setInterval(()=>{Sn(Q=>(Q+1)%Jg.length)},8e3);return()=>clearInterval(S)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let Q=null,Ce=null;try{const M=Xg(new Date),F=dt(ge,"workoutLogs"),$=tn(F,kt("clientId","==",t.id));Q=await Wt($),ee(Q.docs.length);const X=new Date,de=X.getDay(),pe=de===0?6:de-1,Ve=new Date(X);Ve.setDate(X.getDate()-pe),Ve.setHours(0,0,0,0);const tt=Ve.getTime(),nt=Q.docs.filter(fn=>{const gt=fn.data().completedAt;return gt?(gt.toDate?gt.toDate().getTime():new Date(gt).getTime())>=tt:!1}).length;st(nt);const[vt,_t]=await Promise.all([Wt(tn(dt(ge,"habitLogs"),kt("clientId","==",t.id),kt("date","==",M))),_s(Be(ge,"customHabits",t.id))]);let Xt=Ww;if(_t.exists()){const fn=_t.data(),gt=fn.habits||[],mn=fn.hiddenDefaults||[];Xt=C3.filter(tr=>!mn.includes(tr)).length+gt.length}y||(Xt=Math.min(Xt,p)),T(Xt);let Hn=0;if(!vt.empty){const fn=vt.docs[0].data().habits||{};Hn=Object.values(fn).filter(Boolean).length}ke(Math.round(Hn/Xt*100)),A(Hn);const rt=await _s(Be(ge,"nutritionTargets",t.id));rt.exists()&&(D(rt.data()),Ce=rt.data());const wn=await _s(Be(ge,"nutritionLogs",`${t.id}_${M}`));if(wn.exists()){const gt=(wn.data().entries||[]).reduce((mn,Qn)=>({protein:mn.protein+(Qn.protein||0),carbs:mn.carbs+(Qn.carbs||0),fats:mn.fats+(Qn.fats||0),calories:mn.calories+(Qn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});O(gt)}}catch(M){console.error("Error loading dashboard stats:",M)}try{const M=dt(ge,"clients"),F=tn(M,kt("leaderboardOptIn","==",!0)),X=(await Wt(F)).docs.map(de=>({id:de.id,name:de.data().name,photoURL:de.data().photoURL||null}));if(je(X.slice(0,3)),t?.id){const de=X.findIndex(Ve=>Ve.id===t.id),pe=de>=0?de+1:null;try{const Ve=`lbRank_${t.id}`,tt=sessionStorage.getItem(Ve);tt&&Gn(parseInt(tt,10)),pe&&sessionStorage.setItem(Ve,String(pe))}catch{}}}catch(M){console.error("Leaderboard preview error:",M)}try{let M=0;if(Q){const F=Q.docs.map($=>$.data().date).filter(Boolean).sort().reverse();if(F.length>0){const $=new Date;let X=new Date($);e:for(let de=0;de<52;de++){const pe=new Date(X),Ve=pe.getDay(),tt=Ve===0?6:Ve-1;pe.setDate(pe.getDate()-tt),pe.setHours(0,0,0,0);const nt=new Date(pe);nt.setDate(nt.getDate()+7);const vt=Xg(pe),_t=Xg(nt);if(F.some(Hn=>Hn>=vt&&Hn<_t))M++;else{if(de>0)break e;break}X.setDate(X.getDate()-7)}}}Qt(M)}catch(M){console.error("Streak computation error:",M)}I(!0)})()},[s,t,R]),w.useEffect(()=>{if(!(!ve||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:Y,habitWeekPct:ye,nutritionTotals:E,nutritionTargetData:B,todayHabitsCount:L,realHabitCount:k,weeklyWorkouts:Le,weeklyWorkoutTarget:te,leaderboardTop3:ce,streakWeeks:Je}))}catch{}},[ve,Y,ye,E,B,L,Le,te,ce,Je,t]),w.useEffect(()=>{if(!(!ve||js.current)&&Le>=te&&te>0){const S=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(S))return;sessionStorage.setItem(S,"1")}catch{}js.current=!0,Pr(!0),setTimeout(()=>Pr(!1),3500)}},[ve,Le,te,t]);const H=w.useCallback(async()=>{if(Vn.current=!0,ls(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await zn(Be(ge,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),ae=w.useCallback(async S=>{if(Te(S),Ae(!1),V(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await zn(Be(ge,"clients",t.id),{weeklyWorkoutTarget:S})}catch(Q){console.error("Failed to save weekly target:",Q)}}},[t]),ne=S=>{const Q=S.currentTarget,Ce=Q.querySelector(".ripple");Ce&&Ce.remove();const M=Q.getBoundingClientRect(),F=Math.max(M.width,M.height),$=S.clientX-M.left-F/2,X=S.clientY-M.top-F/2,de=document.createElement("span");de.className="ripple",de.style.cssText=`width:${F}px;height:${F}px;left:${$}px;top:${X}px;`,Q.appendChild(de),setTimeout(()=>de.remove(),600)},$e=t?.name?.split(" ")[0]||"there",Qe=Math.min(Math.round(Le/te*100),100),Ke=Je>0?Math.min(Math.round(Je/12*100),100):0,ot=[{label:"Wk Streak",value:`${Je}`,pct:Ke,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Le}/${te}`,pct:Qe,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"var(--color-primary)",size:"normal"}],At=E.calories>0&&B?.calories&&E.calories>=B.calories*.8,Cn=Le>=te&&te>0,Cs=L>=R,Yn=(()=>{if(!ve)return null;const S=te-Le;return S===1?"1 more workout to hit your weekly goal":S===2?"2 more workouts to hit your weekly goal":R-L===1?"1 habit left to complete today":null})(),Ms=S=>!B||!B[S]?0:Math.min(Math.round(E[S]/B[S]*100),100),si=(()=>{const S=new Date().getHours(),Q=ve&&L>=R&&E.calories>0,Ce=M=>M[Math.floor(Date.now()/6e4%M.length)];return Q?Ce(tu.allDone):S>=5&&S<12?Ce(tu.morning):S>=12&&S<17?Ce(tu.afternoon):S>=17&&S<21?Ce(tu.evening):Ce(tu.night)})(),Ds=ve?Le===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:L<R?{label:"DAILY HABITS",message:`${L}/${R} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:ye,ringLabel:`${L}/${R}`}:y&&E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,er=w.useCallback(async()=>{if(t){le(!0);try{const S=await Wt(tn(dt(ge,"posts"),kt("authorId","==",t.id),$o("createdAt","desc"),Wo(30)));St(S.docs.map(Ce=>({id:Ce.id,...Ce.data()})));const Q=await Wt(tn(dt(ge,"postLikes"),kt("userId","==",t.id)));Jn(new Set(Q.docs.map(Ce=>Ce.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{le(!1)}}},[t]);w.useEffect(()=>{ve&&t&&er()},[ve,t,er]);const wi=S=>{const Q=S.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){Tt("Please select an image file","error");return}if(Q.size>10*1024*1024){Tt("Image must be under 10MB","error");return}yt(Q),wt(URL.createObjectURL(Q))}},kr=()=>{yt(null),mt&&URL.revokeObjectURL(mt),wt(null),Lt.current&&(Lt.current.value="")},Ns=async()=>{if(!(!pt.trim()&&!it||Bt||!t)){fs(!0);try{let S=null;if(it){const F=await N3(it),$=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,X=oa(la,`postImages/${t.id}/${$}`);await vu(X,F),S=await so(X)}await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:pt.trim(),type:S?"image":"text",imageURL:S||null,createdAt:xs(),likeCount:0,commentCount:0});const Ce=pt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ce){const F=new Set;Ce.forEach($=>{const X=$.slice(1).trim(),de=ue.find(pe=>pe.name&&pe.name.toLowerCase()===X.toLowerCase());de&&!F.has(de.id)&&(F.add(de.id),Kn(de.id,"mention",{}))})}Ht(""),kr(),Oe.current&&(Oe.current.style.height="auto"),await er();const M=ue.length;Tt(M>0?`Shared with ${M} ${M===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(S){console.error("Error posting:",S),Tt(S?.message||"Failed to post","error")}finally{fs(!1)}}},_a=async S=>{if(window.confirm("Delete this post?"))try{await ar(Be(ge,"posts",S)),St(Q=>Q.filter(Ce=>Ce.id!==S)),Tt("Post deleted","info")}catch(Q){console.error("Delete error:",Q),Tt("Failed to delete","error")}},Bi=async S=>{if(!t)return;const Q=t.id,Ce=`${S}_${Q}`,M=rn.has(S),F=new Set(rn);M?F.delete(S):F.add(S),Jn(F),St($=>$.map(X=>X.id===S?{...X,likeCount:Math.max(0,(X.likeCount||0)+(M?-1:1))}:X));try{if(M)await ar(Be(ge,"postLikes",Ce)),await zn(Be(ge,"posts",S),{likeCount:hi(-1)});else{await ss(Be(ge,"postLikes",Ce),{postId:S,userId:Q,createdAt:xs()}),await zn(Be(ge,"posts",S),{likeCount:hi(1)});const $=gn.find(X=>X.id===S);$&&Kn($.authorId,"like",{postId:S})}}catch($){console.error("Like error:",$),er()}},ri=async S=>{try{const Q=await Wt(tn(dt(ge,"postComments"),kt("postId","==",S),$o("createdAt","asc"),Wo(50)));cn(Ce=>({...Ce,[S]:Q.docs.map(M=>({id:M.id,...M.data()}))}))}catch(Q){console.error("Error loading comments:",Q)}},xi=S=>{const Q=new Set(Fn);Q.has(S)?Q.delete(S):(Q.add(S),On[S]||ri(S)),Ln(Q)},zi=async S=>{const Q=(Gt[S]||"").trim(),Ce=Re[S];if(!(!Q&&!Ce||!t)){Z(M=>({...M,[S]:!0}));try{let M=null;if(Ce){const pe=oa(la,`comment-images/${Date.now()}_${Ce.name}`);await vu(pe,Ce),M=await so(pe)}const F={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Q||"",createdAt:xs()};M&&(F.imageURL=M);const $=C[S];$&&(F.replyToId=$.id,F.replyToName=$.authorName),await or(dt(ge,"postComments"),F),await zn(Be(ge,"posts",S),{commentCount:hi(1)});const X=gn.find(pe=>pe.id===S);X&&Kn(X.authorId,"comment",{postId:S});const de=Q.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(de){const pe=new Set;de.forEach(Ve=>{const tt=Ve.slice(1).trim(),nt=ue.find(vt=>vt.name&&vt.name.toLowerCase()===tt.toLowerCase());nt&&!pe.has(nt.id)&&(pe.add(nt.id),Kn(nt.id,"mention",{postId:S}))})}Dt(pe=>({...pe,[S]:""})),Ie(pe=>({...pe,[S]:null})),Fe(pe=>({...pe,[S]:null})),re(pe=>({...pe,[S]:null})),xt.current[S]&&(xt.current[S].value=""),St(pe=>pe.map(Ve=>Ve.id===S?{...Ve,commentCount:(Ve.commentCount||0)+1}:Ve)),await ri(S)}catch(M){console.error("Comment error:",M),Tt("Failed to comment","error")}finally{Z(M=>({...M,[S]:!1}))}}},Ur=async(S,Q)=>{try{await ar(Be(ge,"postComments",Q)),await zn(Be(ge,"posts",S),{commentCount:hi(-1)}),cn(Ce=>({...Ce,[S]:(Ce[S]||[]).filter(M=>M.id!==Q)})),St(Ce=>Ce.map(M=>M.id===S?{...M,commentCount:Math.max((M.commentCount||1)-1,0)}:M))}catch(Ce){console.error("Delete comment error:",Ce),Tt("Failed to delete comment","error")}},jr=(S,Q)=>{const Ce=Q.target.files?.[0];if(!Ce)return;if(Ce.size>5*1024*1024){Tt("Image must be under 5MB","error");return}Ie(F=>({...F,[S]:Ce}));const M=new FileReader;M.onload=F=>Fe($=>({...$,[S]:F.target.result})),M.readAsDataURL(Ce)},qs=S=>{Ie(Q=>({...Q,[S]:null})),Fe(Q=>({...Q,[S]:null})),xt.current[S]&&(xt.current[S].value="")},$s=S=>{Ht(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",_r(S.target.value,"compose")},Ls=(S,Q)=>{Dt(Ce=>({...Ce,[S]:Q})),_r(Q,S)};return a.jsx(sl,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:ms,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{Pn(!dn),dn||xr()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Zn>0&&a.jsx("span",{className:"header-notif-badge",children:Zn>9?"9+":Zn})]}),dn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),lt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Hs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:lt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):lt.map(S=>a.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(Pn(!1),S.type==="buddy_request"||S.type==="buddy_accept")b(y?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!Fn.has(S.postId)){const Q=new Set(Fn);Q.add(S.postId),Ln(Q),On[S.postId]||ri(S.postId)}setTimeout(()=>{const Q=document.getElementById(`post-${S.postId}`);Q&&Q.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&b(`/client/core-buddy/profile/${S.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?a.jsx("img",{src:S.fromPhotoURL,alt:""}):a.jsx("span",{children:(S.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Zg(S.createdAt)})]})]},S.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:g,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Sj.map((S,Q)=>{const Ce=Q<U;return a.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${Ce?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},Q)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ye.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Se||"/Logo.webp",alt:Se?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Pe?" uploading":""}`,children:Pe?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ye,type:"file",accept:"image/*",onChange:P,style:{display:"none"}})]}),!Se&&!Pe&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ye.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(q.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(q.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(q.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Jg[Rt].text," ",a.jsx("strong",{children:Jg[Rt].bold})]},Rt)]}),a.jsx("div",{className:"cb-stats-row",children:ot.map(S=>{const Q=(S.size==="large",38),Ce=2*Math.PI*Q,M=Ce-S.pct/100*Ce,F=S.editable,$=S.pct>=75&&S.pct<100,X=S.pct>=100;return a.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${F?" cb-stat-tappable":""}${F&&We?" cb-stat-hint":""}${$?" cb-stat-near":""}${X?" cb-stat-complete":""}`,onClick:F?()=>{Ae(!0),V(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Q}),a.jsx("circle",{className:`cb-stat-fill${$?" cb-fill-near":""}${X?" cb-fill-complete":""}`,cx:"50",cy:"50",r:Q,strokeDasharray:Ce,strokeDashoffset:M})]}),a.jsx("span",{className:`cb-stat-value${X?" cb-val-complete":""}`,children:S.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[S.label==="Wk Streak"&&Je>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),S.label]})]},S.label)})}),He&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Ae(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>a.jsx("button",{className:`cb-target-option${S===te?" active":""}`,onClick:()=>ae(S),children:S},S))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[si.main," ",a.jsx("strong",{children:$e}),"  ",si.sub]}),Yn&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Yn})]}),Ds&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ds.action||void 0,style:Ds.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ds.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ds.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ds.label}),a.jsx("span",{className:"cb-nudge-title",children:Ds.message}),Ds.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ds.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[y&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${At?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ms("protein"),color:"var(--color-primary)"},{label:"C",pct:Ms("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ms("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Ms("calories"),color:"var(--color-primary)"}].map(S=>{const Ce=2*Math.PI*38,M=Ce-S.pct/100*Ce;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:Ce,strokeDashoffset:M})]}),a.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${Cn?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Le," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[Y," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Cs?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${L>=R?" cb-habits-all-done":""}`,children:Array.from({length:R},(S,Q)=>a.jsx("span",{className:`cb-habit-dot${Q<L?" done":""}${!Q&&L>0&&Q>=L?" cb-dot-warming":""}`,style:Q>=L&&L>0?{"--glow-intensity":Math.min(L/R,.9)}:void 0},Q))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[L,"/",R," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{ne(S),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),ce.length>0?a.jsx("div",{className:"cb-lb-preview",children:ce.map((S,Q)=>{const Ce=["#FFD700","#A8B4C0","#CD7F32"][Q],M=S.name?S.name.split(" ").map(de=>de[0]).join("").slice(0,2).toUpperCase():"?",F=S.id===t?.id,$=Q+1,X=F&&hr?hr-$:0;return a.jsxs("div",{className:`cb-lb-entry${F?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ce},children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:M})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ce},children:["#",$,F&&X>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",X]}),F&&X<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:X})]})]},S.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Jr.find(S=>S.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:Jr.find(S=>S.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),y&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Se?a.jsx("img",{src:Se,alt:""}):a.jsx("span",{children:nu(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Oe,placeholder:"Share your progress... (use @ to mention)",value:pt,onChange:$s,rows:1,maxLength:500}),et&&hn==="compose"&&Ct.length>0&&a.jsx("div",{className:"mention-dropdown",children:Ct.map(S=>a.jsxs("button",{className:"mention-option",onClick:()=>es(S,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:""}):a.jsx("span",{children:nu(S.name)})}),a.jsx("span",{children:S.name})]},S.id))}),mt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:mt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:kr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Lt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Lt,type:"file",accept:"image/*",onChange:wi,hidden:!0}),(pt.trim()||it)&&a.jsx("button",{className:"journey-post-btn",onClick:Ns,disabled:Bt,children:Bt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ut?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):gn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:gn.map(S=>a.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?a.jsx("img",{src:S.authorPhotoURL,alt:""}):a.jsx("span",{children:nu(S.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:S.authorName}),a.jsx("span",{className:"journey-post-time",children:Zg(S.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>_a(S.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const Q=Jr.find(Ce=>Ce.id===S.metadata.badgeId);return Q?.img?a.jsx("img",{src:Q.img,alt:S.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[S.content&&a.jsx("p",{className:"journey-post-content",children:Vr(S.content)}),S.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${rn.has(S.id)?" liked":""}`,onClick:()=>Bi(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:rn.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:S.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(S.id)?" active":""}`,onClick:()=>xi(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:S.commentCount||0})]})]}),Fn.has(S.id)&&a.jsxs("div",{className:"journey-comments",children:[On[S.id]?.length>0?On[S.id].map(Q=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:Q.authorPhotoURL?a.jsx("img",{src:Q.authorPhotoURL,alt:""}):a.jsx("span",{children:nu(Q.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Q.authorName}),Q.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Q.replyToName]}),Q.content&&a.jsx("span",{className:"journey-comment-text",children:Vr(Q.content)}),Q.imageURL&&a.jsx("img",{className:"journey-comment-image",src:Q.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Zg(Q.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>re(Ce=>({...Ce,[S.id]:{id:Q.id,authorName:Q.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ur(S.id,Q.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Q.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),C[S.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:C[S.id].authorName})]}),a.jsx("button",{onClick:()=>re(Q=>({...Q,[S.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),De[S.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:De[S.id],alt:"Preview"}),a.jsx("button",{onClick:()=>qs(S.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>xt.current[S.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Q=>{xt.current[S.id]=Q},type:"file",accept:"image/*",onChange:Q=>jr(S.id,Q),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Gt[S.id]||"",onChange:Q=>Ls(S.id,Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&zi(S.id)},maxLength:300}),et&&hn===S.id&&Ct.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ct.map(Q=>a.jsxs("button",{className:"mention-option",onClick:()=>es(Q,S.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Q.photoURL?a.jsx("img",{src:Q.photoURL,alt:""}):a.jsx("span",{children:nu(Q.name)})}),a.jsx("span",{children:Q.name})]},Q.id))}),a.jsx("button",{onClick:()=>zi(S.id),disabled:!(Gt[S.id]||"").trim()&&!Re[S.id]||It[S.id],children:It[S.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!y&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(ti,{active:"home"}),bi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Le,"/",te," sessions complete"]})]})}),on&&a.jsxs("div",{className:`toast-notification ${on.type}`,children:[on.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),on.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),on.message]}),a.jsx(u3,{steps:bn,active:os,onFinish:H})]})})}async function ef(s,e){const t=Jr.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=Be(ge,"coreBuddyBadges",e.id),l=await _s(i),u=l.exists()?l.data().earned||[]:[];if(u.some(g=>g.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await zn(i,{earned:[...u,d]}):await ss(i,{earned:[d]}),await or(dt(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:xs(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function Kl({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const ep=new Map;function Yr(){return new Date().toISOString().split("T")[0]}const Gw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],R3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function I3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function M3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Or(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState("loading"),[p,b]=w.useState(null),[k,T]=w.useState(null),[R,q]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,U]=w.useState(null),[K,Y]=w.useState(Yr()),[ee,ye]=w.useState({entries:[]}),[ke,ve]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[I,E]=w.useState(!1),[O,B]=w.useState(()=>{const P=new Date;return{year:P.getFullYear(),month:P.getMonth()}}),[D,L]=w.useState(!1),[A,Le]=w.useState(()=>{const P=new Date;return{year:P.getFullYear(),month:P.getMonth()}}),[st,te]=w.useState(!1),[Te,He]=w.useState(I3),[Ae,We]=w.useState(null),[V,ce]=w.useState(null),[je,Se]=w.useState(!1),[_e,Pe]=w.useState(null),[ze,Ye]=w.useState(""),[Je,Qt]=w.useState(!1),[Rt,Sn]=w.useState(""),[on,qt]=w.useState([]),[Tt,gn]=w.useState(!1),[St,ut]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,pt]=w.useState(null),[Ht,it]=w.useState("100"),[yt,mt]=w.useState(0),[wt,Bt]=w.useState("weight"),[fs,rn]=w.useState(0),[Jn,Fn]=w.useState(null);w.useRef(null);const Ln=w.useRef(!1),On=w.useRef(null),cn=w.useRef(null),Gt=w.useRef(null),Dt=w.useCallback((P,H="info")=>{Fn({message:P,type:H}),setTimeout(()=>Fn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const H=await _s(Be(ge,"nutritionTargets",t.id));H.exists()?(b(H.data()),y("dashboard")):y("setup")}catch(H){console.error("Error loading nutrition data:",H),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const H=await _s(Be(ge,"nutritionLogs",`${t.id}_${K}`));if(H.exists()){const ae=H.data();ye({entries:ae.entries||[]})}else ye({entries:[]})}catch(H){console.error("Error loading log:",H),ye({entries:[]})}})()},[t?.id,K]),w.useEffect(()=>{const P=ee.entries.reduce((H,ae)=>({protein:H.protein+(ae.protein||0),carbs:H.carbs+(ae.carbs||0),fats:H.fats+(ae.fats||0),calories:H.calories+(ae.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ve(P)},[ee.entries]);const It=async P=>{try{if(await ss(Be(ge,"nutritionLogs",`${t.id}_${K}`),{clientId:t.id,date:K,entries:P.entries,updatedAt:Ft.now()}),p?.protein&&K===Yr()&&P.entries.reduce((ae,ne)=>ae+(ne.protein||0),0)>=p.protein){let ae=1;for(let ne=1;ne<7;ne++){const $e=new Date;$e.setDate($e.getDate()-ne);const Qe=$e.toISOString().split("T")[0];try{const Ke=await _s(Be(ge,"nutritionLogs",`${t.id}_${Qe}`));if(Ke.exists())if((Ke.data().entries||[]).reduce((At,Cn)=>At+(Cn.protein||0),0)>=p.protein)ae++;else break;else break}catch{break}}if(ae>=7){const ne=await ef("nutrition_7",t);ne&&T(ne)}}}catch(H){console.error("Error saving nutrition log:",H)}},Z=K===Yr(),C=(P,H)=>new Date(P,H+1,0).getDate(),re=(P,H)=>new Date(P,H,1).getDay(),Re=P=>{if(P===Yr())return"Today";const H=new Date(P+"T12:00:00"),ae=new Date;return ae.setDate(ae.getDate()-1),P===ae.toISOString().split("T")[0]?"Yesterday":H.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},Ie=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],Fe=()=>{let P=parseFloat(R.weight);R.weightUnit==="lbs"&&(P*=.453592);let H;R.heightUnit==="cm"?H=parseFloat(R.height):H=(parseFloat(R.heightFeet)||0)*30.48+(parseFloat(R.heightInches)||0)*2.54;const ae=parseInt(R.age);let ne=R.gender==="male"?10*P+6.25*H-5*ae+5:10*P+6.25*H-5*ae-161;const Qe=ne*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[R.dailyActivity],Ke={low:100,moderate:200,high:300,daily:400},ot=Math.round(Qe+Ke[R.trainingFrequency]);let At=ot,Cn,Cs;switch(R.goal){case"lose":At=ot*(1-{light:.15,moderate:.2,harsh:.25}[R.deficitLevel]),Cn=2.2,Cs=.3;break;case"build":At=ot*1.1,Cn=2,Cs=.22;break;default:Cn=1.8,Cs=.25}At=Math.max(At,R.gender==="male"?1400:1100);const Yn=Math.round(P*Cn),Ms=Math.round(At*Cs/9),si=Math.max(0,Math.round((At-Yn*4-Ms*9)/4));U({calories:Math.round(At),protein:Yn,carbs:si,fats:Ms,bmr:Math.round(ne),neat:Math.round(Qe),exerciseAdd:Ke[R.trainingFrequency],tdee:Math.round(ot)})},Oe=async()=>{if(G)try{const P={clientId:t.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,goal:R.goal,updatedAt:Ft.now()};await ss(Be(ge,"nutritionTargets",t.id),P),b(P),y("dashboard"),Dt("Macro targets saved!","success")}catch(P){console.error("Error saving targets:",P),Dt("Failed to save targets. Please try again.","error")}},Lt=()=>{const P=R.weight&&parseFloat(R.weight)>0,H=R.age&&parseInt(R.age)>0,ae=R.heightUnit==="cm"?R.height&&parseFloat(R.height)>0:R.heightFeet&&parseFloat(R.heightFeet)>0||R.heightInches&&parseFloat(R.heightInches)>0;return P&&H&&ae},xt="nut_favourite_foods",lt=()=>{try{return JSON.parse(localStorage.getItem(xt)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const H=await _s(Be(ge,"favouriteFoods",t.id));if(H.exists()){const ae=H.data().items||[];localStorage.setItem(xt,JSON.stringify(ae)),rn(ne=>ne+1)}else{const ae=lt();ae.length>0&&await ss(Be(ge,"favouriteFoods",t.id),{items:ae,updatedAt:Ft.now()})}}catch(H){console.error("Error loading favourites:",H)}})()},[t?.id]);const un=P=>lt().some(H=>H.name.toLowerCase()===(P||"").toLowerCase()),dn=P=>{const H=lt(),ae=H.findIndex(ne=>ne.name.toLowerCase()===P.name.toLowerCase());ae>=0?H.splice(ae,1):H.unshift({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving,per100g:P.per100g||null,servingUnit:P.servingUnit||"g",portion:P.portion||null}),localStorage.setItem(xt,JSON.stringify(H)),t?.id&&ss(Be(ge,"favouriteFoods",t.id),{items:H,updatedAt:Ft.now()}).catch(ne=>console.error("Error saving favourites:",ne)),rn(ne=>ne+1)},Pn=P=>{const H=[...ee.entries,{...P,meal:Te,id:Date.now(),addedAt:new Date().toISOString()}],ae={...ee,entries:H};ye(ae),It(ae),ce(null),pt(null),it("100"),mt(0),Bt("weight"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Dt("Food added!","success")},ms=P=>{const H=ee.entries.filter(ne=>ne.id!==P),ae={...ee,entries:H};ye(ae),It(ae)},ue=async P=>{if(!(!t?.id||P===K)){te(!0);try{const H=await _s(Be(ge,"nutritionLogs",`${t.id}_${P}`));if(!H.exists()||!H.data().entries?.length){Dt("No food logged on that day","error");return}const ae=H.data().entries.map(Qe=>({...Qe,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ne=[...ee.entries,...ae],$e={...ee,entries:ne};ye($e),It($e),L(!1),Dt(`Copied ${ae.length} items from ${Re(P)}`,"success")}catch(H){console.error("Error copying day:",H),Dt("Failed to copy day","error")}finally{te(!1)}}},Me=w.useRef(null),Ge=w.useRef([]),ct=3,et=5,$t=async()=>{Se(!0);const P=document.querySelector("#barcode-reader");if(!P){Se(!1),Dt("Scanner container not found.","error");return}if(!Me.current)try{const ae=await Js(()=>import("./quagga.min-BbicSfvA.js").then(ne=>ne.q),[]);Me.current=ae.default}catch(ae){console.error("Failed to load barcode scanner:",ae),Se(!1),Dt("Could not load scanner.","error");return}const H=Me.current;H.init({inputStream:{type:"LiveStream",target:P,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ae=>{if(ae){console.error("Quagga init error:",ae),Se(!1),Dt("Could not access camera. Check permissions.","error");return}H.start(),Ln.current=!0}),Ge.current=[],H.onDetected(ae=>{const ne=ae.codeResult.decodedCodes?.filter(Qe=>Qe.error!==void 0)?.map(Qe=>Qe.error)||[];if((ne.length>0?ne.reduce((Qe,Ke)=>Qe+Ke,0)/ne.length:1)<.15){const Qe=ae.codeResult.code,Ke=Ge.current;Ke.push(Qe),Ke.length>et&&Ke.shift(),Ke.filter(At=>At===Qe).length>=ct&&(H.offDetected(),Ge.current=[],Pe(Qe))}})},hn=()=>{const P=Me.current;Ln.current&&P&&(P.stop(),P.offDetected(),Ln.current=!1),Se(!1)},Nt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Ct=P=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((P||"").replace(/\s/g,"")),vn=P=>{if(!P)return{value:100,unit:"g"};const H=P.toLowerCase().replace(/\s/g,""),ae=H.match(/([\d.]+)/),ne=ae?parseFloat(ae[1]):100;return Ct(P)?/cl/.test(H)?{value:ne*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(H)&&!/ml/.test(H)?{value:ne*1e3,unit:"ml"}:{value:ne,unit:"ml"}:{value:ne,unit:"g"}},Ss=P=>{if(Ct(P.serving_size)||Ct(P.quantity))return"ml";const H=P.product_name||P.product_name_en||"";return Nt.test(H)?"ml":"g"},ni=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],bi=(P,H)=>{const ae=P||"",ne=ae.match(/\((\d+\.?\d*)\s*g\)/i),$e=ae.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ne&&$e){const ot=parseFloat(ne[1]);let At=$e[1].replace(/^\d+\s*/,"").trim();if(At&&ot>0)return{label:At,weight:ot}}const Qe=ae.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Qe){const ot=parseFloat(Qe[1]);let At=Qe[2].replace(/^\d+\s*/,"").trim();if(At&&ot>0)return{label:At,weight:ot}}const Ke=H||"";for(const{pattern:ot,label:At,weight:Cn}of ni)if(ot.test(Ke))return{label:At,weight:Cn};return null},Pr=P=>{const H=P.nutriments||{},ae=Ss(P),ne=vn(P.serving_size),$e=ae==="ml"?ne.unit==="ml"?ne.value:100:ne.value,Qe=P.product_name||P.product_name_en||"Unknown Product",Ke=bi(P.serving_size,Qe);return{name:Qe,brand:P.brands||"",image:P.image_small_url||P.image_url||null,servingSize:P.serving_size||"100g",servingValue:$e,servingUnit:ae,portion:Ke,protein:Math.round(H.proteins_100g||H.proteins||0),carbs:Math.round(H.carbohydrates_100g||H.carbohydrates||0),fats:Math.round(H.fat_100g||H.fat||0),calories:Math.round(H["energy-kcal_100g"]||H["energy-kcal"]||(H.energy_100g?H.energy_100g/4.184:0)),per100g:!0}},js=async P=>{Qt(!0);try{const H=`https://world.openfoodfacts.org/api/v2/product/${P}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ae=await fetch(H);if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const ne=await ae.json();if(ne.status==="success"||ne.status===1||ne.product){const $e=Pr(ne.product);$e.calories===0&&$e.protein===0&&$e.carbs===0?Dt("Product found but no nutrition data available.","error"):(pt($e),$e.portion?(mt(1),it(String($e.portion.weight)),Bt("portion")):(mt(0),it(String($e.servingValue||100)),Bt("weight")),Ye(""))}else Dt("Product not found. Try search or manual entry.","error")}catch(H){console.error("Barcode lookup error:",H),Dt("Failed to look up product. Check your connection.","error")}Qt(!1)},hr=(P,H,ae)=>{const ne=P.toLowerCase().trim(),$e=H.toLowerCase().trim(),Qe=ae.toLowerCase().trim();let Ke=0;return(ne===Qe||ne===Qe+"s"||ne+"s"===Qe)&&(Ke+=100),(ne.endsWith(" "+Qe)||ne.endsWith(" "+Qe+"s"))&&(Ke+=40),(ne.startsWith(Qe+" ")||ne.startsWith(Qe+"s "))&&(Ke+=15),Qe.split(/\s+/).some(At=>$e===At||$e.startsWith(At))&&(Ke+=30),Ke+=Math.max(0,30-ne.length),Ke},Gn=async()=>{if(!Rt.trim())return;On.current&&On.current.abort();const P=new AbortController;On.current=P;const H=Rt.trim().toLowerCase(),ae=H.split(/\s+/).filter(Boolean);if(ep.has(H)){qt(ep.get(H));return}gn(!0);try{const $e=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Rt.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Qe=await fetch($e,{signal:P.signal});if(!Qe.ok)throw new Error(`HTTP ${Qe.status}`);const ot=((await Qe.json()).products||[]).map(At=>Pr(At)).filter(At=>At.name!=="Unknown Product"&&(At.calories>0||At.protein>0)).filter(At=>{const Cn=(At.name+" "+At.brand).toLowerCase();return ae.every(Cs=>Cn.includes(Cs))}).sort((At,Cn)=>hr(Cn.name,Cn.brand,H)-hr(At.name,At.brand,H)).slice(0,10);ep.set(H,ot),qt(ot),ot.length===0&&Dt("No results found. Try a different search.","info")}catch(ne){if(ne.name==="AbortError")return;console.error("Search error:",ne),Dt("Search failed. Check your connection.","error")}gn(!1)};w.useEffect(()=>{if(cn.current&&clearTimeout(cn.current),!(!Rt.trim()||V!=="search"||le))return cn.current=setTimeout(()=>{Gn()},700),()=>clearTimeout(cn.current)},[Rt]);const os=l,ls={"ring-protein":os?"#2dd4bf":"#14b8a6","ring-carbs":os?"#fbbf24":"#f59e0b","ring-fats":os?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Vn=80,bn=2*Math.PI*Vn,Zn=(P,H,ae,ne,$e)=>{const Qe=ne>0?Math.min(100,Math.round(ae/ne*100)):0,Ke=bn-Qe/100*bn,ot=ls[$e]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Vn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Vn,style:{stroke:ot},strokeDasharray:bn,strokeDashoffset:Ke})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:ot},children:Math.round(ae)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ne,P==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:ot},children:H})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:ot},children:[Qe,"%"]})]})};if(w.useEffect(()=>{if(!_e)return;const P=setTimeout(()=>{const H=_e;hn(),Pe(null),js(H)},1500);return()=>clearTimeout(P)},[_e]),w.useEffect(()=>()=>{const P=Me.current;if(Ln.current&&P){try{P.stop(),P.offDetected()}catch{}Ln.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:R.gender==="male"?"active":"",onClick:()=>{q(P=>({...P,gender:"male"})),U(null)},children:"Male"}),a.jsx("button",{className:R.gender==="female"?"active":"",onClick:()=>{q(P=>({...P,gender:"female"})),U(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:R.age,onChange:P=>{q(H=>({...H,age:P.target.value})),U(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:R.weight,onChange:P=>{q(H=>({...H,weight:P.target.value})),U(null)},placeholder:R.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.weightUnit==="kg"?"active":"",onClick:()=>{q(P=>({...P,weightUnit:"kg"})),U(null)},children:"kg"}),a.jsx("button",{className:R.weightUnit==="lbs"?"active":"",onClick:()=>{q(P=>({...P,weightUnit:"lbs"})),U(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[R.heightUnit==="cm"?a.jsx("input",{type:"number",value:R.height,onChange:P=>{q(H=>({...H,height:P.target.value})),U(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:R.heightFeet,onChange:P=>{q(H=>({...H,heightFeet:P.target.value})),U(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:R.heightInches,onChange:P=>{q(H=>({...H,heightInches:P.target.value})),U(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.heightUnit==="cm"?"active":"",onClick:()=>{q(P=>({...P,heightUnit:"cm"})),U(null)},children:"cm"}),a.jsx("button",{className:R.heightUnit==="ft"?"active":"",onClick:()=>{q(P=>({...P,heightUnit:"ft"})),U(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:R.dailyActivity,onChange:P=>{q(H=>({...H,dailyActivity:P.target.value})),U(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:R.trainingFrequency,onChange:P=>{q(H=>({...H,trainingFrequency:P.target.value})),U(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:R.goal==="lose"?"active":"",onClick:()=>{q(P=>({...P,goal:"lose"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:R.goal==="maintain"?"active":"",onClick:()=>{q(P=>({...P,goal:"maintain"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:R.goal==="build"?"active":"",onClick:()=>{q(P=>({...P,goal:"build"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),R.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:R.deficitLevel==="light"?"active":"",onClick:()=>{q(P=>({...P,deficitLevel:"light"})),U(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="moderate"?"active":"",onClick:()=>{q(P=>({...P,deficitLevel:"moderate"})),U(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="harsh"?"active":"",onClick:()=>{q(P=>({...P,deficitLevel:"harsh"})),U(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Fe,disabled:!Lt(),children:"Calculate Macros"})]}),G&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[Zn("Protein","Protein",G.protein,G.protein,"ring-protein"),Zn("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),Zn("Fats","Fats",G.fats,G.fats,"ring-fats"),Zn("Calories","Calories",G.calories,G.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[G.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[G.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[G.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Oe,children:"Set as My Daily Targets"})]})]}),Jn&&a.jsx("div",{className:`toast-notification ${Jn.type}`,children:Jn.message})]});const xr=P=>{const H=new Date(P+"T12:00:00"),ae=H.getDay(),ne=new Date(H);ne.setDate(H.getDate()-(ae+6)%7);const $e=[];for(let Qe=0;Qe<7;Qe++){const Ke=new Date(ne);Ke.setDate(ne.getDate()+Qe),$e.push(Ke.toISOString().split("T")[0])}return $e},Hs=["M","T","W","T","F","S","S"],Kn=(P,H="search")=>{He(P),H==="scan"?(ce("scan"),pt(null)):H==="manual"?(ce("manual"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):H==="favourites"?ce("favourites"):(ce("search"),qt([]),Sn(""))},_r=xr(K),es=new Date(K+"T12:00:00"),Vr=`${Ie[es.getMonth()]} ${es.getFullYear()}`;return a.jsx(sl,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),U(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const P=new Date(K+"T12:00:00");P.setDate(P.getDate()-7);const H=P.toISOString().split("T")[0];Y(H)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{E(!I),B({year:es.getFullYear(),month:es.getMonth()})},children:Vr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const P=new Date(K+"T12:00:00");P.setDate(P.getDate()+7);const H=P.toISOString().split("T")[0];H<=Yr()&&Y(H)},"aria-label":"Next week",disabled:_r[6]>=Yr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:_r.map((P,H)=>{const ae=new Date(P+"T12:00:00").getDate(),ne=P===K,$e=P>Yr(),Qe=P===Yr();return a.jsxs("button",{className:`nut-week-day${ne?" selected":""}${Qe?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>Y(P),children:[a.jsx("span",{className:"nut-week-day-letter",children:Hs[H]}),a.jsx("span",{className:"nut-week-day-num",children:ae})]},P)})})]}),I&&a.jsxs("div",{className:"nut-calendar",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>B(P=>{let H=P.month-1,ae=P.year;return H<0&&(H=11,ae--),{year:ae,month:H}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[O.month]," ",O.year]}),a.jsx("button",{onClick:()=>B(P=>{let H=P.month+1,ae=P.year;return H>11&&(H=0,ae++),{year:ae,month:H}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(P=>a.jsx("span",{children:P},P))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(re(O.year,O.month))].map((P,H)=>a.jsx("span",{},`e${H}`)),[...Array(C(O.year,O.month))].map((P,H)=>{const ae=H+1,ne=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,$e=ne>Yr(),Qe=ne===K,Ke=ne===Yr();return a.jsx("button",{className:`nut-cal-day${Qe?" selected":""}${Ke?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>{Y(ne),E(!1)},children:ae},ae)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Zn("Protein","Protein",ke.protein,p.protein,"ring-protein"),Zn("Carbs","Carbs",ke.carbs,p.carbs,"ring-carbs"),Zn("Fats","Fats",ke.fats,p.fats,"ring-fats"),Zn("Calories","kCal",ke.calories,p.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[Z&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{L(!0),Le({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Gw.map(P=>{const H=ee.entries.filter(ne=>(ne.meal||"snacks")===P.key),ae=H.reduce((ne,$e)=>({protein:ne.protein+($e.protein||0),carbs:ne.carbs+($e.carbs||0),fats:ne.fats+($e.fats||0),calories:ne.calories+($e.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${P.key}`,children:R3[P.key]}),a.jsx("span",{className:"nut-meal-card-title",children:P.label}),H.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[ae.calories," cal"]}),Z&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>We(Ae===P.key?null:P.key),"aria-label":`Add to ${P.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),H.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,p.protein>0?ae.protein/p.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,p.carbs>0?ae.carbs/p.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,p.fats>0?ae.fats/p.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,p.calories>0?ae.calories/p.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:ae.calories})]})]}),H.length>0&&a.jsx("div",{className:"nut-log-list",children:H.map(ne=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${un(ne.name)?" active":""}`,onClick:()=>dn(ne),"aria-label":un(ne.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:un(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ne.name}),ne.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ne.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ne.calories})]}),Z&&a.jsx("button",{className:"nut-log-delete",onClick:()=>ms(ne.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))}),H.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Z?"Tap + to add food":"No entries"})})]},P.key)})})})]})}),Ae&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>We(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Gw.find(P=>P.key===Ae)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const P=Ae;We(null),Kn(P,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const P=Ae;We(null),Kn(P,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const P=Ae;We(null),Kn(P,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const P=Ae;We(null),Kn(P,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),D&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>L(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>L(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Le(P=>{let H=P.month-1,ae=P.year;return H<0&&(H=11,ae--),{year:ae,month:H}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[A.month]," ",A.year]}),a.jsx("button",{onClick:()=>Le(P=>{let H=P.month+1,ae=P.year;return H>11&&(H=0,ae++),{year:ae,month:H}}),disabled:A.year===new Date().getFullYear()&&A.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(P=>a.jsx("span",{children:P},P))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(re(A.year,A.month))].map((P,H)=>a.jsx("span",{},`e${H}`)),[...Array(C(A.year,A.month))].map((P,H)=>{const ae=H+1,ne=`${A.year}-${String(A.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,$e=ne>Yr(),Qe=ne===K,Ke=ne===Yr(),ot=$e||Qe;return a.jsx("button",{className:`nut-cal-day${Qe?" selected":""}${Ke?" today":""}${$e?" future":""}`,disabled:ot,onClick:()=>ue(ne),children:ae},ae)})]}),st&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{hn(),Pe(null),ce(null),pt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:V==="scan"?"Scan Barcode":V==="search"?"Search Food":V==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{hn(),Pe(null),ce(null),pt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),V==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),je&&!_e&&a.jsx("div",{className:"nut-scan-line"}),_e&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:_e})]})]}),!je&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:$t,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),je&&!_e&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:ze,onChange:P=>Ye(P.target.value),onKeyDown:P=>P.key==="Enter"&&ze.trim()&&js(ze.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>ze.trim()&&js(ze.trim()),disabled:!ze.trim()||Je,children:Je?"...":"Look Up"})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="scan"&&le&&(()=>{const P=le.servingUnit||"g",H=le.portion,ae=wt==="portion"&&H?yt*H.weight:parseFloat(Ht)||0,ne=ae/100,$e=P==="ml"?[100,200,250,500]:[50,100,150,200],Qe=wt==="portion"&&H?`${yt} ${H.label}${yt!==1?"s":""} (${Math.round(ae)}${P})`:`${Math.round(ae)}${P}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${un(le.name)?" active":""}`,onClick:()=>dn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:un(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",P,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),H&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&mt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(ae)||100))},children:["Custom (",P,")"]})]}),wt==="portion"&&H?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[H.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),P]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",P,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Ke=>it(Ke.target.value),onFocus:Ke=>Ke.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ke=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Ke)?" active":""}`,onClick:()=>it(String(Ke)),children:[Ke,P]},Ke))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{pt(null),ce("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Pn({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Qe}),children:"Add"})]})]})})(),V==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Gt,value:Rt,onChange:P=>Sn(P.target.value),onKeyDown:P=>{P.key==="Enter"&&(clearTimeout(cn.current),Gn())},onFocus:()=>setTimeout(()=>Gt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Gn,disabled:Tt,children:Tt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[on.map((P,H)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{pt(P),P.portion?(mt(1),it(String(P.portion.weight)),Bt("portion")):(mt(0),it(String(P.servingValue||100)),Bt("weight"))},children:[P.image&&a.jsx("img",{src:P.image,alt:P.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:P.name}),P.brand&&a.jsx("span",{className:"nut-search-item-brand",children:P.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[P.calories," cal  ",P.protein,"p  ",P.carbs,"c  ",P.fats,"f per 100",P.servingUnit||"g"]})]})]},H)),on.length===0&&Rt&&!Tt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),V==="search"&&le&&(()=>{const P=le.servingUnit||"g",H=le.portion,ae=wt==="portion"&&H?yt*H.weight:parseFloat(Ht)||0,ne=ae/100,$e=P==="ml"?[100,200,250,500]:[50,100,150,200],Qe=wt==="portion"&&H?`${yt} ${H.label}${yt!==1?"s":""} (${Math.round(ae)}${P})`:`${Math.round(ae)}${P}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${un(le.name)?" active":""}`,onClick:()=>dn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:un(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",P,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),H&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&mt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(ae)||100))},children:["Custom (",P,")"]})]}),wt==="portion"&&H?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[H.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),P]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",P,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Ke=>it(Ke.target.value),onFocus:Ke=>Ke.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ke=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Ke)?" active":""}`,onClick:()=>it(String(Ke)),children:[Ke,P]},Ke))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Pn({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Qe}),children:"Add"})]})]})})(),V==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:St.name,onChange:P=>ut(H=>({...H,name:P.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:St.serving,onChange:P=>ut(H=>({...H,serving:P.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:St.protein,onChange:P=>ut(H=>({...H,protein:P.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:St.carbs,onChange:P=>ut(H=>({...H,carbs:P.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:St.fats,onChange:P=>ut(H=>({...H,fats:P.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:St.calories,onChange:P=>ut(H=>({...H,calories:P.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!St.name.trim(),onClick:()=>Pn({name:St.name,protein:parseFloat(St.protein)||0,carbs:parseFloat(St.carbs)||0,fats:parseFloat(St.fats)||0,calories:parseFloat(St.calories)||0,serving:St.serving||""}),children:"Add Food"})]}),V==="favourites"&&!le&&(()=>{const P=lt(),H=ae=>{if(ae.per100g){const ne=ae.per100g;pt({name:ae.name,brand:"",image:null,servingSize:ae.serving||"100g",servingValue:100,servingUnit:ae.servingUnit||"g",portion:ae.portion||null,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,per100g:!0}),ae.portion?(mt(1),it(String(ae.portion.weight)),Bt("portion")):(mt(0),it("100"),Bt("weight"))}else Pn({name:ae.name,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,serving:ae.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:P.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:P.map((ae,ne)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:$e=>{$e.stopPropagation(),dn(ae)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>H(ae),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:ae.name}),a.jsx("span",{className:"nut-recent-item-serving",children:ae.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[ae.calories," cal"]})]})]},ne))})})})(),V==="favourites"&&le&&(()=>{const P=le.servingUnit||"g",H=le.portion,ae=wt==="portion"&&H?yt*H.weight:parseFloat(Ht)||0,ne=ae/100,$e=P==="ml"?[100,200,250,500]:[50,100,150,200],Qe=wt==="portion"&&H?`${yt} ${H.label}${yt!==1?"s":""} (${Math.round(ae)}${P})`:`${Math.round(ae)}${P}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${un(le.name)?" active":""}`,onClick:()=>dn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:un(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",P,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),H&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:wt==="portion"?"active":"",onClick:()=>{Bt("portion"),yt<1&&mt(1)},children:"Portions"}),a.jsxs("button",{className:wt==="weight"?"active":"",onClick:()=>{Bt("weight"),it(String(Math.round(ae)||100))},children:["Custom (",P,")"]})]}),wt==="portion"&&H?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[H.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),P]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>mt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",P,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Ke=>it(Ke.target.value),onFocus:Ke=>Ke.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ke=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(Ke)?" active":""}`,onClick:()=>it(String(Ke)),children:[Ke,P]},Ke))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Pn({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Qe}),children:"Add"})]})]})})()]})}),a.jsx(ti,{active:"nutrition"}),Jn&&a.jsx("div",{className:`toast-notification ${Jn.type}`,children:Jn.message}),a.jsx(Kl,{badge:k,onDismiss:()=>T(null)})]})})}async function D3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,g=1080,y=1920,p=document.createElement("canvas");p.width=g,p.height=y;const b=p.getContext("2d"),k="#2a2a28",T="#ffffff",R="#A12F3A",q="#1a1a1a",G="#555555";b.fillStyle=k,b.fillRect(0,0,g,y);const U=Math.round(g*.82),K=Math.round(y*.75),Y=Math.round((g-U)/2),ee=Math.round((y-K)/2),ye=28,ke=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Kw(b,Y,ee,U,K,ye),b.fillStyle=T,b.fill(),b.restore(),b.save(),Kw(b,Y,ee,U,K,ye),b.strokeStyle=R,b.lineWidth=ke,b.stroke(),b.restore();const ve=220,I=50,E=52,O=68,B=10,D=36,L=48,A=30,Le=34,st=46,te=30,Te=28;b.font=`bold ${E}px 'Orbitron', sans-serif`;const He=su(b,t.toUpperCase(),U-100);b.font=`500 ${D}px 'Montserrat', sans-serif`;let Ae=[];e==="badge"&&d?Ae=su(b,d,U-120):e==="badge"&&l.length>0?Ae=su(b,l.join("    "),U-120):i.length>0&&(Ae=su(b,i.map(Tt=>`${Tt.value} ${Tt.label}`).join("    "),U-120));const We=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Le}px 'Montserrat', sans-serif`;const V=su(b,We,U-80);let ce=He.length*O;Ae.length>0&&(ce+=B+Ae.length*L),ce+=A+V.length*st,ce+=te+Te;const Se=ee+K-60-ce,Pe=ee+40,ze=Se-I,Ye=g/2,Je=(Pe+ze)/2,Qt=e==="badge"&&u?u:"/Logo.webp";b.save();const Rt=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Sn=b.createRadialGradient(Ye,Je,ve*.6,Ye,Je,ve*1.5);Sn.addColorStop(0,Rt),Sn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Sn,b.fillRect(Ye-ve*1.5,Je-ve*1.5,ve*3,ve*3),b.restore(),b.beginPath(),b.arc(Ye,Je,ve+6,0,Math.PI*2),b.fillStyle=T,b.fill();const on=e==="badge"?"#ffc107":R;b.beginPath(),b.arc(Ye,Je,ve,0,Math.PI*2),b.strokeStyle=on,b.lineWidth=5,b.stroke();try{const Tt=await L3(Qt);b.save(),b.beginPath(),b.arc(Ye,Je,ve-6,0,Math.PI*2),b.clip();const gn=(ve-6)*2;b.drawImage(Tt,Ye-ve+6,Je-ve+6,gn,gn),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=R,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Ye,Je)}let qt=Se;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=q,b.font=`bold ${E}px 'Orbitron', sans-serif`;for(const Tt of He)b.fillText(Tt,g/2,qt),qt+=O;if(Ae.length>0){qt+=B,b.fillStyle=G,b.font=`500 ${D}px 'Montserrat', sans-serif`;for(const Tt of Ae)b.fillText(Tt,g/2,qt),qt+=L}qt+=A,b.fillStyle=q,b.font=`bold ${Le}px 'Montserrat', sans-serif`;for(const Tt of V)b.fillText(Tt,g/2,qt),qt+=st;return qt+=te,b.fillStyle=R,b.font=`600 ${Te}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",g/2,qt),new Promise(Tt=>{p.toBlob(gn=>Tt(gn),"image/png")})}function Kw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function L3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function su(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const g=u?`${u} ${d}`:d;s.measureText(g).width>t&&u?(l.push(u),u=d):u=g}return u&&l.push(u),l}function O3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=50,p.gain.value=.3,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2);const b=u.createOscillator(),k=u.createGain();b.type="sine",b.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),b.connect(k).connect(g),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=55,p.gain.value=.35,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,g)=>{const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=g===0?523:784,p.gain.value=.12,p.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),y.connect(p).connect(u.destination),y.start(u.currentTime+d),y.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const P3=2e3,Wp=42,Ol=2*Math.PI*Wp,V3=1200,Yw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Gp({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:g="Done",holdLabel:y="Hold To Complete Session",shareType:p="workout",hideShare:b=!1}){const[k,T]=w.useState("hold"),[R,q]=w.useState(!1),[G,U]=w.useState(0),[K,Y]=w.useState(!1),[ee,ye]=w.useState(!1),[ke,ve]=w.useState(null),I=O3(),E=w.useRef(null),O=w.useRef(null),B=w.useRef(null),D=w.useRef(null),L=w.useRef(!1),A=w.useRef(!1),Le=w.useRef(0),st=w.useRef(Yw[Math.floor(Math.random()*Yw.length)]),te=w.useRef([...Array(80)].map((_e,Pe)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Pe%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Pe%3}))),Te=w.useCallback(()=>{if(L.current)return;L.current=!0,A.current=!1,Le.current=0,q(!0),U(0),D.current=performance.now(),I.tap(),E.current&&(E.current.style.strokeDashoffset=Ol);const _e=Pe=>{const ze=Pe-D.current,Ye=Math.min(ze/P3,1);if(E.current&&(E.current.style.strokeDashoffset=Ol-Ye*Ol),O.current){const Je=8*(1-Ye),Qt=1-Ye,Rt=1+Ye*.15;O.current.style.filter=`blur(${Je}px) grayscale(${Qt})`,O.current.style.transform=`scale(${Rt})`}U(Ye),ze-Le.current>=V3&&(Le.current=ze,I.tick()),Ye<1?B.current=requestAnimationFrame(_e):(L.current=!1,A.current=!0,B.current=null,q(!1),U(1),I.complete(),T("celebrate"))};B.current=requestAnimationFrame(_e)},[I]),He=w.useCallback(()=>{L.current&&(L.current=!1,B.current&&(cancelAnimationFrame(B.current),B.current=null),E.current&&(E.current.style.strokeDashoffset=Ol),O.current&&(O.current.style.filter="",O.current.style.transform=""),q(!1),U(0))},[]),Ae=w.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),We=w.useCallback(()=>{const _e=[s||"Workout Complete!"];return e&&_e.push(e),t?.length&&_e.push(t.map(Pe=>`${Pe.value} ${Pe.label}`).join(" | ")),_e.push("#MindCoreFitness"),_e.join(`
`)},[s,e,t]),V=w.useCallback(async()=>{if(!(ee||!u))try{await u({type:p==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current}),ye(!0),ve("Posted to Journey!"),setTimeout(()=>ve(null),2500)}catch(_e){console.error("Journey post failed:",_e),ve(_e?.message||"Failed to post"),setTimeout(()=>ve(null),3500)}},[ee,u,s,e,t]),[ce,je]=w.useState(!1),Se=w.useCallback(async()=>{je(!0);try{const _e=await D3({type:p||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current,userName:d}),Pe=We();if(navigator.share&&navigator.canShare?.({files:[new File([_e],"workout.png",{type:"image/png"})]})){const ze=new File([_e],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Pe,files:[ze]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Pe}):(await navigator.clipboard.writeText(Pe),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500))}catch{try{await navigator.clipboard.writeText(We()),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500)}catch{}}finally{je(!1)}},[s,e,t,d,We]);return k==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${R?"wc-holding":""}`,onPointerDown:_e=>{_e.preventDefault(),Te()},onPointerUp:He,onPointerLeave:He,onPointerCancel:He,onClick:_e=>{_e.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:_e=>{(_e.key==="Enter"||_e.key===" ")&&(_e.preventDefault(),I.complete(),T("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Wp}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:E,cx:"50",cy:"50",r:Wp,style:{strokeDasharray:Ol,strokeDashoffset:Ol}})]}),a.jsx("img",{ref:O,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${K?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:te.current.map((_e,Pe)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${_e.shape}`,style:{"--x":`${_e.x}%`,"--delay":`${_e.delay}s`,"--color":_e.color,"--drift":`${_e.drift}px`,"--spin":`${_e.spin}deg`,"--duration":`${_e.duration}s`,width:`${_e.width}px`,height:`${_e.height}px`}},Pe))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:st.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((_e,Pe)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:_e.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:_e.label})]},Pe))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${ee?"wc-share-done":""}`,onClick:V,disabled:ee,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),ee?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Se,disabled:ce,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ce?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Ae,children:g}),ke&&a.jsx("div",{className:"wc-share-toast",children:ke})]})]})}const Qw="/login/assets/randomiser-glq9YJkL.jpg",Xw="/login/assets/programme-card-workout-CnNzTYkz.webp",U3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",B3="/login/assets/muscle-group-arms-C9AdZL4-.png",z3="/login/assets/arms-bicep-BUrmT1o-.png",F3="/login/assets/arms-tricep-D9tAnFnS.png",H3="/login/assets/arms-full-arms-BY3TvpJm.png",q3="/login/assets/muscle-group-chest-Cxfuc7XI.png",$3="/login/assets/chest-strength-BR4BAFTH.png",W3="/login/assets/chest-hypertrophy-B8yNrvjB.png",G3="/login/assets/chest-endurance-e-OSWtWO.png",K3="/login/assets/muscle-group-shoulders-DibNtCLF.png",Y3="/login/assets/shoulders-strength-CKlZBF5A.png",Q3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",X3="/login/assets/shoulders-endurance-HuqNG5rD.png",J3="/login/assets/muscle-group-core-CPR-bdRg.png",Z3="/login/assets/core-lower-abs-TVcqGMFJ.png",e5="/login/assets/core-obliques-rotation-Djb7Qlbk.png",t5="/login/assets/core-weighted-core-4Kwh9mTv.png",n5="/login/assets/muscle-group-back-8JPV-YUo.png",s5="/login/assets/back-strength-BmSRxnwo.png",r5="/login/assets/back-hypertrophy-CXHmsnCz.png",i5="/login/assets/back-endurance-C8qJ8l5I.png",a5="/login/assets/muscle-group-legs-B8jcbdov.png",o5="/login/assets/legs-quads-DbnfsebI.png",l5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",c5="/login/assets/legs-power-plyo-D2qBXeUR.png",u5=60,tp=5,d5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},h5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},np={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},sp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:U3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],ru=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:B3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:q3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:n5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:K3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:a5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:J3}],Jw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:$3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:W3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:G3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:s5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:r5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:i5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:Y3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:Q3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:X3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:z3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:F3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:H3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:o5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:l5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:c5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:Z3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:e5,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:t5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},rp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Qr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ci=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],ip=[5,10,15,20,30],f5=new Set(["single leg v-up","hollow hold to v-sit","reverse crunch to leg raise","side plank rotation","hip dips plank","alternating cross body v-up","alternating cross body v up","bent hollow hold","heels elevated glute bridge","hollow body hold","hollow body rock","star side plank","straddle leg lift","leg raise to hip lift","scorpion kicks","seated v hold"]),yh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Zw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function m5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function g5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function p5({src:s,...e}){const t=w.useRef(null),[i,l]=w.useState(!1);return w.useEffect(()=>{const u=t.current;if(!u)return;const d=new IntersectionObserver(([g])=>{g.isIntersecting&&(l(!0),d.disconnect())},{rootMargin:"200px"});return d.observe(u),()=>d.disconnect()},[]),a.jsx("video",{ref:t,src:i?s:void 0,...e})}function y5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Or(),{isDark:l,toggleTheme:u}=Ui(),{isPremium:d,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=hc(),p=Zs(),[b,k]=w.useState("randomiser_hub"),[T,R]=w.useState(["bodyweight"]),[q,G]=w.useState("core"),[U,K]=w.useState("intermediate"),[Y,ee]=w.useState(d?15:5),[ye,ke]=w.useState([]),[ve,I]=w.useState(!1),E=w.useRef(!1),O=w.useRef([]),B=w.useRef(""),[D,L]=w.useState([]),[A,Le]=w.useState(2),[st,te]=w.useState(Ci[1]),[Te,He]=w.useState(1),[Ae,We]=w.useState(0),[V,ce]=w.useState("work"),[je,Se]=w.useState(0),[_e,Pe]=w.useState(!1),[ze,Ye]=w.useState(0),[Je,Qt]=w.useState(!1),[Rt,Sn]=w.useState(!1),[on,qt]=w.useState(null),Tt=w.useRef(null);w.useRef(null),w.useRef(null);const[gn,St]=w.useState(null),ut=w.useCallback((M,F="info")=>{St({message:M,type:F}),setTimeout(()=>St(null),3e3)},[]),le=w.useCallback(async M=>{if(!t)throw new Error("Not signed in");const F=M&&typeof M=="object"&&M.type;await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:F?"":M,type:F?M.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...F?{metadata:{title:M.title||"",subtitle:M.subtitle||"",stats:M.stats||[],quote:M.quote||"",badges:M.badges||[]}}:{}})},[t]),[pt,Ht]=w.useState(null),[it,yt]=w.useState(null),[mt,wt]=w.useState(0),[Bt,fs]=w.useState(0),[rn,Jn]=w.useState([]),[Fn,Ln]=w.useState(""),[On,cn]=w.useState(""),[Gt,Dt]=w.useState(!1),[It,Z]=w.useState(0),[C,re]=w.useState(!1),[Re,Ie]=w.useState({}),De=w.useRef(null),Fe=w.useRef(null),[Oe,Lt]=w.useState(0),[xt,lt]=w.useState(0),[un,dn]=w.useState(0),[Pn,ms]=w.useState(0),[ue,Me]=w.useState(0),[Ge,ct]=w.useState(0),[et,$t]=w.useState(null),[hn,Nt]=w.useState({beginner:0,intermediate:0,advanced:0}),Ct=d?ip:ip.filter(M=>g.includes(M)),vn=!d&&Oe>=y,[Ss,ni]=w.useState([]),[bi,Pr]=w.useState(!1),[js,hr]=w.useState({}),[Gn,os]=w.useState(!1),[ls,Vn]=w.useState(!1),[bn,Zn]=w.useState(""),[xr,Hs]=w.useState(null),[Kn,_r]=w.useState([]),[es,Vr]=w.useState({total:0,favouriteFocus:null,streak:0}),[P,H]=w.useState(null),[ae,ne]=w.useState(""),[$e,Qe]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=dt(ge,"workoutLogs"),$=tn(F,kt("clientId","==",t.id)),de=(await Wt($)).docs.map(gt=>gt.data()),pe=de.filter(gt=>gt.type!=="programme");ms(pe.length);const Ve=pe.reduce((gt,mn)=>gt+(mn.duration||0),0);Me(Ve);const tt={beginner:0,intermediate:0,advanced:0};pe.forEach(gt=>{gt.level&&tt[gt.level]!==void 0&&tt[gt.level]++}),Nt(tt);const nt=new Date,vt=nt.getDay(),_t=vt===0?-6:1-vt,Xt=new Date(nt);Xt.setDate(nt.getDate()+_t),Xt.setHours(0,0,0,0);const Hn=Xt.getTime(),rt=de.filter(gt=>{const mn=gt.completedAt;return mn?(mn.toDate?mn.toDate().getTime():new Date(mn).getTime())>=Hn:!1});Lt(rt.filter(gt=>gt.type!=="programme").length);let wn=0;if(t)try{const gt=await _s(Be(ge,"clientProgrammes",t.id));if(gt.exists()){const mn=gt.data(),Qn=mn.templateId;wn=rt.filter(As=>As.type==="programme"&&As.programmeId===Qn).length,H(Qn);const tr=sp.find(As=>As.id===Qn);tr&&ne(tr.name);const Ws=d5[Qn];if(Ws){const As=Object.keys(mn.completedSessions||{}).length,nr=Ws.duration*Ws.daysPerWeek;dn(nr>0?Math.round(As/nr*100):0)}}else H(null),ne(""),dn(0)}catch{}lt(wn);const fn=pe.map(gt=>gt.completedAt).filter(Boolean).map(gt=>gt.toDate?gt.toDate().getTime():new Date(gt).getTime()).sort((gt,mn)=>mn-gt);if(fn.length===0)ct(0);else{const gt=new Set;fn.forEach(nr=>{const Er=new Date(nr),go=Er.getDay(),rl=go===0?-6:1-go,ii=new Date(Er);ii.setDate(Er.getDate()+rl),ii.setHours(0,0,0,0),gt.add(ii.getTime())});const mn=[...gt].sort((nr,Er)=>Er-nr);let Qn=0;const tr=new Date(nt),Ws=nt.getDay()===0?-6:1-nt.getDay();tr.setDate(nt.getDate()+Ws),tr.setHours(0,0,0,0);let As=tr.getTime();mn.includes(As)||(As-=10080*60*1e3);for(let nr=0;nr<200&&mn.includes(As);nr++)Qn++,As-=10080*60*1e3;ct(Qn)}}catch(F){console.error("Error loading workout stats:",F)}finally{Qe(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=tn(dt(ge,"savedWorkouts"),kt("clientId","==",t.id)),X=(await Wt(F)).docs.map(de=>({id:de.id,...de.data()}));X.sort((de,pe)=>{const Ve=de.savedAt?.toMillis?.()||de.savedAt?.seconds*1e3||0;return(pe.savedAt?.toMillis?.()||pe.savedAt?.seconds*1e3||0)-Ve}),ni(X)}catch(F){console.error("Error loading saved workouts:",F)}finally{Pr(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const F=tn(dt(ge,"workoutLogs"),kt("clientId","==",t.id),$o("completedAt","desc"),Wo(20)),de=(await Wt(F)).docs.map(rt=>rt.data()).filter(rt=>rt.type!=="programme"&&rt.type!=="muscle_group");_r(de.slice(0,3));const pe=de.length,Ve={};de.forEach(rt=>{rt.focus&&(Ve[rt.focus]=(Ve[rt.focus]||0)+1)});const tt=Object.keys(Ve).sort((rt,wn)=>Ve[wn]-Ve[rt])[0]||null;let nt=0;if(de.length>0){const rt=new Set;de.forEach(gt=>{const mn=gt.completedAt?.toDate?gt.completedAt.toDate():gt.completedAt?new Date(gt.completedAt):null;mn&&rt.add(new Date(mn.getFullYear(),mn.getMonth(),mn.getDate()).toDateString())});const wn=new Date;wn.setHours(0,0,0,0);let fn=new Date(wn);for(rt.has(fn.toDateString())||fn.setDate(fn.getDate()-1);rt.has(fn.toDateString());)nt++,fn.setDate(fn.getDate()-1)}Vr({total:pe,favouriteFocus:tt,streak:nt});const vt={core:null,upper:null,lower:null,fullbody:null};de.forEach(rt=>{if(rt.focus&&vt[rt.focus]===null&&rt.completedAt){const wn=rt.completedAt.toDate?rt.completedAt.toDate():new Date(rt.completedAt);vt[rt.focus]=wn}});let _t=null,Xt=new Date;const Hn=["core","upper","lower","fullbody"];for(const rt of Hn){if(vt[rt]===null){const wn=Qr.find(fn=>fn.key===rt)?.label||rt;_t={focus:rt,label:wn,daysAgo:null,message:`You haven't tried ${wn} yet`};break}if(vt[rt]<Xt){Xt=vt[rt];const wn=Math.floor((Date.now()-vt[rt].getTime())/864e5);if(wn>=5){const fn=Qr.find(gt=>gt.key===rt)?.label||rt;_t={focus:rt,label:fn,daysAgo:wn,message:`${fn}  ${wn} days ago`}}}}Hs(_t)}catch(F){console.error("Error loading recent workouts:",F)}})()},[s,t,b]);const Ke=async M=>{if(!(!s||!t||D.length===0)){os(!0);try{const F=Qr.find(de=>de.key===q)?.label||q,$=M||`${F} ${Y}min`,X=await or(dt(ge,"savedWorkouts"),{clientId:t.id,name:$,equipment:T,focus:q,level:U,duration:Y,exercises:D.map(de=>({name:de.name,videoUrl:de.videoUrl,isGif:de.isGif||!1})),rounds:A,savedAt:Ft.now()});ni(de=>[{id:X.id,clientId:t.id,name:$,equipment:T,focus:q,level:U,duration:Y,exercises:D.map(pe=>({name:pe.name,videoUrl:pe.videoUrl,isGif:pe.isGif||!1})),rounds:A,savedAt:Ft.now()},...de]),ut("Workout saved!","success")}catch(F){console.error("Error saving workout:",F),ut("Failed to save workout","error")}finally{os(!1),Vn(!1),Zn("")}}},ot=async M=>{try{await ar(Be(ge,"savedWorkouts",M)),ni(F=>F.filter($=>$.id!==M)),ut("Workout removed","info")}catch(F){console.error("Error deleting saved workout:",F),ut("Failed to remove workout","error")}},At=M=>{R(M.equipment||["bodyweight"]),G(M.focus||"core"),K(M.level||"intermediate"),ee(M.duration||15);const F=Ci.find($=>$.key===(M.level||"intermediate"));te(F),L(M.exercises||[]),Le(M.rounds||2),k("preview")},Cn=async()=>{const M=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");R(M?.equipment||["bodyweight"]),G(M?.focus||"core"),K(M?.level||"intermediate"),ee(M?.duration||15),setTimeout(()=>wi(),50)},Cs=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:T,focus:q,level:U,duration:Y}))};localStorage.getItem("mcf_last_randomiser");const Yn=()=>{const M=[];let F;q==="mix"?F=["core","upper","lower"]:q==="fullbody"?F=["upper","lower"]:F=[q];for(const $ of T)for(const X of F)M.push(`exercises/${$}/${X}`);return M},Ms="mcf_exercise_urls",si=()=>{try{return JSON.parse(sessionStorage.getItem(Ms)||"{}")}catch{return{}}},Ds=M=>{try{sessionStorage.setItem(Ms,JSON.stringify(M))}catch{}},er=async()=>{if(E.current){for(;E.current;)await new Promise(F=>setTimeout(F,200));return O.current}const M=Yn().sort().join("|");if(O.current.length>0&&B.current===M)return O.current;E.current=!0,I(!0);try{const F=Yn(),$=[];for(const tt of F)try{const nt=oa(la,tt),vt=await qw(nt);$.push(...vt.items)}catch{console.warn(`Folder ${tt} not found, skipping.`)}if($.length===0&&T.includes("bodyweight")&&q==="core")try{const tt=oa(la,"core"),nt=await qw(tt);$.push(...nt.items)}catch{console.warn("Legacy core/ folder not found either.")}if($.length===0){const tt=T.map(vt=>rp.find(_t=>_t.key===vt)?.label).join(" + "),nt=Qr.find(vt=>vt.key===q)?.label;return ut(`No exercises found for ${tt} / ${nt}. Upload videos to Firebase Storage.`,"error"),E.current=!1,I(!1),[]}const X=new Set,de=$.filter(tt=>{const nt=tt.name.replace(/\.(mp4|gif)$/i,"");return X.has(nt)?!1:(X.add(nt),!0)}),pe=si(),Ve=await Promise.all(de.map(async tt=>{const nt=tt.fullPath;let vt=pe[nt];vt||(vt=await so(tt),pe[nt]=vt);const _t=m5(tt.name.replace(/\.(mp4|gif)$/i,"")),Xt=/\.gif$/i.test(tt.name);return{name:_t,videoUrl:vt,isGif:Xt}}));return Ds(pe),O.current=Ve,B.current=M,ke(Ve),E.current=!1,I(!1),Ve}catch(F){console.error("Error loading exercises:",F);const $=F.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${F.message||F.code||"Unknown error"}`;return ut($,"error"),E.current=!1,I(!1),[]}},wi=async()=>{if(vn)return;Cs(),k("spinning");const M=await er();if(M.length===0){k("setup");return}const F=Ci.find(_t=>_t.key===U);te(F);const $=F.work+F.rest,X=Y*60,de=Math.floor(X/$);let pe,Ve;de<=6?(pe=Math.max(3,Math.floor(de/2)),Ve=Math.floor(de/pe)):de<=12?(pe=Math.min(6,Math.floor(de/2)),Ve=Math.floor(de/pe)):(pe=Math.min(10,Math.floor(de/2)),Ve=Math.floor(de/pe)),Ve=Math.max(2,Ve);const tt=U==="beginner"?M.filter(_t=>!f5.has(_t.name.toLowerCase())):M,nt=g5(tt),vt=nt.slice(0,Math.min(pe,nt.length));L(vt),Le(Ve),setTimeout(()=>k("preview"),2e3)},kr=()=>{k("countdown"),Ye(3)};w.useEffect(()=>{if(b!=="countdown")return;if(ze<=0){k("workout"),He(1),We(0),ce("work"),Se(st.work),Pe(!1),Ls();return}$s();const M=setTimeout(()=>Ye(F=>F-1),1e3);return()=>clearTimeout(M)},[ze,b]),w.useEffect(()=>{if(b!=="workout"||_e)return;if(je<=0){Ns();return}je<=3&&$s();const M=setTimeout(()=>Se(F=>F-1),1e3);return()=>clearTimeout(M)},[je,b,_e]);const Ns=()=>{if(V==="work")ce("rest"),Se(st.rest);else{const M=Ae+1;if(M>=D.length){const F=Te+1;if(F>A){Qt(!0),_a();return}He(F),We(0)}else We(M);ce("work"),Se(st.work),Ls()}},_a=async()=>{if(s)try{await or(dt(ge,"workoutLogs"),{clientId:t.id,level:U,duration:Y,equipment:T,focus:q,exerciseCount:D.length,rounds:A,exercises:D.map(de=>de.name),completedAt:Ft.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:Y,level:U,focus_area:q,exercise_count:D.length}),Lt(de=>de+1);const M=Pn+1;ms(M),Me(de=>de+Y),Nt(de=>({...de,[U]:(de[U]||0)+1}));const F=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const de of F)if(M>=de.count){const pe=await ef(de.id,t);if(pe){$t(pe);break}}const $=Ge+(Oe===0?1:0),X=[{weeks:2,id:"streak_2"},{weeks:4,id:"streak_4"},{weeks:8,id:"streak_8"}];for(const de of X)if($>=de.weeks){const pe=await ef(de.id,t);pe&&!et&&$t(pe)}}catch(M){console.error("Error saving workout log:",M)}},Bi=async(M,F,$)=>{if(!(!t||!F))try{const X=t.id,de=await _s(Be(ge,"coreBuddyPBs",X)),Ve=(de.exists()?de.data():null)?.exercises||{},tt=Ve[M];let nt=!1;if(tt?(F>(tt.weight||0)||F===(tt.weight||0)&&$>(tt.reps||0))&&(nt=!0):nt=!0,nt){const vt={...Ve,[M]:{weight:F,reps:$,achievedAt:Ft.now()}};await ss(Be(ge,"coreBuddyPBs",X),{clientId:t.id,exercises:vt,updatedAt:Ft.now()}),ut(`New PB! ${F}kg  ${$} reps`,"success"),$s()}}catch(X){console.error("Error checking PB:",X)}},ri=async M=>{if(yt(M),M.interval){const X=[];for(const de of M.exercises){let pe=null,Ve=!1;if(de.storagePath)try{const tt=oa(la,de.storagePath);pe=await so(tt),Ve=/\.gif$/i.test(de.storagePath)}catch{}X.push({name:de.name,videoUrl:pe,isGif:Ve})}L(X),Le(M.rounds),te({work:M.work,rest:M.rest}),k("preview");return}const F={};for(const X of M.exercises)if(X.storagePath)try{const de=oa(la,X.storagePath);F[X.name]={url:await so(de),isGif:/\.gif$/i.test(X.storagePath)}}catch{}Ie(F);const $=M.exercises.map(X=>({name:X.name,type:X.type,targetSets:X.sets,targetReps:X.reps||0,targetTime:X.time||0,sets:[]}));Jn($),wt(0),fs(0),Ln(""),cn(""),re(!1),Dt(!1),Z(0),setMgSessionBadges([]),setMgBadgeCelebration(null),k("muscle_workout")},xi=()=>{const M=De.current;M&&(M.paused?(M.play(),re(!0)):(M.pause(),re(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!Gt||It<=0){b==="muscle_workout"&&Gt&&It<=0&&(Dt(!1),$s());return}return Fe.current=setTimeout(()=>Z(M=>M-1),1e3),()=>clearTimeout(Fe.current)},[b,Gt,It]);const zi=async()=>{const M=rn[mt];let F={};if(M.type==="weighted"){const de=parseFloat(Fn)||0,pe=parseInt(On)||0;if(pe===0){ut("Enter your reps","error");return}F={weight:de,reps:pe}}else if(M.type==="reps"){const de=parseInt(On)||0;if(de===0){ut("Enter your reps","error");return}F={reps:de}}else if(M.type==="timed"){const de=M.targetTime-It;F={time:Math.max(de,1)}}const $=[...rn];$[mt]={...M,sets:[...M.sets,F]},Jn($),M.type==="weighted"&&F.weight>0&&await Bi(M.name,F.weight,F.reps);const X=M.sets.length+1;if(X<M.targetSets)fs(X),cn(""),Dt(!1),Z(0);else if(mt+1<rn.length){const de=mt+1;wt(de),fs(0),Ln(""),cn(""),re(!1),Dt(!1),Z(0)}else await Ur($),Sn(!0)},Ur=async M=>{if(!(!s||!t))try{const F=M.reduce(($,X)=>$+X.sets.length,0);await or(dt(ge,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:pt,sessionId:it?.id,sessionName:it?.name,exerciseCount:M.length,totalSets:F,duration:Math.round(F*1.5),exercises:M.map($=>({name:$.name,type:$.type,sets:$.sets})),completedAt:Ft.now()})}catch(F){console.error("Error saving muscle group workout log:",F)}},jr=w.useRef(null),qs=()=>{(!jr.current||jr.current.state==="closed")&&(jr.current=new(window.AudioContext||window.webkitAudioContext));const M=jr.current;return M.state==="suspended"&&M.resume(),M},$s=()=>{try{const M=qs(),F=M.createOscillator(),$=M.createGain();F.connect($),$.connect(M.destination),F.frequency.value=880,$.gain.value=.3,F.start(M.currentTime),F.stop(M.currentTime+.15)}catch{}},Ls=()=>{try{const M=qs(),F=M.createOscillator(),$=M.createGain();F.connect($),$.connect(M.destination),F.frequency.value=1200,$.gain.value=.4,F.start(M.currentTime),F.stop(M.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||V!=="work"||!D[Ae]?.isGif)return;const F=setInterval(()=>{const $=Tt.current;if(!$)return;const X=$.getAttribute("src");$.removeAttribute("src"),setTimeout(()=>{Tt.current&&Tt.current.setAttribute("src",X)},0)},4e3);return()=>clearInterval(F)},[b,V,Ae,Te,D]);const S=(M,F,$)=>{const X=Math.round(M/F*u5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:c3.map((de,pe)=>a.jsx("line",{x1:de.x1,y1:de.y1,x2:de.x2,y2:de.y2,className:pe<X?`wk-tick-filled ${$}`:"wk-tick-empty",strokeWidth:de.thick?"3":"2"},pe))})},Q=()=>{const M=D.length*A;return((Te-1)*D.length+Ae+(V==="rest"?.5:0))/M},Ce=gn&&a.jsx("div",{className:`toast-notification ${gn.type}`,children:gn.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(sl,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>k("randomiser_hub"),children:a.jsx("img",{src:Qw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>p("/upgrade"),children:[a.jsx("img",{src:Xw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[sp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:sp.map((M,F)=>M.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:M.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:M.image,alt:M.name,className:"wk-prog-img"}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},M.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:M.id}}),style:{animationDelay:`${F*.06}s`},children:[a.jsx("img",{src:Xw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:h5[M.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[M.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:M.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:M.name.toUpperCase()}),a.jsxs("p",{children:[M.daysPerWeek,"x per week  ",M.focus==="fullbody"?"Full Body":M.focus.charAt(0).toUpperCase()+M.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),F===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},M.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[ru.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:ru.map((M,F)=>a.jsx("button",{className:`wk-muscle-hero-card${M.image?" wk-muscle-thumb":""}`,onClick:()=>{Ht(M.key),k("muscle_sessions")},style:{animationDelay:`${F*.05}s`},children:M.image?a.jsx("img",{src:M.image,alt:M.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Qw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:np[M.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:M.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:M.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Jw[M.key]?.length||0," sessions"]})]})]})]})},M.key))})]})]}),a.jsx(ti,{active:"workouts"}),Ce,a.jsx(Kl,{badge:et,onDismiss:()=>$t(null)})]})});if(b==="randomiser_hub"){const M=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},F=Qr.find(X=>X.key===M.focus)?.label||M.focus,$=Ci.find(X=>X.key===M.level)?.label||M.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[es.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:es.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),es.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[es.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),es.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:yh[es.favouriteFocus]||"var(--color-primary)"},children:Qr.find(X=>X.key===es.favouriteFocus)?.label||es.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>k("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Cn,disabled:vn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[F,"  ",$,"  ",M.duration,"min"]})]})]}),xr&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{G(xr.focus),k("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:xr.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Zw[Math.floor(Date.now()/864e5)%Zw.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Ss.length>0&&a.jsx("span",{className:"wk-hub-count",children:Ss.length})]}),bi?Ss.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Qr.map(X=>{const de=Ss.filter(Ve=>Ve.focus===X.key);if(de.length===0)return null;const pe=js[X.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${pe?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":yh[X.key]||"var(--color-primary)"},onClick:()=>hr(Ve=>({...Ve,[X.key]:!Ve[X.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":yh[X.key]||"var(--color-primary)"},children:X.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:de.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${pe?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),pe&&a.jsx("div",{className:"wk-hub-saved-list",children:de.map((Ve,tt)=>{const nt=(Ve.equipment||[]).map(_t=>rp.find(Xt=>Xt.key===_t)?.label||_t).join(", "),vt=Ci.find(_t=>_t.key===Ve.level)?.label||Ve.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${tt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>At(Ve),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:Ve.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[vt,"  ",Ve.duration,"min  ",(Ve.exercises||[]).length," ex"]})}),nt&&a.jsx("span",{className:"wk-hub-saved-equip",children:nt})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>ot(Ve.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},Ve.id)})})]},X.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Kn.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Kn.map((X,de)=>{const pe=Qr.find(vt=>vt.key===X.focus)?.label||X.focus||"",Ve=Ci.find(vt=>vt.key===X.level)?.label||X.level||"",tt=X.completedAt?.toDate?X.completedAt.toDate():X.completedAt?new Date(X.completedAt):null,nt=tt?(()=>{const vt=Math.floor((Date.now()-tt.getTime())/1e3);return vt<3600?`${Math.floor(vt/60)}m ago`:vt<86400?`${Math.floor(vt/3600)}h ago`:`${Math.floor(vt/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${de*.05}s`},onClick:()=>{G(X.focus||"core"),K(X.level||"intermediate"),ee(X.duration||15),X.equipment&&R(X.equipment),k("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":yh[X.focus]||"var(--color-primary)"},children:pe}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[Ve,"  ",X.duration||"?","min  ",X.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:nt}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},de)})})]})]}),a.jsx(ti,{active:"workouts"}),Ce,a.jsx(Kl,{badge:et,onDismiss:()=>$t(null)})]})}if(b==="setup"){const M=Qr.find($=>$.key===q)?.label||q,F=Ci.find($=>$.key===U)?.label||U;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Pn}`,pct:Pn>0?Math.min(Math.round(Pn/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Oe}/${tp}`,pct:Math.round(Math.min(Oe,tp)/tp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ge}`,pct:Ge>0?Math.min(Math.round(Ge/12*100),100):0,color:"#38B6FF",size:"normal"}].map($=>{const de=2*Math.PI*38,pe=de-$.pct/100*de;return a.jsxs("div",{className:`wk-stat-item${$.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:$.color},strokeDasharray:de,strokeDashoffset:pe})]}),a.jsx("span",{className:"wk-stat-value",style:{color:$.color},children:$.value})]}),a.jsx("span",{className:"wk-stat-label",children:$.label})]},$.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Qr.map($=>a.jsxs("button",{className:`wk-equip-btn${q===$.key?" active":""}${$.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{$s(),G($.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ci.map($=>a.jsxs("button",{className:`wk-level-card wk-level-${$.key}${U===$.key?" active":""}`,onClick:()=>{$s(),K($.key)},children:[a.jsx("span",{className:"wk-level-name",children:$.label}),a.jsx("span",{className:"wk-level-desc",children:$.desc})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:ip.map($=>{const X=!Ct.includes($);return a.jsxs("button",{className:`wk-time-btn${Y===$?" active":""}${X?" locked":""}`,onClick:()=>{X||($s(),ee($))},disabled:X,children:[a.jsx("span",{className:"wk-time-num",children:$}),a.jsx("span",{className:"wk-time-unit",children:X?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},$)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:rp.map($=>{const X=T.includes($.key);return a.jsxs("button",{className:`wk-equip-btn${X?" active":""}`,onClick:()=>{X&&T.length===1||($s(),R(de=>X&&de.length===1?de:X?de.filter(pe=>pe!==$.key):[...de,$.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[M,"  ",F,"  ",Y," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[vn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:wi,disabled:ve||vn,children:ve?"Loading exercises...":vn?"Limit Reached":"Randomise Workout"})]}),Ce]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:l3.map((M,F)=>a.jsx("line",{x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,className:"wk-spin-tick",strokeWidth:M.thick?"3.5":"2",style:{animationDelay:`${F*.03}s`}},F))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Ce]});if(b==="preview"){const M=it?.interval?{work:it.work,rest:it.rest}:Ci.find($=>$.key===U),F=D.length*A*(M.work+M.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k(it?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[it?.interval&&a.jsx("h2",{className:"mg-preview-title",children:it.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(F/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[M.work,"/",M.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:D.map(($,X)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${X*.06}s`},onClick:()=>qt($),children:[a.jsx("span",{className:"wk-preview-num",children:X+1}),a.jsx("div",{className:"wk-preview-thumb",children:$.isGif?a.jsx("img",{src:$.videoUrl,alt:$.name,loading:"lazy"}):a.jsx(p5,{src:`${$.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"metadata"})}),a.jsx("span",{className:"wk-preview-name",children:$.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},X))}),on&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>qt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>qt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:on.isGif?a.jsx("img",{src:on.videoUrl,alt:on.name}):a.jsx("video",{src:on.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:on.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!it?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>wi(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Vn(!0),disabled:Gn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:kr,children:"Start Workout"})]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:bn,onChange:$=>Zn($.target.value),placeholder:`${Qr.find($=>$.key===q)?.label||q} ${Y}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ke(bn),disabled:Gn,children:Gn?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:ze}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const M=D[Ae],F=V==="work"?st.work:st.rest,$=V==="rest"?Ae+1<D.length?D[Ae+1]:Te<A?D[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:V==="work"?M.isGif?a.jsx("img",{ref:Tt,className:"wk-video",src:M.videoUrl,alt:M.name},M.videoUrl):a.jsx("video",{className:"wk-video",src:M.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},M.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[$&&($.isGif?a.jsx("img",{className:"wk-rest-preview",src:$.videoUrl,alt:$.name}):a.jsx("video",{className:"wk-rest-preview",src:$.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})),a.jsx("div",{className:"wk-rest-overlay"}),a.jsxs("div",{className:"wk-rest-text",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),$&&a.jsxs("div",{className:"wk-rest-next",children:[a.jsx("span",{className:"wk-rest-next-tag",children:"UP NEXT"}),a.jsx("span",{className:"wk-rest-next-name",children:$.name})]})]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&k("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ae+1," / ",D.length]}),a.jsx("h2",{className:"wk-exercise-name",children:M.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Te," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[S(je,F,V==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:je}),a.jsx("span",{className:`wk-timer-phase ${V}`,children:V==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&k("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Pe(!_e),children:_e?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Se(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Q()*100}%`}})}),Je&&(()=>{const X=Ci.find(pe=>pe.key===U),de=D.length*A*(X.work+X.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Gp,{title:"Workout Complete!",stats:[{value:Math.ceil(de/60),label:"Minutes"},{value:D.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Qt(!1),yt(null),Ht(null)}}),!it?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Vn(!0),disabled:Gn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:pe=>pe.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:bn,onChange:pe=>Zn(pe.target.value),placeholder:`${Qr.find(pe=>pe.key===q)?.label||q} ${Y}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ke(bn),disabled:Gn,children:Gn?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const M=ru.find($=>$.key===pt),F=Jw[pt]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:np[pt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:M?.icon})})}),a.jsxs("h2",{children:[M?.label," Workouts"]}),a.jsxs("p",{children:[F.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:F.map(($,X)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{yt($),k("muscle_overview")},style:{animationDelay:`${X*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:$.name}),a.jsx("p",{children:$.desc}),a.jsx("div",{className:"mg-session-meta",children:$.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[$.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const de=$.exercises.map(tt=>tt.sets||0),pe=Math.min(...de),Ve=Math.max(...de);return pe===Ve?`${pe} sets each`:`${pe}-${Ve} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id))})]}),Ce]})}if(b==="muscle_overview"){const M=it;if(!M)return null;const F=ru.find($=>$.key===pt);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:M.image?void 0:{background:np[pt]},children:M.image?a.jsx("img",{src:M.image,alt:M.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:F?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:M.name}),M.level&&a.jsx("span",{className:"mg-overview-level",children:M.level})]}),a.jsx("p",{className:"mg-overview-desc",children:M.desc})]}),M.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:M.overview})]}),M.tips&&M.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:M.tips.map(($,X)=>a.jsx("li",{children:$},X))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",M.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:M.exercises.map(($,X)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:X+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:$.name}),M.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[M.work,"s work / ",M.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[$.sets," sets  ",$.reps?`${$.reps} reps`:`${$.time}s`,$.type==="weighted"&&"  weighted"]})]})]},X))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ri(M),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Ce]})}if(b==="muscle_workout"){const M=it;if(!M)return null;const F=M.exercises[mt],$=rn[mt];if(!F||!$)return null;const X=$.sets.length,de=M.exercises.length,pe=M.exercises.reduce((_t,Xt)=>_t+(Xt.sets||0),0),tt=rn.reduce((_t,Xt)=>_t+Xt.sets.length,0)/pe*100,nt=Re[F.name];F.type==="timed"&&It===0&&!Gt&&X===Bt&&setTimeout(()=>Z(F.time),0);const vt=X+1<F.sets?"Log Set":mt+1<de?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${tt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&k("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",mt+1,"/",de]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[nt?a.jsxs("div",{className:"mg-video-container",onClick:xi,children:[nt.isGif?a.jsx("img",{className:"mg-video",src:nt.url,alt:F.name}):a.jsx("video",{ref:De,className:"mg-video",src:nt.url,loop:!0,muted:!0,playsInline:!0},F.name),!C&&!nt.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:F.name}),a.jsx("span",{className:`mg-ex-type-badge ${F.type}`,children:F.type==="weighted"?"Weight + Reps":F.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",X+1," of ",F.sets]}),F.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.reps," reps"]}),F.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",F.time,"s"]})]}),F.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Fn,onChange:_t=>Ln(_t.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:On,onChange:_t=>cn(_t.target.value),placeholder:"0"})]})]}),F.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:On,onChange:_t=>cn(_t.target.value),placeholder:"0"})]})}),F.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[It,"s"]})}),Gt?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Dt(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{It===0&&Z(F.time),Dt(!0)},children:It<F.time&&It>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:zi,children:vt}),$.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:$.sets.map((_t,Xt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Xt+1,": ",_t.weight!=null?`${_t.weight}kg  ${_t.reps}`:_t.reps!=null?`${_t.reps} reps`:`${_t.time}s`]})]},Xt))})]})]}),Ce,Rt&&(()=>{const _t=rn.reduce((rt,wn)=>rt+wn.sets.length,0),Xt=ru.find(rt=>rt.key===pt)?.label||"",Hn=[{value:rn.length,label:"Exercises"},{value:_t,label:"Sets"}];return a.jsx(Gp,{title:`${Xt} Complete!`,subtitle:it?.name,stats:Hn,hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>k("randomiser_hub"),onDone:()=>{Sn(!1),yt(null),Ht(null)}})})()]})}return a.jsx(Kl,{badge:et,onDismiss:()=>$t(null)})}const v5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],b5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",ex=[{color:"#e91e63",darkColor:"#FF4D88"},{color:"#00bcd4",darkColor:"#26D9EC"},{color:"#ff5722",darkColor:"#FF7A50"},{color:"#009688",darkColor:"#26B8A8"},{color:"#ffc107",darkColor:"#FFD54F"},{color:"#673ab7",darkColor:"#9575CD"},{color:"#8bc34a",darkColor:"#AED581"},{color:"#f44336",darkColor:"#EF5350"},{color:"#3f51b5",darkColor:"#7986CB"},{color:"#795548",darkColor:"#A1887F"}],w5=700,Kp=42,Pl=2*Math.PI*Kp,vh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function x5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ga(s){return s.toISOString().split("T")[0]}function _5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function k5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Or(),{isDark:l,toggleTheme:u}=Ui(),{isPremium:d,FREE_HABIT_LIMIT:g}=hc(),y=Zs(),[p,b]=w.useState({}),[k,T]=w.useState([]),[R,q]=w.useState(!0),[G,U]=w.useState(!1),[K,Y]=w.useState(0),[ee,ye]=w.useState(null),[ke,ve]=w.useState(null),[I,E]=w.useState(!1),[O,B]=w.useState(null),[D,L]=w.useState(!1),[A,Le]=w.useState(!1),[st,te]=w.useState(!1),[Te,He]=w.useState(""),[Ae,We]=w.useState(null),[V,ce]=w.useState([]),[je,Se]=w.useState([]),[_e,Pe]=w.useState(null),ze=w.useRef(null),Ye=w.useRef(null),Je=w.useRef(null),Qt=w.useRef(null),Rt=w.useRef(!1),Sn=w.useRef({}),on=w.useRef([]),qt=w.useRef([]),Tt=w.useRef(null),gn=w.useRef(vh[Math.floor(Math.random()*vh.length)]),St=w.useCallback((ue,Me="info")=>{ye({message:ue,type:Me}),setTimeout(()=>ye(null),3e3)},[]),ut=new Date,le=Ga(ut),pt=x5(ut),Ht=_5(pt),it=["M","T","W","T","F","S","S"],yt=(ue,Me)=>l&&Me?Me:ue,mt=[...v5.filter(ue=>!V.includes(ue.key)).map(ue=>({...ue,color:yt(ue.color,ue.darkColor)})),...k.map((ue,Me)=>{const Ge=ex[Me%ex.length];return{key:`custom_${ue.id}`,label:ue.label,icon:b5,color:yt(Ge.color,Ge.darkColor),isCustom:!0,id:ue.id}})],wt=d?mt:mt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Me=dt(ge,"habitLogs"),Ge=tn(Me,kt("clientId","==",t.id)),ct=await Wt(Ge),et={};ct.docs.forEach(Ct=>{const vn=Ct.data();et[vn.date]={...vn,_id:Ct.id}}),b(et);const $t=await _s(Be(ge,"customHabits",t.id));if($t.exists()){const Ct=$t.data();T(Ct.habits||[]),ce(Ct.hiddenDefaults||[]),Se(Ct.savedHabits||[])}let hn=0;const Nt=new Date(ut);for(;;){const Ct=Ga(Nt),vn=et[Ct];if(vn)if(Object.values(vn.habits||{}).filter(Boolean).length>=3)hn++,Nt.setDate(Nt.getDate()-1);else break;else if(Ct===le)Nt.setDate(Nt.getDate()-1);else break}Y(hn)}catch(Me){console.error("Error loading habit logs:",Me)}finally{q(!1)}})()},[s,t]);const Bt=p[le]||{habits:{}};w.useEffect(()=>{Object.values(Bt.habits||{}).filter(Boolean).length<wt.length&&A&&Le(!1)},[wt.length,Bt.habits]);const fs=async ue=>{if(!(!s||G||Bt.habits?.[ue])){on.current=[...Array(10)].map((Ge,ct)=>{const et=ct/10*2*Math.PI,$t=18+Math.random()*20;return{tx:Math.cos(et)*$t,ty:Math.sin(et)*$t,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),ve(ue),setTimeout(()=>ve(null),700),navigator.vibrate&&navigator.vibrate(50),U(!0);try{const ct={...Bt.habits||{},[ue]:!0},et=Bt._id||`${t.id}_${le}`;if(b(hn=>({...hn,[le]:{clientId:t.id,date:le,habits:ct,_id:et}})),await ss(Be(ge,"habitLogs",et),{clientId:t.id,date:le,habits:ct}),Object.values(ct).filter(Boolean).length===wt.length&&!A){gn.current=vh[Math.floor(Math.random()*vh.length)],qt.current=[...Array(80)].map((Nt,Ct)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ct%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ct%3})),setTimeout(()=>{E(!0),Le(!0),setTimeout(()=>Tt.current?.focus(),1100)},400);let hn=1;for(let Nt=1;Nt<7;Nt++){const Ct=new Date;Ct.setDate(Ct.getDate()-Nt);const vn=Ga(Ct),Ss=p[vn];if(Ss)if(Object.values(Ss.habits||{}).filter(Boolean).length>=wt.length)hn++;else break;else break}hn>=7&&ef("habits_7",t).then(Nt=>{Nt&&B(Nt)})}}catch(Ge){console.error("Error saving habit:",Ge),St("Failed to save. Try again.","error"),b(ct=>({...ct,[le]:{...ct[le],habits:{...ct[le]?.habits||{},[ue]:!1}}}))}finally{U(!1)}}},rn=async ue=>{if(!(!s||G)){U(!0);try{const Ge={...Bt.habits||{},[ue]:!1},ct=Bt._id||`${t.id}_${le}`;await ss(Be(ge,"habitLogs",ct),{clientId:t.id,date:le,habits:Ge}),b(et=>({...et,[le]:{clientId:t.id,date:le,habits:Ge,_id:ct}}))}catch(Me){console.error("Error undoing habit:",Me),St("Failed to undo. Try again.","error")}finally{U(!1)}}},Jn=ue=>{if(Bt.habits?.[ue]||!1||G||Qt.current)return;Qt.current=ue,Pe(ue),Ye.current=performance.now();const Ge=Sn.current[ue];Ge&&(Ge.style.strokeDashoffset=Pl);const ct=et=>{const $t=et-Ye.current,hn=Math.min($t/w5,1),Nt=Sn.current[ue];Nt&&(Nt.style.strokeDashoffset=Pl-hn*Pl),hn<1?Je.current=requestAnimationFrame(ct):(Qt.current=null,Rt.current=!0,Je.current=null,Pe(null),fs(ue))};Je.current=requestAnimationFrame(ct)},Fn=()=>{if(!Qt.current)return;const ue=Qt.current;Qt.current=null,Je.current&&(cancelAnimationFrame(Je.current),Je.current=null),ze.current&&(clearTimeout(ze.current),ze.current=null),Sn.current[ue]&&(Sn.current[ue].style.strokeDashoffset=Pl),Pe(null),Ye.current=null};w.useEffect(()=>()=>{Je.current&&cancelAnimationFrame(Je.current),ze.current&&clearTimeout(ze.current)},[]);const Ln=w.useCallback(async ue=>{if(!t)throw new Error("Not signed in");const Me=ue&&typeof ue=="object"&&ue.type;await or(dt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me?"":ue,type:Me?ue.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...Me?{metadata:{title:ue.title||"",subtitle:ue.subtitle||"",stats:ue.stats||[],quote:ue.quote||"",badges:ue.badges||[]}}:{}})},[t]),On=async()=>{const ue=Te.trim();if(!ue)return;if(!t?.id){St("Still loading, try again","error");return}const Me=Date.now().toString(36),Ge=[...k,{id:Me,label:ue}];try{await ss(Be(ge,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:V,savedHabits:je},{merge:!0}),T(Ge),He(""),te(!1),St(`Added "${ue}"`,"success")}catch(ct){console.error("Error adding custom habit:",ct),St(ct?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ct?.message||"Unknown error"}`,"error")}},cn=async ue=>{if(!t?.id)return;const Me=k.find(et=>et.id===ue),Ge=k.filter(et=>et.id!==ue),ct=Me&&!je.includes(Me.label)?[...je,Me.label]:je;try{await ss(Be(ge,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:V,savedHabits:ct},{merge:!0}),T(Ge),Se(ct),We(null),St("Habit saved for later","success")}catch(et){console.error("Error deleting habit:",et),St("Failed to remove","error")}},Gt=async ue=>{if(!t?.id)return;const Me=Date.now().toString(36),Ge=[...k,{id:Me,label:ue}],ct=je.filter(et=>et!==ue);try{await ss(Be(ge,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:V,savedHabits:ct},{merge:!0}),T(Ge),Se(ct),te(!1),St(`Added "${ue}"`,"success")}catch(et){console.error("Error re-adding habit:",et),St("Failed to add","error")}},Dt=async ue=>{if(!t?.id)return;const Me=je.filter(Ge=>Ge!==ue);try{await ss(Be(ge,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:V,savedHabits:Me},{merge:!0}),Se(Me)}catch(Ge){console.error("Error removing saved habit:",Ge)}},It=async ue=>{if(!t?.id)return;const Me=[...V,ue];try{await ss(Be(ge,"customHabits",t.id),{clientId:t.id,habits:k,hiddenDefaults:Me,savedHabits:je},{merge:!0}),ce(Me),We(null),St("Habit removed","success")}catch(Ge){console.error("Error hiding default habit:",Ge),St("Failed to remove","error")}},Z=Ht.map(ue=>{const Me=Ga(ue),Ge=p[Me],ct=Ge?Object.values(Ge.habits||{}).filter(Boolean).length:0;return{date:ue,dateStr:Me,completed:ct,total:wt.length}}),C=Z.reduce((ue,Me)=>ue+Me.completed,0),re=Z.reduce((ue,Me)=>ue+Me.total,0),Re=re>0?Math.round(C/re*100):0,Ie=Object.values(Bt.habits||{}).filter(Boolean).length,De=wt.length>0?Math.round(Ie/wt.length*100):0,Fe=Ie===wt.length&&wt.length>0,Oe=(()=>{const ue=Object.keys(p).sort();let Me=0,Ge=0,ct=null;for(const et of ue){const $t=p[et];if(Object.values($t.habits||{}).filter(Boolean).length>=3){if(ct){const Nt=new Date(ct);Ge=(new Date(et)-Nt)/(1e3*60*60*24)===1?Ge+1:1}else Ge=1;Ge>Me&&(Me=Ge),ct=et}else Ge=0,ct=null}return Math.max(Me,K)})(),Lt=new Date(ut.getFullYear(),ut.getMonth(),1),xt=Lt.toLocaleString("default",{month:"long"}),lt=new Date(ut.getFullYear(),ut.getMonth()+1,0).getDate(),un=(Lt.getDay()+6)%7,dn=Array.from({length:lt},(ue,Me)=>{const Ge=new Date(ut.getFullYear(),ut.getMonth(),Me+1),ct=Ga(Ge),et=p[ct],$t=et?Object.values(et.habits||{}).filter(Boolean).length:0,hn=Ge>ut;return{day:Me+1,dateStr:ct,completed:$t,total:wt.length,isFuture:hn,isToday:ct===le}}),Pn=wt.map(ue=>({...ue,days:Ht.map(Me=>{const Ge=Ga(Me);return p[Ge]?.habits?.[ue.key]||!1})})),ms=Z.filter(ue=>ue.completed===ue.total&&ue.total>0).length;return a.jsx(sl,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||R?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${Fe?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-De/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Ie,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),wt.length]}),a.jsx("span",{className:"cbc-ring-label",children:Fe?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:Fe?"You showed up for yourself today.":Ie===0?"Start your day strong.":`${wt.length-Ie} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:K}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Oe}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[wt.map(ue=>{const Me=Bt.habits?.[ue.key]||!1,Ge=ke===ue.key,ct=_e===ue.key;return a.jsxs("div",{className:`cbc-habit-tile ${Me?"cbc-habit-done":""} ${Ge?"cbc-habit-just-checked":""}`,style:{"--habit-color":ue.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:et=>{et.stopPropagation(),We(ue.isCustom?{type:"custom",id:ue.id,label:ue.label}:{type:"default",key:ue.key,label:ue.label})},"aria-label":`Remove ${ue.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${ct?"cbc-holding":""} ${Me?"cbc-ring-completed":""}`,onPointerDown:et=>{Me||(et.preventDefault(),Jn(ue.key))},onPointerUp:Fn,onPointerLeave:Fn,onPointerCancel:Fn,onClick:et=>{if(et.stopPropagation(),Rt.current){Rt.current=!1;return}Me&&rn(ue.key)},role:"button",tabIndex:0,"aria-label":Me?`Undo ${ue.label}`:`Press and hold to complete ${ue.label}`,onKeyDown:et=>{(et.key==="Enter"||et.key===" ")&&(et.preventDefault(),Me?rn(ue.key):fs(ue.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Kp}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:et=>{et&&(Sn.current[ue.key]=et)},cx:"50",cy:"50",r:Kp,style:{stroke:ue.color,strokeDasharray:Pl,strokeDashoffset:Me?0:Pl}})]}),Me&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":ue.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:ue.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:ue.icon})})}),Ge&&a.jsx("div",{className:"cbc-particles",children:on.current.map((et,$t)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${et.tx}px`,"--ty":`${et.ty}px`,"--size":`${et.size}px`,"--particle-color":ue.color,animationDuration:`${et.duration}s`}},$t))})]}),a.jsx("span",{className:"cbc-habit-label",children:ue.label}),Me?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ue.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>te(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[ms,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),it.map((ue,Me)=>a.jsx("span",{className:`cbc-weekly-day-label${Ht[Me]&&Ga(Ht[Me])===le?" cbc-today-label":""}`,children:ue},Me))]}),Pn.map(ue=>(ue.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:ue.color},children:ue.label}),ue.days.map((Me,Ge)=>a.jsx("span",{className:`cbc-weekly-dot${Me?" cbc-dot-done":""}${Ht[Ge]&&Ga(Ht[Ge])===le?" cbc-dot-today":""}`,style:Me?{background:ue.color,borderColor:ue.color,boxShadow:`0 0 6px ${ue.color}40`}:void 0},Ge))]},ue.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Re}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[C,"/",re," completed (",Re,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:xt}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((ue,Me)=>a.jsx("span",{className:"cbc-cal-day-label",children:ue},Me))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:un},(ue,Me)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Me}`)),dn.map(ue=>{const Me=ue.total>0?ue.completed/ue.total:0,Ge=ue.isFuture?-1:Me===0?0:Me<.4?1:Me<.75?2:Me<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${ue.isToday?" cbc-cal-today":""}${Ge===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ge<0?"future":Ge}`,children:ue.day},ue.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(ti,{active:"home"}),st&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>te(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),je.length>0&&a.jsxs("div",{className:"cbc-saved-habits",children:[a.jsx("span",{className:"cbc-saved-label",children:"Quick add"}),a.jsx("div",{className:"cbc-saved-chips",children:je.map(ue=>a.jsxs("div",{className:"cbc-saved-chip",children:[a.jsx("button",{className:"cbc-saved-chip-add",onClick:()=>Gt(ue),children:ue}),a.jsx("button",{className:"cbc-saved-chip-remove",onClick:()=>Dt(ue),"aria-label":`Remove ${ue}`,children:""})]},ue))})]}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Te,onChange:ue=>He(ue.target.value),maxLength:30,autoFocus:!0,onKeyDown:ue=>ue.key==="Enter"&&On()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{te(!1),He("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:On,disabled:!Te.trim(),children:"Add"})]})]})}),Ae&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>We(null),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ae.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>We(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ae.type==="custom"?cn(Ae.id):It(Ae.key),children:"Remove"})]})]})}),I&&a.jsx(Gp,{title:"All Habits Complete!",subtitle:gn.current,stats:[{value:`${Ie}/${wt.length}`,label:"Habits"},{value:K||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?Ln:null,userName:t?.name,onDone:()=>{E(!1),L(!1)}}),ee&&a.jsx("div",{className:`toast-notification ${ee.type}`,children:ee.message}),a.jsx(Kl,{badge:O,onDismiss:()=>B(null)})]})})}function Mo(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function j5(s,e){return[s,e].sort().join("_")}function tx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function E5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Or(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState("feed"),[p,b]=w.useState([]),[k,T]=w.useState([]),[R,q]=w.useState([]),[G,U]=w.useState(""),[K,Y]=w.useState([]),[ee,ye]=w.useState([]),[ke,ve]=w.useState(!0),[I,E]=w.useState(null),[O,B]=w.useState(null),[D,L]=w.useState([]),[A,Le]=w.useState(!1),[st,te]=w.useState(new Set),[Te,He]=w.useState(new Set),[Ae,We]=w.useState({}),[V,ce]=w.useState({}),[je,Se]=w.useState({}),[_e,Pe]=w.useState({}),[ze,Ye]=w.useState({}),[Je,Qt]=w.useState({}),Rt=w.useRef({}),[Sn,on]=w.useState(!1),[qt,Tt]=w.useState(null),[gn,St]=w.useState([]),ut=w.useCallback((C,re="info")=>{B({message:C,type:re}),setTimeout(()=>B(null),3500)},[]),le=(C,re)=>{const Re=C.match(/@(\w*)$/);if(Re){on(!0),Tt(re);const Ie=p.filter(De=>De.name&&De.name.toLowerCase().includes(Re[1].toLowerCase())).slice(0,5);St(Ie)}else on(!1),St([])},pt=(C,re)=>{const Ie=(V[re]||"").replace(/@\w*$/,`@${C.name} `);ce(De=>({...De,[re]:Ie})),on(!1),St([])},Ht=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Re,Ie)=>Re.startsWith("@")&&p.some(De=>Re.trim()===`@${De.name}`)?a.jsx("span",{className:"mention-highlight",children:Re.trim()},Ie):Re);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const it=w.useCallback(async()=>{if(t){ve(!0);try{const C=t.id,Re=(await Wt(dt(ge,"clients"))).docs.map(lt=>({id:lt.id,...lt.data()}));ye(Re);const Ie=Object.fromEntries(Re.map(lt=>[lt.id,lt])),De=await Wt(tn(dt(ge,"buddies"),kt("user1","==",C))),Fe=await Wt(tn(dt(ge,"buddies"),kt("user2","==",C))),Oe=new Set;[...De.docs,...Fe.docs].forEach(lt=>{const un=lt.data(),dn=un.user1===C?un.user2:un.user1;Oe.add(dn)}),b(Array.from(Oe).map(lt=>Ie[lt]).filter(Boolean));const Lt=await Wt(tn(dt(ge,"buddyRequests"),kt("toId","==",C),kt("status","==","pending")));T(Lt.docs.map(lt=>({reqId:lt.id,...lt.data(),fromClient:Ie[lt.data().fromId]})).filter(lt=>lt.fromClient));const xt=await Wt(tn(dt(ge,"buddyRequests"),kt("fromId","==",C),kt("status","==","pending")));q(xt.docs.map(lt=>({reqId:lt.id,...lt.data(),toClient:Ie[lt.data().toId]})).filter(lt=>lt.toClient))}catch(C){console.error("Error fetching buddy data:",C),ut("Failed to load buddies","error")}finally{ve(!1)}}},[t,ut]);w.useEffect(()=>{it()},[it]),w.useEffect(()=>{if(!G.trim()||!t){Y([]);return}const C=G.toLowerCase(),re=t.id,Re=new Set(p.map(Oe=>Oe.id)),Ie=new Set(R.map(Oe=>Oe.toId)),De=new Set(k.map(Oe=>Oe.fromId)),Fe=ee.filter(Oe=>Oe.id===re||!Oe.name||!Oe.coreBuddyAccess&&Oe.clientType!=="core_buddy"?!1:Oe.name.toLowerCase().includes(C)).map(Oe=>({...Oe,isBuddy:Re.has(Oe.id),isPendingOut:Ie.has(Oe.id),isPendingIn:De.has(Oe.id)})).slice(0,20);Y(Fe)},[G,ee,p,R,k,t]);const yt=async(C,re)=>{if(!(!t||C===t.id))try{await or(dt(ge,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:re,read:!1,createdAt:xs()})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&ut("Notifications blocked  check Firestore rules","error")}},mt=async C=>{E(C);try{const re=`${t.id}_${C}`;await ss(Be(ge,"buddyRequests",re),{fromId:t.id,toId:C,status:"pending",createdAt:xs()}),await yt(C,"buddy_request"),ut("Buddy request sent!","success"),await it()}catch(re){console.error("Error sending request:",re),ut("Failed to send request","error")}finally{E(null)}},wt=async C=>{E(C.reqId);try{const re=j5(C.fromId,t.id);await ss(Be(ge,"buddies",re),{user1:[C.fromId,t.id].sort()[0],user2:[C.fromId,t.id].sort()[1],connectedAt:xs()}),await ar(Be(ge,"buddyRequests",C.reqId)),await yt(C.fromId,"buddy_accept"),ut("Buddy added!","success"),await it()}catch(re){console.error("Error accepting request:",re),ut("Failed to accept","error")}finally{E(null)}},Bt=async C=>{E(C.reqId);try{await ar(Be(ge,"buddyRequests",C.reqId)),ut("Request declined","info"),await it()}catch(re){console.error("Error declining:",re),ut("Failed to decline","error")}finally{E(null)}},fs=async C=>{E(C.reqId);try{await ar(Be(ge,"buddyRequests",C.reqId)),ut("Request cancelled","info"),await it()}catch(re){console.error("Error cancelling:",re),ut("Failed to cancel","error")}finally{E(null)}},rn=w.useCallback(async()=>{if(!t||p.length===0){L([]);return}Le(!0);try{const C=[t.id,...p.map(De=>De.id)],re=[];for(let De=0;De<C.length;De+=30)re.push(C.slice(De,De+30));let Re=[];for(const De of re){const Fe=await Wt(tn(dt(ge,"posts"),kt("authorId","in",De),$o("createdAt","desc"),Wo(50)));Re.push(...Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})))}Re.sort((De,Fe)=>{const Oe=De.createdAt?.toDate?.()||new Date(0);return(Fe.createdAt?.toDate?.()||new Date(0))-Oe}),L(Re.slice(0,50));const Ie=await Wt(tn(dt(ge,"postLikes"),kt("userId","==",t.id)));te(new Set(Ie.docs.map(De=>De.data().postId)))}catch(C){console.error("Error loading feed:",C)}finally{Le(!1)}},[t,p]);w.useEffect(()=>{p.length>0&&g==="feed"&&rn()},[p,g,rn]);const Jn=async C=>{if(!t)return;const re=t.id,Re=`${C}_${re}`,Ie=st.has(C),De=new Set(st);Ie?De.delete(C):De.add(C),te(De),L(Fe=>Fe.map(Oe=>Oe.id===C?{...Oe,likeCount:Math.max(0,(Oe.likeCount||0)+(Ie?-1:1))}:Oe));try{if(Ie)await ar(Be(ge,"postLikes",Re)),await zn(Be(ge,"posts",C),{likeCount:hi(-1)});else{await ss(Be(ge,"postLikes",Re),{postId:C,userId:re,createdAt:xs()}),await zn(Be(ge,"posts",C),{likeCount:hi(1)});const Fe=D.find(Oe=>Oe.id===C);Fe&&yt(Fe.authorId,"like")}}catch(Fe){console.error("Like error:",Fe),rn()}},Fn=async C=>{if(window.confirm("Delete this post?"))try{await ar(Be(ge,"posts",C)),L(re=>re.filter(Re=>Re.id!==C)),ut("Post deleted","info")}catch(re){console.error("Delete error:",re),ut("Failed to delete","error")}},Ln=async C=>{try{const re=await Wt(tn(dt(ge,"postComments"),kt("postId","==",C),$o("createdAt","asc"),Wo(50)));We(Re=>({...Re,[C]:re.docs.map(Ie=>({id:Ie.id,...Ie.data()}))}))}catch(re){console.error("Error loading comments:",re)}},On=C=>{const re=new Set(Te);re.has(C)?re.delete(C):(re.add(C),Ae[C]||Ln(C)),He(re)},cn=async C=>{const re=(V[C]||"").trim(),Re=ze[C];if(!(!re&&!Re||!t)){Se(Ie=>({...Ie,[C]:!0}));try{let Ie=null;if(Re){const xt=oa(la,`comment-images/${Date.now()}_${Re.name}`);await vu(xt,Re),Ie=await so(xt)}const De={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:re||"",createdAt:xs()};Ie&&(De.imageURL=Ie);const Fe=_e[C];Fe&&(De.replyToId=Fe.id,De.replyToName=Fe.authorName),await or(dt(ge,"postComments"),De),await zn(Be(ge,"posts",C),{commentCount:hi(1)});const Oe=D.find(xt=>xt.id===C);Oe&&yt(Oe.authorId,"comment");const Lt=re.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Lt){const xt=new Set;Lt.forEach(lt=>{const un=lt.slice(1).trim(),dn=p.find(Pn=>Pn.name&&Pn.name.toLowerCase()===un.toLowerCase());dn&&!xt.has(dn.id)&&(xt.add(dn.id),yt(dn.id,"mention"))})}ce(xt=>({...xt,[C]:""})),Ye(xt=>({...xt,[C]:null})),Qt(xt=>({...xt,[C]:null})),Pe(xt=>({...xt,[C]:null})),Rt.current[C]&&(Rt.current[C].value=""),L(xt=>xt.map(lt=>lt.id===C?{...lt,commentCount:(lt.commentCount||0)+1}:lt)),await Ln(C)}catch(Ie){console.error("Comment error:",Ie),ut("Failed to comment","error")}finally{Se(Ie=>({...Ie,[C]:!1}))}}},Gt=async(C,re)=>{try{await ar(Be(ge,"postComments",re)),await zn(Be(ge,"posts",C),{commentCount:hi(-1)}),We(Re=>({...Re,[C]:(Re[C]||[]).filter(Ie=>Ie.id!==re)})),L(Re=>Re.map(Ie=>Ie.id===C?{...Ie,commentCount:Math.max((Ie.commentCount||1)-1,0)}:Ie))}catch(Re){console.error("Delete comment error:",Re),ut("Failed to delete comment","error")}},Dt=(C,re)=>{const Re=re.target.files?.[0];if(!Re)return;if(Re.size>5*1024*1024){ut("Image must be under 5MB","error");return}Ye(De=>({...De,[C]:Re}));const Ie=new FileReader;Ie.onload=De=>Qt(Fe=>({...Fe,[C]:De.target.result})),Ie.readAsDataURL(Re)},It=C=>{Ye(re=>({...re,[C]:null})),Qt(re=>({...re,[C]:null})),Rt.current[C]&&(Rt.current[C].value="")},Z=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(sl,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${g==="feed"?" active":""}`,onClick:()=>y("feed"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("span",{children:"Feed"})]}),a.jsxs("button",{className:`bdy-tab${g==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`bdy-tab${g==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Z>0&&a.jsx("span",{className:"bdy-tab-badge",children:Z})]}),a.jsxs("button",{className:`bdy-tab${g==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),ke?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[g==="feed"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Add buddies to see their posts here!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):A?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):D.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("h3",{children:"No posts yet"}),a.jsx("p",{children:"Your buddies haven't posted anything yet"})]}):a.jsx("div",{className:"bdy-feed-list",children:D.map(C=>a.jsxs("div",{className:"bdy-feed-post",children:[a.jsxs("div",{className:"bdy-feed-post-header",children:[a.jsx("div",{className:"bdy-feed-avatar",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Mo(C.authorName)})}),a.jsxs("div",{className:"bdy-feed-meta",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:[a.jsx("span",{className:"bdy-feed-name",children:C.authorName}),a.jsx("span",{className:"bdy-feed-time",children:tx(C.createdAt)})]}),C.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-delete-btn",onClick:()=>Fn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(re=>`${re.value} ${re.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed a workout using Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo bdy-feed-card-badge",children:(()=>{const re=Jr.find(Re=>Re.id===C.metadata.badgeId);return re?.img?a.jsx("img",{src:re.img,alt:C.metadata.title,loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title})})()}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.badgeDesc}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Earned a badge on Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(re=>`${re.value} ${re.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed daily habits with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"bdy-feed-content",children:Ht(C.content)}),C.imageURL&&a.jsx("div",{className:"bdy-feed-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"bdy-feed-actions",children:[a.jsxs("button",{className:`bdy-feed-action-btn${st.has(C.id)?" liked":""}`,onClick:()=>Jn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:st.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`bdy-feed-action-btn${Te.has(C.id)?" active":""}`,onClick:()=>On(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Te.has(C.id)&&a.jsxs("div",{className:"bdy-feed-comments",children:[Ae[C.id]?.length>0?Ae[C.id].map(re=>a.jsxs("div",{className:"bdy-feed-comment",children:[a.jsx("div",{className:"bdy-feed-comment-avatar",children:re.authorPhotoURL?a.jsx("img",{src:re.authorPhotoURL,alt:""}):a.jsx("span",{children:Mo(re.authorName)})}),a.jsxs("div",{className:"bdy-feed-comment-body",children:[a.jsxs("div",{className:"bdy-feed-comment-bubble",children:[a.jsx("span",{className:"bdy-feed-comment-name",children:re.authorName}),re.replyToName&&a.jsxs("span",{className:"bdy-feed-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),re.replyToName]}),re.content&&a.jsx("span",{className:"bdy-feed-comment-text",children:Ht(re.content)}),re.imageURL&&a.jsx("img",{className:"bdy-feed-comment-img",src:re.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"bdy-feed-comment-row",children:[a.jsx("span",{className:"bdy-feed-comment-time",children:tx(re.createdAt)}),a.jsx("button",{className:"bdy-feed-comment-reply-btn",onClick:()=>Pe(Re=>({...Re,[C.id]:{id:re.id,authorName:re.authorName}})),children:"Reply"}),re.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-comment-del-btn",onClick:()=>Gt(C.id,re.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},re.id)):a.jsx("p",{className:"bdy-feed-no-comments",children:"No comments yet"}),_e[C.id]&&a.jsxs("div",{className:"bdy-feed-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:_e[C.id].authorName})]}),a.jsx("button",{onClick:()=>Pe(re=>({...re,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Je[C.id]&&a.jsxs("div",{className:"bdy-feed-comment-img-preview",children:[a.jsx("img",{src:Je[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>It(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"bdy-feed-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"bdy-feed-comment-img-btn",onClick:()=>Rt.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:re=>{Rt.current[C.id]=re},type:"file",accept:"image/*",onChange:re=>Dt(C.id,re),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:V[C.id]||"",onChange:re=>{ce(Re=>({...Re,[C.id]:re.target.value})),le(re.target.value,C.id)},onKeyDown:re=>{re.key==="Enter"&&cn(C.id)},maxLength:300}),Sn&&qt===C.id&&gn.length>0&&a.jsx("div",{className:"bdy-feed-mention-dropdown",children:gn.map(re=>a.jsxs("button",{className:"bdy-feed-mention-option",onClick:()=>pt(re,C.id),children:[a.jsx("div",{className:"bdy-feed-mention-avatar",children:re.photoURL?a.jsx("img",{src:re.photoURL,alt:""}):a.jsx("span",{children:Mo(re.name)})}),a.jsx("span",{children:re.name})]},re.id))}),a.jsx("button",{onClick:()=>cn(C.id),disabled:!(V[C.id]||"").trim()&&!ze[C.id]||je[C.id],children:je[C.id]?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})})]})]})]},C.id))})}),g==="buddies"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:p.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Mo(C.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:C.name})}),a.jsx("button",{className:"bdy-view-btn",onClick:re=>{re.stopPropagation(),d(`/client/core-buddy/profile/${C.id}`)},"aria-label":"View profile",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]},C.id))})}),g==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.fromClient.photoURL?a.jsx("img",{src:C.fromClient.photoURL,alt:C.fromClient.name}):a.jsx("span",{children:Mo(C.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>wt(C),disabled:I===C.reqId,children:I===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>Bt(C),disabled:I===C.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},C.reqId))})]}),R.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:R.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.toClient?.photoURL?a.jsx("img",{src:C.toClient.photoURL,alt:C.toClient.name}):a.jsx("span",{children:Mo(C.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fs(C),disabled:I===C.reqId,children:I===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},C.reqId))})]}),k.length===0&&R.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),g==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:G,onChange:C=>U(C.target.value),autoFocus:!0}),G&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>U(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),G.trim()&&K.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',G,'"']})}),K.length>0&&a.jsx("div",{className:"bdy-list",children:K.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Mo(C.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.name}),C.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),C.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):C.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):C.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:re=>{re.stopPropagation();const Re=k.find(Ie=>Ie.fromId===C.id);Re&&wt(Re)},disabled:!!I,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:re=>{re.stopPropagation(),mt(C.id)},disabled:I===C.id,children:I===C.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},C.id))})]})]})]}),a.jsx(ti,{active:"buddies"}),O&&a.jsxs("div",{className:`toast-notification ${O.type}`,children:[a.jsx("span",{className:"toast-icon",children:O.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):O.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:O.message})]})]})})}function bh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ap(s,e){return[s,e].sort().join("_")}const T5=5;function op(s){return s.toISOString().split("T")[0]}function nx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function S5(){const{userId:s}=_S(),{currentUser:e,isClient:t,clientData:i,loading:l}=Or(),{isDark:u,toggleTheme:d}=Ui(),g=Zs(),[y,p]=w.useState(null),[b,k]=w.useState("none"),[T,R]=w.useState(null),[q,G]=w.useState(!0),[U,K]=w.useState(!1),[Y,ee]=w.useState(null),[ye,ke]=w.useState([]),[ve,I]=w.useState(!1),[E,O]=w.useState(new Set),[B,D]=w.useState(new Set),[L,A]=w.useState({}),[Le,st]=w.useState({}),[te,Te]=w.useState({}),[He,Ae]=w.useState(!0),[We,V]=w.useState(0),[ce,je]=w.useState(0),[Se,_e]=w.useState(0),[Pe,ze]=w.useState(new Set),[Ye,Je]=w.useState(null),[Qt,Rt]=w.useState(!1),[Sn,on]=w.useState(!1),[qt,Tt]=w.useState([]),[gn,St]=w.useState(!1),[ut,le]=w.useState(null),[pt,Ht]=w.useState([]),it=w.useCallback((Z,C="info")=>{ee({message:Z,type:C}),setTimeout(()=>ee(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&g("/")},[e,t,l,g]),w.useEffect(()=>{i&&s&&i.id===s&&g("/client/core-buddy",{replace:!0})},[i,s,g]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let Z=!1;return(async()=>{G(!0);try{const Re=(await Wt(dt(ge,"clients"))).docs.map(Oe=>({id:Oe.id,...Oe.data()})).find(Oe=>Oe.id===s);if(!Re){Z||G(!1);return}Z||p(Re);const Ie=i.id,De=ap(Ie,s);if((await _s(Be(ge,"buddies",De))).exists())Z||k("buddy");else{const Oe=`${Ie}_${s}`,Lt=await _s(Be(ge,"buddyRequests",Oe));if(Lt.exists()&&Lt.data().status==="pending")Z||(k("pending_out"),R(Oe));else{const xt=`${s}_${Ie}`,lt=await _s(Be(ge,"buddyRequests",xt));lt.exists()&&lt.data().status==="pending"?Z||(k("pending_in"),R(xt)):Z||k("none")}}}catch(C){console.error("Error loading profile:",C)}finally{Z||G(!1)}})(),()=>{Z=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let Z=!1;return(async()=>{Ae(!0);try{const C=await Wt(tn(dt(ge,"workoutLogs"),kt("clientId","==",s)));if(Z)return;const re=C.docs.length;V(re);let Re=0;const Ie=C.docs.map(Fe=>Fe.data().date).filter(Boolean).sort().reverse();if(Ie.length>0){const Fe=new Date;let Oe=new Date(Fe);for(let Lt=0;Lt<52;Lt++){const xt=new Date(Oe),lt=xt.getDay(),un=lt===0?6:lt-1;xt.setDate(xt.getDate()-un),xt.setHours(0,0,0,0);const dn=new Date(xt);dn.setDate(dn.getDate()+7);const Pn=op(xt),ms=op(dn);if(Ie.some(Me=>Me>=Pn&&Me<ms))Re++;else{if(Lt>0)break;break}Oe.setDate(Oe.getDate()-7)}}Z||je(Re);let De=0;for(let Fe=0;Fe<30;Fe++){const Oe=new Date;Oe.setDate(Oe.getDate()-Fe);const Lt=op(Oe);try{const xt=await Wt(tn(dt(ge,"habitLogs"),kt("clientId","==",s),kt("date","==",Lt)));if(xt.empty)break;{const lt=xt.docs[0].data().habits||{};if(Object.values(lt).filter(Boolean).length>=T5)De++;else break}}catch{break}}Z||_e(De);try{const Fe=await _s(Be(ge,"coreBuddyBadges",s));if(!Z&&Fe.exists()){const Oe=Fe.data().earned||[];ze(new Set(Oe.map(Lt=>Lt.id)))}}catch(Fe){console.error("Error loading buddy badges:",Fe)}}catch(C){console.error("Error loading buddy stats:",C)}finally{Z||Ae(!1)}})(),()=>{Z=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const Z=i.id;(async()=>{try{const[C,re,Re]=await Promise.all([Wt(tn(dt(ge,"buddies"),kt("user1","==",Z))),Wt(tn(dt(ge,"buddies"),kt("user2","==",Z))),Wt(dt(ge,"clients"))]),Ie=new Set;[...C.docs,...re.docs].forEach(Fe=>{const Oe=Fe.data();Ie.add(Oe.user1===Z?Oe.user2:Oe.user1)});const De={};Re.docs.forEach(Fe=>{De[Fe.id]=Fe.data()}),Tt(Array.from(Ie).filter(Fe=>De[Fe]).map(Fe=>({id:Fe,name:De[Fe].name,photoURL:De[Fe].photoURL||null})))}catch(C){console.error("Error loading buddies for mentions:",C)}})()},[i]);const yt=async(Z,C,re={})=>{if(!(!i||Z===i.id))try{await or(dt(ge,"notifications"),{toId:Z,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:C,read:!1,createdAt:xs(),...re})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&it("Notifications blocked  check Firestore rules","error")}},mt=async()=>{K(!0);try{const Z=`${i.id}_${s}`;await ss(Be(ge,"buddyRequests",Z),{fromId:i.id,toId:s,status:"pending",createdAt:xs()}),await yt(s,"buddy_request"),k("pending_out"),R(Z),it("Buddy request sent!","success")}catch(Z){console.error(Z),it("Failed to send request","error")}finally{K(!1)}},wt=async()=>{if(T){K(!0);try{const Z=ap(i.id,s);await ss(Be(ge,"buddies",Z),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:xs()}),await ar(Be(ge,"buddyRequests",T)),await yt(s,"buddy_accept"),k("buddy"),it("Buddy added!","success")}catch(Z){console.error(Z),it("Failed to accept","error")}finally{K(!1)}}},Bt=async()=>{if(T){K(!0);try{await ar(Be(ge,"buddyRequests",T)),k("none"),it(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(Z){console.error(Z),it("Failed","error")}finally{K(!1)}}},fs=async()=>{K(!0);try{const Z=ap(i.id,s);await ar(Be(ge,"buddies",Z)),k("none"),Rt(!1),it("Buddy removed","info")}catch(Z){console.error(Z),it("Failed to remove","error")}finally{K(!1)}},rn=w.useCallback(async()=>{if(s){I(!0);try{const Z=await Wt(tn(dt(ge,"posts"),kt("authorId","==",s),$o("createdAt","desc"),Wo(30)));if(ke(Z.docs.map(C=>({id:C.id,...C.data()}))),i){const C=await Wt(tn(dt(ge,"postLikes"),kt("userId","==",i.id)));O(new Set(C.docs.map(re=>re.data().postId)))}}catch(Z){console.error("Error loading journey:",Z)}finally{I(!1)}}},[s,i]);w.useEffect(()=>{!q&&y&&rn()},[q,y,rn]);const Jn=async Z=>{if(window.confirm("Delete this post?"))try{await ar(Be(ge,"posts",Z)),ke(C=>C.filter(re=>re.id!==Z)),it("Post deleted","info")}catch(C){console.error("Delete error:",C),it("Failed to delete","error")}},Fn=async Z=>{if(!i)return;const C=i.id,re=`${Z}_${C}`,Re=E.has(Z),Ie=new Set(E);Re?Ie.delete(Z):Ie.add(Z),O(Ie),ke(De=>De.map(Fe=>Fe.id===Z?{...Fe,likeCount:Math.max(0,(Fe.likeCount||0)+(Re?-1:1))}:Fe));try{if(Re)await ar(Be(ge,"postLikes",re)),await zn(Be(ge,"posts",Z),{likeCount:hi(-1)});else{await ss(Be(ge,"postLikes",re),{postId:Z,userId:C,createdAt:xs()}),await zn(Be(ge,"posts",Z),{likeCount:hi(1)});const De=ye.find(Fe=>Fe.id===Z);De&&yt(De.authorId,"like",{postId:Z})}}catch(De){console.error("Like error:",De),rn()}},Ln=async Z=>{try{const C=await Wt(tn(dt(ge,"postComments"),kt("postId","==",Z),$o("createdAt","asc"),Wo(50)));A(re=>({...re,[Z]:C.docs.map(Re=>({id:Re.id,...Re.data()}))}))}catch(C){console.error("Error loading comments:",C)}},On=Z=>{const C=new Set(B);C.has(Z)?C.delete(Z):(C.add(Z),L[Z]||Ln(Z)),D(C)},cn=(Z,C)=>{const re=Z.match(/@(\w*)$/);if(re){St(!0),le(C);const Re=qt.filter(Ie=>Ie.name&&Ie.name.toLowerCase().includes(re[1].toLowerCase())).slice(0,5);Ht(Re)}else St(!1),Ht([])},Gt=(Z,C)=>{const Re=(Le[C]||"").replace(/@\w*$/,`@${Z.name} `);st(Ie=>({...Ie,[C]:Re})),St(!1),Ht([])},Dt=(Z,C)=>{st(re=>({...re,[Z]:C})),cn(C,Z)},It=async Z=>{const C=(Le[Z]||"").trim();if(!(!C||!i)){Te(re=>({...re,[Z]:!0}));try{await or(dt(ge,"postComments"),{postId:Z,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:C,createdAt:xs()}),await zn(Be(ge,"posts",Z),{commentCount:hi(1)});const re=ye.find(Ie=>Ie.id===Z);re&&yt(re.authorId,"comment",{postId:Z});const Re=C.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Re){const Ie=new Set;Re.forEach(De=>{const Fe=De.slice(1).trim(),Oe=qt.find(Lt=>Lt.name&&Lt.name.toLowerCase()===Fe.toLowerCase());Oe&&!Ie.has(Oe.id)&&(Ie.add(Oe.id),yt(Oe.id,"mention",{postId:Z}))})}st(Ie=>({...Ie,[Z]:""})),ke(Ie=>Ie.map(De=>De.id===Z?{...De,commentCount:(De.commentCount||0)+1}:De)),await Ln(Z)}catch(re){console.error("Comment error:",re),it("Failed to comment","error")}finally{Te(re=>({...re,[Z]:!1}))}}};return l||q||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(sl,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>Rt(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&on(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:bh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:mt,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Bt,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:wt,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Bt,disabled:U,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),He?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:We}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ce,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Se>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Se," day",Se!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const Z=Jr.filter(C=>Pe.has(C.id));return Z.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[Z.length,"/",Jr.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:Z.map(C=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Je(C),children:[a.jsx("img",{src:C.img,alt:C.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:C.name})]},C.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),ve?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):ye.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:ye.map(Z=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:bh(Z.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Z.authorName}),a.jsx("span",{className:"journey-post-time",children:nx(Z.createdAt)})]}),Z.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Jn(Z.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Z.type==="workout_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),!Z.metadata.stats?.length&&Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="badge_earned"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const C=Jr.find(re=>re.id===Z.metadata.badgeId);return C?.img?a.jsx("img",{src:C.img,alt:Z.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:Z.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="habits_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[Z.content&&a.jsx("p",{className:"journey-post-content",children:Z.content}),Z.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Z.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${E.has(Z.id)?" liked":""}`,onClick:()=>Fn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Z.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${B.has(Z.id)?" active":""}`,onClick:()=>On(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Z.commentCount||0})]})]}),B.has(Z.id)&&a.jsxs("div",{className:"journey-comments",children:[L[Z.id]?.length>0?L[Z.id].map(C=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>g(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:bh(C.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:C.authorName}),a.jsx("span",{className:"journey-comment-text",children:C.content})]}),a.jsx("span",{className:"journey-comment-time",children:nx(C.createdAt)})]})]},C.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Le[Z.id]||"",onChange:C=>Dt(Z.id,C.target.value),onKeyDown:C=>{C.key==="Enter"&&It(Z.id)},maxLength:300}),gn&&ut===Z.id&&pt.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:pt.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>Gt(C,Z.id),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:bh(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),a.jsx("button",{onClick:()=>It(Z.id),disabled:!(Le[Z.id]||"").trim()||te[Z.id],children:te[Z.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Z.id))})]})]}),a.jsx(ti,{active:"buddies"}),Sn&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>on(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),Ye&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Je(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Z=>Z.stopPropagation(),children:[a.jsx("img",{src:Ye.img,alt:Ye.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Ye.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Ye.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Je(null),children:"Close"})]})}),Qt&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>Rt(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:Z=>Z.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>Rt(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:fs,disabled:U,children:U?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),Y&&a.jsxs("div",{className:`toast-notification ${Y.type}`,children:[a.jsx("span",{className:"toast-icon",children:Y.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:Y.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ti,{active:"buddies"})]})}const lp=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],sx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function C5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function N5(){const s=Zs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Or(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[g,y]=w.useState(0),[p,b]=w.useState(0),[k,T]=w.useState(null),[R,q]=w.useState(!1),G=w.useRef(null),[U,K]=w.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:sx.filter(A=>A.defaultOn).map(A=>A.id)}),[Y,ee]=w.useState(!1),[ye,ke]=w.useState(!1),[ve,I]=w.useState(null);w.useEffect(()=>{e?.photoURL&&T(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const L=()=>{const Le=new Date,st=new Date(Le);st.setHours(23,59,59,999);const te=st-Le;d({hours:Math.floor(te/36e5),minutes:Math.floor(te%36e5/6e4),seconds:Math.floor(te%6e4/1e3)}),y(60-Math.floor(te%6e4/1e3))};L();const A=setInterval(L,1e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{const L=setInterval(()=>b(A=>(A+1)%lp.length),8e3);return()=>clearInterval(L)},[]);const E=async L=>{const A=L.target.files?.[0];if(!(!A||!e?.id)){q(!0);try{const Le=oa(la,`profilePhotos/${e.id}`);await vu(Le,A);const st=await so(Le);await zn(Be(ge,"clients",e.id),{photoURL:st}),T(st),i({photoURL:st})}catch(Le){console.error("Photo upload error:",Le)}finally{q(!1)}}},O=L=>{ke(!1),K(A=>A.includes(L)?A.filter(Le=>Le!==L):[...A,L])},B=(L,A)=>{ke(!1),K(Le=>{const st=Le.indexOf(L);if(st<0)return Le;const te=st+A;if(te<0||te>=Le.length)return Le;const Te=[...Le];return[Te[st],Te[te]]=[Te[te],Te[st]],Te})},D=async()=>{ee(!0),I(null);try{const L=e||await l();if(!L?.id){I("Could not find your profile. Try refreshing."),ee(!1);return}await zn(Be(ge,"clients",L.id),{dashboardWidgets:U}),i({dashboardWidgets:U}),ke(!0)}catch(L){console.error("Save config error:",L),I("Save failed  please try again.")}finally{ee(!1)}};return a.jsx(sl,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Sj.map((L,A)=>a.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${A<g?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>G.current?.click(),children:[a.jsx("img",{src:k||"/Logo.webp",alt:k?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${R?" uploading":""}`,children:R?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:G,type:"file",accept:"image/*",onChange:E,style:{display:"none"}})]}),!k&&!R&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>G.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[lp[p].text," ",a.jsx("strong",{children:lp[p].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:sx.map(L=>{const A=U.includes(L.id),Le=U.indexOf(L.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:C5(L.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:L.label}),a.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>B(L.id,-1),disabled:Le===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Le+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>B(L.id,1),disabled:Le===U.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>O(L.id),"aria-label":A?`Remove ${L.label}`:`Add ${L.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${ye?" saved":""}`,onClick:D,disabled:Y||ye,children:Y?"Saving...":ye?"Saved":"Save Dashboard"}),ve&&a.jsx("p",{className:"bldr-save-error",children:ve}),ye&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(ti,{active:"home"})]})})}const Cj="@firebase/installations",p0="0.6.19";const Nj=1e4,Aj=`w:${p0}`,Rj="FIS_v2",A5="https://firebaseinstallations.googleapis.com/v1",R5=3600*1e3,I5="installations",M5="Installations";const D5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ko=new Qo(I5,M5,D5);function Ij(s){return s instanceof vi&&s.code.includes("request-failed")}function Mj({projectId:s}){return`${A5}/projects/${s}/installations`}function Dj(s){return{token:s.token,requestStatus:2,expiresIn:O5(s.expiresIn),creationTime:Date.now()}}async function Lj(s,e){const i=(await e.json()).error;return Ko.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Oj({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function L5(s,{refreshToken:e}){const t=Oj(s);return t.append("Authorization",P5(e)),t}async function Pj(s){const e=await s();return e.status>=500&&e.status<600?s():e}function O5(s){return Number(s.replace("s","000"))}function P5(s){return`${Rj} ${s}`}async function V5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Mj(s),l=Oj(s),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={fid:t,authVersion:Rj,appId:s.appId,sdkVersion:Aj},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Pj(()=>fetch(i,g));if(y.ok){const p=await y.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:Dj(p.authToken)}}else throw await Lj("Create Installation",y)}function Vj(s){return new Promise(e=>{setTimeout(e,s)})}function U5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const B5=/^[cdef][\w-]{21}$/,Yp="";function z5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=F5(s);return B5.test(t)?t:Yp}catch{return Yp}}function F5(s){return U5(s).substr(0,22)}function Rf(s){return`${s.appName}!${s.appId}`}const Uj=new Map;function Bj(s,e){const t=Rf(s);zj(t,e),H5(t,e)}function zj(s,e){const t=Uj.get(s);if(t)for(const i of t)i(e)}function H5(s,e){const t=q5();t&&t.postMessage({key:s,fid:e}),$5()}let Oo=null;function q5(){return!Oo&&"BroadcastChannel"in self&&(Oo=new BroadcastChannel("[Firebase] FID Change"),Oo.onmessage=s=>{zj(s.data.key,s.data.fid)}),Oo}function $5(){Uj.size===0&&Oo&&(Oo.close(),Oo=null)}const W5="firebase-installations-database",G5=1,Yo="firebase-installations-store";let cp=null;function y0(){return cp||(cp=af(W5,G5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Yo)}})),cp}async function tf(s,e){const t=Rf(s),l=(await y0()).transaction(Yo,"readwrite"),u=l.objectStore(Yo),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&Bj(s,e.fid),e}async function Fj(s){const e=Rf(s),i=(await y0()).transaction(Yo,"readwrite");await i.objectStore(Yo).delete(e),await i.done}async function If(s,e){const t=Rf(s),l=(await y0()).transaction(Yo,"readwrite"),u=l.objectStore(Yo),d=await u.get(t),g=e(d);return g===void 0?await u.delete(t):await u.put(g,t),await l.done,g&&(!d||d.fid!==g.fid)&&Bj(s,g.fid),g}async function v0(s){let e;const t=await If(s.appConfig,i=>{const l=K5(i),u=Y5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Yp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function K5(s){const e=s||{fid:z5(),registrationStatus:0};return Hj(e)}function Y5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Ko.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Q5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:X5(s)}:{installationEntry:e}}async function Q5(s,e){try{const t=await V5(s,e);return tf(s.appConfig,t)}catch(t){throw Ij(t)&&t.customData.serverCode===409?await Fj(s.appConfig):await tf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function X5(s){let e=await rx(s.appConfig);for(;e.registrationStatus===1;)await Vj(100),e=await rx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await v0(s);return i||t}return e}function rx(s){return If(s,e=>{if(!e)throw Ko.create("installation-not-found");return Hj(e)})}function Hj(s){return J5(s)?{fid:s.fid,registrationStatus:0}:s}function J5(s){return s.registrationStatus===1&&s.registrationTime+Nj<Date.now()}async function Z5({appConfig:s,heartbeatServiceProvider:e},t){const i=eL(s,t),l=L5(s,t),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={installation:{sdkVersion:Aj,appId:s.appId}},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Pj(()=>fetch(i,g));if(y.ok){const p=await y.json();return Dj(p)}else throw await Lj("Generate Auth Token",y)}function eL(s,{fid:e}){return`${Mj(s)}/${e}/authTokens:generate`}async function b0(s,e=!1){let t;const i=await If(s.appConfig,u=>{if(!qj(u))throw Ko.create("not-registered");const d=u.authToken;if(!e&&sL(d))return u;if(d.requestStatus===1)return t=tL(s,e),u;{if(!navigator.onLine)throw Ko.create("app-offline");const g=iL(u);return t=nL(s,g),g}});return t?await t:i.authToken}async function tL(s,e){let t=await ix(s.appConfig);for(;t.authToken.requestStatus===1;)await Vj(100),t=await ix(s.appConfig);const i=t.authToken;return i.requestStatus===0?b0(s,e):i}function ix(s){return If(s,e=>{if(!qj(e))throw Ko.create("not-registered");const t=e.authToken;return aL(t)?{...e,authToken:{requestStatus:0}}:e})}async function nL(s,e){try{const t=await Z5(s,e),i={...e,authToken:t};return await tf(s.appConfig,i),t}catch(t){if(Ij(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Fj(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await tf(s.appConfig,i)}throw t}}function qj(s){return s!==void 0&&s.registrationStatus===2}function sL(s){return s.requestStatus===2&&!rL(s)}function rL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+R5}function iL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function aL(s){return s.requestStatus===1&&s.requestTime+Nj<Date.now()}async function oL(s){const e=s,{installationEntry:t,registrationPromise:i}=await v0(e);return i?i.catch(console.error):b0(e).catch(console.error),t.fid}async function lL(s,e=!1){const t=s;return await cL(t),(await b0(t,e)).token}async function cL(s){const{registrationPromise:e}=await v0(s);e&&await e}function uL(s){if(!s||!s.options)throw up("App Configuration");if(!s.name)throw up("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw up(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function up(s){return Ko.create("missing-app-config-values",{valueName:s})}const $j="installations",dL="installations-internal",hL=s=>{const e=s.getProvider("app").getImmediate(),t=uL(e),i=Xo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},fL=s=>{const e=s.getProvider("app").getImmediate(),t=Xo(e,$j).getImmediate();return{getId:()=>oL(t),getToken:l=>lL(t,l)}};function mL(){mi(new ei($j,hL,"PUBLIC")),mi(new ei(dL,fL,"PRIVATE"))}mL();wr(Cj,p0);wr(Cj,p0,"esm2020");const gL="/firebase-messaging-sw.js",pL="/firebase-cloud-messaging-push-scope",Wj="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",yL="https://fcmregistrations.googleapis.com/v1",Gj="google.c.a.c_id",vL="google.c.a.c_l",bL="google.c.a.ts",wL="google.c.a.e",ax=1e4;var ox;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ox||(ox={}));var Au;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Au||(Au={}));function ra(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function xL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const dp="fcm_token_details_db",_L=5,lx="fcm_token_object_Store";async function kL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(dp))return null;let e=null;return(await af(dp,_L,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(lx))return;const g=d.objectStore(lx),y=await g.index("fcmSenderId").get(s);if(await g.clear(),!!y){if(l===2){const p=y;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:ra(p.vapidKey)}}}else if(l===3){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ra(p.auth),p256dh:ra(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ra(p.vapidKey)}}}else if(l===4){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ra(p.auth),p256dh:ra(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ra(p.vapidKey)}}}}}})).close(),await Vg(dp),await Vg("fcm_vapid_details_db"),await Vg("undefined"),jL(e)?e:null}function jL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const EL="firebase-messaging-database",TL=1,Ru="firebase-messaging-store";let hp=null;function Kj(){return hp||(hp=af(EL,TL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ru)}})),hp}async function SL(s){const e=Yj(s),i=await(await Kj()).transaction(Ru).objectStore(Ru).get(e);if(i)return i;{const l=await kL(s.appConfig.senderId);if(l)return await w0(s,l),l}}async function w0(s,e){const t=Yj(s),l=(await Kj()).transaction(Ru,"readwrite");return await l.objectStore(Ru).put(e,t),await l.done,e}function Yj({appConfig:s}){return s.appId}const CL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dr=new Qo("messaging","Messaging",CL);async function NL(s,e){const t=await _0(s),i=Qj(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(x0(s.appConfig),l)).json()}catch(d){throw dr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-subscribe-no-token");return u.token}async function AL(s,e){const t=await _0(s),i=Qj(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${x0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw dr.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw dr.create("token-update-failed",{errorInfo:d})}if(!u.token)throw dr.create("token-update-no-token");return u.token}async function RL(s,e){const i={method:"DELETE",headers:await _0(s)};try{const u=await(await fetch(`${x0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw dr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw dr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function x0({projectId:s}){return`${yL}/projects/${s}/registrations`}async function _0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function Qj({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==Wj&&(l.web.applicationPubKey=i),l}const IL=10080*60*1e3;async function ML(s){const e=await LL(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:ra(e.getKey("auth")),p256dh:ra(e.getKey("p256dh"))},i=await SL(s.firebaseDependencies);if(i){if(OL(i.subscriptionOptions,t))return Date.now()>=i.createTime+IL?DL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await RL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return cx(s.firebaseDependencies,t)}else return cx(s.firebaseDependencies,t)}async function DL(s,e){try{const t=await AL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await w0(s.firebaseDependencies,i),t}catch(t){throw t}}async function cx(s,e){const i={token:await NL(s,e),createTime:Date.now(),subscriptionOptions:e};return await w0(s,i),i.token}async function LL(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:xL(e)})}function OL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function ux(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return PL(e,s),VL(e,s),UL(e,s),e}function PL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function VL(s,e){e.data&&(s.data=e.data)}function UL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function BL(s){return typeof s=="object"&&!!s&&Gj in s}function zL(s){if(!s||!s.options)throw fp("App Configuration Object");if(!s.name)throw fp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw fp(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fp(s){return dr.create("missing-app-config-values",{valueName:s})}class FL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=zL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function HL(s){try{s.swRegistration=await navigator.serviceWorker.register(gL,{scope:pL}),s.swRegistration.update().catch(()=>{}),await qL(s.swRegistration)}catch(e){throw dr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function qL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${ax} ms`)),ax),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function $L(s,e){if(!e&&!s.swRegistration&&await HL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw dr.create("invalid-sw-registration");s.swRegistration=e}}async function WL(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=Wj)}async function Xj(s,e){if(!navigator)throw dr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw dr.create("permission-blocked");return await WL(s,e?.vapidKey),await $L(s,e?.serviceWorkerRegistration),ML(s)}async function GL(s,e,t){const i=KL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[Gj],message_name:t[vL],message_time:t[bL],message_device_time:Math.floor(Date.now()/1e3)})}function KL(s){switch(s){case Au.NOTIFICATION_CLICKED:return"notification_open";case Au.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function YL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Au.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(ux(t)):s.onMessageHandler.next(ux(t)));const i=t.data;BL(i)&&i[wL]==="1"&&await GL(s,t.messageType,i)}const dx="@firebase/messaging",hx="0.12.23";const QL=s=>{const e=new FL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>YL(e,t)),e},XL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>Xj(e,i)}};function JL(){mi(new ei("messaging",QL,"PUBLIC")),mi(new ei("messaging-internal",XL,"PRIVATE")),wr(dx,hx),wr(dx,hx,"esm2020")}async function ZL(){try{await qx()}catch{return!1}return typeof window<"u"&&Hx()&&OC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function eO(s=Lu()){return ZL().then(e=>{if(!e)throw dr.create("unsupported-browser")},e=>{throw dr.create("indexed-db-unsupported")}),Xo(jn(s),"messaging").getImmediate()}async function tO(s,e){return s=jn(s),Xj(s,e)}JL();const nO="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let mp=null;function sO(){if(!mp)try{mp=eO(Lu())}catch{return null}return mp}function Qp(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function fx(){return"Notification"in window?Notification.permission:"denied"}function rO(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function iO(s){if(!Qp())return null;try{const e=await Notification.requestPermission(),t=sO();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let g=1;g<=d;g++){try{const y=()=>tO(t,{vapidKey:nO,serviceWorkerRegistration:i});if(u=l?await rO(y):await y(),u)break}catch(y){console.warn(`Push getToken attempt ${g}/${d} failed:`,y)}g<d&&await new Promise(y=>setTimeout(y,1500*g))}return u&&s&&await zn(Be(ge,"clients",s),{fcmTokens:T6(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function aO(s,e){if(!(!e||!s))try{await zn(Be(ge,"clients",s),{fcmTokens:S6(e)})}catch(t){console.error("Token revoke failed:",t)}}const oO=[{key:"daily_morning",label:"Morning motivation",desc:"Daily 6 AM motivational nudge to start your day"},{key:"daily_evening",label:"Evening check-in",desc:"Daily 6 PM reminder to log your habits"},{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function lO(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Or(),{isDark:u,toggleTheme:d,accent:g,setAccent:y,isMono:p,toggleMono:b}=Ui(),k=Zs(),[T,R]=w.useState(!1),[q,G]=w.useState(null),[U,K]=w.useState(!1),[Y,ee]=w.useState("default"),[ye,ke]=w.useState({daily_morning:!0,daily_evening:!0,buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[ve,I]=w.useState(null),E=w.useCallback((D,L="info")=>{I({message:D,type:L}),setTimeout(()=>I(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&k("/")},[l,s,k]),w.useEffect(()=>{if(!e)return;const D=e.notificationPrefs;D&&ke(A=>({...A,...D}));const L=e.fcmTokens||[];L.length>0&&(R(!0),G(L[L.length-1])),ee(fx())},[e]);const O=async()=>{if(e){K(!0);try{if(T)q&&await aO(e.id,q),R(!1),G(null),t({fcmTokens:[]}),E("Push notifications disabled","info");else{if(!Qp()){E("Push notifications are not supported on this device","error");return}const D=await iO(e.id),L=fx();ee(L),D?(R(!0),G(D),t({fcmTokens:[...e.fcmTokens||[],D]}),E("Push notifications enabled!","success")):E(L==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":L==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(D){console.error("Push toggle failed:",D),E("Something went wrong  please try again","error")}finally{K(!1)}}},B=async D=>{if(!e)return;const L={...ye,[D]:!ye[D]};ke(L);try{await zn(Be(ge,"clients",e.id),{notificationPrefs:L}),t({notificationPrefs:L})}catch(A){console.error("Failed to save pref:",A),ke(Le=>({...Le,[D]:!Le[D]})),E("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>k("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"19",cy:"13.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),a.jsx("circle",{cx:"5",cy:"15.5",r:"2.5"}),a.jsx("circle",{cx:"11",cy:"19.5",r:"2.5"}),a.jsx("path",{d:"M12 2a10 10 0 0 0 0 20 2 2 0 0 0 2-2v-1a2 2 0 0 1 2-2h1a2 2 0 0 0 2-2 10 10 0 0 0-7-13z"})]}),"Accent Colour"]}),a.jsx("div",{className:"settings-accent-row",children:[{key:"red",color:"#B8313D",label:"Red"},{key:"orange",color:"#FF8533",label:"Orange"},{key:"blue",color:"#1AADFF",label:"Blue"},{key:"green",color:"#C1FF72",label:"Green"},{key:"purple",color:"#CB6CE6",label:"Purple"}].map(D=>a.jsxs("button",{className:`settings-accent-option${g===D.key?" active":""}`,onClick:()=>y(D.key),"aria-label":`${D.label} accent`,children:[a.jsx("span",{className:"settings-accent-dot",style:{background:D.color}}),a.jsx("span",{className:"settings-accent-label",children:D.label})]},D.key))}),a.jsxs("div",{className:"settings-row settings-mono-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Mono"}),a.jsx("span",{className:"settings-row-desc",children:"Black & white with frosted glass"})]}),a.jsx("button",{className:`settings-toggle${p?" on":""}`,onClick:b,"aria-label":"Toggle mono theme",children:a.jsx("span",{className:"settings-toggle-knob"})})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Qp()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${T?" on":""}${U?" loading":""}`,onClick:O,disabled:U,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),oO.map(D=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:D.label}),a.jsx("span",{className:"settings-row-desc",children:D.desc})]}),a.jsx("button",{className:`settings-toggle${ye[D.key]?" on":""}`,onClick:()=>B(D.key),"aria-label":`Toggle ${D.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},D.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),ve&&a.jsx("div",{className:`settings-toast ${ve.type}`,children:ve.message}),a.jsx(ti,{active:"home"})]})}const wh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function gp({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function mx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,g=2*Math.PI*d,y=g*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:g,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const gx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function cO(s,e,t){const i=t instanceof Ft?t:Ft.fromDate(new Date(t)),l=Ft.now();switch(s.type){case"workouts":{const u=tn(dt(ge,"workoutLogs"),kt("clientId","==",e),kt("completedAt",">=",i),kt("completedAt","<=",l));return(await Wt(u)).size}case"minutes":{const u=tn(dt(ge,"workoutLogs"),kt("clientId","==",e),kt("completedAt",">=",i),kt("completedAt","<=",l));return(await Wt(u)).docs.reduce((g,y)=>g+(y.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),d=new Date().toISOString().slice(0,10),g=tn(dt(ge,"habitLogs"),kt("clientId","==",e));return(await Wt(g)).docs.filter(p=>{const b=p.data().date;if(b<u||b>d)return!1;const k=p.data().habits||{};return Object.values(k).length>0&&Object.values(k).every(T=>T===!0)}).length}case"streak":{const u=tn(dt(ge,"workoutLogs"),kt("clientId","==",e),kt("completedAt",">=",i),kt("completedAt","<=",l)),d=await Wt(u),g=new Set(d.docs.map(k=>k.data().completedAt.toDate().toISOString().slice(0,10)));let y=0;const p=new Date(i.toDate()),b=new Date;for(;g.has(p.toISOString().slice(0,10))&&p<=b;)y++,p.setDate(p.getDate()+1);return y}default:return 0}}function uO(){const{currentUser:s,clientData:e,loading:t}=Or(),{isDark:i,toggleTheme:l}=Ui(),{isPremium:u}=hc(),d=Zs(),[g,y]=w.useState(null),[p,b]=w.useState(null),[k,T]=w.useState(0),[R,q]=w.useState(0),[G,U]=w.useState(!0),[K,Y]=w.useState(!1),[ee,ye]=w.useState(null),[ke,ve]=w.useState(null),[I,E]=w.useState(!1),[O,B]=w.useState(null),D=w.useCallback((Ae,We="info")=>{ve({message:Ae,type:We}),setTimeout(()=>ve(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const L=w.useCallback(async()=>{if(e){U(!0);try{const Ae=tn(dt(ge,"userChallenges"),kt("clientId","==",e.id),kt("status","==","active")),We=await Wt(Ae);if(We.empty)y(null),b(null);else{const je=We.docs[0],Se={id:je.id,...je.data()},_e=wh.find(Pe=>Pe.id===Se.challengeId);if(Se.endDate.toDate()<new Date)await zn(Be(ge,"userChallenges",je.id),{status:"failed"}),y(null),b(null),D("Challenge expired  time ran out","error");else if(y(Se),b(_e),_e){const Pe=await cO(_e,e.id,Se.startDate);if(T(Pe),Pe>=_e.goal&&Se.status==="active"){if(await zn(Be(ge,"userChallenges",je.id),{status:"completed",completedAt:xs()}),E(!0),y(ze=>ze?{...ze,status:"completed"}:null),!Se.badgeAwarded){const ze=Jr.find(Ye=>Ye.id===_e.id);if(ze)try{const Ye=Be(ge,"coreBuddyBadges",e.id),Je=await _s(Ye),Qt=Je.exists()?Je.data().earned||[]:[];if(!Qt.some(Rt=>Rt.id===ze.id)){const Rt={id:ze.id,earnedAt:new Date().toISOString()};Je.exists()?await zn(Ye,{earned:[...Qt,Rt]}):await ss(Ye,{earned:[Rt]})}await zn(Be(ge,"userChallenges",je.id),{badgeAwarded:!0}),await or(dt(ge,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:ze.name,badgeDesc:ze.desc,badgeId:ze.id},createdAt:xs(),likeCount:0,commentCount:0}),B(ze)}catch(Ye){console.error("Badge award failed:",Ye)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:_e.name,challenge_type:_e.type,duration_days:_e.duration})}}}const V=tn(dt(ge,"userChallenges"),kt("clientId","==",e.id),kt("status","==","completed")),ce=await Wt(V);q(ce.size)}catch(Ae){console.error("Failed to load challenges:",Ae)}finally{U(!1)}}},[e,D]);w.useEffect(()=>{L()},[L]);const A=async Ae=>{if(!(!e||K)){Y(!0);try{const We=wh.find(_e=>_e.id===Ae);if(!We)return;const V=tn(dt(ge,"userChallenges"),kt("clientId","==",e.id),kt("status","==","active"));if(!(await Wt(V)).empty){ye(null),D("You already have an active challenge","info"),await L();return}const je=Ft.now(),Se=Ft.fromDate(new Date(Date.now()+We.duration*864e5));await or(dt(ge,"userChallenges"),{clientId:e.id,challengeId:Ae,startDate:je,endDate:Se,status:"active",completedAt:null,badgeAwarded:!1,createdAt:xs()}),ye(null),D(`${We.name} started  let's go!`,"success"),await L()}catch(We){console.error("Start challenge failed:",We),We?.code==="permission-denied"?D("Permission denied  please re-login and try again","error"):D("Something went wrong  try again","error")}finally{Y(!1)}}},Le=async()=>{if(!(!g||K)){Y(!0);try{await zn(Be(ge,"userChallenges",g.id),{status:"failed"}),y(null),b(null),T(0),ye(null),D("Challenge abandoned","info"),await L()}catch(Ae){console.error("Give up failed:",Ae),D("Something went wrong","error")}finally{Y(!1)}}},st=g?.endDate?Math.max(0,Math.ceil((g.endDate.toDate()-new Date)/864e5)):0,te=()=>{if(!p||!g)return"";const Ae=Math.max(1,Math.ceil((Date.now()-g.startDate.toDate())/864e5)),We=p.goal/p.duration*Ae;return k>=We*1.15?"Ahead":k>=We*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Te=g&&g.status==="active"&&p,He=I||g&&g.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),G?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):He?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(mx,{progress:p?.goal||1,goal:p?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:p?.name}),a.jsxs("p",{className:"ch-completed-count",children:[R+(I?1:0)," challenge",R!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{E(!1),y(null),b(null),L()},children:"Choose Next Challenge"})]}):Te?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(mx,{progress:k,goal:p.goal,label:p.type==="minutes"?"minutes":p.type==="streak"?"day streak":p.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:st}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${te().toLowerCase().replace(" ","")}`,children:te()})]}),a.jsx("h2",{className:"ch-active-name",children:p.name}),a.jsx("p",{className:"ch-active-desc",children:p.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>ye("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:wh.filter(Ae=>Ae.id!==p.id).map(Ae=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Ae.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ae.name}),a.jsx("p",{children:Ae.description})]})]},Ae.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:wh.map(Ae=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?ye(Ae):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Ae.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ae.name}),a.jsx("p",{children:Ae.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Ae.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:gx[Ae.difficulty]},children:Ae.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Ae.id))})]})]}),ee&&ee!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&ye(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ae=>Ae.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(gp,{icon:ee.icon,size:36})}),a.jsx("h2",{children:ee.name}),a.jsx("p",{children:ee.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[ee.duration," days"]}),a.jsx("span",{style:{color:gx[ee.difficulty]},children:ee.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>A(ee.id),disabled:K,children:K?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ye(null),disabled:K,children:"Cancel"})]})}),ee==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&ye(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ae=>Ae.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Le,disabled:K,children:K?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ye(null),disabled:K,children:"Keep Going"})]})}),a.jsx(Kl,{badge:O,onDismiss:()=>B(null)}),ke&&a.jsx("div",{className:`ch-toast ch-toast-${ke.type}`,children:ke.message}),a.jsx(ti,{})]})}const dO={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},hO=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function fO(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Or(),{isDark:l,toggleTheme:u}=Ui(),d=Zs(),[g,y]=w.useState(new Set),[p,b]=w.useState({}),[k,T]=w.useState(!0),[R,q]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{T(!0);try{const K=await _s(Be(ge,"coreBuddyBadges",t.id));if(K.exists()){const Y=K.data().earned||[];y(new Set(Y.map(ye=>ye.id)));const ee={};Y.forEach(ye=>{ee[ye.id]=ye}),b(ee)}}catch(K){console.error("Failed to load badges:",K)}finally{T(!1)}})()},[t]);const G=hO.map(K=>({key:K,label:dO[K],badges:Jr.filter(Y=>Y.category===K)})).filter(K=>K.badges.length>0),U=Jr.filter(K=>g.has(K.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[U," / ",Jr.length," earned"]}),k?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):G.map(K=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:K.label}),a.jsx("div",{className:"bdg-grid",children:K.badges.map(Y=>{const ee=g.has(Y.id);return a.jsxs("button",{className:`bdg-item${ee?" earned":" locked"}`,onClick:()=>q(Y),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[Y.img?a.jsx("img",{src:Y.img,alt:Y.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!ee&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:Y.name})]},Y.id)})})]},K.key))]}),R&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>q(null),children:a.jsxs("div",{className:"bdg-modal",onClick:K=>K.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${g.has(R.id)?" earned":" locked"}`,children:R.img?a.jsx("img",{src:R.img,alt:R.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:R.name}),a.jsx("p",{className:"bdg-modal-desc",children:R.desc}),g.has(R.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",p[R.id]?.earnedAt?`  ${new Date(p[R.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>q(null),children:"Close"})]})}),a.jsx(ti,{active:"badges"})]})}const mO=w.lazy(()=>Js(()=>import("./Dashboard-DVZmKOVY.js"),__vite__mapDeps([0,1,2]))),gO=w.lazy(()=>Js(()=>import("./AddClient-CT6H96gW.js"),__vite__mapDeps([3,4]))),pO=w.lazy(()=>Js(()=>import("./ClientDashboard-Dn9WfetL.js"),__vite__mapDeps([5,1,6]))),yO=w.lazy(()=>Js(()=>import("./ClientForms-DKP15MSV.js"),__vite__mapDeps([7,8,6]))),vO=w.lazy(()=>Js(()=>import("./ClientTools-B_NHKQ6R.js"),__vite__mapDeps([9,10,6]))),bO=w.lazy(()=>Js(()=>import("./MacroCalculator-BssN6zrR.js"),__vite__mapDeps([11,10,6]))),wO=w.lazy(()=>Js(()=>import("./ProteinSnacks-BJKddTQs.js"),__vite__mapDeps([12,10,6]))),xO=w.lazy(()=>Js(()=>import("./DailyMotivation-C0JEZePn.js"),__vite__mapDeps([13,10,6]))),_O=w.lazy(()=>Js(()=>import("./CircuitDashboard-lMbDFBP8.js"),__vite__mapDeps([14,15]))),kO=w.lazy(()=>Js(()=>import("./CircuitBooking-BmptGwmy.js"),__vite__mapDeps([16,17,15]))),jO=w.lazy(()=>Js(()=>import("./PersonalBests-vyMMXtSi.js"),__vite__mapDeps([18,19,6]))),EO=w.lazy(()=>Js(()=>import("./Leaderboard-CpFRoILC.js"),__vite__mapDeps([20,21]))),TO=w.lazy(()=>Js(()=>import("./UpgradePage-D0Y_nWSD.js"),__vite__mapDeps([22,23,24]))),SO=w.lazy(()=>Js(()=>import("./SignUp-Ca8-3gz2.js"),[])),CO=w.lazy(()=>Js(()=>import("./Onboarding-B9Ti3YVo.js"),__vite__mapDeps([25,23,26])));function NO({children:s}){const{pathname:e}=Vi();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function AO(){const s=Zs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function RO(){return a.jsx(ZD,{children:a.jsx(JD,{children:a.jsx(r3,{children:a.jsxs(lC,{basename:"/login",children:[a.jsx(AO,{}),a.jsx(NO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(PS,{children:[a.jsx(In,{path:"/",element:a.jsx(o3,{})}),a.jsx(In,{path:"/dashboard",element:a.jsx(mO,{})}),a.jsx(In,{path:"/add-client",element:a.jsx(gO,{})}),a.jsx(In,{path:"/client",element:a.jsx(pO,{})}),a.jsx(In,{path:"/client/forms",element:a.jsx(yO,{})}),a.jsx(In,{path:"/client/tools",element:a.jsx(vO,{})}),a.jsx(In,{path:"/client/tools/macros",element:a.jsx(bO,{})}),a.jsx(In,{path:"/client/tools/snacks",element:a.jsx(wO,{})}),a.jsx(In,{path:"/client/tools/motivation",element:a.jsx(xO,{})}),a.jsx(In,{path:"/client/personal-bests",element:a.jsx(jO,{})}),a.jsx(In,{path:"/client/circuit",element:a.jsx(_O,{})}),a.jsx(In,{path:"/client/circuit/booking",element:a.jsx(kO,{})}),a.jsx(In,{path:"/client/core-buddy",element:a.jsx(A3,{})}),a.jsx(In,{path:"/client/core-buddy/nutrition",element:a.jsx(ph,{feature:"nutrition",children:a.jsx(M3,{})})}),a.jsx(In,{path:"/client/core-buddy/workouts",element:a.jsx(y5,{})}),a.jsx(In,{path:"/client/core-buddy/consistency",element:a.jsx(ph,{feature:"consistency",children:a.jsx(k5,{})})}),a.jsx(In,{path:"/client/core-buddy/buddies",element:a.jsx(ph,{feature:"buddies",children:a.jsx(E5,{})})}),a.jsx(In,{path:"/client/core-buddy/builder",element:a.jsx(N5,{})}),a.jsx(In,{path:"/client/core-buddy/profile/:userId",element:a.jsx(S5,{})}),a.jsx(In,{path:"/client/core-buddy/settings",element:a.jsx(lO,{})}),a.jsx(In,{path:"/client/core-buddy/challenges",element:a.jsx(uO,{})}),a.jsx(In,{path:"/client/core-buddy/badges",element:a.jsx(fO,{})}),a.jsx(In,{path:"/client/leaderboard",element:a.jsx(ph,{feature:"leaderboard",children:a.jsx(EO,{})})}),a.jsx(In,{path:"/signup",element:a.jsx(SO,{})}),a.jsx(In,{path:"/onboarding",element:a.jsx(CO,{})}),a.jsx(In,{path:"/upgrade",element:a.jsx(TO,{})}),a.jsx(In,{path:"*",element:a.jsx(Nx,{to:"/",replace:!0})})]})})})]})})})})}PT.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(RO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{i3 as A,Kl as B,ti as C,MO as D,xs as E,sl as P,Ft as T,or as a,ar as b,dt as c,ge as d,Be as e,XA as f,Wt as g,n4 as h,ss as i,a as j,_s as k,Or as l,Ui as m,Zs as n,$o as o,Sj as p,tn as q,w as r,LO as s,IO as t,zn as u,OO as v,kt as w,ef as x,hc as y,a3 as z};
