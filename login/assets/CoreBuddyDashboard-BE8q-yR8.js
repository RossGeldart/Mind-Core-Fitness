import{k as re,l as ie,m as oe,r as c,j as e,i as ne,e as le,d as y,c as I,q as L,w,g as D}from"./index-DCAy83v6.js";import{C as de}from"./CoreBuddyNav-Bxyc0Xfe.js";import{T as he,b as $}from"./ringTicks-_1Alaa2O.js";const me="/login/assets/workouts-DXJtvJtv.jpg",N=60,C=[10,25,50,100,200,500,1e3],ue=5;function xe(i){return i.toISOString().split("T")[0]}function be(i){let p=0;for(const r of C){if(i<r)return{prev:p,next:r};p=r}return{prev:C[C.length-1],next:i+100}}const pe={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function fe(){const{currentUser:i,isClient:p,clientData:r,logout:O,loading:g}=re(),{isDark:M,toggleTheme:R}=ie(),d=oe(),[j,H]=c.useState({hours:0,minutes:0,seconds:0}),[q,A]=c.useState(0),[T,U]=c.useState(0),[ge,K]=c.useState(""),[k,F]=c.useState(0),[S,z]=c.useState(0),[J,X]=c.useState(!1),[b,W]=c.useState(null);c.useCallback((s,t="info")=>{W({message:s,type:t}),setTimeout(()=>W(null),4e3)},[]),c.useEffect(()=>{!g&&!i&&d("/")},[g,i,d]),c.useEffect(()=>{const s=()=>{const a=new Date,o=new Date(a);o.setHours(23,59,59,999);const n=o-a,u=Math.floor(n/(1e3*60*60)),x=Math.floor(n%(1e3*60*60)/(1e3*60)),l=Math.floor(n%(1e3*60)/1e3);H({hours:u,minutes:x,seconds:l}),A(60-l)};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[]),c.useEffect(()=>{if(!i||!r)return;(async()=>{try{const t=await ne(le(y,"clientProgrammes",r.id));if(t.exists()){const h=t.data(),f=pe[h.templateId];if(f){const te=Object.keys(h.completedSessions||{}).length,E=f.duration*f.daysPerWeek;U(E>0?Math.round(te/E*100):0);const ae=h.templateId.replace(/_/g," ").replace(/\b\w/g,ce=>ce.toUpperCase());K(ae)}}const a=I(y,"workoutLogs"),o=L(a,w("clientId","==",r.id)),u=(await D(o)).docs.filter(h=>h.data().type!=="programme").length;F(u);const x=xe(new Date),l=I(y,"habitLogs"),se=L(l,w("clientId","==",r.id),w("date","==",x)),B=await D(se);let _=0;if(!B.empty){const h=B.docs[0].data().habits||{};_=Object.values(h).filter(Boolean).length}z(Math.round(_/ue*100))}catch(t){console.error("Error loading dashboard stats:",t)}finally{X(!0)}})()},[i,r]);const m=s=>{const t=s.currentTarget,a=t.querySelector(".ripple");a&&a.remove();const o=t.getBoundingClientRect(),n=Math.max(o.width,o.height),u=s.clientX-o.left-n/2,x=s.clientY-o.top-n/2,l=document.createElement("span");l.className="ripple",l.style.cssText=`width:${n}px;height:${n}px;left:${u}px;top:${x}px;`,t.appendChild(l),setTimeout(()=>l.remove(),600)},Y=r?.name?.split(" ")[0]||"there",V=Math.round(T/100*N),{prev:v,next:P}=be(k),G=P>v?Math.round((k-v)/(P-v)*100):100,Q=Math.round(G/100*N),Z=Math.round(S/100*N),ee=[{label:"Programme",value:`${T}%`,ticks:V,cls:"cb-stat-programme"},{label:"Workouts",value:`${k}`,ticks:Q,cls:"cb-stat-workouts"},{label:"Habits Today",value:`${S}%`,ticks:Z,cls:"cb-stat-habits"}];return e.jsxs("div",{className:"cb-dashboard","data-theme":M?"dark":"light",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:R,"aria-label":"Toggle theme",children:M?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),e.jsx("button",{onClick:O,"aria-label":"Log out",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),g?e.jsx("div",{className:"cb-loading-inline",children:e.jsx("div",{className:"cb-loading-spinner"})}):e.jsxs("main",{className:"cb-main",children:[e.jsx("div",{className:"cb-greeting",children:e.jsxs("h2",{children:["Hey ",Y]})}),e.jsxs("div",{className:"cb-ring-container",children:[e.jsxs("div",{className:"cb-ring",children:[e.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:he.map((s,t)=>{const a=t<q;return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`ring-tick ${a?"elapsed":"remaining"}`,strokeWidth:s.thick?"3":"2"},t)})}),e.jsxs("div",{className:"cb-ring-center",children:[e.jsx("div",{className:"cb-ring-logo",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness"})}),e.jsxs("div",{className:"cb-ring-countdown",children:[e.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),e.jsx("span",{className:"cb-timer-colon",children:":"}),e.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),e.jsx("span",{className:"cb-timer-colon",children:":"}),e.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),e.jsx("div",{className:"cb-ring-label",children:"remaining today"})]})]}),e.jsxs("p",{className:"cb-ring-tagline",children:["You have 24 hours a day... ",e.jsx("strong",{children:"make it count"})," with Core Buddy"]})]}),e.jsx("div",{className:"cb-stats-row",children:ee.map(s=>e.jsxs("div",{className:"cb-stat-item",children:[e.jsxs("div",{className:`cb-stat-ring ${s.cls}`,children:[e.jsx("svg",{viewBox:"0 0 100 100",children:$.map((t,a)=>e.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,className:a<s.ticks?"cb-stat-filled":"cb-stat-empty",strokeWidth:t.thick?"3":"2"},a))}),e.jsx("span",{className:"cb-stat-value",children:J?s.value:"â€“"})]}),e.jsx("span",{className:"cb-stat-label",children:s.label})]},s.cls))}),e.jsxs("div",{className:"cb-features",children:[e.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:s=>{m(s),d("/client/core-buddy/nutrition")},children:[e.jsxs("div",{className:"cb-card-top-row",children:[e.jsx("div",{className:"cb-card-content",children:e.jsx("h3",{children:"Today's Nutrition"})}),e.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsx("div",{className:"cb-card-preview-row",children:e.jsx("div",{className:"cb-mini-rings",children:[{cls:"cb-ring-protein",label:"P",filled:15},{cls:"cb-ring-carbs",label:"C",filled:28},{cls:"cb-ring-fats",label:"F",filled:38},{cls:"cb-ring-cals",label:"Cal",filled:22}].map(s=>e.jsxs("div",{className:`cb-mini-ring ${s.cls}`,children:[e.jsx("svg",{viewBox:"0 0 100 100",children:$.map((t,a)=>e.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,className:a<s.filled?"cb-tick-filled":"cb-tick-empty",strokeWidth:t.thick?"3":"2"},a))}),e.jsx("span",{children:s.label})]},s.cls))})}),e.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),e.jsx("button",{className:"cb-feature-card cb-card-workouts cb-card-thumbnail ripple-btn",onClick:s=>{m(s),d("/client/core-buddy/workouts")},children:e.jsx("img",{src:me,alt:"Workouts",className:"cb-card-thumb-img"})}),e.jsxs("button",{className:"cb-feature-card cb-card-consistency ripple-btn",onClick:s=>{m(s),d("/client/core-buddy/consistency")},children:[e.jsxs("div",{className:"cb-card-content",children:[e.jsx("h3",{children:"Daily Habits"}),e.jsx("p",{children:"Check off your daily habits and build streaks"})]}),e.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsxs("button",{className:"cb-feature-card cb-card-progress ripple-btn",onClick:s=>{m(s),d("/client/personal-bests?mode=corebuddy")},children:[e.jsxs("div",{className:"cb-card-content",children:[e.jsx("h3",{children:"My Progress"}),e.jsx("p",{children:"Track personal bests and body metrics"})]}),e.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),e.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:s=>{m(s),d("/client/leaderboard")},children:[e.jsxs("div",{className:"cb-card-content",children:[e.jsx("h3",{children:"Leaderboard"}),e.jsx("p",{children:"Compete with your Core Buddies"})]}),e.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]})]})]}),e.jsx(de,{active:"home"}),b&&e.jsxs("div",{className:`toast-notification ${b.type}`,children:[b.type==="info"&&e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),b.message]})]})}export{fe as default};
